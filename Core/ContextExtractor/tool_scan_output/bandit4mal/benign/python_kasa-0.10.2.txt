Run started:2025-04-12 10:41:02.332309

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/create_module_fixtures.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
51	        if network is None:
52	            network = "255.255.255.255"
53	        devs = asyncio.run(Discover.discover(target=network)).values()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
103	                if key in {"ip", "local_ip"}:
104	                    return "127.0.0.123"
105	                # Already scrubbed by dump_devinfo

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
352	            discovery_info = raw_discovery[device.host]
353	            if decrypted_data := device._discovery_info.get("decrypted_data"):
354	                discovery_info["result"]["decrypted_data"] = decrypted_data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
376	            discovery_info = raw_discovery[dev.host]
377	            if decrypted_data := dev._discovery_info.get("decrypted_data"):
378	                discovery_info["result"]["decrypted_data"] = decrypted_data

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
186	    required=False,
187	    default="255.255.255.255",
188	    help="Target network for discovery.",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
463	    # Scrub the child device ids
464	    if children := final.get("system", {}).get("get_sysinfo", {}).get("children"):
465	        for index, child in enumerate(children):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
463	    # Scrub the child device ids
464	    if children := final.get("system", {}).get("get_sysinfo", {}).get("children"):
465	        for index, child in enumerate(children):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
463	    # Scrub the child device ids
464	    if children := final.get("system", {}).get("get_sysinfo", {}).get("children"):
465	        for index, child in enumerate(children):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
470	
471	    if discovery_info and not discovery_info.get("system"):
472	        final["discovery_result"] = redact_data(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
655	        for child in child_list:
656	            child_id = child.get("device_id") or child.get("dev_id")
657	            if not child_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
655	        for child in child_list:
656	            child_id = child.get("device_id") or child.get("dev_id")
657	            if not child_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
660	            if (
661	                category := child.get("category")
662	            ) and category in SmartChildDevice.CHILD_DEVICE_TYPE_MAP:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
870	        elif (
871	            basic_info := response.get("getDeviceInfo", {})
872	            .get("device_info", {})
873	            .get("basic_info")
874	        ) and "dev_id" in basic_info:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
870	        elif (
871	            basic_info := response.get("getDeviceInfo", {})
872	            .get("device_info", {})
873	            .get("basic_info")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
870	        elif (
871	            basic_info := response.get("getDeviceInfo", {})
872	            .get("device_info", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
881	    # Scrub the device ids in the parent for smart protocol
882	    if gc := main_response.get("get_child_device_component_list"):
883	        for child in gc["child_component_list"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:891
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
890	    # Scrub the device ids in the parent for the smart camera protocol
891	    if gc := main_response.get("getChildDeviceComponentList"):
892	        for child in gc["child_component_list"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
895	        for child in main_response["getChildDeviceList"]["child_device_list"]:
896	            if device_id := child.get("device_id"):
897	                child["device_id"] = scrubbed_child_id_map[device_id]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
898	                continue
899	            elif dev_id := child.get("dev_id"):
900	                child["dev_id"] = scrubbed_child_id_map[dev_id]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
998	    # it in the child fixture.
999	    if smart_cam_child_list := final.get("getChildDeviceList"):
1000	        child_infos_on_parent = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1008	        # Get the parent model for checking whether to create a seperate child fixture
1009	        if model := final.get("get_device_info", {}).get("model"):
1010	            parent_model = model

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1008	        # Get the parent model for checking whether to create a seperate child fixture
1009	        if model := final.get("get_device_info", {}).get("model"):
1010	            parent_model = model

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1011	        elif (
1012	            device_model := final.get("getDeviceInfo", {})
1013	            .get("device_info", {})
1014	            .get("basic_info", {})
1015	            .get("device_model")
1016	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1011	        elif (
1012	            device_model := final.get("getDeviceInfo", {})
1013	            .get("device_info", {})
1014	            .get("basic_info", {})
1015	            .get("device_model")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1011	        elif (
1012	            device_model := final.get("getDeviceInfo", {})
1013	            .get("device_info", {})
1014	            .get("basic_info", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1011	        elif (
1012	            device_model := final.get("getDeviceInfo", {})
1013	            .get("device_info", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1024
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1023	        if (
1024	            (child_model := response.get("get_device_info", {}).get("model"))
1025	            and parent_model

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1024
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1023	        if (
1024	            (child_model := response.get("get_device_info", {}).get("model"))
1025	            and parent_model

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1037	            (
1038	                child_model := response.get("getDeviceInfo", {})
1039	                .get("device_info", {})
1040	                .get("basic_info", {})
1041	                .get("device_model")
1042	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1037	            (
1038	                child_model := response.get("getDeviceInfo", {})
1039	                .get("device_info", {})
1040	                .get("basic_info", {})
1041	                .get("device_model")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1037	            (
1038	                child_model := response.get("getDeviceInfo", {})
1039	                .get("device_info", {})
1040	                .get("basic_info", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/dump_devinfo.py:1038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1037	            (
1038	                child_model := response.get("getDeviceInfo", {})
1039	                .get("device_info", {})

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/devtools/generate_supported.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	            new_contents_text = "".join(new_contents)
115	            f.write(new_contents_text)
116	        return True

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/__init__.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
150	
151	    smart.SmartDevice("127.0.0.1")
152	    iot.IotDevice("127.0.0.1")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/__init__.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
151	    smart.SmartDevice("127.0.0.1")
152	    iot.IotDevice("127.0.0.1")
153	    iot.IotPlug("127.0.0.1")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/__init__.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
152	    iot.IotDevice("127.0.0.1")
153	    iot.IotPlug("127.0.0.1")
154	    iot.IotBulb("127.0.0.1")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/__init__.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
153	    iot.IotPlug("127.0.0.1")
154	    iot.IotBulb("127.0.0.1")
155	    iot.IotLightStrip("127.0.0.1")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/__init__.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
154	    iot.IotBulb("127.0.0.1")
155	    iot.IotLightStrip("127.0.0.1")
156	    iot.IotStrip("127.0.0.1")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/__init__.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
155	    iot.IotLightStrip("127.0.0.1")
156	    iot.IotStrip("127.0.0.1")
157	    iot.IotDimmer("127.0.0.1")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/__init__.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
156	    iot.IotStrip("127.0.0.1")
157	    iot.IotDimmer("127.0.0.1")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/cli/discover.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
343	    credentials: Credentials | None,
344	    target: str = "255.255.255.255",
345	    timeout: int = 5,
346	    attempts: int = 3,
347	) -> Device | None:
348	    """Discover a device identified by its alias."""
349	    found_event = asyncio.Event()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/cli/main.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
42	ENCRYPT_TYPES = [encrypt_type.value for encrypt_type in DeviceEncryptionType]
43	DEFAULT_TARGET = "255.255.255.255"
44	
45	
46	def _legacy_type_to_class(_type: str) -> Any:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/credentials.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
20	    """Return decoded default credentials."""
21	    un = base64.b64decode(tuple[0].encode()).decode()
22	    pw = base64.b64decode(tuple[1].encode()).decode()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/credentials.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
20	    """Return decoded default credentials."""
21	    un = base64.b64decode(tuple[0].encode()).decode()
22	    pw = base64.b64decode(tuple[1].encode()).decode()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/credentials.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
21	    un = base64.b64decode(tuple[0].encode()).decode()
22	    pw = base64.b64decode(tuple[1].encode()).decode()
23	    return Credentials(un, pw)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/credentials.py:22
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
21	    un = base64.b64decode(tuple[0].encode()).decode()
22	    pw = base64.b64decode(tuple[1].encode()).decode()
23	    return Credentials(un, pw)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
247	        on_discovered_raw: OnDiscoveredRawCallable | None = None,
248	        target: str = "255.255.255.255",
249	        discovery_packets: int = 3,
250	        discovery_timeout: int = 5,
251	        interface: str | None = None,
252	        on_unsupported: OnUnsupportedCallable | None = None,
253	        port: int | None = None,
254	        credentials: Credentials | None = None,
255	        timeout: int | None = None,
256	    ) -> None:
257	        self.transport: DatagramTransport | None = None
258	        self.discovery_packets = discovery_packets
259	        self.interface = interface
260	        self.on_discovered = on_discovered

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
431	        *,
432	        target: str = "255.255.255.255",
433	        on_discovered: OnDiscoveredCallable | None = None,
434	        on_discovered_raw: OnDiscoveredRawCallable | None = None,
435	        discovery_timeout: int = 5,
436	        discovery_packets: int = 3,
437	        interface: str | None = None,
438	        on_unsupported: OnUnsupportedCallable | None = None,
439	        credentials: Credentials | None = None,
440	        username: str | None = None,
441	        password: str | None = None,
442	        port: int | None = None,
443	        timeout: int | None = None,
444	    ) -> DeviceDict:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
494	            ),
495	            local_addr=("0.0.0.0", 0),  # noqa: S104
496	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
503	            for device in protocol.discovered_devices.values():
504	                await device.protocol.close()
505	            raise ex

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
506	        finally:
507	            transport.close()
508	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
581	            ),
582	            local_addr=("0.0.0.0", 0),  # noqa: S104
583	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
591	        finally:
592	            transport.close()
593	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
681	                _LOGGER.debug("Trying to connect with %s", prot.__class__.__name__)
682	                dev = await _connect(config, prot)
683	            except Exception as ex:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
698	            finally:
699	                await prot.close()
700	        return None

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
768	        key_and_iv = _AesDiscoveryQuery.keypair.decrypt_discovery_key(
769	            base64.b64decode(encryped_key.encode())
770	        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/discover.py:769
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
768	        key_and_iv = _AesDiscoveryQuery.keypair.decrypt_discovery_key(
769	            base64.b64decode(encryped_key.encode())
770	        )

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/httpclient.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
115	            async with resp:
116	                response_data = await resp.read()
117	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/protocols/smartcamprotocol.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
165	            )
166	        response_data = await self._transport.send(smart_request)
167	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/protocols/smartprotocol.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
112	        super().__init__(transport=transport)
113	        self._terminal_uuid: str = base64.b64encode(md5(uuid.uuid4().bytes)).decode()
114	        self._query_lock = asyncio.Lock()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/protocols/smartprotocol.py:113
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
112	        super().__init__(transport=transport)
113	        self._terminal_uuid: str = base64.b64encode(md5(uuid.uuid4().bytes)).decode()
114	        self._query_lock = asyncio.Lock()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/modules/lighteffect.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
43	                with contextlib.suppress(binascii.Error):
44	                    effect["scene_name"] = base64.b64decode(
45	                        effect["scene_name"]
46	                    ).decode()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/modules/lighteffect.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
43	                with contextlib.suppress(binascii.Error):
44	                    effect["scene_name"] = base64.b64decode(
45	                        effect["scene_name"]
46	                    ).decode()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
599	        if self._info and (nickname := self._info.get("nickname")):
600	            return base64.b64decode(nickname).decode()
601	        else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:600
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
599	        if self._info and (nickname := self._info.get("nickname")):
600	            return base64.b64decode(nickname).decode()
601	        else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
700	        ssid = self._info.get("ssid")
701	        ssid = base64.b64decode(ssid).decode() if ssid else "No SSID"
702	        return ssid

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:701
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
700	        ssid = self._info.get("ssid")
701	        ssid = base64.b64decode(ssid).decode() if ssid else "No SSID"
702	        return ssid

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
741	            return WifiNetwork(
742	                ssid=base64.b64decode(res["ssid"]).decode(),
743	                cipher_type=res["cipher_type"],

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:742
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
741	            return WifiNetwork(
742	                ssid=base64.b64decode(res["ssid"]).decode(),
743	                cipher_type=res["cipher_type"],

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
773	            "account": {
774	                "username": base64.b64encode(
775	                    self.credentials.username.encode()
776	                ).decode(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:774
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
773	            "account": {
774	                "username": base64.b64encode(
775	                    self.credentials.username.encode()
776	                ).decode(),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
776	                ).decode(),
777	                "password": base64.b64encode(
778	                    self.credentials.password.encode()
779	                ).decode(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:777
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
776	                ).decode(),
777	                "password": base64.b64encode(
778	                    self.credentials.password.encode()
779	                ).decode(),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
782	                "key_type": keytype,
783	                "password": base64.b64encode(password.encode()).decode(),
784	                "ssid": base64.b64encode(ssid.encode()).decode(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:783
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
782	                "key_type": keytype,
783	                "password": base64.b64encode(password.encode()).decode(),
784	                "ssid": base64.b64encode(ssid.encode()).decode(),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
783	                "password": base64.b64encode(password.encode()).decode(),
784	                "ssid": base64.b64encode(ssid.encode()).decode(),
785	            },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:784
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
783	                "password": base64.b64encode(password.encode()).decode(),
784	                "ssid": base64.b64encode(ssid.encode()).decode(),
785	            },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
809	            "account": {
810	                "username": base64.b64encode(username.encode()).decode(),
811	                "password": base64.b64encode(password.encode()).decode(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:810
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
809	            "account": {
810	                "username": base64.b64encode(username.encode()).decode(),
811	                "password": base64.b64encode(password.encode()).decode(),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
810	                "username": base64.b64encode(username.encode()).decode(),
811	                "password": base64.b64encode(password.encode()).decode(),
812	            },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:811
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
810	                "username": base64.b64encode(username.encode()).decode(),
811	                "password": base64.b64encode(password.encode()).decode(),
812	            },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
819	        return await self.protocol.query(
820	            {"set_device_info": {"nickname": base64.b64encode(alias.encode()).decode()}}
821	        )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smart/smartdevice.py:820
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
819	        return await self.protocol.query(
820	            {"set_device_info": {"nickname": base64.b64encode(alias.encode()).decode()}}
821	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smartcam/modules/camera.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
76	                decoded = json_loads(
77	                    base64.b64decode(credentials_hash.encode()).decode()
78	                )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/smartcam/modules/camera.py:77
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
76	                decoded = json_loads(
77	                    base64.b64decode(credentials_hash.encode()).decode()
78	                )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
96	            self._login_params = json_loads(
97	                base64.b64decode(self._credentials_hash.encode()).decode()  # type: ignore[union-attr]
98	            )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:97
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
96	            self._login_params = json_loads(
97	                base64.b64decode(self._credentials_hash.encode()).decode()  # type: ignore[union-attr]
98	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
131	            return None
132	        return base64.b64encode(json_dumps(self._login_params).encode()).decode()
133	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:132
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
131	            return None
132	        return base64.b64encode(json_dumps(self._login_params).encode()).decode()
133	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
142	        """Hash the credentials."""
143	        un = base64.b64encode(_sha1(credentials.username.encode()).encode()).decode()
144	        if login_v2:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:143
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
142	        """Hash the credentials."""
143	        un = base64.b64encode(_sha1(credentials.username.encode()).encode()).decode()
144	        if login_v2:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
144	        if login_v2:
145	            pw = base64.b64encode(
146	                _sha1(credentials.password.encode()).encode()
147	            ).decode()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:145
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
144	        if login_v2:
145	            pw = base64.b64encode(
146	                _sha1(credentials.password.encode()).encode()
147	            ).decode()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
148	        else:
149	            pw = base64.b64encode(credentials.password.encode()).decode()
150	        return un, pw

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:149
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
148	        else:
149	            pw = base64.b64encode(credentials.password.encode()).decode()
150	        return un, pw

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
316	            self._app_url,
317	            json=self._generate_key_pair_payload(),
318	            headers=headers,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
403	        """Create the encryption session."""
404	        handshake_key_bytes: bytes = base64.b64decode(handshake_key.encode())
405	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:404
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
403	        """Create the encryption session."""
404	        handshake_key_bytes: bytes = base64.b64decode(handshake_key.encode())
405	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
421	        encrypted = encryptor.update(padded_data) + encryptor.finalize()
422	        return base64.b64encode(encrypted)
423	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:422
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
421	        encrypted = encryptor.update(padded_data) + encryptor.finalize()
422	        return base64.b64encode(encrypted)
423	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
427	        unpadder = self.padding_strategy.unpadder()
428	        decrypted = decryptor.update(base64.b64decode(data)) + decryptor.finalize()
429	        unpadded_data = unpadder.update(decrypted) + unpadder.finalize()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:428
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
427	        unpadder = self.padding_strategy.unpadder()
428	        decrypted = decryptor.update(base64.b64decode(data)) + decryptor.finalize()
429	        unpadded_data = unpadder.update(decrypted) + unpadder.finalize()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
447	        """Create a key pair."""
448	        key_bytes = base64.b64decode(private_key_der_b64.encode())
449	        private_key = cast(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:448
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
447	        """Create a key pair."""
448	        key_bytes = base64.b64decode(private_key_der_b64.encode())
449	        private_key = cast(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
451	        )
452	        key_bytes = base64.b64decode(public_key_der_b64.encode())
453	        public_key = cast(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:452
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
451	        )
452	        key_bytes = base64.b64decode(public_key_der_b64.encode())
453	        public_key = cast(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
472	        )
473	        self.private_key_der_b64 = base64.b64encode(self.private_key_der_bytes).decode()
474	        self.public_key_der_b64 = base64.b64encode(self.public_key_der_bytes).decode()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:473
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
472	        )
473	        self.private_key_der_b64 = base64.b64encode(self.private_key_der_bytes).decode()
474	        self.public_key_der_b64 = base64.b64encode(self.public_key_der_bytes).decode()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
473	        self.private_key_der_b64 = base64.b64encode(self.private_key_der_bytes).decode()
474	        self.public_key_der_b64 = base64.b64encode(self.public_key_der_bytes).decode()
475	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/aestransport.py:474
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
473	        self.private_key_der_b64 = base64.b64encode(self.private_key_der_bytes).decode()
474	        self.public_key_der_b64 = base64.b64encode(self.public_key_der_bytes).decode()
475	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/klaptransport.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
128	        else:
129	            self._local_auth_hash = base64.b64decode(self._credentials_hash.encode())  # type: ignore[union-attr]
130	        self._default_credentials_auth_hash: dict[str, bytes] = {}

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/klaptransport.py:129
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
128	        else:
129	            self._local_auth_hash = base64.b64decode(self._credentials_hash.encode())  # type: ignore[union-attr]
130	        self._default_credentials_auth_hash: dict[str, bytes] = {}

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/klaptransport.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
162	            return None
163	        return base64.b64encode(self._local_auth_hash).decode()
164	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/klaptransport.py:163
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
162	            return None
163	        return base64.b64encode(self._local_auth_hash).decode()
164	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/linkietransport.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
66	        creds_combined = f"{creds.username}:{creds.password}"
67	        return base64.b64encode(creds_combined.encode()).decode()
68	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/linkietransport.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
66	        creds_combined = f"{creds.username}:{creds.password}"
67	        return base64.b64encode(creds_combined.encode()).decode()
68	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/linkietransport.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
73	        encrypted_cmd = XorEncryption.encrypt(request)[4:]
74	        b64_cmd = base64.b64encode(encrypted_cmd).decode()
75	        url_safe_cmd = quote(b64_cmd, safe="!~*'()")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/linkietransport.py:74
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
73	        encrypted_cmd = XorEncryption.encrypt(request)[4:]
74	        b64_cmd = base64.b64encode(encrypted_cmd).decode()
75	        url_safe_cmd = quote(b64_cmd, safe="!~*'()")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/linkietransport.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
95	            json_payload: dict = json_loads(
96	                XorEncryption.decrypt(base64.b64decode(response))
97	            )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/linkietransport.py:96
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
95	            json_payload: dict = json_loads(
96	                XorEncryption.decrypt(base64.b64decode(response))
97	            )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/linkietransport.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
124	        try:
125	            return await self._execute_send(request)
126	        except Exception as ex:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/sslaestransport.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
124	        elif self._credentials_hash:
125	            ch = json_loads(base64.b64decode(self._credentials_hash.encode()))
126	            self._password = ch["pwd"]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/sslaestransport.py:125
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
124	        elif self._credentials_hash:
125	            ch = json_loads(base64.b64decode(self._credentials_hash.encode()))
126	            self._password = ch["pwd"]

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/sslaestransport.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
142	        ch = {"un": credentials.username, "pwd": credentials.password}
143	        return base64.b64encode(json_dumps(ch).encode()).decode()
144	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/sslaestransport.py:143
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
142	        ch = {"un": credentials.username, "pwd": credentials.password}
143	        return base64.b64encode(json_dumps(ch).encode()).decode()
144	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/ssltransport.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
80	            self._login_params = json_loads(
81	                base64.b64decode(self._credentials_hash.encode()).decode()  # type: ignore[union-attr]
82	            )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/ssltransport.py:81
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
80	            self._login_params = json_loads(
81	                base64.b64decode(self._credentials_hash.encode()).decode()  # type: ignore[union-attr]
82	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/ssltransport.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
103	        """The hashed credentials used by the transport."""
104	        return base64.b64encode(json_dumps(self._login_params).encode()).decode()
105	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/ssltransport.py:104
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
103	        """The hashed credentials used by the transport."""
104	        return base64.b64encode(json_dumps(self._login_params).encode()).decode()
105	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/ssltransport.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
200	
201	        resp_dict = await self.send_request(request)
202	        await self._handle_response_error_code(resp_dict, "Error logging in")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/ssltransport.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
224	
225	        return await self.send_request(request)
226	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/xortransport.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
107	        if writer:
108	            writer.close()
109	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/xortransport.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
114	        """
115	        await self.close()
116	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/xortransport.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
128	        try:
129	            await self._connect(self._timeout)
130	        except TimeoutError as ex:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/kasa/transports/xortransport.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
165	            async with asyncio_timeout(self._timeout):
166	                return await self._execute_send(request)
167	        except TimeoutError as ex:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/conftest.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	    with path.open() as fdp:
33	        return fdp.read()
34	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/conftest.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
64	
65	    transport = DummyTransport(config=DeviceConfig(host="127.0.0.123"))
66	    protocol = SmartProtocol(transport=transport)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/device_fixtures.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
449	    d = device_for_fixture_name(fixture_data.name, fixture_data.protocol)(
450	        host="127.0.0.123"
451	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/discovery_fixtures.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
18	
19	DISCOVERY_MOCK_IP = "127.0.0.123"
20	
21	
22	class DiscoveryResponse(TypedDict):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/discovery_fixtures.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
38	        "hardware_version": "3.0",
39	        "ip": "127.0.0.1",
40	        "mac": "24:2F:D0:00:00:00",
41	        "master_device_id": "REDACTED_51f72a752213a6c45203530",
42	        "need_account_digest": True,
43	        "owner": "REDACTED_341c020d7e8bda184e56a90",
44	        "role": "master",
45	        "tmp_port": [20001],
46	    },
47	}
48	
49	
50	def _make_unsupported(
51	    device_family,
52	    encrypt_type,
53	    *,
54	    https: bool = False,
55	    omit_keys: dict[str, Any] | None = None,
56	) -> DiscoveryResponse:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/discovery_fixtures.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
64	            "device_model": "P110(EU)",
65	            "ip": "127.0.0.1",
66	            "mac": "48-22xxx",
67	            "is_support_iot_cloud": True,
68	            "obd_src": "tplink",
69	            "factory_default": False,
70	            "mgt_encrypt_schm": {
71	                "is_support_https": https,
72	                "encrypt_type": encrypt_type,
73	                "http_port": 80,
74	                "lv": 2,
75	            },
76	            "encrypt_info": {"data": "", "key": "", "sym_schm": encrypt_type},
77	        },
78	        "error_code": 0,
79	    }
80	    for key, val in omit_keys.items():
81	        if val is None:
82	            result["result"].pop(key)
83	        else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/discovery_fixtures.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
388	    discovery_data = request.param
389	    host = "127.0.0.1"
390	
391	    async def mock_discover(self):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/fakeprotocol_iot.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
239	    def __init__(self, info, fixture_name=None, *, verbatim=False):
240	        super().__init__(config=DeviceConfig("127.0.0.123"))
241	        info = copy.deepcopy(info)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/fakeprotocol_smart.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
44	            config=DeviceConfig(
45	                "127.0.0.123",
46	                credentials=Credentials(
47	                    username="dummy_user",
48	                    password="dummy_password",  # noqa: S106
49	                ),
50	            ),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/fakeprotocol_smartcam.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
42	            config=DeviceConfig(
43	                "127.0.0.123",
44	                credentials=Credentials(
45	                    username="dummy_user",
46	                    password="dummy_password",  # noqa: S106
47	                ),
48	            ),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
56	    conn = mocker.patch("asyncio.open_connection", side_effect=aio_mock_writer)
57	    config = DeviceConfig("127.0.0.1")
58	    with pytest.raises(KasaException):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
80	    )
81	    config = DeviceConfig("127.0.0.1")
82	    with pytest.raises(KasaException):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
104	    )
105	    config = DeviceConfig("127.0.0.1")
106	    with pytest.raises(KasaException):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
128	    )
129	    config = DeviceConfig("127.0.0.1")
130	    with pytest.raises(KasaException):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
181	
182	    config = DeviceConfig("127.0.0.1")
183	    protocol = protocol_class(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
231	
232	    config = DeviceConfig("127.0.0.1")
233	    protocol = protocol_class(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
283	
284	    config = DeviceConfig("127.0.0.1")
285	    protocol = protocol_class(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
339	
340	    config = DeviceConfig("127.0.0.1")
341	    protocol = protocol_class(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
389	
390	    config = DeviceConfig("127.0.0.1")
391	    protocol = protocol_class(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
442	
443	    config = DeviceConfig("127.0.0.1")
444	    protocol = protocol_class(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
485	
486	    config = DeviceConfig("127.0.0.1")
487	    protocol = protocol_class(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
538	
539	    config = DeviceConfig("127.0.0.1")
540	    protocol = protocol_class(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
588	
589	    config = DeviceConfig("127.0.0.1", port_override=custom_port)
590	    protocol = protocol_class(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
770	    """Test that the actual hashing doesn't break and empty credential returns an empty hash."""
771	    host = "127.0.0.1"
772	
773	    params = Device.ConnectionParameters(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
792	    """Test that credentials_hash provided via config sets correctly."""
793	    host = "127.0.0.1"
794	
795	    credentials = Credentials("Foo", "Bar")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
827	    conn = mocker.patch("asyncio.open_connection", side_effect=error)
828	    config = DeviceConfig("127.0.0.1")
829	    with pytest.raises(KasaException):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
869	    write_mock = mocker.patch("asyncio.StreamWriter.write", side_effect=error)
870	    config = DeviceConfig("127.0.0.1")
871	    with pytest.raises(KasaException):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/protocols/test_iotprotocol.py:887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
886	            proto = TPLinkSmartHomeProtocol()
887	        host = "127.0.0.1"
888	        proto = TPLinkSmartHomeProtocol(host=host)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/smart/test_smartdevice.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
202	
203	    new_dev = SmartDevice("127.0.0.1", protocol=dev.protocol)
204	    await new_dev.update()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/smart/test_smartdevice.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
262	
263	    new_dev = type(dev)("127.0.0.1", protocol=dev.protocol)
264	    module_queries: dict[str, dict[str, dict]] = {}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/smart/test_smartdevice.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
434	
435	    new_dev = SmartDevice("127.0.0.1", protocol=dev.protocol)
436	    if not first_update:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/smart/test_smartdevice.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
675	
676	    new_dev = SmartDevice("127.0.0.1", protocol=dev.protocol)
677	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/smartcam/modules/test_camera.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
67	    cred = json.dumps({"un": "bar", "pwd": "foobar"})
68	    cred_hash = base64.b64encode(cred.encode()).decode()
69	    with (

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/smartcam/modules/test_camera.py:68
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
67	    cred = json.dumps({"un": "bar", "pwd": "foobar"})
68	    cred_hash = base64.b64encode(cred.encode()).decode()
69	    with (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/smartcam/modules/test_camera.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	    url = camera_module.onvif_url()
100	    assert url == "http://127.0.0.123:2020/onvif/device_service"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_childdevice.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
145	            super().__init__(
146	                SmartDevice("127.0.0.1"),
147	                {"device_id": "1", "category": "foobar"},

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
90	            "--host",
91	            "127.0.0.1",
92	            "--username",
93	            "foo",
94	            "--password",
95	            "bar",
96	            "--device-family",
97	            device_family,
98	            "--encrypt-type",
99	            encrypt_type,
100	        ],
101	        catch_exceptions=False,
102	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
141	        "discovery_response": discovery_mock.discovery_data,
142	        "meta": {"ip": "127.0.0.123", "port": discovery_mock.discovery_port},
143	    }

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
209	    )
210	    row = f"{'127.0.0.1':<15} UNSUPPORTED DEVICE"
211	    assert header in res.output

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
299	        def __init__(self):
300	            super().__init__("127.0.0.1")
301	            # device_type and _info initialised for repr

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
720	
721	    res = await runner.invoke(cli, ["--host", "127.0.0.1", "--json", "state"], obj=dev)
722	    assert res.exit_code == 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
745	            "--host",
746	            "127.0.0.123",
747	            "--username",
748	            "foo",
749	            "--password",
750	            "bar",
751	            "--device-family",
752	            dr.device_type,
753	            "--encrypt-type",
754	            dr.mgt_encrypt_schm.encrypt_type,
755	            "--login-version",
756	            dr.mgt_encrypt_schm.lv or 1,
757	        ],
758	    )
759	    assert res.exit_code == 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
776	            "--host",
777	            "127.0.0.1",
778	            "--username",
779	            "foo",
780	            "--password",
781	            "bar",
782	            "--discovery-timeout",
783	            "7",
784	        ],
785	    )
786	    assert res.exit_code == 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
787	    discovery_mock.assert_called_once_with(
788	        "127.0.0.1",
789	        port=None,
790	        credentials=Credentials("foo", "bar"),
791	        timeout=5,
792	        discovery_timeout=7,
793	        on_unsupported=ANY,
794	        on_discovered_raw=ANY,
795	    )
796	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
804	            "--host",
805	            "127.0.0.1",
806	            "--type",
807	            "plug",
808	            auth_param,
809	            "foo",
810	        ],
811	    )
812	    assert res.exit_code == 2

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
824	            "--host",
825	            "127.0.0.1",
826	            "--alias",
827	            "foo",
828	        ],
829	    )
830	    assert res.exit_code == 2

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
867	            "--host",
868	            "127.0.0.123",
869	            "--username",
870	            "foo",
871	            "--password",
872	            "bar",
873	            "--verbose",
874	        ],
875	    )
876	    assert res.exit_code == 0
877	
878	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
899	    """Test discovery output."""
900	    host = "127.0.0.1"
901	
902	    res = await runner.invoke(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
921	    """Test discovery output."""
922	    host = "127.0.0.1"
923	    discovery_mock.ip = host

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
951	    """Test discovery output."""
952	    host = "127.0.0.1"
953	    discovery_mock.ip = host

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
997	        cli,
998	        ["--type", device_type, "--host", "127.0.0.1"],
999	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1004	@pytest.mark.skip(
1005	    "Skip until pytest-asyncio supports pytest 8.0, https://github.com/pytest-dev/pytest-asyncio/issues/737"
1006	)
1007	async def test_shell(dev: Device, mocker, runner):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1074
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1073	        cli,
1074	        ["--host", "127.0.0.123", "--debug", "feature"],
1075	        catch_exceptions=False,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1087
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1086	        cli,
1087	        ["--host", "127.0.0.123", "--debug", "feature"],
1088	        catch_exceptions=False,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1104	        cli,
1105	        ["--host", "127.0.0.123", "--debug", "feature", "led"],
1106	        catch_exceptions=False,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1120	        cli,
1121	        ["--host", "127.0.0.123", "--debug", "feature", "missing"],
1122	        catch_exceptions=False,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1138	        cli,
1139	        ["--host", "127.0.0.123", "--debug", "feature", "led", "True"],
1140	        catch_exceptions=False,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1163	            "--host",
1164	            "127.0.0.123",
1165	            "--debug",
1166	            "feature",
1167	            "--child",
1168	            child_id,
1169	            "state",
1170	            "True",
1171	        ],
1172	        catch_exceptions=False,
1173	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1192	        cli,
1193	        ["--host", "127.0.0.123", "--debug", "feature", "pir_range", "Far"],
1194	        catch_exceptions=False,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1211	        cli,
1212	        ["--host", "127.0.0.123", "--debug", "feature", "pir_range", "`Far"],
1213	        catch_exceptions=False,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1230	        cli,
1231	        ["--host", "127.0.0.123", "--debug", "feature", "pir_range", "'Far'"],
1232	        catch_exceptions=False,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1348	    """Test that device config is returned."""
1349	    host = "127.0.0.1"
1350	    mocker.patch("kasa.device_factory._connect", side_effect=[Exception, dev])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1381	    """Test the device config command with invalids."""
1382	    host = "127.0.0.1"
1383	    mocker.patch("kasa.discover.Discover.try_connect_all", return_value=None)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_cli.py:1420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1419	            "--target",
1420	            "127.0.0.2",
1421	            "discover",
1422	            "config",
1423	        ],
1424	        catch_exceptions=False,
1425	    )
1426	    assert res.exit_code == 1
1427	    assert "--target is not a valid option for single host discovery" in res.output

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_device.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
81	    """Make sure constructor api not broken for new and existing SmartDevices."""
82	    host = "127.0.0.2"
83	    port = 1234

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_device.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
94	            "hw_ver": "1.0",
95	            "mac": "1.2.3.4",
96	            "hwId": "hw_id",
97	            "oem_id": "oem_id",
98	        }
99	        dev = klass(
100	            parent,
101	            {"dummy": "info", "device_id": "dummy", **smartcam_required},
102	            {
103	                "component_list": [{"id": "device", "ver_code": 1}],
104	                "app_component_list": [{"name": "device", "version": 1}],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_device.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
116	    """Test device repr when update() not called and no discovery info."""
117	    host = "127.0.0.2"
118	    port = 1234

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_device.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
159	    """Make sure timeout is passed to the protocol."""
160	    host = "127.0.0.1"
161	    dev = IotDevice(host, config=DeviceConfig(host, timeout=100))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_device.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
381	            config=Device.Config(
382	                host="127.0.0.1",
383	                credentials=Device.Credentials(username="user", password="foobar"),  # noqa: S106

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_device_factory.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
293	    """Test get_protocol returns the right protocol."""
294	    config = DeviceConfig("127.0.0.1", connection_type=conn_params)
295	    protocol = get_protocol(config)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_deviceconfig.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
19	
20	PLUG_XOR_CONFIG = DeviceConfig(host="127.0.0.1")
21	PLUG_KLAP_CONFIG = DeviceConfig(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_deviceconfig.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
21	PLUG_KLAP_CONFIG = DeviceConfig(
22	    host="127.0.0.1",
23	    connection_type=DeviceConnectionParameters(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_deviceconfig.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
27	CAMERA_AES_CONFIG = DeviceConfig(
28	    host="127.0.0.1",
29	    connection_type=DeviceConnectionParameters(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
64	        "device_model": "P110(EU)",
65	        "ip": "127.0.0.1",
66	        "mac": "48-22xxx",
67	        "is_support_iot_cloud": True,
68	        "obd_src": "tplink",
69	        "factory_default": False,
70	        "mgt_encrypt_schm": {
71	            "is_support_https": False,
72	            "encrypt_type": "AES",
73	            "http_port": 80,
74	            "lv": 2,
75	        },
76	    },
77	    "error_code": 0,
78	}
79	
80	
81	@wallswitch_iot
82	async def test_type_detection_switch(dev: Device):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
132	    """Make sure that discover_single returns an initialized SmartDevice instance."""
133	    host = "127.0.0.1"
134	    discovery_mock.ip = host

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
181	    host = "foobar"
182	    ip = "127.0.0.1"
183	
184	    discovery_mock.ip = ip

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
200	    """Make sure that discover gives credentials precedence over un and pw."""
201	    host = "127.0.0.1"
202	
203	    async def mock_discover(self, *_, **__):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
228	    """Make sure that discover_single gives credentials precedence over un and pw."""
229	    host = "127.0.0.1"
230	
231	    async def mock_discover(self, *_, **__):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
256	    """Make sure that discover_single handles unsupported devices correctly."""
257	    host = "127.0.0.1"
258	
259	    # Test with a valid unsupported response
260	    with pytest.raises(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
267	    """Make sure that discover_single handles no response correctly."""
268	    host = "127.0.0.1"
269	    mocker.patch.object(_DiscoverProtocol, "do_discover")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
287	    """Make sure that invalid discovery information raises an exception."""
288	    host = "127.0.0.1"
289	
290	    async def mock_discover(self):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
305	    assert proto.discovery_packets == 3
306	    assert proto.target_1 == ("255.255.255.255", 9999)
307	    transport = mocker.patch.object(proto, "transport")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
317	
318	    addr = "127.0.0.1"
319	    port = 20002 if "result" in discovery_data else 9999

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
323	
324	    addr2 = "127.0.0.2"
325	    mocker.patch("kasa.discover.json_loads", return_value=UNSUPPORTED)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
344	
345	    proto.datagram_received(data, ("127.0.0.1", 9999))
346	    assert len(proto.discovered_devices) == 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
354	        "device_model": "HS100(UK)",
355	        "ip": "127.0.0.1",
356	        "mac": "12-34-56-78-90-AB",
357	        "is_support_iot_cloud": True,
358	        "obd_src": "tplink",
359	        "factory_default": False,
360	        "mgt_encrypt_schm": {
361	            "is_support_https": False,
362	            "encrypt_type": "KLAP",
363	            "http_port": 80,
364	        },
365	    },
366	    "error_code": 0,
367	}
368	
369	
370	@new_discovery
371	async def test_discover_single_authentication(discovery_mock, mocker):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
372	    """Make sure that discover_single handles authenticating devices correctly."""
373	    host = "127.0.0.1"
374	    discovery_mock.ip = host

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
401	    device_class = Discover._get_device_class(discovery_data)
402	    device = device_class("127.0.0.1")
403	    discover_info = DiscoveryResult.from_dict(discovery_data["result"])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
421	    """Make sure that discover_single returns an initialized SmartDevice instance."""
422	    host = "127.0.0.1"
423	    discovery_mock.ip = host

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
438	    """Make sure that discover returns an initialized SmartDevice instance."""
439	    host = "127.0.0.1"
440	    discovery_mock.ip = host

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
506	    """Make sure that _DiscoverProtocol handles authenticating devices correctly."""
507	    host = "127.0.0.1"
508	    discovery_timeout = 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
532	    """Make sure that _DiscoverProtocol handles invalid devices correctly."""
533	    host = "127.0.0.1"
534	    discovery_timeout = 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
564	    """Make sure that if the datagram connection doesnt start a TimeoutError is raised."""
565	    host = "127.0.0.1"
566	    discovery_timeout = 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
582	    """Make sure that a cancel other than when target is discovered propogates."""
583	    host = "127.0.0.1"
584	    discovery_timeout = 1

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
650	    encrypted_key_iv = keypair.public_key.encrypt(key_iv, padding)
651	    encrypted_key_iv_b4 = base64.b64encode(encrypted_key_iv)
652	    encryption_session = AesEncyptionSession(key_iv[:16], key_iv[16:])

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:651
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
650	    encrypted_key_iv = keypair.public_key.encrypt(key_iv, padding)
651	    encrypted_key_iv_b4 = base64.b64encode(encrypted_key_iv)
652	    encryption_session = AesEncyptionSession(key_iv[:16], key_iv[16:])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_discovery.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
731	    host = "foobar"
732	    ip = "127.0.0.1"
733	
734	    discovery_mock.ip = ip

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_httpclient.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
77	
78	    host = "127.0.0.1"
79	
80	    side_effect = _post if mock_read else error

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_httpclient.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	    with pytest.raises(error_raises, match=error_message) as exc_info:
93	        await client.post("http://foobar")
94	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
172	    fixture_infos = {
173	        "127.0.0.1": get_fixture_info("KP303(UK)_1.0_1.0.3.json", "IOT"),  # Strip
174	        "127.0.0.2": get_fixture_info("HS110(EU)_1.0_1.2.5.json", "IOT"),  # Plug
175	        "127.0.0.3": get_fixture_info("L530E(EU)_3.0_1.1.6.json", "SMART"),  # Bulb
176	        "127.0.0.4": get_fixture_info("KL430(US)_1.0_1.0.10.json", "IOT"),  # Lightstrip
177	        "127.0.0.5": get_fixture_info("HS220(US)_1.0_1.5.7.json", "IOT"),  # Dimmer
178	        "127.0.0.6": get_fixture_info("H200(US)_1.0_1.3.6.json", "SMARTCAM"),  # Hub
179	    }
180	    fixture_infos["127.0.0.1"].data["system"]["get_sysinfo"]["alias"] = (

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
173	        "127.0.0.1": get_fixture_info("KP303(UK)_1.0_1.0.3.json", "IOT"),  # Strip
174	        "127.0.0.2": get_fixture_info("HS110(EU)_1.0_1.2.5.json", "IOT"),  # Plug
175	        "127.0.0.3": get_fixture_info("L530E(EU)_3.0_1.1.6.json", "SMART"),  # Bulb
176	        "127.0.0.4": get_fixture_info("KL430(US)_1.0_1.0.10.json", "IOT"),  # Lightstrip
177	        "127.0.0.5": get_fixture_info("HS220(US)_1.0_1.5.7.json", "IOT"),  # Dimmer
178	        "127.0.0.6": get_fixture_info("H200(US)_1.0_1.3.6.json", "SMARTCAM"),  # Hub
179	    }
180	    fixture_infos["127.0.0.1"].data["system"]["get_sysinfo"]["alias"] = (
181	        "Bedroom Power Strip"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
174	        "127.0.0.2": get_fixture_info("HS110(EU)_1.0_1.2.5.json", "IOT"),  # Plug
175	        "127.0.0.3": get_fixture_info("L530E(EU)_3.0_1.1.6.json", "SMART"),  # Bulb
176	        "127.0.0.4": get_fixture_info("KL430(US)_1.0_1.0.10.json", "IOT"),  # Lightstrip
177	        "127.0.0.5": get_fixture_info("HS220(US)_1.0_1.5.7.json", "IOT"),  # Dimmer
178	        "127.0.0.6": get_fixture_info("H200(US)_1.0_1.3.6.json", "SMARTCAM"),  # Hub
179	    }
180	    fixture_infos["127.0.0.1"].data["system"]["get_sysinfo"]["alias"] = (
181	        "Bedroom Power Strip"
182	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
175	        "127.0.0.3": get_fixture_info("L530E(EU)_3.0_1.1.6.json", "SMART"),  # Bulb
176	        "127.0.0.4": get_fixture_info("KL430(US)_1.0_1.0.10.json", "IOT"),  # Lightstrip
177	        "127.0.0.5": get_fixture_info("HS220(US)_1.0_1.5.7.json", "IOT"),  # Dimmer
178	        "127.0.0.6": get_fixture_info("H200(US)_1.0_1.3.6.json", "SMARTCAM"),  # Hub
179	    }
180	    fixture_infos["127.0.0.1"].data["system"]["get_sysinfo"]["alias"] = (
181	        "Bedroom Power Strip"
182	    )
183	    for index, child in enumerate(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
176	        "127.0.0.4": get_fixture_info("KL430(US)_1.0_1.0.10.json", "IOT"),  # Lightstrip
177	        "127.0.0.5": get_fixture_info("HS220(US)_1.0_1.5.7.json", "IOT"),  # Dimmer
178	        "127.0.0.6": get_fixture_info("H200(US)_1.0_1.3.6.json", "SMARTCAM"),  # Hub
179	    }
180	    fixture_infos["127.0.0.1"].data["system"]["get_sysinfo"]["alias"] = (
181	        "Bedroom Power Strip"
182	    )
183	    for index, child in enumerate(
184	        fixture_infos["127.0.0.1"].data["system"]["get_sysinfo"]["children"]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
177	        "127.0.0.5": get_fixture_info("HS220(US)_1.0_1.5.7.json", "IOT"),  # Dimmer
178	        "127.0.0.6": get_fixture_info("H200(US)_1.0_1.3.6.json", "SMARTCAM"),  # Hub
179	    }
180	    fixture_infos["127.0.0.1"].data["system"]["get_sysinfo"]["alias"] = (
181	        "Bedroom Power Strip"
182	    )
183	    for index, child in enumerate(
184	        fixture_infos["127.0.0.1"].data["system"]["get_sysinfo"]["children"]
185	    ):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
179	    }
180	    fixture_infos["127.0.0.1"].data["system"]["get_sysinfo"]["alias"] = (
181	        "Bedroom Power Strip"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
183	    for index, child in enumerate(
184	        fixture_infos["127.0.0.1"].data["system"]["get_sysinfo"]["children"]
185	    ):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
186	        child["alias"] = f"Plug {index + 1}"
187	    fixture_infos["127.0.0.2"].data["system"]["get_sysinfo"]["alias"] = (
188	        "Bedroom Lamp Plug"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
189	    )
190	    fixture_infos["127.0.0.3"].data["get_device_info"]["nickname"] = (
191	        "TGl2aW5nIFJvb20gQnVsYg=="  # Living Room Bulb

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
192	    )
193	    fixture_infos["127.0.0.4"].data["system"]["get_sysinfo"]["alias"] = (
194	        "Bedroom Lightstrip"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
195	    )
196	    fixture_infos["127.0.0.5"].data["system"]["get_sysinfo"]["alias"] = (
197	        "Living Room Dimmer Switch"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/test_readme_examples.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
198	    )
199	    fixture_infos["127.0.0.6"].data["getDeviceInfo"]["device_info"]["basic_info"][
200	        "device_alias"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
72	):
73	    host = "127.0.0.1"
74	    mock_aes_device = MockAesDevice(host, status_code, error_code, inner_error_code)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
89	async def test_handshake_with_keys(mocker):
90	    host = "127.0.0.1"
91	    mock_aes_device = MockAesDevice(host)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
113	async def test_login(mocker, status_code, error_code, inner_error_code, expectation):
114	    host = "127.0.0.1"
115	    mock_aes_device = MockAesDevice(host, status_code, error_code, inner_error_code)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
159	async def test_login_errors(mocker, inner_error_codes, expectation, call_count):
160	    host = "127.0.0.1"
161	    mock_aes_device = MockAesDevice(host, 200, 0, inner_error_codes)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
192	async def test_send(mocker, status_code, error_code, inner_error_code, expectation):
193	    host = "127.0.0.1"
194	    mock_aes_device = MockAesDevice(host, status_code, error_code, inner_error_code)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
220	async def test_unencrypted_response(mocker, caplog):
221	    host = "127.0.0.1"
222	    mock_aes_device = MockAesDevice(host, 200, 0, 0, do_not_encrypt_response=True)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
251	async def test_unencrypted_response_invalid_json(mocker, caplog):
252	    host = "127.0.0.1"
253	    mock_aes_device = MockAesDevice(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
285	async def test_passthrough_errors(mocker, error_code):
286	    host = "127.0.0.1"
287	    mock_aes_device = MockAesDevice(host, 200, error_code, 0)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
311	async def test_unknown_errors(mocker, error_code):
312	    host = "127.0.0.1"
313	    mock_aes_device = MockAesDevice(host, 200, error_code, 0)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
338	    """Test that port override sets the app_url."""
339	    host = "127.0.0.1"
340	    config = DeviceConfig(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
344	
345	    assert str(transport._app_url) == "http://127.0.0.1:12345/app"
346	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
367	    """
368	    host = "127.0.0.1"
369	
370	    default_delay = HttpClient.WAIT_BETWEEN_REQUESTS_ON_OSERROR

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
501	
502	        client_pub_key_data = base64.b64decode(client_pub_key.encode())
503	        client_pub_key = serialization.load_der_public_key(client_pub_key_data, None)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:502
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
501	
502	        client_pub_key_data = base64.b64decode(client_pub_key.encode())
503	        client_pub_key = serialization.load_der_public_key(client_pub_key_data, None)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
504	        encrypted_key = client_pub_key.encrypt(KEY_IV, asymmetric_padding.PKCS1v15())
505	        key_64 = base64.b64encode(encrypted_key).decode()
506	        return self._mock_response(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_aestransport.py:505
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
504	        encrypted_key = client_pub_key.encrypt(KEY_IV, asymmetric_padding.PKCS1v15())
505	        key_64 = base64.b64encode(encrypted_key).decode()
506	        return self._mock_response(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
67	):
68	    host = "127.0.0.1"
69	    conn = mocker.patch.object(aiohttp.ClientSession, "post", side_effect=error)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
95	):
96	    host = "127.0.0.1"
97	    conn = mocker.patch.object(HttpClient, "post", side_effect=error)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
114	):
115	    host = "127.0.0.1"
116	    conn = mocker.patch.object(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
135	):
136	    host = "127.0.0.1"
137	    conn = mocker.patch.object(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
155	async def test_protocol_reconnect(mocker, retry_count, protocol_class, transport_class):
156	    host = "127.0.0.1"
157	    remaining = retry_count

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
201	
202	    config = DeviceConfig("127.0.0.1")
203	    protocol = IotProtocol(transport=KlapTransport(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
251	
252	    transport = KlapTransport(config=DeviceConfig(host="127.0.0.1"))
253	    transport._handshake_done = True

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
282	
283	    transport = KlapTransport(config=DeviceConfig(host="127.0.0.1"))
284	    transport._handshake_done = True

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
352	
353	    config = DeviceConfig("127.0.0.1", credentials=client_credentials)
354	    protocol = IotProtocol(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
393	
394	        if url == URL("http://127.0.0.1:80/app/handshake1"):
395	            client_seed = data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
400	            return _mock_response(200, server_seed + seed_auth_hash)
401	        elif url == URL("http://127.0.0.1:80/app/handshake2"):
402	            seed_auth_hash = _sha256(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
411	
412	    config = DeviceConfig("127.0.0.1", credentials=client_credentials)
413	    protocol = IotProtocol(transport=transport_class(config=config))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
437	
438	        if url == URL("http://127.0.0.1:80/app/handshake1"):
439	            client_seed = data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
442	            return _mock_response(200, server_seed + client_seed_auth_hash)
443	        elif url == URL("http://127.0.0.1:80/app/handshake2"):
444	            return _mock_response(200, b"")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
444	            return _mock_response(200, b"")
445	        elif url == URL("http://127.0.0.1:80/app/request"):
446	            encryption_session = KlapEncryptionSession(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
458	
459	    config = DeviceConfig("127.0.0.1", credentials=client_credentials)
460	    protocol = IotProtocol(transport=KlapTransport(config=config))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
530	
531	        if url == URL("http://127.0.0.1:80/app/handshake1"):
532	            client_seed = data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
538	            )
539	        elif url == URL("http://127.0.0.1:80/app/handshake2"):
540	            client_seed = data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
544	            )
545	        elif url == URL("http://127.0.0.1:80/app/request"):
546	            return _mock_response(response_status[2], b"")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
549	
550	    config = DeviceConfig("127.0.0.1", credentials=client_credentials)
551	    protocol = IotProtocol(transport=KlapTransport(config=config))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
558	    """Test that port override sets the app_url."""
559	    host = "127.0.0.1"
560	    config = DeviceConfig(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_klaptransport.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
564	
565	    assert str(transport._app_url) == "http://127.0.0.1:12345/app"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_linkietransport.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
22	    """No errors with an expected request/response."""
23	    host = "127.0.0.1"
24	    mock_linkie_device = MockLinkieDevice(host)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_linkietransport.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
41	
42	    host = "127.0.0.1"
43	    mock_linkie_device = MockLinkieDevice(host)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_linkietransport.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
96	    """Test a variety of possible responses from the device."""
97	    host = "127.0.0.1"
98	    transport = LinkieTransportV2(config=DeviceConfig(host))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_linkietransport.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
112	    creds_combined = f"{creds.username}:{creds.password}"
113	    return base64.b64encode(creds_combined.encode()).decode()
114	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_linkietransport.py:113
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
112	    creds_combined = f"{creds.username}:{creds.password}"
113	    return base64.b64encode(creds_combined.encode()).decode()
114	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
111	):
112	    host = "127.0.0.1"
113	    mock_ssl_aes_device = MockSslAesDevice(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
139	async def test_credentials_hash(mocker, wants_default_user):
140	    host = "127.0.0.1"
141	    mock_ssl_aes_device = MockSslAesDevice(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
164	async def test_send(mocker):
165	    host = "127.0.0.1"
166	    mock_ssl_aes_device = MockSslAesDevice(host, want_default_username=False)

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
178	
179	    res = await transport.send(json_dumps(request))
180	    assert "result" in res

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
184	async def test_unencrypted_response(mocker, caplog):
185	    host = "127.0.0.1"
186	    mock_ssl_aes_device = MockSslAesDevice(host, do_not_encrypt_response=True)

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
199	    caplog.set_level(logging.DEBUG)
200	    res = await transport.send(json_dumps(request))
201	    assert "result" in res

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
210	async def test_unencrypted_passthrough(mocker, caplog, want_default):
211	    host = "127.0.0.1"
212	    mock_ssl_aes_device = MockSslAesDevice(

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
227	    caplog.set_level(logging.DEBUG)
228	    res = await transport.send(json_dumps(request))
229	    assert "result" in res

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
237	async def test_unencrypted_passthrough_errors(mocker, caplog, want_default):
238	    host = "127.0.0.1"
239	    request = {

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
260	    with pytest.raises(AuthenticationError):
261	        await transport.send(json_dumps(request))
262	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
277	    with pytest.raises(KasaException, match=msg):
278	        await transport.send(json_dumps(request))
279	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
292	    with pytest.raises(KasaException, match=msg):
293	        await transport.send(json_dumps(request))
294	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
307	    with pytest.raises(KasaException, match=msg):
308	        await transport.send(json_dumps(request))
309	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
322	    with pytest.raises(KasaException, match=msg):
323	        await transport.send(json_dumps(request))
324	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
326	async def test_device_blocked_response(mocker):
327	    host = "127.0.0.1"
328	    mock_ssl_aes_device = MockSslAesDevice(host, device_blocked=True)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
358	    """Test 500 error raises retryable exception."""
359	    host = "127.0.0.1"
360	    mock_ssl_aes_device = MockSslAesDevice(host)

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
380	    with pytest.raises(_RetryableError, match=msg):
381	        await transport.send(json_dumps(request))
382	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
385	    """Test that port override sets the app_url."""
386	    host = "127.0.0.1"
387	    port_override = 12345

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
392	
393	    assert str(transport._app_url) == f"https://127.0.0.1:{port_override}"
394	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_sslaestransport.py:655
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
654	            async with decrypted_response:
655	                decrypted_response_data = await decrypted_response.read()
656	            encrypted_response = self.encryption_session.encrypt(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
131	):
132	    host = "127.0.0.1"
133	    mock_ssl_aes_device = MockSslDevice(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
154	async def test_credentials_hash(mocker):
155	    host = "127.0.0.1"
156	    mock_ssl_aes_device = MockSslDevice(host)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
163	
164	    creds_hash = b64encode(json_dumps(data).encode()).decode()
165	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:164
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
163	
164	    creds_hash = b64encode(json_dumps(data).encode()).decode()
165	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
177	async def test_send(mocker):
178	    host = "127.0.0.1"
179	    mock_ssl_aes_device = MockSslDevice(host, send_error_code=SmartErrorCode.SUCCESS)

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
193	
194	    res = await transport.send(json_dumps(request))
195	    assert "result" in res

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
199	    # Second request does not
200	    res = await transport.send(json_dumps(request))
201	    try_login_spy.assert_called_once()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
207	    """Test transport without credentials."""
208	    host = "127.0.0.1"
209	    mock_ssl_aes_device = MockSslDevice(

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
219	    with pytest.raises(AuthenticationError):
220	        await transport.send('{"method": "dummy"}')
221	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
229	    """Test that transport state adjusts correctly for reset."""
230	    host = "127.0.0.1"
231	    mock_ssl_aes_device = MockSslDevice(host, send_error_code=SmartErrorCode.SUCCESS)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
240	    assert transport._state is TransportState.LOGIN_REQUIRED
241	    assert str(transport._app_url) == "https://127.0.0.1:4433/app"
242	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
244	    assert transport._state is TransportState.ESTABLISHED
245	    assert str(transport._app_url).startswith("https://127.0.0.1:4433/app?token=")
246	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
248	    assert transport._state is TransportState.LOGIN_REQUIRED
249	    assert str(transport._app_url) == "https://127.0.0.1:4433/app"
250	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
253	    """Test that port override sets the app_url."""
254	    host = "127.0.0.1"
255	    port_override = 12345

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
260	
261	    assert str(transport._app_url) == f"https://127.0.0.1:{port_override}/app"
262	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_kasa-0.10.2/python_kasa-0.10.2/tests/transports/test_ssltransport.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
305	        res = self._post(url, json)
306	        _LOGGER.debug("Response %s, data: %s", res, await res.read())
307	        return res

--------------------------------------------------

Code scanned:
	Total lines of code: 35414
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 223.0
		High: 103.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 283.0
		High: 43.0
Files skipped (0):
