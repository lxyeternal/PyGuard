Run started:2025-04-12 15:47:29.950152

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/bioformats.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	
75	    url = ('http://downloads.openmicroscopy.org/bio-formats/' + version +
76	           '/artifacts/loci_tools.jar')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/bioformats.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
78	    path = os.path.join(loc, 'loci_tools.jar')
79	    loci_tools = urlopen(url).read()
80	    sha1_checksum = urlopen(url + '.sha1').read().split(b' ')[0].decode()

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/bioformats.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
78	    path = os.path.join(loc, 'loci_tools.jar')
79	    loci_tools = urlopen(url).read()
80	    sha1_checksum = urlopen(url + '.sha1').read().split(b' ')[0].decode()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/bioformats.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
79	    loci_tools = urlopen(url).read()
80	    sha1_checksum = urlopen(url + '.sha1').read().split(b' ')[0].decode()
81	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/bioformats.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
79	    loci_tools = urlopen(url).read()
80	    sha1_checksum = urlopen(url + '.sha1').read().split(b' ')[0].decode()
81	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/bioformats.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	    with open(path, 'wb') as output:
88	        output.write(loci_tools)
89	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/display.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
416	        output += TAG.render(
417	            data=b64encode(_as_png(s, width, normed=False)).decode('utf-8'),
418	            stack_id=stack_id, i=i)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/display.py:417
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
416	        output += TAG.render(
417	            data=b64encode(_as_png(s, width, normed=False)).decode('utf-8'),
418	            stack_id=stack_id, i=i)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/ffmpeg_reader.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
166	            try:
167	                chunk = proc.stdout.read(CHUNKSIZE)
168	                if len(chunk) == 0:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/ffmpeg_reader.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
169	                    break
170	                self.data_buffer.write(chunk)
171	            except EOFError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/ffmpeg_reader.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
175	
176	        self._process_ffmpeg_stderr(proc.stderr.read())
177	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/ffmpeg_reader.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
198	        self._len = int(lines[-2].split()[1])
199	        self.metafile.write('{0}\n'.format(self._len))
200	        self.metafile.write('{0}\n'.format(self._size[0]))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/ffmpeg_reader.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
199	        self.metafile.write('{0}\n'.format(self._len))
200	        self.metafile.write('{0}\n'.format(self._size[0]))
201	        self.metafile.write('{0}\n'.format(self._size[1]))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/ffmpeg_reader.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
200	        self.metafile.write('{0}\n'.format(self._size[0]))
201	        self.metafile.write('{0}\n'.format(self._size[1]))
202	        self.metafile.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/ffmpeg_reader.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
212	        self.data_buffer.seek(self._stride*j)
213	        s = self.data_buffer.read(self._stride)
214	        w, h = self._size

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/frame.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
136	                           'style="width: {{width}}" />')
137	            return tag.render(data=b64encode(_as_png(image,
138	                                                     width)).decode('utf-8'),
139	                              width=width)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/frame.py:137
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
136	                           'style="width: {{width}}" />')
137	            return tag.render(data=b64encode(_as_png(image,
138	                                                     width)).decode('utf-8'),
139	                              width=width)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/image_sequence.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	
68	        tmp = self.imread(self._filepaths[0], **self.kwargs)
69	        self._first_frame_shape = tmp.shape

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/image_sequence.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
81	        if self._is_zipfile:
82	            file_handle = BytesIO(self._zipfile.read(filename))
83	            return imread(file_handle, **kwargs)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/image_sequence.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	            file_handle = BytesIO(self._zipfile.read(filename))
83	            return imread(file_handle, **kwargs)
84	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/image_sequence.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
84	        else:
85	            return imread(filename, **kwargs)
86	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/image_sequence.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	            raise ValueError("File does not contain this many frames")
130	        res = self.imread(self._filepaths[j], **self.kwargs)
131	        return Frame(res, frame_no=j)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/image_sequence.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
433	        i = np.argwhere(np.all(self._toc == row, 1))[0, 0]
434	        return self.imread(self._filepaths[i], **self.kwargs)
435	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/norpix_reader.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
159	        s = struct.Struct('<' + fs)
160	        vals = s.unpack(self._file.read(s.size))
161	        if len(vals) == 1:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/norpix_reader.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
194	        if self._timestamp_micro:
195	            tsecs, tms, tus = self._timestamp_struct.unpack(self._file.read(8))
196	            tfloat = tsecs + float(tms) / 1000. + float(tus) / 1.0e6

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/norpix_reader.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
197	        else:
198	            tsecs, tms = self._timestamp_struct.unpack(self._file.read(6))
199	            tfloat = tsecs + float(tms) / 1000.

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/tests/test_imseq.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	            for fn in self.filenames:
41	                archive.write(os.path.join(self.filepath, fn))
42	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/tests/test_imseq.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
40	            for fn in self.filenames:
41	                archive.write(os.path.join(self.filepath, fn))
42	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/tiff_stack.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
460	        elif dom_obj.getAttribute("type") == "int":
461	            _write(file_obj, dom_obj.getAttribute("id"),
462	                   int(dom_obj.getAttribute("value")))
463	        elif dom_obj.getAttribute("type") == "float":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/tiff_stack.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
463	        elif dom_obj.getAttribute("type") == "float":
464	            _write(file_obj, dom_obj.getAttribute("id"),
465	                   float(dom_obj.getAttribute("value")))
466	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/tiff_stack.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
466	        else:
467	            _write(file_obj, dom_obj.getAttribute("id"),
468	                   dom_obj.getAttribute("value").encode('ascii'))
469	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/pims/tiff_stack.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
476	            if len(tmp_split) == 2:
477	                _write(file_obj, tmp_split[0],
478	                       tmp_split[1].encode('ascii'))
479	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/setup.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6	try:
7	    descr = open(os.path.join(os.path.dirname(__file__), 'README.md')).read()
8	except IOError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/setup.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    author_email="dallan@pha.jhu.edu",
27	    url="https://github.com/soft-matter/pims",
28	    packages=["pims", "pims.utils", "pims.tests"],

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
399	    parser = configparser.ConfigParser()
400	    parser.read(setup_cfg)
401	    VCS = parser.get("versioneer", "VCS")  # mandatory

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
465	    return stdout
466	LONG_VERSION_PY['git'] = '''
467	# This file helps to compute a version number in source trees obtained from
468	# git-archive tarball (such as those provided by githubs download-from-tag
469	# feature). Distribution tarballs (built by setup.py sdist) and build
470	# directories (produced by setup.py build) will contain a much shorter file
471	# that just contains the computed version number.
472	
473	# This file is released into the public domain. Generated by
474	# versioneer-0.15 (https://github.com/warner/python-versioneer)
475	
476	import errno
477	import os
478	import re
479	import subprocess
480	import sys
481	
482	
483	def get_keywords():
484	    # these strings will be replaced by git during git-archive.
485	    # setup.py/versioneer.py will grep for the variable names, so they must
486	    # each be defined on a line of their own. _version.py will just call
487	    # get_keywords().
488	    git_refnames = "%(DOLLAR)sFormat:%%d%(DOLLAR)s"
489	    git_full = "%(DOLLAR)sFormat:%%H%(DOLLAR)s"
490	    keywords = {"refnames": git_refnames, "full": git_full}
491	    return keywords
492	
493	
494	class VersioneerConfig:
495	    pass
496	
497	
498	def get_config():
499	    # these strings are filled in when 'setup.py versioneer' creates
500	    # _version.py
501	    cfg = VersioneerConfig()
502	    cfg.VCS = "git"
503	    cfg.style = "%(STYLE)s"
504	    cfg.tag_prefix = "%(TAG_PREFIX)s"
505	    cfg.parentdir_prefix = "%(PARENTDIR_PREFIX)s"
506	    cfg.versionfile_source = "%(VERSIONFILE_SOURCE)s"
507	    cfg.verbose = False
508	    return cfg
509	
510	
511	class NotThisMethod(Exception):
512	    pass
513	
514	
515	LONG_VERSION_PY = {}
516	HANDLERS = {}
517	
518	
519	def register_vcs_handler(vcs, method):  # decorator
520	    def decorate(f):
521	        if vcs not in HANDLERS:
522	            HANDLERS[vcs] = {}
523	        HANDLERS[vcs][method] = f
524	        return f
525	    return decorate
526	
527	
528	def run_command(commands, args, cwd=None, verbose=False, hide_stderr=False):
529	    assert isinstance(commands, list)
530	    p = None
531	    for c in commands:
532	        try:
533	            dispcmd = str([c] + args)
534	            # remember shell=False, so use git.cmd on windows, not just git
535	            p = subprocess.Popen([c] + args, cwd=cwd, stdout=subprocess.PIPE,
536	                                 stderr=(subprocess.PIPE if hide_stderr
537	                                         else None))
538	            break
539	        except EnvironmentError:
540	            e = sys.exc_info()[1]
541	            if e.errno == errno.ENOENT:
542	                continue
543	            if verbose:
544	                print("unable to run %%s" %% dispcmd)
545	                print(e)
546	            return None
547	    else:
548	        if verbose:
549	            print("unable to find command, tried %%s" %% (commands,))
550	        return None
551	    stdout = p.communicate()[0].strip()
552	    if sys.version_info[0] >= 3:
553	        stdout = stdout.decode()
554	    if p.returncode != 0:
555	        if verbose:
556	            print("unable to run %%s (error)" %% dispcmd)
557	        return None
558	    return stdout
559	
560	
561	def versions_from_parentdir(parentdir_prefix, root, verbose):
562	    # Source tarballs conventionally unpack into a directory that includes
563	    # both the project name and a version string.
564	    dirname = os.path.basename(root)
565	    if not dirname.startswith(parentdir_prefix):
566	        if verbose:
567	            print("guessing rootdir is '%%s', but '%%s' doesn't start with "
568	                  "prefix '%%s'" %% (root, dirname, parentdir_prefix))
569	        raise NotThisMethod("rootdir doesn't start with parentdir_prefix")
570	    return {"version": dirname[len(parentdir_prefix):],
571	            "full-revisionid": None,
572	            "dirty": False, "error": None}
573	
574	
575	@register_vcs_handler("git", "get_keywords")
576	def git_get_keywords(versionfile_abs):
577	    # the code embedded in _version.py can just fetch the value of these
578	    # keywords. When used from setup.py, we don't want to import _version.py,
579	    # so we do it with a regexp instead. This function is not used from
580	    # _version.py.
581	    keywords = {}
582	    try:
583	        f = open(versionfile_abs, "r")
584	        for line in f.readlines():
585	            if line.strip().startswith("git_refnames ="):
586	                mo = re.search(r'=\s*"(.*)"', line)
587	                if mo:
588	                    keywords["refnames"] = mo.group(1)
589	            if line.strip().startswith("git_full ="):
590	                mo = re.search(r'=\s*"(.*)"', line)
591	                if mo:
592	                    keywords["full"] = mo.group(1)
593	        f.close()
594	    except EnvironmentError:
595	        pass
596	    return keywords
597	
598	
599	@register_vcs_handler("git", "keywords")
600	def git_versions_from_keywords(keywords, tag_prefix, verbose):
601	    if not keywords:
602	        raise NotThisMethod("no keywords at all, weird")
603	    refnames = keywords["refnames"].strip()
604	    if refnames.startswith("$Format"):
605	        if verbose:
606	            print("keywords are unexpanded, not using")
607	        raise NotThisMethod("unexpanded keywords, not a git-archive tarball")
608	    refs = set([r.strip() for r in refnames.strip("()").split(",")])
609	    # starting in git-1.8.3, tags are listed as "tag: foo-1.0" instead of
610	    # just "foo-1.0". If we see a "tag: " prefix, prefer those.
611	    TAG = "tag: "
612	    tags = set([r[len(TAG):] for r in refs if r.startswith(TAG)])
613	    if not tags:
614	        # Either we're using git < 1.8.3, or there really are no tags. We use
615	        # a heuristic: assume all version tags have a digit. The old git %%d
616	        # expansion behaves like git log --decorate=short and strips out the
617	        # refs/heads/ and refs/tags/ prefixes that would let us distinguish
618	        # between branches and tags. By ignoring refnames without digits, we
619	        # filter out many common branch names like "release" and
620	        # "stabilization", as well as "HEAD" and "master".
621	        tags = set([r for r in refs if re.search(r'\d', r)])
622	        if verbose:
623	            print("discarding '%%s', no digits" %% ",".join(refs-tags))
624	    if verbose:
625	        print("likely tags: %%s" %% ",".join(sorted(tags)))
626	    for ref in sorted(tags):
627	        # sorting will prefer e.g. "2.0" over "2.0rc1"
628	        if ref.startswith(tag_prefix):
629	            r = ref[len(tag_prefix):]
630	            if verbose:
631	                print("picking %%s" %% r)
632	            return {"version": r,
633	                    "full-revisionid": keywords["full"].strip(),
634	                    "dirty": False, "error": None
635	                    }
636	    # no suitable tags, so version is "0+unknown", but full hex is still there
637	    if verbose:
638	        print("no suitable tags, using unknown + full revision id")
639	    return {"version": "0+unknown",
640	            "full-revisionid": keywords["full"].strip(),
641	            "dirty": False, "error": "no suitable tags"}
642	
643	
644	@register_vcs_handler("git", "pieces_from_vcs")
645	def git_pieces_from_vcs(tag_prefix, root, verbose, run_command=run_command):
646	    # this runs 'git' from the root of the source tree. This only gets called
647	    # if the git-archive 'subst' keywords were *not* expanded, and
648	    # _version.py hasn't already been rewritten with a short version string,
649	    # meaning we're inside a checked out source tree.
650	
651	    if not os.path.exists(os.path.join(root, ".git")):
652	        if verbose:
653	            print("no .git in %%s" %% root)
654	        raise NotThisMethod("no .git directory")
655	
656	    GITS = ["git"]
657	    if sys.platform == "win32":
658	        GITS = ["git.cmd", "git.exe"]
659	    # if there is a tag, this yields TAG-NUM-gHEX[-dirty]
660	    # if there are no tags, this yields HEX[-dirty] (no NUM)
661	    describe_out = run_command(GITS, ["describe", "--tags", "--dirty",
662	                                      "--always", "--long"],
663	                               cwd=root)
664	    # --long was added in git-1.5.5
665	    if describe_out is None:
666	        raise NotThisMethod("'git describe' failed")
667	    describe_out = describe_out.strip()
668	    full_out = run_command(GITS, ["rev-parse", "HEAD"], cwd=root)
669	    if full_out is None:
670	        raise NotThisMethod("'git rev-parse' failed")
671	    full_out = full_out.strip()
672	
673	    pieces = {}
674	    pieces["long"] = full_out
675	    pieces["short"] = full_out[:7]  # maybe improved later
676	    pieces["error"] = None
677	
678	    # parse describe_out. It will be like TAG-NUM-gHEX[-dirty] or HEX[-dirty]
679	    # TAG might have hyphens.
680	    git_describe = describe_out
681	
682	    # look for -dirty suffix
683	    dirty = git_describe.endswith("-dirty")
684	    pieces["dirty"] = dirty
685	    if dirty:
686	        git_describe = git_describe[:git_describe.rindex("-dirty")]
687	
688	    # now we have TAG-NUM-gHEX or HEX
689	
690	    if "-" in git_describe:
691	        # TAG-NUM-gHEX
692	        mo = re.search(r'^(.+)-(\d+)-g([0-9a-f]+)$', git_describe)
693	        if not mo:
694	            # unparseable. Maybe git-describe is misbehaving?
695	            pieces["error"] = ("unable to parse git-describe output: '%%s'"
696	                               %% describe_out)
697	            return pieces
698	
699	        # tag
700	        full_tag = mo.group(1)
701	        if not full_tag.startswith(tag_prefix):
702	            if verbose:
703	                fmt = "tag '%%s' doesn't start with prefix '%%s'"
704	                print(fmt %% (full_tag, tag_prefix))
705	            pieces["error"] = ("tag '%%s' doesn't start with prefix '%%s'"
706	                               %% (full_tag, tag_prefix))
707	            return pieces
708	        pieces["closest-tag"] = full_tag[len(tag_prefix):]
709	
710	        # distance: number of commits since tag
711	        pieces["distance"] = int(mo.group(2))
712	
713	        # commit: short hex revision ID
714	        pieces["short"] = mo.group(3)
715	
716	    else:
717	        # HEX: no tags
718	        pieces["closest-tag"] = None
719	        count_out = run_command(GITS, ["rev-list", "HEAD", "--count"],
720	                                cwd=root)
721	        pieces["distance"] = int(count_out)  # total number of commits
722	
723	    return pieces
724	
725	
726	def plus_or_dot(pieces):
727	    if "+" in pieces.get("closest-tag", ""):
728	        return "."
729	    return "+"
730	
731	
732	def render_pep440(pieces):
733	    # now build up version string, with post-release "local version
734	    # identifier". Our goal: TAG[+DISTANCE.gHEX[.dirty]] . Note that if you
735	    # get a tagged build and then dirty it, you'll get TAG+0.gHEX.dirty
736	
737	    # exceptions:
738	    # 1: no tags. git_describe was just HEX. 0+untagged.DISTANCE.gHEX[.dirty]
739	
740	    if pieces["closest-tag"]:
741	        rendered = pieces["closest-tag"]
742	        if pieces["distance"] or pieces["dirty"]:
743	            rendered += plus_or_dot(pieces)
744	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
745	            if pieces["dirty"]:
746	                rendered += ".dirty"
747	    else:
748	        # exception #1
749	        rendered = "0+untagged.%%d.g%%s" %% (pieces["distance"],
750	                                          pieces["short"])
751	        if pieces["dirty"]:
752	            rendered += ".dirty"
753	    return rendered
754	
755	
756	def render_pep440_pre(pieces):
757	    # TAG[.post.devDISTANCE] . No -dirty
758	
759	    # exceptions:
760	    # 1: no tags. 0.post.devDISTANCE
761	
762	    if pieces["closest-tag"]:
763	        rendered = pieces["closest-tag"]
764	        if pieces["distance"]:
765	            rendered += ".post.dev%%d" %% pieces["distance"]
766	    else:
767	        # exception #1
768	        rendered = "0.post.dev%%d" %% pieces["distance"]
769	    return rendered
770	
771	
772	def render_pep440_post(pieces):
773	    # TAG[.postDISTANCE[.dev0]+gHEX] . The ".dev0" means dirty. Note that
774	    # .dev0 sorts backwards (a dirty tree will appear "older" than the
775	    # corresponding clean one), but you shouldn't be releasing software with
776	    # -dirty anyways.
777	
778	    # exceptions:
779	    # 1: no tags. 0.postDISTANCE[.dev0]
780	
781	    if pieces["closest-tag"]:
782	        rendered = pieces["closest-tag"]
783	        if pieces["distance"] or pieces["dirty"]:
784	            rendered += ".post%%d" %% pieces["distance"]
785	            if pieces["dirty"]:
786	                rendered += ".dev0"
787	            rendered += plus_or_dot(pieces)
788	            rendered += "g%%s" %% pieces["short"]
789	    else:
790	        # exception #1
791	        rendered = "0.post%%d" %% pieces["distance"]
792	        if pieces["dirty"]:
793	            rendered += ".dev0"
794	        rendered += "+g%%s" %% pieces["short"]
795	    return rendered
796	
797	
798	def render_pep440_old(pieces):
799	    # TAG[.postDISTANCE[.dev0]] . The ".dev0" means dirty.
800	
801	    # exceptions:
802	    # 1: no tags. 0.postDISTANCE[.dev0]
803	
804	    if pieces["closest-tag"]:
805	        rendered = pieces["closest-tag"]
806	        if pieces["distance"] or pieces["dirty"]:
807	            rendered += ".post%%d" %% pieces["distance"]
808	            if pieces["dirty"]:
809	                rendered += ".dev0"
810	    else:
811	        # exception #1
812	        rendered = "0.post%%d" %% pieces["distance"]
813	        if pieces["dirty"]:
814	            rendered += ".dev0"
815	    return rendered
816	
817	
818	def render_git_describe(pieces):
819	    # TAG[-DISTANCE-gHEX][-dirty], like 'git describe --tags --dirty
820	    # --always'
821	
822	    # exceptions:
823	    # 1: no tags. HEX[-dirty]  (note: no 'g' prefix)
824	
825	    if pieces["closest-tag"]:
826	        rendered = pieces["closest-tag"]
827	        if pieces["distance"]:
828	            rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
829	    else:
830	        # exception #1
831	        rendered = pieces["short"]
832	    if pieces["dirty"]:
833	        rendered += "-dirty"
834	    return rendered
835	
836	
837	def render_git_describe_long(pieces):
838	    # TAG-DISTANCE-gHEX[-dirty], like 'git describe --tags --dirty
839	    # --always -long'. The distance/hash is unconditional.
840	
841	    # exceptions:
842	    # 1: no tags. HEX[-dirty]  (note: no 'g' prefix)
843	
844	    if pieces["closest-tag"]:
845	        rendered = pieces["closest-tag"]
846	        rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
847	    else:
848	        # exception #1
849	        rendered = pieces["short"]
850	    if pieces["dirty"]:
851	        rendered += "-dirty"
852	    return rendered
853	
854	
855	def render(pieces, style):
856	    if pieces["error"]:
857	        return {"version": "unknown",
858	                "full-revisionid": pieces.get("long"),
859	                "dirty": None,
860	                "error": pieces["error"]}
861	
862	    if not style or style == "default":
863	        style = "pep440"  # the default
864	
865	    if style == "pep440":
866	        rendered = render_pep440(pieces)
867	    elif style == "pep440-pre":
868	        rendered = render_pep440_pre(pieces)
869	    elif style == "pep440-post":
870	        rendered = render_pep440_post(pieces)
871	    elif style == "pep440-old":
872	        rendered = render_pep440_old(pieces)
873	    elif style == "git-describe":
874	        rendered = render_git_describe(pieces)
875	    elif style == "git-describe-long":
876	        rendered = render_git_describe_long(pieces)
877	    else:
878	        raise ValueError("unknown style '%%s'" %% style)
879	
880	    return {"version": rendered, "full-revisionid": pieces["long"],
881	            "dirty": pieces["dirty"], "error": None}
882	
883	
884	def get_versions():
885	    # I am in _version.py, which lives at ROOT/VERSIONFILE_SOURCE. If we have
886	    # __file__, we can work backwards from there to the root. Some
887	    # py2exe/bbfreeze/non-CPython implementations don't do __file__, in which
888	    # case we can only use expanded keywords.
889	
890	    cfg = get_config()
891	    verbose = cfg.verbose
892	
893	    try:
894	        return git_versions_from_keywords(get_keywords(), cfg.tag_prefix,
895	                                          verbose)
896	    except NotThisMethod:
897	        pass
898	
899	    try:
900	        root = os.path.realpath(__file__)
901	        # versionfile_source is the relative path from the top of the source
902	        # tree (where the .git directory might live) to this file. Invert
903	        # this to find the root from __file__.
904	        for i in cfg.versionfile_source.split('/'):
905	            root = os.path.dirname(root)
906	    except NameError:
907	        return {"version": "0+unknown", "full-revisionid": None,
908	                "dirty": None,
909	                "error": "unable to find root of source tree"}
910	
911	    try:
912	        pieces = git_pieces_from_vcs(cfg.tag_prefix, root, verbose)
913	        return render(pieces, cfg.style)
914	    except NotThisMethod:
915	        pass
916	
917	    try:
918	        if cfg.parentdir_prefix:
919	            return versions_from_parentdir(cfg.parentdir_prefix, root, verbose)
920	    except NotThisMethod:
921	        pass
922	
923	    return {"version": "0+unknown", "full-revisionid": None,
924	            "dirty": None,
925	            "error": "unable to compute version"}
926	'''
927	
928	
929	@register_vcs_handler("git", "get_keywords")
930	def git_get_keywords(versionfile_abs):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:1107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1106	        f = open(".gitattributes", "a+")
1107	        f.write("%s export-subst\n" % versionfile_source)
1108	        f.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:1148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1147	        with open(filename) as f:
1148	            contents = f.read()
1149	    except EnvironmentError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:1163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1162	    with open(filename, "w") as f:
1163	        f.write(SHORT_VERSION_PY % contents)
1164	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:1491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1490	                    LONG = LONG_VERSION_PY[cfg.VCS]
1491	                    f.write(LONG %
1492	                            {"DOLLAR": "$",
1493	                             "STYLE": cfg.style,
1494	                             "TAG_PREFIX": cfg.tag_prefix,
1495	                             "PARENTDIR_PREFIX": cfg.parentdir_prefix,
1496	                             "VERSIONFILE_SOURCE": cfg.versionfile_source,
1497	                             })

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:1586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1585	            with open(os.path.join(root, "setup.cfg"), "a") as f:
1586	                f.write(SAMPLE_CONFIG)
1587	        print(CONFIG_ERROR, file=sys.stderr)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:1593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1592	        LONG = LONG_VERSION_PY[cfg.VCS]
1593	        f.write(LONG % {"DOLLAR": "$",
1594	                        "STYLE": cfg.style,
1595	                        "TAG_PREFIX": cfg.tag_prefix,
1596	                        "PARENTDIR_PREFIX": cfg.parentdir_prefix,
1597	                        "VERSIONFILE_SOURCE": cfg.versionfile_source,
1598	                        })

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:1605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1604	            with open(ipy, "r") as f:
1605	                old = f.read()
1606	        except EnvironmentError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:1611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1610	            with open(ipy, "a") as f:
1611	                f.write(INIT_PY_SNIPPET)
1612	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:1639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1638	        with open(manifest_in, "a") as f:
1639	            f.write("include versioneer.py\n")
1640	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pims-0.7/pims-0.7/versioneer.py:1646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1645	        with open(manifest_in, "a") as f:
1646	            f.write("include %s\n" % cfg.versionfile_source)
1647	    else:

--------------------------------------------------

Code scanned:
	Total lines of code: 7418
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 41.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 44.0
		High: 2.0
Files skipped (0):
