Run started:2025-04-12 11:17:22.330869

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/encoders/bedrock.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
226	                        )
227	                        response_body = json.loads(response.get("body").read())
228	                        embeddings.append(response_body.get("embedding"))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/encoders/bedrock.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
247	                        )
248	                        response_body = json.loads(response.get("body").read())
249	                        chunk_embeddings = response_body.get("embeddings")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/encoders/huggingface.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	    def __init__(self, **data):
65	        if data.get("score_threshold") is None:
66	            data["score_threshold"] = 0.5

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/encoders/huggingface.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
286	            try:
287	                response = requests.post(
288	                    self.huggingface_url,
289	                    headers=headers,
290	                    json=payload,
291	                    # timeout=timeout_seconds,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/encoders/huggingface.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
293	                if response.status_code == 503:
294	                    estimated_time = response.json().get("estimated_time", "")
295	                    if estimated_time:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	    headers: dict[str, str] = {}
155	    index_host: Optional[str] = "http://localhost:5080"
156	
157	    def __init__(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	        namespace: Optional[str] = "",
167	        base_url: Optional[str] = "https://api.pinecone.io",
168	        init_async_index: bool = False,
169	    ):
170	        """Initialize PineconeIndex.
171	
172	        :param api_key: Pinecone API key.
173	        :type api_key: Optional[str]
174	        :param index_name: Name of the index.
175	        :type index_name: str
176	        :param dimensions: Dimensions of the index.
177	        :type dimensions: Optional[int]
178	        :param metric: Metric of the index.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
676	            else:
677	                response = requests.post(
678	                    f"{self.index_host}/vectors/delete",
679	                    json=DeleteRequest(
680	                        ids=route_vec_ids,
681	                        delete_all=True,
682	                        namespace=self.namespace,
683	                    ).model_dump(exclude_none=True),
684	                    timeout=10,
685	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
835	        )
836	        if config_record.get("vectors"):
837	            return ConfigParameter(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1047	        async with aiohttp.ClientSession() as session:
1048	            async with session.post(
1049	                f"{self.host}/query",
1050	                json=params,
1051	                headers=self.headers,
1052	            ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1090
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1089	        async with aiohttp.ClientSession() as session:
1090	            async with session.get(
1091	                f"{self.base_url}/indexes",
1092	                headers=self.headers,
1093	            ) as response:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1120	        async with aiohttp.ClientSession() as session:
1121	            async with session.post(
1122	                f"{self.host}/vectors/upsert",
1123	                json=params,
1124	                headers=self.headers,
1125	            ) as response:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1156	        async with aiohttp.ClientSession() as session:
1157	            async with session.post(
1158	                f"{self.base_url}/indexes",
1159	                json=params,
1160	                headers=self.headers,
1161	            ) as response:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1183	        async with aiohttp.ClientSession() as session:
1184	            async with session.post(
1185	                f"{self.host}/vectors/delete",
1186	                json=params,
1187	                headers=self.headers,
1188	            ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1197	        async with aiohttp.ClientSession() as session:
1198	            async with session.get(
1199	                f"{self.base_url}/indexes/{name}",
1200	                headers=self.headers,
1201	            ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1248	
1249	                async with session.get(
1250	                    list_url,
1251	                    params=params,
1252	                    headers=self.headers,
1253	                ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1260	
1261	                vector_ids = [vec["id"] for vec in response_data.get("vectors", [])]
1262	                if not vector_ids:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1272	
1273	                next_page_token = response_data.get("pagination", {}).get("next")
1274	                if not next_page_token:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1272	
1273	                next_page_token = response_data.get("pagination", {}).get("next")
1274	                if not next_page_token:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1314	        async with aiohttp.ClientSession() as session:
1315	            async with session.get(
1316	                url, params=params, headers=self.headers
1317	            ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1329	                return (
1330	                    response_data.get("vectors", {})
1331	                    .get(vector_id, {})
1332	                    .get("metadata", {})
1333	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1329	                return (
1330	                    response_data.get("vectors", {})
1331	                    .get(vector_id, {})
1332	                    .get("metadata", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1329	                return (
1330	                    response_data.get("vectors", {})
1331	                    .get(vector_id, {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/pinecone.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1335	    def __len__(self):
1336	        namespace_stats = self.index.describe_index_stats()["namespaces"].get(
1337	            self.namespace
1338	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/index/qdrant.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        default=None,
57	        description="Prefix to the REST URL path. Example: `http://localhost:6333/some/prefix/{qdrant-endpoint}`.",
58	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/llms/ollama.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
74	            }
75	            response = requests.post("http://localhost:11434/api/chat", json=payload)
76	            output = response.json()["message"]["content"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/llms/ollama.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	            }
75	            response = requests.post("http://localhost:11434/api/chat", json=payload)
76	            output = response.json()["message"]["content"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/llms/openrouter.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    _client: Optional[openai.OpenAI] = PrivateAttr(default=None)
17	    _base_url: str = PrivateAttr(default="https://openrouter.ai/api/v1")
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/semantic_router-0.1.7/semantic_router-0.1.7/semantic_router/llms/openrouter.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        openrouter_api_key: Optional[str] = None,
23	        base_url: str = "https://openrouter.ai/api/v1",
24	        temperature: float = 0.01,
25	        max_tokens: int = 200,
26	    ):
27	        """Initialize the OpenRouterLLM.
28	
29	        :param name: The name of the OpenRouter model to use.

--------------------------------------------------

Code scanned:
	Total lines of code: 9500
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 0.0
Files skipped (0):
