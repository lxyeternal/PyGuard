Run started:2025-04-12 18:27:02.427675

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/cfn.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
380	    header_fields = Assignment._fields + ("source_ou", )
381	    assignments_csv.write(",".join(header_fields) + "\n")
382	    for template_process_input in template_process_inputs.values():

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/cfn.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
390	                )
391	                assignments_csv.write(",".join(v or "" for v in (assignment_tuple + (source_ou,)) ) + "\n")
392	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/cfn_lib/macro.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
268	                    s3_base_path,
269	                    f"https://s3.amazonaws.com/{BUCKET_NAME}/{s3_base_path}",
270	                    resource_name,

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/check.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
277	                        owner = path.owner()
278	                        if owner != getpass.getuser():
279	                            coda = f", it is owned by {owner}"

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/check.py:278
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
277	                        owner = path.owner()
278	                        if owner != getpass.getuser():
279	                            coda = f", it is owned by {owner}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/configure_profile.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
187	        if cli_version.startswith("1."):
188	            LOGGER.warn(textwrap.dedent(f"""\
189	            Your profile has been written, but is not complete.
190	            You have the AWS CLI version {cli_version}, which does not support Identity Center.
191	            If you install the AWS CLI v2, aws-sso-util configure profile can interactively

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/configure_profile.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	    except FileNotFoundError:
196	        LOGGER.warn(textwrap.dedent("""\
197	            Your profile has been written, but is not complete.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	def get_logout_url(region: Optional[str]=None):
34	    redirect = urllib.parse.quote_plus("https://aws.amazon.com/premiumsupport/knowledge-center/sign-out-account/?from_aws_sso_util_logout")
35	    if not region or region == "us-east-1":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	    if not region or region == "us-east-1":
36	        return f"https://signin.aws.amazon.com/oauth?Action=logout&redirect_uri={redirect}"
37	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    if region == "us-gov-east-1":
39	        return "https://us-gov-east-1.signin.amazonaws-us-gov.com/oauth?Action=logout"
40	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    if region == "us-gov-west-1":
42	        return "https://signin.amazonaws-us-gov.com/oauth?Action=logout"
43	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	    if not region or region == "us-east-1":
48	        return "https://signin.aws.amazon.com/federation"
49	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	    if region == "us-gov-east-1":
51	        return "https://us-gov-east-1.signin.amazonaws-us-gov.com/federation"
52	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	    if region == "us-gov-west-1":
54	        return "https://signin.amazonaws-us-gov.com/federation"
55	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        #TODO: regional?
61	        return "https://console.amazonaws-us-gov.com"
62	    if region:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	    else:
65	        return "https://console.aws.amazon.com/"
66	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	    if logout_first is None:
133	        logout_first = os.environ.get("AWS_CONSOLE_LOGOUT_FIRST", "").lower() in ["true", "1"]
134	        logout_first_from_env = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	    federation_endpoint = get_federation_endpoint(region=region)
153	    issuer = os.environ.get("AWS_CONSOLE_DEFAULT_ISSUER")
154	    destination = get_destination(path=destination_path, region=region, override_region_in_destination=override_region_in_destination)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
265	    serialized_json_bytes = json.dumps(token_payload, ensure_ascii=True, separators=(',', ':')).encode("utf-8")
266	    base64_encoded_bytes = base64.urlsafe_b64encode(serialized_json_bytes)
267	    token = str(base64_encoded_bytes, "ascii")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
297	    if logout_first is None:
298	        logout_first = os.environ.get("AWS_CONSOLE_LOGOUT_FIRST", "").lower() in ["true", "1"]
299	        logout_first_from_env = True

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
323	    try:
324	        token_payload = json.loads(base64.urlsafe_b64decode(config_token))
325	        if not isinstance(token_payload, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
334	    # check the token version
335	    token_version = token_data.get("version")
336	    if token_version != "1":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
339	    # check we have an account, override if it's given
340	    if not token_data.get("account_id") and not account_id:
341	        raise click.UsageError("Token does not specify account, please use --account-id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
345	    # check we have a role, override if it's given
346	    if not token_data.get("role_name") and not role_name:
347	        raise click.UsageError("Token does not specify account, please use --role-name")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/console.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
411	
412	    response = requests.post(federation_endpoint, data=get_signin_token_payload)
413	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/credential_process.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	        if (config.get("sso_interactive_auth") or "").lower() == "true":
151	            raise InvalidSSOConfigError("Interactive auth has been removed. See https://github.com/benkehoe/aws-sso-credential-process/issues/4")
152	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_sso_util-4.33.0/aws_sso_util-4.33.0/src/aws_sso_util/deploy_macro.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	
25	REPO = "https://github.com/benkehoe/aws-sso-util"
26	
27	def clone_repo(git_clone_origin, git_clone_branch, git_clone_args):

--------------------------------------------------

Code scanned:
	Total lines of code: 4055
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 12.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 1.0
Files skipped (0):
