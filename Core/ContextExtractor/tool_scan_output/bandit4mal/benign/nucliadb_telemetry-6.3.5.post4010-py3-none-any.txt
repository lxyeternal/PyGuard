Run started:2025-04-12 19:23:35.956124

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/fastapi/tracing.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
207	    """Returns (host, port, full_url) tuple."""
208	    server = scope.get("server") or ["0.0.0.0", 80]
209	    port = server[1]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/grpc.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
152	            # other telemetry sources add this, so we will too
153	            if ip in ("[::1]", "127.0.0.1"):
154	                attributes[SpanAttributes.NET_PEER_NAME] = "localhost"

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/grpc.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
407	        server = aio.server(
408	            futures.ThreadPoolExecutor(max_workers=concurrency),
409	            interceptors=_interceptors,

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/jaeger.py:125
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
124	        self.split_oversized_batches = split_oversized_batches
125	        self._sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
126	        self._sock.setblocking(False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/tests/telemetry.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	    def get_port(self, port=None):
66	        if os.environ.get("TESTING", "") == "jenkins" or "TRAVIS" in os.environ:
67	            return port if port else self.port

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/tests/telemetry.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	    def get_http_port(self, port=None):
75	        if os.environ.get("TESTING", "") == "jenkins" or "TRAVIS" in os.environ:
76	            return 16686

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/tests/telemetry.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	    def check(self):
84	        resp = requests.get(f"http://{self.host}:{self.get_http_port()}")
85	        return resp.status_code == 200

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/tests/telemetry.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
98	    telemetry_settings.jaeger_enabled = True
99	    telemetry_settings.jaeger_agent_host = "127.0.0.1"
100	    telemetry_settings.jaeger_agent_port = jaeger_server.get_port()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/tests/telemetry.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
261	        # Test regular nats request-response
262	        await self.ncotel.request("testing.telemetry_nats_reqresp", request.name.encode())
263	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/tests/telemetry.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
261	        # Test regular nats request-response
262	        await self.ncotel.request("testing.telemetry_nats_reqresp", request.name.encode())
263	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/tests/telemetry.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
311	
312	    @app.get("/")
313	    async def simple_api():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_telemetry-6.3.5.post4010-py3-none-any/nucliadb_telemetry/tests/telemetry.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
332	
333	    client_base_url = "http://test"
334	    client = AsyncClient(app=app, base_url=client_base_url)

--------------------------------------------------

Code scanned:
	Total lines of code: 2710
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 7.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 1.0
Files skipped (0):
