Run started:2025-04-12 13:55:59.230141

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/clientlib.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
255	                logger.warning(
256	                    f'The {self.key!r} field of repo {dct["repo"]!r} '
257	                    f'appears to be a mutable reference '

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/autoupdate.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
125	    with open(path, newline='') as f:
126	        original = f.read()
127	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/autoupdate.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
135	        with open(path, 'w') as f:
136	            f.write(yaml_dump(yaml_load(original)))
137	        return _original_lines(path, rev_infos, retry=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/autoupdate.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
135	        with open(path, 'w') as f:
136	            f.write(yaml_dump(yaml_load(original)))
137	        return _original_lines(path, rev_infos, retry=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/autoupdate.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
158	    with open(path, 'w', newline='') as f:
159	        f.write(''.join(lines))
160	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/autoupdate.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
158	    with open(path, 'w', newline='') as f:
159	        f.write(''.join(lines))
160	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/autoupdate.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
182	    jobs = max(jobs, 1)  # at least one thread
183	    with concurrent.futures.ThreadPoolExecutor(jobs) as exe:
184	        futures = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/hook_impl.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        raise SystemExit(
24	            f"bug: pre-commit's script is installed in migration mode\n"
25	            f'run `pre-commit install -f --hook-type {hook_type}` to fix '
26	            f'this\n\n'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/hook_impl.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
31	    if hook_type == 'pre-push':
32	        stdin = sys.stdin.buffer.read()
33	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/install_uninstall.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	    with open(filename, 'rb') as f:
60	        contents = f.read()
61	    return any(h in contents for h in (CURRENT_HASH,) + PRIOR_HASHES)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/install_uninstall.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
101	        if sys.platform == 'win32':  # pragma: win32 cover
102	            hook_file.write('#!/bin/sh\n')
103	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/install_uninstall.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
103	
104	        hook_file.write(before + TEMPLATE_START)
105	        hook_file.write(f'INSTALL_PYTHON={shlex.quote(sys.executable)}\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/install_uninstall.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
104	        hook_file.write(before + TEMPLATE_START)
105	        hook_file.write(f'INSTALL_PYTHON={shlex.quote(sys.executable)}\n')
106	        args_s = shlex.join(args)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/install_uninstall.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	        args_s = shlex.join(args)
107	        hook_file.write(f'ARGS=({args_s})\n')
108	        hook_file.write(TEMPLATE_END + after)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/install_uninstall.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
107	        hook_file.write(f'ARGS=({args_s})\n')
108	        hook_file.write(TEMPLATE_END + after)
109	    make_executable(hook_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/migrate_config.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
115	    with open(config_file) as f:
116	        orig_contents = contents = f.read()
117	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/migrate_config.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
129	        with open(config_file, 'w') as f:
130	            f.write(contents)
131	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/run.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
153	    if hook.id in skips or hook.alias in skips:
154	        output.write(
155	            _full_msg(
156	                start=hook.name,
157	                end_msg=SKIPPED,
158	                end_color=color.YELLOW,
159	                use_color=use_color,
160	                cols=cols,
161	            ),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/run.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	    elif not filenames and not hook.always_run:
169	        output.write(
170	            _full_msg(
171	                start=hook.name,
172	                postfix=NO_FILES,
173	                end_msg=SKIPPED,
174	                end_color=color.TURQUOISE,
175	                use_color=use_color,
176	                cols=cols,
177	            ),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/run.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
185	        # print hook and dots first in case the hook takes a while to run
186	        output.write(_start_msg(start=hook.name, end_len=6, cols=cols))
187	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/sample_config.py:2
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	from __future__ import annotations
2	SAMPLE_CONFIG = '''\
3	# See https://pre-commit.com for more information
4	# See https://pre-commit.com/hooks.html for more hooks
5	repos:
6	-   repo: https://github.com/pre-commit/pre-commit-hooks
7	    rev: v3.2.0
8	    hooks:
9	    -   id: trailing-whitespace
10	    -   id: end-of-file-fixer
11	    -   id: check-yaml
12	    -   id: check-added-large-files
13	'''
14	
15	
16	def sample_config() -> int:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/try_repo.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        with open(config_filename, 'w') as cfg:
69	            cfg.write(config_s)
70	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/try_repo.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
68	        with open(config_filename, 'w') as cfg:
69	            cfg.write(config_s)
70	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/try_repo.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	        output.write_line('=' * 79)
74	        output.write(config_s)
75	        output.write_line('=' * 79)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/commands/try_repo.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
73	        output.write_line('=' * 79)
74	        output.write(config_s)
75	        output.write_line('=' * 79)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/git.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
118	    with open(os.path.join(get_git_dir('.'), 'MERGE_MSG'), 'rb') as f:
119	        merge_msg = f.read()
120	    merge_conflict_filenames = parse_merge_msg_for_conflicts(merge_msg)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/docker.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	        with open('/proc/1/cgroup', 'rb') as f:
23	            return b'docker' in f.read()
24	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/docker.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
105	    try:
106	        return ('-u', f'{os.getuid()}:{os.getgid()}')
107	    except AttributeError:

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/docker.py:106
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
105	    try:
106	        return ('-u', f'{os.getuid()}:{os.getgid()}')
107	    except AttributeError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/dotnet.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
43	        with open(nuget_config, 'w') as f:
44	            f.write(
45	                '<?xml version="1.0" encoding="utf-8"?>'
46	                '<configuration>'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/dotnet.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
43	        with open(nuget_config, 'w') as f:
44	            f.write(
45	                '<?xml version="1.0" encoding="utf-8"?>'
46	                '<configuration>'

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
58	    def _open_archive(bio: IO[bytes]) -> ContextManager[ExtractAll]:
59	        return tarfile.open(fileobj=bio)
60	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
91	        return version
92	    resp = urllib.request.urlopen('https://go.dev/dl/?mode=json')
93	    # TODO: 3.9+ .removeprefix('go')

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
91	        return version
92	    resp = urllib.request.urlopen('https://go.dev/dl/?mode=json')
93	    # TODO: 3.9+ .removeprefix('go')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	        return version
92	    resp = urllib.request.urlopen('https://go.dev/dl/?mode=json')
93	    # TODO: 3.9+ .removeprefix('go')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
97	def _get_url(version: str) -> str:
98	    os_name = platform.system().lower()
99	    version = _infer_go_version(version)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
97	def _get_url(version: str) -> str:
98	    os_name = platform.system().lower()
99	    version = _infer_go_version(version)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:98
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
97	def _get_url(version: str) -> str:
98	    os_name = platform.system().lower()
99	    version = _infer_go_version(version)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	    version = _infer_go_version(version)
100	    return f'https://dl.google.com/go/go{version}.{os_name}-{_ARCH}.{_EXT}'
101	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
104	    try:
105	        resp = urllib.request.urlopen(_get_url(version))
106	    except urllib.error.HTTPError as e:  # pragma: no cover

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
104	    try:
105	        resp = urllib.request.urlopen(_get_url(version))
106	    except urllib.error.HTTPError as e:  # pragma: no cover

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
109	                f'Could not find a version matching your system requirements '
110	                f'(os={platform.system().lower()}; arch={_ARCH})',
111	            ) from e

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
109	                f'Could not find a version matching your system requirements '
110	                f'(os={platform.system().lower()}; arch={_ARCH})',
111	            ) from e

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:110
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
109	                f'Could not find a version matching your system requirements '
110	                f'(os={platform.system().lower()}; arch={_ARCH})',
111	            ) from e

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/golang.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
161	    if os.path.exists(pkgdir):  # pragma: no branch (always true on windows?)
162	        rmtree(pkgdir)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/r.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
118	        with open(fname, 'w') as f:
119	            f.write(_inline_r_setup(textwrap.dedent(code)))
120	        yield fname

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/r.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
118	        with open(fname, 'w') as f:
119	            f.write(_inline_r_setup(textwrap.dedent(code)))
120	        yield fname

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/r.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
201	
202	    r_code_inst_environment = f"""\
203	        prefix_dir <- {prefix.prefix_dir!r}
204	        options(

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/ruby.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
28	    files = importlib.resources.files('pre_commit.resources')
29	    return files.joinpath(filename).open('rb')
30	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/ruby.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
83	    with _resource_bytesio(filename) as bio:
84	        with tarfile.open(fileobj=bio) as tf:
85	            tf.extractall(dest)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/rust.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	                if sys.platform == 'win32':  # pragma: win32 cover
90	                    url = 'https://win.rustup.rs/x86_64'
91	                else:  # pragma: win32 no cover

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/rust.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	                else:  # pragma: win32 no cover
92	                    url = 'https://sh.rustup.rs'
93	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/languages/rust.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
93	
94	                resp = urllib.request.urlopen(url)
95	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/repository.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
101	        with open(staging, 'w') as state_file:
102	            state_file.write(json.dumps(_state(hook.additional_dependencies)))
103	        # Move the file into place atomically to indicate we've installed

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/staged_files_only.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
74	        with open(patch_filename, 'wb') as patch_file:
75	            patch_file.write(diff_stdout)
76	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/store.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	        with open(target_file, 'w') as f:
57	            f.write(contents)
58	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/store.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
56	        with open(target_file, 'w') as f:
57	            f.write(contents)
58	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/store.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	            with open(os.path.join(self.directory, 'README'), 'w') as f:
74	                f.write(
75	                    'This directory is maintained by the pre-commit project.\n'
76	                    'Learn more: https://github.com/pre-commit/pre-commit\n',

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/store.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
73	            with open(os.path.join(self.directory, 'README'), 'w') as f:
74	                f.write(
75	                    'This directory is maintained by the pre-commit project.\n'
76	                    'Learn more: https://github.com/pre-commit/pre-commit\n',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/store.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	                f.write(
75	                    'This directory is maintained by the pre-commit project.\n'
76	                    'Learn more: https://github.com/pre-commit/pre-commit\n',
77	                )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/util.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
33	        if os.path.exists(path):
34	            rmtree(path)
35	        raise

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/util.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
45	    new_mode = original_mode | stat.S_IXUSR | stat.S_IXGRP | stat.S_IXOTH
46	    os.chmod(filename, new_mode)
47	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/util.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
45	    new_mode = original_mode | stat.S_IXUSR | stat.S_IXGRP | stat.S_IXOTH
46	    os.chmod(filename, new_mode)
47	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/util.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
188	                try:
189	                    bts = os.read(pty.r, 4096)
190	                except OSError as e:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/util.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
215	        for p in (path, os.path.dirname(path)):
216	            os.chmod(p, os.stat(p).st_mode | stat.S_IWUSR)
217	        func(path)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/util.py:216
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
215	        for p in (path, os.path.dirname(path)):
216	            os.chmod(p, os.stat(p).st_mode | stat.S_IWUSR)
217	        func(path)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/util.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
230	    def rmtree(path: str) -> None:
231	        shutil.rmtree(path, ignore_errors=False, onerror=_handle_readonly_old)
232	else:  # pragma: >=3.12 cover

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/util.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
234	        """On windows, rmtree fails for readonly dirs."""
235	        shutil.rmtree(path, ignore_errors=False, onexc=_handle_readonly)
236	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pre_commit-4.2.0/pre_commit-4.2.0/pre_commit/xargs.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
126	    else:
127	        with concurrent.futures.ThreadPoolExecutor(maxsize) as ex:
128	            yield ex.map

--------------------------------------------------

Code scanned:
	Total lines of code: 5437
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 55.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 64.0
		High: 5.0
Files skipped (0):
