Run started:2025-04-12 18:18:04.691819

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/setup.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    license='APACHE',
41	    url='https://github.com/RobertCraigie/prisma-client-py',
42	    description='Prisma Client Python is an auto-generated and fully type-safe database client',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/setup.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	    project_urls={
67	        'Documentation': 'https://prisma-client-py.readthedocs.io',
68	        'Source': 'https://github.com/RobertCraigie/prisma-client-py',
69	        'Tracker': 'https://github.com/RobertCraigie/prisma-client-py/issues',
70	    },
71	    keywords=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/setup.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	        'Documentation': 'https://prisma-client-py.readthedocs.io',
68	        'Source': 'https://github.com/RobertCraigie/prisma-client-py',
69	        'Tracker': 'https://github.com/RobertCraigie/prisma-client-py/issues',
70	    },
71	    keywords=[
72	        'orm',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/setup.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	        'Source': 'https://github.com/RobertCraigie/prisma-client-py',
69	        'Tracker': 'https://github.com/RobertCraigie/prisma-client-py/issues',
70	    },
71	    keywords=[
72	        'orm',
73	        'mysql',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/__init__.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	                    raise RuntimeError(
54	                        "The Client hasn't been generated yet, "
55	                        'you must run `prisma generate` before you can use the client.\n'
56	                        'See https://prisma-client-py.readthedocs.io/en/stable/reference/troubleshooting/#client-has-not-been-generated-yet'

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/_async_http.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
25	    async def request(self, method: Method, url: str, **kwargs: Any) -> 'Response':
26	        return Response(await self.session.request(method, url, **kwargs))
27	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/_fields.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
100	        """Encode bytes into valid Base64"""
101	        return cls(base64.b64encode(value))
102	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/_fields.py:101
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
100	        """Encode bytes into valid Base64"""
101	        return cls(base64.b64encode(value))
102	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/_fields.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
115	        """Decode from Base64 to the original bytes object"""
116	        return base64.b64decode(self._raw)
117	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/_fields.py:116
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
115	        """Decode from Base64 to the original bytes object"""
116	        return base64.b64decode(self._raw)
117	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/_sync_http.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
24	    def request(self, method: Method, url: str, **kwargs: Any) -> 'Response':
25	        return Response(self.session.request(method, url, **kwargs))
26	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/_vendor/lark_schema_parser.py:3032
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
3031	                    try:
3032	                        username = getpass.getuser()
3033	                    except Exception:

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/_vendor/lark_schema_scan_parser.py:3032
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
3031	                    try:
3032	                        username = getpass.getuser()
3033	                    except Exception:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/binaries/platform.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
9	def name() -> str:
10	    return _platform.system().lower()
11	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/binaries/platform.py:10
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
9	def name() -> str:
10	    return _platform.system().lower()
11	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/cli/commands/fetch.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
17	    if force:
18	        shutil.rmtree(config.binary_cache_dir)
19	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_http.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
141	    ) -> Any:
142	        url, kwargs = self._build_request(
143	            path=path,
144	            method=method,
145	            content=content,
146	            headers=headers,
147	            parse_response=parse_response,
148	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_http.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
149	
150	        response = self.session.request(method, url, **kwargs)
151	        log.debug('%s %s returned status %s', method, url, response.status)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_http.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
208	    ) -> Any:
209	        url, kwargs = self._build_request(
210	            path=path,
211	            method=method,
212	            content=content,
213	            headers=headers,
214	            parse_response=parse_response,
215	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_http.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
216	
217	        response = await self.session.request(method, url, **kwargs)
218	        log.debug('%s %s returned status %s', method, url, response.status)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	
69	        self.url = f'http://localhost:{port}'
70	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
131	        else:
132	            self.process.send_signal(signal.SIGINT)
133	            try:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
135	            except subprocess.TimeoutExpired:
136	                self.process.send_signal(signal.SIGKILL)
137	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
207	            try:
208	                data = self.request('GET', '/status')
209	            except Exception as exc:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
241	
242	        return self.request(
243	            'POST',
244	            '/',
245	            content=content,
246	            headers=headers,
247	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
250	    def start_transaction(self, *, content: str) -> TransactionId:
251	        result = self.request(
252	            'POST',
253	            '/transaction/start',
254	            content=content,
255	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
259	    def commit_transaction(self, tx_id: TransactionId) -> None:
260	        self.request('POST', f'/transaction/{tx_id}/commit')
261	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
263	    def rollback_transaction(self, tx_id: TransactionId) -> None:
264	        self.request('POST', f'/transaction/{tx_id}/rollback')
265	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
293	
294	        return self.request(  # type: ignore[no-any-return]
295	            'GET',
296	            f'/metrics?format={format}',
297	            content=content,
298	            parse_response=format == 'json',
299	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
367	            try:
368	                data = await self.request('GET', '/status')
369	            except Exception as exc:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
401	
402	        return await self.request(
403	            'POST',
404	            '/',
405	            content=content,
406	            headers=headers,
407	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
410	    async def start_transaction(self, *, content: str) -> TransactionId:
411	        result = await self.request(
412	            'POST',
413	            '/transaction/start',
414	            content=content,
415	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
419	    async def commit_transaction(self, tx_id: TransactionId) -> None:
420	        await self.request('POST', f'/transaction/{tx_id}/commit')
421	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
423	    async def rollback_transaction(self, tx_id: TransactionId) -> None:
424	        await self.request('POST', f'/transaction/{tx_id}/rollback')
425	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/_query.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
453	
454	        return await self.request(  # type: ignore[no-any-return]
455	            'GET',
456	            f'/metrics?format={format}',
457	            content=content,
458	            parse_response=format == 'json',
459	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/errors.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	            (
70	                'Error occurred, '
71	                'it is likely that the internal GraphQL query '
72	                'builder generated a malformed request.\n'
73	                'Please create an issue at https://github.com/RobertCraigie/prisma-client-py/issues'
74	            ),

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/utils.py:133
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
132	def get_open_port() -> int:
133	    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
134	    sock.bind(('', 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/engine/utils.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
135	    port = sock.getsockname()[1]
136	    sock.close()
137	    return int(port)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/errors.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
171	        super().__init__(
172	            f'Cannot use {typ} as a list yet; Please create a '
173	            'feature request at https://github.com/RobertCraigie/prisma-client-py/issues/new'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/generator/generator.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
302	    with path.open('w') as file:
303	        file.write(output)
304	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/generator/models.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	
96	RECURSIVE_TYPE_DEPTH_WARNING_DESC = """
97	generator client {
98	  provider             = "prisma-client-py"
99	  recursive_type_depth = -1
100	}
101	
102	If you need to use Mypy, you can also disable this message by explicitly setting the default value:
103	
104	generator client {
105	  provider             = "prisma-client-py"
106	  recursive_type_depth = 5
107	}
108	
109	For more information see: https://prisma-client-py.readthedocs.io/en/stable/reference/limitations/#default-type-limitations
110	"""
111	
112	FAKER: Faker = Faker()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/generator/models.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
663	            raise ValueError(
664	                'Composite types are not supported yet. Please indicate you need this here: https://github.com/RobertCraigie/prisma-client-py/issues/314'
665	            )
666	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/generator/models.py:903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
902	                raise ValueError(
903	                    'Support for the Decimal type is experimental\n'
904	                    '  As such you must set the `enable_experimental_decimal` config flag to true\n'
905	                    '  for more information see: https://github.com/RobertCraigie/prisma-client-py/issues/106'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prisma-0.15.0/prisma-0.15.0/src/prisma/mypy.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
377	def error_unable_to_parse(api: CheckerPluginInterface, context: Context, detail: str) -> None:
378	    link = 'https://github.com/RobertCraigie/prisma-client-py/issues/new/choose'
379	    full_message = f'The prisma mypy plugin was unable to parse: {detail}\n'

--------------------------------------------------

Code scanned:
	Total lines of code: 11196
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 26.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 38.0
		High: 6.0
Files skipped (0):
