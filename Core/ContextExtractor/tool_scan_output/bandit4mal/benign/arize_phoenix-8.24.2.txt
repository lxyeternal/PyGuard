Run started:2025-04-12 11:39:06.702197

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/__init__.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	        raise ImportError(
84	            "The legacy `phoenix.trace.openai` instrumentor module has been removed.\n"
85	            "Please use OpenInference to instrument the OpenAI SDK. Additionally, the "
86	            "`phoenix.otel` module can be used to quickly configure OpenTelemetry:\n\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/__init__.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	        raise ImportError(
108	            "The legacy `phoenix.trace.langchain` instrumentor module has been removed.\n"
109	            "Please use OpenInference to instrument the LangChain SDK. Additionally, the "
110	            "`phoenix.otel` module can be used to quickly configure OpenTelemetry:\n\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/__init__.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	        raise ImportError(
129	            "The legacy `phoenix.trace.llama_index` instrumentor module has been removed.\n"
130	            "Please use OpenInference to instrument the LlamaIndex SDK. Additionally, the "
131	            "`phoenix.otel` module can be used to quickly configure OpenTelemetry:\n\n"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/config.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
585	        parsed_oidc_config_url = urlparse(oidc_config_url)
586	        is_local_oidc_config_url = parsed_oidc_config_url.hostname in ("localhost", "127.0.0.1")
587	        if parsed_oidc_config_url.scheme != "https" and not is_local_oidc_config_url:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/config.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
621	SERVER_DIR = PHOENIX_DIR / "server"
622	HOST = "0.0.0.0"
623	"""The host the server will run on after launch_app is called."""

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/config.py:931
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
930	    host = get_env_host()
931	    if host == "0.0.0.0":
932	        host = "127.0.0.1"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/config.py:932
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
931	    if host == "0.0.0.0":
932	        host = "127.0.0.1"
933	    return URL(urljoin(f"http://{host}:{get_env_port()}", get_env_host_root_path()))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/config.py:939
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
938	    host = get_env_host()
939	    if host == "0.0.0.0":
940	        host = "127.0.0.1"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/config.py:940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
939	    if host == "0.0.0.0":
940	        host = "127.0.0.1"
941	    base_url = get_env_collector_endpoint() or f"http://{host}:{get_env_port()}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/db/engines.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	        )
147	        migrate_in_thread(sync_engine)
148	    return engine

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/db/engines.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
179	        event.listen(sync_engine, "connect", set_postgresql_search_path(schema))
180	    migrate_in_thread(sync_engine)
181	    return engine

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/inferences/fixtures.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
354	    name="wiki",
355	    description="""
356	    Semantic search dataset including queries, answers, retrievals and corpus
357	    documents. Queries are sampled from Googleâ€™s Natural Questions dataset
358	    https://ai.google.com/research/NaturalQuestions, and documents (paragraphs)
359	    are sampled from http://sbert.net/datasets/simplewiki-2020-11-01.jsonl.gz,
360	    based on the Simple English Wikipedia. Embeddings for both questions and
361	    documents are generated from the bi-encoder 'multi-qa-MiniLM-L6-cos-v1',
362	    which produces normalized vectors that are 384-dimensional. Given a query
363	    and its embedding, a small subset of documents are first retrieved based on
364	    cosine similarity search on the document embeddings, then relevance scores
365	    are computed on the retrieved documents using the cross-encoder
366	    'cross-encoder/ms-marco-MiniLM-L-12-v2'. Answers (to the queries) are
367	    generated from 'deepset/tinyroberta-squad2' using the most relevant
368	    documents as the context input.
369	
370	    References:
371	    - https://www.sbert.net/examples/applications/semantic-search/README.html
372	    - https://github.com/UKPLab/sentence-transformers/tree/master/examples/applications/retrieve_rerank
373	    - https://www.sbert.net/docs/pretrained_models.html
374	    - https://www.sbert.net/docs/pretrained_cross-encoders.html
375	    - https://ai.google.com/research/NaturalQuestions
376	    """,  # noqa: E501
377	    primary_schema=Schema(

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/inferences/fixtures.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
529	                    return data_file_path
530	        request.urlretrieve(self.mediaLink, data_file_path)
531	        with open(md5_file, "w") as f:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/inferences/fixtures.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
536	class GCSAssets(NamedTuple):
537	    host: str = "https://storage.googleapis.com/"
538	    bucket: str = "arize-assets"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/inferences/fixtures.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
545	        )
546	        resp = json.loads(request.urlopen(request.Request(url)).read())
547	        return Metadata(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/context.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
176	    def user(self) -> PhoenixUser:
177	        return cast(PhoenixUser, self.get_request().user)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/helpers/playground_clients.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
676	                raise BadRequest(
677	                    "Provide an API key for Azure OpenAI models or use azure-identity, see. e.g. "
678	                    "https://learn.microsoft.com/en-us/python/api/azure-identity/azure.identity.environmentcredential?view=azure-python"  # noqa: E501
679	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/helpers/playground_clients.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
683	                    DefaultAzureCredential(),
684	                    "https://cognitiveservices.azure.com/.default",
685	                ),
686	                azure_endpoint=endpoint,
687	                api_version=api_version,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/auth.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
124	        isinstance(
125	            refresh_token_claims := await token_store.read(Token(refresh_token)),
126	            RefreshTokenClaims,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/auth.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
147	    token_store: TokenStore = request.app.state.get_token_store()
148	    refresh_token_claims = await token_store.read(Token(refresh_token))
149	    if (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/auth.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
163	        and isinstance(
164	            access_token_claims := await token_store.read(Token(access_token)), AccessTokenClaims
165	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/auth.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
238	        not (token := data.get("token"))
239	        or not isinstance((claims := await token_store.read(token)), PasswordResetTokenClaims)
240	        or not claims.expiration_time

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/embeddings.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
14	
15	    @router.get("/exports")
16	    async def download_exported_file(request: Request, filename: str) -> FileResponse:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	
81	@router.get(
82	    "/datasets",
83	    operation_id="listDatasets",
84	    summary="List datasets",
85	    responses=add_errors_to_responses([HTTP_422_UNPROCESSABLE_ENTITY]),
86	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190	
191	@router.get(
192	    "/datasets/{id}",
193	    operation_id="getDataset",
194	    summary="Get dataset by ID",
195	    responses=add_errors_to_responses([HTTP_404_NOT_FOUND]),
196	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
242	
243	@router.get(
244	    "/datasets/{id}/versions",
245	    operation_id="listDatasetVersionsByDatasetId",
246	    summary="List dataset versions",
247	    responses=add_errors_to_responses([HTTP_422_UNPROCESSABLE_ENTITY]),
248	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
439	            if file_content_type is FileContentType.CSV:
440	                encoding = FileContentEncoding(file.headers.get("content-encoding"))
441	                examples = await _process_csv(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
319	
320	@router.post(
321	    "/datasets/upload",
322	    operation_id="uploadDataset",
323	    summary="Upload dataset from JSON, CSV, or PyArrow",
324	    responses=add_errors_to_responses(
325	        [
326	            {
327	                "status_code": HTTP_409_CONFLICT,
328	                "description": "Dataset of the same name already exists",
329	            },
330	            {"status_code": HTTP_422_UNPROCESSABLE_ENTITY, "description": "Invalid request body"},
331	        ]
332	    ),
333	    # FastAPI cannot generate the request body portion of the OpenAPI schema for
334	    # routes that accept multiple request content types, so we have to provide
335	    # this part of the schema manually. For context, see
336	    # https://github.com/tiangolo/fastapi/discussions/7786 and
337	    # https://github.com/tiangolo/fastapi/issues/990
338	    openapi_extra={
339	        "requestBody": {
340	            "content": {
341	                "application/json": {
342	                    "schema": {
343	                        "type": "object",
344	                        "required": ["name", "inputs"],
345	                        "properties": {
346	                            "action": {"type": "string", "enum": ["create", "append"]},
347	                            "name": {"type": "string"},
348	                            "description": {"type": "string"},
349	                            "inputs": {"type": "array", "items": {"type": "object"}},
350	                            "outputs": {"type": "array", "items": {"type": "object"}},
351	                            "metadata": {"type": "array", "items": {"type": "object"}},
352	                        },
353	                    }
354	                },
355	                "multipart/form-data": {
356	                    "schema": {
357	                        "type": "object",
358	                        "required": ["name", "input_keys[]", "output_keys[]", "file"],
359	                        "properties": {
360	                            "action": {"type": "string", "enum": ["create", "append"]},
361	                            "name": {"type": "string"},
362	                            "description": {"type": "string"},
363	                            "input_keys[]": {
364	                                "type": "array",
365	                                "items": {"type": "string"},
366	                                "uniqueItems": True,
367	                            },
368	                            "output_keys[]": {
369	                                "type": "array",
370	                                "items": {"type": "string"},
371	                                "uniqueItems": True,
372	                            },
373	                            "metadata_keys[]": {
374	                                "type": "array",
375	                                "items": {"type": "string"},
376	                                "uniqueItems": True,
377	                            },
378	                            "file": {"type": "string", "format": "binary"},
379	                        },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
520	) -> tuple[Examples, DatasetAction, Name, Description]:
521	    name = data.get("name")
522	    if not name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
523	        raise ValueError("Dataset name is required")
524	    description = data.get("description") or ""
525	    inputs = data.get("inputs")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
524	    description = data.get("description") or ""
525	    inputs = data.get("inputs")
526	    if not inputs:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
529	        raise ValueError("Input should be a list containing only dictionary objects")
530	    outputs, metadata = data.get("outputs"), data.get("metadata")
531	    for k, v in {"outputs": outputs, "metadata": metadata}.items():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
529	        raise ValueError("Input should be a list containing only dictionary objects")
530	    outputs, metadata = data.get("outputs"), data.get("metadata")
531	    for k, v in {"outputs": outputs, "metadata": metadata}.items():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
543	        examples.append(example)
544	    action = DatasetAction(cast(Optional[str], data.get("action")) or "create")
545	    return iter(examples), action, name, description

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
570	        ExampleContent(
571	            input={k: row.get(k) for k in input_keys},
572	            output={k: row.get(k) for k in output_keys},

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
571	            input={k: row.get(k) for k in input_keys},
572	            output={k: row.get(k) for k in output_keys},
573	            metadata={k: row.get(k) for k in metadata_keys},

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
572	            output={k: row.get(k) for k in output_keys},
573	            metadata={k: row.get(k) for k in metadata_keys},
574	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
594	            yield ExampleContent(
595	                input={k: row.get(k) for k in input_keys},
596	                output={k: row.get(k) for k in output_keys},

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
595	                input={k: row.get(k) for k in input_keys},
596	                output={k: row.get(k) for k in output_keys},
597	                metadata={k: row.get(k) for k in metadata_keys},

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
596	                output={k: row.get(k) for k in output_keys},
597	                metadata={k: row.get(k) for k in metadata_keys},
598	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
636	]:
637	    name = cast(Optional[str], form.get("name"))
638	    if not name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
639	        raise ValueError("Dataset name must not be empty")
640	    action = DatasetAction(cast(Optional[str], form.get("action")) or "create")
641	    file = form["file"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	        raise ValueError("Malformed file in form data.")
644	    description = cast(Optional[str], form.get("description")) or file.filename
645	    input_keys = frozenset(filter(bool, cast(list[str], form.getlist("input_keys[]"))))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
676	
677	@router.get(
678	    "/datasets/{id}/examples",
679	    operation_id="getDatasetExamples",
680	    summary="Get examples from a dataset",
681	    responses=add_errors_to_responses([HTTP_404_NOT_FOUND]),
682	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
789	
790	@router.get(
791	    "/datasets/{id}/csv",
792	    operation_id="getDatasetCsv",
793	    summary="Download dataset examples as CSV file",
794	    response_class=StreamingResponse,
795	    status_code=HTTP_200_OK,
796	    responses={
797	        **add_errors_to_responses([HTTP_422_UNPROCESSABLE_ENTITY]),
798	        **add_text_csv_content_to_responses(HTTP_200_OK),
799	    },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
828	
829	@router.get(
830	    "/datasets/{id}/jsonl/openai_ft",
831	    operation_id="getDatasetJSONLOpenAIFineTuning",
832	    summary="Download dataset examples as OpenAI fine-tuning JSONL file",
833	    response_class=PlainTextResponse,
834	    responses=add_errors_to_responses(
835	        [
836	            {
837	                "status_code": HTTP_422_UNPROCESSABLE_ENTITY,
838	                "description": "Invalid dataset or version ID",
839	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
865	
866	@router.get(
867	    "/datasets/{id}/jsonl/openai_evals",
868	    operation_id="getDatasetJSONLOpenAIEvals",
869	    summary="Download dataset examples as OpenAI evals JSONL file",
870	    response_class=PlainTextResponse,
871	    responses=add_errors_to_responses(
872	        [
873	            {
874	                "status_code": HTTP_422_UNPROCESSABLE_ENTITY,
875	                "description": "Invalid dataset or version ID",
876	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
921	    for ex in examples:
922	        input_messages = ex.input.get("messages", [])
923	        if not isinstance(input_messages, list):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:925
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
924	            input_messages = []
925	        output_messages = ex.output.get("messages", [])
926	        if not isinstance(output_messages, list):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
932	
933	        tools = ex.input.get("tools", [])
934	        if tools:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:951
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
950	                        "messages": ims
951	                        if isinstance(ims := ex.input.get("messages"), list)
952	                        else [],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:956
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
955	                        )
956	                        if isinstance(oms := ex.output.get("messages"), list)
957	                        and oms

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/datasets.py:954
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
953	                        "ideal": (
954	                            ideal if isinstance(ideal := last_message.get("content"), str) else ""
955	                        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/evaluations.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
45	
46	@router.post(
47	    "/evaluations",
48	    operation_id="addEvaluations",
49	    summary="Add span, trace, or document evaluations",
50	    status_code=HTTP_204_NO_CONTENT,
51	    responses=add_errors_to_responses(
52	        [
53	            {
54	                "status_code": HTTP_415_UNSUPPORTED_MEDIA_TYPE,
55	                "description": (
56	                    "Unsupported content type, "
57	                    "only gzipped protobuf and pandas-arrow are supported"
58	                ),
59	            },
60	            HTTP_422_UNPROCESSABLE_ENTITY,
61	        ]
62	    ),
63	    openapi_extra={
64	        "requestBody": {
65	            "required": True,
66	            "content": {
67	                "application/x-protobuf": {"schema": {"type": "string", "format": "binary"}},
68	                "application/x-pandas-arrow": {"schema": {"type": "string", "format": "binary"}},
69	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/evaluations.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	        project_name
125	        or request.query_params.get("project-name")  # for backward compatibility
126	        or request.headers.get("project-name")  # read from headers for backwards compatibility

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/evaluations.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	        or request.query_params.get("project-name")  # for backward compatibility
126	        or request.headers.get("project-name")  # read from headers for backwards compatibility
127	        or DEFAULT_PROJECT_NAME

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/evaluations.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	
107	@router.get(
108	    "/evaluations",
109	    operation_id="getEvaluations",
110	    summary="Get span, trace, or document evaluations from a project",
111	    responses=add_errors_to_responses([HTTP_404_NOT_FOUND]),
112	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/evaluations.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
250	    return (
251	        cast(Optional[float], row.get("score")),
252	        cast(Optional[str], row.get("label")),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/evaluations.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	        cast(Optional[float], row.get("score")),
252	        cast(Optional[str], row.get("label")),
253	        cast(Optional[str], row.get("explanation")),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/evaluations.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	        cast(Optional[str], row.get("label")),
253	        cast(Optional[str], row.get("explanation")),
254	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiment_evaluations.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	            end_time=datetime.fromisoformat(end_time),
100	            trace_id=payload.get("trace_id"),
101	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiment_evaluations.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
57	
58	@router.post(
59	    "/experiment_evaluations",
60	    operation_id="upsertExperimentEvaluation",
61	    summary="Create or update evaluation for an experiment run",
62	    responses=add_errors_to_responses(
63	        [{"status_code": HTTP_404_NOT_FOUND, "description": "Experiment run not found"}]
64	    ),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiment_runs.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
50	
51	@router.post(
52	    "/experiments/{experiment_id}/runs",
53	    operation_id="createExperimentRun",
54	    summary="Create run for an experiment",
55	    response_description="Experiment run created successfully",
56	    responses=add_errors_to_responses(
57	        [
58	            {
59	                "status_code": HTTP_404_NOT_FOUND,
60	                "description": "Experiment or dataset example not found",
61	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiment_runs.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	                    repetition_number=exp_run.repetition_number,
161	                    output=exp_run.output.get("task_output"),
162	                    error=exp_run.error,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiment_runs.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	
120	@router.get(
121	    "/experiments/{experiment_id}/runs",
122	    operation_id="listExperimentRuns",
123	    summary="List runs for an experiment",
124	    response_description="Experiment runs retrieved successfully",
125	    responses=add_errors_to_responses(
126	        [{"status_code": HTTP_404_NOT_FOUND, "description": "Experiment not found"}]
127	    ),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiments.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
86	
87	@router.post(
88	    "/datasets/{dataset_id}/experiments",
89	    operation_id="createExperiment",
90	    summary="Create experiment on a dataset",
91	    responses=add_errors_to_responses(
92	        [{"status_code": HTTP_404_NOT_FOUND, "description": "Dataset or DatasetVersion not found"}]
93	    ),
94	    response_description="Experiment retrieved successfully",
95	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiments.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	
216	@router.get(
217	    "/experiments/{experiment_id}",
218	    operation_id="getExperiment",
219	    summary="Get experiment by ID",
220	    responses=add_errors_to_responses(
221	        [{"status_code": HTTP_404_NOT_FOUND, "description": "Experiment not found"}]
222	    ),
223	    response_description="Experiment retrieved successfully",
224	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiments.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	
266	@router.get(
267	    "/datasets/{dataset_id}/experiments",
268	    operation_id="listExperiments",
269	    summary="List experiments by dataset",
270	    response_description="Experiments retrieved successfully",
271	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiments.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
318	) -> tuple[models.Experiment, tuple[models.ExperimentRun], tuple[models.DatasetExampleRevision]]:
319	    experiment = await session.get(models.Experiment, experiment_rowid)
320	    if not experiment:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiments.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
375	
376	@router.get(
377	    "/experiments/{experiment_id}/json",
378	    operation_id="getExperimentJSON",
379	    summary="Download experiment runs as a JSON file",
380	    response_class=PlainTextResponse,
381	    responses=add_errors_to_responses(
382	        [
383	            {"status_code": HTTP_404_NOT_FOUND, "description": "Experiment not found"},
384	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/experiments.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
447	
448	@router.get(
449	    "/experiments/{experiment_id}/csv",
450	    operation_id="getExperimentCSV",
451	    summary="Download experiment runs as a CSV file",
452	    responses={**add_text_csv_content_to_responses(HTTP_200_OK)},
453	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/projects.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	
65	@router.get(
66	    "/projects",
67	    operation_id="getProjects",
68	    summary="List all projects",  # noqa: E501
69	    description="Retrieve a paginated list of all projects in the system.",  # noqa: E501
70	    response_description="A list of projects with pagination information",  # noqa: E501
71	    responses=add_errors_to_responses(
72	        [
73	            HTTP_422_UNPROCESSABLE_ENTITY,
74	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/projects.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	
137	@router.get(
138	    "/projects/{project_identifier}",
139	    operation_id="getProject",
140	    summary="Get project by ID or name",  # noqa: E501
141	    description="Retrieve a specific project using its unique identifier: either project ID or project name. Note: When using a project name as the identifier, it cannot contain slash (/), question mark (?), or pound sign (#) characters.",  # noqa: E501
142	    response_description="The requested project",  # noqa: E501
143	    responses=add_errors_to_responses(
144	        [
145	            HTTP_404_NOT_FOUND,
146	            HTTP_422_UNPROCESSABLE_ENTITY,
147	        ]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/projects.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
175	
176	@router.post(
177	    "/projects",
178	    operation_id="createProject",
179	    summary="Create a new project",  # noqa: E501
180	    description="Create a new project with the specified configuration.",  # noqa: E501
181	    response_description="The newly created project",  # noqa: E501
182	    responses=add_errors_to_responses(
183	        [
184	            HTTP_422_UNPROCESSABLE_ENTITY,
185	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/projects.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
386	    else:
387	        project = await session.get(models.Project, id_)
388	        if project is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/prompts.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	
103	@router.get(
104	    "/prompts",
105	    operation_id="getPrompts",
106	    summary="List all prompts",
107	    description="Retrieve a paginated list of all prompts in the system. A prompt can have "
108	    "multiple versions.",
109	    response_description="A list of prompts with pagination information",
110	    responses=add_errors_to_responses(
111	        [
112	            HTTP_422_UNPROCESSABLE_ENTITY,
113	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/prompts.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	
176	@router.get(
177	    "/prompts/{prompt_identifier}/versions",
178	    operation_id="listPromptVersions",
179	    summary="List prompt versions",
180	    description="Retrieve all versions of a specific prompt with pagination support. Each prompt "
181	    "can have multiple versions with different configurations.",
182	    response_description="A list of prompt versions with pagination information",
183	    responses=add_errors_to_responses([HTTP_422_UNPROCESSABLE_ENTITY, HTTP_404_NOT_FOUND]),
184	    response_model_by_alias=True,
185	    response_model_exclude_defaults=True,
186	    response_model_exclude_unset=True,
187	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/prompts.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
289	    async with request.app.state.db() as session:
290	        prompt_version = await session.get(models.PromptVersion, id_)
291	        if prompt_version is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/prompts.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
247	
248	@router.get(
249	    "/prompt_versions/{prompt_version_id}",
250	    operation_id="getPromptVersionByPromptVersionId",
251	    summary="Get prompt version by ID",
252	    description="Retrieve a specific prompt version using its unique identifier. A prompt version "
253	    "contains the actual template and configuration.",
254	    response_description="The requested prompt version",
255	    responses=add_errors_to_responses(
256	        [
257	            HTTP_404_NOT_FOUND,
258	            HTTP_422_UNPROCESSABLE_ENTITY,
259	        ]
260	    ),
261	    response_model_by_alias=True,
262	    response_model_exclude_defaults=True,
263	    response_model_exclude_unset=True,
264	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/prompts.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
296	
297	@router.get(
298	    "/prompts/{prompt_identifier}/tags/{tag_name}",
299	    operation_id="getPromptVersionByTagName",
300	    summary="Get prompt version by tag",
301	    description="Retrieve a specific prompt version using its tag name. Tags are used to identify "
302	    "specific versions of a prompt.",
303	    response_description="The prompt version with the specified tag",
304	    responses=add_errors_to_responses(
305	        [
306	            HTTP_404_NOT_FOUND,
307	            HTTP_422_UNPROCESSABLE_ENTITY,
308	        ]
309	    ),
310	    response_model_by_alias=True,
311	    response_model_exclude_unset=True,
312	    response_model_exclude_defaults=True,
313	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/prompts.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
350	
351	@router.get(
352	    "/prompts/{prompt_identifier}/latest",
353	    operation_id="getPromptVersionLatest",
354	    summary="Get latest prompt version",
355	    description="Retrieve the most recent version of a specific prompt.",
356	    response_description="The latest version of the specified prompt",
357	    responses=add_errors_to_responses(
358	        [
359	            HTTP_404_NOT_FOUND,
360	            HTTP_422_UNPROCESSABLE_ENTITY,
361	        ]
362	    ),
363	    response_model_by_alias=True,
364	    response_model_exclude_defaults=True,
365	    response_model_exclude_unset=True,
366	)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/prompts.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
393	
394	@router.post(
395	    "/prompts",
396	    operation_id="postPromptVersion",
397	    summary="Create a new prompt",
398	    description="Create a new prompt and its initial version. A prompt can have multiple versions.",
399	    response_description="The newly created prompt version",
400	    responses=add_errors_to_responses(
401	        [
402	            HTTP_422_UNPROCESSABLE_ENTITY,
403	        ]
404	    ),
405	    response_model_by_alias=True,
406	    response_model_exclude_defaults=True,
407	    response_model_exclude_unset=True,
408	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/prompts.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
487	
488	@router.get(
489	    "/prompt_versions/{prompt_version_id}/tags",
490	    operation_id="getPromptVersionTags",
491	    summary="List prompt version tags",
492	    description="Retrieve all tags associated with a specific prompt version. Tags are used to "
493	    "identify and categorize different versions of a prompt.",
494	    response_description="A list of tags associated with the prompt version",
495	    responses=add_errors_to_responses(
496	        [
497	            HTTP_404_NOT_FOUND,
498	            HTTP_422_UNPROCESSABLE_ENTITY,
499	        ]
500	    ),
501	    response_model_by_alias=True,
502	    response_model_exclude_defaults=True,
503	    response_model_exclude_unset=True,
504	)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/prompts.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
602	
603	@router.post(
604	    "/prompt_versions/{prompt_version_id}/tags",
605	    operation_id="createPromptVersionTag",
606	    summary="Add tag to prompt version",
607	    description="Add a new tag to a specific prompt version. Tags help identify and categorize "
608	    "different versions of a prompt.",
609	    response_description="No content returned on successful tag creation",
610	    status_code=HTTP_204_NO_CONTENT,
611	    responses=add_errors_to_responses(
612	        [
613	            HTTP_404_NOT_FOUND,
614	            HTTP_422_UNPROCESSABLE_ENTITY,
615	        ]
616	    ),
617	    response_model_by_alias=True,
618	    response_model_exclude_defaults=True,
619	    response_model_exclude_unset=True,
620	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/spans.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
86	        project_name
87	        or request.query_params.get("project-name")  # for backward compatibility
88	        or request.headers.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/spans.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	        or request.query_params.get("project-name")  # for backward compatibility
88	        or request.headers.get(
89	            "project-name"
90	        )  # read from headers/payload for backward-compatibility
91	        or request_body.project_name

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/spans.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
68	# TODO: Add property details to SpanQuery schema
69	@router.post(
70	    "/spans",
71	    operation_id="querySpans",
72	    summary="Query spans with query DSL",
73	    responses=add_errors_to_responses([HTTP_404_NOT_FOUND, HTTP_422_UNPROCESSABLE_ENTITY]),
74	    include_in_schema=False,
75	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/spans.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	
153	@router.get("/spans", include_in_schema=False, deprecated=True)
154	async def get_spans_handler(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/spans.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
210	
211	@router.post(
212	    "/span_annotations",
213	    operation_id="annotateSpans",
214	    summary="Create or update span annotations",
215	    responses=add_errors_to_responses(
216	        [{"status_code": HTTP_404_NOT_FOUND, "description": "Span not found"}]
217	    ),
218	    response_description="Span annotations inserted successfully",
219	    include_in_schema=True,
220	)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/traces.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
38	
39	@router.post(
40	    "/traces",
41	    operation_id="addTraces",
42	    summary="Send traces",
43	    responses=add_errors_to_responses(
44	        [
45	            {
46	                "status_code": HTTP_415_UNSUPPORTED_MEDIA_TYPE,
47	                "description": (
48	                    "Unsupported content type (only `application/x-protobuf` is supported)"
49	                ),
50	            },
51	            {"status_code": HTTP_422_UNPROCESSABLE_ENTITY, "description": "Invalid request body"},
52	        ]
53	    ),
54	    openapi_extra={
55	        "requestBody": {
56	            "required": True,
57	            "content": {
58	                "application/x-protobuf": {"schema": {"type": "string", "format": "binary"}}
59	            },
60	        }
61	    },
62	    include_in_schema=False,
63	)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/routers/v1/traces.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
143	
144	@router.post(
145	    "/trace_annotations",
146	    operation_id="annotateTraces",
147	    summary="Create or update trace annotations",
148	    responses=add_errors_to_responses(
149	        [{"status_code": HTTP_404_NOT_FOUND, "description": "Trace not found"}]
150	    ),
151	    include_in_schema=False,
152	)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/types/pagination.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
119	            cursor_parts.extend([sort_column.type.name, str(sort_column)])
120	        return base64.b64encode(self._DELIMITER.join(cursor_parts).encode()).decode()
121	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/types/pagination.py:120
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
119	            cursor_parts.extend([sort_column.type.name, str(sort_column)])
120	        return base64.b64encode(self._DELIMITER.join(cursor_parts).encode()).decode()
121	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/types/pagination.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
123	    def from_string(cls, cursor: str) -> "Cursor":
124	        decoded = base64.b64decode(cursor).decode()
125	        rowid_string = decoded

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/types/pagination.py:124
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
123	    def from_string(cls, cursor: str) -> "Cursor":
124	        decoded = base64.b64decode(cursor).decode()
125	        rowid_string = decoded

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/types/pagination.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
142	    """
143	    return base64.b64encode(f"{CURSOR_PREFIX}{offset}".encode("utf-8")).decode()
144	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/types/pagination.py:143
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
142	    """
143	    return base64.b64encode(f"{CURSOR_PREFIX}{offset}".encode("utf-8")).decode()
144	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/types/pagination.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
149	    """
150	    prefix, offset = base64.b64decode(cursor).decode().split(":")
151	    return int(offset)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/api/types/pagination.py:150
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
149	    """
150	    prefix, offset = base64.b64decode(cursor).decode().split(":")
151	    return int(offset)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/app.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	                    "n_samples": self._app_config.n_samples,
254	                    "basename": self._sanitize_basename(request.scope.get("root_path", "")),
255	                    "platform_version": phoenix_version,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/app.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
280	        for key in "origin", "referer":
281	            if not (url := headers.get(key)):
282	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/app.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
337	
338	@router.get("/arize_phoenix_version")
339	async def version() -> PlainTextResponse:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/app.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
535	
536	@router.get("/healthz")
537	async def check_healthz(_: Request) -> PlainTextResponse:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/app.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
685	        msg = (
686	            "\n\nâš ï¸âš ï¸ Phoenix failed to migrate the database to the latest version. âš ï¸âš ï¸\n\n"
687	            "The database may be in a dirty state. To resolve this, the Alembic CLI can be used\n"
688	            "from the `src/phoenix/db` directory inside the Phoenix project root. From here,\n"
689	            "revert any partial migrations and run `alembic stamp` to reset the migration state,\n"
690	            "then try starting Phoenix again.\n\n"
691	            "If issues persist, please reach out for support in the Arize community Slack:\n"
692	            "https://arize-ai.slack.com\n\n"
693	            "You can also refer to the Alembic documentation for more information:\n"
694	            "https://alembic.sqlalchemy.org/en/latest/tutorial.html\n\n"
695	            ""
696	        )
697	        raise PhoenixMigrationError(msg) from e
698	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/bearer_auth.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	    ) -> Optional[tuple[AuthCredentials, BaseUser]]:
49	        if header := conn.headers.get("Authorization"):
50	            scheme, _, token = header.partition(" ")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/bearer_auth.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	                return None
53	        elif access_token := conn.cookies.get(PHOENIX_ACCESS_TOKEN_COOKIE_NAME):
54	            token = access_token

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/main.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	
80	_WELCOME_MESSAGE = Environment(loader=BaseLoader()).from_string("""
81	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/main.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
334	        if not read_only:
335	            Thread(
336	                target=send_dataset_fixtures,
337	                args=(f"http://{host}:{port}", dataset_fixtures),
338	            ).start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/main.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
430	    server = Server(config=Config(app, host=host, port=port, root_path=host_root_path))  # type: ignore
431	    Thread(target=_write_pid_file_when_ready, args=(server,), daemon=True).start()
432	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/prometheus.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
98	def start_prometheus() -> None:
99	    Thread(target=gather_system_data, daemon=True).start()
100	    start_http_server(9090, addr="::")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/prometheus.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
123	                with open(cgroup_v2_file, "r") as f:
124	                    return int(f.read().strip())
125	            except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/prometheus.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	                with open(cgroup_v1_file, "r") as f:
130	                    return int(f.read().strip())
131	            except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/prometheus.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
144	                with open(cgroup_v2_swap_file, "r") as f:
145	                    return int(f.read().strip())
146	            except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/prometheus.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	                with open(cgroup_v1_swap_file, "r") as f:
151	                    return int(f.read().strip())
152	            except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/prometheus.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
196	                with open(cgroup_v1_cpu_usage, "r") as f:
197	                    usage = int(f.read().strip())
198	                key = "cgroup_v1"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/server/telemetry.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        logger.warning(
22	            "HTTP collector endpoint should include the protocol (http:// or https://)."
23	            "Assuming http."
24	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/client.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
82	        host = get_env_host()
83	        if host == "0.0.0.0":
84	            host = "127.0.0.1"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/client.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
83	        if host == "0.0.0.0":
84	            host = "127.0.0.1"
85	        base_url = endpoint or get_env_collector_endpoint() or f"http://{host}:{get_env_port()}"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/client.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
819	    with open(path, "rb") as f:
820	        file.write(gzip.compress(f.read()))
821	    return path.name, file, "text/csv", {"Content-Encoding": "gzip"}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/client.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
819	    with open(path, "rb") as f:
820	        file.write(gzip.compress(f.read()))
821	    return path.name, file, "text/csv", {"Content-Encoding": "gzip"}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/evaluation.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
144	    host = host or get_env_host()
145	    if host == "0.0.0.0":
146	        host = "127.0.0.1"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/evaluation.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
145	    if host == "0.0.0.0":
146	        host = "127.0.0.1"
147	    port = port or get_env_port()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/session.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
136	        self.root_path = _get_root_path(self.notebook_env, self.port)
137	        host = "127.0.0.1" if self.host == "0.0.0.0" else self.host
138	        self._client = Client(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/session.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
136	        self.root_path = _get_root_path(self.notebook_env, self.port)
137	        host = "127.0.0.1" if self.host == "0.0.0.0" else self.host
138	        self._client = Client(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/session.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
393	        )
394	        self.server = ThreadServer(
395	            app=self.app,
396	            host=self.host,
397	            port=self.port,
398	            root_path=self.root_path,
399	        ).run_in_thread()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/session.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
407	    def end(self) -> None:
408	        self.server.close()
409	        self.temp_dir.cleanup()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/session.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
431	            )
432	        shutil.rmtree(directory)
433	    _session_working_dir = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/session.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
608	        logger.error(
609	            f"ðŸ’¥ Phoenix failed to start. Please try again (making sure that "
610	            f"port {port} is not occupied by another process) or file an issue "
611	            f"with us at https://github.com/Arize-ai/phoenix"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/session.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
618	        print(f"ðŸ’½ Your data is being persisted to {get_printable_db_url(database_url)}")
619	    print("ðŸ“– For more information on how to use Phoenix, check out https://docs.arize.com/phoenix")
620	    return _session

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/session.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
665	        return f"{_get_databricks_notebook_base_url(context)}/{port}/"
666	    if host == "0.0.0.0" or host == "127.0.0.1":
667	        # The app is running locally, so use localhost

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/session.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
665	        return f"{_get_databricks_notebook_base_url(context)}/{port}/"
666	    if host == "0.0.0.0" or host == "127.0.0.1":
667	        # The app is running locally, so use localhost

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/session/session.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
667	        # The app is running locally, so use localhost
668	        return f"http://localhost:{port}/"
669	    return f"http://{host}:{port}/"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/exporter.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
36	        host = get_env_host()
37	        if host == "0.0.0.0":
38	            host = "127.0.0.1"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/exporter.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
37	        if host == "0.0.0.0":
38	            host = "127.0.0.1"
39	        base_url = get_env_collector_endpoint() or f"http://{host}:{get_env_port()}"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/exporter.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
76	            or get_env_collector_endpoint()
77	            or f"http://{'127.0.0.1' if self._host == '0.0.0.0' else self._host}:{self._port}"
78	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/exporter.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
76	            or get_env_collector_endpoint()
77	            or f"http://{'127.0.0.1' if self._host == '0.0.0.0' else self._host}:{self._port}"
78	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/exporter.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	    def _start_consumer(self) -> None:
103	        Thread(
104	            target=MethodType(
105	                self.__class__._consume_items,
106	                weakref.proxy(self),
107	            ),
108	            daemon=True,
109	        ).start()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/fixtures.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
89	    def dataframe(self) -> pd.DataFrame:
90	        self.load()
91	        return cast(pd.DataFrame, self._df).copy(deep=False)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/fixtures.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
198	            name="ChatRAG-Bench: Hybrid Dialogue (samples)",
199	            description="https://huggingface.co/datasets/nvidia/ChatRAG-Bench/viewer/hybridial",
200	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/fixtures.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
205	            name="ChatRAG-Bench: SQA (samples)",
206	            description="https://huggingface.co/datasets/nvidia/ChatRAG-Bench/viewer/sqa",
207	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/fixtures.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	            name="ChatRAG-Bench: DoQA Cooking (samples)",
213	            description="https://huggingface.co/datasets/nvidia/ChatRAG-Bench/viewer/doqa_cooking",
214	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/fixtures.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	            name="ChatQA-Train: Synthetic ConvQA (samples)",
220	            description="https://huggingface.co/datasets/nvidia/ChatQA-Training-Data/viewer/synthetic_convqa",
221	        ),

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/fixtures.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
367	def get_dataset_fixtures(fixture_name: str) -> Iterable[DatasetFixture]:
368	    return (fixture.load() for fixture in get_trace_fixture_by_name(fixture_name).dataset_fixtures)
369	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/fixtures.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
470	    file_name: str,
471	    host: Optional[str] = "https://storage.googleapis.com/",
472	    bucket: Optional[str] = "arize-phoenix-assets",
473	    prefix: Optional[str] = "traces/",
474	) -> str:
475	    return f"{host}{bucket}/{prefix}{file_name}"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/trace/utils.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
21	
22	    with request.urlopen(url) as f:
23	        return cast(list[str], f.readlines())

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/utilities/client.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
75	    def request(self, *args: Any, **kwargs: Any) -> httpx.Response:
76	        response = super().request(*args, **kwargs)
77	        self._check_version(response)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arize_phoenix-8.24.2/arize_phoenix-8.24.2/src/phoenix/utilities/client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
135	    async def request(self, *args: Any, **kwargs: Any) -> httpx.Response:
136	        response = await super().request(*args, **kwargs)
137	        self._check_version(response)

--------------------------------------------------

Code scanned:
	Total lines of code: 41433
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 107.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 143.0
		High: 4.0
Files skipped (0):
