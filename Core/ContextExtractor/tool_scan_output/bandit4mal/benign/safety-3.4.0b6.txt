Run started:2025-04-12 13:20:04.223805

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/requirements.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
436	        """
437	        r = requests.get('https://pypi.org/pypi/{name}/{version}/json'.format(
438	            name=self.key,
439	            version=version
440	        ))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/requirements.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
436	        """
437	        r = requests.get('https://pypi.org/pypi/{name}/{version}/json'.format(
438	            name=self.key,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/requirements.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
443	
444	        for item in data.get("urls", {}):
445	            sha256 = item.get("digests", {}).get("sha256", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/requirements.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
444	        for item in data.get("urls", {}):
445	            sha256 = item.get("digests", {}).get("sha256", False)
446	            if sha256:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/requirements.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
444	        for item in data.get("urls", {}):
445	            sha256 = item.get("digests", {}).get("sha256", False)
446	            if sha256:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        if vuln['severity'] is not None:
40	            highest_base_score = max(highest_base_score, (vuln['severity'].get('cvssv3', {}) or {}).get('base_score', 10))
41	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        if vuln['severity'] is not None:
40	            highest_base_score = max(highest_base_score, (vuln['severity'].get('cvssv3', {}) or {}).get('base_score', 10))
41	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/utils.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	    changelog = fetch_changelog(pkg, remediation['version'], remediation['recommended_version'],
125	                                api_key=api_key, from_spec=remediation.get('requirement', {}).get('specifier', None))
126	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/utils.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	    changelog = fetch_changelog(pkg, remediation['version'], remediation['recommended_version'],
125	                                api_key=api_key, from_spec=remediation.get('requirement', {}).get('specifier', None))
126	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/utils.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	    changelog = fetch_changelog(pkg, remediation['version'], remediation['recommended_version'],
161	                                api_key=api_key, from_spec=remediation.get('requirement', {}).get('specifier', None))
162	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/utils.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	    changelog = fetch_changelog(pkg, remediation['version'], remediation['recommended_version'],
161	                                api_key=api_key, from_spec=remediation.get('requirement', {}).get('specifier', None))
162	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/utils.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
234	
235	    r = requests.get(
236	        "https://pyup.io/api/v1/changelogs/{}/".format(package),
237	        headers={"X-Api-Key": api_key}
238	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/utils.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
235	    r = requests.get(
236	        "https://pyup.io/api/v1/changelogs/{}/".format(package),
237	        headers={"X-Api-Key": api_key}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/utils.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	        if obj.report['report_meta']['scan_target'] != "files":
297	            click.secho("This report was generated against an environment, but this alert command requires "
298	                        "a scan report that was generated against a file. To learn more about the "
299	                        "`safety alert` command visit https://docs.pyup.io/docs/safety-2-alerts", fg='red')
300	            sys.exit(1)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/alerts/utils.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
309	
310	            obj.requirements_files[f] = open(f, "rb").read()
311	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/cli_utils.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	
56	    client_session.mount("https://pyup.io/static-s3/", S3PresignedAdapter())
57	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/constants.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	CLAIM_EMAIL_VERIFIED_API = "https://api.safetycli.com/email_verified"
18	CLAIM_EMAIL_VERIFIED_AUTH_SERVER = "email_verified"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/main.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
70	    config = configparser.ConfigParser()
71	    config.read(CONFIG)
72	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/main.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	    config = configparser.ConfigParser()
162	    config.read(AUTH_CONFIG_USER)
163	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/main.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	    config = configparser.ConfigParser()
182	    config.read(CONFIG)
183	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/main.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
227	    config = configparser.ConfigParser()
228	    config.read(CONFIG)
229	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/main.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
262	    with open(AUTH_CONFIG_USER, 'w') as configfile:
263	        config.write(configfile)
264	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/main.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
278	    config = configparser.ConfigParser()
279	    config.read(AUTH_CONFIG_USER)
280	    config['auth'] = {'access_token': access_token, 'id_token': id_token,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/main.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
283	    with open(AUTH_CONFIG_USER, 'w') as configfile:
284	        config.write(configfile)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/server.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
40	    for port in port_range:
41	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
42	            try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/server.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
42	            try:
43	                s.connect(("localhost", port))
44	                # If the connect succeeds, the port is already in use

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/server.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
253	            # Start a threaded HTTP server to handle the callback
254	            server = ThreadedHTTPServer((HOST, PORT), CallbackHandler)
255	            server.initial_state = initial_state

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
58	    if "jwks_uri" in openid_config:
59	        return client_session.get(url=openid_config["jwks_uri"], bearer=False).json()
60	    return None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	    try:
94	        detail = response.json().get("detail")
95	    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	                data = r.json()
143	                reason = data.get("detail", "Unable to find reason.")
144	                error_code = data.get("error_code", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	                reason = data.get("detail", "Unable to find reason.")
144	                error_code = data.get("error_code", None)
145	            except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
328	
329	        r = self.get(url=USER_INFO_ENDPOINT)
330	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
363	
364	        r = self.post(url=PLATFORM_API_PROJECT_CHECK_ENDPOINT, json=data)
365	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
380	
381	        return self.get(url=PLATFORM_API_PROJECT_ENDPOINT, params=data)
382	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
403	
404	        return self.get(url=PLATFORM_API_POLICY_ENDPOINT, params=data)
405	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
418	
419	        return self.post(url=PLATFORM_API_PROJECT_SCAN_REQUEST_ENDPOINT, json=data)
420	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
432	
433	        return self.post(
434	            url=PLATFORM_API_PROJECT_UPLOAD_SCAN_ENDPOINT,
435	            data=json_report,
436	            headers={"Content-Type": "application/json"},
437	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
446	        """
447	        return self.post(
448	            url=PLATFORM_API_REQUIREMENTS_UPLOAD_SCAN_ENDPOINT,
449	            data=json.dumps(json_payload),
450	            headers={"Content-Type": "application/json"},
451	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
485	
486	        return self.get(url=PLATFORM_API_CHECK_UPDATES_ENDPOINT, params=data)
487	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
496	        try:
497	            response = self.get(
498	                url=PLATFORM_API_INITIALIZE_ENDPOINT,
499	                headers={"Content-Type": "application/json"},
500	                timeout=5,
501	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/auth/utils.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
675	        for feature in FeatureType:
676	            server_value = str_to_bool(settings.get(feature.config_key))
677	            if server_value is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	        # Test network speed (download speed)
134	        test_url = "https://data.safetycli.com/api/v1/safety/announcements/"  # Test the download speed
135	        start_time = time.perf_counter()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	        try:
137	            response = requests.get(test_url, timeout=10)
138	            end_time = time.perf_counter()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
206	        config = configparser.ConfigParser()
207	        config.read(CONFIG_FILE_USER)
208	        LOG.debug("Config file contents:")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
609	        not sys.stdout.isatty()
610	        and os.environ.get("SAFETY_OS_DESCRIPTION", None) != "run"
611	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:945
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
944	                            and vuln.severity.cvssv3
945	                            and vuln.severity.cvssv3.get(
946	                                "base_severity", "none"
947	                            ).lower()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:1194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1193	
1194	    config.read(CONFIG_FILE)
1195	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1235	        with open(CONFIG_FILE, "w") as configfile:
1236	            config.write(configfile)
1237	    except Exception as e:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:1301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1300	    PYTHON_VERSION = platform.python_version()
1301	    OS_TYPE = platform.system()
1302	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:1301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
1300	    PYTHON_VERSION = platform.python_version()
1301	    OS_TYPE = platform.system()
1302	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:1301
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
1300	    PYTHON_VERSION = platform.python_version()
1301	    OS_TYPE = platform.system()
1302	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:1350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1349	
1350	    organization = data.get("organization", "-")
1351	    account = data.get("user_email", "-")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:1351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1350	    organization = data.get("organization", "-")
1351	    account = data.get("user_email", "-")
1352	    current_version = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:1355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1354	    )
1355	    latest_available_version = data.get("safety_updates", {}).get("stable_version", "-")
1356	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/cli.py:1355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1354	    )
1355	    latest_available_version = data.get("safety_updates", {}).get("stable_version", "-")
1356	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/constants.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	OPEN_MIRRORS = [
12	    f"https://pyup.io/aws/safety/free/{JSON_SCHEMA_VERSION}/",
13	]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/constants.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	class URLSettings(Enum):
82	    PLATFORM_API_BASE_URL = f"https://platform.{DEFAULT_DOMAIN}/cli/api/v1"
83	    DATA_API_BASE_URL = f"https://data.{DEFAULT_DOMAIN}/api/v1/safety/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/constants.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	    PLATFORM_API_BASE_URL = f"https://platform.{DEFAULT_DOMAIN}/cli/api/v1"
83	    DATA_API_BASE_URL = f"https://data.{DEFAULT_DOMAIN}/api/v1/safety/"
84	    CLIENT_ID = "AWnwFBMr9DdZbxbDwYxjm4Gb24pFTnMp"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/constants.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	    CLIENT_ID = "AWnwFBMr9DdZbxbDwYxjm4Gb24pFTnMp"
85	    AUTH_SERVER_URL = f"https://auth.{DEFAULT_DOMAIN}"
86	    SAFETY_PLATFORM_URL = f"https://platform.{DEFAULT_DOMAIN}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/constants.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	    AUTH_SERVER_URL = f"https://auth.{DEFAULT_DOMAIN}"
86	    SAFETY_PLATFORM_URL = f"https://platform.{DEFAULT_DOMAIN}"
87	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/constants.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
127	    config = configparser.ConfigParser()
128	    config.read(CONFIG)
129	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/constants.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	IGNORE_UNPINNED_REQ_REASON = (
171	    "This vulnerability is being ignored due to the 'ignore-unpinned-requirements' flag (default True). "
172	    "To change this, set 'ignore-unpinned-requirements' to False under 'security' in your policy file. "
173	    "See https://docs.pyup.io/docs/safety-20-policy-file for more information."
174	)
175	
176	# REGEXES
177	HASH_REGEX_GROUPS = r"--hash[=| ](\w+):(\w+)"
178	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/constants.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
178	
179	DOCS_API_KEY_URL = "https://docs.safetycli.com/cli/api-keys"
180	MSG_NO_AUTHD_DEV_STG = "Please login or register Safety CLI [bold](free forever)[/bold] to scan and secure your projects with Safety"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/constants.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
204	
205	MSG_VERIFICATION_HINT = "Canâ€™t find the verification email? Login at [link]`https://platform.safetycli.com/login/`[/link] to resend the verification email"
206	
207	MSG_NO_VERIFIED_EMAIL_TPL = f"""Email verification is required for {{email}}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/errors.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	        self.credential = credential
190	        self.link = 'https://docs.safetycli.com/safety-docs/support/invalid-api-key-error'
191	        self.message = message.format(credential=f" '{self.credential}' ", link=self.link) if self.credential else message.format(credential=' ', link=self.link)

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/events/utils/context.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
27	    """
28	    return UserInfo(name=getpass.getuser(), home_dir=str(Path.home()))
29	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/events/utils/context.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
27	    """
28	    return UserInfo(name=getpass.getuser(), home_dir=str(Path.home()))
29	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/events/utils/context.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
38	        "architecture": platform.machine(),
39	        "platform": platform.system(),
40	        "name": None,

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/events/utils/context.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
38	        "architecture": platform.machine(),
39	        "platform": platform.system(),
40	        "name": None,

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/events/utils/context.py:39
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
38	        "architecture": platform.machine(),
39	        "platform": platform.system(),
40	        "name": None,

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/events/utils/context.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
75	    """
76	    hostname = socket.gethostname()
77	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/events/utils/context.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
75	    """
76	    hostname = socket.gethostname()
77	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/firewall/constants.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	MSG_UNINSTALL_SUCCESS = "Safety Firewall has been uninstalled from your machine. Note that your individual requirements files may still reference Safety Firewall. You can remove these references by removing the following line from your requirements files:"
3	MSG_REQ_FILE_LINE = "-i https://pkgs.safetycli.com/repository/public/pypi/simple/"
4	
5	MSG_FEEDBACK = "We're sorry to see you go. If you have any feedback on how we can do better, we'd love to hear it. Otherwise hit enter to exit."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/init/command.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
747	            MSG_COMPLETE_TOOL_SECURED.format(
748	                firewall_url="https://platform.safetycli.com/firewall/"
749	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/init/constants.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	MSG_SETUP_PACKAGE_FIREWALL_RESULT = "configured and secured. Safety will analyze package installations for security risks before installation, and warn you if you install vulnerable packages.\n"
43	MSG_SETUP_PACKAGE_FIREWALL_NOTE_STATUS = "To see your firewall status, usage and to configure your firewall security settings visit [link]https://platform.safetycli.com/firewall/[/link]"
44	
45	MSG_SETUP_CODEBASE_TITLE = " Secure Your First Codebase"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/init/constants.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	MSG_HELP = "ğŸ’¬ Need help or want to give feedback? [link]support@safetycli.com[/link] (we normally respond within 4 hours)"
77	MSG_DOCS = "ğŸ“š Read the docs: [link]https://docs.safetycli.com[/link]"
78	MSG_TEAM = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/init/constants.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	MSG_TEAM = (
79	    "ğŸ‘¥ Invite your team: [link]https://platform.safetycli.com/organization/team[/link]"
80	)
81	
82	
83	MSG_SETUP_NEXT_STEPS = (
84	    MSG_TEAM,

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/init/render.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
16	    # On non-Windows platforms, return the original emoji
17	    if platform.system() != "Windows":
18	        return emoji

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/init/render.py:17
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
16	    # On non-Windows platforms, return the original emoji
17	    if platform.system() != "Windows":
18	        return emoji

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/output_utils.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
349	          f' packages visit'
350	    link = 'https://docs.pyup.io/docs/safety-range-specs'
351	
352	    if style:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/output_utils.py:949
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
948	    if context.params.get('audit_and_monitor'):
949	        logged_url = context.params.get('audit_and_monitor_url') if context.params.get('audit_and_monitor_url') else "https://safetycli.com"
950	        audit_and_monitor = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/output_utils.py:1280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1279	
1280	        msg = f"-> Warning: {len(total)} known {match_text} the {pkg.name} versions that could be " \
1281	              f"installed from your specifier{'s' if len(pkg.requirements) > 1 else ''}: {reqs} (unpinned). These vulnerabilities are not " \
1282	              f"reported by default. To report these vulnerabilities set 'ignore-unpinned-requirements' to False " \

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	                try:
62	                    data = json.loads(f.read())
63	                    if db_name in data:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	                                try:
71	                                    data[db_name]["db"]["meta"]["base_domain"] = "https://data.safetycli.com"
72	                                except KeyError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	            with open(DB_CACHE_FILE, "w") as _:
112	                _.write(json.dumps({}))
113	                LOG.debug('Cache file created')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
111	            with open(DB_CACHE_FILE, "w") as _:
112	                _.write(json.dumps({}))
113	                LOG.debug('Cache file created')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
124	                try:
125	                    cache = json.loads(f.read())
126	                except json.JSONDecodeError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
136	            }
137	            f.write(json.dumps(cache))
138	            LOG.debug('Safety updated the cache file for %s database.', db_name)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
136	            }
137	            f.write(json.dumps(cache))
138	            LOG.debug('Safety updated the cache file for %s database.', db_name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	    try:
180	        r = session.get(url=url, timeout=REQUEST_TIMEOUT,
181	                        headers=headers, params=telemetry_data)
182	    except requests.exceptions.ConnectionError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	        LOG.debug(f'Getting policy')
224	        r = session.get(url=url, timeout=REQUEST_TIMEOUT)
225	        LOG.debug(r.text)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
255	        LOG.debug(f'Posting results: {audit_report}')
256	        r = session.post(url=url, timeout=REQUEST_TIMEOUT, json=audit_report)
257	        LOG.debug(r.text)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
289	    with open(full_path) as f:
290	        data = json.loads(f.read())
291	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
415	    """
416	    base_domain = db.get('meta', {}).get('base_domain')
417	    unpinned_ignored = ignore_vulns.get(vuln_id, {}).get('requirements', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
415	    """
416	    base_domain = db.get('meta', {}).get('base_domain')
417	    unpinned_ignored = ignore_vulns.get(vuln_id, {}).get('requirements', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
416	    base_domain = db.get('meta', {}).get('base_domain')
417	    unpinned_ignored = ignore_vulns.get(vuln_id, {}).get('requirements', None)
418	    should_ignore = not unpinned_ignored or str(affected.specifier) in unpinned_ignored

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
416	    base_domain = db.get('meta', {}).get('base_domain')
417	    unpinned_ignored = ignore_vulns.get(vuln_id, {}).get('requirements', None)
418	    should_ignore = not unpinned_ignored or str(affected.specifier) in unpinned_ignored

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
421	            not ignore_vulns[vuln_id]['expires'] or ignore_vulns[vuln_id]['expires'] > datetime.utcnow()))
422	    more_info_url = f"{base_domain}{data.get('more_info_path', '')}"
423	    severity = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
439	        ignored=ignored,
440	        ignored_reason=ignore_vulns.get(vuln_id, {}).get('reason', None) if ignore_vulns else None,
441	        ignored_expires=ignore_vulns.get(vuln_id, {}).get('expires', None) if ignore_vulns else None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
439	        ignored=ignored,
440	        ignored_reason=ignore_vulns.get(vuln_id, {}).get('reason', None) if ignore_vulns else None,
441	        ignored_expires=ignore_vulns.get(vuln_id, {}).get('expires', None) if ignore_vulns else None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
440	        ignored_reason=ignore_vulns.get(vuln_id, {}).get('reason', None) if ignore_vulns else None,
441	        ignored_expires=ignore_vulns.get(vuln_id, {}).get('expires', None) if ignore_vulns else None,
442	        vulnerable_spec=vulnerable_spec,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
440	        ignored_reason=ignore_vulns.get(vuln_id, {}).get('reason', None) if ignore_vulns else None,
441	        ignored_expires=ignore_vulns.get(vuln_id, {}).get('expires', None) if ignore_vulns else None,
442	        vulnerable_spec=vulnerable_spec,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
442	        vulnerable_spec=vulnerable_spec,
443	        all_vulnerable_specs=data.get("specs", []),
444	        analyzed_version=analyzed_version,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
445	        analyzed_requirement=analyzed_requirement,
446	        advisory=data.get("advisory"),
447	        is_transitive=data.get("transitive", False),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
446	        advisory=data.get("advisory"),
447	        is_transitive=data.get("transitive", False),
448	        published_date=data.get("published_date"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
447	        is_transitive=data.get("transitive", False),
448	        published_date=data.get("published_date"),
449	        fixed_versions=[ver for ver in data.get("fixed_versions", []) if ver],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
448	        published_date=data.get("published_date"),
449	        fixed_versions=[ver for ver in data.get("fixed_versions", []) if ver],
450	        closest_versions_without_known_vulnerabilities=data.get("closest_secure_versions", []),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
449	        fixed_versions=[ver for ver in data.get("fixed_versions", []) if ver],
450	        closest_versions_without_known_vulnerabilities=data.get("closest_secure_versions", []),
451	        resources=data.get("vulnerability_resources"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
450	        closest_versions_without_known_vulnerabilities=data.get("closest_secure_versions", []),
451	        resources=data.get("vulnerability_resources"),
452	        CVE=cve,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
453	        severity=severity,
454	        affected_versions=data.get("affected_versions", []),
455	        more_info_url=more_info_url

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
471	        xve_id: str = str(
472	            next(filter(lambda i: i.get('type', None) in ['cve', 'pve'], data.get('ids', []))).get('id', ''))
473	    except StopIteration:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
471	        xve_id: str = str(
472	            next(filter(lambda i: i.get('type', None) in ['cve', 'pve'], data.get('ids', []))).get('id', ''))
473	    except StopIteration:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
471	        xve_id: str = str(
472	            next(filter(lambda i: i.get('type', None) in ['cve', 'pve'], data.get('ids', []))).get('id', ''))
473	    except StopIteration:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	
479	    cve_meta = db_full.get("meta", {}).get("severities", {}).get(xve_id, {})
480	    return CVE(name=xve_id, cvssv2=cve_meta.get("cvssv2", None),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	
479	    cve_meta = db_full.get("meta", {}).get("severities", {}).get(xve_id, {})
480	    return CVE(name=xve_id, cvssv2=cve_meta.get("cvssv2", None),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	
479	    cve_meta = db_full.get("meta", {}).get("severities", {}).get(xve_id, {})
480	    return CVE(name=xve_id, cvssv2=cve_meta.get("cvssv2", None),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
479	    cve_meta = db_full.get("meta", {}).get("severities", {}).get(xve_id, {})
480	    return CVE(name=xve_id, cvssv2=cve_meta.get("cvssv2", None),
481	               cvssv3=cve_meta.get("cvssv3", None))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
480	    return CVE(name=xve_id, cvssv2=cve_meta.get("cvssv2", None),
481	               cvssv3=cve_meta.get("cvssv3", None))
482	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
511	    if cve:
512	        if cve.cvssv2 and cve.cvssv2.get("base_score", None):
513	            severity = cve.cvssv2.get("base_score", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
512	        if cve.cvssv2 and cve.cvssv2.get("base_score", None):
513	            severity = cve.cvssv2.get("base_score", None)
514	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
514	
515	        if cve.cvssv3 and cve.cvssv3.get("base_score", None):
516	            severity = cve.cvssv3.get("base_score", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
515	        if cve.cvssv3 and cve.cvssv3.get("base_score", None):
516	            severity = cve.cvssv3.get("base_score", None)
517	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
517	
518	    ignore_severity_below = float(ignore_severity_rules.get('ignore-cvss-severity-below', 0.0))
519	    ignore_unknown_severity = bool(ignore_severity_rules.get('ignore-cvss-unknown-severity', False))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
518	    ignore_severity_below = float(ignore_severity_rules.get('ignore-cvss-severity-below', 0.0))
519	    ignore_unknown_severity = bool(ignore_severity_rules.get('ignore-cvss-unknown-severity', False))
520	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
531	    is_prev_not_ignored: bool = vuln_id not in ignore_vulns
532	    is_req_not_ignored: bool = 'requirements' in ignore_vulns.get(vuln_id, {}) and str(req.specifier) not in ignore_vulns.get(vuln_id, {}).get('requirements', set())
533	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
531	    is_prev_not_ignored: bool = vuln_id not in ignore_vulns
532	    is_req_not_ignored: bool = 'requirements' in ignore_vulns.get(vuln_id, {}) and str(req.specifier) not in ignore_vulns.get(vuln_id, {}).get('requirements', set())
533	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
531	    is_prev_not_ignored: bool = vuln_id not in ignore_vulns
532	    is_req_not_ignored: bool = 'requirements' in ignore_vulns.get(vuln_id, {}) and str(req.specifier) not in ignore_vulns.get(vuln_id, {}).get('requirements', set())
533	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
607	    db_full = None
608	    vulnerable_packages = frozenset(db.get('vulnerable_packages', []))
609	    vulnerabilities = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
621	
622	        pkg = found_pkgs.get(name, None)
623	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	                        try:
644	                            vuln_id: str = str(next(filter(lambda i: i.get('type', None) == 'pyup', data.get('ids', []))).get('id', ''))
645	                        except StopIteration:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	                        try:
644	                            vuln_id: str = str(next(filter(lambda i: i.get('type', None) == 'pyup', data.get('ids', []))).get('id', ''))
645	                        except StopIteration:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	                        try:
644	                            vuln_id: str = str(next(filter(lambda i: i.get('type', None) == 'pyup', data.get('ids', []))).get('id', ''))
645	                        except StopIteration:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
690	            spec = remediations[vuln.package_name][str(vuln.analyzed_requirement.specifier)]
691	            spec['vulnerabilities_found'] = spec.get('vulnerabilities_found', 0) + 1
692	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
786	
787	    for vuln in db_full.get('vulnerable_packages', {}).get(package.name, []):
788	        vuln_id: str = str(next(filter(lambda i: i.get('type', None) == 'pyup', vuln.get('ids', []))).get('id', ''))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
786	
787	    for vuln in db_full.get('vulnerable_packages', {}).get(package.name, []):
788	        vuln_id: str = str(next(filter(lambda i: i.get('type', None) == 'pyup', vuln.get('ids', []))).get('id', ''))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
787	    for vuln in db_full.get('vulnerable_packages', {}).get(package.name, []):
788	        vuln_id: str = str(next(filter(lambda i: i.get('type', None) == 'pyup', vuln.get('ids', []))).get('id', ''))
789	        if vuln_id and vuln_id not in secure_vulns_by_user:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
787	    for vuln in db_full.get('vulnerable_packages', {}).get(package.name, []):
788	        vuln_id: str = str(next(filter(lambda i: i.get('type', None) == 'pyup', vuln.get('ids', []))).get('id', ''))
789	        if vuln_id and vuln_id not in secure_vulns_by_user:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
787	    for vuln in db_full.get('vulnerable_packages', {}).get(package.name, []):
788	        vuln_id: str = str(next(filter(lambda i: i.get('type', None) == 'pyup', vuln.get('ids', []))).get('id', ''))
789	        if vuln_id and vuln_id not in secure_vulns_by_user:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
789	        if vuln_id and vuln_id not in secure_vulns_by_user:
790	            affected_versions += vuln.get('affected_versions', [])
791	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
815	    for pkg_name in remediations.keys():
816	        pkg: Package = packages.get(pkg_name, None)
817	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
829	            rem = remediations[pkg_name][analyzed_requirement]
830	            spec = rem.get('requirement').specifier
831	            version = rem['version']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
839	
840	            upgrade = rem['closest_secure_version'].get('upper', None)
841	            downgrade = rem['closest_secure_version'].get('lower', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
840	            upgrade = rem['closest_secure_version'].get('upper', None)
841	            downgrade = rem['closest_secure_version'].get('lower', None)
842	            recommended_version = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1099	    for remediation in req_remediations:
1100	        req: SafetyRequirement = remediation.get('requirement')
1101	        pkg: str = req.name

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1102	
1103	        dry_fix = Fix(package=pkg, more_info_url=remediation.get('more_info_url', ''),
1104	                      previous_spec=str(req.specifier),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1104	                      previous_spec=str(req.specifier),
1105	                      other_options=remediation.get('other_recommended_versions', []))
1106	        from_ver: Optional[str] = remediation.get('version', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1105	                      other_options=remediation.get('other_recommended_versions', []))
1106	        from_ver: Optional[str] = remediation.get('version', None)
1107	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1220	
1221	        if data.get('supported', True):
1222	            new_content = data['content']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1283	                with open(name, mode="w") as r_file:
1284	                    r_file.write(new_content)
1285	                output.append((f"Changes applied to {name}.", {}))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1283	                with open(name, mode="w") as r_file:
1284	                    r_file.write(new_content)
1285	                output.append((f"Changes applied to {name}.", {}))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1292	        else:
1293	            not_supported_filename = data.get('filename', name)
1294	            output.append(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1355	    vulnerable = []
1356	    vulnerabilities = report.get('vulnerabilities', []) + report.get('ignored_vulnerabilities', [])
1357	    remediations = defaultdict(dict)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1355	    vulnerable = []
1356	    vulnerabilities = report.get('vulnerabilities', []) + report.get('ignored_vulnerabilities', [])
1357	    remediations = defaultdict(dict)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1358	
1359	    for key, pkg_rem in report.get('remediations', {}).items():
1360	        analyzed = set(pkg_rem['requirements'].keys())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1363	            req_rem = pkg_rem['requirements'][req]
1364	            recommended = req_rem.get('recommended_version', None)
1365	            secure_v = req_rem.get('other_recommended_versions', [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1364	            recommended = req_rem.get('recommended_version', None)
1365	            secure_v = req_rem.get('other_recommended_versions', [])
1366	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1366	
1367	            remediations[key][req] = {'vulnerabilities_found': req_rem.get('vulnerabilities_found', 0),
1368	                                      'version': req_rem.get('version'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1367	            remediations[key][req] = {'vulnerabilities_found': req_rem.get('vulnerabilities_found', 0),
1368	                                      'version': req_rem.get('version'),
1369	                                      'requirement': SafetyRequirement(req_rem['requirement']['raw']),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1372	                                      # minor isn't supported in review
1373	                                      'more_info_url': req_rem.get('more_info_url')}
1374	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1374	
1375	    packages = report.get('scanned_packages', [])
1376	    pkgs = {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1378	    for name, values in packages.items():
1379	        requirements = [SafetyRequirement(r['raw']) for r in values.get('requirements', [])]
1380	        values.update({'requirements': requirements})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1385	    ctx.packages = found_packages
1386	    ctx.review = report.get('report_meta', [])
1387	    ctx.key = ctx.review.get('api_key', False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1386	    ctx.review = report.get('report_meta', [])
1387	    ctx.key = ctx.review.get('api_key', False)
1388	    cvssv2 = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1391	    for vuln in vulnerabilities:
1392	        vuln['pkg'] = pkgs.get(vuln.get('package_name', None))
1393	        XVE_ID = vuln.get('CVE', None)  # Trying to get first the CVE ID

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1391	    for vuln in vulnerabilities:
1392	        vuln['pkg'] = pkgs.get(vuln.get('package_name', None))
1393	        XVE_ID = vuln.get('CVE', None)  # Trying to get first the CVE ID

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1392	        vuln['pkg'] = pkgs.get(vuln.get('package_name', None))
1393	        XVE_ID = vuln.get('CVE', None)  # Trying to get first the CVE ID
1394	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1394	
1395	        severity = vuln.get('severity', None)
1396	        if severity and severity.get('source', False):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1395	        severity = vuln.get('severity', None)
1396	        if severity and severity.get('source', False):
1397	            cvssv2 = severity.get('cvssv2', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1396	        if severity and severity.get('source', False):
1397	            cvssv2 = severity.get('cvssv2', None)
1398	            cvssv3 = severity.get('cvssv3', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1397	            cvssv2 = severity.get('cvssv2', None)
1398	            cvssv3 = severity.get('cvssv3', None)
1399	            # Trying to get the PVE ID if it exists, otherwise it will be the same CVE ID of above

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1399	            # Trying to get the PVE ID if it exists, otherwise it will be the same CVE ID of above
1400	            XVE_ID = severity.get('source', False)
1401	            vuln['severity'] = Severity(source=XVE_ID, cvssv2=cvssv2, cvssv3=cvssv3)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1404	
1405	        ignored_expires = vuln.get('ignored_expires', None)
1406	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1525	
1526	    source = os.environ.get('SAFETY_ANNOUNCEMENTS_URL', None)
1527	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1552	            if 'announcements' in announcements.keys():
1553	                announcements = announcements.get('announcements', [])
1554	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1665	        with tempfile.NamedTemporaryFile(prefix='server-safety-policy-') as tmp:
1666	            tmp.write(server_safety_policy.encode('utf-8'))
1667	            tmp.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1665	        with tempfile.NamedTemporaryFile(prefix='server-safety-policy-') as tmp:
1666	            tmp.write(server_safety_policy.encode('utf-8'))
1667	            tmp.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1694	        with open(save_at, 'w+') as report_file:
1695	            report_file.write(report)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/safety.py:1695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1694	        with open(save_at, 'w+') as report_file:
1695	            report_file.write(report)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/command.py:900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
899	    console = ctx.obj.console
900	    ecosystems = [Ecosystem(member.value) for member in list(ScannableEcosystems)]
901	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/command.py:1211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1210	
1211	    ecosystems = [Ecosystem(member.value) for member in list(ScannableEcosystems)]
1212	    ecosystems.append(Ecosystem.SAFETY_PROJECT)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/constants.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	CLI_VERSION = get_version()
9	CLI_WEBSITE_URL="https://safetycli.com"
10	CLI_DOCUMENTATION_URL="https://docs.safetycli.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/constants.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	CLI_WEBSITE_URL="https://safetycli.com"
10	CLI_DOCUMENTATION_URL="https://docs.safetycli.com"
11	CLI_SUPPORT_EMAIL="support@safetycli.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/constants.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	CLI_AUTH_COMMAND_HELP = (
20	    "Authenticate Safety CLI to perform scans. Your default browser will automatically open to "
21	    "https://platform.safetycli.com.\n\n"
22	    "Example:\n  safety auth login\n\n"
23	    "For headless authentication, you will receive a URL to paste into an external browser.\n\n"
24	    "Example:\n  safety auth login --headless"
25	)
26	
27	CLI_AUTH_HEADLESS_HELP = "For headless authentication, you will receive a URL to paste into an external browser."
28	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/constants.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	# Auth options
114	CLI_AUTH_LOGIN_HELP = "Authenticate with Safety CLI to perform scans. Your default browser will automatically open to https://platform.safetycli.com unless already authenticated.\n\n" \
115	    "[bold]Example: safety auth login[/bold]"
116	CLI_AUTH_LOGOUT_HELP = "Log out from the current Safety CLI session.\n\n" \

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/init_scan.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
204	    # Initialize ecosystems
205	    ecosystems = [Ecosystem(member.value) for member in list(ScannableEcosystems)]
206	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/main.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
147	    with open(at, 'w+') as report_file:
148	        report_file.write(report)
149	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/main.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
172	    os_metadata = {
173	        "type": os.environ.get("SAFETY_OS_TYPE", None) or platform.system(),
174	        "release": os.environ.get("SAFETY_OS_RELEASE", None) or platform.release(),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/main.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
172	    os_metadata = {
173	        "type": os.environ.get("SAFETY_OS_TYPE", None) or platform.system(),
174	        "release": os.environ.get("SAFETY_OS_RELEASE", None) or platform.release(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/main.py:173
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
172	    os_metadata = {
173	        "type": os.environ.get("SAFETY_OS_TYPE", None) or platform.system(),
174	        "release": os.environ.get("SAFETY_OS_RELEASE", None) or platform.release(),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/main.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	                    with open(f_path, "r") as file:
234	                        content = file.read()
235	                except Exception as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/render.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	        console.print(
161	            "[green]Run `safety scan --apply-fixes`[/green] to update these packages and fix these vulnerabilities. "
162	            "Documentation, limitations, and configurations for applying automated fixes: [link]https://docs.safetycli.com/safety-docs/vulnerability-remediation/applying-fixes[/link]"
163	        )

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/render.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
595	        for ecosystem in [
596	            Ecosystem(member.value) for member in list(ScannableEcosystems)
597	        ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/scan/render.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
639	
640	    DOC_NAMESPACE = f"https://spdx.org/spdxdocs/{DOC_NAME}"
641	    # DOC_NAMESPACE = f"urn:safety:{project_identifier}:{version}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/constants.py:1
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	PUBLIC_REPOSITORY_URL = "https://pkgs.safetycli.com/repository/public/pypi/simple/"
2	ORGANIZATION_REPOSITORY_URL = "https://pkgs.safetycli.com/repository/{}/pypi/simple/"
3	PROJECT_CONFIG = ".safety-project.ini"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/constants.py:2
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	PUBLIC_REPOSITORY_URL = "https://pkgs.safetycli.com/repository/public/pypi/simple/"
2	ORGANIZATION_REPOSITORY_URL = "https://pkgs.safetycli.com/repository/{}/pypi/simple/"
3	PROJECT_CONFIG = ".safety-project.ini"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/interceptors/unix.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
106	            with open(self.user_rc_path, "a") as f:
107	                f.write(source_line)
108	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/interceptors/unix.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
166	                    cleaned_content = re.sub(pattern, "", content, flags=re.DOTALL)
167	                    dst.write(cleaned_content)
168	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/interceptors/windows.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
105	            if self.scripts_dir.exists():
106	                shutil.rmtree(self.scripts_dir)
107	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/pip.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
144	        )
145	        return base64.urlsafe_b64encode(auth_envelop.encode("utf-8")).decode("utf-8")
146	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/pip.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	    def default_index_url(cls) -> str:
149	        return "https://pypi.org/simple/"
150	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/tool_inspector.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
142	        exe_name = tool_type.value
143	        if platform.system() == "Windows":
144	            exe_name = f"{exe_name}.exe"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/tool_inspector.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
142	        exe_name = tool_type.value
143	        if platform.system() == "Windows":
144	            exe_name = f"{exe_name}.exe"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/tool_inspector.py:143
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
142	        exe_name = tool_type.value
143	        if platform.system() == "Windows":
144	            exe_name = f"{exe_name}.exe"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/utils.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
110	    def configure(self, org_slug: Optional[str]) -> Optional[Path]:
111	        return Pip.configure_system(org_slug)
112	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/utils.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
110	    def configure(self, org_slug: Optional[str]) -> Optional[Path]:
111	        return Pip.configure_system(org_slug)
112	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/utils.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
113	    def reset(self) -> None:
114	        Pip.reset_system()
115	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/utils.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
113	    def reset(self) -> None:
114	        Pip.reset_system()
115	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/utils.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	            ):
282	                if args[ind].startswith("https://pkgs.safetycli.com"):
283	                    self.__index_url = args[ind]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/utils.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
299	                        requirements = re.sub(
300	                            r"^(-i|--index-url).*$", "", f.read(), flags=re.MULTILINE
301	                        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/utils.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
301	                        )
302	                        tf.write(requirements)
303	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/utils.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
301	                        )
302	                        tf.write(requirements)
303	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/tool/utils.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
402	                Padding(
403	                    f"Learn more: [link]https://data.safetycli.com/packages/pypi/{package_name}/[/link]",
404	                    (0, 0, 0, 1),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
156	    LOG.debug("Trying to parse file using dparse...")
157	    content = fh.read()
158	    LOG.debug(f"Content: {content}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
220	    """
221	    licenses = db.get("licenses", [])
222	    for name, id in licenses.items():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	        if cleaned_arg in flags:
260	            option_used = flags.get(cleaned_arg)
261	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
263	                used_options[option_used][cleaned_arg] = (
264	                    used_options[option_used].get(cleaned_arg, 0) + 1
265	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
296	    for announcement in announcements:
297	        if announcement.get("type", "").lower() == "primary_announcement":
298	            try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
326	        for announcement in announcements
327	        if announcement.get("type", "").lower() != "primary_announcement"
328	        and not announcement.get("local", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
327	        if announcement.get("type", "").lower() != "primary_announcement"
328	        and not announcement.get("local", False)
329	        or (announcement.get("local", False) and include_local)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
328	        and not announcement.get("local", False)
329	        or (announcement.get("local", False) and include_local)
330	    ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
348	        for announcement in announcements
349	        if announcement.get("type", "").lower() == by_type
350	    ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
371	        {
372	            "os_type": os.environ.get("SAFETY_OS_TYPE", None) or platform.system(),
373	            "os_release": os.environ.get("SAFETY_OS_RELEASE", None)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
371	        {
372	            "os_type": os.environ.get("SAFETY_OS_TYPE", None) or platform.system(),
373	            "os_release": os.environ.get("SAFETY_OS_RELEASE", None)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
371	        {
372	            "os_type": os.environ.get("SAFETY_OS_TYPE", None) or platform.system(),
373	            "os_release": os.environ.get("SAFETY_OS_RELEASE", None)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:372
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
371	        {
372	            "os_type": os.environ.get("SAFETY_OS_TYPE", None) or platform.system(),
373	            "os_release": os.environ.get("SAFETY_OS_RELEASE", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
372	            "os_type": os.environ.get("SAFETY_OS_TYPE", None) or platform.system(),
373	            "os_release": os.environ.get("SAFETY_OS_RELEASE", None)
374	            or platform.release(),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
374	            or platform.release(),
375	            "os_description": os.environ.get("SAFETY_OS_DESCRIPTION", None)
376	            or platform.platform(),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
386	    body["safety_source"] = (
387	        os.environ.get("SAFETY_SOURCE", None) or context.safety_source
388	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
494	    if policy_file:
495	        project_config = policy_file.get("project", {})
496	        security = policy_file.get("security", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
495	        project_config = policy_file.get("project", {})
496	        security = policy_file.get("security", {})
497	        ctx = click.get_current_context()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
500	        if not project:
501	            project_id = project_config.get("id", None)
502	            if not project_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
509	        ):
510	            ignore_unpinned_requirements = security.get(
511	                "ignore-unpinned-requirements", None
512	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
514	        if not ignore:
515	            ignore = security.get("ignore-vulnerabilities", {})
516	        if source == click.core.ParameterSource.DEFAULT:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
516	        if source == click.core.ParameterSource.DEFAULT:
517	            exit_code = not security.get("continue-on-vulnerability-error", False)
518	        ignore_cvss_below = security.get("ignore-cvss-severity-below", 0.0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
517	            exit_code = not security.get("continue-on-vulnerability-error", False)
518	        ignore_cvss_below = security.get("ignore-cvss-severity-below", 0.0)
519	        ignore_cvss_unknown = security.get("ignore-cvss-unknown-severity", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
518	        ignore_cvss_below = security.get("ignore-cvss-severity-below", 0.0)
519	        ignore_cvss_unknown = security.get("ignore-cvss-unknown-severity", False)
520	        ignore_severity_rules = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
553	    if policy_file:
554	        fix = policy_file.get("security-updates", {})
555	        auto_fix = fix.get("auto-security-updates-limit", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
554	        fix = policy_file.get("security-updates", {})
555	        auto_fix = fix.get("auto-security-updates-limit", None)
556	        if not auto_fix:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
569	        self.with_values = kwargs.pop("with_values", {})
570	        help = kwargs.get("help", "")
571	        if self.mutually_exclusive:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
573	                [
574	                    "{0} with values {1}".format(item, self.with_values.get(item))
575	                    if item in self.with_values

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
604	        for used in m_exclusive_used:
605	            value_used = opts.get(used, None)
606	            if not isinstance(value_used, List):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
607	                value_used = [value_used]
608	            if value_used and set(self.with_values.get(used, [])).intersection(
609	                value_used

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
616	                [
617	                    "\n * --{0} with {1}".format(item, self.with_values.get(item))
618	                    if item in self.with_values

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
636	        self.required_options = set(kwargs.pop("required_options", []))
637	        help = kwargs.get("help", "")
638	        if self.required_options:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
715	
716	    color = os.environ.get("SAFETY_COLOR", None)
717	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
857	        errors: str = "strict",
858	        pure: bool = os.environ.get("SAFETY_PURE_YAML", "false").lower() == "true",
859	    ) -> None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
986	                # Read the content of the file
987	                raw = f.read()
988	                yaml = YAML(typ="safe", pure=self.pure)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1004	                or not isinstance(safety_policy, dict)
1005	                or not safety_policy.get("security", None)
1006	            ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1020	            # Validate 'security' section keys
1021	            security_config = safety_policy.get("security", {})
1022	            security_keys = [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1039
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1038	            # Validate 'ignore-cvss-severity-below' value
1039	            ignore_cvss_security_below = security_config.get(
1040	                "ignore-cvss-severity-below", None
1041	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1060
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1059	            # Validate 'continue-on-vulnerability-error' value
1060	            continue_on_vulnerability_error = security_config.get(
1061	                "continue-on-vulnerability-error", None
1062	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1067	            # Validate 'ignore-cvss-unknown-severity' value
1068	            ignore_cvss_unknown_severity = security_config.get(
1069	                "ignore-cvss-unknown-severity", None
1070	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1075	            # Validate 'ignore-vulnerabilities' section
1076	            ignore_vulns = safety_policy.get("security", {}).get(
1077	                "ignore-vulnerabilities", {}
1078	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1075	            # Validate 'ignore-vulnerabilities' section
1076	            ignore_vulns = safety_policy.get("security", {}).get(
1077	                "ignore-vulnerabilities", {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1110	
1111	                    reason = ignored_vuln_config.get("reason", "")
1112	                    reason = str(reason) if reason else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1112	                    reason = str(reason) if reason else None
1113	                    expires = ignored_vuln_config.get("expires", "")
1114	                    expires = str(expires) if expires else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1148	            # Validate 'fix' section keys
1149	            fix_config = safety_policy.get("fix", {})
1150	            self.fail_if_unrecognized_keys(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1157	            )
1158	            auto_remediation_limit = fix_config.get("auto-security-updates-limit", None)
1159	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1269	            legacy_key_added = True
1270	            session = kwargs.get("session")
1271	            kwargs["key"] = session.api_key if session else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1274	            if attr in kwargs:
1275	                setattr(ctx, attr, kwargs.get(attr))
1276	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1307	
1308	    packages_licenses_db = licenses_db.get("packages", {})
1309	    filtered_packages_licenses = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1317	        # packages may have different licenses depending their version.
1318	        pkg_licenses = packages_licenses_db.get(pkg_name, [])
1319	        if not pkg.version:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1369	            f.seek(0)
1370	            requirements_files[f.name] = f.read()
1371	            f.close()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1389	    """
1390	    ignore = SafetyContext().params.get("ignore_unpinned_requirements")
1391	    return (ignore is None or ignore) and not version

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py:1497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1496	            client: "SafetyAuthSession" = auth.client
1497	            token = client.token.get("access_token") if client.token else None
1498	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/auth/test_cli.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    ):
23	        auth_data = "https://safetycli.com", "initialState"
24	        get_authorization_data.return_value = auth_data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/auth/test_cli.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	            "Canâ€™t find the verification email? Login at",
48	            "`https://platform.safetycli.com/login/` to resend the verification email",
49	            "",
50	        ]
51	
52	        for res_line, exp_line in zip(result.stdout.splitlines(), expected):
53	            self.assertIn(exp_line, res_line)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/formatters/test_json.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	                                   latest_version='4.0.4',
34	                                   more_info_url='https://pyup.io/packages/pypi/django/?from=4.0.1&to=4.0.4')
35	        remediations = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/formatters/test_json.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	                                                              'lower': None},
42	                                   'more_info_url': 'https://pyup.io/packages/pypi/django/?from=4.0.1&to=4.0.4'}}}
43	        cve = CVE(name='CVE-2022-22818',
44	                  cvssv2={'base_score': 4.3, 'impact_score': 2.9,
45	                          'vector_string': 'AV:N/AC:M/Au:N/C:N/I:P/A:N'},
46	                  cvssv3={'base_score': 6.1, 'impact_score': 2.7,
47	                          'base_severity': 'MEDIUM',
48	                          'vector_string': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N'})
49	        vulnerabilities = [Vulnerability(package_name='django', pkg=affected_package,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/formatters/test_json.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	                                         closest_versions_without_known_vulnerabilities=[],
58	                                         resources=['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22818'],
59	                                         CVE=cve,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/formatters/test_json.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	                                         affected_versions=['4.0.1'],
62	                                         more_info_url='https://pyup.io/vulnerabilities/CVE-2022-22818/44742/')]
63	        packages = [Package(name='secure-package', version='0.1.0',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/formatters/test_json.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	                            latest_version='0.1.0',
69	                            more_info_url='https://pyup.io/packages/pypi/secure-package/'),
70	                    affected_package]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/formatters/test_json.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	                        "latest_version": "4.0.4",
152	                        "more_info_url": "https://pyup.io/packages/pypi/django/?from=4.0.1&to=4.0.4"
153	                    }
154	                },
155	                "announcements": [],
156	                "vulnerabilities": [
157	                    {
158	                        "vulnerability_id": "44742",
159	                        "package_name": "django",
160	                        "ignored": False,
161	                        "ignored_reason": None,
162	                        "ignored_expires": None,
163	                        "vulnerable_spec": ">=4.0a1,<4.0.2",
164	                        "all_vulnerable_specs": [
165	                            ">=4.0a1,<4.0.2"
166	                        ],
167	                        "analyzed_version": "4.0.1",
168	                        "analyzed_requirement": {
169	                            "raw": "django==4.0.1",
170	                            "extras": [],
171	                            "marker": None,
172	                            "name": "django",
173	                            "specifier": "==4.0.1",
174	                            "url": None,
175	                            "found": None
176	                        },
177	                        "advisory": "The {% debug %} template tag in Django",
178	                        "is_transitive": False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/formatters/test_json.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	                        "resources": [
187	                            "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22818"
188	                        ],
189	                        "CVE": "CVE-2022-22818",
190	                        "severity": {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/formatters/test_json.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
206	                        ],
207	                        "more_info_url": "https://pyup.io/vulnerabilities/CVE-2022-22818/44742/"
208	                    },
209	                ],
210	                "ignored_vulnerabilities": [],
211	                "remediations": {
212	                    "django": {
213	                        "requirements": {
214	                            "==4.0.1": {
215	                                "vulnerabilities_found": 1,
216	                                "version": "4.0.1",
217	                                "requirement": {
218	                                    "raw": "django==4.0.1",
219	                                    "extras": [],
220	                                    "marker": None,
221	                                    "name": "django",
222	                                    "specifier": "==4.0.1",
223	                                    "url": None,
224	                                    "found": None
225	                                },
226	                                "recommended_version": "4.0.4",
227	                                "other_recommended_versions": [
228	                                    "2.2.28",
229	                                    "3.2.13"
230	                                ],
231	                                "closest_secure_version": {
232	                                    "upper": "4.0.4",
233	                                    "lower": None
234	                                },
235	                                "more_info_url": "https://pyup.io/packages/pypi/django/?from=4.0.1&to=4.0.4"
236	                            }
237	                            },
238	                        "current_version": None,
239	                        "vulnerabilities_found": None,
240	                        "recommended_version": None,
241	                        "other_recommended_versions": [],
242	                        "more_info_url": None
243	                    }
244	                },
245	                "remediations_results": {
246	                    "vulnerabilities_fixed": [],
247	                    "remediations_applied": {},
248	                    "remediations_skipped": {}
249	                }
250	            },
251	            indent=4
252	        )
253	        self.assertEqual(result, expected_result)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/formatters/test_json.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
234	                                },
235	                                "more_info_url": "https://pyup.io/packages/pypi/django/?from=4.0.1&to=4.0.4"
236	                            }
237	                            },
238	                        "current_version": None,
239	                        "vulnerabilities_found": None,
240	                        "recommended_version": None,
241	                        "other_recommended_versions": [],
242	                        "more_info_url": None
243	                    }
244	                },
245	                "remediations_results": {
246	                    "vulnerabilities_fixed": [],
247	                    "remediations_applied": {},
248	                    "remediations_skipped": {}
249	                }
250	            },
251	            indent=4
252	        )
253	        self.assertEqual(result, expected_result)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/init/test_init_main.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	                ProjectModel(
111	                    id="test-id", url_path="http://example.com", name="Test Project"
112	                ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/init/test_init_main.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	                    PROJECT_CONFIG_ID: "test-id",
115	                    PROJECT_CONFIG_URL: "http://example.com",
116	                    PROJECT_CONFIG_NAME: "Test Project",
117	                },
118	            ),
119	            ("id_only", ProjectModel(id="test-id"), {PROJECT_CONFIG_ID: "test-id"}),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/init/test_init_main.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	                "with_url",
122	                ProjectModel(id="test-id", url_path="http://example.com"),
123	                {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/init/test_init_main.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
124	                    PROJECT_CONFIG_ID: "test-id",
125	                    PROJECT_CONFIG_URL: "http://example.com",
126	                },
127	            ),
128	            (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/resources.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	                                                           'latest_version': '0.1.0',
54	                                                           'more_info_url': 'https://pyup.io/packages/pypi/insecure-package/'}},
55	                'announcements': [], 'vulnerabilities': [
56	        {'vulnerability_id': '25853', 'package_name': 'insecure-package', 'ignored': False, 'ignored_reason': None,
57	         'ignored_expires': None, 'vulnerable_spec': ['<0.2.0'],
58	         'all_vulnerable_specs': ['<0.2.0'], 'analyzed_version': '0.1.0', 'analyzed_requirement': {
59	                                                                  "raw": "insecure-package==0.1.0",
60	                                                                  "extras": [],
61	                                                                  "marker": None,
62	                                                                  "name": "insecure-package",
63	                                                                  "specifier": "==0.1.0",
64	                                                                  "url": None
65	                                                              },
66	         'advisory': 'This is an insecure package with lots of exploitable security vulnerabilities.',
67	         'is_transitive': False, 'published_date': '2021-Apr-14',
68	         'fixed_versions': [''], 'closest_versions_without_known_vulnerabilities': [],
69	         'resources': ['https://pypi.org/project/insecure-package'],
70	         'CVE': None,
71	         'severity': None, 'affected_versions': ['0.1.0'],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/resources.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	         'fixed_versions': [''], 'closest_versions_without_known_vulnerabilities': [],
69	         'resources': ['https://pypi.org/project/insecure-package'],
70	         'CVE': None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/resources.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	         'severity': None, 'affected_versions': ['0.1.0'],
72	         'more_info_url': 'https://pyup.io/vulnerabilities/PVE-2021-25853/25853/'}],
73	                'ignored_vulnerabilities': [],
74	                'remediations': {
75	                    'insecure-package': {
76	                        'requirements': {
77	                            '==0.1.0': {
78	                                'version': '0.1.0',
79	                                'requirement': {
80	                                    "raw": "insecure-package==0.1.0",
81	                                    "extras": [],
82	                                    "marker": None,
83	                                    "name": "insecure-package",
84	                                    "specifier": "==0.1.0",
85	                                    "url": None
86	                                },
87	                                'vulnerabilities_found': 1, 'recommended_version': None,
88	                                'other_recommended_versions': [],
89	                                'more_info_url': 'https://pyup.io/packages/pypi/insecure-package/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/resources.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	                                'other_recommended_versions': [],
89	                                'more_info_url': 'https://pyup.io/packages/pypi/insecure-package/'
90	                            },
91	                        }}}}
92	
93	
94	# Python objects
95	SCANNED_PACKAGES = {
96	    'safety': Package(name='safety', version='2.0b1', requirements=[SafetyRequirement('safety==2.0b1')]),
97	    'click': Package(name='click', version='8.0.4', requirements=[SafetyRequirement('click==8.0.4')]),
98	    'insecure-package': Package(name='insecure-package', version='0.1.0',
99	                                requirements=[SafetyRequirement('insecure-package==0.1.0')]),
100	}
101	
102	VULNS = [Vulnerability(vulnerability_id='25853', package_name='insecure-package',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/resources.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
115	                       closest_versions_without_known_vulnerabilities=[],
116	                       resources=['https://pypi.org/project/insecure-package'],
117	                       CVE=None, severity=None, affected_versions=['0.1.0'],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/resources.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	                       CVE=None, severity=None, affected_versions=['0.1.0'],
118	                       more_info_url='https://pyup.io/vulnerabilities/PVE-2021-25853/25853/')]
119	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/resources.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	            'other_recommended_versions': [],
128	            'more_info_url': 'https://pyup.io/packages/pypi/insecure-package/'
129	        },
130	    }
131	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	        "latest_version": "2.2",
42	        "more_info_url": "https://pyup.io/package/foo",
43	    }
44	    p_kwargs.update(pkg_kwargs)
45	
46	    c_kwargs = {"name": "bla", "cvssv2": None, "cvssv3": None}
47	    c_kwargs.update(cve_kwargs)
48	
49	    cve = CVE(**c_kwargs)
50	    severity = None
51	    if cve and cve.cvssv2 or cve.cvssv3:
52	        severity = Severity(source=cve.name, cvssv2=cve.cvssv2, cvssv3=cve.cvssv3)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	        "affected_versions": [],
78	        "more_info_url": "https://pyup.io/PVE/2323",
79	    }
80	
81	    v_kwargs.update(vuln_kwargs)
82	
83	    return Vulnerability(**v_kwargs)
84	
85	
86	class TestSafetyCLI(unittest.TestCase):
87	    def setUp(self):
88	        self.maxDiff = None
89	        self.runner = CliRunner(mix_stderr=False)
90	        self.output_options = ["screen", "text", "json", "bare"]
91	        self.dirname = os.path.dirname(__file__)
92	        # Make sure the console is not quiet
93	        # TODO: This is a workaround, we should improve the way the console
94	        # is initialized in the CLI
95	        console.quiet = False
96	
97	        # Reset the commands
98	        # CLI initialization is made on the import of the module
99	        # so we need to reset the commands to avoid side effects

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	        get_announcements_func.return_value = [announcement]
169	        message = f"* {announcement.get('message')}"
170	        result = self.runner.invoke(self.cli, ["check"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
309	        # Sorting and comparing specific fields
310	        fail_scan = parsed_policy.get("fail_scan", None)
311	        self.assertIsNotNone(fail_scan)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
404	            click.unstyle(result.stderr),
405	            "The --apply-security-updates option needs authentication. See https://docs.safetycli.com/safety-docs/support/invalid-api-key-error.\n",
406	        )
407	        self.assertEqual(result.exit_code, 65)
408	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
443	                    "closest_secure_version": {"minor": None, "major": target},
444	                    "more_info_url": "https://pyup.io/p/pypi/django/52d/",
445	                }
446	            }
447	        }
448	
449	        dirname = os.path.dirname(__file__)
450	        source_req = os.path.join(dirname, "test_fix", "basic", "reqs_simple.txt")
451	
452	        with tempfile.TemporaryDirectory() as tempdir:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
468	            with open(req_file) as f:
469	                self.assertEqual("django==1.8\nsafety==2.3.0\nflask==0.87.0", f.read())
470	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
485	            with open(req_file) as f:
486	                self.assertEqual("django==1.9\nsafety==2.3.0\nflask==0.87.0", f.read())
487	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
497	                        "closest_secure_version": {"minor": None, "major": target},
498	                        "more_info_url": "https://pyup.io/p/pypi/django/52d/",
499	                    }
500	                }
501	            }
502	
503	            self.runner.invoke(
504	                self.cli,
505	                [
506	                    "check",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
517	            with open(req_file) as f:
518	                self.assertEqual("django==1.9\nsafety==2.3.0\nflask==0.87.0", f.read())
519	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
536	            with open(req_file) as f:
537	                self.assertEqual("django==2.0\nsafety==2.3.0\nflask==0.87.0", f.read())
538	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
617	            parsed_json = json.loads(json_output)
618	            vulnerabilities = parsed_json.get("vulnerabilities", [])
619	            self.assertEqual(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
624	
625	            ignored = parsed_json.get("ignored_vulnerabilities", [])
626	            self.assertEqual(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
629	
630	            reason = ignored[0].get("ignored_reason", None)
631	            self.assertEqual("", reason, "Unexpected ignore reason.")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
858	        mock_net_if_addrs.return_value = {
859	            "eth0": [Mock(family=socket.AF_INET, address="192.168.1.1")]
860	        }

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
865	                type=socket.SOCK_STREAM,
866	                laddr=Mock(ip="192.168.1.1", port=8080),
867	                raddr=Mock(ip="93.184.216.34", port=80),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:867
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
866	                laddr=Mock(ip="192.168.1.1", port=8080),
867	                raddr=Mock(ip="93.184.216.34", port=80),
868	                status="ESTABLISHED",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_cli.py:890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
889	        self.assertIsNotNone(result["download_speed"])
890	        self.assertEqual(result["interfaces"], {"eth0": ["192.168.1.1"]})
891	        self.assertEqual(result["connections"][0]["laddr"], "192.168.1.1:8080")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	            '   For more information about this vulnerability, visit',
57	            '   https://pyup.io/PVE/2323',
58	            '   To ignore this vulnerability, use PyUp vulnerability id PYUP-1234 in',
59	            '   safetyâ€™s ignore command-line argument or add the ignore to your safety',
60	            '   policy file.\n'
61	        ]
62	
63	        EXPECTED = '\n'.join(lines)
64	        self.assertEqual(output, EXPECTED)
65	
66	    @patch("safety.output_utils.is_using_api_key")
67	    def test_format_vulnerability_with_dep_spec(self, is_using_api_key):
68	        is_using_api_key.return_value = True
69	
70	        numpy_pkg = {'name': 'numpy', 'version': '1.22.0', 'requirements': [SafetyRequirement('numpy>=1.22.0')],
71	                     'secure_versions': ['1.22.3'], 'insecure_versions': ['1.22.2', '1.22.1', '1.22.0', '1.22.0rc3',
72	                                                                          '1.21.5']}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	            '   options for scanning unpinned packages visit',
108	            '   https://docs.pyup.io/docs/safety-range-specs',
109	            '   For more information about this vulnerability, visit',
110	            '   https://pyup.io/PVE/2323',
111	            '   To ignore this vulnerability, use PyUp vulnerability id PYUP-1234 in',
112	            '   safetyâ€™s ignore command-line argument or add the ignore to your safety',
113	            '   policy file.\n'
114	        ]
115	
116	        EXPECTED = '\n'.join(lines)
117	
118	        self.assertEqual(output, EXPECTED)
119	
120	    @patch("safety.output_utils.is_using_api_key")
121	    def test_format_vulnerability_with_ignored_vulnerability(self, is_using_api_key):
122	        is_using_api_key.return_value = True
123	
124	        numpy_pkg = {'name': 'numpy', 'version': '1.22.0', 'requirements': [SafetyRequirement('numpy==1.22.0')],
125	                     'secure_versions': ['1.22.3'],
126	                     'insecure_versions': ['1.22.2', '1.22.1', '1.22.0', '1.22.0rc3', '1.21.5']}
127	
128	        vulnerability = get_vulnerability(pkg_kwargs=numpy_pkg,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	            '   For more information about this vulnerability, visit',
110	            '   https://pyup.io/PVE/2323',
111	            '   To ignore this vulnerability, use PyUp vulnerability id PYUP-1234 in',
112	            '   safetyâ€™s ignore command-line argument or add the ignore to your safety',
113	            '   policy file.\n'
114	        ]
115	
116	        EXPECTED = '\n'.join(lines)
117	
118	        self.assertEqual(output, EXPECTED)
119	
120	    @patch("safety.output_utils.is_using_api_key")
121	    def test_format_vulnerability_with_ignored_vulnerability(self, is_using_api_key):
122	        is_using_api_key.return_value = True
123	
124	        numpy_pkg = {'name': 'numpy', 'version': '1.22.0', 'requirements': [SafetyRequirement('numpy==1.22.0')],
125	                     'secure_versions': ['1.22.3'],
126	                     'insecure_versions': ['1.22.2', '1.22.1', '1.22.0', '1.22.0rc3', '1.21.5']}
127	
128	        vulnerability = get_vulnerability(pkg_kwargs=numpy_pkg,
129	                                          vuln_kwargs={'ignored': True})
130	        columns = 80

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
138	            '   For more information about this vulnerability, visit',
139	            '   https://pyup.io/PVE/2323\n'
140	        ]
141	
142	        EXPECTED = '\n'.join(lines)
143	        self.assertEqual(output, EXPECTED)
144	
145	        reason = 'We do not use that feature'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	            '   For more information about this vulnerability, visit',
158	            '   https://pyup.io/PVE/2323\n',
159	        ]
160	
161	        EXPECTED = '\n'.join(lines)
162	        self.assertEqual(output, EXPECTED)
163	
164	        reason = 'We do not think this vuln is a security issue'
165	        expires = datetime.strptime('2022-06-21', '%Y-%m-%d')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
178	           f'   Reason: {reason}',
179	            '   For more information about this vulnerability, visit https://pyup.io/PVE/2323\n'
180	        ]
181	
182	        EXPECTED = '\n'.join(lines)
183	        self.assertEqual(output, EXPECTED)
184	
185	    @patch("safety.output_utils.SafetyContext")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
199	                    'latest_version_without_known_vulnerabilities': '2.2', 'latest_version': '2.2',
200	                    'more_info_url': 'https://pyup.io/package/foo'}
201	        ctx.return_value = Mock(packages=[Package(**p_kwargs)])
202	        output = get_printable_list_of_scanned_items('stdin')
203	
204	        EXPECTED = (
205	            [[{'styled': False, 'value': 'django'}]],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
268	                            'closest_secure_version': {'upper': parse('4.0.4'), 'lower': None},
269	                            'more_info_url': 'https://pyup.io/packages/pypi/django/?from=4.0.1&to=4.0.4'}}
270	        }
271	
272	        EXPECTED = ['   REMEDIATIONS',
273	                    '\n-> django version 4.0.1 was found, which has 1 vulnerability'
274	                    '\n   The closest version with no known vulnerabilities is 4.0.4'
275	                    '\n' + f"{' ' * 78}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
277	                    '\n   without known vulnerabilities are: 2.2.28, 3.2.13'
278	                    '\n' + f"{' ' * 78}"
279	                    '\n   For more information about the django package and update options, visit'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
298	                            'closest_secure_version': {'major': parse('4.0.4'), 'minor': None},
299	                            'more_info_url': 'https://pyup.io/packages/pypi/django/'}}}
300	
301	        # Start & End line decorator in format_long_text affects this output
302	        EXPECTED = ['   REMEDIATIONS',
303	                    '\n  1 vulnerability was reported in 1 package. For detailed remediation & fix '
304	                    '\n  recommendations, upgrade to a commercial license. \n',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
326	            'requirement': SafetyRequirement('django>=2.2;python_version>="3.6"'),
327	            'more_info_url': 'https://pyup.io/django',
328	            'recommended_version': '3.2.18',
329	            'other_recommended_versions': [],
330	            'closest_secure_version': {
331	                'upper': '3.2.18',
332	                'lower': None
333	            }
334	        }
335	
336	        result = get_fix_hint_for_unpinned(req_rem)
337	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
346	            'requirement': SafetyRequirement('django>=2.2'),
347	            'more_info_url': 'https://pyup.io/django',
348	            'recommended_version': '3.2.20',
349	            'other_recommended_versions': ['4.1.7', '4.2b1'],
350	            'closest_secure_version': {
351	                'upper': '3.2.18',
352	                'lower': None
353	            }
354	        }
355	
356	        result = get_fix_hint_for_unpinned(req_rem)
357	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_output_utils.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
367	            'requirement': SafetyRequirement('django>=2.2'),
368	            'more_info_url': 'https://pyup.io/django',
369	            'recommended_version': '3.2.20',
370	            'other_recommended_versions': ['4.1.7'],
371	            'closest_secure_version': {
372	                'upper': '3.2.18',
373	                'lower': None
374	            }
375	        }
376	
377	        result = get_fix_hint_for_unpinned(req_rem)
378	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	                                      'latest_version_without_known_vulnerabilities': '2.2',
70	                                      'latest_version': '2.2', 'more_info_url': 'https://pyup.io/package/default_pkg'})
71	
72	    def test_check_from_file(self):
73	        reqs = StringIO("Django==1.8.1")
74	        packages = read_requirements(reqs)
75	
76	        vulns, _ = check(
77	            session=self.session,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
179	            with open(DB_CACHE_FILE, 'w') as f:
180	                f.write(json.dumps({}))
181	        except Exception:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	        db_generic_exception = error.exception
259	        self.assertEqual(str(db_generic_exception), 'Your authentication credential is invalid. See https://docs.safetycli.com/safety-docs/support/invalid-api-key-error.')
260	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
354	            with open(DB_CACHE_FILE, 'w') as f:
355	                f.write(json.dumps({}))
356	        except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
500	
501	        expected = announcements.get('announcements')
502	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
578	                              ignore_severity_rules=ignore_rules, req=req)
579	        m_b_score = cve_cvss_medium.cvssv3.get('base_score')
580	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
629	                     'secure_versions': ['1.22.3'], 'latest_version_without_known_vulnerabilities': '2.2',
630	                     'latest_version': '2.2', 'more_info_url': 'https://pyup.io/package/numpy'}
631	
632	        vulns = [
633	            get_vulnerability(pkg_kwargs=numpy_pkg, vuln_kwargs={'affected_versions': ['1.22.0', '1.21.5']}),
634	            get_vulnerability(pkg_kwargs=numpy_pkg,
635	                              vuln_kwargs={'affected_versions': ['1.22.0', '1.22.0rc3']}),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
648	                                   'requirement': SafetyRequirement('numpy==1.22.0'),
649	                                   'more_info_url': 'https://pyup.io/package/numpy'}}
650	                    }
651	
652	        self.assertEqual(remediations, EXPECTED)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
662	        with open(test_filename) as f:
663	            db_full = json.loads(f.read())
664	        self.assertIsNotNone(db_full)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
675	                                      'requirement': SafetyRequirement('numpy==1.22.0'),
676	                                      'more_info_url': 'https://pyup.io/package/foo'}}}
677	        compute_sec_ver(remediations=rem, packages=pre_pkg_meta, secure_vulns_by_user=ignored_vulns, db_full=db_full)
678	        EXPECTED = {'numpy': {
679	            '==1.22.0': {'vulnerabilities_found': 1, 'version': '1.22.0',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
682	                         'closest_secure_version': {'upper': parse('1.22.3'), 'lower': parse('1.21.5')},
683	                         'more_info_url': 'https://pyup.io/package/foo?from=1.22.0&to=1.22.3',
684	                         'recommended_version': parse('1.22.3')}}}
685	        self.assertEqual(rem, EXPECTED)
686	
687	        pre_pkg_meta = {'numpy': copy.copy(npy)}
688	        ignored_vulns = set()
689	        rem = {'numpy': {'==1.22.0' : {'vulnerabilities_found': 2, 'version': '1.22.0',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
690	                         'requirement': SafetyRequirement('numpy==1.22.0'),
691	                         'more_info_url': 'https://pyup.io/package/foo'}}}
692	        compute_sec_ver(remediations=rem, packages=pre_pkg_meta, secure_vulns_by_user=ignored_vulns, db_full=db_full)
693	        EXPECTED = {'numpy': {'==1.22.0': {'vulnerabilities_found': 2, 'version': '1.22.0',
694	                                           'requirement': SafetyRequirement('numpy==1.22.0'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
696	                                           'closest_secure_version': {'upper': parse('1.22.3'), 'lower': None},
697	                                           'more_info_url': 'https://pyup.io/package/foo?from=1.22.0&to=1.22.3',
698	                                           'recommended_version': parse('1.22.3')}}}
699	
700	        self.assertEqual(rem, EXPECTED)
701	
702	    @patch("safety.safety.compute_sec_ver")
703	    @patch("safety.safety.precompute_remediations")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
707	        with open(test_filename) as f:
708	            db_full = json.loads(f.read())
709	        self.assertIsNotNone(db_full)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_safety.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
751	                        'recommended_version': parse('4.0.4'),
752	                        'more_info_url': 'https://pyup.io/packages/pypi/django/?from=4.0.1&to=4.0.4'}}}
753	
754	        with open(os.path.join(self.dirname, "test_db", "report_with_recommended_fix.json")) as f:
755	            vulns, remediations, packages = review(report=read_vulnerabilities(f))
756	            self.assertDictEqual(remediations, REMEDIATIONS_WITH_FIX)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/tests/test_util.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	        content = StringIO(
30	            "-e git+https://github.com/jdunck/python-unicodecsv#egg=unicodecsv"
31	        )
32	        result = list(read_requirements(content))

--------------------------------------------------

Code scanned:
	Total lines of code: 22806
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 98.0
		High: 236.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 325.0
		High: 9.0
Files skipped (0):
