Run started:2025-04-12 10:43:49.442208

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
37	    # treated as public identifiers (so we can't use the email address).
38	    username = base64.urlsafe_b64encode(
39	        hashlib.sha1(force_bytes(email)).digest()
40	    ).rstrip(b"=")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	    def describe_user_by_claims(self, claims):
74	        email = claims.get("email")
75	        return "email {}".format(email)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	        """Return all users matching the specified email."""
79	        email = claims.get("email")
80	        if not email:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	        """Return object for a newly created user account."""
101	        email = claims.get("email")
102	        username = self.get_username(claims)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
116	                # this is for backwards compatibility only
117	                return username_algo(claims.get("email"))
118	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	                # also pass the claims to the custom user name algo
120	                return username_algo(claims.get("email"), claims)
121	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	
122	        return default_username_algo(claims.get("email"), claims)
123	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	        """Get the signing key by exploring the JWKS endpoint of the OP."""
160	        response_jwks = requests.get(
161	            self.OIDC_OP_JWKS_ENDPOINT,
162	            verify=self.get_settings("OIDC_VERIFY_SSL", True),
163	            timeout=self.get_settings("OIDC_TIMEOUT", None),
164	            proxies=self.get_settings("OIDC_PROXY", None),
165	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
190	            header, payload_data, signature = token.split(b".")
191	            header = json.loads(smart_str(b64decode(header)))
192	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
194	            if "alg" in header and header["alg"] == "none":
195	                return b64decode(payload_data)
196	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	        """Validate the token signature."""
202	        nonce = kwargs.get("nonce")
203	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
224	        payload = json.loads(payload_data.decode("utf-8"))
225	        token_nonce = payload.get("nonce")
226	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
237	            # When Basic auth is defined, create the Auth Header and remove secret from payload.
238	            user = payload.get("client_id")
239	            pw = payload.get("client_secret")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238	            user = payload.get("client_id")
239	            pw = payload.get("client_secret")
240	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
243	
244	        response = requests.post(
245	            self.OIDC_OP_TOKEN_ENDPOINT,
246	            data=payload,
247	            auth=auth,
248	            verify=self.get_settings("OIDC_VERIFY_SSL", True),
249	            timeout=self.get_settings("OIDC_TIMEOUT", None),
250	            proxies=self.get_settings("OIDC_PROXY", None),
251	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
273	
274	        user_response = requests.get(
275	            self.OIDC_OP_USER_ENDPOINT,
276	            headers={"Authorization": "Bearer {0}".format(access_token)},
277	            verify=self.get_settings("OIDC_VERIFY_SSL", True),
278	            timeout=self.get_settings("OIDC_TIMEOUT", None),
279	            proxies=self.get_settings("OIDC_PROXY", None),
280	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
290	
291	        state = self.request.GET.get("state")
292	        code = self.request.GET.get("code")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	        state = self.request.GET.get("state")
292	        code = self.request.GET.get("code")
293	        nonce = kwargs.pop("nonce", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
316	        token_info = self.get_token(token_payload)
317	        id_token = token_info.get("id_token")
318	        access_token = token_info.get("access_token")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
317	        id_token = token_info.get("id_token")
318	        access_token = token_info.get("access_token")
319	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/auth.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
377	        try:
378	            return self.UserModel.objects.get(pk=user_id)
379	        except self.UserModel.DoesNotExist:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozilla_django_oidc-4.0.1-py2.py3-none-any/mozilla_django_oidc/contrib/drf.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	                raise exceptions.AuthenticationFailed(
90	                    data.get(
91	                        "error_description", "no error description in www-authenticate"
92	                    )

--------------------------------------------------

Code scanned:
	Total lines of code: 856
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 22.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 0.0
Files skipped (0):
