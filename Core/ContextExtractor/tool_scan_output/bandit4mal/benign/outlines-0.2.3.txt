Run started:2025-04-12 14:26:51.338358

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/benchmarks/bench_json_schema.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	
28	complex_schema = """{
29	  "$schema": "http://json-schema.org/draft-04/schema#",
30	  "title": "Schema for a recording",
31	  "type": "object",
32	  "definitions": {
33	    "artist": {
34	      "type": "object",
35	      "properties": {
36	        "id": {"type": "number"},
37	        "name": {"type": "string"},
38	        "functions": {
39	          "type": "array",
40	          "items": {"type": "string"}
41	        }
42	      },
43	      "required": ["id", "name", "functions"]
44	    }
45	  },
46	  "properties": {
47	    "id": {"type": "number"},
48	    "work": {
49	      "type": "object",
50	      "properties": {
51	        "id": {"type": "number"},
52	        "name": {"type": "string"},
53	        "composer": {"$ref": "#/definitions/artist"}
54	      }
55	    },
56	    "recording_artists": {
57	      "type": "array",
58	      "items": {"$ref": "#/definitions/artist"}
59	    }
60	  },
61	  "required": ["id", "work", "recording_artists"]
62	}"""
63	
64	schemas = dict(simple_schema=simple_schema, complex_schema=complex_schema)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/examples/react.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	def search_wikipedia(query: str):
44	    url = f"https://en.wikipedia.org/w/api.php?format=json&action=query&prop=extracts&exintro&explaintext&redirects=1&titles={query}&origin=*"
45	    response = requests.get(url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/examples/react.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	    url = f"https://en.wikipedia.org/w/api.php?format=json&action=query&prop=extracts&exintro&explaintext&redirects=1&titles={query}&origin=*"
45	    response = requests.get(url)
46	    page = response.json()["query"]["pages"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/outlines/fsm/guide.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	        warnings.warn(
111	            "Outlines' public *community-contributed* CFG structured generation is experimental. "
112	            "Please review https://dottxt-ai.github.io/outlines/latest/reference/generation/cfg#disclaimer"
113	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/outlines/function.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	    """Download the file in which the function is stored on GitHub."""
67	    GITHUB_BASE_URL = "https://raw.githubusercontent.com"
68	    BRANCH = "main"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/outlines/function.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	    url = "/".join([GITHUB_BASE_URL, username, repo, BRANCH] + path_to_file) + ".py"
83	    result = requests.get(url)
84	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/outlines/function.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
102	        module = importlib.util.module_from_spec(spec)
103	        exec(content, module.__dict__)
104	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/outlines/models/exllamav2.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
304	        raise ImportError(
305	            "The `exllamav2`, `transformers` and `torch` libraries needs to be installed in order to use `exllamav2` models. "
306	            "Please run `pip install transformers torch git+https://github.com/lapp0/exllamav2@sampler-logits-processor` "
307	            "Documentation: https://dottxt-ai.github.io/outlines/latest/reference/models/exllamav2/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/outlines/models/llamacpp.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
398	            "The pre-tokenizer in `llama.cpp` handles unicode improperly "
399	            + "(https://github.com/ggerganov/llama.cpp/pull/5613)\n"
400	            + "Outlines may raise a `RuntimeError` when building the regex index.\n"
401	            + "To circumvent this error when using `models.llamacpp()` you may pass the argument"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/generate/test_api.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	IMG_URI = "https://upload.wikimedia.org/wikipedia/en/a/a9/Example.jpg"
10	PIL_IMG = Image.open(BytesIO(urlopen(IMG_URI).read())).convert("RGB")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/generate/test_api.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
9	IMG_URI = "https://upload.wikimedia.org/wikipedia/en/a/a9/Example.jpg"
10	PIL_IMG = Image.open(BytesIO(urlopen(IMG_URI).read())).convert("RGB")
11	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/generate/test_generate.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
217	    if fixture_name.endswith("_vision"):
218	        img_url = "https://python-pillow.org/pillow-perf/static/space_pil_lanczos.png"
219	        img = Image.open(BytesIO(urlopen(img_url).read())).convert("RGB")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/generate/test_generate.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
218	        img_url = "https://python-pillow.org/pillow-perf/static/space_pil_lanczos.png"
219	        img = Image.open(BytesIO(urlopen(img_url).read())).convert("RGB")
220	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/generate/test_generate.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
268	@pytest.mark.skip(
269	    "Fix issues with JSON, some models fail this test https://github.com/dottxt-ai/outlines/issues/985"
270	)
271	@pytest.mark.parametrize("model_fixture", ALL_MODEL_FIXTURES)
272	def test_generate_json(request, model_fixture, sample_schema):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/generate/test_integration_transformers_vision.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	IMAGE_URLS = [
12	    "https://upload.wikimedia.org/wikipedia/commons/2/25/Siam_lilacpoint.jpg",
13	    "https://upload.wikimedia.org/wikipedia/commons/7/71/2010-kodiak-bear-1.jpg",
14	    "https://upload.wikimedia.org/wikipedia/commons/b/be/Tamias-rufus-001.jpg",
15	]
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/generate/test_integration_transformers_vision.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    "https://upload.wikimedia.org/wikipedia/commons/2/25/Siam_lilacpoint.jpg",
13	    "https://upload.wikimedia.org/wikipedia/commons/7/71/2010-kodiak-bear-1.jpg",
14	    "https://upload.wikimedia.org/wikipedia/commons/b/be/Tamias-rufus-001.jpg",
15	]
16	
17	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/generate/test_integration_transformers_vision.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    "https://upload.wikimedia.org/wikipedia/commons/7/71/2010-kodiak-bear-1.jpg",
14	    "https://upload.wikimedia.org/wikipedia/commons/b/be/Tamias-rufus-001.jpg",
15	]
16	
17	
18	def img_from_url(url):

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/generate/test_integration_transformers_vision.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
18	def img_from_url(url):
19	    img_byte_stream = BytesIO(urlopen(url).read())
20	    return Image.open(img_byte_stream).convert("RGB")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/test_function.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	        responses.GET,
40	        "https://raw.githubusercontent.com/dottxt-ai/outlines/main/program.py",
41	        body="import outlines\n",
42	        status=200,
43	    )
44	
45	    file = download_from_github("dottxt-ai/outlines/program")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/test_function.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        responses.GET,
50	        "https://raw.githubusercontent.com/dottxt-ai/outlines/main/foo/bar/program.py",
51	        body="import outlines\n",
52	        status=200,
53	    )
54	
55	    file = download_from_github("dottxt-ai/outlines/foo/bar/program")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/test_function.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	        responses.GET,
63	        "https://raw.githubusercontent.com/foo/bar/main/program.py",
64	        json={"error": "not found"},
65	        status=404,
66	    )
67	
68	    with pytest.raises(ValueError, match="Program could not be found at"):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/test_function.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        responses.GET,
73	        "https://raw.githubusercontent.com/foo/bar/main/program.py",
74	        json={"error": "Internal Server Error"},
75	        status=500,
76	    )
77	
78	    with pytest.raises(HTTPError, match="500 Server Error"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/test_templates.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
367	    with open(base_template_path, "w") as f:
368	        f.write(
369	            """{% block content %}{% endblock %}
370	"""

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/test_templates.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
367	    with open(base_template_path, "w") as f:
368	        f.write(
369	            """{% block content %}{% endblock %}
370	"""

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/test_templates.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
374	    with open(include_file_path, "w") as f:
375	        f.write(
376	            """{% for example in examples %}
377	- Q: {{ example.question }}

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/test_templates.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
374	    with open(include_file_path, "w") as f:
375	        f.write(
376	            """{% for example in examples %}
377	- Q: {{ example.question }}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/test_templates.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
384	    with open(prompt_file_path, "w") as f:
385	        f.write(
386	            """{% extends "base_template.txt" %}
387	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/outlines-0.2.3/outlines-0.2.3/tests/test_templates.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
384	    with open(prompt_file_path, "w") as f:
385	        f.write(
386	            """{% extends "base_template.txt" %}
387	

--------------------------------------------------

Code scanned:
	Total lines of code: 11924
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 1.0
Files skipped (0):
