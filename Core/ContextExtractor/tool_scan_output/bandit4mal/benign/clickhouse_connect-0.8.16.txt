Run started:2025-04-12 15:09:57.296400

Test results:
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/common.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
40	        try:
41	            os_user = f'; os_user:{getpass.getuser()}'
42	        except Exception:  # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/common.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
40	        try:
41	            os_user = f'; os_user:{getpass.getuser()}'
42	        except Exception:  # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/datatypes/network.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
48	        if fmt == 'string':
49	            return '0.0.0.0'
50	        if fmt == 'int':

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/asyncclient.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
30	            executor_threads = min(32, (os.cpu_count() or 1) + 4)  # Mimic the default behavior
31	        self.executor = ThreadPoolExecutor(max_workers=executor_threads)
32	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/asyncclient.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	        self.client.close()
72	        await asyncio.to_thread(self.executor.shutdown, True)
73	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
121	        elif (not client_cert or tls_mode in ('strict', 'proxy')) and username:
122	            self.headers['Authorization'] = 'Basic ' + b64encode(f'{username}:{password}'.encode()).decode()
123	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:122
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
121	        elif (not client_cert or tls_mode in ('strict', 'proxy')) and username:
122	            self.headers['Authorization'] = 'Basic ' + b64encode(f'{username}:{password}'.encode()).decode()
123	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
212	        if not context.is_insert and columns_only_re.search(context.uncommented_query):
213	            response = self._raw_request(f'{context.final_query}\n FORMAT JSON',
214	                                         params, headers, retries=self.query_retries)
215	            json_result = json.loads(response.data)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
238	            headers['Content-Type'] = 'text/plain; charset=utf-8'
239	        response = self._raw_request(body,
240	                                     params,
241	                                     headers,
242	                                     stream=True,
243	                                     retries=self.query_retries,
244	                                     fields=fields,
245	                                     server_wait=not context.streaming)
246	        byte_source = RespBuffCls(ResponseSource(response))  # pylint: disable=not-callable

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
279	
280	        response = self._raw_request(block_gen, params, headers, error_handler=error_handler, server_wait=False)
281	        logger.debug('Context insert response code: %d, content: %s', response.status, response.data)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
309	        params.update(self._validate_settings(settings or {}))
310	        response = self._raw_request(insert_block, params, headers, server_wait=False)
311	        logger.debug('Raw insert response code: %d, content: %s', response.status, response.data)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
360	        method = 'POST' if payload or fields else 'GET'
361	        response = self._raw_request(payload, params, headers, method, fields=fields, server_wait=False)
362	        if response.data:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
448	            try:
449	                response = self.http.request(method, url, **kwargs)
450	            except HTTPError as ex:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
485	        body, params, fields = self._prep_raw_query(query, parameters, settings, fmt, use_database, external_data)
486	        return self._raw_request(body, params, fields=fields).data
487	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
497	        body, params, fields = self._prep_raw_query(query, parameters, settings, fmt, use_database, external_data)
498	        return self._raw_request(body, params, fields=fields, stream=True, server_wait=False)
499	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httpclient.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
529	        try:
530	            response = self.http.request('GET', f'{self.url}/ping', timeout=3, preload_content=True)
531	            return 200 <= response.status < 300

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httputil.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	            zstd_decom = zstandard.ZstdDecompressor()
147	            return zstd_decom.stream_reader(response.data).read()
148	        except zstandard.ZstdError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/httputil.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
259	        self.response.drain_conn()
260	        self.response.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/clickhouse_connect/driver/query.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
383	    with pyarrow.RecordBatchFileWriter(sink, table.schema, options=options) as writer:
384	        writer.write(table)
385	    return table.schema.names, sink.getvalue()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/setup.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	    with open(os.path.join(project_dir, 'README.md'), encoding='utf-8') as read_me:
31	        long_desc = read_me.read()
32	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/setup.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
38	        with open(os.path.join(project_dir, 'clickhouse_connect', '__version__.py'), encoding='utf-8') as version_file:
39	            file_version = version_file.read().strip()
40	            match = re.search(r"version\s*=\s*'(.+)'", file_version)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/clickhouse_connect-0.8.16/clickhouse_connect-0.8.16/setup.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	        package_data={'clickhouse_connect': ['VERSION', 'py.typed']},
55	        url='https://github.com/ClickHouse/clickhouse-connect',
56	        packages=find_packages(exclude=['tests*']),

--------------------------------------------------

Code scanned:
	Total lines of code: 7480
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 2.0
Files skipped (0):
