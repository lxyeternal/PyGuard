Run started:2025-04-12 13:55:19.157417

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwe/fernet.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
31	                raise ValueError("Raw key must be 32 bytes")
32	            self.key = base64.urlsafe_b64encode(key)
33	        elif password is not None:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwe/fernet.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
41	            kdf = PBKDF2HMAC(algorithm=_algorithm, length=32, salt=salt, iterations=iterations)
42	            self.key = base64.urlsafe_b64encode(kdf.derive(as_bytes(password)))
43	        else:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwe/jwe_hmac.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
92	        if "zip" in self and self["zip"] == "DEF":
93	            msg = zlib.decompress(msg)
94	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwe/jwe_hmac.py:93
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
92	        if "zip" in self and self["zip"] == "DEF":
93	            msg = zlib.decompress(msg)
94	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwe/jwe_rsa.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
129	        if "zip" in jwe.headers and jwe.headers["zip"] == "DEF":
130	            msg = zlib.decompress(msg)
131	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwe/jwe_rsa.py:130
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
129	        if "zip" in jwe.headers and jwe.headers["zip"] == "DEF":
130	            msg = zlib.decompress(msg)
131	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/__init__.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
307	        as_unicode(v)
308	        for v in [base64.b64encode(d) for d in [ssl.PEM_cert_to_DER_cert(c) for c in cert_chain]]
309	    ]

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/__init__.py:308
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
307	        as_unicode(v)
308	        for v in [base64.b64encode(d) for d in [ssl.PEM_cert_to_DER_cert(c) for c in cert_chain]]
309	    ]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/__init__.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
321	        ssl.DER_cert_to_PEM_cert(d)
322	        for d in [base64.b64decode(x) for x in [as_bytes(y) for y in x5c]]
323	    ]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/__init__.py:322
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
321	        ssl.DER_cert_to_PEM_cert(d)
322	        for d in [base64.b64decode(x) for x in [as_bytes(y) for y in x5c]]
323	    ]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/__init__.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
333	
334	    return [base64.b64decode(x) for x in [as_bytes(y) for y in x5c]]
335	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/__init__.py:334
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
333	
334	    return [base64.b64decode(x) for x in [as_bytes(y) for y in x5c]]
335	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/__init__.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
356	    with open(pem_file) as fp:
357	        pem = fp.read()
358	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/ec.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
338	    with open(pem_file) as cert_file:
339	        return import_ec_key(cert_file.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/jwk.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
201	    with open(filename, "w") as fp:
202	        fp.write(json.dumps(key.to_dict()))
203	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/jwk.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	        with open(filename) as jwk_file:
209	            jwk_dict = json.loads(jwk_file.read())
210	            return key_from_jwk_dict(jwk_dict)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/okp.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
373	    with open(pem_file) as cert_file:
374	        return import_okp_key(cert_file.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/rsa.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
58	            )
59	        keyfile.write(pem)
60	        keyfile.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/rsa.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
110	    with open(pem_file) as cert_file:
111	        return import_rsa_key(cert_file.read())
112	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/rsa.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
323	            for der_data in self.x5c:
324	                _cert_chain.append(der_cert(base64.b64decode(der_data)))
325	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/rsa.py:324
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
323	            for der_data in self.x5c:
324	                _cert_chain.append(der_cert(base64.b64decode(der_data)))
325	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/x509.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
122	    if isinstance(cert, str):
123	        der_cert = base64.b64decode(cert.encode("ascii"))
124	    else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/x509.py:123
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
122	    if isinstance(cert, str):
123	        der_cert = base64.b64decode(cert.encode("ascii"))
124	    else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/x509.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
124	    else:
125	        der_cert = base64.b64decode(cert)
126	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/jwk/x509.py:125
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
124	    else:
125	        der_cert = base64.b64decode(cert)
126	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	    """
144	    curve = spec.get("crv", "P-256")
145	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	    """
167	    curve = spec.get("crv", "Ed25519")
168	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	            self.source = None
277	            initial_keys = keys.get("keys", [keys]) if isinstance(keys, dict) else keys
278	            self._keys = self.jwk_dicts_as_keys(initial_keys)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
404	        with open(filename) as input_file:
405	            _info = json.load(input_file)
406	        if "keys" in _info:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
501	                headers = _http_resp.headers
502	                self.last_remote = headers.get("last-modified") or headers.get("date")
503	        elif not_modified:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
501	                headers = _http_resp.headers
502	                self.last_remote = headers.get("last-modified") or headers.get("date")
503	        elif not_modified:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
843	
844	        _keys = spec.get("keys", [])
845	        if _keys:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
849	        for attr in self.params:
850	            val = spec.get(attr)
851	            if val:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:1172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1171	
1172	    keys = key_bundle.get()
1173	    diff = {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:1261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1260	    key_spec = []
1261	    for key in bundle.get():
1262	        _spec = {"type": key.kty, "use": [key.use]}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:1268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1267	
1268	    diff = {"del": bundle.get()}
1269	    _kb = build_key_bundle(key_spec)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:1315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1314	    if type.upper() == "RSA":
1315	        keysize = kwargs.get("size", DEFAULT_RSA_KEYSIZE)
1316	        public_exponent = kwargs.get("exp", DEFAULT_RSA_EXP)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:1316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1315	        keysize = kwargs.get("size", DEFAULT_RSA_KEYSIZE)
1316	        public_exponent = kwargs.get("exp", DEFAULT_RSA_EXP)
1317	        _key = new_rsa_key(public_exponent=public_exponent, key_size=keysize, **kargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:1319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1318	    elif type.upper() == "EC":
1319	        crv = kwargs.get("crv", DEFAULT_EC_CURVE)
1320	        if crv not in NIST2SEC:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:1325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1324	    elif type.upper() == "OKP":
1325	        crv = kwargs.get("crv", DEFAULT_OKP_CURVE)
1326	        if crv not in OKP_CRV2PUBLIC:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_bundle.py:1331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1330	    elif type.lower() in ["sym", "oct"]:
1331	        keysize = kwargs.get("bytes", 24)
1332	        randomkey = os.urandom(keysize)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_issuer.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
243	        with open(filename) as jwks_file:
244	            self.import_jwks_as_json(jwks_file.read())
245	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_issuer.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
288	                if key_use in ["ver", "dec"]:
289	                    _bkeys = bundle.get(key_type, only_active=False)
290	                else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_issuer.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
290	                else:
291	                    _bkeys = bundle.get(key_type)
292	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_issuer.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
322	            else:
323	                _crv = kwargs.get("crv")
324	                if _crv:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_issuer.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
382	        for attr in self.params:
383	            val = info.get(attr)
384	            if val:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_issuer.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
388	
389	        self._bundles = [KeyBundle().load(val) for val in info["bundles"]]
390	        return self

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_issuer.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
569	            with open(private_path) as fp:
570	                _jwks = fp.read()
571	            _issuer = KeyIssuer()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_issuer.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
604	            with open(public_path) as fp:
605	                _jwks = fp.read()
606	            _issuer = KeyIssuer()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	
75	        return self._issuers.get(issuer_id)
76	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
192	
193	        return _issuer.get(key_use=key_use, key_type=key_type, kid=kid, **kwargs)
194	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	        """
206	        return self.get("sig", key_type, issuer_id, kid, **kwargs)
207	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
209	    def get_verify_key(self, key_type="", issuer_id="", kid=None, **kwargs):
210	        return self.get("ver", key_type, issuer_id, kid, **kwargs)
211	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	    def get_encrypt_key(self, key_type="", issuer_id="", kid=None, **kwargs):
214	        return self.get("enc", key_type, issuer_id, kid, **kwargs)
215	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	    def get_decrypt_key(self, key_type="", issuer_id="", kid=None, **kwargs):
218	        return self.get("dec", key_type, issuer_id, kid, **kwargs)
219	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	
233	        return self.get(usage, ktype, issuer_id)
234	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	        if kid:
479	            for _key in _issuer.get(use, kid=kid, key_type=key_type):
480	                if _key and _key not in keys:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
484	            try:
485	                _add_keys = _issuer.get(use, key_type=key_type)
486	            except KeyError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
528	
529	        keys = self.get(key_use="enc", issuer_id="", key_type=_key_type)
530	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
562	
563	        allow_missing_kid = kwargs.get("allow_missing_kid", False)
564	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
565	        _key_type = ""
566	        if jwt.headers.get("alg"):
567	            _key_type = jws_alg2keytype(jwt.headers["alg"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
568	
569	        _kid = jwt.headers.get("kid", "")
570	        nki = kwargs.get("no_kid_issuer", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
569	        _kid = jwt.headers.get("kid", "")
570	        nki = kwargs.get("no_kid_issuer", {})
571	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
571	
572	        _payload = jwt.payload()
573	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
573	
574	        _iss = _payload.get("iss") or kwargs.get("iss") or ""
575	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
573	
574	        _iss = _payload.get("iss") or kwargs.get("iss") or ""
575	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
576	        if not _iss:
577	            _iss = kwargs.get("issuer")
578	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
592	            if _key_type == "oct":
593	                keys.extend(self.get(key_use="sig", issuer_id="", key_type=_key_type))
594	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
595	            # No issuer, just use all keys I have
596	            keys = self.get(key_use="sig", issuer_id="", key_type=_key_type)
597	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
688	        """
689	        self.ca_certs = info.get("ca_certs")
690	        self.httpc_params = info.get("httpc_params")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
689	        self.ca_certs = info.get("ca_certs")
690	        self.httpc_params = info.get("httpc_params")
691	        self.keybundle_cls = importer(info.get("keybundle_cls", KeyBundle))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
690	        self.httpc_params = info.get("httpc_params")
691	        self.keybundle_cls = importer(info.get("keybundle_cls", KeyBundle))
692	        self.remove_after = info.get("remove_after", 3600)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
691	        self.keybundle_cls = importer(info.get("keybundle_cls", KeyBundle))
692	        self.remove_after = info.get("remove_after", 3600)
693	        self.spec2key = info.get("spec2key", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
692	        self.remove_after = info.get("remove_after", 3600)
693	        self.spec2key = info.get("spec2key", {})
694	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
694	
695	        _issuers = info.get("issuers")
696	        if _issuers is None:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
699	            for _issuer_id, _issuer_desc in _issuers.items():
700	                self._issuers[_issuer_id] = KeyIssuer().load(_issuer_desc)
701	        return self

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/key_jar.py:704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
703	    def loads(self, string):
704	        return self.load(json.loads(string))
705	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/tools/jwtpeek.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
111	        with open(args.jwk) as fp:
112	            _key = key_from_jwk_dict(fp.read())
113	        keys.append(_key)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/tools/jwtpeek.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
117	        with open(args.jwks) as fp:
118	            _iss.import_jwks(fp.read())
119	        keys.extend(_iss.all_keys())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/tools/jwtpeek.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
125	    if not args.msg or args.msg == "-":  # If nothing specified assume stdin
126	        message = sys.stdin.read()
127	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/tools/jwtpeek.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	            with open(args.msg) as fp:
130	                message = fp.read().strip("\n")
131	        else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/utils.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
50	        data = b"\x00"
51	    s = base64.urlsafe_b64encode(data).rstrip(b"=")
52	    return s.decode("ascii")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/utils.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
59	    # urlsafe_b64decode will happily convert b64encoded data
60	    _d = base64.urlsafe_b64decode(as_bytes(data) + b"==")
61	    return intarr2long(struct.unpack(f"{len(_d)}B", _d))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/utils.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
72	    _data = as_bytes(data)
73	    _d = base64.urlsafe_b64decode(_data + b"==")
74	    # verify that it's base64url encoded and not just base64

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/utils.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
87	    Uses the url-safe - and _ characters, and doesn't pad with = characters."""
88	    return base64.urlsafe_b64encode(b).rstrip(b"=")
89	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cryptojwt-1.9.4/cryptojwt-1.9.4/src/cryptojwt/utils.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
125	
126	    return base64.urlsafe_b64decode(b)
127	

--------------------------------------------------

Code scanned:
	Total lines of code: 7167
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 78.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 78.0
		High: 8.0
Files skipped (0):
