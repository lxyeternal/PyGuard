Run started:2025-04-12 10:18:22.485147

Test results:
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/client.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
56	                                  headers=self.headers)
57	        pickled_weights = urllib2.urlopen(request).read()
58	        return pickle.loads(pickled_weights)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/client.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	    def update_parameters(self, delta: list):
61	        request = urllib2.Request('http://{}/update'.format(self.master_url),
62	                                  pickle.dumps(delta, -1), headers=self.headers)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/client.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
62	                                  pickle.dumps(delta, -1), headers=self.headers)
63	        return urllib2.urlopen(request).read()
64	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/client.py:78
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
77	    def get_parameters(self):
78	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
79	            host = determine_master(port=self.port).split(':')[0]

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/client.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
79	            host = determine_master(port=self.port).split(':')[0]
80	            sock.connect((host, self.port))
81	            sock.sendall(b'g')

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/client.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
80	            sock.connect((host, self.port))
81	            sock.sendall(b'g')
82	            data = np.asarray(receive(sock))

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/client.py:86
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
85	    def update_parameters(self, delta: list):
86	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
87	            host = determine_master(port=self.port).split(':')[0]

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/client.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
87	            host = determine_master(port=self.port).split(':')[0]
88	            sock.connect((host, self.port))
89	            data = {'delta': delta}

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/client.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
89	            data = {'delta': delta}
90	            sock.sendall(b'u')
91	            send(sock, data)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/client.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
90	            sock.sendall(b'u')
91	            send(sock, data)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/server.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
96	
97	        self.server = Process(target=self.start_flask_service)
98	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/server.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
105	        self.server.join()
106	        self.server.close()
107	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/server.py:186
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
185	    def start_server(self):
186	        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
187	        sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/server.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
201	                del thread
202	            self.socket.close()
203	            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/server.py:203
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
202	            self.socket.close()
203	            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
204	            try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/server.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
205	                host = determine_master(port=self.port).split(':')[0]
206	                sock.connect((host, self.port))
207	                sock.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/server.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
206	                sock.connect((host, self.port))
207	                sock.close()
208	            except Exception:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/server.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
221	        weights = self.master_network.get_weights()
222	        send(conn, weights)
223	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/parameter/server.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
225	        while self.runs:
226	            get_or_update = conn.recv(1).decode()
227	            if get_or_update == 'u':

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/spark_model.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
434	                    predictions.extend(outputs.logits.numpy())
435	                shutil.rmtree(model_dir)
436	                return predictions

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/spark_model.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
500	                    generations.extend(outputs)
501	                shutil.rmtree(model_dir)
502	                return generations

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/spark_model.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
556	                partition_results = __call(partition, model)
557	                shutil.rmtree(model_dir)
558	                return partition_results

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/utils/sockets.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
20	    else:
21	        return gethostbyname(gethostname()) + ":" + str(port)
22	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/utils/sockets.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
20	    else:
21	        return gethostbyname(gethostname()) + ":" + str(port)
22	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/utils/sockets.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
36	    while buffer_size < num_bytes:
37	        data = socket.recv(bytes_left)
38	        delta = len(data)

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/utils/sockets.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
69	    length = str(len(pickled_data)).zfill(num_bytes)
70	    socket.sendall(length.encode())
71	    socket.sendall(pickled_data)

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elephas-6.2.1-py3-none-any/elephas/utils/sockets.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
70	    socket.sendall(length.encode())
71	    socket.sendall(pickled_data)

--------------------------------------------------

Code scanned:
	Total lines of code: 1818
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 21.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 5.0
Files skipped (0):
