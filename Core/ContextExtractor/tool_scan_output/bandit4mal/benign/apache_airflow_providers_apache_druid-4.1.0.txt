Run started:2025-04-12 10:21:39.961114

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/get_provider_info.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        "name": "Apache Druid",
28	        "description": "`Apache Druid <https://druid.apache.org/>`__.\n",
29	        "state": "ready",
30	        "source-date-epoch": 1741507815,
31	        "versions": [
32	            "4.1.0",
33	            "4.0.0",
34	            "3.12.1",
35	            "3.12.0",
36	            "3.11.0",
37	            "3.10.2",
38	            "3.10.1",
39	            "3.10.0",
40	            "3.9.0",
41	            "3.8.1",
42	            "3.8.0",
43	            "3.7.0",
44	            "3.6.0",
45	            "3.5.0",
46	            "3.4.2",
47	            "3.4.1",
48	            "3.4.0",
49	            "3.3.1",
50	            "3.3.0",
51	            "3.2.1",
52	            "3.2.0",
53	            "3.1.0",
54	            "3.0.0",
55	            "2.3.3",
56	            "2.3.2",
57	            "2.3.1",
58	            "2.3.0",
59	            "2.2.0",
60	            "2.1.0",
61	            "2.0.2",
62	            "2.0.1",
63	            "2.0.0",
64	            "1.1.0",
65	            "1.0.1",
66	            "1.0.0",
67	        ],
68	        "integrations": [
69	            {
70	                "integration-name": "Apache Druid",
71	                "external-doc-url": "https://druid.apache.org/",
72	                "logo": "/docs/integration-logos/druid-1.png",
73	                "how-to-guide": ["/docs/apache-airflow-providers-apache-druid/operators.rst"],
74	                "tags": ["apache"],
75	            }
76	        ],
77	        "operators": [
78	            {
79	                "integration-name": "Apache Druid",
80	                "python-modules": ["airflow.providers.apache.druid.operators.druid"],
81	            }
82	        ],
83	        "hooks": [
84	            {
85	                "integration-name": "Apache Druid",
86	                "python-modules": ["airflow.providers.apache.druid.hooks.druid"],
87	            }
88	        ],
89	        "connection-types": [
90	            {
91	                "hook-class-name": "airflow.providers.apache.druid.hooks.druid.DruidDbApiHook",
92	                "connection-type": "druid",
93	            }
94	        ],
95	        "transfers": [
96	            {
97	                "source-integration-name": "Apache Hive",
98	                "target-integration-name": "Apache Druid",
99	                "python-module": "airflow.providers.apache.druid.transfers.hive_to_druid",
100	            }
101	        ],
102	        "dependencies": [
103	            "apache-airflow>=2.9.0",
104	            "apache-airflow-providers-common-sql>=1.20.0",
105	            "pydruid>=0.4.1",
106	        ],
107	        "optional-dependencies": {"apache.hive": ["apache-airflow-providers-apache-hive"]},
108	        "devel-dependencies": [],
109	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/get_provider_info.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	                "integration-name": "Apache Druid",
71	                "external-doc-url": "https://druid.apache.org/",
72	                "logo": "/docs/integration-logos/druid-1.png",
73	                "how-to-guide": ["/docs/apache-airflow-providers-apache-druid/operators.rst"],
74	                "tags": ["apache"],
75	            }
76	        ],
77	        "operators": [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	        if ingestion_type == IngestionType.BATCH:
102	            endpoint = self.conn.extra_dejson.get("endpoint", "")
103	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	        else:
104	            endpoint = self.conn.extra_dejson.get("msq_endpoint", "")
105	        return f"{conn_type}://{host}:{port}/{endpoint}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	            if self.get_connection_type == "druid":
111	                conn_type = self.conn.extra_dejson.get("schema", "http")
112	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	
115	            status_endpoint = self.conn.extra_dejson.get("status_endpoint", self.status_endpoint)
116	            return f"{conn_type}://{self.conn.host}:{self.conn.port}/{status_endpoint}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	    def get_verify(self) -> bool | str:
134	        ca_bundle_path: str | None = self.conn.extra_dejson.get("ca_bundle_path", None)
135	        if not self.verify_ssl and ca_bundle_path:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
147	        self.log.info("Druid ingestion spec: %s", json_index_spec)
148	        req_index = requests.post(
149	            url, data=json_index_spec, headers=self.header, auth=self.get_auth(), verify=self.get_verify()
150	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
170	        while running:
171	            req_status = requests.get(druid_task_status_url, auth=self.get_auth(), verify=self.get_verify())
172	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
176	                # ensure that the job gets killed if the max ingestion time is exceeded
177	                requests.post(
178	                    f"{url}/{druid_task_id}/shutdown", auth=self.get_auth(), verify=self.get_verify()
179	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
226	            port=conn.port,
227	            path=conn.extra_dejson.get("endpoint", "/druid/v2/sql"),
228	            scheme=conn.extra_dejson.get("schema", "http"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	            path=conn.extra_dejson.get("endpoint", "/druid/v2/sql"),
228	            scheme=conn.extra_dejson.get("schema", "http"),
229	            user=conn.login,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_druid-4.1.0/apache_airflow_providers_apache_druid-4.1.0/src/airflow/providers/apache/druid/hooks/druid.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	        conn_type = conn.conn_type or "druid"
247	        endpoint = conn.extra_dejson.get("endpoint", "druid/v2/sql")
248	        return f"{conn_type}://{host}/{endpoint}"

--------------------------------------------------

Code scanned:
	Total lines of code: 522
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 0.0
Files skipped (0):
