Run started:2025-04-12 13:54:00.081321

Test results:
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/api/fields.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
26	    def to_representation(self, obj):
27	        return zlib.decompress(obj).decode("utf8")
28	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/api/fields.py:27
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
26	    def to_representation(self, obj):
27	        return zlib.decompress(obj).decode("utf8")
28	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/api/fields.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
40	    def to_representation(self, obj):
41	        return json.loads(zlib.decompress(obj).decode("utf8"))
42	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/api/fields.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
40	    def to_representation(self, obj):
41	        return json.loads(zlib.decompress(obj).decode("utf8"))
42	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/api/fields.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
53	    def to_representation(self, obj):
54	        return zlib.decompress(obj.contents).decode("utf8")
55	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/api/fields.py:54
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
53	    def to_representation(self, obj):
54	        return zlib.decompress(obj.contents).decode("utf8")
55	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/api/management/commands/prune.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	            type=str,
29	            default="http://127.0.0.1:8000",
30	            help="API endpoint to use for the query (default: 'http://127.0.0.1:8000')",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/api/management/commands/prune.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	            default="http://127.0.0.1:8000",
30	            help="API endpoint to use for the query (default: 'http://127.0.0.1:8000')",
31	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/api/tests/tests_records.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	        self.assertEqual(0, models.Record.objects.count())
91	        test_url = "https://ara.recordsansible.org"
92	        request = self.client.post(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/cli/base.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        metavar="<url>",
27	        default=os.environ.get("ARA_API_SERVER", "http://127.0.0.1:8000"),
28	        help=("API server endpoint if using http client, defaults to ARA_API_SERVER or 'http://127.0.0.1:8000'"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/cli/base.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        default=os.environ.get("ARA_API_SERVER", "http://127.0.0.1:8000"),
28	        help=("API server endpoint if using http client, defaults to ARA_API_SERVER or 'http://127.0.0.1:8000'"),
29	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	class HttpClient:
16	    def __init__(self, endpoint="http://127.0.0.1:8000", auth=None, cert=None, timeout=30, verify=True):
17	        self.log = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
43	        # http://127.0.0.1:8000 / api/v1/playbooks
44	        return self.http.request(method, self.endpoint + url, timeout=self.timeout, **payload)
45	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
47	        if payload:
48	            return self._request("get", url, **payload)
49	        else:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
49	        else:
50	            return self._request("get", url)
51	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
52	    def patch(self, url, **payload):
53	        return self._request("patch", url, data=json.dumps(payload))
54	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
55	    def post(self, url, **payload):
56	        return self._request("post", url, data=json.dumps(payload))
57	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
58	    def put(self, url, **payload):
59	        return self._request("put", url, data=json.dumps(payload))
60	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
61	    def delete(self, url):
62	        return self._request("delete", url)
63	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	class AraHttpClient:
66	    def __init__(self, endpoint="http://127.0.0.1:8000", auth=None, cert=None, timeout=30, verify=True):
67	        self.log = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
98	    def get(self, endpoint, **kwargs):
99	        return self._request("get", endpoint, params=kwargs)
100	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
101	    def patch(self, endpoint, **kwargs):
102	        return self._request("patch", endpoint, **kwargs)
103	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
104	    def post(self, endpoint, **kwargs):
105	        return self._request("post", endpoint, **kwargs)
106	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
107	    def put(self, endpoint, **kwargs):
108	        return self._request("put", endpoint, **kwargs)
109	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/http.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
110	    def delete(self, endpoint, **kwargs):
111	        return self._request("delete", endpoint)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/offline.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	        self._start_server()
35	        super().__init__(endpoint="http://localhost:%d" % self.server_thread.port, auth=auth)
36	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/offline.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	    def _start_server(self):
38	        self.server_thread = ServerThread("localhost")
39	        self.server_thread.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/clients/utils.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    client="offline",
11	    endpoint="http://127.0.0.1:8000",
12	    timeout=30,
13	    username=None,
14	    password=None,
15	    cert=None,
16	    key=None,
17	    verify=True,
18	    run_sql_migrations=True,
19	):
20	    """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/action/ara_playbook.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	EXAMPLES = """
30	- name: Get a specific playbook
31	  ara_playbook:
32	    playbook_id: 5
33	  register: playbook_query
34	
35	- name: Get current playbook by not specifying a playbook id
36	  ara_playbook:
37	  register: playbook_query
38	
39	- name: Do something with the playbook
40	  debug:
41	    msg: "Playbook report: http://ara_api/playbook/{{ playbook_query.playbook.id | string }}.html"
42	"""
43	
44	RETURN = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/action/ara_record.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	
42	EXAMPLES = """
43	- name: Associate specific data to a key for a playbook
44	  ara_record:
45	    key: "foo"
46	    value: "bar"
47	
48	- name: Associate data to a playbook that previously ran
49	  ara_record:
50	    playbook_id: 21
51	    key: logs
52	    value: "{{ lookup('file', '/var/log/ansible.log') }}"
53	    type: text
54	
55	- name: Retrieve the git version of the development repository
56	  shell: cd dev && git rev-parse HEAD
57	  register: git_version
58	  delegate_to: localhost
59	
60	- name: Record and register the git version of the playbooks
61	  ara_record:
62	    key: "git_version"
63	    value: "{{ git_version.stdout }}"
64	  register: version
65	
66	- name: Print recorded data
67	  debug:
68	    msg: "{{ version.playbook_id }} - {{ version.key }}: {{ version.value }}
69	
70	# Write data with a type (otherwise defaults to "text")
71	# This changes the behavior on how the value is presented in the web interface
72	- name: Record different formats of things
73	  ara_record:
74	    key: "{{ item.key }}"
75	    value: "{{ item.value }}"
76	    type: "{{ item.type }}"
77	  with_items:
78	    - { key: "log", value: "error", type: "text" }
79	    - { key: "website", value: "http://domain.tld", type: "url" }
80	    - { key: "data", value: "{ 'key': 'value' }", type: "json" }
81	    - { key: "somelist", value: ['one', 'two'], type: "list" }
82	    - { key: "somedict", value: {'key': 'value' }, type: "dict" }
83	"""
84	
85	
86	RETURN = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/action/ara_record.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	
86	RETURN = """
87	playbook:
88	    description: ID of the playbook the data was recorded in
89	    returned: on success
90	    type: int
91	    sample: 1
92	key:
93	    description: Key where the record is saved
94	    returned: on success
95	    type: str
96	    sample: log_url
97	value:
98	    description: Value of the key
99	    returned: on success
100	    type: complex
101	    sample: http://logurl
102	type:
103	    description: Type of the key
104	    returned: on success
105	    type: string
106	    sample: url
107	created:
108	    description: Date the record was created (ISO-8601)
109	    returned: on success
110	    type: str
111	    sample: 2018-11-15T17:27:41.597234Z
112	updated:
113	    description: Date the record was updated (ISO-8601)
114	    returned: on success
115	    type: str
116	    sample: 2018-11-15T17:27:41.597265Z
117	"""
118	
119	
120	class ActionModule(ActionBase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	
41	DOCUMENTATION = """
42	callback: ara
43	callback_type: notification
44	requirements:
45	  - ara
46	short_description: Sends playbook execution data to the ARA API internally or over HTTP
47	description:
48	  - Sends playbook execution data to the ARA API internally or over HTTP
49	options:
50	  api_client:
51	    description: The client to use for communicating with the API
52	    default: offline
53	    env:
54	      - name: ARA_API_CLIENT
55	    ini:
56	      - section: ara
57	        key: api_client
58	    choices: ['offline', 'http']
59	  api_server:
60	    description: When using the HTTP client, the base URL to the ARA API server
61	    default: http://127.0.0.1:8000
62	    env:
63	      - name: ARA_API_SERVER
64	    ini:
65	      - section: ara
66	        key: api_server
67	  api_username:
68	    description: If authentication is required, the username to authenticate with
69	    default: null
70	    env:
71	      - name: ARA_API_USERNAME
72	    ini:
73	      - section: ara
74	        key: api_username
75	  api_password:
76	    description: If authentication is required, the password to authenticate with
77	    default: null
78	    env:
79	      - name: ARA_API_PASSWORD
80	    ini:
81	      - section: ara
82	        key: api_password
83	  api_cert:
84	    description: If a client certificate is required, the path to the certificate to use.
85	    default: null
86	    env:
87	      - name: ARA_API_CERT
88	    ini:
89	      - section: ara
90	        key: api_cert
91	  api_key:
92	    description: If a client certificate is required, the path to the private key to use.
93	    default: null
94	    env:
95	      - name: ARA_API_KEY
96	    ini:
97	      - section: ara
98	        key: api_key
99	  api_ca:
100	    description: The path to a CA bundle.
101	    default: null
102	    env:
103	      - name: ARA_API_CA
104	    ini:
105	      - section: ara
106	        key: api_ca
107	  api_insecure:
108	    description: Can be enabled to ignore SSL certification of the API server
109	    type: bool
110	    default: false
111	    env:
112	      - name: ARA_API_INSECURE
113	    ini:
114	      - section: ara
115	        key: api_insecure
116	  api_timeout:
117	    description: Timeout, in seconds, before giving up on HTTP requests
118	    type: integer
119	    default: 30
120	    env:
121	      - name: ARA_API_TIMEOUT
122	    ini:
123	      - section: ara
124	        key: api_timeout
125	  argument_labels:
126	    description: |
127	        A list of CLI arguments that, if set, will be automatically applied to playbooks as labels.
128	        Note that CLI arguments are not always named the same as how they are represented by Ansible.
129	        For example, --limit is "subset", --user is "remote_user" but --check is "check".
130	    type: list
131	    default:
132	      - remote_user
133	      - check
134	      - tags
135	      - skip_tags
136	      - subset
137	    env:
138	      - name: ARA_ARGUMENT_LABELS
139	    ini:
140	      - section: ara
141	        key: argument_labels
142	  callback_threads:
143	    description:
144	      - The number of threads to use in API client thread pools (maximum 4)
145	      - When set to 0, no threading will be used (default) which is appropriate for usage with sqlite
146	      - Using threads is recommended when the server is using MySQL or PostgreSQL
147	    type: integer
148	    default: 0
149	    env:
150	      - name: ARA_CALLBACK_THREADS
151	    ini:
152	      - section: ara
153	        key: callback_threads
154	  default_labels:
155	    description: A list of default labels that will be applied to playbooks
156	    type: list
157	    default: []
158	    env:
159	      - name: ARA_DEFAULT_LABELS
160	    ini:
161	      - section: ara
162	        key: default_labels
163	  ignored_facts:
164	    description: List of host facts that will not be saved by ARA
165	    type: list
166	    default: ["ansible_env"]
167	    env:
168	      - name: ARA_IGNORED_FACTS
169	    ini:
170	      - section: ara
171	        key: ignored_facts
172	  ignored_arguments:
173	    description: List of Ansible arguments that will not be saved by ARA
174	    type: list
175	    default: ["extra_vars"]
176	    env:
177	      - name: ARA_IGNORED_ARGUMENTS
178	    ini:
179	      - section: ara
180	        key: ignored_arguments
181	  ignored_files:
182	    description:
183	      - List of file path patterns that will not be saved by ARA
184	      - Note that the default pattern ('.ansible/tmp') gets dynamically set to the value of ANSIBLE_LOCAL_TEMP
185	      - The configuration for ANSIBLE_LOCAL_TEMP is typically ~/.ansible/tmp unless it is changed.
186	    type: list
187	    default: [".ansible/tmp"]
188	    env:
189	      - name: ARA_IGNORED_FILES
190	    ini:
191	      - section: ara
192	        key: ignored_files
193	  localhost_as_hostname:
194	    description:
195	        - Associates results to the hostname (or fqdn) instead of localhost when the inventory name is localhost
196	        - Defaults to false for backwards compatibility, set to true to enable
197	        - This can be useful when targeting localhost, using ansible-pull or ansible-playbook -i 'localhost,'
198	        - This helps differentiating results between hosts, otherwise everything would be recorded under localhost.
199	    type: boolean
200	    default: false
201	    env:
202	      - name: ARA_LOCALHOST_AS_HOSTNAME
203	    ini:
204	      - section: ara
205	        key: localhost_as_hostname
206	  localhost_as_hostname_format:
207	    description:
208	      - The format to use when recording the hostname for localhost
209	      - This is used when recording the controller hostname or when ARA_LOCALHOST_TO_HOSTNAME is true
210	      - There are different formats to choose from based on the full (or short) configured hostname and fqdn
211	      - Defaults to 'fqdn' (i.e, server.example.org) but can be set to 'fqdn_short' (server)
212	      - Other options include 'hostname' and 'hostname_short' which may be suitable depending on server configuration
213	    default: fqdn
214	    env:
215	      - name: ARA_LOCALHOST_AS_HOSTNAME_FORMAT
216	    ini:
217	      - section: ara
218	        key: localhost_as_hostname_format
219	    choices: ['fqdn', 'fqdn_short', 'hostname', 'hostname_short']
220	  record_controller:
221	    description:
222	      - Whether ara should record the controller hostname on which the playbook ran
223	      - Defaults to true but may be optionally set to false for privacy or other use cases
224	    type: boolean
225	    default: true
226	    env:
227	      - name: ARA_RECORD_CONTROLLER
228	    ini:
229	      - section: ara
230	        key: record_controller
231	  record_controller_name:
232	    description:
233	      - The name to use when recording the controller hostname.
234	      - Defaults to the system hostname.
235	    type: string
236	    env:
237	      - name: ARA_RECORD_CONTROLLER_NAME
238	    ini:
239	      - section: ara
240	        key: record_controller_name
241	  record_user:
242	    description:
243	      - Whether ara should record the user that ran a playbook
244	      - Defaults to true but may be optionally set to false for privacy or other use cases
245	    type: boolean
246	    default: true
247	    env:
248	      - name: ARA_RECORD_USER
249	    ini:
250	      - section: ara
251	        key: record_user
252	  record_user_name:
253	    description:
254	      - The name to use when recording the user that ran a playbook.
255	      - Defaults to the OS user which ran the playbook.
256	    type: string
257	    env:
258	      - name: ARA_RECORD_USER_NAME
259	    ini:
260	      - section: ara
261	        key: record_user_name
262	  record_task_content:
263	    description:
264	      - Whether ara should record the content of a task
265	      - Defaults to true, set to false for privacy or other use cases
266	    type: boolean
267	    default: true
268	    env:
269	      - name: ARA_RECORD_TASK_CONTENT
270	    ini:
271	      - section: ara
272	        key: record_task_content
273	"""
274	
275	# Task modules for which ara should save host facts
276	ANSIBLE_SETUP_MODULES = frozenset(

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
334	    def set_handler(self, sig):
335	        original_handler = signal.getsignal(sig)
336	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
349	
350	        signal.signal(sig, handler)
351	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:350
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
349	
350	        signal.signal(sig, handler)
351	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
427	        if self.callback_threads:
428	            self.global_threads = ThreadPoolExecutor(max_workers=self.callback_threads)
429	            self.log.debug("Global thread pool initialized with %s thread(s)" % self.callback_threads)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
481	        # Record the playbook file
482	        self._submit_thread("global", self._get_or_create_file, path, content)
483	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
521	        if labels:
522	            self._submit_thread("global", self._set_playbook_labels, labels)
523	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
535	            if not ignored:
536	                self._submit_thread("global", self._get_or_create_file, path)
537	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
562	        if self.callback_threads:
563	            self.task_threads = ThreadPoolExecutor(max_workers=self.callback_threads)
564	            self.log.debug("Task thread pool initialized with %s thread(s)" % self.callback_threads)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
589	        self.log.debug("v2_runner_on_ok")
590	        self._submit_thread("task", self._load_result, result, "ok", **kwargs)
591	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
601	            self.task = self.task_cache[task_uuid]
602	        self._submit_thread("task", self._load_result, result, "unreachable", **kwargs)
603	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
613	            self.task = self.task_cache[task_uuid]
614	        self._submit_thread("task", self._load_result, result, "failed", **kwargs)
615	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
617	        self.log.debug("v2_runner_on_skipped")
618	        self._submit_thread("task", self._load_result, result, "skipped", **kwargs)
619	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
671	        if self.play is not None:
672	            self._submit_thread(
673	                "global",
674	                self.client.patch,
675	                "/api/v1/plays/%s" % self.play["id"],
676	                status="completed",
677	                ended=datetime.datetime.now(datetime.timezone.utc).isoformat(),
678	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
723	                    with open(path) as fd:
724	                        content = fd.read()
725	                except OSError as e:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
739	        # so that we can differentiate between different actual hosts
740	        if self.localhost_as_hostname and host in ["localhost", "127.0.0.1"]:
741	            host = self.localhost_hostname

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
871	
872	            self._submit_thread(
873	                "global",
874	                self.client.patch,
875	                "/api/v1/hosts/%s" % host["id"],
876	                changed=host_stats["changed"],
877	                unreachable=host_stats["unreachable"],
878	                failed=host_stats["failures"],
879	                ok=host_stats["ok"],
880	                skipped=host_stats["skipped"],
881	            )

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
895	        if self.localhost_as_hostname_format.startswith("hostname"):
896	            hostname = socket.gethostname()
897	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:896
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
895	        if self.localhost_as_hostname_format.startswith("hostname"):
896	            hostname = socket.gethostname()
897	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
917	        try:
918	            user = getpass.getuser()
919	        except Exception:

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/plugins/callback/ara_default.py:918
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
917	        try:
918	            user = getpass.getuser()
919	        except Exception:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/server/settings.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
71	# Django built-in server and npm development server
72	ALLOWED_HOSTS = settings.get("ALLOWED_HOSTS", ["::1", "127.0.0.1", "localhost"])
73	CORS_ORIGIN_WHITELIST = settings.get("CORS_ORIGIN_WHITELIST", ["http://127.0.0.1:8000", "http://localhost:3000"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/server/settings.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	ALLOWED_HOSTS = settings.get("ALLOWED_HOSTS", ["::1", "127.0.0.1", "localhost"])
73	CORS_ORIGIN_WHITELIST = settings.get("CORS_ORIGIN_WHITELIST", ["http://127.0.0.1:8000", "http://localhost:3000"])
74	CORS_ORIGIN_REGEX_WHITELIST = settings.get("CORS_ORIGIN_REGEX_WHITELIST", [])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/server/settings.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	ALLOWED_HOSTS = settings.get("ALLOWED_HOSTS", ["::1", "127.0.0.1", "localhost"])
73	CORS_ORIGIN_WHITELIST = settings.get("CORS_ORIGIN_WHITELIST", ["http://127.0.0.1:8000", "http://localhost:3000"])
74	CORS_ORIGIN_REGEX_WHITELIST = settings.get("CORS_ORIGIN_REGEX_WHITELIST", [])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/server/settings.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
306	        print("[ara] Writing default settings to %s" % DEFAULT_SETTINGS)
307	        settings_file.write(comment.lstrip())
308	        yaml.dump({"default": SETTINGS}, settings_file)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/ui/management/commands/generate.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
34	        # Retrieve static assets (../../static)
35	        shutil.rmtree(os.path.join(path, "static"), ignore_errors=True)
36	        ui_path = os.path.abspath(os.path.dirname(os.path.dirname(os.path.dirname(__file__))))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/ara/ui/management/commands/generate.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
46	        with open(destination, "w") as f:
47	            f.write(render_to_string(template, kwargs))
48	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/tests/with_ansible-runner.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	except ImportError as e:
15	    print("ara must be installed first: https://github.com/ansible-community/ara#getting-started")
16	    raise e

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/tests/with_ansible-runner.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	    os.environ["ARA_API_CLIENT"] = os.getenv("ARA_API_CLIENT", "offline")
29	    os.environ["ARA_API_SERVER"] = os.getenv("ARA_API_SERVER", "http://127.0.0.1:8000")
30	    os.environ["ARA_API_INSECURE"] = os.getenv("ARA_API_INSECURE", "false")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ara-1.7.2/ara-1.7.2/tests/with_ansible-runner.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	    with open(playbook_file) as f:
47	        playbook_id = f.read()
48	

--------------------------------------------------

Code scanned:
	Total lines of code: 7966
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 36.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 55.0
		High: 6.0
Files skipped (0):
