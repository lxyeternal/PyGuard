Run started:2025-04-12 12:02:53.503471

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aus/advanced_upgrade_service.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
399	        org_upgrade_spec.add_organization_error(
400	            f"Version data inheritance from organizations {', '.join(sorted(unverified_org_ids))} "
401	            f"are unverified. Ask the owner of these organizations to publish version data to the organization ID {org.org_id}. "
402	            "See https://source.redhat.com/groups/public/sre/wiki/advanced_upgrade_service_aus"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aus/base.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
233	                    soaked_versions[version] = min(
234	                        soak_days, soaked_versions.get(version, soak_days)
235	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aus/base.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	
237	            current_upgrade = current_cluster_upgrade_policies.get(spec.cluster_uuid)
238	            for version, metric_value in remaining_soak_day_metric_values_for_cluster(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aus/base.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
368	    """
369	    addon_service_version = (ocm_env.labels or {}).get(
370	        "feature_flag_addon_service_version"
371	    ) or "v2"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aus/base.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
747	            )
748	            result.get(
749	                org_upgrade_spec.org.environment.name, org_upgrade_spec.org.org_id
750	            ).aggregate(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aus/base.py:856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
855	    # of cluster
856	    handler = HANDLERS.get(gate.label)
857	    if handler:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aus/base.py:1296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1295	        max(
1296	            (spec.upgrade_policy.conditions.soak_days or 0) - soaked_versions.get(v, 0),
1297	            0,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aws_ecr_image_pull_secrets.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
14	def enc_dec(data: str) -> str:
15	    return base64.b64encode(data.encode("utf-8")).decode("utf-8")
16	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aws_ecr_image_pull_secrets.py:15
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
14	def enc_dec(data: str) -> str:
15	    return base64.b64encode(data.encode("utf-8")).decode("utf-8")
16	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aws_ecr_image_pull_secrets.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
18	def get_password(token: str) -> str:
19	    return base64.b64decode(token).decode("utf-8").split(":")[1]
20	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aws_ecr_image_pull_secrets.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
18	def get_password(token: str) -> str:
19	    return base64.b64decode(token).decode("utf-8").split(":")[1]
20	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aws_iam_keys.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
72	    for wd in working_dirs.values():
73	        shutil.rmtree(wd)
74	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aws_saml_idp/integration.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	        """Get the SAML metadata from the given URL."""
115	        response = requests.get(saml_metadata_url)
116	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aws_version_sync/merge_request_manager/merge_request.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	AVS_DESC = string.Template(
38	    f"""
39	This MR is triggered by app-interface's [aws-version-sync (AVS)](https://github.com/app-sre/qontract-reconcile/tree/master/reconcile/aws_version_sync).
40	
41	Please **do not remove the {AVS_LABEL} label** from this MR!
42	
43	Parts of this description are used by AVS to manage the MR.
44	
45	{PROMOTION_DATA_SEPARATOR}
46	
47	* {VERSION_REF}: {AVS_VERSION}
48	* {PROVIDER_REF}: $provider
49	* {ACCOUNT_ID_REF}: $account_id
50	* {RESOURCE_PROVIDER_REF}: $resource_provider
51	* {RESOURCE_IDENTIFIER_REF}: $resource_identifier
52	* {RESOURCE_ENGINE_REF}: $resource_engine
53	* {RESOURCE_ENGINE_VERSION_REF}: $resource_engine_version
54	"""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/aws_version_sync/utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	
32	    response = requests.get(
33	        url, params=params, headers=headers, verify=ssl_verify, timeout=timeout
34	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/change_owners/change_owners.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	        self_serviceability_hint += (
176	            "but <b>not all changes are self-serviceable and require AppSRE approval</b>."
177	            "The AppSRE Interrupt Catcher (IC) will review your Merge Request (MR) as it comes up in their "
178	            "<a href='https://gitlab.cee.redhat.com/service/app-interface-output/-/blob/master/app-interface-review-queue.md'>queue</a>, "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/change_owners/tester.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
179	            with open(f"{self.resource_dir()}{path}", encoding="locale") as f:
180	                content = f.read()
181	                parsed_content, schema = parse_resource_file_content(content)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/checkpoint.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	    try:
55	        rs = requests.get(url, verify=False, timeout=60)
56	    except requests.exceptions.ConnectionError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/checkpoint.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	    for field, validator in VALIDATORS.items():
164	        value = app.get(field)
165	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/cli.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
620	    except gql.GqlApiIntegrationNotFound as e:
621	        sys.stderr.write(str(e) + "\n")
622	        sys.exit(ExitCodes.INTEGRATION_NOT_FOUND)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/cli.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
623	    except RunnerException as e:
624	        sys.stderr.write(str(e) + "\n")
625	        sys.exit(ExitCodes.ERROR)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/cli.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
626	    except gql.GqlApiErrorForbiddenSchema as e:
627	        sys.stderr.write(str(e) + "\n")
628	        sys.exit(ExitCodes.FORBIDDEN_SCHEMA)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/cli.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
635	            with open(dump_schemas_file, "w", encoding="locale") as f:
636	                f.write(json.dumps(gqlapi.get_queried_schemas()))
637	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/cli.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
737	    required=True,
738	    default="https://auth.redhat.com/auth/realms/EmployeeIDP/protocol/saml/descriptor",
739	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/cli.py:2971
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2970	    "--default-auth-issuer-url",
2971	    default="https://auth.redhat.com/auth/realms/EmployeeIDP",
2972	    help="Use this Issuer (SSO server) URL if nothing else is specified for a cluster in the OCM cluster labels.",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/cli.py:3041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3040	    "--default-auth-issuer-url",
3041	    default="https://auth.redhat.com/auth/realms/EmployeeIDP",
3042	    help="Use this Issuer (SSO server) URL if nothing else is specified for a cluster in the OCM cluster labels.",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/cli.py:3528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3527	    help="if `limited` (default) the integration will not make any final decisions on the MR, but if `authoritative` it will ",
3528	    default=os.environ.get("CHANGE_TYPE_PROCESSING_MODE", "limited"),
3529	    type=click.Choice(["limited", "authoritative"], case_sensitive=True),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/cli.py:3534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3533	    is_flag=True,
3534	    default=bool(os.environ.get("MR_MANAGEMENT")),
3535	    help="Manage MR labels and comments (default to false)",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_base.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	    field="",
29	    path=os.environ.get("DASHDOTDB_SECRET", "app-sre/dashdot/auth-proxy-production"),
30	    q_format=None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_base.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	        endpoint = f"{self.dashdotdb_url}/api/v1/token"
61	        response = requests.get(
62	            url=endpoint,
63	            params=params,
64	            auth=(self.dashdotdb_user, self.dashdotdb_pass),
65	            timeout=(5, 120),
66	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_base.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
109	            headers["X-Auth"] = str(self.dashdotdb_token)
110	        return requests.post(
111	            url=endpoint,
112	            json=data,
113	            headers=headers,
114	            auth=(self.dashdotdb_user, self.dashdotdb_pass),
115	            timeout=timeout,
116	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_base.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
123	    ) -> requests.Response:
124	        return requests.get(
125	            url=endpoint,
126	            params=params,
127	            auth=(self.dashdotdb_user, self.dashdotdb_pass),
128	            timeout=timeout,
129	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_base.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
149	            headers["Authorization"] = (
150	                f"Basic {b64encode(f'{username}:{password}'.encode()).decode('utf-8')}"
151	            )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_base.py:150
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
149	            headers["Authorization"] = (
150	                f"Basic {b64encode(f'{username}:{password}'.encode()).decode('utf-8')}"
151	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_base.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
151	            )
152	        response = requests.get(
153	            url, params=params, headers=headers, verify=ssl_verify, timeout=(5, 300)
154	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_cso.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
59	            endpoint = f"{self.dashdotdb_url}/api/v1/imagemanifestvuln/{cluster}"
60	            response = self._do_post(endpoint, item)
61	            try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_cso.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        LOG.info("%s processing %s", LOGMARKER, cluster)
72	        oc = oc_map.get(cluster)
73	        if isinstance(oc, OCLogMsg):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dora.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
253	        gh_instance = queries.get_github_instance()
254	        self.gh_token = secret_reader.read(gh_instance["token"])
255	        self._gh_apis: dict[str, GithubRepositoryApi] = {}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dora.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
337	        deployments = [
338	            self.build_deployment_post(st, dep, rc_commits[rc])
339	            for st, dep, rc in sorted(saastarget_dep_repo_changes, key=sortkey)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dora.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
342	        if deployments:
343	            self.post({"deployments": deployments})
344	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dora.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
367	                    saas_file_path = "data/" + saas_file.path.lstrip("/")
368	                    saastarget = SaasTarget(
369	                        app_name=saas_file.name,
370	                        env_name=target_env_name,
371	                        path=saas_file_path,
372	                        resource_template=rt.name,
373	                        namespace=ns.path,
374	                        pipeline=pipeline,
375	                    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dora.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
423	        LOG.info("Fetching commits %s", rc)
424	        if rc.repo_url.startswith("https://github.com"):
425	            try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dora.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
443	        endpoint = f"{self.dashdotdb_url}/api/v1/dora/latest"
444	        response = self._do_get(
445	            endpoint,
446	            {
447	                "app_name": app_env.app_name,
448	                "env_name": app_env.env_name,
449	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dora.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
460	
461	        prefix = "https://gitlab.cee.redhat.com/"
462	        repo = rc.repo_url[rc.repo_url.startswith(prefix) and len(prefix) :]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dora.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
478	
479	        prefix = "https://github.com/"
480	        repo = rc.repo_url[rc.repo_url.startswith(prefix) and len(prefix) :]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dora.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
488	        endpoint = f"{self.dashdotdb_url}/api/v1/dora"
489	        response = self._do_post(endpoint, data)
490	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dvo.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	        )
60	        self.chunksize = self.secret_content.get("chunksize") or "20"
61	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dvo.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        # dvd.data.data.result.[{metric,values}]
72	        dvdata = deploymentvalidation.payload.get("data", {})
73	        if not dvdata:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dvo.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	            return None
75	        dvresult = dvdata.get("result")
76	        if dvresult is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dvo.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
113	                )
114	                response = self._do_post(endpoint, dvdata, (5, 120))
115	                try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dvo.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	        try:
137	            deploymentvalidation = self._promget(
138	                url=prom_info.url,
139	                params={"query": (metrics)},
140	                token=prom_info.token,
141	                ssl_verify=prom_info.ssl_verify,
142	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_dvo.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	            uri = "/api/v1/label/__name__/values"
176	            deploymentvalidation = self._promget(
177	                url=prom_info.url,
178	                params={},
179	                token=prom_info.token,
180	                ssl_verify=prom_info.ssl_verify,
181	                uri=uri,
182	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_slo.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
87	            try:
88	                response = self._do_post(endpoint, payload)
89	                response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dashdotdb_slo.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
140	                try:
141	                    prom_response = self._promget(
142	                        url=promurl,
143	                        params={"query": (f"{promquery}")},
144	                        token=promtoken,
145	                        username=username,
146	                        password=password,
147	                    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/database_access_manager.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
207	    secret["data"] = {
208	        "script.sql": base64.b64encode(script.encode("utf-8")).decode("utf-8"),
209	    }

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/database_access_manager.py:208
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
207	    secret["data"] = {
208	        "script.sql": base64.b64encode(script.encode("utf-8")).decode("utf-8"),
209	    }

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/database_access_manager.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
514	    def _decode_secret_value(value: str) -> str:
515	        return base64.b64decode(value).decode("utf-8")
516	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/database_access_manager.py:515
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
514	    def _decode_secret_value(value: str) -> str:
515	        return base64.b64decode(value).decode("utf-8")
516	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dynatrace_token_provider/integration.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
611	    def base64_decode(self, encoded: str) -> str:
612	        data_bytes = base64.b64decode(encoded)
613	        return data_bytes.decode("utf-8")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dynatrace_token_provider/integration.py:612
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
611	    def base64_decode(self, encoded: str) -> str:
612	        data_bytes = base64.b64decode(encoded)
613	        return data_bytes.decode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dynatrace_token_provider/integration.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
616	        data_bytes = string.encode("utf-8")
617	        encoded = base64.b64encode(data_bytes)
618	        return encoded.decode("utf-8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/dynatrace_token_provider/integration.py:617
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
616	        data_bytes = string.encode("utf-8")
617	        encoded = base64.b64encode(data_bytes)
618	        return encoded.decode("utf-8")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/endpoints_discovery/merge_request.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	DESC = string.Template(
24	    f"""
25	This MR is triggered by app-interface's [endpoints-discovery](https://github.com/app-sre/qontract-reconcile/tree/master/reconcile/endpoints_discovery).
26	
27	Please **do not remove the `{LABEL}` label** from this MR!
28	
29	Parts of this description are used to manage the MR.
30	
31	{PROMOTION_DATA_SEPARATOR}
32	
33	* {INTEGRATION_REF}: {INTEGRATION}
34	* {VERSION_REF}: {VERSION}
35	* {HASH_REF}: $hash
36	"""

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/external_resources/secrets_sync.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
115	    def _format_value(self, value: str) -> str:
116	        decoded_value = base64.b64decode(value).decode("utf-8")
117	        if decoded_value.startswith("__vault__:"):

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/external_resources/secrets_sync.py:116
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
115	    def _format_value(self, value: str) -> str:
116	        decoded_value = base64.b64decode(value).decode("utf-8")
117	        if decoded_value.startswith("__vault__:"):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/fleet_labeler/merge_request.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    def description(self) -> str:
42	        return f"""
43	This is an automatically generated MR by the [fleet-labeler](https://github.com/app-sre/qontract-reconcile/tree/master/reconcile/fleet_labeler) integration.
44	
45	This MR updates the cluster inventory for the fleet label spec defined at {self._path}.
46	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/gcr_mirror.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	        for app in result["apps"]:
104	            gcr_repos = app.get("gcrRepos")
105	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/gcr_mirror.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	                project = gcr_repo["project"]["name"]
111	                server_url = gcr_repo["project"].get("serverUrl") or "gcr.io"
112	                for item in gcr_repo["items"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/gcr_mirror.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	
177	                tags = item["mirror"].get("tags")
178	                tags_exclude = item["mirror"].get("tagsExclude")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/gcr_mirror.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	                tags = item["mirror"].get("tags")
178	                tags_exclude = item["mirror"].get("tagsExclude")
179	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/gcr_mirror.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
242	            with open(control_file_path, encoding="locale") as file_obj:
243	                last_deep_sync = float(file_obj.read())
244	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/gcr_mirror.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
257	        with open(path, "w", encoding="locale") as file_object:
258	            file_object.write(str(time.time()))
259	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/gcr_mirror.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
257	        with open(path, "w", encoding="locale") as file_object:
258	            file_object.write(str(time.time()))
259	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/gcr_mirror.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
270	            project = project_data["name"]
271	            token = base64.b64decode(raw_data["token"]).decode()
272	            creds[project] = f"{raw_data['user']}:{token}"

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/gcr_mirror.py:271
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
270	            project = project_data["name"]
271	            token = base64.b64decode(raw_data["token"]).decode()
272	            creds[project] = f"{raw_data['user']}:{token}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_org.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	
27	GH_BASE_URL = os.environ.get("GITHUB_API", "https://api.github.com")
28	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_org.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	            continue
117	        token = secret_reader.read(org["token"])
118	        org_config = {"token": token, "managed_teams": org["managedTeams"]}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_owners.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	def run(dry_run: bool) -> None:
84	    base_url = os.environ.get("GITHUB_API", "https://api.github.com")
85	    config = get_config()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_repo_invites.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	    result = gqlapi.query(queries.CODE_COMPONENT_REPO_QUERY)
103	    token = secret_reader.read(settings["githubRepoInvites"]["credentials"])
104	    g = raw_github_api.RawGithubApi(token)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_repo_permissions_validator.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	def init_github() -> Github:
28	    base_url = os.environ.get("GITHUB_API", "https://api.github.com")
29	    token = get_default_config()["token"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_repo_permissions_validator.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	        repo_url = jjb.get_repo_url(job)
48	        repo_name = repo_url.rstrip("/").replace("https://github.com/", "")
49	        repo = gh.get_repo(repo_name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_users.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	
30	GH_BASE_URL = os.environ.get("GITHUB_API", "https://api.github.com")
31	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_users.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	
30	GH_BASE_URL = os.environ.get("GITHUB_API", "https://api.github.com")
31	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_users.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	def send_email_notification(user: dict, smtp_client: SmtpClient) -> None:
58	    msg_template = """
59	Hello,
60	
61	This is an automated message coming from App-Interface.
62	
63	The App SRE team adheres to the OpenShift GitHub policy:
64	https://mojo.redhat.com/docs/DOC-1200784
65	
66	Your GitHub profile does not comply with the following requirements:
67	
68	- Company field should contain "Red Hat".
69	
70	
71	For any questions, please ping @app-sre-ic on #sd-app-sre in CoreOS Slack,
72	or mail us at sd-app-sre@redhat.com.
73	
74	App-Interface repository: https://gitlab.cee.redhat.com/service/app-interface
75	
76	"""
77	    to = user["username"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_validator.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	def run(dry_run: bool) -> None:
14	    base_url = os.environ.get("GITHUB_API", "https://api.github.com")
15	    orgs = queries.get_github_orgs()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/github_validator.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	        org_name = org["name"]
21	        token = secret_reader.read(org["token"])
22	        gh = Github(token, base_url=base_url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/integrations_manager.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	IMAGE_DEFAULT = "quay.io/app-sre/qontract-reconcile"
55	UPSTREAM_DEFAULT = "https://github.com/app-sre/qontract-reconcile"
56	
57	INTEGRATION_UPSTREAM_REPOS_PARAM = "INTEGRATION_UPSTREAM_REPOS"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/integrations_manager.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	def get_image_tag_from_ref(ref: str, upstream: str) -> str:
61	    gh_prefix = "https://github.com/"
62	    upstream = upstream.removeprefix(gh_prefix)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/ocm_clusters.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
221	        elb_fqdn = current_spec.console_url.replace(
222	            "https://console-openshift-console", "elb"
223	        )
224	        if desired_spec.elb_fqdn != elb_fqdn:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_cluster_bots.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
54	    try:
55	        res = urllib.request.urlopen(url, timeout=10)
56	        return res is not None and res.getcode() == 200

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_cluster_bots.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
124	    b64_token = secret["data"]["token"]
125	    return base64.b64decode(b64_token).decode()
126	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_cluster_bots.py:125
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
124	    b64_token = secret["data"]["token"]
125	    return base64.b64decode(b64_token).decode()
126	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_cluster_bots.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
209	        ) as kc:
210	            kc.write(kubeconfig_content)
211	            kc.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_cluster_bots.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
241	    vault = cast(_VaultClient, VaultClient())
242	    vault.write(
243	        {
244	            "path": vault_secret(cluster, config, cluster_admin=False)["path"],
245	            "data": vault_data(cluster, config, token, cluster_admin=False),
246	        },
247	        decode_base64=False,
248	    )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_cluster_bots.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
249	    if cluster.cluster_admin and admin_token:
250	        vault.write(
251	            {
252	                "path": vault_secret(cluster, config, cluster_admin=True)["path"],
253	                "data": vault_data(cluster, config, admin_token, cluster_admin=True),
254	            },
255	            decode_base64=False,
256	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_resources_base.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
296	    if decode_base64:
297	        config = base64.b64decode(config).decode("utf-8")
298	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_resources_base.py:297
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
296	    if decode_base64:
297	        config = base64.b64decode(config).decode("utf-8")
298	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_resources_base.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
365	        if body["kind"] == "PrometheusRule":
366	            app_int_base_url = "https://gitlab.cee.redhat.com/service/app-interface"
367	            if settings and "repoUrl" in settings:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_saas_deploy.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
334	        with open(sast_file, "w", encoding="locale") as f:
335	            f.write(file + "\n")
336	            f.write(url + "\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_saas_deploy.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
335	            f.write(file + "\n")
336	            f.write(url + "\n")
337	            f.write(emails + "\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_saas_deploy.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
336	            f.write(url + "\n")
337	            f.write(emails + "\n")
338	        images = " ".join(saasherder.images)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_saas_deploy.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
341	        with open(clamav_file, "w", encoding="locale") as f:
342	            f.write(images + "\n")
343	            f.write(app_name + "\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_saas_deploy.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
342	            f.write(images + "\n")
343	            f.write(app_name + "\n")
344	        image_auth = saasherder._initiate_image_auth(saas_file)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/openshift_saas_deploy.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
347	            with open(json_file, "w", encoding="locale") as f:
348	                f.write(json.dumps(image_auth.getDockerConfigJson(), indent=2))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/oum/base.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
351	                    ClusterError(
352	                        message="This cluster does not have the capability to manage the cluster-admins role. Go to https://red.ht/ohss-incident and request cluster-admin access."
353	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	        for app in apps:
160	            quay_repos = app.get("quayRepos")
161	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
280	
281	                tags = item["mirror"].get("tags")
282	                tags_exclude = item["mirror"].get("tagsExclude")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
281	                tags = item["mirror"].get("tags")
282	                tags_exclude = item["mirror"].get("tagsExclude")
283	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
385	            with open(path, encoding="locale") as file_obj:
386	                last_compare_tags = float(file_obj.read())
387	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
395	        with open(path, "w", encoding="locale") as file_object:
396	            file_object.write(str(time.time()))
397	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
395	        with open(path, "w", encoding="locale") as file_object:
396	            file_object.write(str(time.time()))
397	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror_org.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	        for org_key, org_info in self.quay_api_store.items():
99	            if not org_info.get("mirror"):
100	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror_org.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	                    },
130	                    "mirror_filters": org_info.get("mirror_filters").get(
131	                        repo["name"], {}
132	                    ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror_org.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	                    },
130	                    "mirror_filters": org_info.get("mirror_filters").get(
131	                        repo["name"], {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror_org.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	
166	                if item["mirror"].get("username") and item["mirror"].get("token"):
167	                    mirror_username = item["mirror"]["username"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror_org.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	
166	                if item["mirror"].get("username") and item["mirror"].get("token"):
167	                    mirror_username = item["mirror"]["username"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror_org.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	
179	                tags = item["mirror_filters"].get("tags")
180	                tags_exclude = item["mirror_filters"].get("tags_exclude")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/quay_mirror_org.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	                tags = item["mirror_filters"].get("tags")
180	                tags_exclude = item["mirror_filters"].get("tags_exclude")
181	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/queries.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
393	    for instance in instances:
394	        if instance["url"] == "https://github.com/app-sre":
395	            return instance

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/rhidp/sso_client/base.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    """Convert a console URL to an OAuth callback URL."""
39	    if console_url.startswith("https://console-openshift-console.apps.rosa."):
40	        # ROSA cluster

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/rhidp/sso_client/base.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
236	
237	    secret_reader.vault_client.write(  # type: ignore[attr-defined] # mypy doesn't recognize the VaultClient.__new__ method
238	        secret={
239	            "path": secret.path,
240	            "data": sso_client.dict(),
241	        },
242	        decode_base64=False,
243	    )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/run_integration.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
130	    if entry_point:
131	        return entry_point.load()
132	    raise ValueError(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/merge_request_manager_v2.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	
45	MR_DESC = """
46	This is an auto-promotion triggered by app-interface's [saas-auto-promotions-manager](https://github.com/app-sre/qontract-reconcile/tree/master/reconcile/saas_auto_promotions_manager) (SAPM).
47	This MR promotes all subscribers with auto-promotions for the channel(s) listed below.
48	
49	Please **do not manually modify** this MR in any way, as it might result in blocking the auto-promotion.
50	
51	This description is used by SAPM to manage auto-promotions.
52	"""
53	
54	
55	class MergeRequestManagerV2:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        sapm_mrs = [
72	            mr for mr in all_open_mrs if label in mr.attributes.get("labels", [])
73	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	            attrs = mr.attributes
79	            desc = str(attrs.get("description", ""))
80	            parts = desc.split(PROMOTION_DATA_SEPARATOR)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	                    "Bad data separator format. Closing %s",
84	                    mr.attributes.get("web_url", "NO_WEBURL"),
85	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	                    VERSION_REF,
99	                    mr.attributes.get("web_url", "NO_WEBURL"),
100	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	                    version_ref,
110	                    mr.attributes.get("web_url", "NO_WEBURL"),
111	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	                    MR_KIND_REF,
128	                    mr.attributes.get("web_url", "NO_WEBURL"),
129	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	            attrs = mr.attributes
147	            desc = str(attrs.get("description", ""))
148	            parts = desc.split(PROMOTION_DATA_SEPARATOR)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149	            promotion_data = parts[1]
150	            has_conflicts = bool(attrs.get("has_conflicts", False))
151	            if has_conflicts:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
153	                    "Merge-conflict detected. Closing %s",
154	                    mr.attributes.get("web_url", "NO_WEBURL"),
155	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	                    CONTENT_HASHES,
168	                    mr.attributes.get("web_url", "NO_WEBURL"),
169	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	                    CHANNELS_REF,
182	                    mr.attributes.get("web_url", "NO_WEBURL"),
183	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
192	                    "Duplicate MR detected. Closing %s",
193	                    mr.attributes.get("web_url", "NO_WEBURL"),
194	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/mr_parser.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
208	                    IS_BATCHABLE,
209	                    mr.attributes.get("web_url", "NO_WEBURL"),
210	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/renderer.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	    ) -> bool:
47	        namespace_selector = deepcopy(target.get("namespaceSelector"))
48	        if namespace_selector:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/renderer.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	            for target in rt["targets"]:
71	                if not self._is_wanted_target(subscriber=subscriber, target=target):
72	                    continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/renderer.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	                    continue
73	                target_promotion = target.get("promotion")
74	                if not target_promotion:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/renderer.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	                    continue
76	                if not bool(target_promotion.get("auto", False)):
77	                    continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/renderer.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	                subscriber_channels = {ch.name for ch in subscriber.channels}
79	                target_channels = set(target_promotion.get("subscribe", []))
80	                if subscriber_channels != target_channels:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/renderer.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	            target["ref"] = subscriber.desired_ref
99	            cur_promotion_data = target["promotion"].get("promotion_data", [])
100	            for desired_config_hash in subscriber.desired_hashes:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/renderer.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	                        continue
105	                    data = cur_hash.get("data", [])
106	                    for d in data:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/saas_auto_promotions_manager/merge_request_manager/renderer.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	                    for d in data:
107	                        if d.get("parent_saas") != desired_config_hash.parent_saas:
108	                            continue

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/slack_usergroups.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	            instance = queries.get_github_instance()
87	            token = secret_reader.read(instance["token"])
88	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/statuspage/atlassian.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	    def _do_get(self, url: str, params: dict[str, Any]) -> Response:
77	        response = requests.get(
78	            url, params=params, headers=self.auth_headers, timeout=30
79	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/statuspage/atlassian.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	            params = {"page": page, "per_page": per_page}
89	            response = self._do_get(url, params=params)
90	            items = response.json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/statuspage/atlassian.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
113	        url = f"{self.api_url}/v1/pages/{self.page_id}/components"
114	        response = requests.post(
115	            url, json={"component": data}, headers=self.auth_headers
116	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/statuspage/atlassian.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
135	        url = f"{self.api_url}/v1/pages/{self.page_id}/incidents"
136	        response = requests.post(
137	            url, json={"incident": data}, headers=self.auth_headers
138	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/statuspage/atlassian.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
186	    def get_raw_component_by_id(self, id: str) -> AtlassianRawComponent | None:
187	        return self._components_by_id.get(id)
188	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/statuspage/atlassian.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	        group_name = (
207	            self._group_id_to_name.get(raw_component.group_id)
208	            if raw_component.group_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/statuspage/atlassian.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
256	            # reason or the component is not found on the page anymore
257	            component = self._components_by_displayname.get(
258	                desired_component.display_name
259	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/statuspage/atlassian.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
277	        current_group_name = (
278	            self._group_id_to_name.get(current.group_id)
279	            if current and current.group_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/statuspage/atlassian.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
285	        if desired.group_name:
286	            group_id = self._group_name_to_id.get(desired.group_name, None)
287	            if not group_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/statuspage/atlassian.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
348	        group_id = (
349	            self._group_name_to_id.get(desired.group_name, None)
350	            if desired.group_name

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/templating/lib/merge_request_manager.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	MR_DESC = string.Template(
39	    f"""
40	This MR is triggered by app-interface's [template-rendering](https://github.com/app-sre/qontract-reconcile/blob/master/reconcile/templating/renderer.py).
41	
42	Please **do not remove the {TR_LABEL} label** from this MR!
43	
44	Parts of this description are used by the Template Renderer to manage the MR.
45	
46	{DATA_SEPARATOR}
47	
48	* {VERSION_REF}: $version
49	* {COLLECTION_REF}: $collection
50	* {TEMPLATE_RESULT_HASH_REF}: $result_hash
51	"""

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/templating/renderer.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	            ) as f:
87	                return f.read()
88	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/templating/renderer.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	        if path not in self.content_cache:
135	            self.content_cache[path] = self.persistence.read(path)
136	        return self.content_cache[path]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/templating/renderer.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
143	            for output in self.output_cache.values():
144	                self.persistence.write(output)
145	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/templating/renderer.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
143	            for output in self.output_cache.values():
144	                self.persistence.write(output)
145	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/templating/renderer.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	        target_path = r.render_target_path()
288	        current_file = persistence.read(target_path)
289	        if current_file is None and template.patch:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/templating/renderer.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
330	                ):
331	                    persistence_transaction.write(output)
332	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/templating/renderer.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
330	                ):
331	                    persistence_transaction.write(output)
332	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_init/merge_request.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	DESC = string.Template(
19	    f"""
20	This MR is triggered by app-interface's [terraform-init](https://github.com/app-sre/qontract-reconcile/tree/master/reconcile/terraform_init).
21	
22	Please **do not remove** the **{LABEL}** label from this MR!
23	
24	Parts of this description are used by integration to manage the MR.
25	
26	{PROMOTION_DATA_SEPARATOR}
27	
28	* {VERSION_REF}: {VERSION}
29	* {ACCOUNT_REF}: $account
30	"""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_repo.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	            logging.warning(
113	                "Unable to parse existing Terraform-Repo state from S3. Will re-create internal state upon apply, more info here: https://gitlab.cee.redhat.com/service/app-interface/-/blob/master/docs/terraform-repo/sop/statefile-load-errors.md",
114	                exc_info=err,
115	            )
116	            repo_diff_result = self.calculate_diff(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_users.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	):
150	    msg_template = """
151	You have been invited to join the {} AWS account!
152	Below you will find credentials for the first sign in.
153	You will be requested to change your password.
154	
155	The password is encrypted with your public gpg key. To decrypt the password:
156	
157	echo <password> | base64 -d | gpg -d - && echo
158	(you will be asked to provide your passphrase to unlock the secret)
159	
160	Once you are logged in, navigate to the "Security credentials" page [1] and enable MFA [2].
161	Once you have enabled MFA, sign out and sign in again.
162	
163	Details:
164	
165	Console URL: {}
166	Username: {}
167	Encrypted password: {}
168	
169	[1] https://console.aws.amazon.com/iam/home#security_credential
170	[2] https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa.html
171	
172	"""
173	    mails = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_vpc_resources/integration.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	            # Else get None
86	            private_subnets = outputs_per_account.get(
87	                f"{request.identifier}-private_subnets", {}
88	            ).get("value", [])
89	            public_subnets = outputs_per_account.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_vpc_resources/integration.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	            # Else get None
86	            private_subnets = outputs_per_account.get(
87	                f"{request.identifier}-private_subnets", {}
88	            ).get("value", [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_vpc_resources/integration.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	            ).get("value", [])
89	            public_subnets = outputs_per_account.get(
90	                f"{request.identifier}-public_subnets", {}
91	            ).get("value", [])
92	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_vpc_resources/integration.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	            ).get("value", [])
89	            public_subnets = outputs_per_account.get(
90	                f"{request.identifier}-public_subnets", {}
91	            ).get("value", [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_vpc_resources/integration.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	                "static": {
95	                    "vpc_id": outputs_per_account.get(
96	                        f"{request.identifier}-vpc_id", {}
97	                    ).get("value"),
98	                    "subnets": {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_vpc_resources/integration.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	                "static": {
95	                    "vpc_id": outputs_per_account.get(
96	                        f"{request.identifier}-vpc_id", {}
97	                    ).get("value"),

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_vpc_resources/integration.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
204	
205	            mr_manager.create_merge_request(
206	                MrData(
207	                    account=outputs["static"]["account_name"],
208	                    content=content,
209	                    path=f"data/aws/{outputs['static']['account_name']}/vpcs/{outputs['static']['identifier']}.yml",
210	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/terraform_vpc_resources/merge_request.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	DESC = string.Template(
19	    f"""
20	This MR is triggered by app-interface's [terraform-vpc-resources](https://github.com/app-sre/qontract-reconcile/tree/master/reconcile/terraform_vpc_request).
21	
22	Please **do not remove** the **{LABEL}** label from this MR!
23	
24	Parts of this description are used by integration to manage the MR.
25	
26	{PROMOTION_DATA_SEPARATOR}
27	
28	* {VERSION_REF}: {VERSION}
29	* {ACCOUNT_REF}: $account
30	"""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/acs/base.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	        for attr in attrs:
50	            value = api_data.get(attr)
51	            if value is None or len(value) == 0:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/acs/base.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
62	        }
63	        response = self.session.request(
64	            verb,
65	            url,
66	            headers=headers,
67	            json=json,
68	            timeout=self.timeout,
69	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/acs/base.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
80	    ) -> Any:
81	        return self.generic_request(path, verb, json=json).json()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/amtool.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
30	    with tempfile.NamedTemporaryFile(mode="w+", encoding="locale") as fp:
31	        fp.write(yaml_config)
32	        fp.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/amtool.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
41	    with tempfile.NamedTemporaryFile(mode="w+", encoding="locale") as fp:
42	        fp.write(yaml_config)
43	        fp.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/aws_api.py:2137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2136	        return (
2137	            s3.get_object(Bucket=bucket_name, Key=path)["Body"].read().decode("utf-8")
2138	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/binary.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	                        f"Aborting: Could not find binary: {b}. "
21	                        + f"Hint: https://command-not-found.com/{b}"
22	                    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/deadmanssnitch_api.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	BASE_URL = "https://api.deadmanssnitch.com/v1/snitches"
11	REQUEST_TIMEOUT = 60

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/deadmanssnitch_api.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	        logging.debug("Getting snitches for tags:%s", tags)
52	        response = self.session.get(
53	            url=self.url,
54	            params={"tags": ",".join(tags)},
55	            auth=(self.token, ""),
56	            timeout=self.timeout,
57	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/deadmanssnitch_api.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	    def create_snitch(self, payload: dict) -> Snitch:
63	        if payload.get("name") is None or payload.get("interval") is None:
64	            raise DeadManssnitchException(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/deadmanssnitch_api.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	    def create_snitch(self, payload: dict) -> Snitch:
63	        if payload.get("name") is None or payload.get("interval") is None:
64	            raise DeadManssnitchException(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/deadmanssnitch_api.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
68	        logging.debug("Creating new snitch with name:: %s ", payload["name"])
69	        response = self.session.post(
70	            url=self.url,
71	            json=payload,
72	            auth=(self.token, ""),
73	            headers=headers,
74	            timeout=self.timeout,
75	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/github_api.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	GH_BASE_URL = os.environ.get("GITHUB_API", "https://api.github.com")
10	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
124	            secret_reader = SecretReader(settings=settings)
125	        token = secret_reader.read(instance["token"])
126	        self.ssl_verify = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	                name_with_namespace = parsed_project_url.path.strip("/")
148	                self.project = self.gl.projects.get(name_with_namespace)
149	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149	        else:
150	            self.project = self.gl.projects.get(project_id)
151	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	    def get_app_sre_group_users(self) -> list[GroupMember]:
277	        app_sre_group = self.gl.groups.get("app-sre")
278	        return self.get_items(app_sre_group.members.list)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
281	        try:
282	            return self.gl.groups.get(group_name)
283	        except GitlabGetError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
332	        except GitlabCreateError:
333	            member = project.members.get(user.id)
334	            member.access_level = access_level

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
345	            except GitlabCreateError:
346	                member = group.members.get(user.user)
347	                member.access_level = user.access_level

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
377	    def get_group_id_and_projects(self, group_name: str) -> tuple[str, list[str]]:
378	        group = self.gl.groups.get(group_name)
379	        return group.id, [p.name for p in self.get_items(group.projects.list)]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
381	    def get_group(self, group_name: str) -> Group:
382	        return self.gl.groups.get(group_name)
383	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
393	        try:
394	            project = self.gl.projects.get(repo)
395	        except GitlabGetError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
400	    def get_project_by_id(self, project_id: int) -> Project:
401	        return self.gl.projects.get(project_id)
402	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
406	    def get_merge_request(self, mr_id: str | int) -> ProjectMergeRequest:
407	        return self.project.mergerequests.get(mr_id)
408	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
584	            raise ValueError("item must have an id")
585	        refreshed_item = manager.get(item_id)
586	        item.labels = refreshed_item.labels

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
679	            path = path.lstrip("/")
680	            return self.project.files.get(file_path=path, ref=ref)
681	        except GitlabGetError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gitlab_api.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
803	        response: Any = project.repository_compare(ref_from, ref_to)
804	        return response.get("commits", [])
805	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gpg.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
11	def gpg_encrypt(content, public_gpg_key):
12	    public_gpg_key_dec = base64.b64decode(public_gpg_key)
13	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gpg.py:12
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
11	def gpg_encrypt(content, public_gpg_key):
12	    public_gpg_key_dec = base64.b64decode(public_gpg_key)
13	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gql.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
154	        # show schemas if log level is debug
155	        query_schemas = result.get("extensions", {}).get("schemas", [])
156	        self._queried_schemas.update(query_schemas)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gql.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
154	        # show schemas if log level is debug
155	        query_schemas = result.get("extensions", {}).get("schemas", [])
156	        self._queried_schemas.update(query_schemas)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gql.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
349	    headers = {"Authorization": token} if token else None
350	    response = requests.get(sha_endpoint.geturl(), headers=headers, timeout=60)
351	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gql.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
359	    headers = {"Authorization": token} if token else None
360	    response = requests.get(
361	        git_commit_info_endpoint.geturl(), headers=headers, timeout=60
362	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gql.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
398	    server = server_url.geturl()
399	    token = config["graphql"].get("token")
400	    if sha:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gql.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
407	        git_commit_info = get_git_commit_info(sha, server_url, token)
408	        running_state.timestamp = git_commit_info.get("timestamp")  # type: ignore[attr-defined]
409	        running_state.commit = git_commit_info.get("commit")  # type: ignore[attr-defined]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gql.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
408	        running_state.timestamp = git_commit_info.get("timestamp")  # type: ignore[attr-defined]
409	        running_state.commit = git_commit_info.get("commit")  # type: ignore[attr-defined]
410	        return server, token, running_state.commit, running_state.timestamp

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gql.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
457	    server_url = urlparse(config["graphql"]["server"])
458	    token = config["graphql"].get("token")
459	    current_sha = get_sha(server_url, token)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/gql.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
469	    headers = {"Authorization": token} if token else None
470	    response = requests.get(diff_endpoint.geturl(), headers=headers, timeout=30)
471	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/helm.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	            ) as values_file:
73	                values_file.write(json.dumps(values, cls=JSONEncoder))
74	                values_file.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/helm.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
72	            ) as values_file:
73	                values_file.write(json.dumps(values, cls=JSONEncoder))
74	                values_file.flush()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/instrumented_wrappers.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
17	
18	INTEGRATION_NAME = os.environ.get("INTEGRATION_NAME", "")
19	SHARDS = int(os.environ.get("SHARDS", "1"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/instrumented_wrappers.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
18	INTEGRATION_NAME = os.environ.get("INTEGRATION_NAME", "")
19	SHARDS = int(os.environ.get("SHARDS", "1"))
20	SHARD_ID = int(os.environ.get("SHARD_ID", "0"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/instrumented_wrappers.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	SHARDS = int(os.environ.get("SHARDS", "1"))
20	SHARD_ID = int(os.environ.get("SHARD_ID", "0"))
21	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/instrumented_wrappers.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
69	        self.counter.inc()
70	        return super().request(*args, **kwargs)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/internal_groups/client.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
71	        try:
72	            return self._client.request(
73	                method=method,
74	                url=url,
75	                json=json,
76	                # Content-Type is required for GET too :(
77	                headers={"Content-Type": "application/json"},
78	                timeout=timeout,
79	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/internal_groups/client.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
89	        """Get a group by name."""
90	        resp = self._request("GET", f"{self.api_url}/v1/groups/{name}")
91	        self._check_response(resp)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/internal_groups/client.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
95	        """Delete a group by name."""
96	        resp = self._request("DELETE", f"{self.api_url}/v1/groups/{name}")
97	        self._check_response(resp)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/internal_groups/client.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
100	        """Create a group."""
101	        resp = self._request("POST", f"{self.api_url}/v1/groups/", json=data)
102	        self._check_response(resp)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/internal_groups/client.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
106	        """Update a group."""
107	        resp = self._request(
108	            "PATCH",
109	            f"{self.api_url}/v1/groups/{name}",
110	            json=data,
111	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
36	        url = f"{self.url}/manage/configuration-as-code/export"
37	        res = requests.post(
38	            url,
39	            verify=self.ssl_verify,
40	            auth=(self.user, self.password),
41	            timeout=60,
42	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
47	        url = f"{self.url}/manage/configuration-as-code/apply"
48	        res = requests.post(
49	            url,
50	            verify=self.ssl_verify,
51	            auth=(self.user, self.password),
52	            data=yaml.safe_dump(config),
53	            timeout=60,
54	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
58	        url = f"{self.url}/api/json?tree=jobs[name]"
59	        res = requests.get(
60	            url, verify=self.ssl_verify, auth=(self.user, self.password), timeout=60
61	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	        url = f"{self.url}/api/json?tree=jobs[name,builds[number,result,actions[lastBuiltRevision[SHA1]]]]"
70	        res = requests.get(
71	            url, verify=self.ssl_verify, auth=(self.user, self.password), timeout=60
72	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	            job_name = r["name"]
78	            builds = r.get("builds", [])
79	            for b in builds:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	            for b in builds:
80	                actions = b.get("actions", [])
81	                for a in actions:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	                for a in actions:
82	                    revision = a.get("lastBuiltRevision")
83	                    if revision:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
90	        url = f"{self.url}/job/{job_name}/{build_id}/doDelete"
91	        res = requests.post(
92	            url, verify=self.ssl_verify, auth=(self.user, self.password), timeout=60
93	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
99	        url = f"{self.url}/job/{job_name}/doDelete"
100	        res = requests.post(
101	            url,
102	            verify=self.ssl_verify,
103	            auth=(self.user, self.password),
104	            timeout=60,
105	            **kwargs,
106	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	        url = f"{self.url}/role-strategy/strategy/getAllRoles"
112	        res = requests.get(
113	            url, verify=self.ssl_verify, auth=(self.user, self.password), timeout=60
114	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
121	        data = {"type": "globalRoles", "roleName": role, "sid": user}
122	        res = requests.post(
123	            url,
124	            verify=self.ssl_verify,
125	            data=data,
126	            auth=(self.user, self.password),
127	            timeout=60,
128	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
134	        data = {"type": "globalRoles", "roleName": role, "sid": user}
135	        res = requests.post(
136	            url,
137	            verify=self.ssl_verify,
138	            data=data,
139	            auth=(self.user, self.password),
140	            timeout=60,
141	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
152	            )
153	            res = requests.post(
154	                url, verify=self.ssl_verify, auth=(self.user, self.password), timeout=60
155	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	        )
164	        res = requests.get(
165	            url, verify=self.ssl_verify, auth=(self.user, self.password), timeout=60
166	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	        url = f"{self.url}/job/{job_name}/lastBuild/api/json"
183	        res = requests.get(
184	            url, verify=self.ssl_verify, auth=(self.user, self.password), timeout=60
185	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	            crumb_url = f"{self.url}/crumbIssuer/api/json"
198	            res = requests.get(
199	                crumb_url,
200	                verify=self.ssl_verify,
201	                auth=(self.user, self.password),
202	                timeout=60,
203	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jenkins_api.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
217	        url = f"{self.url}/job/{job_name}/build"
218	        res = requests.post(
219	            url,
220	            verify=self.ssl_verify,
221	            auth=(self.user, self.password),
222	            timeout=60,
223	            **kwargs,
224	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jinja2/extensions.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
26	        content = textwrap.dedent(content)
27	        return base64.b64encode(content.encode()).decode("utf-8")
28	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jinja2/extensions.py:27
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
26	        content = textwrap.dedent(content)
27	        return base64.b64encode(content.encode()).decode("utf-8")
28	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	JJB_INI = "[jenkins]\nurl = https://JENKINS_URL"
30	
31	
32	class JJB:  # pylint: disable=too-many-public-methods

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	            if not self.print_only:
60	                ini = self.secret_reader.read(token)
61	                ini = ini.replace('"', "")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
64	            with open(ini_file_path, "w", encoding="locale") as f:
65	                f.write(ini)
66	                f.write("\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
64	            with open(ini_file_path, "w", encoding="locale") as f:
65	                f.write(ini)
66	                f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
65	                f.write(ini)
66	                f.write("\n")
67	            working_dirs[name] = wd

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
65	                f.write(ini)
66	                f.write("\n")
67	            working_dirs[name] = wd

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	                    yaml.dump(content, f)
83	                    f.write("\n")
84	            else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
82	                    yaml.dump(content, f)
83	                    f.write("\n")
84	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
86	                with open(config_file_path, "a", encoding="locale") as f:
87	                    f.write(config)
88	                    f.write("\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
86	                with open(config_file_path, "a", encoding="locale") as f:
87	                    f.write(config)
88	                    f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	                    f.write(config)
88	                    f.write("\n")
89	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
87	                    f.write(config)
88	                    f.write("\n")
89	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
100	            with open(config_path, "w", encoding="locale") as f:
101	                f.write(configs[name])
102	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
100	            with open(config_path, "w", encoding="locale") as f:
101	                f.write(configs[name])
102	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
136	            with open(config_path, encoding="locale") as f:
137	                configs[name] = f.read()
138	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
267	        for wd in self.working_dirs.values():
268	            shutil.rmtree(wd)
269	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jjb_client.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
292	                    project_url_raw = job["properties"][0]["github"]["url"]
293	                    if "https://github.com" in project_url_raw:
294	                        continue

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jump_host.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	        with open(identity_file, "w", encoding="locale") as f:
48	            f.write(self._identity)
49	        os.chmod(identity_file, 0o600)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jump_host.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
47	        with open(identity_file, "w", encoding="locale") as f:
48	            f.write(self._identity)
49	        os.chmod(identity_file, 0o600)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jump_host.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
48	            f.write(self._identity)
49	        os.chmod(identity_file, 0o600)
50	        self._identity_file = identity_file

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jump_host.py:49
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
48	            f.write(self._identity)
49	        os.chmod(identity_file, 0o600)
50	        self._identity_file = identity_file

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jump_host.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
52	    def cleanup(self) -> None:
53	        shutil.rmtree(self._identity_dir)
54	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jump_host.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	        with open(known_hosts_file, "w", encoding="locale") as f:
99	            f.write(self._known_hosts)
100	        os.chmod(known_hosts_file, 0o600)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jump_host.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
98	        with open(known_hosts_file, "w", encoding="locale") as f:
99	            f.write(self._known_hosts)
100	        os.chmod(known_hosts_file, 0o600)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jump_host.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
99	            f.write(self._known_hosts)
100	        os.chmod(known_hosts_file, 0o600)
101	        self.known_hosts_file = known_hosts_file

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/jump_host.py:100
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
99	            f.write(self._known_hosts)
100	        os.chmod(known_hosts_file, 0o600)
101	        self.known_hosts_file = known_hosts_file

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/keycloak.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	            return None
48	        return requests.get(
49	            f"{self.url}/.well-known/openid-configuration",
50	            timeout=self.timeout,
51	        ).json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/keycloak.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
66	
67	        response = requests.post(
68	            self._openid_configuration["registration_endpoint"],
69	            json={
70	                "client_name": client_name,
71	                "redirect_uris": redirect_uris,
72	                "response_types": ["code"],
73	                "grant_types": ["authorization_code"],
74	                "application_type": "web",
75	                "contacts": contacts,
76	                "initiate_login_uri": initiate_login_uri,
77	                "request_uris": request_uris,
78	            },
79	            headers={"Authorization": f"Bearer {self.initial_access_token}"},
80	            timeout=self.timeout,
81	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/membershipsources/app_interface_resolver.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
30	    password = secret_reader.read_secret(source.password)
31	    basic_auth_info = base64.b64encode(f"{username}:{password}".encode()).decode()
32	    gql_api = gql.get_api_for_server(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/membershipsources/app_interface_resolver.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
30	    password = secret_reader.read_secret(source.password)
31	    basic_auth_info = base64.b64encode(f"{username}:{password}".encode()).decode()
32	    gql_api = gql.get_api_for_server(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/mr/promote_qontract.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
173	            path="data/services/app-interface/cicd/ci-ext/saas-qontract-dashboards.yaml",
174	            search_text="$.resourceTemplates[?(@.url == 'https://github.com/app-sre/qontract-reconcile')].targets[?(@.name == 'app-sre-observability-production')].ref",
175	            replace_text=self.commit_sha,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/mr/promote_qontract.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
182	            path="data/services/app-interface/cicd/ci-int/saas-qontract-manager-int.yaml",
183	            search_text="$.resourceTemplates[?(@.url == 'https://github.com/app-sre/qontract-reconcile')].targets[?(@.name == 'app-interface-production')].ref",
184	            replace_text=self.commit_sha,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/oauth2_backend_application_session.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
78	        try:
79	            return self.session.request(
80	                method=method,
81	                url=url,
82	                data=data,
83	                headers=headers,
84	                withhold_token=withhold_token,
85	                client_id=client_id,
86	                client_secret=client_secret,
87	                **kwargs,
88	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/oauth2_backend_application_session.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
90	            self.fetch_token()
91	            return self.session.request(
92	                method=method,
93	                url=url,
94	                data=data,
95	                headers=headers,
96	                withhold_token=withhold_token,
97	                client_id=client_id,
98	                client_secret=client_secret,
99	                **kwargs,
100	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/oauth2_backend_application_session.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	    def get(self, url: str, **kwargs: Any) -> Response:
123	        return self.session.get(url, **kwargs)
124	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/oauth2_backend_application_session.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
125	    def post(self, url: str, **kwargs: Any) -> Response:
126	        return self.session.post(url, **kwargs)
127	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/oc.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
346	            secret_reader = SecretReader(settings=settings)
347	            key = secret_reader.read(jh["identity"])
348	            jumphost_parameters = JumphostParameters(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/oc.py:1297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1296	            local_port = self.jump_host.local_port
1297	            opts["proxy"] = f"http://localhost:{local_port}"
1298	        configuration = Configuration()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/ocm_base_client.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
57	        }
58	        r = self._session.post(
59	            self._access_token_url, data=data, timeout=REQUEST_TIMEOUT_SEC
60	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/ocm_base_client.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	        r.raise_for_status()
62	        self._access_token = r.json().get("access_token")
63	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/ocm_base_client.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        ocm_request.labels(verb="GET", client_id=self._access_token_client_id).inc()
72	        r = self._session.get(
73	            f"{self._url}{api_path}",
74	            params=params,
75	            timeout=REQUEST_TIMEOUT_SEC,
76	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/ocm_base_client.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	        while True:
96	            rs = self.get(api_path, params=params_copy)
97	            yield from rs.get("items", [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/ocm_base_client.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	            rs = self.get(api_path, params=params_copy)
97	            yield from rs.get("items", [])
98	            current_page = rs.get("page", 0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/ocm_base_client.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	            yield from rs.get("items", [])
98	            current_page = rs.get("page", 0)
99	            records_on_page = rs.get("size", len(rs.get("items", [])))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/ocm_base_client.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	            current_page = rs.get("page", 0)
99	            records_on_page = rs.get("size", len(rs.get("items", [])))
100	            if records_on_page < max_page_size:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/ocm_base_client.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	            current_page = rs.get("page", 0)
99	            records_on_page = rs.get("size", len(rs.get("items", [])))
100	            if records_on_page < max_page_size:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/ocm_base_client.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
112	        ocm_request.labels(verb="POST", client_id=self._access_token_client_id).inc()
113	        r = self._session.post(
114	            f"{self._url}{api_path}",
115	            json=data,
116	            params=params,
117	            timeout=REQUEST_TIMEOUT_SEC,
118	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/openshift_resource.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	DNS_NAMES_URL = (
42	    "https://kubernetes.io/docs/concepts/overview/working-with-objects/names/"
43	)
44	
45	IGNORABLE_DATA_FIELDS = ["service-ca.crt"]
46	# these labels existance and/or value is determined by a controller running

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/openshift_resource.py:707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
706	        return ""
707	    return base64.b64encode(str(value).encode()).decode("utf-8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/openshift_resource.py:707
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
706	        return ""
707	    return base64.b64encode(str(value).encode()).decode("utf-8")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/pagerduty_api.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	            for entry in entries
114	            if not entry["user"].get("deleted_at")
115	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/pagerduty_api.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	
215	        pd = pagerduty_map.get(pagerduty.instance.name)
216	        pagerduty_names = pd.get_pagerduty_users(pd_resource_type, pd_resource_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/prometheus.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	    def label(self, label_name: str, default: str | None = None) -> str | None:
45	        return self.metric.get(label_name, default)
46	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/prometheus.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	    def instant_vector_query(self, query: str) -> list[PrometheusVector]:
64	        response = requests.get(
65	            self.query_url,
66	            params={"query": query},
67	            headers={
68	                "Authorization": f"Bearer {self.auth_token}",
69	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/prometheus.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	            ) from e
81	        if parsed.get("status") != "success":
82	            raise PrometheusQueryError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/prometheus.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	            raise PrometheusQueryError(
83	                f"Query response status was not `success`but {parsed.get('status')}"
84	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/prometheus.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	            )
89	        result_type = parsed.get("data", {}).get("resultType")
90	        if result_type != INSTANT_VECTOR_RESULT_TYPE:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/prometheus.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	            )
89	        result_type = parsed.get("data", {}).get("resultType")
90	        if result_type != INSTANT_VECTOR_RESULT_TYPE:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/prometheus.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
111	            }
112	            response = requests.post(
113	                prometheus.auth.access_token_url, data=data, timeout=15
114	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/prometheus.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
115	            response.raise_for_status()
116	            auth_token = response.json().get("access_token")
117	        case _:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/promtool.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
35	            with tempfile.NamedTemporaryFile(delete=False) as fp:
36	                fp.write(yaml.dump(yaml_spec).encode())
37	                temp_rule_files[rule_file] = fp.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/promtool.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
35	            with tempfile.NamedTemporaryFile(delete=False) as fp:
36	                fp.write(yaml.dump(yaml_spec).encode())
37	                temp_rule_files[rule_file] = fp.name

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/promtool.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	        try:
62	            fp.write(yaml.dump(yaml_spec).encode())
63	            fp.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/promtool.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
61	        try:
62	            fp.write(yaml.dump(yaml_spec).encode())
63	            fp.flush()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	        """
28	        if kwargs.get("cache"):
29	            cache_members = self.team_members.get(team)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	        if kwargs.get("cache"):
29	            cache_members = self.team_members.get(team)
30	            if cache_members:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	
35	        r = requests.get(url, headers=self.auth_header, timeout=self._timeout)
36	        if r.status_code == 404:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	        url = f"{self.api_url}/users/{user}"
57	        r = requests.get(url, headers=self.auth_header, timeout=self._timeout)
58	        return r.ok

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	        if not r.ok:
69	            message = r.json().get("message", "")
70	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138	        # perform request
139	        r = requests.get(
140	            url, params=params, headers=self.auth_header, timeout=self._timeout
141	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	        body = r.json()
146	        repositories = body.get("repositories", [])
147	        next_page = body.get("next_page")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	        repositories = body.get("repositories", [])
147	        next_page = body.get("next_page")
148	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
177	        # perform request
178	        r = requests.post(
179	            url, json=params, headers=self.auth_header, timeout=self._timeout
180	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
212	        # perform request
213	        r = requests.post(
214	            url, json=params, headers=self.auth_header, timeout=self._timeout
215	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	        )
223	        r = requests.get(url, headers=self.auth_header, timeout=self._timeout)
224	        if not r.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
224	        if not r.ok:
225	            message = r.json().get("message")
226	            expected_message = "Team does not have permission for repo."

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/quay_api.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	
232	        return r.json().get("role") or None
233	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/raw_github_api.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
14	
15	    BASE_URL = os.environ.get("GITHUB_API", "https://api.github.com")
16	    BASE_HEADERS = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/raw_github_api.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	    BASE_URL = os.environ.get("GITHUB_API", "https://api.github.com")
16	    BASE_HEADERS = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/raw_github_api.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
41	        h = self.headers(headers)
42	        res = requests.get(self.BASE_URL + url, headers=h, timeout=60)
43	        res.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/raw_github_api.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
50	                    req_url = res.links["next"]["url"]
51	                    res = requests.get(req_url, headers=h, timeout=60)
52	                    res.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/raw_github_api.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	                req_url = res.links["next"]["url"]
58	                res = requests.get(req_url, headers=h, timeout=60)
59	                res.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/raw_github_api.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	            login
72	            for login in (invitation.get("login") for invitation in invitations)
73	            if login is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/raw_github_api.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	            login
81	            for login in (invitation.get("login") for invitation in invitations)
82	            if login is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/rest_api_base.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	    """
20	    if links.get("next", {}).get("results", "false") == "true":
21	        return links["next"]["url"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/rest_api_base.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	    """
20	    if links.get("next", {}).get("results", "false") == "true":
21	        return links["next"]["url"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/rest_api_base.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	    def _get(self, url: str, params: dict | None = None) -> dict[str, Any]:
78	        response = self.session.get(
79	            urljoin(self.host, url), params=params, timeout=self.read_timeout
80	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/rest_api_base.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	    ) -> list[dict[str, Any]]:
93	        response = self.session.get(
94	            urljoin(self.host, url), params=params, timeout=self.read_timeout
95	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/rest_api_base.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	            while next_url := get_next_url(response.links):
101	                response = self.session.get(next_url)
102	                results += response.json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/rest_api_base.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
107	    def _post(self, url: str, data: dict | None = None) -> dict[str, Any]:
108	        response = self.session.post(
109	            urljoin(self.host, url), json=data, timeout=self.read_timeout
110	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/rosa/rosa_cli.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	        with open(self.log_file, encoding="utf-8") as f:
52	            logger(f.read())
53	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/runtime/desired_state_diff.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
139	
140	    process = multiprocessing.Process(
141	        target=_extract_diffs_task,
142	        args=(
143	            extraction_function,
144	            previous_desired_state,
145	            current_desired_state,
146	            result_value,
147	        ),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/models.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
208	                    self.auth_server: {
209	                        "auth": base64.b64encode(
210	                            f"{self.username}:{self.password}".encode()
211	                        ).decode(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/models.py:209
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
208	                    self.auth_server: {
209	                        "auth": base64.b64encode(
210	                            f"{self.username}:{self.password}".encode()
211	                        ).decode(),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
457	        for sub_channel, sub_targets in subscriptions.items():
458	            pub_channel_refs = publications.get(sub_channel, set())
459	            for sub_saas, sub_rt_name, sub_rt_url, _ in sub_targets:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
589	    ) -> None:
590	        image_tag = parameters.get("IMAGE_TAG")
591	        if image_tag and str(ref).startswith(str(image_tag)):

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
731	            blob = repo.get_git_blob(x.sha)
732	            return base64.b64decode(blob.content).decode("utf8")
733	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:732
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
731	            blob = repo.get_git_blob(x.sha)
732	            return base64.b64decode(blob.content).decode("utf8")
733	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
745	        if "github" in url:
746	            github = self._initiate_github(saas_file, base_url="https://api.github.com")
747	            repo = github.get_repo(repo_name)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:764
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
763	        if "github" in url:
764	            repo_name = url.rstrip("/").replace("https://github.com/", "")
765	            repo = github.get_repo(repo_name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
770	            project = self.gitlab.get_project(url)
771	            f = project.files.get(file_path=path.lstrip("/"), ref=commit_sha)
772	            content = f.decode()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
784	        if "github" in url:
785	            repo_name = url.rstrip("/").replace("https://github.com/", "")
786	            repo = github.get_repo(repo_name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
803	            ):
804	                file_contents = project.files.get(
805	                    file_path=item["path"], ref=commit_sha
806	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
817	        if "github" in url:
818	            repo_name = url.rstrip("/").replace("https://github.com/", "")
819	            repo = github.get_repo(repo_name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
840	                        for rule in rules:
841	                            annotations = rule.get("annotations")
842	                            if not annotations:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
869	            return False
870	        for template_parameter in template.get("parameters", {}):
871	            if template_parameter["name"] == parameter_name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
901	            # add IMAGE_TAG only if it is unspecified
902	            if not (image_tag := consolidated_parameters.get("IMAGE_TAG", "")):
903	                sha_substring = commit_sha[:hash_length]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1113	                username, password = (
1114	                    base64.b64decode(auth["auth"]).decode("utf-8").split(":")
1115	                )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1113	                username, password = (
1114	                    base64.b64decode(auth["auth"]).decode("utf-8").split(":")
1115	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1196	        if not base_url:
1197	            base_url = os.environ.get("GITHUB_API", "https://api.github.com")
1198	        return Github(token, base_url=base_url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1196	        if not base_url:
1197	            base_url = os.environ.get("GITHUB_API", "https://api.github.com")
1198	        return Github(token, base_url=base_url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1232	        return ImageAuth(
1233	            username=creds.get("user"),
1234	            password=creds.get("token"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1233	            username=creds.get("user"),
1234	            password=creds.get("token"),
1235	            auth_server=creds.get("url"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1234	            password=creds.get("token"),
1235	            auth_server=creds.get("url"),
1236	            docker_config=json.loads(creds.get(".dockerconfigjson") or "{}"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1235	            auth_server=creds.get("url"),
1236	            docker_config=json.loads(creds.get(".dockerconfigjson") or "{}"),
1237	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1468	                        raise Exception("state is not initialized")
1469	                    current_commit_sha = self.state.get(trigger_spec.state_key, None)
1470	                    # skip if there is no change in commit sha

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1529	                job_name = target.upstream.name
1530	                job_history = current_state[target.upstream.instance.name].get(
1531	                    job_name, []
1532	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1551	                    trigger_spec.reason = f"{target.upstream.instance.server_url}/job/{job_name}/{last_build_result_number}"
1552	                    last_build_result_commit_sha = last_build_result.get("commit_sha")
1553	                    if last_build_result_commit_sha:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1559	                    raise Exception("state is not initialized")
1560	                state_build_result = self.state.get(trigger_spec.state_key, None)
1561	                # skip if last_build_result is incomplete or

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1669	                        raise Exception("state is not initialized")
1670	                    current_image_tag = self.state.get(trigger_spec.state_key, None)
1671	                    # skip if there is no change in image tag

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1720	        for key, trigger_spec in all_trigger_specs.items():
1721	            current_target_config = self.state.get(key, None)
1722	            # Continue if there are no diffs between configs.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1737	                # to reduce false-positives.
1738	                promotion = trigger_spec.state_content.get("promotion")
1739	                if promotion and promotion.get("auto", False):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1738	                promotion = trigger_spec.state_content.get("promotion")
1739	                if promotion and promotion.get("auto", False):
1740	                    trigger_spec.reason += " [auto-promotion]"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1848	
1849	        if promotion.commit_sha in self.blocked_versions.get(promotion.url, set()):
1850	            logging.error(f"Commit {promotion.commit_sha} is blocked!")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:1854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1853	        # hotfix must run before further gates are evaluated to override them
1854	        if promotion.commit_sha in self.hotfix_versions.get(promotion.url, set()):
1855	            return True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:2012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2011	                    # collect data to trigger promotion
2012	                    subscribed_saas_file_paths = subscribe_saas_file_path_map.get(
2013	                        channel
2014	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/saasherder/saasherder.py:2021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2020	
2021	                    subscribed_target_paths = subscribe_target_path_map.get(channel)
2022	                    if subscribed_target_paths:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/state.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
406	            )
407	            return json.loads(response["Body"].read())
408	        except ClientError as details:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terraform/config_client.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
124	                with open(print_to_file, "a", encoding="locale") as f:
125	                    f.write(f"##### {account_name} #####\n")
126	                    f.write(client.dumps())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terraform/config_client.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
125	                    f.write(f"##### {account_name} #####\n")
126	                    f.write(client.dumps())
127	                    f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terraform/config_client.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
126	                    f.write(client.dumps())
127	                    f.write("\n")
128	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terraform_client.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
662	        for wd in self.working_dirs.values():
663	            shutil.rmtree(wd)
664	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript/cloudflare_client.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
182	        ) as terraform_config_file:
183	            terraform_config_file.write(self.dumps())
184	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript/cloudflare_resources.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
125	        secret_reader = create_secret_reader(use_vault=vault_settings.vault)
126	        token = secret_reader.read(instance["token"])
127	        gh = GithubRepositoryApi(

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript/cloudflare_resources.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
125	        secret_reader = create_secret_reader(use_vault=vault_settings.vault)
126	        token = secret_reader.read(instance["token"])
127	        gh = GithubRepositoryApi(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript/cloudflare_resources.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
199	            certificate_secret = cert_values.pop("certificate_secret")
200	            certificate = secret_reader.read(certificate_secret.pop("certificate"))
201	            key = secret_reader.read(certificate_secret.pop("key"))

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript/cloudflare_resources.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
199	            certificate_secret = cert_values.pop("certificate_secret")
200	            certificate = secret_reader.read(certificate_secret.pop("certificate"))
201	            key = secret_reader.read(certificate_secret.pop("key"))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript/cloudflare_resources.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
200	            certificate = secret_reader.read(certificate_secret.pop("certificate"))
201	            key = secret_reader.read(certificate_secret.pop("key"))
202	            bundle_method = cert_values.pop("bundle_method") or "ubiquitous"

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript/cloudflare_resources.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
200	            certificate = secret_reader.read(certificate_secret.pop("certificate"))
201	            key = secret_reader.read(certificate_secret.pop("key"))
202	            bundle_method = cert_values.pop("bundle_method") or "ubiquitous"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	
190	GH_BASE_URL = os.environ.get("GITHUB_API", "https://api.github.com")
191	LOGTOES_RELEASE = "repos/app-sre/logs-to-elasticsearch-lambda/releases/latest"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	
190	GH_BASE_URL = os.environ.get("GITHUB_API", "https://api.github.com")
191	LOGTOES_RELEASE = "repos/app-sre/logs-to-elasticsearch-lambda/releases/latest"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
192	KINESIS_TO_OS_RELEASE = (
193	    "https://github.com/app-sre/kinesis-to-opensearch-lambda/releases/latest"
194	)
195	ROSA_AUTHENTICATOR_PRE_SIGNUP_RELEASE = (
196	    "repos/app-sre/cognito-pre-signup-trigger/releases/latest"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
501	                        "source": "hashicorp/aws",
502	                        "version": self.versions.get(name),
503	                    },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
540	        self.partitions = {
541	            a["name"]: a.get("partition") or "aws" for a in filtered_accounts
542	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
578	        # defaults from account
579	        bucket_backend_value = config.get("bucket")
580	        key_backend_value = config.get(f"{integration}_key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
579	        bucket_backend_value = config.get("bucket")
580	        key_backend_value = config.get(f"{integration}_key")
581	        region_backend_value = config.get("region")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
580	        key_backend_value = config.get(f"{integration}_key")
581	        region_backend_value = config.get("region")
582	        terraform_state = config["terraformState"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
585	            for key in tf_state_integration:
586	                integration_value = key.get("integration")
587	                if integration_value.replace("-", "_") == integration:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
587	                if integration_value.replace("-", "_") == integration:
588	                    bucket_backend_value = terraform_state.get("bucket")
589	                    key_backend_value = key.get("key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
588	                    bucket_backend_value = terraform_state.get("bucket")
589	                    key_backend_value = key.get("key")
590	                    region_backend_value = terraform_state.get("region")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
589	                    key_backend_value = key.get("key")
590	                    region_backend_value = terraform_state.get("region")
591	                    break

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
605	    def get_lambda_zip(self, release_url: str) -> str:
606	        if not self.lambda_zip.get(release_url):
607	            with self.lambda_lock:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
608	                # this may have already happened, so we check again
609	                if not self.lambda_zip.get(release_url):
610	                    self.lambda_zip[release_url] = self.download_lambda_zip(release_url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
627	        if not os.path.exists(zip_file):
628	            r = requests.get(zip_url, timeout=60)
629	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
631	            with open(zip_file, "wb") as f:
632	                f.write(r.content)
633	        return zip_file

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
631	            with open(zip_file, "wb") as f:
632	                f.write(r.content)
633	        return zip_file

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
647	        headers = {"Authorization": "token " + self.token}
648	        r = requests.get(GH_BASE_URL + "/" + release_url, headers=headers, timeout=60)
649	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
653	        if not os.path.exists(zip_file):
654	            r = requests.get(zip_url, timeout=60)
655	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
656	            with open(zip_file, "wb") as f:
657	                f.write(r.content)
658	        return zip_file

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
656	            with open(zip_file, "wb") as f:
657	                f.write(r.content)
658	        return zip_file

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
676	        headers = {"Authorization": "token " + self.token}
677	        r = requests.get(GH_BASE_URL + "/" + release_url, headers=headers, timeout=60)
678	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
682	        if not os.path.exists(zip_file):
683	            r = requests.get(zip_url, timeout=60)
684	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
685	            with open(zip_file, "wb") as f:
686	                f.write(r.content)
687	        return zip_file

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
685	            with open(zip_file, "wb") as f:
686	                f.write(r.content)
687	        return zip_file

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
706	        instance_name = instance["name"]
707	        if not self.jenkins_map.get(instance_name):
708	            with self.jenkins_lock:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
709	                # this may have already happened, so we check again
710	                if not self.jenkins_map.get(instance_name):
711	                    self.jenkins_map[instance_name] = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
742	    def _get_partition(self, account):
743	        return self.partitions.get(account) or "aws"
744	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
801	    def _get_aws_username(user):
802	        return user.get("aws_username") or user["org_username"]
803	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
811	        mandatory_policies = [
812	            p for p in account.get("policies") or [] if p.get("mandatory")
813	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
811	        mandatory_policies = [
812	            p for p in account.get("policies") or [] if p.get("mandatory")
813	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:972
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
971	    def get_provider_alias(account: Mapping[str, str]) -> str:
972	        if not account.get("assume_role"):
973	            return f"account-{account['name']}-{account['assume_region']}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
981	    ) -> dict[str, Any] | None:
982	        if lifecycle := common_values.get("lifecycle"):
983	            lifecycle = NamespaceTerraformResourceLifecycleV1(**lifecycle)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
997	            account_name = account["name"]
998	            assume_role = account.get("assume_role")
999	            region = account["assume_region"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1002	            config = self.configs[account_name]
1003	            existing_provider_aliases = {p.get("alias") for p in ts["provider"]["aws"]}
1004	            if alias not in existing_provider_aliases:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1034
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1033	                "name": zone["name"],
1034	                "vpc": zone.get("vpc"),
1035	                "comment": "Managed by Terraform",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1049	        counts = {}
1050	        for record in zone.get("records") or []:
1051	            record_fqdn = f"{record['name']}.{zone['name']}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1065	            # None/zero is accepted but not a good default
1066	            if not record.get("alias") and record.get("ttl") is None:
1067	                record["ttl"] = default_ttl

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1065	            # None/zero is accepted but not a good default
1066	            if not record.get("alias") and record.get("ttl") is None:
1067	                record["ttl"] = default_ttl

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1087
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1086	                allowed_vault_secret_paths = (
1087	                    cast(set[str], zone.get("allowed_vault_secret_paths")) or set()
1088	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1097
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1096	                        )
1097	                    value = self.secret_reader.read({
1098	                        "path": rec["path"],
1099	                        "field": rec["field"],
1100	                        "version": rec["version"],
1101	                    })

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1160	            }
1161	            req_peer_owner_id = requester.get("peer_owner_id")
1162	            if req_peer_owner_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1167	            # add routes to existing route tables
1168	            route_table_ids = requester.get("route_table_ids")
1169	            if route_table_ids:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1183	            # add security group rules for private hosted controlplane API VPC endpoint service
1184	            if requester.get("api_security_group_id"):
1185	                hcp_api_ingress_rule = aws_security_group_rule(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1188	                    type="ingress",
1189	                    security_group_id=requester.get("api_security_group_id"),
1190	                    cidr_blocks=[accepter["cidr_block"]],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1197	
1198	            if accepter.get("api_security_group_id"):
1199	                self.add_resource(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1204	                        type="ingress",
1205	                        security_group_id=accepter.get("api_security_group_id"),
1206	                        cidr_blocks=[requester["cidr_block"]],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1234	            # add routes to existing route tables
1235	            route_table_ids = accepter.get("route_table_ids")
1236	            if route_table_ids:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1587	    ) -> bool:
1588	        e = provider_exclusions.get(spec.provider)
1589	        if not e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1598	        filtered_specs = [
1599	            spec for spec in specs if not spec.resource.get("managed_by_erv2")
1600	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1612	            item["provider"]: Exclusion(
1613	                all=item.get("excludeAllProvisioners") or False,
1614	                provisioners={

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1614	                provisioners={
1615	                    p["name"] for p in (item.get("excludeProvisioners") or [])
1616	                },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1657	                raise OutputResourceNameNotUniqueException(
1658	                    namespace_info.get("name"), duplicates
1659	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1747	
1748	        if not values.get("apply_immediately"):
1749	            values["apply_immediately"] = False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1752	        # rds instance
1753	        if values.get("multi_az"):
1754	            az = values.pop("availability_zone", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1755	        else:
1756	            az = values.get("availability_zone", None)
1757	        provider = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1773	        def validate_parameter_group(parameter_group: aws_db_parameter_group) -> None:
1774	            parameter_group_name = parameter_group.get("name")
1775	            for parameter in parameter_group.get("parameter", []):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1774	            parameter_group_name = parameter_group.get("name")
1775	            for parameter in parameter_group.get("parameter", []):
1776	                if parameter.get("name") == "rds.logical_replication":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1776
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1775	            for parameter in parameter_group.get("parameter", []):
1776	                if parameter.get("name") == "rds.logical_replication":
1777	                    apply_method = parameter.get("apply_method")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1776	                if parameter.get("name") == "rds.logical_replication":
1777	                    apply_method = parameter.get("apply_method")
1778	                    if apply_method != "pending-reboot":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1789	            # for multiple RDS instances.
1790	            pg_name = pg_values.get("name", values["identifier"] + "-pg")
1791	            pg_identifier = pg_values.pop("identifier", None) or pg_name

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1810	            # Associate parameter group to db instance
1811	            values["parameter_group_name"] = pg_tf_resource.get("name")
1812	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1823	
1824	            if old_pg_tf_resource.get("name") == pg_tf_resource.get("name"):
1825	                raise ValueError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1823	
1824	            if old_pg_tf_resource.get("name") == pg_tf_resource.get("name"):
1825	                raise ValueError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1835	        # is true
1836	        if not enhanced_monitoring and values.get("monitoring_interval", None):
1837	            values.pop("monitoring_interval")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1840	            # Set monitoring interval to 60s if it is not set.
1841	            values["monitoring_interval"] = values.get("monitoring_interval", 60)
1842	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1899	            output_name = output_prefix + "__db_ca_cert"
1900	            output_value = self.secret_reader.read(ca_cert)
1901	            tf_resources.append(Output(output_name, value=output_value, sensitive=True))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1902	
1903	        region = self._region_from_availability_zone(az) or self.default_regions.get(
1904	            account
1905	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1916	                deps.append("aws_db_instance." + source_info.identifier)
1917	                replica_az = source_info.resource.get("availability_zone", None)
1918	                if replica_az and len(replica_az) > 1:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1920	                else:
1921	                    replica_region = self.default_regions.get(account)
1922	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1945	                    # storage_encrypted is ignored for cross-region replicas
1946	                    encrypt = values.get("storage_encrypted", None)
1947	                    if encrypt and "kms_key_id" not in values:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:1960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1959	                # Source RDS must have these parameters set
1960	                source_brp = source_values.get("backup_retention_period", 0)
1961	                if source_brp <= 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2024	                e_n["source_ids"] = [identifier]
2025	                source_type = e_n.get("source_type", "all")
2026	                e_n_identifier = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2093	    def _get_db_name_from_values(self, values: dict) -> str:
2094	        return values.get("name") or values.get("db_name") or ""
2095	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2093	    def _get_db_name_from_values(self, values: dict) -> str:
2094	        return values.get("name") or values.get("db_name") or ""
2095	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2109	            "replicate_source_db" not in config
2110	            and config.get("replica_source", None) is None
2111	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2140	        values["bucket"] = identifier
2141	        versioning = common_values.get("versioning", True)
2142	        values["versioning"] = {"enabled": versioning}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2152	        server_side_encryption_configuration = (
2153	            common_values.get("server_side_encryption_configuration")
2154	            or DEFAULT_S3_SSE_CONFIGURATION

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2159	        # Support static website hosting [rosa-authenticator]
2160	        website = common_values.get("website")
2161	        if website:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2162	            values["website"] = website
2163	        request_payer = common_values.get("request_payer")
2164	        if request_payer:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2165	            values["request_payer"] = request_payer
2166	        lifecycle_rules = common_values.get("lifecycle_rules")
2167	        if lifecycle_rules:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2170	        if versioning:
2171	            lrs = values.get("lifecycle_rule", [])
2172	            expiration_rule = False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2188	                    lrs = rule
2189	        sc = common_values.get("storage_class")
2190	        if sc:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2202	            }
2203	            if values.get("lifecycle_rule"):
2204	                values["lifecycle_rule"].append(rule)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2206	                values["lifecycle_rule"] = rule
2207	        cors_rules = common_values.get("cors_rules")
2208	        if cors_rules:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2211	        # S3 Bucket Logging
2212	        s3_bucket_logging = common_values.get("s3_bucket_logging")
2213	        if s3_bucket_logging:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2213	        if s3_bucket_logging:
2214	            target_bucket_name = s3_bucket_logging.get("target_bucket_name")
2215	            logging_identifier = f"{identifier}-logging"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2225	                "target_bucket": "${aws_s3_bucket." + target_bucket_name + ".id}",
2226	                "target_prefix": s3_bucket_logging.get("target_prefix", ""),
2227	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2232	        deps = []
2233	        replication_configs = common_values.get("replication_configurations")
2234	        if replication_configs:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2314	                status = config["status"]
2315	                sc = config.get("storage_class") or "standard"
2316	                rc_values.clear()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2331	            values["depends_on"] = self.get_dependencies(deps)
2332	        region = common_values.get("region") or self.default_regions.get(account)
2333	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2331	            values["depends_on"] = self.get_dependencies(deps)
2332	        region = common_values.get("region") or self.default_regions.get(account)
2333	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2345	
2346	        sqs_identifier = common_values.get("sqs_identifier", None)
2347	        if sqs_identifier is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2348	            sqs_values = {"name": sqs_identifier}
2349	            sqs_provider = values.get("provider")
2350	            if sqs_provider:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2354	
2355	            s3_events = common_values.get("s3_events", ["s3:ObjectCreated:*"])
2356	            notification_values = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2365	            }
2366	            filter_prefix = common_values.get("filter_prefix", None)
2367	            if filter_prefix is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2368	                notification_values["queue"][0]["filter_prefix"] = filter_prefix
2369	            filter_suffix = common_values.get("filter_suffix", None)
2370	            if filter_suffix is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2377	
2378	        event_notifications = common_values.get("event_notifications")
2379	        sns_notifications = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2400	                    resource_values = {"name": resource_name}
2401	                    resource_provider = values.get("provider")
2402	                    if resource_provider:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2426	
2427	                filter_prefix = event_notification.get("filter_prefix", None)
2428	                if filter_prefix is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2429	                    notification_config["filter_prefix"] = filter_prefix
2430	                filter_suffix = event_notification.get("filter_suffix", None)
2431	                if filter_suffix is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2449	
2450	        bucket_policy = common_values.get("bucket_policy")
2451	        if bucket_policy:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2483	        action = ["s3:*Object*"]
2484	        if common_values.get("acl", "private") == "public-read":
2485	            action.append("s3:PutObjectAcl")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2485	            action.append("s3:PutObjectAcl")
2486	        allow_object_tagging = common_values.get("allow_object_tagging", False)
2487	        if allow_object_tagging:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2535	
2536	        default_region = self.default_regions.get(account)
2537	        desired_region = values.pop("region", default_region)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2543	
2544	        if not values.get("apply_immediately"):
2545	            values["apply_immediately"] = False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2546	
2547	        parameter_group = values.get("parameter_group")
2548	        # Assume that cluster enabled is false if parameter group unset

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2580	
2581	        if values.get("transit_encryption_enabled", False):
2582	            values["auth_token"] = auth_token

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2605	        # db.auth_token
2606	        if values.get("transit_encryption_enabled", False):
2607	            output_name = output_prefix + "__db_auth_token"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2634	        # iam user policies
2635	        for policy in common_values.get("policies") or []:
2636	            tf_iam_user_policy_attachment = aws_iam_user_policy_attachment(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2643	
2644	        user_policy = common_values.get("user_policy")
2645	        if user_policy:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2645	        if user_policy:
2646	            variables = common_values.get("variables")
2647	            # variables are replaced in the user_policy

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2673	        aws_infrastructure_access = (
2674	            common_values.get("aws_infrastructure_access") or None
2675	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2681	            # OCM AWS infrastructure access.
2682	            assume_role = aws_infrastructure_access.get("assume_role")
2683	            if assume_role:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2687	                cluster = aws_infrastructure_access["cluster"]["name"]
2688	                ocm = ocm_map.get(cluster)
2689	                role_grants = ocm.get_aws_infrastructure_access_role_grants(cluster)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2759	        assume_role = {k: v for k, v in assume_role.items() if v is not None}
2760	        assume_action = common_values.get("assume_action") or "AssumeRole"
2761	        # assume role policy

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2771	        }
2772	        assume_condition = json.loads(common_values.get("assume_condition") or "{}")
2773	        if assume_condition:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2782	
2783	        inline_policy = common_values.get("inline_policy")
2784	        if inline_policy:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2789	
2790	        if max_session_duration := common_values.get("max_session_duration"):
2791	            values["max_session_duration"] = max_session_duration

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2796
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2795	
2796	        if role_policy := common_values.get("role_policy"):
2797	            tf_aws_iam_policy = aws_iam_policy(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2813	
2814	        for policy in common_values.get("policies") or []:
2815	            tf_iam_role_policy_attachment = aws_iam_role_policy_attachment(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2864	                        "StringEquals": {
2865	                            "SAML:aud": "https://signin.aws.amazon.com/saml"
2866	                        }
2867	                    },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2884	        output_prefix = spec.output_prefix
2885	        uid = self.uids.get(account)
2886	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2888	        self.init_common_outputs(tf_resources, spec)
2889	        region = common_values.get("region") or self.default_regions.get(account)
2890	        specs = common_values.get("specs")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2888	        self.init_common_outputs(tf_resources, spec)
2889	        region = common_values.get("region") or self.default_regions.get(account)
2890	        specs = common_values.get("specs")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2889	        region = common_values.get("region") or self.default_regions.get(account)
2890	        specs = common_values.get("specs")
2891	        all_queues_per_spec = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2908	                values.update(defaults)
2909	                fifo_queue = values.get("fifo_queue", False)
2910	                if fifo_queue:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:2955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2954	                output_name = f"{output_prefix}__{queue_key}"
2955	                output_value = f"https://sqs.{region}.amazonaws.com/{uid}/{queue_name}"
2956	                tf_resources.append(Output(output_name, value=output_value))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3024	        output_prefix = spec.output_prefix
3025	        policy = common_values.get("inline_policy")
3026	        region = common_values.get("region") or self.default_regions.get(account)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3025	        policy = common_values.get("inline_policy")
3026	        region = common_values.get("region") or self.default_regions.get(account)
3027	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3025	        policy = common_values.get("inline_policy")
3026	        region = common_values.get("region") or self.default_regions.get(account)
3027	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3028	        values = {}
3029	        fifo_topic = common_values.get("fifo_topic", False)
3030	        topic_name = identifier + ".fifo" if fifo_topic else identifier

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3041	        if "subscriptions" in common_values:
3042	            subscriptions = common_values.get("subscriptions")
3043	            for index, sub in enumerate(subscriptions):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3065	        output_name = output_prefix + "__endpoint"
3066	        output_value = f"https://sns.{region}.amazonaws.com"
3067	        tf_resources.append(Output(output_name, value=output_value))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3075
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3074	        output_prefix = spec.output_prefix
3075	        uid = self.uids.get(account)
3076	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3078	        self.init_common_outputs(tf_resources, spec)
3079	        region = common_values.get("region") or self.default_regions.get(account)
3080	        specs = common_values.get("specs")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3078	        self.init_common_outputs(tf_resources, spec)
3079	        region = common_values.get("region") or self.default_regions.get(account)
3080	        specs = common_values.get("specs")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3079	        region = common_values.get("region") or self.default_regions.get(account)
3080	        specs = common_values.get("specs")
3081	        all_tables = []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3108	        output_name = output_prefix + "__endpoint"
3109	        output_value = f"https://dynamodb.{region}.amazonaws.com"
3110	        tf_resources.append(Output(output_name, value=output_value))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3174	
3175	        region = common_values.get("region") or self.default_regions.get(account)
3176	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3174	
3175	        region = common_values.get("region") or self.default_regions.get(account)
3176	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3178	        ecr_tf_resource = aws_ecr_repository(identifier, **values)
3179	        public = common_values.get("public")
3180	        if public:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3296	                        f"arn:aws:s3:::{identifier}/{enable_dir}/*"
3297	                        for enable_dir in common_values.get(
3298	                            "get_object_enable_dirs", []
3299	                        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3305	        values["depends_on"] = self.get_dependencies([bucket_tf_resource])
3306	        region = common_values.get("region") or self.default_regions.get(account)
3307	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3305	        values["depends_on"] = self.get_dependencies([bucket_tf_resource])
3306	        region = common_values.get("region") or self.default_regions.get(account)
3307	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3311	
3312	        values = common_values.get("distribution_config", {})
3313	        # aws_s3_bucket_acl

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3355	            acl_values["access_control_policy"] = access_control_policy
3356	            acl_values["bucket"] = logging_config_bucket.get("bucket").split(".")[0]
3357	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3406	        output_prefix = spec.output_prefix
3407	        uid = self.uids.get(account)
3408	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3410	
3411	        region = common_values.get("region") or self.default_regions.get(account)
3412	        provider = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3410	
3411	        region = common_values.get("region") or self.default_regions.get(account)
3412	        provider = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3419	        sqs_values["visibility_timeout_seconds"] = int(
3420	            common_values.get("visibility_timeout_seconds", 30)
3421	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3422	        sqs_values["message_retention_seconds"] = int(
3423	            common_values.get("message_retention_seconds", 345600)
3424	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3445	
3446	        kms_encryption = common_values.get("kms_encryption", False)
3447	        if kms_encryption:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3452	            kms_values["key_usage"] = str(
3453	                common_values.get("key_usage", "ENCRYPT_DECRYPT")
3454	            ).upper()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3455	            kms_values["customer_master_key_spec"] = str(
3456	                common_values.get("customer_master_key_spec", "SYMMETRIC_DEFAULT")
3457	            ).upper()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3457	            ).upper()
3458	            kms_values["is_enabled"] = common_values.get("is_enabled", True)
3459	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3504	
3505	        s3_events = common_values.get("s3_events", ["s3:ObjectCreated:*"])
3506	        notification_values = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3516	
3517	        filter_prefix = common_values.get("filter_prefix", None)
3518	        if filter_prefix is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3519	            notification_values["queue"][0]["filter_prefix"] = filter_prefix
3520	        filter_suffix = common_values.get("filter_suffix", None)
3521	        if filter_suffix is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3597	        output_name = f"{output_prefix}__{sqs_identifier}"
3598	        output_value = f"https://sqs.{region}.amazonaws.com/{uid}/{sqs_identifier}"
3599	        tf_resources.append(Output(output_name, value=output_value))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3623	
3624	        region = common_values.get("region") or self.default_regions.get(account)
3625	        provider = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3623	
3624	        region = common_values.get("region") or self.default_regions.get(account)
3625	        provider = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3631	
3632	        es_identifier = common_values.get("es_identifier", None)
3633	        if es_identifier is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3691	
3692	            release_url = common_values.get("release_url", LOGTOES_RELEASE)
3693	            zip_file = self.get_logtoes_zip(release_url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3702	            lambda_values["function_name"] = lambda_identifier
3703	            lambda_values["runtime"] = common_values.get("runtime", "nodejs18.x")
3704	            lambda_values["timeout"] = common_values.get("timeout", 30)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3703	            lambda_values["runtime"] = common_values.get("runtime", "nodejs18.x")
3704	            lambda_values["timeout"] = common_values.get("timeout", 30)
3705	            lambda_values["handler"] = common_values.get("handler", "index.handler")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3704	            lambda_values["timeout"] = common_values.get("timeout", 30)
3705	            lambda_values["handler"] = common_values.get("handler", "index.handler")
3706	            lambda_values["memory_size"] = common_values.get("memory_size", 128)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3706
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3705	            lambda_values["handler"] = common_values.get("handler", "index.handler")
3706	            lambda_values["memory_size"] = common_values.get("memory_size", 128)
3707	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3752	
3753	            filter_pattern = common_values.get("filter_pattern", None)
3754	            if filter_pattern is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3849	                values[key] = values[key].upper()
3850	        region = values.pop("region", None) or self.default_regions.get(account)
3851	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3885	        }
3886	        kinesis_values["shard_count"] = common_values.get("shard_count")
3887	        kinesis_values["retention_period"] = common_values.get("retention_period", 24)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3886	        kinesis_values["shard_count"] = common_values.get("shard_count")
3887	        kinesis_values["retention_period"] = common_values.get("retention_period", 24)
3888	        kinesis_values["encryption_type"] = common_values.get("encryption_type", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3887	        kinesis_values["retention_period"] = common_values.get("retention_period", 24)
3888	        kinesis_values["encryption_type"] = common_values.get("encryption_type", None)
3889	        if kinesis_values["encryption_type"] == "KMS":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3889	        if kinesis_values["encryption_type"] == "KMS":
3890	            kinesis_values["kms_key_id"] = common_values.get("kms_key_id")
3891	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3892	        # get region and set provider if required
3893	        region = common_values.get("region") or self.default_regions.get(account)
3894	        provider = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3892	        # get region and set provider if required
3893	        region = common_values.get("region") or self.default_regions.get(account)
3894	        provider = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:3904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3903	
3904	        es_identifier = common_values.get("es_identifier", None)
3905	        if es_identifier:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4001	
4002	            release_url = common_values.get("release_url", KINESIS_TO_OS_RELEASE)
4003	            zip_file = self.get_lambda_zip(release_url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4014
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4013	            lambda_values["function_name"] = lambda_identifier
4014	            lambda_values["runtime"] = common_values.get("runtime", "python3.9")
4015	            lambda_values["timeout"] = common_values.get("timeout", 30)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4014	            lambda_values["runtime"] = common_values.get("runtime", "python3.9")
4015	            lambda_values["timeout"] = common_values.get("timeout", 30)
4016	            lambda_values["handler"] = common_values.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4015	            lambda_values["timeout"] = common_values.get("timeout", 30)
4016	            lambda_values["handler"] = common_values.get(
4017	                "handler", "lambda_function.handler"
4018	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4019
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4018	            )
4019	            lambda_values["memory_size"] = common_values.get("memory_size", 128)
4020	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4029	
4030	            index_prefix = common_values.get("index_prefix", f"{identifier}-")
4031	            lambda_values["environment"] = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4052
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4051	            }
4052	            starting_position = common_values.get("starting_position", "LATEST")
4053	            source_vaules["starting_position"] = starting_position

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4055
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4054	            if starting_position == "AT_TIMESTAMP":
4055	                starting_position_timestamp = common_values.get(
4056	                    "starting_position_timestamp", None
4057	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4063
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4062	
4063	            batch_size = common_values.get("batch_size", 100)
4064	            source_vaules["batch_size"] = batch_size

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4065	
4066	            parallelization_factor = common_values.get("parallelization_factor", 1)
4067	            source_vaules["parallelization_factor"] = parallelization_factor

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4138	
4139	        retention_in_days = values.get("retention_in_days") or default_retention_in_days
4140	        if retention_in_days not in allowed_retention_in_days:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4265	                with open(print_to_file, "a", encoding="locale") as f:
4266	                    f.write(f"##### {name} #####\n")
4267	                    f.write(content)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4265	                with open(print_to_file, "a", encoding="locale") as f:
4266	                    f.write(f"##### {name} #####\n")
4267	                    f.write(content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4266	                    f.write(f"##### {name} #####\n")
4267	                    f.write(content)
4268	                    f.write("\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4266	                    f.write(f"##### {name} #####\n")
4267	                    f.write(content)
4268	                    f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4267	                    f.write(content)
4268	                    f.write("\n")
4269	            if existing_dirs is None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4267	                    f.write(content)
4268	                    f.write("\n")
4269	            if existing_dirs is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4273	            with open(wd + "/config.tf.json", "w", encoding="locale") as f:
4274	                f.write(content)
4275	            working_dirs[name] = wd

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4273	            with open(wd + "/config.tf.json", "w", encoding="locale") as f:
4274	                f.write(content)
4275	            working_dirs[name] = wd

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4298	        resource = spec.resource
4299	        defaults_path = resource.get("defaults", None)
4300	        overrides = resource.get("overrides", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4299	        defaults_path = resource.get("defaults", None)
4300	        overrides = resource.get("overrides", None)
4301	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4309	        for key in VARIABLE_KEYS:
4310	            val = resource.get(key, None)
4311	            # checking explicitly for not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4315	
4316	        if self.versions and not self.versions.get(
4317	            spec.provisioner_name, ""
4318	        ).startswith("3"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4321	                    values["db_name"] = db_name
4322	                if values.get("replica_source"):
4323	                    values.pop("db_name", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4333	            elif spec.provider == "msk":
4334	                if ebs_volume_size := values.get("broker_node_group_info", {}).pop(
4335	                    "ebs_volume_size", None

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
4402	            anno_json = json.dumps(spec.annotations()).encode("utf-8")
4403	            output_value = base64.b64encode(anno_json).decode()
4404	            tf_resources.append(Output(output_name, value=output_value))

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4403
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
4402	            anno_json = json.dumps(spec.annotations()).encode("utf-8")
4403	            output_value = base64.b64encode(anno_json).decode()
4404	            tf_resources.append(Output(output_name, value=output_value))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4479	            log_types = res["publish_log_types"] or []
4480	            region = res.get("region") or self.default_regions.get(account)
4481	            for log_type in log_types:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4479	            log_types = res["publish_log_types"] or []
4480	            region = res.get("region") or self.default_regions.get(account)
4481	            for log_type in log_types:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4589	            }
4590	            region = values.get("region") or self.default_regions.get(account)
4591	            if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4589	            }
4590	            region = values.get("region") or self.default_regions.get(account)
4591	            if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4626	
4627	        admin_user_arn = auth_options.get("admin_user_arn", "")
4628	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4686	        es_values["tags"] = tags
4687	        es_values["elasticsearch_version"] = values.get("elasticsearch_version")
4688	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4707	        es_values["log_publishing_options"] = publishing_options
4708	        ebs_options = values.get("ebs_options", {})
4709	        ebs_values = {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4710	        if ebs_options:
4711	            ebs_enabled = ebs_options.get("ebs_enabled", True)
4712	            ebs_values["ebs_enabled"] = ebs_enabled

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4713	            if ebs_enabled:
4714	                volume_size = ebs_options.get("volume_size", None)
4715	                if volume_size is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4720	                ebs_values["volume_size"] = volume_size
4721	                volume_type = ebs_options.get("volume_type", "gp2")
4722	                ebs_values["volume_type"] = volume_type

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4722	                ebs_values["volume_type"] = volume_type
4723	                iops = ebs_options.get("iops", 0)
4724	                ebs_values["iops"] = iops

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4728	        es_values["encrypt_at_rest"] = {
4729	            "enabled": values.get("encrypt_at_rest", {}).get("enabled", True)
4730	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4728	        es_values["encrypt_at_rest"] = {
4729	            "enabled": values.get("encrypt_at_rest", {}).get("enabled", True)
4730	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4731	
4732	        node_to_node_encryption = values.get("node_to_node_encryption", {})
4733	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4734	        es_values["node_to_node_encryption"] = {
4735	            "enabled": node_to_node_encryption.get("enabled", True)
4736	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4737	
4738	        domain_endpoint_options = values.get("domain_endpoint_options", {})
4739	        tls_security_policy = domain_endpoint_options.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4738	        domain_endpoint_options = values.get("domain_endpoint_options", {})
4739	        tls_security_policy = domain_endpoint_options.get(
4740	            "tls_security_policy", "Policy-Min-TLS-1-0-2019-07"
4741	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4741	        )
4742	        enforce_https = domain_endpoint_options.get("enforce_https", True)
4743	        es_values["domain_endpoint_options"] = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4747	
4748	        cluster_config = values.get("cluster_config", {})
4749	        dedicated_master_enabled = cluster_config.get("dedicated_master_enabled", True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4748	        cluster_config = values.get("cluster_config", {})
4749	        dedicated_master_enabled = cluster_config.get("dedicated_master_enabled", True)
4750	        dedicated_master_type = cluster_config.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4749	        dedicated_master_enabled = cluster_config.get("dedicated_master_enabled", True)
4750	        dedicated_master_type = cluster_config.get(
4751	            "dedicated_master_type", "t2.small.elasticsearch"
4752	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4752	        )
4753	        dedicated_master_count = cluster_config.get("dedicated_master_count", 3)
4754	        zone_awareness_enabled = cluster_config.get("zone_awareness_enabled", True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4754
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4753	        dedicated_master_count = cluster_config.get("dedicated_master_count", 3)
4754	        zone_awareness_enabled = cluster_config.get("zone_awareness_enabled", True)
4755	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4756	        cluster_vaules = {
4757	            "instance_type": cluster_config.get(
4758	                "instance_type", "t2.small.elasticsearch"
4759	            ),
4760	            "instance_count": cluster_config.get("instance_count", 3),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4759	            ),
4760	            "instance_count": cluster_config.get("instance_count", 3),
4761	            "zone_awareness_enabled": zone_awareness_enabled,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4769	        if zone_awareness_enabled:
4770	            zone_awareness_config = cluster_config.get("zone_awareness_config", {})
4771	            availability_zone_count = zone_awareness_config.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4770	            zone_awareness_config = cluster_config.get("zone_awareness_config", {})
4771	            availability_zone_count = zone_awareness_config.get(
4772	                "availability_zone_count", 3
4773	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4778
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4777	
4778	        warm_enabled = cluster_config.get("warm_enabled", False)
4779	        if warm_enabled:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4780	            cluster_vaules["warm_enabled"] = warm_enabled
4781	            cluster_vaules["warm_type"] = cluster_config.get(
4782	                "warm_type", "ultrawarm1.medium.elasticsearch"
4783	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4783	            )
4784	            cluster_vaules["warm_count"] = cluster_config.get("warm_count", 2)
4785	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4785	
4786	        cold_storage_options = cluster_config.get("cold_storage_options", {})
4787	        if cold_storage_options.get("enabled", False):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4786	        cold_storage_options = cluster_config.get("cold_storage_options", {})
4787	        if cold_storage_options.get("enabled", False):
4788	            if not dedicated_master_enabled:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4805	
4806	        snapshot_options = values.get("snapshot_options", {})
4807	        automated_snapshot_start_hour = snapshot_options.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4806	        snapshot_options = values.get("snapshot_options", {})
4807	        automated_snapshot_start_hour = snapshot_options.get(
4808	            "automated_snapshot_start_hour", 23
4809	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4814	
4815	        vpc_options = values.get("vpc_options", {})
4816	        security_group_ids = vpc_options.get("security_group_ids", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4815	        vpc_options = values.get("vpc_options", {})
4816	        security_group_ids = vpc_options.get("security_group_ids", None)
4817	        subnet_ids = vpc_options.get("subnet_ids", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4817
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4816	        security_group_ids = vpc_options.get("security_group_ids", None)
4817	        subnet_ids = vpc_options.get("subnet_ids", None)
4818	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4843	
4844	        advanced_options = values.get("advanced_options", None)
4845	        if advanced_options is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4871	
4872	        region = values.get("region") or self.default_regions.get(account)
4873	        provider = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4871	
4872	        region = values.get("region") or self.default_regions.get(account)
4873	        provider = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4877	
4878	        auth_options = values.get("auth", {})
4879	        # TODO: @fishi0x01 make mandatory after migration APPSRE-3409

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4887	        else:
4888	            advanced_security_options = values.get("advanced_security_options", {})
4889	            if advanced_security_options:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4927	        # add master user creds to output and secretsmanager if internal_user_database_enabled
4928	        security_options = es_values.get("advanced_security_options")
4929	        if security_options and security_options.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:4929
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4928	        security_options = es_values.get("advanced_security_options")
4929	        if security_options and security_options.get(
4930	            "internal_user_database_enabled", False
4931	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5024	        values = {}
5025	        secret = common_values.get("secret", None)
5026	        if secret is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5028	
5029	            key = secret_data.get("key", None)
5030	            if key is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5036
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5035	
5036	            certificate = secret_data.get("certificate", None)
5037	            if certificate is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5043
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5042	
5043	            caCertificate = secret_data.get("caCertificate", None)
5044	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5049	
5050	        domain = common_values.get("domain", None)
5051	        if domain is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5055
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5054	
5055	            alt_names = domain.get("alternate_names", None)
5056	            if alt_names is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5059
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5058	
5059	        region = common_values.get("region") or self.default_regions.get(account)
5060	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5059
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5058	
5059	        region = common_values.get("region") or self.default_regions.get(account)
5060	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5110	        values = {"name": identifier, "comment": "managed by app-interface"}
5111	        secret = common_values.get("secret", None)
5112	        if secret is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5119	        secret_key = "cloudfront_public_key"
5120	        key = secret_data.get(secret_key, None)
5121	        if key is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5152	        cluster = namespace_info["cluster"]
5153	        ocm = ocm_map.get(cluster["name"])
5154	        account["assume_role"] = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5177	        condition_type = condition["type"]
5178	        condition_type_key = SUPPORTED_ALB_LISTENER_RULE_CONDITION_TYPE_MAPPING.get(
5179	            condition_type
5180	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5203	
5204	        default_region = self.default_regions.get(account)
5205	        cluster_region = namespace_info["cluster"]["spec"]["region"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5279	            "internal": False,
5280	            "ip_address_type": resource.get("ip_address_type", "ipv4"),
5281	            "load_balancer_type": "application",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5287	
5288	        idle_timeout = resource.get("idle_timeout")
5289	        if idle_timeout:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5291	
5292	        enable_http2 = resource.get("enable_http2")
5293	        if enable_http2 is False:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5295	
5296	        if resource.get("access_logs"):
5297	            # https://www.terraform.io/docs/providers/aws/r/lb.html#access_logs

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5310	            region = str(
5311	                common_values.get("region") or self.default_regions.get(account)
5312	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5310	            region = str(
5311	                common_values.get("region") or self.default_regions.get(account)
5312	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5350	            target_name = t["name"]
5351	            t_openshift_service = t.get("openshift_service")
5352	            t_ips = t.get("ips")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5351	            t_openshift_service = t.get("openshift_service")
5352	            t_ips = t.get("ips")
5353	            t_protocol = t.get("protocol") or "HTTPS"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5352	            t_ips = t.get("ips")
5353	            t_protocol = t.get("protocol") or "HTTPS"
5354	            t_protocol_version = t.get("protocol_version") or "HTTP1"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5353	            t_protocol = t.get("protocol") or "HTTPS"
5354	            t_protocol_version = t.get("protocol_version") or "HTTP1"
5355	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5385	            health_check_port = 443
5386	            if health_check := t.get("health_check"):
5387	                health_check_interval = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5387	                health_check_interval = (
5388	                    health_check.get("interval") or health_check_interval
5389	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5390	                health_check_timeout = (
5391	                    health_check.get("timeout") or health_check_timeout
5392	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5393	                health_check_unhealthy_threshold = (
5394	                    health_check.get("unhealthy_threshold")
5395	                    or health_check_unhealthy_threshold

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5397	                health_check_healthy_threshold = (
5398	                    health_check.get("healthy_threshold")
5399	                    or health_check_healthy_threshold

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5400	                )
5401	                health_check_path = health_check.get("path") or health_check_path
5402	                health_check_port = health_check.get("port") or health_check_port

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5401	                health_check_path = health_check.get("path") or health_check_path
5402	                health_check_port = health_check.get("port") or health_check_port
5403	                health_check_protocol = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5403	                health_check_protocol = (
5404	                    health_check.get("protocol") or health_check_protocol
5405	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5481	            raise KeyError("expected a single default target")
5482	        ssl_policy = resource.get("ssl_policy") or "ELBSecurityPolicy-TLS13-1-0-2021-06"
5483	        values = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5504	            action_values = {}
5505	            action_type = action.get("type")
5506	            if action_type == "forward":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5518	                weight_sum = 0
5519	                for a in action.get("forward", {}).get("target_group", []):
5520	                    target_name = a["target"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5518	                weight_sum = 0
5519	                for a in action.get("forward", {}).get("target_group", []):
5520	                    target_name = a["target"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5535	            elif action_type == "fixed-response":
5536	                fr_data = action.get("fixed_response", {})
5537	                action_values = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5539	                    "fixed_response": {
5540	                        "content_type": fr_data.get("content_type"),
5541	                        "message_body": fr_data.get("message_body"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5540	                        "content_type": fr_data.get("content_type"),
5541	                        "message_body": fr_data.get("message_body"),
5542	                        "status_code": fr_data.get("status_code"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5541	                        "message_body": fr_data.get("message_body"),
5542	                        "status_code": fr_data.get("status_code"),
5543	                    },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5545	            elif action_type == "redirect":
5546	                redirect_data = action.get("redirect", {})
5547	                action_values = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5549	                    "redirect": {
5550	                        "host": redirect_data.get("host"),
5551	                        "path": redirect_data.get("path"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5550	                        "host": redirect_data.get("host"),
5551	                        "path": redirect_data.get("path"),
5552	                        "port": redirect_data.get("port"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5551	                        "path": redirect_data.get("path"),
5552	                        "port": redirect_data.get("port"),
5553	                        "protocol": redirect_data.get("protocol"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5552	                        "port": redirect_data.get("port"),
5553	                        "protocol": redirect_data.get("protocol"),
5554	                        "query": redirect_data.get("query"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5553	                        "protocol": redirect_data.get("protocol"),
5554	                        "query": redirect_data.get("query"),
5555	                        "status_code": redirect_data.get("status_code"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5554	                        "query": redirect_data.get("query"),
5555	                        "status_code": redirect_data.get("status_code"),
5556	                    },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5567	                    self._get_alb_rule_condition_value(c)
5568	                    for c in rule.get("condition", [])
5569	                ],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5600	
5601	        region = common_values.get("region") or self.default_regions.get(account)
5602	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5600	
5601	        region = common_values.get("region") or self.default_regions.get(account)
5602	        if self._multiregion_account(account):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5607	
5608	        secret = common_values.get("secret")
5609	        secret_data = self.secret_reader.read_all(secret)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5644	            github = self.init_github()
5645	            repo_name = url.rstrip("/").replace("https://github.com/", "")
5646	            repo = github.get_repo(repo_name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5683	        for f in filters:
5684	            upstream = f.get("upstream")
5685	            if upstream:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5702	        tags["Name"] = identifier
5703	        extra_tags = common_values.get("extra_tags", None)
5704	        if extra_tags:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5707	        region = cast(
5708	            str, common_values.get("region") or self.default_regions.get(account)
5709	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5707	        region = cast(
5708	            str, common_values.get("region") or self.default_regions.get(account)
5709	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5712	            "name": identifier,
5713	            "vpc_security_group_ids": common_values.get("vpc_security_group_ids"),
5714	            "update_default_version": common_values.get("update_default_version"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5713	            "vpc_security_group_ids": common_values.get("vpc_security_group_ids"),
5714	            "update_default_version": common_values.get("update_default_version"),
5715	            "block_device_mappings": common_values.get("block_device_mappings"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5714	            "update_default_version": common_values.get("update_default_version"),
5715	            "block_device_mappings": common_values.get("block_device_mappings"),
5716	            "tags": tags,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5723	        # common_values is untyped, so casting is necessary
5724	        image = cast(list[dict[str, Any]], common_values.get("image"))
5725	        image_id = self.get_asg_image_id(filters=image, account=account, region=region)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5740	
5741	        role_name = common_values.get("iam_role_name")
5742	        if role_name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5749	
5750	        cloudinit_configs = common_values.get("cloudinit_configs")
5751	        if cloudinit_configs:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5752	            vars = {}
5753	            variables = common_values.get("variables")
5754	            if variables:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5756	            vars.update({"aws_region": region})
5757	            vars.update({"aws_account_id": self.uids.get(account)})
5758	            part = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5767	                part.append({
5768	                    "filename": c.get("filename"),
5769	                    "content_type": c.get("content_type"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5768	                    "filename": c.get("filename"),
5769	                    "content_type": c.get("content_type"),
5770	                    "content": content,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5780	            "name": identifier,
5781	            "max_size": common_values.get("max_size"),
5782	            "min_size": common_values.get("min_size"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5781	            "max_size": common_values.get("max_size"),
5782	            "min_size": common_values.get("min_size"),
5783	            "vpc_zone_identifier": common_values.get("vpc_zone_identifier"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5782	            "min_size": common_values.get("min_size"),
5783	            "vpc_zone_identifier": common_values.get("vpc_zone_identifier"),
5784	            "capacity_rebalance": common_values.get("capacity_rebalance"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5783	            "vpc_zone_identifier": common_values.get("vpc_zone_identifier"),
5784	            "capacity_rebalance": common_values.get("capacity_rebalance"),
5785	            "max_instance_lifetime": common_values.get("max_instance_lifetime"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5784	            "capacity_rebalance": common_values.get("capacity_rebalance"),
5785	            "max_instance_lifetime": common_values.get("max_instance_lifetime"),
5786	            "protect_from_scale_in": common_values.get("protect_from_scale_in"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5785	            "max_instance_lifetime": common_values.get("max_instance_lifetime"),
5786	            "protect_from_scale_in": common_values.get("protect_from_scale_in"),
5787	            "enabled_metrics": common_values.get("enabled_metrics"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5786	            "protect_from_scale_in": common_values.get("protect_from_scale_in"),
5787	            "enabled_metrics": common_values.get("enabled_metrics"),
5788	            "mixed_instances_policy": {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5788	            "mixed_instances_policy": {
5789	                "instances_distribution": common_values.get("instances_distribution"),
5790	                "launch_template": {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5798	                "strategy": "Rolling",
5799	                "preferences": common_values.get("instance_refresh_preferences"),
5800	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5803	        override = []
5804	        instance_types = common_values.get("instance_types")
5805	        if instance_types:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5806	            override += [{"instance_type": i} for i in instance_types]
5807	        instance_requirements = common_values.get("instance_requirements")
5808	        if instance_requirements:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5817	        ]
5818	        if self.versions.get(account, "").startswith("3"):
5819	            asg_value["tags"] = tags

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5892
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5891	        # Prepare consts
5892	        region = common_values.get("region") or self.default_regions.get(account)
5893	        bucket_name = common_values.get("cognito_callback_bucket_name")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5892
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5891	        # Prepare consts
5892	        region = common_values.get("region") or self.default_regions.get(account)
5893	        bucket_name = common_values.get("cognito_callback_bucket_name")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5892	        region = common_values.get("region") or self.default_regions.get(account)
5893	        bucket_name = common_values.get("cognito_callback_bucket_name")
5894	        bucket_url = f"https://{bucket_name}.s3.{region}.amazonaws.com"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5899	            lambda_managed_policy_arn = "arn:aws-us-gov:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
5900	        vpc_id = common_values.get("vpc_id")
5901	        subnet_ids = common_values.get("subnet_ids")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5901
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5900	        vpc_id = common_values.get("vpc_id")
5901	        subnet_ids = common_values.get("subnet_ids")
5902	        network_interface_ids = common_values.get("network_interface_ids")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5901	        subnet_ids = common_values.get("subnet_ids")
5902	        network_interface_ids = common_values.get("network_interface_ids")
5903	        certificate_arn = common_values.get("certificate_arn")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5902	        network_interface_ids = common_values.get("network_interface_ids")
5903	        certificate_arn = common_values.get("certificate_arn")
5904	        domain_name = common_values.get("domain_name")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5903	        certificate_arn = common_values.get("certificate_arn")
5904	        domain_name = common_values.get("domain_name")
5905	        openshift_ingress_load_balancer_arn = common_values.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5904	        domain_name = common_values.get("domain_name")
5905	        openshift_ingress_load_balancer_arn = common_values.get(
5906	            "openshift_ingress_load_balancer_arn"
5907	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5908
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5907	        )
5908	        vpce_id = common_values.get("vpce_id")
5909	        insights_callback_urls = common_values.get("insights_callback_urls")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5908	        vpce_id = common_values.get("vpce_id")
5909	        insights_callback_urls = common_values.get("insights_callback_urls")
5910	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:5938
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5937	        # pre-signup lambda
5938	        release_url = common_values.get(
5939	            "release_url", ROSA_AUTHENTICATOR_PRE_SIGNUP_RELEASE
5940	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6001	        # Prepare all resource arguments from default file
6002	        pool_args = common_values.get("user_pool_properties", None)
6003	        pool_client_args = common_values.get("user_pool_client_properties", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6002	        pool_args = common_values.get("user_pool_properties", None)
6003	        pool_client_args = common_values.get("user_pool_client_properties", None)
6004	        cognito_resource_server_args = common_values.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6003	        pool_client_args = common_values.get("user_pool_client_properties", None)
6004	        cognito_resource_server_args = common_values.get(
6005	            "cognito_resource_server_properties", None
6006	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6006	        )
6007	        pool_client_service_account_common_args = common_values.get(
6008	            "pool_client_service_account_common_properties", None
6009	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6010
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6009	        )
6010	        rest_api_args = common_values.get("rest_api_properties", None)
6011	        gateway_authorizer_args = common_values.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6010	        rest_api_args = common_values.get("rest_api_properties", None)
6011	        gateway_authorizer_args = common_values.get(
6012	            "gateway_authorizer_properties", None
6013	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6014
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6013	        )
6014	        gateway_method_proxy_any_args = common_values.get(
6015	            "gateway_method_proxy_any_properties", None
6016	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6017
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6016	        )
6017	        gateway_method_get_args = common_values.get(
6018	            "gateway_method_get_properties", None
6019	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6019	        )
6020	        gateway_method_get_response_args = common_values.get(
6021	            "gateway_method_get_response_properties", None
6022	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6022	        )
6023	        gateway_method_auth_get_response_args = common_values.get(
6024	            "gateway_method_auth_get_response_properties", None
6025	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6025	        )
6026	        integration_proxy_args = common_values.get("integration_proxy_properties", None)
6027	        integration_token_args = common_values.get("integration_token_properties", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6027
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6026	        integration_proxy_args = common_values.get("integration_proxy_properties", None)
6027	        integration_token_args = common_values.get("integration_token_properties", None)
6028	        integration_auth_args = common_values.get("integration_auth_properties", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6027	        integration_token_args = common_values.get("integration_token_properties", None)
6028	        integration_auth_args = common_values.get("integration_auth_properties", None)
6029	        waf_acl_args = common_values.get("waf_acl_properties", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6028	        integration_auth_args = common_values.get("integration_auth_properties", None)
6029	        waf_acl_args = common_values.get("waf_acl_properties", None)
6030	        lb_target_group_args = common_values.get("lb_target_group_properties", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6029	        waf_acl_args = common_values.get("waf_acl_properties", None)
6030	        lb_target_group_args = common_values.get("lb_target_group_properties", None)
6031	        lb_args = common_values.get("lb_properties", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6031
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6030	        lb_target_group_args = common_values.get("lb_target_group_properties", None)
6031	        lb_args = common_values.get("lb_properties", None)
6032	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6419	            connection_id=f"${{{api_gateway_vpc_link_resource.id}}}",
6420	            uri=f"{common_values.get('api_proxy_uri')}/api/{{proxy}}",
6421	            **integration_proxy_args,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6704	
6705	        vpc_id = common_values.get("vpc_id")
6706	        subnet_ids = common_values.get("subnet_ids")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6706
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6705	        vpc_id = common_values.get("vpc_id")
6706	        subnet_ids = common_values.get("subnet_ids")
6707	        vpce_security_group_rule_common_args = common_values.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6706	        subnet_ids = common_values.get("subnet_ids")
6707	        vpce_security_group_rule_common_args = common_values.get(
6708	            "vpce_security_group_rule_common_properties", None
6709	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6709	        )
6710	        vpc_endpoint_args = common_values.get("vpc_endpoint_properties", None)
6711	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6788	        scram_enabled = (
6789	            values.get("client_authentication", {}).get("sasl", {}).get("scram", False)
6790	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6788	        scram_enabled = (
6789	            values.get("client_authentication", {}).get("sasl", {}).get("scram", False)
6790	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6788	        scram_enabled = (
6789	            values.get("client_authentication", {}).get("sasl", {}).get("scram", False)
6790	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6792	        if scram_enabled:
6793	            if not spec.resource.get("users", []):
6794	                raise ValueError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6836	        if (
6837	            values.get("logging_info", {})
6838	            .get("broker_logs", {})
6839	            .get("cloudwatch_logs", {})
6840	            .get("enabled", False)
6841	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6836	        if (
6837	            values.get("logging_info", {})
6838	            .get("broker_logs", {})
6839	            .get("cloudwatch_logs", {})
6840	            .get("enabled", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6836	        if (
6837	            values.get("logging_info", {})
6838	            .get("broker_logs", {})
6839	            .get("cloudwatch_logs", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/terrascript_aws_client.py:6837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6836	        if (
6837	            values.get("logging_info", {})
6838	            .get("broker_logs", {})

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/three_way_diff_strategy.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
33	        body["data"] = data | {
34	            k: base64.b64encode(str(v).encode()).decode("utf-8")
35	            for k, v in string_data.items()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/three_way_diff_strategy.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
33	        body["data"] = data | {
34	            k: base64.b64encode(str(v).encode()).decode("utf-8")
35	            for k, v in string_data.items()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/unleash/server.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
98	        """Create a feature toggle."""
99	        self._post(
100	            f"/api/admin/projects/{project_id}/features",
101	            data={
102	                "name": name,
103	                "description": description,
104	                "type": type.value,
105	                "impressionData": impression_data,
106	            },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/unleash/server.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
131	        # Then delete it
132	        self._post(
133	            f"/api/admin/projects/{project_id}/delete",
134	            data={"features": [name]},
135	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/unleash/server.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
142	        if enabled:
143	            self._post(f"{base_url}/on")
144	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/unleash/server.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
144	        else:
145	            self._post(f"{base_url}/off")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	            )
89	            self.kube_sa_token_path = os.environ.get(
90	                "KUBE_SA_TOKEN_PATH",
91	                "/var/run/secrets/kubernetes.io/serviceaccount/token",
92	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
121	        if auto_refresh:
122	            t = threading.Thread(target=self._auto_refresh_client_auth, daemon=True)
123	            t.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
159	                        role=self.kube_auth_role,
160	                        jwt=f.read(),
161	                        mount_point=self.kube_auth_mount,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	        secret_path = secret["path"]
179	        secret_version = secret.get("version")
180	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
252	        try:
253	            secret = self._client.read(path)
254	        except hvac.exceptions.Forbidden:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	        secret_field = secret["field"]
276	        secret_format = secret.get("format", "plain")
277	        secret_version = secret.get("version")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	        secret_format = secret.get("format", "plain")
277	        secret_version = secret.get("version")
278	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
290	        return (
291	            base64.b64decode(data).decode("utf-8")
292	            if secret_format == "base64"

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:291
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
290	        return (
291	            base64.b64decode(data).decode("utf-8")
292	            if secret_format == "base64"

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
325	            data = {
326	                k: base64.b64decode(v or "").decode("utf-8")
327	                for k, v in b64_data.items()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:326
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
325	            data = {
326	                k: base64.b64decode(v or "").decode("utf-8")
327	                for k, v in b64_data.items()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vault.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
364	        try:
365	            self._client.write(path, **data)
366	        except hvac.exceptions.Forbidden:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vcs.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	            return ref
161	        if repo_url.startswith("https://github.com/"):
162	            github = self._init_github(repo_url=repo_url, auth_code=auth_code)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/reconcile/utils/vcs.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
177	        """
178	        if repo_url.startswith("https://github.com/"):
179	            github = self._init_github(repo_url=repo_url, auth_code=auth_code)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	CONTENT_FORMAT_VERSION = "1.0.0"
37	DASHDOTDB_SECRET = os.environ.get(
38	    "DASHDOTDB_SECRET", "app-sre/dashdot/auth-proxy-production"
39	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	        # promotions
52	        self.add_report_section("promotions", self.app.get("promotions"))
53	        # merge activities

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	        # merge activities
54	        self.add_report_section("merge_activities", self.app.get("merge_activity"))
55	        # Container Vulnerabilities

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	            "container_vulnerabilities",
58	            self.get_vulnerability_content(self.app.get("container_vulnerabilities")),
59	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	            "post_deploy_jobs",
63	            self.get_post_deploy_jobs_content(self.app.get("post_deploy_jobs")),
64	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	            "deployment_validations",
68	            self.get_validations_content(self.app.get("deployment_validations")),
69	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        self.add_report_section(
72	            "service_slo", self.get_slo_content(self.app.get("service_slo"))
73	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	    auth = (dashdotdb_user, dashdotdb_pass)
198	    vuln_metrics = requests.get(
199	        f"{dashdotdb_url}/api/v1/imagemanifestvuln/metrics", auth=auth, timeout=60
200	    ).text

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	    ).text
201	    validt_metrics = requests.get(
202	        f"{dashdotdb_url}/api/v1/deploymentvalidation/metrics", auth=auth, timeout=60
203	    ).text

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	    ).text
204	    slo_metrics = requests.get(
205	        f"{dashdotdb_url}/api/v1/serviceslometrics/metrics", auth=auth, timeout=60
206	    ).text

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
373	    for job in result:
374	        build_history = job.get("build_history")
375	        if not build_history:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
418	            with open(report_file, "w", encoding="locale") as f:
419	                f.write(report["content"])
420	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_interface_reporter.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
421	    if not dry_run:
422	        email_body = """\
423	            Hello,
424	
425	            A new report by the App SRE team is now available at:
426	            https://visual-app-interface.devshift.net/reports
427	
428	            You can use the Search bar to search by App.
429	
430	            You can also view reports per service here:
431	            https://visual-app-interface.devshift.net/services
432	
433	
434	            Having problems? Ping us on #sd-app-sre on Slack!
435	
436	
437	            You are receiving this message because you are a member
438	            of app-interface or subscribed to a mailing list specified
439	            as owning a service being run by the App SRE team:
440	            https://gitlab.cee.redhat.com/service/app-interface
441	            """
442	
443	        mr = CreateAppInterfaceReporter(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/app_sre_tekton_access_revalidation.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	
23	EMAIL_BODY = """Hello app-interface service owner,
24	
25	Access to all Tekton pipelines namespaces must be revalidated regularly. This ensures
26	that the access is still valid and is needed to safeguard against unauthorized access.
27	
28	Please review, within one week, that all your app-interface roles that grant access to
29	those namespaces are assigned to the appropriate users. In order to help you identifying
30	those roles and users, please take a look into the app-interface documentation:
31	https://gitlab.cee.redhat.com/service/app-interface/-/blob/master/docs/app-sre/tekton/access-revalidation.md
32	
33	If you have questions about this, please post a question in the #sd-app-sre Slack channel.
34	
35	Thank you,
36	
37	The AppSRE team
38	"""
39	
40	
41	@click.command()
42	@config_file
43	@dry_run
44	@log_level
45	@gitlab_project_id
46	@click.option(
47	    "--email-dir",
48	    help="app-interface dir to store new AppSRE Tekton revalidation emails",
49	    default="data/app-interface/emails/app-sre-tekton",
50	)
51	def main(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/cost_report/cost_management_api.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
69	        }
70	        response = self.session.request(
71	            method="GET",
72	            url=f"{self.base_url}/reports/aws/costs/",
73	            params=params,
74	            timeout=self.read_timeout,
75	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/cost_report/cost_management_api.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
92	        }
93	        response = self.session.request(
94	            method="GET",
95	            url=f"{self.base_url}/reports/openshift/costs/",
96	            params=params,
97	            timeout=self.read_timeout,
98	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/cost_report/cost_management_api.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
113	        }
114	        response = self.session.request(
115	            method="GET",
116	            url=f"{self.base_url}/recommendations/openshift",
117	            params=params,
118	            timeout=self.read_timeout,
119	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/cost_report/cost_management_api.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	        body = response.json()
130	        data = body.get("data", [])
131	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/cost_report/cost_management_api.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	
132	        while next_url := body.get("links", {}).get("next"):
133	            r = self.session.request(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/cost_report/cost_management_api.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	
132	        while next_url := body.get("links", {}).get("next"):
133	            r = self.session.request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/cost_report/cost_management_api.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
132	        while next_url := body.get("links", {}).get("next"):
133	            r = self.session.request(
134	                method="GET",
135	                url=urljoin(self.host, next_url),
136	                timeout=self.read_timeout,
137	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/cost_report/cost_management_api.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	            body = r.json()
140	            data.extend(body.get("data", []))
141	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/cost_report/view.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	
33	OPTIMIZATION_HEADER = """\
34	# OpenShift Cost Optimization Report
35	
36	Report is generated for optimization enabled namespaces
37	(`insights_cost_management_optimizations='true'` in namespace `labels`).
38	
39	In Cost optimizations, recommendations get generated when
40	CPU usage is at or above the 60th percentile and
41	memory usage is at the 100th percentile.
42	
43	View details in [Cost Management Optimizations](https://console.redhat.com/openshift/cost-management/optimizations).
44	"""
45	
46	AWS_SUMMARY = """\

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/systems_and_tools.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
374	            name=a.name,
375	            url="https://dash.cloudflare.com/",
376	            description=a.description,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/cli_commands/systems_and_tools.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
482	            name="github",
483	            url="https://github.com",
484	            description="github",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/glitchtip_access_revalidation.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	EMAIL_BODY = """Hello App-Interface service owner,
25	
26	Access to all Glitchtip organizations and projects must be revalidated regularly.
27	This ensures that the access is still valid and is needed to safeguard against unauthorized access.
28	Please review, within one week, all your App-Interface roles referencing Glitchtip
29	organizations (https://gitlab.cee.redhat.com/search?search=glitchtip_roles%3A&nav_source=navbar&project_id=13582&group_id=5301&search_code=true&repository_ref=master).
30	
31	If you have questions about this, please post a question in the #sd-app-sre Slack channel.
32	
33	Thank you,
34	The SRE team
35	"""
36	
37	
38	@click.command()
39	@config_file
40	@dry_run
41	@log_level
42	@gitlab_project_id
43	@click.option(
44	    "--glitchtip-access-revalidation-email-path",
45	    help="App-interface path to store new Glitchtip revalidation emails",
46	    default="data/app-interface/emails/glitchtip",
47	)
48	def main(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
293	    for c in clusters:
294	        jh = c.get("jumpHost")
295	        if jh:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
309	
310	    clusters_ocm = [c for c in clusters if c.get("ocm") is not None and c.get("auth")]
311	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
309	
310	    clusters_ocm = [c for c in clusters if c.get("ocm") is not None and c.get("auth")]
311	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
318	
319	        if not c.get("spec"):
320	            continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
324	            "id": c["spec"]["id"],
325	            "external_id": c["spec"].get("external_id"),
326	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	        if upgrade_policy:
331	            data["upgradePolicy"] = upgrade_policy.get("schedule_type")
332	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
332	
333	        if data.get("upgradePolicy") == "automatic":
334	            data["schedule"] = c["upgradePolicy"]["schedule"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
334	            data["schedule"] = c["upgradePolicy"]["schedule"]
335	            ocm = ocm_map.get(c["name"])
336	            upgrade_policy = get_upgrade_policies(ocm.ocm_api, c["spec"]["id"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
337	            if upgrade_policy and len(upgrade_policy) > 0:
338	                next_run = upgrade_policy[0].get("next_run")
339	                if next_run:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
365	    for org_spec in orgs.values():
366	        version_data = aus.get_version_data_map(
367	            dry_run=True,
368	            org_upgrade_spec=org_spec,
369	            integration=ous.QONTRACT_INTEGRATION,
370	        ).get(org_spec.org.environment.name, org_spec.org.org_id)
371	        for version, version_history in version_data.versions.items():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
437	
438	        version_data = aus.get_version_data_map(
439	            dry_run=True,
440	            org_upgrade_spec=org_spec,
441	            integration=integration,
442	        ).get(org_spec.org.environment.name, org_spec.org.org_id)
443	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	            sector = (
479	                org_spec.sectors.get(upgrade_spec.upgrade_policy.conditions.sector)
480	                if upgrade_spec.upgrade_policy.conditions.sector

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
512	                for v in upgrades:
513	                    soaks = [s.get(v, 0) for s in workload_soaking_upgrades.values()]
514	                    min_soaks = min(soaks)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
581	    print(
582	        "https://grafana.app-sre.devshift.net/d/ukLXCSwVz/aus-cluster-upgrade-overview"
583	    )
584	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
623	    is_flag=True,
624	    default=bool(os.environ.get("IGNORE_STS_CLUSTERS")),
625	    help="Ignore STS clusters",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
908	    ocm_info = ocms[0]
909	    upgrade_policy_clusters = ocm_info.get("upgradePolicyClusters")
910	    if not upgrade_policy_clusters:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
927	    )
928	    ocm = ocm_map.get(cluster)
929	    ocm_addons = [a for a in ocm.addons if a["id"] == addon]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:953
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
952	        # detection addon service version
953	        ocm_env_labels = json.loads(ocm_info["environment"].get("labels") or "{}")
954	        addon_service_version = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
954	        addon_service_version = (
955	            ocm_env_labels.get("feature_flag_addon_service_version") or "v2"
956	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
969	def has_cluster_account_access(cluster: dict[str, Any]) -> bool:
970	    spec = cluster.get("spec") or {}
971	    account = spec.get("account")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:971
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
970	    spec = cluster.get("spec") or {}
971	    account = spec.get("account")
972	    return account or cluster.get("awsInfrastructureManagementAccounts") is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:972
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
971	    account = spec.get("account")
972	    return account or cluster.get("awsInfrastructureManagementAccounts") is not None
973	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
982	        for c in queries.get_clusters()
983	        if c.get("ocm") is not None and has_cluster_account_access(c)
984	    ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
999	        cluster_name = cluster["name"]
1000	        product = cluster.get("spec", {}).get("product", "")
1001	        management_account = tfvpc._get_default_management_account(cluster)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
999	        cluster_name = cluster["name"]
1000	        product = cluster.get("spec", {}).get("product", "")
1001	        management_account = tfvpc._get_default_management_account(cluster)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1019	                cluster,
1020	                ocm_map.get(cluster_name),
1021	                provided_assume_role=None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1104	
1105	    clusters = [c for c in queries.get_clusters() if c.get("network")]
1106	    cidrs = [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1109	            "name": c["name"],
1110	            "account": ((c.get("spec") or {}).get("account") or {}).get("name"),
1111	            "cidr": c["network"]["vpc"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1109	            "name": c["name"],
1110	            "account": ((c.get("spec") or {}).get("account") or {}).get("name"),
1111	            "cidr": c["network"]["vpc"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1109	            "name": c["name"],
1110	            "account": ((c.get("spec") or {}).get("account") or {}).get("name"),
1111	            "cidr": c["network"]["vpc"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1114	            "hosts": str(ipaddress.ip_network(c["network"]["vpc"]).num_addresses),
1115	            "description": c.get("description"),
1116	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1131	        for c in clusters
1132	        for connection in (c["peering"] or {}).get("connections") or []
1133	        if connection["provider"] == "account-tgw"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1194	    clusters = queries.get_clusters()
1195	    clusters = [c for c in clusters if c.get("ocm") is not None]
1196	    accounts = {a["uid"]: a["name"] for a in queries.get_aws_accounts()}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1201	        cluster_name = cluster["name"]
1202	        ocm = ocm_map.get(cluster_name)
1203	        role_grants = ocm.get_aws_infrastructure_access_role_grants(cluster_name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1206	            account_id = user_arn.split(":")[4]
1207	            account_name = accounts.get(account_id, "")
1208	            src_login = f"{user} @ [{account_id} ({account_name})](https://{account_id}.signin.aws.amazon.com/console)"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1251	    settings = queries.get_app_interface_settings()
1252	    clusters = [c for c in queries.get_clusters() if c.get("ocm") is not None]
1253	    ocm_map = OCMMap(clusters=clusters, settings=settings)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1257	        cluster_name = cluster["name"]
1258	        if cluster["spec"].get("account"):
1259	            item = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1264	            continue
1265	        ocm = ocm_map.get(cluster_name)
1266	        aws_account_id = ocm.get_cluster_aws_account_id(cluster_name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1358	    )
1359	    token = secret_reader.read(cluster[automation_token_name])
1360	    print(f"oc login --server {server} --token {token}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1379	
1380	    client_secret = secret_reader.read(ocm["accessTokenClientSecret"])
1381	    access_token_command = f'curl -s -X POST {ocm["accessTokenUrl"]} -d "grant_type=client_credentials" -d "client_id={ocm["accessTokenClientId"]}" -d "client_secret={client_secret}" | jq -r .access_token'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1461	        logging.error(
1462	            "terraform-repo is missing a section in this account's '/dependencies/terraform-state-1.yml' file, please add one using the docs in https://gitlab.cee.redhat.com/service/app-interface/-/blob/master/docs/terraform-repo/getting-started.md?ref_type=heads#step-1-setup-aws-account and then try again"
1463	        )
1464	        return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1655	    for w in job["wrappers"]:
1656	        vault_secrets = w.get("vault-secrets")
1657	        if vault_secrets:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1657	        if vault_secrets:
1658	            vault_url = vault_secrets.get("vault-url")
1659	            secrets = vault_secrets.get("secrets")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1658	            vault_url = vault_secrets.get("vault-url")
1659	            secrets = vault_secrets.get("secrets")
1660	            for s in secrets:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1706	        ob.aggregate_shared_resources(ns_info, "openshiftResources")
1707	        openshift_resources = ns_info.get("openshiftResources") or []
1708	        for r in openshift_resources:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1748	) -> str | None:
1749	    return overrides.get(attr) or defaults.get(attr)
1750	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1748	) -> str | None:
1749	    return overrides.get(attr) or defaults.get(attr)
1750	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1764	    return (
1765	        spec.resource.get("region")
1766	        or rds_attr("region", overrides, defaults)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1766	        or rds_attr("region", overrides, defaults)
1767	        or region_from_az(spec.resource.get("availability_zone"))
1768	        or region_from_az(rds_attr("availability_zone", overrides, defaults))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1768	        or region_from_az(rds_attr("availability_zone", overrides, defaults))
1769	        or accounts[spec.provisioner_name].get("resourcesDefaultRegion")
1770	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1792	            )
1793	            overrides = json.loads(spec.resource.get("overrides") or "{}")
1794	            item = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1892	    for account in accounts:
1893	        account_name = account.get("name")
1894	        account_deployment_regions = account.get("supportedDeploymentRegions")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1893	        account_name = account.get("name")
1894	        account_deployment_regions = account.get("supportedDeploymentRegions")
1895	        for region in account_deployment_regions or []:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1898	                    data = aws.describe_rds_recommendations(account_name, region)
1899	                    db_recommendations = data.get("DBRecommendations", [])
1900	                except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1913
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1912	                    for rec in db_recommendations
1913	                    if rec.get("Status") not in IGNORED_STATUSES
1914	                    and rec.get("Severity") not in IGNORED_SEVERITIES

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:1914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1913	                    if rec.get("Status") not in IGNORED_STATUSES
1914	                    and rec.get("Severity") not in IGNORED_SEVERITIES
1915	                ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2014	
2015	        for p in role.get("permissions") or []:
2016	            r_name = p["service"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2028	
2029	        for aws in role.get("aws_groups") or []:
2030	            for policy in aws["policies"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2033
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2032	
2033	        for a in role.get("access") or []:
2034	            if a["cluster"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2040	
2041	        for s in role.get("self_service") or []:
2042	            for d in s.get("datafiles") or []:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2041	        for s in role.get("self_service") or []:
2042	            for d in s.get("datafiles") or []:
2043	                name = d.get("name")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2043
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2042	            for d in s.get("datafiles") or []:
2043	                name = d.get("name")
2044	                if name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2132	    )
2133	    oc = oc_map.get(cluster)
2134	    obj = oc.get(namespace, kind, name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2133	    oc = oc_map.get(cluster)
2134	    obj = oc.get(namespace, kind, name)
2135	    root_owner = oc.get_obj_root_owner(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2179	
2180	    parent_apps = {app["parentApp"]["path"] for app in apps if app.get("parentApp")}
2181	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2186	            "name": full_name(app),
2187	            "latest": latest_sre_checkpoints.get(full_name(app), ""),
2188	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2280	
2281	            labels = mr.attributes.get("labels") or []
2282	            if glhk.is_good_to_merge(labels):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2375	        # skip stale or non self serviceable MRs
2376	        labels = mr.attributes.get("labels", [])
2377	        if "stale" in labels:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2464	            "merged_at": mr.merged_at,
2465	            "labels": ", ".join(mr.attributes.get("labels", [])),
2466	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2502	        c_name = c.name
2503	        oc = oc_map.get(c_name)
2504	        if not oc or isinstance(oc, OCLogMsg):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2512	                    kind = resource["kind"]
2513	                    namespace = resource["metadata"].get("namespace")
2514	                    name = resource["metadata"]["name"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2563	        c_name = c.name
2564	        oc = oc_map.get(c_name)
2565	        if not oc or isinstance(oc, OCLogMsg):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2578	                            kind = resource["kind"]
2579	                            namespace = resource["metadata"].get("namespace")
2580	                            name = resource["metadata"]["name"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2668	            for t in instance.tags:
2669	                if t.get("Key") == "os":
2670	                    os = t["Value"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2670	                    os = t["Value"]
2671	                if t.get("Key") == "jenkins_controller":
2672	                    url = f"https://{t['Value'].replace('-', '.')}.devshift.net/computer/{instance.id}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2675	            for t in image.tags:
2676	                if t.get("Key") == "infra_commit":
2677	                    commit_url = f"https://gitlab.cee.redhat.com/app-sre/infra/-/tree/{t.get('Value')}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2676	                if t.get("Key") == "infra_commit":
2677	                    commit_url = f"https://gitlab.cee.redhat.com/app-sre/infra/-/tree/{t.get('Value')}"
2678	            launch_emoji = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2676	                if t.get("Key") == "infra_commit":
2677	                    commit_url = f"https://gitlab.cee.redhat.com/app-sre/infra/-/tree/{t.get('Value')}"
2678	            launch_emoji = ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2602	    help="AWS access key id",
2603	    default=os.environ.get("QONTRACT_CLI_EC2_JENKINS_WORKER_AWS_ACCESS_KEY_ID", None),
2604	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2607	    help="AWS secret access key",
2608	    default=os.environ.get(
2609	        "QONTRACT_CLI_EC2_JENKINS_WORKER_AWS_SECRET_ACCESS_KEY", None
2610	    ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2614	    help="AWS region",
2615	    default=os.environ.get("QONTRACT_CLI_EC2_JENKINS_WORKER_AWS_REGION", "us-east-1"),
2616	)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2794	    with open(file_path, encoding="locale") as f:
2795	        content = json.loads(f.read())
2796	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2810	            for rule in rules:
2811	                name = rule.get("alert")
2812	                summary = rule.get("annotations", {}).get("summary")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2811	                name = rule.get("alert")
2812	                summary = rule.get("annotations", {}).get("summary")
2813	                message = rule.get("annotations", {}).get("message")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2811	                name = rule.get("alert")
2812	                summary = rule.get("annotations", {}).get("summary")
2813	                message = rule.get("annotations", {}).get("message")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2812	                summary = rule.get("annotations", {}).get("summary")
2813	                message = rule.get("annotations", {}).get("message")
2814	                severity = rule.get("labels", {}).get("severity")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2812	                summary = rule.get("annotations", {}).get("summary")
2813	                message = rule.get("annotations", {}).get("message")
2814	                severity = rule.get("labels", {}).get("severity")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2813	                message = rule.get("annotations", {}).get("message")
2814	                severity = rule.get("labels", {}).get("severity")
2815	                description = rule.get("annotations", {}).get("description")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2813	                message = rule.get("annotations", {}).get("message")
2814	                severity = rule.get("labels", {}).get("severity")
2815	                description = rule.get("annotations", {}).get("description")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2814	                severity = rule.get("labels", {}).get("severity")
2815	                description = rule.get("annotations", {}).get("description")
2816	                threshold = rule.get("for")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2814	                severity = rule.get("labels", {}).get("severity")
2815	                description = rule.get("annotations", {}).get("description")
2816	                threshold = rule.get("for")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2815	                description = rule.get("annotations", {}).get("description")
2816	                threshold = rule.get("for")
2817	                if name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:2987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2986	                    continue
2987	                if hcp_migration := t.namespace.cluster.labels.get("hcp_migration"):
2988	                    app = sf.app.parent_app.name if sf.app.parent_app else sf.app.name

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3037	        if m.namespace.cluster.labels
3038	        and m.namespace.cluster.labels.get("environment") == environment_name
3039	    ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3075
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3074	            project = c["project"]
3075	            root_node = project.get("node") or ""
3076	            if "jobs" not in project:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3080	                for job in pj.values():
3081	                    node = job.get("node", root_node)
3082	                    if node in {"rhel8", "rhel8-app-interface"}:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3156	    state = init_state(integration=cl.QONTRACT_INTEGRATION)
3157	    change_log = ChangeLog(**state.get(BUNDLE_DIFFS_OBJ))
3158	    data: list[dict[str, str]] = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3243	    state = init_state(integration=integration)
3244	    value = state.get(key)
3245	    print(value)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3381	        )
3382	        value = cache.get(cache_key)
3383	        print(value)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3574	    ob.aggregate_shared_resources(namespace_info, "openshiftResources")
3575	    openshift_resources = namespace_info.get("openshiftResources")
3576	    for r in openshift_resources:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3576	    for r in openshift_resources:
3577	        resource_path = r.get("resource", {}).get("path")
3578	        if path and path != resource_path:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3576	    for r in openshift_resources:
3577	        resource_path = r.get("resource", {}).get("path")
3578	        if path and path != resource_path:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3631	        for resource in ns["openshiftResources"]:
3632	            tests = resource.get("tests") or []
3633	            if path not in tests:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3746	        ob.aggregate_shared_resources(ni, "openshiftResources")
3747	        for r in ni.get("openshiftResources"):
3748	            if r.get("resource", {}).get("path") != alertmanager_secret_path:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3747	        for r in ni.get("openshiftResources"):
3748	            if r.get("resource", {}).get("path") != alertmanager_secret_path:
3749	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3747	        for r in ni.get("openshiftResources"):
3748	            if r.get("resource", {}).get("path") != alertmanager_secret_path:
3749	                continue

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
3752	            if "data" in body:
3753	                am_config = base64.b64decode(
3754	                    body["data"][alertmanager_secret_key]
3755	                ).decode("utf-8")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3753
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
3752	            if "data" in body:
3753	                am_config = base64.b64decode(
3754	                    body["data"][alertmanager_secret_key]
3755	                ).decode("utf-8")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3766	            continue
3767	        for r in ni.get("openshiftResources"):
3768	            if r.get("resource", {}).get("path") != rules_path:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3767	        for r in ni.get("openshiftResources"):
3768	            if r.get("resource", {}).get("path") != rules_path:
3769	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3767	        for r in ni.get("openshiftResources"):
3768	            if r.get("resource", {}).get("path") != rules_path:
3769	                continue

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3954
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3953	    secret_reader = SecretReader(settings=settings)
3954	    prom_auth_creds = secret_reader.read(auth)
3955	    prom_auth = requests.auth.HTTPBasicAuth(*prom_auth_creds.split(":"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3957
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3956	
3957	    url = f"https://prometheus.{cluster}.devshift.net/api/v1/query"
3958	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:3959
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3958	
3959	    response = requests.get(url, params={"query": query}, auth=prom_auth, timeout=60)
3960	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:4078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4077	
4078	    bucket = os.environ.get("APP_INTERFACE_STATE_BUCKET")
4079	    region = os.environ.get("APP_INTERFACE_STATE_BUCKET_REGION", "us-east-1")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:4079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4078	    bucket = os.environ.get("APP_INTERFACE_STATE_BUCKET")
4079	    region = os.environ.get("APP_INTERFACE_STATE_BUCKET_REGION", "us-east-1")
4080	    promotion_state = SaasPromotionState.create(promotion_state=None, saas_files=None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:4081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4080	    promotion_state = SaasPromotionState.create(promotion_state=None, saas_files=None)
4081	    for publisher_id, state in promotion_state.get(channel=channel, sha=sha).items():
4082	        print()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:4105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4104	    print(f"Current states for {publisher_id=}")
4105	    print(promotion_state.get(channel=channel, sha=sha).get(publisher_id, None))
4106	    print()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:4105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4104	    print(f"Current states for {publisher_id=}")
4105	    print(promotion_state.get(channel=channel, sha=sha).get(publisher_id, None))
4106	    print()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:4111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4110	    print(f"New state for {publisher_id=}")
4111	    print(promotion_state.get(channel=channel, sha=sha).get(publisher_id, None))
4112	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:4111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4110	    print(f"New state for {publisher_id=}")
4111	    print(promotion_state.get(channel=channel, sha=sha).get(publisher_id, None))
4112	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/qontract_reconcile-0.10.2.dev145/qontract_reconcile-0.10.2.dev145/tools/qontract_cli.py:4120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4119	    help="filesystem path to a local app-interface repo",
4120	    default=os.environ.get("APP_INTERFACE_PATH", None),
4121	)

--------------------------------------------------

Code scanned:
	Total lines of code: 107725
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 91.0
		High: 825.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 891.0
		High: 25.0
Files skipped (0):
