Run started:2025-04-12 14:15:04.730425

Test results:
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
23	with open(os.path.join(here, "trino", "_version.py"), "r", "utf-8") as f:
24	    exec(f.read(), about)
25	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	with open(os.path.join(here, "trino", "_version.py"), "r", "utf-8") as f:
24	    exec(f.read(), about)
25	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/setup.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	with open(os.path.join(here, "README.md"), "r", "utf-8") as f:
27	    readme = f.read()
28	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/_version.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	__description__ = "Client for the Trino distributed SQL Engine"
3	__url__ = "https://github.com/trinodb/trino-python-client"
4	__version__ = "0.333.0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
335	    def get_token_from_cache(self, key: Optional[str]) -> Optional[str]:
336	        return self._cache.get(key)
337	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
363	            password_as_dict = json.loads(str(password))
364	            if password_as_dict.get("sharded_password"):
365	                # if password was stored shared, reconstruct it

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
365	                # if password was stored shared, reconstruct it
366	                shard_count = int(password_as_dict.get("shard_count"))
367	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
372	        except self._keyring.errors.NoKeyringError as e:
373	            raise trino.exceptions.NotSupportedError("Although keyring module is installed no backend has been "
374	                                                     "detected, check https://pypi.org/project/keyring/ for more "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
403	        except self._keyring.errors.NoKeyringError as e:
404	            raise trino.exceptions.NotSupportedError("Although keyring module is installed no backend has been "
405	                                                     "detected, check https://pypi.org/project/keyring/ for more "

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
453	
454	        return self._retry_request(response, **kwargs)
455	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
457	        # we have to handle the authentication, may be token the token expired, or it wasn't there at all
458	        auth_info = response.headers.get('WWW-Authenticate')
459	        if not auth_info:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
470	
471	        auth_server = auth_info_headers.get('bearer x_redirect_server', auth_info_headers.get('x_redirect_server'))
472	        token_server = auth_info_headers.get('bearer x_token_server', auth_info_headers.get('x_token_server'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
470	
471	        auth_server = auth_info_headers.get('bearer x_redirect_server', auth_info_headers.get('x_redirect_server'))
472	        token_server = auth_info_headers.get('bearer x_token_server', auth_info_headers.get('x_token_server'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
471	        auth_server = auth_info_headers.get('bearer x_redirect_server', auth_info_headers.get('x_redirect_server'))
472	        token_server = auth_info_headers.get('bearer x_token_server', auth_info_headers.get('x_token_server'))
473	        if token_server is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
471	        auth_server = auth_info_headers.get('bearer x_redirect_server', auth_info_headers.get('x_redirect_server'))
472	        token_server = auth_info_headers.get('bearer x_token_server', auth_info_headers.get('x_token_server'))
473	        if token_server is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
516	                    token_response = json.loads(response.text)
517	                    token = token_response.get('token')
518	                    if token:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
519	                        return token
520	                    error = token_response.get('error')
521	                    if error:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
523	                    else:
524	                        token_server = token_response.get('nextUri')
525	                        logger.debug(f"nextURi auth token server: {token_server}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/auth.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
547	    def _determine_user(headers: Mapping[Any, Any]) -> Optional[Any]:
548	        return headers.get(HEADER_USER)
549	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
98	logger = trino.logging.get_logger(__name__)
99	executor = ThreadPoolExecutor(max_workers=4)
100	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	MAX_ATTEMPTS = constants.DEFAULT_MAX_ATTEMPTS
109	SOCKS_PROXY = os.environ.get("SOCKS_PROXY")
110	if SOCKS_PROXY:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
633	
634	        http_response = self._post(
635	            self.statement_url,
636	            data=data,
637	            headers=http_headers,
638	            timeout=self._request_timeout,
639	            proxies=PROXIES,
640	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	    def get(self, url: str) -> Response:
644	        return self._get(
645	            url,
646	            headers=self.http_headers,
647	            timeout=self._request_timeout,
648	            proxies=PROXIES,
649	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
688	        if "error" in response and response["error"]:
689	            raise self._process_error(response["error"], response.get("id"))
690	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
732	
733	        self._next_uri = response.get("nextUri")
734	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
734	
735	        data = response.get("data") if response.get("data") else []
736	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
734	
735	        data = response.get("data") if response.get("data") else []
736	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
739	            stats=response["stats"],
740	            warnings=response.get("warnings", []),
741	            info_uri=response["infoUri"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
742	            next_uri=self._next_uri,
743	            update_type=response.get("updateType"),
744	            update_count=response.get("updateCount"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
743	            update_type=response.get("updateType"),
744	            update_count=response.get("updateCount"),
745	            rows=data,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
745	            rows=data,
746	            columns=response.get("columns"),
747	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
882	        try:
883	            response = self._request.post(self._query, additional_http_headers)
884	        except requests.exceptions.RequestException as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
916	        try:
917	            response = self._request.get(self._request.next_uri)
918	        except requests.exceptions.RequestException as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:1000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
999	                        if result.status_code == 429 and "Retry-After" in result.headers:
1000	                            retry_after = _parse_retry_after_header(result.headers.get("Retry-After"))
1001	                            handle_retry_sleep = _RetryAfterSleep(retry_after)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1101	    def data(self) -> bytes:
1102	        return base64.b64decode(self._segment["data"])
1103	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1101	    def data(self) -> bytes:
1102	        return base64.b64decode(self._segment["data"])
1103	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1133	    def data(self) -> bytes:
1134	        http_response = self._send_spooling_request(self.uri)
1135	        if not http_response.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:1149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1148	    def headers(self) -> Dict[str, List[str]]:
1149	        return self._segment.get("headers", {})
1150	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:1154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1153	            try:
1154	                http_response = self._send_spooling_request(self.ack_uri, timeout=2)
1155	                if not http_response.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/client.py:1168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1167	            headers_with_single_value[key] = values[0]
1168	        return self._request._get(uri, headers=headers_with_single_value, **kwargs)
1169	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/mapper.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
94	            return None
95	        return base64.b64decode(value.encode("utf8"))
96	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trino-0.333.0/trino-0.333.0/trino/mapper.py:95
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
94	            return None
95	        return base64.b64decode(value.encode("utf8"))
96	

--------------------------------------------------

Code scanned:
	Total lines of code: 3777
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 36.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 39.0
		High: 3.0
Files skipped (0):
