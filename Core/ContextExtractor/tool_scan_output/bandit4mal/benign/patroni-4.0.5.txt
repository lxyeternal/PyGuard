Run started:2025-04-12 11:46:01.643182

Test results:
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
395	    if os.name != 'nt':
396	        signal.signal(signal.SIGCHLD, sigchld_handler)
397	        signal.signal(signal.SIGHUP, passtochild)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:396
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
395	    if os.name != 'nt':
396	        signal.signal(signal.SIGCHLD, sigchld_handler)
397	        signal.signal(signal.SIGHUP, passtochild)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
396	        signal.signal(signal.SIGCHLD, sigchld_handler)
397	        signal.signal(signal.SIGHUP, passtochild)
398	        signal.signal(signal.SIGQUIT, passtochild)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:397
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
396	        signal.signal(signal.SIGCHLD, sigchld_handler)
397	        signal.signal(signal.SIGHUP, passtochild)
398	        signal.signal(signal.SIGQUIT, passtochild)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
397	        signal.signal(signal.SIGHUP, passtochild)
398	        signal.signal(signal.SIGQUIT, passtochild)
399	        signal.signal(signal.SIGUSR1, passtochild)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:398
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
397	        signal.signal(signal.SIGHUP, passtochild)
398	        signal.signal(signal.SIGQUIT, passtochild)
399	        signal.signal(signal.SIGUSR1, passtochild)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
398	        signal.signal(signal.SIGQUIT, passtochild)
399	        signal.signal(signal.SIGUSR1, passtochild)
400	        signal.signal(signal.SIGUSR2, passtochild)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:399
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
398	        signal.signal(signal.SIGQUIT, passtochild)
399	        signal.signal(signal.SIGUSR1, passtochild)
400	        signal.signal(signal.SIGUSR2, passtochild)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
399	        signal.signal(signal.SIGUSR1, passtochild)
400	        signal.signal(signal.SIGUSR2, passtochild)
401	    signal.signal(signal.SIGINT, passtochild)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:400
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
399	        signal.signal(signal.SIGUSR1, passtochild)
400	        signal.signal(signal.SIGUSR2, passtochild)
401	    signal.signal(signal.SIGINT, passtochild)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
400	        signal.signal(signal.SIGUSR2, passtochild)
401	    signal.signal(signal.SIGINT, passtochild)
402	    signal.signal(signal.SIGABRT, passtochild)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:401
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
400	        signal.signal(signal.SIGUSR2, passtochild)
401	    signal.signal(signal.SIGINT, passtochild)
402	    signal.signal(signal.SIGABRT, passtochild)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
401	    signal.signal(signal.SIGINT, passtochild)
402	    signal.signal(signal.SIGABRT, passtochild)
403	    signal.signal(signal.SIGTERM, passtochild)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:402
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
401	    signal.signal(signal.SIGINT, passtochild)
402	    signal.signal(signal.SIGABRT, passtochild)
403	    signal.signal(signal.SIGTERM, passtochild)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
402	    signal.signal(signal.SIGABRT, passtochild)
403	    signal.signal(signal.SIGTERM, passtochild)
404	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:403
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
402	    signal.signal(signal.SIGABRT, passtochild)
403	    signal.signal(signal.SIGTERM, passtochild)
404	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/__main__.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
405	    import multiprocessing
406	    patroni = multiprocessing.Process(target=patroni_main, args=(args.configfile,))
407	    patroni.start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
140	        message = self.responses[status_code][0]
141	        self.wfile.write('{0} {1} {2}\r\n\r\n'.format(self.protocol_version, status_code, message).encode('utf-8'))
142	        self.log_request(status_code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
141	        self.wfile.write('{0} {1} {2}\r\n\r\n'.format(self.protocol_version, status_code, message).encode('utf-8'))
142	        self.log_request(status_code)
143	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	        self.end_headers()
169	        self.wfile.write(body.encode('utf-8'))
170	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
700	                return {}
701	            request = json.loads(self.rfile.read(content_length).decode('utf-8'))
702	            if isinstance(request, dict) and (request or body_is_optional):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:1231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1230	        """
1231	        ret = BaseHTTPRequestHandler.parse_request(self)
1232	        if ret:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:1380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1379	        self.__start_time = time.time()
1380	        BaseHTTPRequestHandler.handle_one_request(self)
1381	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:1579
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1578	            try:
1579	                sock = socket.socket(socket.AF_INET6, socket.SOCK_STREAM)
1580	                sock.setsockopt(socket.IPPROTO_IPV6, socket.IPV6_V6ONLY, False)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:1586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1585	                if sock:
1586	                    sock.close()
1587	        return False

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:1654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1653	            # Rely on ThreadingMixIn.server_close() to have all requests terminate before we continue
1654	            self.server_close()
1655	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:1704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1703	                request.do_handshake()
1704	        super(RestApiServer, self).process_request_thread(request, client_address)
1705	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:1704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1703	                request.do_handshake()
1704	        super(RestApiServer, self).process_request_thread(request, client_address)
1705	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:1722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1721	                logger.debug('Failed to shutdown SSL connection: %r', e)
1722	        super(RestApiServer, self).shutdown_request(request)
1723	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:1796
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1795	
1796	        self.__auth_key = base64.b64encode(config['auth'].encode('utf-8')) if 'auth' in config else None
1797	        # pyright -- ``__listen`` is initially created as ``None``, but right after that it is replaced with a string

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/api.py:1796
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1795	
1796	        self.__auth_key = base64.b64encode(config['auth'].encode('utf-8')) if 'auth' in config else None
1797	        # pyright -- ``__listen`` is initially created as ``None``, but right after that it is replaced with a string

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/async_executor.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
186	        """
187	        Thread(target=self.run, args=(func, args)).start()
188	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/config.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
247	                tmpfile = shutil.move(tmpfile, self._cache_file)
248	                os.chmod(self._cache_file, pg_perm.file_create_mode)
249	                self._cache_needs_saving = False

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/config.py:248
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
247	                tmpfile = shutil.move(tmpfile, self._cache_file)
248	                os.chmod(self._cache_file, pg_perm.file_create_mode)
249	                self._cache_needs_saving = False

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/config_generator.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
60	    try:
61	        hostname = socket.gethostname()
62	        # Filter out unexpected results when python is compiled with --disable-ipv6 and running on IPv6 system.

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/config_generator.py:61
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
60	    try:
61	        hostname = socket.gethostname()
62	        # Filter out unexpected results when python is compiled with --disable-ipv6 and running on IPv6 system.

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/config_generator.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
216	        """
217	        fd.write('\n'.join(self._format_config()))
218	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/config_generator.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
360	        try:
361	            conn = psycopg.connect(dsn=self.dsn,
362	                                   password=self.config['postgresql']['authentication']['superuser']['password'])
363	            with conn.cursor() as cur:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/config_generator.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
364	                yield cur
365	            conn.close()
366	        except psycopg.Error as e:

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/config_generator.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
426	        # because we use "username" in the config for some reason
427	        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()
428	        su_params['password'] = su_params.get('password', patroni_env_su_pwd) or \

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/config_generator.py:427
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
426	        # because we use "username" in the config for some reason
427	        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()
428	        su_params['password'] = su_params.get('password', patroni_env_su_pwd) or \

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/ctl.py:842
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
841	            raise PatroniCtlException('--file and --command are mutually exclusive options')
842	        sql = p_file.read().decode('utf-8')
843	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/ctl.py:1876
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1875	    with tmp:
1876	        tmp.write(contents)
1877	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/ctl.py:1876
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1875	    with tmp:
1876	        tmp.write(contents)
1877	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/ctl.py:1911
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1910	        for line in unified_diff:
1911	            buf.write(line.encode('utf-8'))
1912	        buf.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/ctl.py:1911
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1910	        for line in unified_diff:
1911	            buf.write(line.encode('utf-8'))
1912	        buf.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/ctl.py:2077
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2076	        with codecs.open(tmpfile, encoding='utf-8') as fd:
2077	            after_editing = fd.read()
2078	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/daemon.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
104	        if os.name != 'nt':
105	            signal.signal(signal.SIGHUP, self.sighup_handler)
106	        signal.signal(signal.SIGTERM, self.sigterm_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/daemon.py:105
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
104	        if os.name != 'nt':
105	            signal.signal(signal.SIGHUP, self.sighup_handler)
106	        signal.signal(signal.SIGTERM, self.sigterm_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/daemon.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
105	            signal.signal(signal.SIGHUP, self.sighup_handler)
106	        signal.signal(signal.SIGTERM, self.sigterm_handler)
107	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/daemon.py:106
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
105	            signal.signal(signal.SIGHUP, self.sighup_handler)
106	        signal.signal(signal.SIGTERM, self.sigterm_handler)
107	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/consul.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
57	
58	    def __init__(self, host: str = '127.0.0.1', port: int = 8500, token: Optional[str] = None, scheme: str = 'http',
59	                 verify: bool = True, cert: Optional[str] = None, ca_cert: Optional[str] = None) -> None:
60	        self.token = token

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/consul.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
141	                kwargs['headers']['X-Consul-Token'] = token
142	            return callback(self.response(self.http.request(method.upper(), self.uri(path, params), **kwargs)))
143	        return wrapper

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/consul.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
194	    def connect(self, *args: Any, **kwargs: Any) -> HTTPClient:
195	        return self.http_connect(*args, **kwargs)  # pragma: no cover
196	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
283	        kwargs = self._prepare_common_parameters(etcd_nodes, timeout)
284	        request_executor = self._prepare_request(kwargs, params, method)
285	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
287	            try:
288	                response = self._do_http_request(retry, machines_cache, request_executor, method, path, **kwargs)
289	                return self._handle_server_response(response)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
466	    def _get_members(self, base_uri: str, **kwargs: Any) -> List[str]:
467	        response = self.http.request(self._MGET, base_uri + self.version_prefix + '/machines', **kwargs)
468	        data = self._handle_server_response(response).data.decode('utf-8')

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd.py:599
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
598	                try:
599	                    sock = socket.socket(af, socktype, proto)
600	                    self.set_socket_options(sock, socket_options)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
601	                    if timeout is None or isinstance(timeout, (float, int)):
602	                        sock.settimeout(timeout)
603	                    if source_address:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
604	                        sock.bind(source_address)
605	                    sock.connect(sa)
606	                    return sock

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
610	                    if sock is not None:
611	                        sock.close()
612	                        sock = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
787	    def set_failover_value(self, value: str, version: Optional[int] = None) -> bool:
788	        return bool(self._client.write(self.failover_path, value, prevIndex=version or 0))
789	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd.py:792
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
791	    def set_config_value(self, value: str, version: Optional[int] = None) -> bool:
792	        return bool(self._client.write(self.config_path, value, prevIndex=version or 0))
793	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
834	    def set_history_value(self, value: str) -> bool:
835	        return bool(self._client.write(self.history_path, value))
836	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd3.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
188	def base64_encode(v: Union[str, bytes]) -> str:
189	    return base64.b64encode(to_bytes(v)).decode('utf-8')
190	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd3.py:189
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
188	def base64_encode(v: Union[str, bytes]) -> str:
189	    return base64.b64encode(to_bytes(v)).decode('utf-8')
190	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd3.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
192	def base64_decode(v: str) -> str:
193	    return base64.b64decode(v).decode('utf-8')
194	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd3.py:193
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
192	def base64_decode(v: str) -> str:
193	    return base64.b64decode(v).decode('utf-8')
194	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd3.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
252	        if self.version_prefix != '/v3':
253	            response = self.http.urlopen(self._MGET, base_uri + '/version', **kwargs)
254	            response = self._handle_server_response(response)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd3.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
284	        self._ensure_version_prefix(base_uri, **kwargs)
285	        resp = self.http.urlopen(self._MPOST, base_uri + self.version_prefix + '/cluster/member/list', **kwargs)
286	        members = self._handle_server_response(resp)['members']

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd3.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
502	        try:
503	            response.close()
504	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/etcd3.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
570	                sock.shutdown(socket.SHUT_RDWR)
571	                sock.close()
572	            except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
62	    fd, name = tempfile.mkstemp()
63	    os.write(fd, content)
64	    os.close(fd)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
62	    fd, name = tempfile.mkstemp()
63	    os.write(fd, content)
64	    os.close(fd)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
63	    os.write(fd, content)
64	    os.close(fd)
65	    __temp_files.append(name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
98	        with open(SERVICE_TOKEN_FILENAME) as f:
99	            token = f.read()
100	            if not token:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
114	        with open(ca_certs) as f:
115	            if not f.read():
116	                raise self.ConfigException('Cert file exists but empty.')

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
131	        if data_key_name in config:
132	            self.pool_config[pool_key_name] = _create_temp_file(base64.b64decode(config[data_key_name]))
133	        elif file_key_name in config:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:132
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
131	        if data_key_name in config:
132	            self.pool_config[pool_key_name] = _create_temp_file(base64.b64decode(config[data_key_name]))
133	        elif file_key_name in config:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
137	        with open(os.path.expanduser(KUBE_CONFIG_DEFAULT_LOCATION)) as f:
138	            config: Dict[str, Any] = yaml.safe_load(f)
139	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
291	                try:
292	                    response = self.pool_manager.request('GET', base_uri + path, headers=headers, **kwargs)
293	                    endpoint = self._handle_server_response(response, True)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
376	                try:
377	                    response = self.pool_manager.request(method, base_uri + path, **kwargs)
378	                    if some_request_failed:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
416	                try:
417	                    return self._do_http_request(retry, api_servers_cache, method, path, **kwargs)
418	                except K8sConnectionFailed as ex:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
447	
448	            response = self.request(_retry, method, self._API_URL_PREFIX + path, headers=headers, fields=fields,
449	                                    body=body, preload_content=_preload_content, timeout=_request_timeout)
450	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
683	        try:
684	            response.close()
685	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/kubernetes.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
734	                sock.shutdown(socket.SHUT_RDWR)
735	                sock.close()
736	            except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/raft.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	        if add_self:
90	            thread = threading.Thread(target=utility.executeCommand, args=(['add', selfAddress],))
91	            thread.daemon = True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/raft.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
276	    def startAutoTick(self) -> None:
277	        self.__thread = threading.Thread(target=self._autoTickThread)
278	        self.__thread.daemon = True

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/zookeeper.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
141	
142	        ret = self._orig_kazoo_connect(*args)
143	        return max(self.loop_wait - 2, 2) * 1000, ret[1]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/dcs/zookeeper.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
165	        if not self.set_ttl(config['ttl']) and loop_wait_changed:
166	            self._client._connection._socket.close()
167	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/ha.py:1147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
1146	            return []
1147	        pool = ThreadPool(len(members))
1148	        results = pool.map(self.fetch_node_status, members)  # Run API calls on members in parallel

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/ha.py:1230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
1229	            return True
1230	        pool = ThreadPool(len(members))
1231	        call_failsafe_member = functools.partial(self.call_failsafe_member, data)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/log.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
52	        ret = super(PatroniFileHandler, self)._open()
53	        os.chmod(self.baseFilename, self._log_file_mode)
54	        return ret

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/log.py:53
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
52	        ret = super(PatroniFileHandler, self)._open()
53	        os.chmod(self.baseFilename, self._log_file_mode)
54	        return ret

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
90	        self.bootstrapping = False
91	        self.__thread_ident = current_thread().ident
92	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
264	                with open(self._version_file) as f:
265	                    return postgres_major_version_to_int(f.read().strip())
266	            except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1113	                with open(history_path, 'r') as f:
1114	                    history_content = f.read()
1115	                history = list(parse_history(history_content))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:1246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1245	        # If it is called not from main thread we will create a new cursor to execute statement.
1246	        if current_thread().ident == self.__thread_ident:
1247	            timeline = self._cluster_info_state_get('timeline') or 0

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:1262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1261	            sql = "SELECT " + self.POSTMASTER_START_TIME
1262	            return self.query(sql, retry=current_thread().ident == self.__thread_ident)[0][0].isoformat(sep=' ')
1263	        except psycopg.Error:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:1316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1315	                    if os.path.exists(new_name):
1316	                        shutil.rmtree(new_name)
1317	                    os.rename(pg_wal_realpath, new_name)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:1326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1325	                    if os.path.exists(new_name):
1326	                        shutil.rmtree(new_name)
1327	                    os.rename(pg_tsp_rpath, new_name)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:1334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1333	                if os.path.exists(new_name):
1334	                    shutil.rmtree(new_name)
1335	                os.rename(self._data_dir, new_name)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:1355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1354	                    logger.info('Removing WAL directory: %s', pg_wal_realpath)
1355	                    shutil.rmtree(pg_wal_realpath)
1356	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:1360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1359	                    logger.info('Removing user defined tablespace directory: %s', pg_tsp_rpath)
1360	                    shutil.rmtree(pg_tsp_rpath, ignore_errors=True)
1361	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/__init__.py:1362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1361	
1362	                shutil.rmtree(self._data_dir)
1363	        except (IOError, OSError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/bootstrap.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
130	                (fd, pwfile) = tempfile.mkstemp()
131	                os.write(fd, self._postgresql.config.superuser['password'].encode('utf-8'))
132	                os.close(fd)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/bootstrap.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
130	                (fd, pwfile) = tempfile.mkstemp()
131	                os.write(fd, self._postgresql.config.superuser['password'].encode('utf-8'))
132	                os.close(fd)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
283	        if self._fd:
284	            self._fd.close()
285	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
287	        if self._fd:
288	            self._fd.write(line)
289	            self._fd.write('\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
288	            self._fd.write(line)
289	            self._fd.write('\n')
290	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
488	            pg_perm.set_permissions_from_data_directory(self._postgresql.data_dir)
489	            os.chmod(filename, pg_perm.file_create_mode)
490	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:489
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
488	            pg_perm.set_permissions_from_data_directory(self._postgresql.data_dir)
489	            os.chmod(filename, pg_perm.file_create_mode)
490	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
532	                    elif f == 'pg_ident.conf':
533	                        open(config_file, 'w').close()
534	                        self.set_file_permissions(config_file)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
576	            with open(self._pg_hba_conf, 'a') as f:
577	                f.write('\n{}\n'.format('\n'.join(config)))
578	            self.set_file_permissions(self._pg_hba_conf)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:823
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
822	                    wanted_lines = (self._pgpass_content(wanted_primary_conninfo) or '').splitlines()
823	                    file_lines = f.read().splitlines()
824	                    if set(wanted_lines) == set(file_lines):

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
982	        with open(self._pgpass, 'w') as f:
983	            os.chmod(self._pgpass, stat.S_IWRITE | stat.S_IREAD)
984	            f.write(content)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:983
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
982	        with open(self._pgpass, 'w') as f:
983	            os.chmod(self._pgpass, stat.S_IWRITE | stat.S_IREAD)
984	            f.write(content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:984
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
983	            os.chmod(self._pgpass, stat.S_IWRITE | stat.S_IREAD)
984	            f.write(content)
985	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:992
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
991	            if parse_bool(recovery_params.pop('standby_mode', None)):
992	                open(self._standby_signal, 'w').close()
993	                self.set_file_permissions(self._standby_signal)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
995	                self._remove_file_if_exists(self._standby_signal)
996	                open(self._recovery_signal, 'w').close()
997	                self.set_file_permissions(self._recovery_signal)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:1039
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1038	                    for raw_line in lines:
1039	                        f.write(raw_line)
1040	            except Exception:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1101	        for la in listen_addresses:
1102	            if la.strip().lower() in ('*', '0.0.0.0', '127.0.0.1', 'localhost'):  # we are listening on '*' or localhost
1103	                return 'localhost'  # connection via localhost is preferred

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/config.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1101	        for la in listen_addresses:
1102	            if la.strip().lower() in ('*', '0.0.0.0', '127.0.0.1', 'localhost'):  # we are listening on '*' or localhost
1103	                return 'localhost'  # connection via localhost is preferred

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/postmaster.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
159	        try:
160	            self.send_signal(getattr(signal, 'SIG' + STOP_SIGNALS[mode]))
161	        except psutil.NoSuchProcess:

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/postmaster.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
247	        parent_conn, child_conn = ctx.Pipe(False)
248	        proc = ctx.Process(target=pg_ctl_start, args=(child_conn, cmdline, env))
249	        proc.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/rewind.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
315	                    self._checkpoint_task = CriticalTask()
316	                    Thread(target=self.__checkpoint, args=(self._checkpoint_task, wakeup)).start()
317	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/rewind.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
410	                for f in os.listdir(replslot_dir):
411	                    shutil.rmtree(os.path.join(replslot_dir, f))
412	                fsync_dir(replslot_dir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/rewind.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
546	            with open(os.path.join(self._postgresql.data_dir, 'postmaster.opts')) as f:
547	                data = f.read()
548	                for opt in data.split('" "'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/slots.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
483	        if not self._advance:
484	            self._advance = SlotsAdvanceThread(self)
485	        return self._advance.schedule(slots)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/slots.py:723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
722	                if os.path.exists(slot_tmp_dir):
723	                    shutil.rmtree(slot_tmp_dir)
724	                os.makedirs(slot_tmp_dir)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/slots.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
724	                os.makedirs(slot_tmp_dir)
725	                os.chmod(slot_tmp_dir, pg_perm.dir_create_mode)
726	                fsync_dir(slot_tmp_dir)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/slots.py:725
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
724	                os.makedirs(slot_tmp_dir)
725	                os.chmod(slot_tmp_dir, pg_perm.dir_create_mode)
726	                fsync_dir(slot_tmp_dir)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/slots.py:729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
728	                with open(slot_filename, 'wb') as f:
729	                    os.chmod(slot_filename, pg_perm.file_create_mode)
730	                    f.write(value['data'])

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/slots.py:729
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
728	                with open(slot_filename, 'wb') as f:
729	                    os.chmod(slot_filename, pg_perm.file_create_mode)
730	                    f.write(value['data'])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/slots.py:730
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
729	                    os.chmod(slot_filename, pg_perm.file_create_mode)
730	                    f.write(value['data'])
731	                    f.flush()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/slots.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
733	                if os.path.exists(slot_dir):
734	                    shutil.rmtree(slot_dir)
735	                os.rename(slot_tmp_dir, slot_dir)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/slots.py:736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
735	                os.rename(slot_tmp_dir, slot_dir)
736	                os.chmod(slot_dir, pg_perm.dir_create_mode)
737	                fsync_dir(slot_dir)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/postgresql/slots.py:736
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
735	                os.rename(slot_tmp_dir, slot_dir)
736	                os.chmod(slot_dir, pg_perm.dir_create_mode)
737	                fsync_dir(slot_dir)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/scripts/barman/cli.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	        required=True,
64	        help="URL to reach the pg-backup-api, e.g. 'http://localhost:7480'",
65	        dest="api_url",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/scripts/wale_restore.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	            with open(version_file) as f:
58	                return float(f.read())
59	        except Exception:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/utils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
42	
43	USER_AGENT = 'Patroni/{0} Python/{1} {2}'.format(__version__, platform.python_version(), platform.system())
44	OCT_RE = re.compile(r'^[-+]?0[0-7]*')

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/utils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
42	
43	USER_AGENT = 'Patroni/{0} Python/{1} {2}'.format(__version__, platform.python_version(), platform.system())
44	OCT_RE = re.compile(r'^[-+]?0[0-7]*')

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/utils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
42	
43	USER_AGENT = 'Patroni/{0} Python/{1} {2}'.format(__version__, platform.python_version(), platform.system())
44	OCT_RE = re.compile(r'^[-+]?0[0-7]*')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/utils.py:1043
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1042	            fd, tmpfile = tempfile.mkstemp(dir=d)
1043	            os.close(fd)
1044	            os.remove(tmpfile)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/validator.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
103	        raise ConfigParseError("contains a wrong value")
104	    if host in ["127.0.0.1", "0.0.0.0", "*", "::1", "localhost"]:
105	        raise ConfigParseError('must not contain "127.0.0.1", "0.0.0.0", "*", "::1", "localhost"')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/validator.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
103	        raise ConfigParseError("contains a wrong value")
104	    if host in ["127.0.0.1", "0.0.0.0", "*", "::1", "localhost"]:
105	        raise ConfigParseError('must not contain "127.0.0.1", "0.0.0.0", "*", "::1", "localhost"')

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/validator.py:153
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
152	            proto = socket.getaddrinfo(host, None, 0, socket.SOCK_STREAM, 0, socket.AI_PASSIVE)
153	            s = socket.socket(proto[0][0], socket.SOCK_STREAM)
154	            try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/validator.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
163	            finally:
164	                s.close()
165	    return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/validator.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
296	            with open(os.path.join(data_dir, "PG_VERSION"), "r") as version:
297	                pgversion = version.read().strip()
298	            waldir = ("pg_wal" if float(pgversion) >= 10 else "pg_xlog")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/watchdog/base.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
66	            return TestingWatchdogDevice.from_config(self.driver_config)
67	        elif platform.system() == 'Linux' and self.driver == 'default':
68	            from patroni.watchdog.linux import LinuxWatchdogDevice

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/watchdog/base.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
66	            return TestingWatchdogDevice.from_config(self.driver_config)
67	        elif platform.system() == 'Linux' and self.driver == 'default':
68	            from patroni.watchdog.linux import LinuxWatchdogDevice

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/watchdog/linux.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
153	            try:
154	                os.write(self._fd, b'V')
155	                os.close(self._fd)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/watchdog/linux.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
203	        try:
204	            os.write(self._fd, b'1')
205	        except OSError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/patroni/watchdog/linux.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
241	        while len(buf):
242	            buf = buf[os.write(self._fd, buf):]
243	        self.timeout = timeout

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/setup.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	LICENSE = 'The MIT License'
21	URL = 'https://github.com/patroni/patroni'
22	AUTHOR = 'Alexander Kukushkin, Polina Bungina'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/setup.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
157	    with open(os.path.join(__location__, fname), encoding='utf-8') as fd:
158	        return fd.read()
159	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/setup.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
175	    install_requires = []
176	    for r in read('requirements.txt').split('\n'):
177	        r = r.strip()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/setup.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	        keywords=KEYWORDS,
209	        long_description=read('README.rst'),
210	        classifiers=CLASSIFIERS,

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
30	    def get(*args):
31	        return psycopg_connect()
32	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
193	        super(MockRestApiServer, self).__init__(MockPatroni(), config)
194	        Handler(MockRequest(request), ('0.0.0.0', 8080), self)
195	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
411	    def test_do_GET_failsafe(self, mock_dcs):
412	        type(mock_dcs).failsafe = PropertyMock(return_value={'node1': 'http://foo:8080/patroni'})
413	        self.assertIsNotNone(MockRestApiServer(RestApiHandler, 'GET /failsafe'))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
446	        # empty request
447	        request = make_request('')
448	        MockRestApiServer(RestApiHandler, request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
449	        # invalid request
450	        request = make_request('foobar=baz')
451	        MockRestApiServer(RestApiHandler, request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
452	        # wrong role
453	        request = make_request(schedule=future_restart_time.isoformat(), role='unknown', postgres_version='9.5.3')
454	        MockRestApiServer(RestApiHandler, request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
455	        # wrong version
456	        request = make_request(schedule=future_restart_time.isoformat(), role='primary', postgres_version='9.5.3.1')
457	        MockRestApiServer(RestApiHandler, request)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
455	        # wrong version
456	        request = make_request(schedule=future_restart_time.isoformat(), role='primary', postgres_version='9.5.3.1')
457	        MockRestApiServer(RestApiHandler, request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
458	        # unknown filter
459	        request = make_request(schedule=future_restart_time.isoformat(), batman='lives')
460	        MockRestApiServer(RestApiHandler, request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
461	        # incorrect schedule
462	        request = make_request(schedule='2016-08-42 12:45TZ+1', role='primary')
463	        MockRestApiServer(RestApiHandler, request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
464	        # everything fine, but the schedule is missing
465	        request = make_request(role='primary', postgres_version='9.5.2')
466	        MockRestApiServer(RestApiHandler, request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
468	            with patch.object(MockHa, 'schedule_future_restart', Mock(return_value=retval)):
469	                request = make_request(schedule=future_restart_time.isoformat())
470	                MockRestApiServer(RestApiHandler, request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
471	            with patch.object(MockHa, 'restart', Mock(return_value=(retval, "foo"))):
472	                request = make_request(role='primary', postgres_version='9.5.2')
473	                MockRestApiServer(RestApiHandler, request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
475	        with patch.object(global_config.__class__, 'is_paused', PropertyMock(return_value=True)):
476	            MockRestApiServer(RestApiHandler, make_request(schedule='2016-08-42 12:45TZ+1', role='primary'))
477	            # Valid timeout

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
477	            # Valid timeout
478	            MockRestApiServer(RestApiHandler, make_request(timeout='60s'))
479	            # Invalid timeout

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
479	            # Invalid timeout
480	            MockRestApiServer(RestApiHandler, make_request(timeout='42towels'))
481	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
695	                                                  'ciphers': '!SSLv1:!SSLv2:!SSLv3:!TLSv1:!TLSv1.1',
696	                                                  'allowlist': ['127.0.0.1', '::1/128', '::1/zxc'],
697	                                                  'allowlist_include_members': True})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
711	        mock_dcs.cluster = get_cluster_initialized_without_leader()
712	        mock_dcs.cluster.members[1].data['api_url'] = 'http://127.0.0.1z:8011/patroni'
713	        mock_dcs.cluster.members.append(Member(0, 'bad-api-url', 30, {'api_url': 123}))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
714	        mock_rh = Mock()
715	        mock_rh.client_address = ('127.0.0.2',)
716	        self.assertIsNot(self.srv.check_access(mock_rh), True)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
716	        self.assertIsNot(self.srv.check_access(mock_rh), True)
717	        mock_rh.client_address = ('127.0.0.1',)
718	        mock_rh.request.getpeercert.return_value = None

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
724	        except Exception:
725	            self.assertIsNone(self.srv.handle_error(None, ('127.0.0.1', 55555)))
726	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:732
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
731	    def __create_socket(self):
732	        sock = socket.socket()
733	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
745	    def test_process_request_thread(self):
746	        self.srv.process_request_thread(self.__create_socket(), ('2', 54321))
747	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
745	    def test_process_request_thread(self):
746	        self.srv.process_request_thread(self.__create_socket(), ('2', 54321))
747	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_api.py:751
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
750	    def test_process_request_error(self, mock_get_request):
751	        mock_get_request.return_value = (self.__create_socket(), ('127.0.0.1', 55555))
752	        self.srv._handle_request_noblock()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_barman.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	API_URL = "http://localhost:7480"
16	BARMAN_SERVER = "my_server"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_barman.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	            str(exc.exception),
80	            "Failed to perform a GET request to http://localhost:7480/some/path"
81	        )
82	
83	    @patch.object(PgBackupApi, "_deserialize_response", Mock(return_value="test"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_barman.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
102	            str(exc.exception),
103	            f"Failed to perform a POST request to http://localhost:7480/some/path with {mock_serialize.return_value}"
104	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_barman.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	            str(exc.exception),
120	            "pg-backup-api is currently not up and running at http://localhost:7480: random",
121	        )
122	
123	    @patch("patroni.scripts.barman.utils.OperationStatus")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_config.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	            'PATRONI_ETCD_HOST': '127.0.0.1:2379',
59	            'PATRONI_ETCD_URL': 'https://127.0.0.1:2379',
60	            'PATRONI_ETCD_PROXY': 'http://127.0.0.1:2379',
61	            'PATRONI_ETCD_SRV': 'test',
62	            'PATRONI_ETCD_CACERT': '/cacert',
63	            'PATRONI_ETCD_CERT': '/cert',
64	            'PATRONI_ETCD_KEY': '/key',
65	            'PATRONI_CONSUL_HOST': '127.0.0.1:8500',
66	            'PATRONI_CONSUL_REGISTER_SERVICE': 'on',
67	            'PATRONI_KUBERNETES_LABELS': 'a: b: c',
68	            'PATRONI_KUBERNETES_SCOPE_LABEL': 'a',
69	            'PATRONI_KUBERNETES_PORTS': '[{"name": "postgresql"}]',
70	            'PATRONI_KUBERNETES_RETRIABLE_HTTP_CODES': '401',
71	            'PATRONI_ZOOKEEPER_HOSTS': "'host1:2181','host2:2181'",
72	            'PATRONI_EXHIBITOR_HOSTS': 'host1,host2',
73	            'PATRONI_EXHIBITOR_PORT': '8181',
74	            'PATRONI_RAFT_PARTNER_ADDRS': "'host1:1234','host2:1234'",
75	            'PATRONI_foo_HOSTS': '[host1,host2',  # Exception in parse_list
76	            'PATRONI_SUPERUSER_USERNAME': 'postgres',
77	            'PATRONI_SUPERUSER_PASSWORD': 'patroni',
78	            'PATRONI_REPLICATION_USERNAME': 'replicator',
79	            'PATRONI_REPLICATION_PASSWORD': 'rep-pass',
80	            'PATRONI_admin_PASSWORD': 'admin',
81	            'PATRONI_admin_OPTIONS': 'createrole,createdb',
82	            'PATRONI_POSTGRESQL_BIN_POSTGRES': 'sergtsop'
83	        })
84	        config = Config('postgres0.yml')
85	        self.assertEqual(config.local_configuration['log']['mode'], 0o123)
86	        with patch.object(Config, '_load_config_file', Mock(return_value={'restapi': {}})):
87	            with patch.object(Config, '_build_effective_configuration', Mock(side_effect=Exception)):
88	                config.reload_local_configuration()
89	            self.assertTrue(config.reload_local_configuration())
90	            self.assertIsNone(config.reload_local_configuration())
91	
92	    @patch('tempfile.mkstemp', Mock(return_value=[3000, 'blabla']))
93	    @patch('os.path.exists', Mock(return_value=True))
94	    @patch('os.remove', Mock(side_effect=IOError))
95	    @patch('os.close', Mock(side_effect=IOError))
96	    @patch('os.chmod', Mock())
97	    @patch('shutil.move', Mock(return_value=None))
98	    @patch('json.dump', Mock())
99	    def test_save_cache(self):
100	        self.config.set_dynamic_configuration({'ttl': 30, 'postgresql': {'foo': 'bar'}})
101	        with patch('os.fdopen', Mock(side_effect=IOError)):
102	            self.config.save_cache()
103	        with patch('os.fdopen', MagicMock()):
104	            self.config.save_cache()
105	
106	    def test_standby_cluster_parameters(self):
107	        dynamic_configuration = {
108	            'standby_cluster': {
109	                'create_replica_methods': ['wal_e', 'basebackup'],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_config.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	            'PATRONI_ETCD_URL': 'https://127.0.0.1:2379',
60	            'PATRONI_ETCD_PROXY': 'http://127.0.0.1:2379',
61	            'PATRONI_ETCD_SRV': 'test',
62	            'PATRONI_ETCD_CACERT': '/cacert',
63	            'PATRONI_ETCD_CERT': '/cert',
64	            'PATRONI_ETCD_KEY': '/key',
65	            'PATRONI_CONSUL_HOST': '127.0.0.1:8500',
66	            'PATRONI_CONSUL_REGISTER_SERVICE': 'on',
67	            'PATRONI_KUBERNETES_LABELS': 'a: b: c',
68	            'PATRONI_KUBERNETES_SCOPE_LABEL': 'a',
69	            'PATRONI_KUBERNETES_PORTS': '[{"name": "postgresql"}]',
70	            'PATRONI_KUBERNETES_RETRIABLE_HTTP_CODES': '401',
71	            'PATRONI_ZOOKEEPER_HOSTS': "'host1:2181','host2:2181'",
72	            'PATRONI_EXHIBITOR_HOSTS': 'host1,host2',
73	            'PATRONI_EXHIBITOR_PORT': '8181',
74	            'PATRONI_RAFT_PARTNER_ADDRS': "'host1:1234','host2:1234'",
75	            'PATRONI_foo_HOSTS': '[host1,host2',  # Exception in parse_list
76	            'PATRONI_SUPERUSER_USERNAME': 'postgres',
77	            'PATRONI_SUPERUSER_PASSWORD': 'patroni',
78	            'PATRONI_REPLICATION_USERNAME': 'replicator',
79	            'PATRONI_REPLICATION_PASSWORD': 'rep-pass',
80	            'PATRONI_admin_PASSWORD': 'admin',
81	            'PATRONI_admin_OPTIONS': 'createrole,createdb',
82	            'PATRONI_POSTGRESQL_BIN_POSTGRES': 'sergtsop'
83	        })
84	        config = Config('postgres0.yml')
85	        self.assertEqual(config.local_configuration['log']['mode'], 0o123)
86	        with patch.object(Config, '_load_config_file', Mock(return_value={'restapi': {}})):
87	            with patch.object(Config, '_build_effective_configuration', Mock(side_effect=Exception)):
88	                config.reload_local_configuration()
89	            self.assertTrue(config.reload_local_configuration())
90	            self.assertIsNone(config.reload_local_configuration())
91	
92	    @patch('tempfile.mkstemp', Mock(return_value=[3000, 'blabla']))
93	    @patch('os.path.exists', Mock(return_value=True))
94	    @patch('os.remove', Mock(side_effect=IOError))
95	    @patch('os.close', Mock(side_effect=IOError))
96	    @patch('os.chmod', Mock())
97	    @patch('shutil.move', Mock(return_value=None))
98	    @patch('json.dump', Mock())
99	    def test_save_cache(self):
100	        self.config.set_dynamic_configuration({'ttl': 30, 'postgresql': {'foo': 'bar'}})
101	        with patch('os.fdopen', Mock(side_effect=IOError)):
102	            self.config.save_cache()
103	        with patch('os.fdopen', MagicMock()):
104	            self.config.save_cache()
105	
106	    def test_standby_cluster_parameters(self):
107	        dynamic_configuration = {
108	            'standby_cluster': {
109	                'create_replica_methods': ['wal_e', 'basebackup'],
110	                'host': 'localhost',

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_config_generator.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
18	HOSTNAME = 'test_hostname'
19	IP = '1.9.8.4'
20	
21	
22	def mock_open(*args, **kwargs):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_config_generator.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
353	    def test_get_address(self):
354	        with patch('socket.getaddrinfo', Mock(side_effect=[[(2, 1, 6, '', ('127.0.0.1', 0))],
355	                                                           Exception])), \

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_config_generator.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
357	             patch('logging.warning') as mock_warning:
358	            self.assertEqual(get_address(), ('foo', '127.0.0.1'))
359	            self.assertEqual(get_address(), (NO_VALUE_MSG, NO_VALUE_MSG))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_consul.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	                  'Value': ('postgres://replicator:rep-pass@127.0.0.1:5432/postgres'
38	                            + '?application_name=http://127.0.0.1:8008/patroni').encode('utf-8')},
39	                 {'CreateIndex': 2630, 'Flags': 0, 'Key': key + 'members/postgresql1', 'LockIndex': 1,
40	                  'ModifyIndex': 2630, 'Session': 'fd4f44fe-2cac-bba5-a60b-304b51ff39b7',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_consul.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	                  'Value': ('postgres://replicator:rep-pass@127.0.0.1:5433/postgres'
42	                            + '?application_name=http://127.0.0.1:8009/patroni').encode('utf-8')},
43	                 {'CreateIndex': 1085, 'Flags': 0, 'Key': key + 'optime/leader', 'LockIndex': 0,
44	                  'ModifyIndex': 6429, 'Value': b'4496294792'},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_consul.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	        self.assertIsInstance(get_dcs({'ttl': 30, 'scope': 't', 'name': 'p', 'retry_timeout': 10,
106	                                       'consul': {'url': 'https://l:1', 'verify': 'on',
107	                                                  'key': 'foo', 'cert': 'bar', 'cacert': 'buz',
108	                                                  'token': 'asd', 'dc': 'dc1', 'register_service': True}}), Consul)
109	        self.assertIsInstance(get_dcs({'ttl': 30, 'scope': 't_', 'name': 'p', 'retry_timeout': 10,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_consul.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	        self.assertIsInstance(get_dcs({'ttl': 30, 'scope': 't_', 'name': 'p', 'retry_timeout': 10,
110	                                       'consul': {'url': 'https://l:1', 'verify': 'on',
111	                                                  'cert': 'bar', 'cacert': 'buz', 'register_service': True}}), Consul)
112	        self.c = get_dcs({'ttl': 30, 'scope': 'test', 'name': 'postgresql1', 'retry_timeout': 10,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_consul.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	            self.c.touch_member({'conn_url': 'postgres://replicator:rep-pass@127.0.0.1:5433/postgres',
159	                                 'api_url': 'http://127.0.0.1:8009/patroni'})
160	        self.c._register_service = True
161	        self.c.refresh_session = Mock(return_value=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_consul.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	    def test_update_service(self):
259	        d = {'role': 'replica', 'api_url': 'http://a/t', 'conn_url': 'pg://c:1', 'state': 'running'}
260	        self.assertIsNone(self.c.update_service({}, {}))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_consul.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
282	
283	        d = {'role': 'replica', 'api_url': 'http://a/t', 'conn_url': 'pg://c:1', 'state': 'running'}
284	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ctl.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
61	        runner = CliRunner()
62	        with runner.isolated_filesystem():
63	            self.assertRaises(PatroniCtlException, load_config, './non-existing-config-file', None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ctl.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	        cluster = get_cluster_initialized_with_leader(sync=('leader', 'other'))
242	        cluster.members.append(Member(0, 'async', 28, {'api_url': 'http://127.0.0.1:8012/patroni'}))
243	        cluster.config.data['synchronous_mode'] = True

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ctl.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
270	
271	        with self.runner.isolated_filesystem():
272	            with open('dummy', 'w') as dummy_file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ctl.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
272	            with open('dummy', 'w') as dummy_file:
273	                dummy_file.write('SELECT 1')
274	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ctl.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
480	        result = self.runner.invoke(ctl, ['list'])
481	        assert '127.0.0.1' in result.output
482	        assert result.exit_code == 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ctl.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
528	                                      {'conn_url': 'postgres://replicator:rep-pass@127.0.0.1:5437/postgres',
529	                                       'api_url': 'http://127.0.0.1:8012/patroni', 'state': 'running',
530	                                       'tags': {'replicatefrom': 'other'}}))
531	        cluster.members.append(Member(0, 'wrong_cascade', 28,
532	                                      {'conn_url': 'postgres://replicator:rep-pass@127.0.0.1:5438/postgres',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ctl.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
532	                                      {'conn_url': 'postgres://replicator:rep-pass@127.0.0.1:5438/postgres',
533	                                       'api_url': 'http://127.0.0.1:8013/patroni', 'state': 'running',
534	                                       'tags': {'replicatefrom': 'nonexistinghost'}}))
535	        with patch('patroni.dcs.AbstractDCS.get_cluster', Mock(return_value=cluster)):
536	            result = self.runner.invoke(ctl, ['topology', 'dummy'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	    if key in ['/service/test/leader', '/patroni/test/leader'] and \
36	            (kwargs.get('prevValue') == 'foo' or not kwargs.get('prevExist', True)):
37	        return True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	    if key in ['/service/test/leader', '/patroni/test/leader'] and \
36	            (kwargs.get('prevValue') == 'foo' or not kwargs.get('prevExist', True)):
37	        return True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	                     "value": "postgres://replicator:rep-pass@127.0.0.1:5434/postgres"
70	                     + "?application_name=http://127.0.0.1:8009/patroni",
71	                     "expiration": "2015-05-15T09:10:59.949384522Z", "ttl": 21,
72	                     "modifiedIndex": 20727, "createdIndex": 20727},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	                     "value": "postgres://replicator:rep-pass@127.0.0.1:5433/postgres"
75	                     + "?application_name=http://127.0.0.1:8008/patroni",
76	                     "expiration": "2015-05-15T09:11:09.611860899Z", "ttl": 30,
77	                     "modifiedIndex": 20730, "createdIndex": 20730}],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
101	    srv.target.to_text.return_value = \
102	        'localhost' if name in ['_etcd-server._tcp.foobar', '_etcd-server-baz._tcp.foobar'] else '127.0.0.1'
103	    return [srv]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
106	def socket_getaddrinfo(*args):
107	    if args[0] in ('ok', 'localhost', '127.0.0.1'):
108	        return [(socket.AF_INET, 1, 6, '', ('127.0.0.1', 0)), (socket.AF_INET6, 1, 6, '', ('::1', 0))]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
107	    if args[0] in ('ok', 'localhost', '127.0.0.1'):
108	        return [(socket.AF_INET, 1, 6, '', ('127.0.0.1', 0)), (socket.AF_INET6, 1, 6, '', ('::1', 0))]
109	    raise socket.gaierror

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	def http_request(method, url, **kwargs):
113	    if url == 'http://localhost:2379/timeout':
114	        raise ReadTimeoutError(None, None, None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
115	    ret = MockResponse()
116	    if url == 'http://localhost:2379/v2/machines':
117	        ret.content = 'http://localhost:2379,http://localhost:4001'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	    if url == 'http://localhost:2379/v2/machines':
117	        ret.content = 'http://localhost:2379,http://localhost:4001'
118	    elif url == 'http://localhost:4001/v2/machines':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	        ret.content = 'http://localhost:2379,http://localhost:4001'
118	    elif url == 'http://localhost:4001/v2/machines':
119	        ret.content = ''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	        ret.content = ''
120	    elif url != 'http://localhost:2379/':
121	        raise socket.error

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	    @patch.object(EtcdClient, '_get_machines_list',
145	                  Mock(return_value=['http://localhost:2379', 'http://localhost:4001']))
146	    def setUp(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	    @patch.object(EtcdClient, '_get_machines_list',
145	                  Mock(return_value=['http://localhost:2379', 'http://localhost:4001']))
146	    def setUp(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	    def test_machines(self):
155	        self.client._base_uri = 'http://localhost:4002'
156	        self.client._machines_cache = ['http://localhost:4002', 'http://localhost:2379']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	        self.client._base_uri = 'http://localhost:4002'
156	        self.client._machines_cache = ['http://localhost:4002', 'http://localhost:2379']
157	        self.assertIsNotNone(self.client.machines)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	        self.client._base_uri = 'http://localhost:4002'
156	        self.client._machines_cache = ['http://localhost:4002', 'http://localhost:2379']
157	        self.assertIsNotNone(self.client.machines)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	        self.assertIsNotNone(self.client.machines)
158	        self.client._base_uri = 'http://localhost:4001'
159	        self.client._machines_cache = ['http://localhost:4001']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	        self.client._base_uri = 'http://localhost:4001'
159	        self.client._machines_cache = ['http://localhost:4001']
160	        self.client._update_machines_cache = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	    def test_api_execute(self):
171	        self.client._base_uri = 'http://localhost:4001'
172	        self.assertRaises(etcd.EtcdException, self.client.api_execute, '/', 'POST', timeout=0)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	        self.assertRaises(etcd.EtcdException, self.client.api_execute, '/', 'POST', timeout=0)
173	        self.client._base_uri = 'http://localhost:4001'
174	        rtry = Retry(deadline=10, max_delay=1, max_tries=-1, retry_exceptions=(etcd.EtcdLeaderElectionInProgress,))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	    @patch.object(EtcdClient, '_get_machines_list',
169	                  Mock(return_value=['http://localhost:4001', 'http://localhost:2379']))
170	    def test_api_execute(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	    @patch.object(EtcdClient, '_get_machines_list',
169	                  Mock(return_value=['http://localhost:4001', 'http://localhost:2379']))
170	    def test_api_execute(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
210	        self.assertFalse(self.client._refresh_machines_cache())
211	        self.assertRaises(etcd.EtcdException, self.client._refresh_machines_cache, ['http://localhost:2379'])
212	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	    @patch.object(EtcdClient, '_get_machines_list',
242	                  Mock(return_value=['http://localhost:2379', 'http://localhost:4001']))
243	    def setUp(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	    @patch.object(EtcdClient, '_get_machines_list',
242	                  Mock(return_value=['http://localhost:2379', 'http://localhost:4001']))
243	    def setUp(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
257	        self.assertRaises(SleepException, self.etcd.get_etcd_client,
258	                          {'url': 'https://test:2379', 'retry_timeout': 10}, EtcdClient)
259	        self.assertRaises(SleepException, self.etcd.get_etcd_client,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
262	            self.assertRaises(SleepException, self.etcd.get_etcd_client,
263	                              {'proxy': 'https://user:password@test:2379', 'retry_timeout': 10}, EtcdClient)
264	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd3.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    elif url.endswith('/cluster/member/list'):
27	        ret.content = '{"members":[{"clientURLs":["http://localhost:2379", "http://localhost:4001"]}]}'
28	    elif url.endswith('/auth/authenticate'):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_etcd3.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
76	    def test_authenticate(self):
77	        etcd3 = Etcd3Client({'host': '127.0.0.1', 'port': 2379, 'use_proxies': True, 'retry_timeout': 10},
78	                            DnsCachingResolver())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    m1 = Member(0, 'leader', 28, {'conn_url': 'postgres://replicator:rep-pass@127.0.0.1:5435/postgres',
60	                                  'api_url': 'http://127.0.0.1:8008/patroni', 'xlog_location': 4,
61	                                  'role': 'primary', 'state': 'running'})
62	    leader = Leader(0, 0, m1 if leader else Member(0, '', 28, {}))
63	    m2 = Member(0, 'other', 28, {'conn_url': 'postgres://replicator:rep-pass@127.0.0.1:5436/postgres',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	    m2 = Member(0, 'other', 28, {'conn_url': 'postgres://replicator:rep-pass@127.0.0.1:5436/postgres',
64	                                 'api_url': 'http://127.0.0.1:8011/patroni',
65	                                 'state': 'running',
66	                                 'pause': True,
67	                                 'tags': {'clonefrom': True},
68	                                 'scheduled_restart': {'schedule': "2100-01-01 10:53:07.560445+00:00",
69	                                                       'postgres_version': '99.0.0'}})
70	    syncstate = SyncState(0 if sync else None, sync and sync[0], sync and sync[1], 0)
71	    failsafe = {m.name: m.api_url for m in (m1, m2)} if failsafe else None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	        self.replicatefrom = None
150	        self.api.connection_string = 'http://127.0.0.1:8008'
151	        self.clonefrom = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	        self.watchdog = Watchdog(self.config)
157	        self.request = lambda *args, **kwargs: requests_get(args[0].api_url, *args[1:], **kwargs)
158	        self.failover_priority = 1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
207	    @patch.object(etcd.Client, 'read', etcd_read)
208	    @patch.object(AbstractEtcdClientWithFailover, '_get_machines_list', Mock(return_value=['http://remotehost:2379']))
209	    @patch.object(Config, '_load_cache', Mock())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
267	    @patch.object(Cluster, 'get_clone_member',
268	                  Mock(return_value=Member(0, 'test', 1, {'api_url': 'http://127.0.0.1:8011/patroni',
269	                                                          'conn_url': 'postgres://127.0.0.1:5432/postgres'})))
270	    @patch.object(Bootstrap, 'create_replica', Mock(return_value=0))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
560	        global_config.update(self.ha.cluster)
561	        self.ha.update_failsafe({'name': 'leader', 'api_url': 'http://127.0.0.1:8008/patroni',
562	                                 'conn_url': 'postgres://127.0.0.1:5432/postgres', 'slots': {'foo': 1000}})
563	        self.p.is_primary = false

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
570	        self.ha.cluster = get_cluster_initialized_with_leader()
571	        self.ha.update_failsafe({'name': 'leader', 'api_url': 'http://127.0.0.1:8008/patroni',
572	                                 'conn_url': 'postgres://127.0.0.1:5432/postgres', 'slots': {'foo': 1000}})
573	        self.p.is_primary = false

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
581	    def test_call_failsafe_member(self):
582	        member = Member(0, 'test', 1, {'api_url': 'http://localhost:8011/patroni'})
583	        self.ha.patroni.request = Mock()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
588	            self.assertEqual(mock_logger.call_args_list[0][0],
589	                             ('Got response from %s %s: %s', 'test', 'http://localhost:8011/failsafe', 'Accepted'))
590	            self.assertTrue(ret.accepted)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
596	            self.assertEqual(mock_logger.call_args_list[0][0],
597	                             ('Request failed to %s: POST %s (%s)', 'test', 'http://localhost:8011/failsafe', e))
598	            self.assertFalse(ret.accepted)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
744	        self.ha.cluster = get_cluster_initialized_with_leader(Failover(0, '', 'b', None))
745	        self.ha.cluster.members.append(Member(0, 'b', 28, {'api_url': 'http://127.0.0.1:8011/patroni'}))
746	        self.assertEqual(self.ha.run_cycle(), 'manual failover: demoting myself')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
819	        self.ha.cluster = get_cluster_initialized_with_leader(Failover(0, self.p.name, 'b', scheduled))
820	        self.ha.cluster.members.append(Member(0, 'b', 28, {'api_url': 'http://127.0.0.1:8011/patroni'}))
821	        self.assertEqual('switchover: demoting myself', self.ha.run_cycle())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:834
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
833	            self.ha.cluster = get_cluster_initialized_with_leader(Failover(0, self.p.name, 'b', scheduled))
834	            self.ha.cluster.members.append(Member(0, 'b', 28, {'api_url': 'http://127.0.0.1:8011/patroni'}))
835	            self.assertEqual('no action. I am (postgresql0), the leader with the lock', self.ha.run_cycle())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
855	        self.ha.cluster = get_cluster_initialized_with_leader(Failover(0, None, 'b', None))
856	        self.ha.cluster.members.append(Member(0, 'b', 28, {'api_url': 'http://127.0.0.1:8011/patroni'}))
857	        self.assertEqual('PAUSE: manual failover: demoting myself', self.ha.run_cycle())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
870	        self.ha.cluster = get_cluster_initialized_with_leader(Failover(0, None, 'b', None), sync=(self.p.name, 'a'))
871	        self.ha.cluster.members.append(Member(0, 'b', 28, {'api_url': 'http://127.0.0.1:8011/patroni'}))
872	        self.assertEqual('manual failover: demoting myself', self.ha.run_cycle())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:895
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
894	                                                              sync=(self.p.name, 'a'))
895	        self.ha.cluster.members.append(Member(0, 'a', 28, {'api_url': 'http://127.0.0.1:8011/patroni'}))
896	        self.assertEqual('switchover: demoting myself', self.ha.run_cycle())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
936	            self.ha.cluster = get_cluster_initialized_without_leader(failover=Failover(0, '', 'b', None))
937	            self.ha.cluster.members.append(Member(0, 'b', 28, {'api_url': 'http://127.0.0.1:8011/patroni'}))
938	            self.ha.fetch_node_status = get_node_status(timeline=1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:1097
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1096	    def test_fetch_node_status(self):
1097	        member = Member(0, 'test', 1, {'api_url': 'http://127.0.0.1:8011/patroni'})
1098	        self.ha.fetch_node_status(member)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_ha.py:1099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1098	        self.ha.fetch_node_status(member)
1099	        member = Member(0, 'test', 1, {'api_url': 'http://localhost:8011/patroni'})
1100	        self.ha.patroni.request = Mock()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
55	                                              namespace='default', uid='964dfeae-e79b-4476-8a5a-1920b5c2a69d')
56	    address0 = k8s_client.V1EndpointAddress(ip='10.0.0.0', target_ref=target_ref)
57	    address1 = k8s_client.V1EndpointAddress(ip='10.0.0.1')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
56	    address0 = k8s_client.V1EndpointAddress(ip='10.0.0.0', target_ref=target_ref)
57	    address1 = k8s_client.V1EndpointAddress(ip='10.0.0.1')
58	    port = k8s_client.V1EndpointPort(port=5432, name='postgresql', protocol='TCP')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
74	                                       uid='964dfeae-e79b-4476-8a5a-1920b5c2a69d')
75	    status = k8s_client.V1PodStatus(pod_ip='10.0.0.1')
76	    spec = k8s_client.V1PodSpec(hostname='p-0', node_name='kind-control-plane', containers=[])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	def mock_load_k8s_config(self, *args, **kwargs):
88	    self._server = 'http://localhost'
89	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	            k8s_config.load_incluster_config()
106	            self.assertEqual(k8s_config.server, 'https://a:1')
107	            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer a')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	            "contexts": [{"name": "local", "context": {"user": "local", "cluster": "local"}}],
134	            "clusters": [{"name": "local", "cluster": {"server": "https://a:1/", "certificate-authority": "a"}}],
135	            "users": [{"name": "local", "user": {"username": "a", "password": "b", "client-certificate": "c"}}]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
138	            k8s_config.load_kube_config()
139	            self.assertEqual(k8s_config.server, 'https://a:1')
140	            self.assertEqual(k8s_config.pool_config, {'ca_certs': 'a', 'cert_file': 'c', 'cert_reqs': 'CERT_REQUIRED',

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
147	
148	        config["users"][0]["user"]["client-key-data"] = base64.b64encode(b'foobar').decode('utf-8')
149	        config["clusters"][0]["cluster"]["certificate-authority-data"] = base64.b64encode(b'foobar').decode('utf-8')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:148
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
147	
148	        config["users"][0]["user"]["client-key-data"] = base64.b64encode(b'foobar').decode('utf-8')
149	        config["clusters"][0]["cluster"]["certificate-authority-data"] = base64.b64encode(b'foobar').decode('utf-8')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
148	        config["users"][0]["user"]["client-key-data"] = base64.b64encode(b'foobar').decode('utf-8')
149	        config["clusters"][0]["cluster"]["certificate-authority-data"] = base64.b64encode(b'foobar').decode('utf-8')
150	        with patch('builtins.open', mock_open(read_data=json.dumps(config))), \

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:149
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
148	        config["users"][0]["user"]["client-key-data"] = base64.b64encode(b'foobar').decode('utf-8')
149	        config["clusters"][0]["cluster"]["certificate-authority-data"] = base64.b64encode(b'foobar').decode('utf-8')
150	        with patch('builtins.open', mock_open(read_data=json.dumps(config))), \

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
393	        self.assertEqual(args[2].subsets[0].addresses[0].target_ref.resource_version, '1')
394	        self.assertEqual(args[2].subsets[0].addresses[0].ip, '10.0.0.1')
395	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
401	    def setUp(self, config=None):
402	        super(TestKubernetesEndpoints, self).setUp({'use_endpoints': True, 'pod_ip': '10.0.0.0'})
403	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_kubernetes.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
409	        self.assertEqual(args[2].subsets[0].addresses[0].target_ref.resource_version, '10')
410	        self.assertEqual(args[2].subsets[0].addresses[0].ip, '10.0.0.0')
411	        self.k._kinds._object_cache['test'].subsets[:] = []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_patroni.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	    @patch.object(Thread, 'start', Mock())
80	    @patch.object(AbstractEtcdClientWithFailover, '_get_machines_list', Mock(return_value=['http://remotehost:2379']))
81	    @patch.object(Postgresql, '_get_gucs', Mock(return_value={'foo': True, 'bar': True}))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_patroni.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	    @patch.object(etcd.Client, 'delete', Mock())
113	    @patch.object(AbstractEtcdClientWithFailover, '_get_machines_list', Mock(return_value=['http://remotehost:2379']))
114	    @patch.object(Thread, 'join', Mock())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_patroni.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
306	            members=[Member(version=1, name="postgresql0", session=1, data={
307	                "api_url": "https://127.0.0.1:8008",
308	            })],
309	            **without_members

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postgresql.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
354	        with open(os.path.join(self.p.data_dir, 'postgresql.auto.conf'), 'w') as f:
355	            f.write(read_data)
356	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postgresql.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
460	        self.assertEqual(self.p.timeline_wal_position(), (1, 2, 1))
461	        Thread(target=self.p.timeline_wal_position).start()
462	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postgresql.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
737	            self.assertEqual(self.p.postmaster_start_time(), now.isoformat(sep=' '))
738	            t = Thread(target=self.p.postmaster_start_time)
739	            t.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postgresql.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
776	        state = {'sleeps': 0, 'num_rejects': 0, 'final_return': 0}
777	        self.__thread_ident = current_thread().ident
778	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postgresql.py:780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
779	        def increment_sleeps(*args):
780	            if current_thread().ident == self.__thread_ident:
781	                print("Sleep")

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
25	    def test_init(self):
26	        proc = PostmasterProcess(-123)
27	        self.assertTrue(proc.is_single_user)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
32	    def test_from_pidfile(self, mock_read, mock_init, mock_create_time):
33	        mock_init.side_effect = psutil.NoSuchProcess(123)
34	        mock_read.return_value = {}

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
61	    def test_from_pid(self, mock_init):
62	        mock_init.side_effect = psutil.NoSuchProcess(123)
63	        self.assertEqual(PostmasterProcess.from_pid(123), None)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
72	    def test_signal_kill(self, mock_kill, mock_children, mock_suspend):
73	        proc = PostmasterProcess(123)
74	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
76	        mock_children.return_value = [Mock()]
77	        mock_children.return_value[0].kill.side_effect = psutil.NoSuchProcess(123)
78	        self.assertTrue(proc.signal_kill())

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
80	        # postmaster has gone before suspend
81	        mock_suspend.side_effect = psutil.NoSuchProcess(123)
82	        self.assertTrue(proc.signal_kill())

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
85	        mock_suspend.side_effect = psutil.AccessDenied()
86	        mock_children.side_effect = psutil.NoSuchProcess(123)
87	        self.assertTrue(proc.signal_kill())

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
90	        mock_children.side_effect = psutil.AccessDenied()
91	        mock_kill.side_effect = psutil.NoSuchProcess(123)
92	        self.assertTrue(proc.signal_kill())

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
103	    def test_signal_stop(self, mock_send_signal):
104	        proc = PostmasterProcess(-123)
105	        self.assertEqual(proc.signal_stop('immediate'), False)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
106	
107	        mock_send_signal.side_effect = [None, psutil.NoSuchProcess(123), psutil.AccessDenied()]
108	        proc = PostmasterProcess(123)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
107	        mock_send_signal.side_effect = [None, psutil.NoSuchProcess(123), psutil.AccessDenied()]
108	        proc = PostmasterProcess(123)
109	        self.assertEqual(proc.signal_stop('immediate'), None)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
119	        mock_os.configure_mock(name="nt")
120	        proc = PostmasterProcess(-123)
121	        self.assertEqual(proc.signal_stop('immediate'), False)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
122	
123	        proc = PostmasterProcess(123)
124	        self.assertEqual(proc.signal_stop('immediate'), None)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
135	        c3 = Mock()
136	        c3.cmdline = Mock(side_effect=psutil.NoSuchProcess(123))
137	        c4 = Mock()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
140	        with patch('psutil.Process.children', Mock(return_value=[c1, c2, c3, c4])):
141	            proc = PostmasterProcess(123)
142	            self.assertIsNone(proc.wait_for_user_backends_to_close(1))

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
146	        with patch('psutil.Process.children', Mock(return_value=[c1, c2, c3, c4])):
147	            proc = PostmasterProcess(123)
148	            proc.wait_for_user_backends_to_close(1)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
149	
150	        with patch('psutil.Process.children', Mock(side_effect=psutil.NoSuchProcess(123))):
151	            proc = PostmasterProcess(123)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
150	        with patch('psutil.Process.children', Mock(side_effect=psutil.NoSuchProcess(123))):
151	            proc = PostmasterProcess(123)
152	            self.assertIsNone(proc.wait_for_user_backends_to_close(None))

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
166	
167	        mock_frompidfile.side_effect = psutil.NoSuchProcess(123)
168	        self.assertEqual(PostmasterProcess.start('true', '/tmp', '/tmp/test.conf', []), "proc 123")

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_postmaster.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
172	
173	    @patch('psutil.Process.__init__', Mock(side_effect=psutil.NoSuchProcess(123)))
174	    def test_read_postmaster_pidfile(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_validator.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    "etcd3": {
53	        "url": "https://127.0.0.1:2379"
54	    },
55	    "exhibitor": {
56	        "hosts": ["string"],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_validator.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
75	        "use_endpoints": False,
76	        "pod_ip": "127.0.0.1",
77	        "ports": [{"name": "string", "port": 1000}],
78	        "retriable_http_codes": [401],
79	    },
80	    "postgresql": {
81	        "listen": "127.0.0.2,::1:543",
82	        "connect_address": "127.0.0.2:543",
83	        "proxy_address": "127.0.0.2:5433",
84	        "authentication": {
85	            "replication": {"username": "user"},
86	            "superuser": {"username": "user"},

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_validator.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
160	
161	    if host == "127.0.0.1" or host == "" or host is None:
162	        return [(socket.AF_INET, socket.SOCK_STREAM, socket.IPPROTO_TCP, '', ('127.0.0.1', port))]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_validator.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
161	    if host == "127.0.0.1" or host == "" or host is None:
162	        return [(socket.AF_INET, socket.SOCK_STREAM, socket.IPPROTO_TCP, '', ('127.0.0.1', port))]
163	    elif host == "127.0.0.2":

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_validator.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
162	        return [(socket.AF_INET, socket.SOCK_STREAM, socket.IPPROTO_TCP, '', ('127.0.0.1', port))]
163	    elif host == "127.0.0.2":
164	        return [(socket.AF_INET, socket.SOCK_STREAM, socket.IPPROTO_TCP, '', ('127.0.0.2', port))]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_validator.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
163	    elif host == "127.0.0.2":
164	        return [(socket.AF_INET, socket.SOCK_STREAM, socket.IPPROTO_TCP, '', ('127.0.0.2', port))]
165	    elif host == "::1":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_watchdog.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
36	    dev = mock_devices[fd]
37	    sys.stderr.write("Ioctl %d %d %r\n" % (fd, op, arg))
38	    if op == linuxwd.WDIOC_GETSUPPORT:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_watchdog.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	    if op == linuxwd.WDIOC_GETSUPPORT:
39	        sys.stderr.write("Get support\n")
40	        assert (mutate_flag is True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_watchdog.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
45	    elif op == linuxwd.WDIOC_SETTIMEOUT:
46	        sys.stderr.write("Set timeout called with %s\n" % arg.value)
47	        assert 0 < arg.value < 65535

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patroni-4.0.5/patroni-4.0.5/tests/test_zookeeper.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
249	        self.zk.touch_member({'conn_url': 'postgres://repuser:rep-pass@localhost:5434/postgres',
250	                              'api_url': 'http://127.0.0.1:8009/patroni'})
251	
252	    @patch.object(MockKazooClient, 'create', Mock(side_effect=[RetryFailedError, Exception]))

--------------------------------------------------

Code scanned:
	Total lines of code: 33105
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 134.0
		High: 174.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 277.0
		High: 31.0
Files skipped (0):
