Run started:2025-04-12 10:27:44.349287

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
12	    argument_spec = dict(
13	        url=dict(required=False, default=os.environ.get('VAULT_ADDR', ''), type='str'),
14	        ca_cert=dict(required=False, default=os.environ.get('VAULT_CACERT', ''), type='str'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
13	        url=dict(required=False, default=os.environ.get('VAULT_ADDR', ''), type='str'),
14	        ca_cert=dict(required=False, default=os.environ.get('VAULT_CACERT', ''), type='str'),
15	        ca_path=dict(required=False, default=os.environ.get('VAULT_CAPATH', ''), type='str'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
14	        ca_cert=dict(required=False, default=os.environ.get('VAULT_CACERT', ''), type='str'),
15	        ca_path=dict(required=False, default=os.environ.get('VAULT_CAPATH', ''), type='str'),
16	        client_cert=dict(required=False, default=os.environ.get('VAULT_CLIENT_CERT', ''), type='str'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
15	        ca_path=dict(required=False, default=os.environ.get('VAULT_CAPATH', ''), type='str'),
16	        client_cert=dict(required=False, default=os.environ.get('VAULT_CLIENT_CERT', ''), type='str'),
17	        client_key=dict(required=False, default=os.environ.get('VAULT_CLIENT_KEY', ''), type='str'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
16	        client_cert=dict(required=False, default=os.environ.get('VAULT_CLIENT_CERT', ''), type='str'),
17	        client_key=dict(required=False, default=os.environ.get('VAULT_CLIENT_KEY', ''), type='str'),
18	        verify=dict(required=False, default=(not os.environ.get('VAULT_SKIP_VERIFY', '')), type='bool'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
17	        client_key=dict(required=False, default=os.environ.get('VAULT_CLIENT_KEY', ''), type='str'),
18	        verify=dict(required=False, default=(not os.environ.get('VAULT_SKIP_VERIFY', '')), type='bool'),
19	        authtype=dict(required=False, default=os.environ.get('VAULT_AUTHTYPE', 'token'), type='str'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
18	        verify=dict(required=False, default=(not os.environ.get('VAULT_SKIP_VERIFY', '')), type='bool'),
19	        authtype=dict(required=False, default=os.environ.get('VAULT_AUTHTYPE', 'token'), type='str'),
20	        login_mount_point=dict(required=False, default=os.environ.get('VAULT_LOGIN_MOUNT_POINT', None), type='str'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	        authtype=dict(required=False, default=os.environ.get('VAULT_AUTHTYPE', 'token'), type='str'),
20	        login_mount_point=dict(required=False, default=os.environ.get('VAULT_LOGIN_MOUNT_POINT', None), type='str'),
21	        token=dict(required=False, fallback=(hashivault_default_token, ''), type='str', no_log=True),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	        token=dict(required=False, fallback=(hashivault_default_token, ''), type='str', no_log=True),
22	        username=dict(required=False, default=os.environ.get('VAULT_USER', ''), type='str'),
23	        password=dict(required=False, fallback=(env_fallback, ['VAULT_PASSWORD']), type='str', no_log=True),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	        aws_header=dict(required=False, fallback=(env_fallback, ['VAULT_AWS_HEADER']), type='str', no_log=True),
27	        namespace=dict(required=False, default=os.environ.get('VAULT_NAMESPACE', None), type='str'),
28	        timeout=dict(required=False, default=30, type=int)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
50	    for key, value in options.items():
51	        config_type = documentation.get(key, {}).get('type')
52	        if config_type is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
50	    for key, value in options.items():
51	        config_type = documentation.get(key, {}).get('type')
52	        if config_type is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	        if config_type is None:
53	            module.warn('Unknown option "{}". Make sure this is not a typo, if it is not, please open an '
54	                        'issue at https://github.com/TerryHowe/ansible-modules-hashivault/issues.'.format(key))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	def get_ec2_iam_role():
72	    request = requests.get(url='http://169.254.169.254/latest/meta-data/iam/security-credentials/')
73	    request.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	def get_ec2_iam_role():
72	    request = requests.get(url='http://169.254.169.254/latest/meta-data/iam/security-credentials/')
73	    request.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	    role_name = get_ec2_iam_role()
79	    metadata_url = 'http://169.254.169.254/latest/meta-data/iam/security-credentials/{role}'.format(
80	        role=role_name

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	    )
82	    response = requests.get(url=metadata_url)
83	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	def hashivault_client(params):
95	    url = params.get('url')
96	    ca_cert = params.get('ca_cert')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	    url = params.get('url')
96	    ca_cert = params.get('ca_cert')
97	    ca_path = params.get('ca_path')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	    ca_cert = params.get('ca_cert')
97	    ca_path = params.get('ca_path')
98	    client_cert = params.get('client_cert')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	    ca_path = params.get('ca_path')
98	    client_cert = params.get('client_cert')
99	    client_key = params.get('client_key')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	    client_cert = params.get('client_cert')
99	    client_key = params.get('client_key')
100	    cert = (client_cert, client_key)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	    cert = (client_cert, client_key)
101	    check_verify = params.get('verify')
102	    namespace = params.get('namespace', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	    check_verify = params.get('verify')
102	    namespace = params.get('namespace', None)
103	    timeout = params.get('timeout')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	    namespace = params.get('namespace', None)
103	    timeout = params.get('timeout')
104	    if check_verify == '' or check_verify:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	def hashivault_auth(client, params):
118	    token = params.get('token')
119	    authtype = params.get('authtype')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	    token = params.get('token')
119	    authtype = params.get('authtype')
120	    login_mount_point = params.get('login_mount_point', authtype)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	    authtype = params.get('authtype')
120	    login_mount_point = params.get('login_mount_point', authtype)
121	    if not login_mount_point:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	        login_mount_point = authtype
123	    username = params.get('username')
124	    password = params.get('password')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
123	    username = params.get('username')
124	    password = params.get('password')
125	    secret_id = params.get('secret_id')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	    password = params.get('password')
125	    secret_id = params.get('secret_id')
126	    role_id = params.get('role_id')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	    secret_id = params.get('secret_id')
126	    role_id = params.get('role_id')
127	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
165	        with open(token_file, 'r') as f:
166	            return f.read().strip()
167	    return ''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
173	    client = hashivault_auth_client(params)
174	    version = params.get('version')
175	    mount_point = params.get('mount_point')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
174	    version = params.get('version')
175	    mount_point = params.get('mount_point')
176	    secret = params.get('secret')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	    mount_point = params.get('mount_point')
176	    secret = params.get('secret')
177	    secret_version = params.get('secret_version')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	    secret = params.get('secret')
177	    secret_version = params.get('secret_version')
178	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	
179	    key = params.get('key')
180	    default = params.get('default')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	    key = params.get('key')
180	    default = params.get('default')
181	    if secret.startswith('/'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
211	        try:
212	            data = response.get('data', {})
213	            metadata = data.get('metadata', {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	            data = response.get('data', {})
213	            metadata = data.get('metadata', {})
214	            data = data.get('data', {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	            metadata = data.get('metadata', {})
214	            data = data.get('data', {})
215	        except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
219	        metadata = {}
220	    lease_duration = response.get('lease_duration', None)
221	    if lease_duration is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	        result['lease_duration'] = lease_duration
223	    lease_id = response.get('lease_id', None)
224	    if lease_id is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	        result['lease_id'] = lease_id
226	    renewable = response.get('renewable', None)
227	    if renewable is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
228	        result['renewable'] = renewable
229	    wrap_info = response.get('wrap_info', None)
230	    if wrap_info is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/module_utils/hashivault.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
317	            v = desired_state[key]
318	            if ((key not in current_state) or (not _compare_state(v, current_state.get(key)))):
319	                return False

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_azure_auth_config.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	ANSIBLE_METADATA = {'status': ['stableinterface'], 'supported_by': 'community', 'version': '1.1'}
10	DOCUMENTATION = '''
11	---
12	module: hashivault_azure_auth_config
13	version_added: "3.17.7"
14	short_description: Hashicorp Vault azure auth config
15	description:
16	    - Module to configure an azure auth mount
17	options:
18	    mount_point:
19	        description:
20	            - name of the secret engine mount name.
21	        default: azure
22	    tenant_id:
23	        description:
24	            - azure SPN tenant id
25	    client_id:
26	        description:
27	            - azure SPN client id
28	    client_secret:
29	        description:
30	            - azure SPN client secret
31	    config_file:
32	        description:
33	            - alternate way to pass SPN vars. must be json object
34	    environment:
35	        description:
36	            - azure environment. default is likely OK
37	        default: AzurePublicCloud
38	    resource:
39	        description:
40	            - the azure AD resource the auth method accesses. default is likely OK
41	        default: https://management.azure.com
42	extends_documentation_fragment: hashivault
43	'''
44	EXAMPLES = '''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_azure_auth_config.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	    argspec['environment'] = dict(required=False, type='str', default='AzurePublicCloud')
65	    argspec['resource'] = dict(required=False, type='str', default='https://management.azure.com')
66	    argspec['config_file'] = dict(required=False, type='str', default=None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_db_secret_engine_config.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	ANSIBLE_METADATA = {'status': ['stableinterface'], 'supported_by': 'community', 'version': '1.1'}
10	DOCUMENTATION = '''
11	---
12	module: hashivault_db_secret_engine_config
13	version_added: "3.17.8"
14	short_description: Hashicorp Vault database secrets engine config
15	description:
16	    - Module to configure a database secrets engine
17	options:
18	    mount_point:
19	        description:
20	            - name of the secret engine mount name.
21	        default: database
22	    state:
23	        description:
24	            - should configuration be present or absent
25	        default: present
26	    config_file:
27	        description:
28	            - Optional location of file containing relevant db configuration info. use either this or the following
29	              ansible params in your play
30	    connection_details:
31	        description:
32	            - root level database credential for example username, password, connection_url.
33	    plugin_name:
34	        description:
35	            - name of database plugin used. see out of the box list at
36	              https://www.vaultproject.io/docs/secrets/databases/index.html
37	    plugin_version:
38	        description:
39	            - Specifies the semantic version of the plugin to use for this connection
40	              https://developer.hashicorp.com/vault/api-docs/secret/databases
41	    allowed_roles:
42	        description:
43	            - list of the roles allowed to use this connection. Defaults to empty (no roles), if contains a "*" any role
44	              can use this connection.
45	        default: []
46	    verify_connection:
47	        description:
48	            - Specifies if the connection is verified during initial configuration. Defaults to true.
49	        default: true
50	    root_credentials_rotate_statements:
51	        description:
52	            - Specifies the database statements to be executed to rotate the root user's credentials. See the plugin's
53	              API page for more information on support and formatting for this parameter.
54	        default: []
55	        aliases: [ root_rotation_statements ]
56	    password_policy:
57	        description:
58	            - The name of the password policy to use when generating passwords for this database. If not specified,
59	              this will use a default policy defined as 20 characters with at least 1 uppercase, 1 lowercase, 1 number,
60	              and 1 dash character.
61	extends_documentation_fragment: hashivault
62	'''
63	EXAMPLES = '''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_db_secret_engine_config.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	'''
63	EXAMPLES = '''
64	---
65	- hosts: localhost
66	  tasks:
67	    - hashivault_db_secret_engine_config:
68	        name: test
69	        plugin_name: "postgresql-database-plugin" #https://www.vaultproject.io/docs/secrets/databases/index.html
70	        allowed_roles: ["my-role"]
71	        connection_details:
72	            username: "myuser@dbname"
73	            password: "P@ssw0rd"
74	            connection_url: "postgresql://{{'{{username}}'}}:{{'{{password}}'}}@blergh-db.com:5230"
75	        state: "present
76	
77	    - hashivault_db_secret_engine_config:
78	        name: test
79	        config_file: /users/drewbuntu/my-db-config.json
80	'''
81	
82	
83	def main():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_identity_group.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	    client = hashivault_auth_client(params)
201	    group_id = params.get('id')
202	    group_name = params.get('name')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_identity_group.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	    group_id = params.get('id')
202	    group_name = params.get('name')
203	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_identity_group.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	def hashivault_identity_group(params):
223	    state = params.get('state')
224	    if state == 'present':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_jwt_auth_method_config.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	'''
63	EXAMPLES = '''
64	---
65	- hosts: localhost
66	  tasks:
67	    - hashivault_jwt_auth_method_config:
68	        oidc_discovery_url: "https://accounts.google.com"
69	        oidc_client_id: "123456"
70	        oidc_client_secret: "123456"
71	        default_role: "gmail"
72	'''
73	
74	
75	def main():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_jwt_auth_role.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	'''
94	EXAMPLES = '''
95	---
96	- hosts: localhost
97	  tasks:
98	    - hashivault_jwt_auth_role:
99	        name: "gmail"
100	        bound_audiences: ["123-456.apps.googleusercontent.com"]
101	        allowed_redirect_uris: ["https://vault.com:8200/ui/vault/auth/jwt/oidc/callback"]
102	        token_policies: ["test"]
103	
104	- hosts: localhost
105	  tasks:
106	    - hashivault_jwt_auth_role:
107	        name: nested_ns_role
108	        bound_audiences: ["123-456.apps.googleusercontent.com"]
109	        allowed_redirect_uris: ["https://vault.com:8200/ui/jwt/oidc/callback?namespace=namespaceone%2Fnamespacetwo"]
110	        token_policies: ["test"]
111	'''
112	
113	
114	def main():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_k8s_auth_config.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	'''
42	EXAMPLES = '''
43	---
44	- hosts: localhost
45	  tasks:
46	    - hashivault_k8s_auth_config:
47	        kubernetes_host: https://192.168.99.100:8443
48	        kubernetes_ca_cert: "-----BEGIN CERTIFICATE-----\n.....\n-----END CERTIFICATE-----"
49	'''
50	
51	
52	def main():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_oidc_auth_method_config.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	'''
63	EXAMPLES = '''
64	---
65	- hosts: localhost
66	  tasks:
67	    - hashivault_oidc_auth_method_config:
68	        oidc_discovery_url: "https://accounts.google.com"
69	        oidc_client_id: "123456"
70	        oidc_client_secret: "123456"
71	        default_role: "gmail"
72	'''
73	
74	
75	def main():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_oidc_auth_role.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	'''
94	EXAMPLES = '''
95	---
96	- hosts: localhost
97	  tasks:
98	    - hashivault_oidc_auth_role:
99	        name: "gmail"
100	        bound_audiences: ["123-456.apps.googleusercontent.com"]
101	        allowed_redirect_uris: ["https://vault.com:8200/ui/vault/auth/oidc/oidc/callback"]
102	        token_policies: ["test"]
103	
104	- hosts: localhost
105	  tasks:
106	    - hashivault_oidc_auth_role:
107	        name: nested_ns_role
108	        bound_audiences: ["123-456.apps.googleusercontent.com"]
109	        allowed_redirect_uris: ["https://vault.com:8200/ui/oidc/oidc/callback?namespace=namespaceone%2Fnamespacetwo"]
110	        token_policies: ["test"]
111	'''
112	
113	
114	def main():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_pki_ca.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	ANSIBLE_METADATA = {'status': ['preview'], 'supported_by': 'community', 'version': '1.1'}
9	DOCUMENTATION = r'''
10	---
11	module: hashivault_pki_ca
12	version_added: "4.5.0"
13	short_description: Hashicorp Vault PKI Generate Root/Intermediate
14	description:
15	    - 'WARNING: if king is `intermediate` and signed CSR have not been inported back to vault, module will regenerate
16	      private key and create new CSR.'
17	    - This module generates a new private key and a CSR for signing or a new self-signed CA certificate and private key.
18	    - If using Vault as a root, and for many other CAs, the various parameters on the final certificate are set at
19	      signing time and may or may not honor the parameters set here.
20	    - This will overwrite any previously existing CA private key.
21	    - This is mostly meant as a helper function, and not all possible parameters that can be set in a CSR are supported.
22	options:
23	    mount_point:
24	        default: pki
25	        description:
26	            - location where secrets engine is mounted. also known as path
27	    type:
28	        type: str
29	        choices: ["exported", "internal"]
30	        default: internal
31	        description:
32	            - Specifies the type of the root to create, If `exported`, the private key will be returned in the
33	              response;
34	            - If it is `internal` the private key will not be returned and cannot be retrieved later.
35	    common_name:
36	        type: str
37	        description:
38	            - Specifies the requested CN for the certificate. [required]
39	    kind:
40	        type: str
41	        choices: ["root", "intermediate"]
42	        default: root
43	        description:
44	            - Specifies the kind of CA certificate.
45	    state:
46	        type: str
47	        choices: ["present", "absent"]
48	        default: present
49	        description:
50	            - Do you want for this config to be present or absent
51	    config:
52	        description:
53	            - Collection of properties for pki generate root. Ref.
54	              U(https://www.vaultproject.io/api-docs/secret/pki#generate-root)
55	        type: dict
56	        suboptions:
57	            alt_names:
58	                type: str
59	                description:
60	                    - Specifies the requested Subject Alternative Names, in a comma-delimited list.
61	                    - These can be host names or email addresses; they will be parsed into their respective fields.
62	            ip_sans:
63	                type: str
64	                description:
65	                    - Specifies the requested IP Subject Alternative Names, in a comma-delimited list.
66	            uri_sans:
67	                type: str
68	                description:
69	                    - Specifies the requested URI Subject Alternative Names, in a comma-delimited list.
70	            other_sans:
71	                type: str
72	                description:
73	                    - Specifies custom OID/UTF8-string SANs.
74	                    - These must match values specified on the role in `allowed_other_sans` (see role creation for
75	                      allowed_other_sans globbing rules).
76	                    - The format is the same as OpenSSL `<oid>;<type>:<value>` where the only current valid type is
77	                      `UTF8`
78	                    - This can be a comma-delimited list or a JSON string slice.
79	            ttl:
80	                type: str
81	                description:
82	                    - Specifies the requested Time To Live (after which the certificate will be expired).
83	                    - This cannot be larger than the engine's max (or, if not set, the system max).
84	            format:
85	                type: str
86	                default: "pem"
87	                choice: ["pem", "der", "pem_bundle"]
88	                description:
89	                    - Specifies the format for returned data.
90	                    - If `der`, the output is base64 encoded.
91	                    - If `pem_bundle`, the `certificate` field will contain the private key (if exported) and
92	                      certificate, concatenated;
93	                    - if the issuing CA is not a Vault-derived self-signed root, this will be included as well.
94	            private_key_format:
95	                type: str
96	                default: der
97	                description:
98	                    - Specifies the format for marshaling the private key.
99	                    - Defaults to `der` which will return either base64-encoded DER or PEM-encoded DER, depending on
100	                      the value of `format`.
101	                    - The other option is `pkcs8` which will return the key marshalled as PEM-encoded PKCS8
102	            key_type:
103	                type: str
104	                default: "rsa"
105	                choice: ["rsa", "ec"]
106	                description:
107	                    - Specifies the desired key type.
108	            key_bits:
109	                type: int
110	                default: 2048
111	                description:
112	                    - Specifies the number of bits to use
113	            max_path_length:
114	                type: int
115	                default: -1
116	                description:
117	                    - Specifies the maximum path length to encode in the generated certificate.
118	                    - A limit of `-1` means no limit.
119	                    - Unless the signing certificate has a maximum path length set, in which case the path length is set
120	                      to one less than that of the signing certificate.
121	                    - A limit of `0` means a literal path length of zero.
122	            exclude_cn_from_sans:
123	                type: bool
124	                default: false
125	                description:
126	                    - If set, the given `common_name` will not be included in DNS or Email Subject Alternate Names (as
127	                      appropriate).
128	                    - Useful if the CN is not a hostname or email address, but is instead some human-readable
129	                      identifier.
130	            permitted_dns_domains:
131	                type: list
132	                description:
133	                    - A list containing DNS domains for which certificates are allowed to be issued or signed by this CA
134	                      certificate.
135	                    - Note that subdomains are allowed, as per U(https://tools.ietf.org/html/rfc5280#section-4.2.1.10).
136	            ou:
137	                type: list
138	                description:
139	                    - Specifies the `OU` (OrganizationalUnit) values in the subject field of the resulting certificate.
140	            organization:
141	                type: list
142	                description:
143	                    - Specifies the `O` (Organization) values in the subject field of the resulting certificate.
144	            country:
145	                type: list
146	                description:
147	                    - Specifies the `C` (Country) values in the subject field of the resulting certificate.
148	            locality:
149	                type: list
150	                description:
151	                    - Specifies the `L` (Locality) values in the subject field of the resulting certificate.
152	            province:
153	                type: list
154	                description:
155	                    - Specifies the `ST` (Province) values in the subject field of the resulting certificate.
156	            street_address:
157	                type: list
158	                description:
159	                    - Specifies the Street Address values in the subject field of the resulting certificate.
160	            postal_code:
161	                type: list
162	                description:
163	                    - Specifies the Postal Code values in the subject field of the resulting certificate.
164	            serial_number:
165	                type: string
166	                description:
167	                    - Specifies the Serial Number, if any.
168	                    - Otherwise Vault will generate a random serial for you.
169	                    - If you want more than one, specify alternative names in the alt_names map using OID 2.5.4.5.
170	extends_documentation_fragment:
171	    - hashivault
172	'''
173	EXAMPLES = r'''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_pki_cert_issue.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	ANSIBLE_METADATA = {'status': ['preview'], 'supported_by': 'community', 'version': '1.1'}
9	DOCUMENTATION = r'''
10	---
11	module: hashivault_pki_cert_issue
12	version_added: "4.5.0"
13	short_description: Hashicorp Vault PKI Generate Certificate
14	description:
15	    - This module generates a new set of credentials (private key and certificate) based on the role named in the
16	      module.
17	    - The issuing CA certificate is returned as well, so that only the root CA need be in a client's trust store.
18	options:
19	    role:
20	        recuired: true
21	        description:
22	            - Specifies the name of the role to create.
23	    common_name:
24	        recuired: true
25	        description:
26	            - Specifies the requested CN for the certificate. If the CN is allowed by role policy, it will be issued.
27	    mount_point:
28	        default: pki
29	        description:
30	            - location where secrets engine is mounted. also known as path
31	    extra_params:
32	        description:
33	            - "Collection of properties from pki role U(https://www.vaultproject.io/api-docs/secret/pki#parameters-6)"
34	        type: dict
35	        suboptions:
36	        alt_names:
37	            type: string
38	            description:
39	                - Specifies requested Subject Alternative Names, in a comma-delimited list. These can be host names or
40	                  email addresses; they will be parsed into their respective fields. If any requested names do not match
41	                  role policy, the entire request will be denied.
42	        ip_sans:
43	            type: string
44	            description:
45	                - Specifies requested IP Subject Alternative Names, in a comma-delimited list. Only valid if the role
46	                  allows IP SANs (which is the default).
47	        uri_sans:
48	            type: string
49	            description:
50	                - Specifies the requested URI Subject Alternative Names, in a comma-delimited list.
51	        other_sans:
52	            type: string
53	            description:
54	                - Specifies custom OID/UTF8-string SANs. These must match values specified on the role in
55	                  allowed_other_sans (see role creation for allowed_other_sans globbing rules). The format is the same
56	                  as OpenSSL <oid>;<type>:<value> where the only current valid type is UTF8. This can be a
57	                  comma-delimited list or a JSON string slice.
58	        ttl:
59	            type: string
60	            description:
61	                - Specifies requested Time To Live. Cannot be greater than the role's max_ttl value. If not provided,
62	                  the role's ttl value will be used. Note that the role values default to system values if not
63	                  explicitly set.
64	        format:
65	            type: string
66	            description:
67	                - Specifies the format for returned data. Can be pem, der, or pem_bundle; defaults to pem. If der, the
68	                  output is base64 encoded. If pem_bundle, the certificate field will contain the private key and
69	                  certificate, concatenated; if the issuing CA is not a Vault-derived self-signed root, this will be
70	                  included as well.
71	        private_key_format:
72	            type: string
73	            description:
74	                - Specifies the format for marshaling the private key. Defaults to der which will return either
75	                  base64-encoded DER or PEM-encoded DER, depending on the value of format. The other option is pkcs8
76	                  which will return the key marshalled as PEM-encoded PKCS8.
77	        exclude_cn_from_sans:
78	            type: bool
79	            description:
80	                - If true, the given common_name will not be included in DNS or Email Subject Alternate Names
81	                  (as appropriate). Useful if the CN is not a hostname or email address, but is instead some
82	                  human-readable identifier.
83	extends_documentation_fragment:
84	    - hashivault
85	'''
86	
87	EXAMPLES = r'''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_pki_role.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	ANSIBLE_METADATA = {'status': ['preview'], 'supported_by': 'community', 'version': '1.1'}
11	DOCUMENTATION = r'''
12	---
13	module: hashivault_pki_role
14	version_added: "4.5.0"
15	short_description: Hashicorp Vault PKI Create/Update/Delete Role
16	description:
17	    - This module creates or updates the role definition.
18	    - Note that the `allowed_domains`, `allow_subdomains`, `allow_glob_domains`, and `allow_any_name` attributes are
19	      additive; between them nearly and across multiple roles nearly any issuing policy can be accommodated.
20	      `server_flag`, `client_flag`, and `code_signing_flag` are additive as well.
21	    - If a client requests a certificate that is not allowed by the CN policy in the role, the request is denied.
22	options:
23	    mount_point:
24	        default: pki
25	        description:
26	            - location where secrets engine is mounted. also known as path
27	    name:
28	        recuired: true
29	        description:
30	            - Specifies the name of the role to create.
31	    role_file:
32	        description:
33	            - file with a json object containing play parameters. pass all params but name, state, mount_point which
34	              stay in the ansible play
35	    state:
36	        description:
37	            - Do you want for this config to be present or absent
38	        choices: ["present", "absent"]
39	        default: present
40	    config:
41	        type: dict
42	        description:
43	            - Collection of properties from pki role
44	              U(https://www.vaultproject.io/api-docs/secret/pki#create-update-role)
45	        suboptions:
46	            ttl:
47	                type: str
48	                description:
49	                    - Specifies the Time To Live value provided as a string duration with time suffix.
50	                    - Hour is the largest suffix.
51	                    - If not set, uses the system default value or the value of `max_ttl`, whichever is shorter.
52	            max_ttl:
53	                type: str
54	                description:
55	                    - Specifies the maximum Time To Live value provided as a string duration with time suffix.
56	                    - Hour is the largest suffix.
57	                    - If not set, defaults to the system maximum lease TTL.
58	            allow_localhost:
59	                type: bool
60	                default: true
61	                description:
62	                    - Specifies if clients can request certificates for `localhost` as one of the requested common
63	                      names.
64	                    - This is useful for testing and to allow clients on a single host to talk securely.
65	            allowed_domains:
66	                type: list
67	                description:
68	                    - Specifies the domains of the role.
69	                    - This is used with the `allow_bare_domains` and `allow_subdomains` options.
70	            allowed_domains_template:
71	                type: bool
72	                default: false
73	                description:
74	                    - When set, `allowed_domains` may contain templates, as with
75	                      [ACL Path Templating](https://www.vaultproject.io/docs/concepts/policies).
76	            allow_bare_domains:
77	                type: bool
78	                default: false
79	                description:
80	                    - Specifies if clients can request certificates matching the value of the actual domains themselves.
81	                    - e.g. if a configured domain set with `allowed_domains` is `example.com`, this allows clients to
82	                      actually request a certificate containing the name `example.com` as one of the DNS values on the
83	                      final certificate. In some scenarios, this can be considered a security risk.
84	            allow_subdomains:
85	                type: bool
86	                default: false
87	                description:
88	                    - Specifies if clients can request certificates with CNs that are subdomains of the CNs allowed by
89	                      the other role options. This includes wildcard subdomains.
90	                    - For example, an `allowed_domains` value of `example.com` with this option set to true will allow
91	                      `foo.example.com` and `bar.example.com` as well as `*.example.com`.
92	                    - This is redundant when using the `allow_any_name` option.
93	            allow_glob_domains:
94	                type: bool
95	                default: false
96	                description:
97	                    - Allows names specified in `allowed_domains` to contain glob patterns (e.g. `ftp*.example.com`)
98	                    - Clients will be allowed to request certificates with names matching the glob patterns.
99	            allow_any_name:
100	                type: bool
101	                default: false
102	                description:
103	                    - Specifies if clients can request any CN
104	                    - Useful in some circumstances, but make sure you understand whether it is appropriate for your
105	                      installation before enabling it.
106	            enforce_hostnames:
107	                type: bool
108	                default: true
109	                description:
110	                    - Specifies if only valid host names are allowed for CNs, DNS SANs, and the host part of email
111	                      addresses.
112	            allow_ip_sans:
113	                type: bool
114	                default: true
115	                description:
116	                    - Specifies if clients can request IP Subject Alternative Names
117	                    - No authorization checking is performed except to verify that the given values are valid IP
118	                      addresses.
119	            allowed_uri_sans:
120	                type: list
121	                description:
122	                    - Defines allowed URI Subject Alternative Names
123	                    - No authorization checking is performed except to verify that the given values are valid URIs
124	                    - Values can contain glob patterns (e.g. `spiffe://hostname/*`).
125	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
126	                      not do so as it would break idempotency.
127	            allowed_other_sans:
128	                type: list
129	                description:
130	                    - Defines allowed custom OID/UTF8-string SANs
131	                    - Each item of the list has the same format as OpenSSL `<oid>;<type>:<value>`, but the only valid
132	                      type is `UTF8` or `UTF-8`.
133	                    - The `value` part of an element may be a `*` to allow any value with that OID
134	                    - Alternatively, specifying a single `*` will allow any `other_sans` input. `server_flag`
135	                      `(bool)` Specifies if certificates are flagged for server use.
136	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
137	                      not do so as it would break idempotency.
138	            server_flag:
139	                type: bool
140	                default: true
141	                description:
142	                    - Specifies if certificates are flagged for server use.
143	            client_flag:
144	                type: bool
145	                default: true
146	                description:
147	                    - Specifies if certificates are flagged for client use.
148	            code_signing_flag:
149	                type: bool
150	                default: false
151	                description:
152	                    - Specifies if certificates are flagged for code signing use.
153	            email_protection_flag:
154	                type: bool
155	                default: false
156	                description:
157	                    - Specifies if certificates are flagged for email protection use.
158	            key_type:
159	                type: str
160	                default: "rsa"
161	                description:
162	                    - Specifies the type of key to generate for generated private keys and the type of key expected for
163	                      submitted CSRs
164	                    - Currently, `rsa` and `ec` are supported, or when signing CSRs `any` can be specified to allow
165	                      keys of either type and with any bit size (subject to > 1024 bits for RSA keys).
166	            key_bits:
167	                type: int
168	                default: 2048
169	                description:
170	                    - Specifies the number of bits to use for the generated keys
171	                    - This will need to be changed for `ec` keys, e.g., 224 or 521.
172	            key_usage:
173	                type: list
174	                default: ["DigitalSignature", "KeyAgreement", "KeyEncipherment"]
175	                description:
176	                    - Specifies the allowed key usage constraint on issued certificates
177	                    - Valid values can be found at U(https://golang.org/pkg/crypto/x509/#KeyUsage) - simply drop the
178	                      `KeyUsage` part of the value
179	                    - Values are not case-sensitive
180	                    - To specify no key usage constraints, set this to an empty list.
181	            ext_key_usage:
182	                type: list
183	                description:
184	                    - Specifies the allowed extended key usage constraint on issued certificates
185	                    - Valid values can be found at U(https://golang.org/pkg/crypto/x509/#ExtKeyUsage) - simply drop the
186	                      `ExtKeyUsage` part of the value
187	                    - Values are not case-sensitive
188	                    - To specify no key usage constraints, set this to an empty list.
189	            ext_key_usage_oids:
190	                type: list
191	                description:
192	                    - List of extended key usage oids.
193	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
194	                      not do so as it would break idempotency.
195	            use_csr_common_name:
196	                type: bool
197	                default: true
198	                description:
199	                    - When used with the CSR signing endpoint, the common name in the CSR will be used instead of taken
200	                      from the JSON data
201	                    - This does `not` include any requested SANs in the CSR; use `use_csr_sans` for that.
202	            use_csr_sans:
203	                type: bool
204	                default: true
205	                description:
206	                    - When used with the CSR signing endpoint, the subject alternate names in the CSR will be used
207	                      instead of taken from the JSON data
208	                    - This does `not` include the common name in the CSR; use `use_csr_common_name` for that.
209	            ou:
210	                type: list
211	                description:
212	                    - Specifies the OU (OrganizationalUnit) values in the subject field of issued certificates.
213	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
214	                      not do so as it would break idempotency.
215	            organization:
216	                type: list
217	                description:
218	                    - Specifies the O (Organization) values in the subject field of issued certificates
219	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
220	                      not do so as it would break idempotency.
221	            country:
222	                type: list
223	                description:
224	                    - Specifies the C (Country) values in the subject field of issued certificates
225	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
226	                      not do so as it would break idempotency.
227	            locality:
228	                type: list
229	                description:
230	                    - Specifies the L (Locality) values in the subject field of issued certificates
231	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
232	                      not do so as it would break idempotency.
233	            province:
234	                type: list
235	                description:
236	                    - Specifies the ST (Province) values in the subject field of issued certificates
237	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
238	                      not do so as it would break idempotency.
239	            street_address:
240	                type: list
241	                description:
242	                    - Specifies the Street Address values in the subject field of issued certificates
243	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
244	                      not do so as it would break idempotency.
245	            postal_code:
246	                type: list
247	                description:
248	                    - Specifies the Postal Code values in the subject field of issued certificates
249	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
250	                      not do so as it would break idempotency.
251	            serial_number:
252	                type: str
253	                description:
254	                    - Specifies the Serial Number, if any
255	                    - Otherwise Vault will generate a random serial for you
256	                    - If you want more than one, specify alternative names in the alt_names map using OID 2.5.4.5.
257	            generate_lease:
258	                type: bool
259	                default: false
260	                description:
261	                    - Specifies if certificates issued/signed against this role will have Vault leases attached to them
262	                    - Certificates can be added to the CRL by `vault revoke <lease_id>` when certificates are
263	                      associated with leases
264	                    - It can also be done using the `pki/revoke` endpoint
265	                    - However, when lease generation is disabled, invoking `pki/revoke` would be the only way to add
266	                      the certificates to the CRL.
267	            no_store:
268	                type: bool
269	                default: false
270	                description:
271	                    - If set, certificates issued/signed against this role will not be stored in the storage backend
272	                    - This can improve performance when issuing large numbers of certificates
273	                    - However, certificates issued in this way cannot be enumerated or revoked, so this option is
274	                      recommended only for certificates that are non-sensitive, or extremely short-lived
275	                    - This option implies a value of `false` for `generate_lease`.
276	            require_cn:
277	                type: bool
278	                default: true
279	                description:
280	                    - If set to false, makes the `common_name` field optional while generating a certificate.
281	            policy_identifiers:
282	                type: list
283	                description:
284	                    - A comma-separated string or list of policy OIDs.
285	                    - Although this parameter could take a string with comma-delimited items, it's highly advised to
286	                      not do so as it would break idempotency.
287	            basic_constraints_valid_for_non_ca:
288	                type: bool
289	                default: false
290	                description:
291	                    - Mark Basic Constraints valid when issuing non-CA certificates.
292	            not_before_duration:
293	                type: duration
294	                default: "30s"
295	                description:
296	                    - Specifies the duration by which to backdate the NotBefore property.
297	extends_documentation_fragment:
298	    - hashivault
299	'''
300	EXAMPLES = r'''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_pki_tidy.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	ANSIBLE_METADATA = {'status': ['preview'], 'supported_by': 'community', 'version': '1.1'}
9	DOCUMENTATION = r'''
10	---
11	module: hashivault_pki_tidy
12	version_added: "4.5.0"
13	short_description: Hashicorp Vault PKI Tidy
14	description:
15	    - This endpoint retrieves one of a selection of certificates.
16	options:
17	    mount_point:
18	        default: pki
19	        description:
20	            - location where secrets engine is mounted. also known as path
21	    config:
22	        type: dict
23	        description:
24	            - Collection of properties for pki tidy endpoint. Ref.
25	              U(https://www.vaultproject.io/api-docs/secret/pki#tidy)
26	        suboptions:
27	            tidy_cert_store:
28	                type: bool
29	                default: false
30	                description:
31	                    - Specifies whether to tidy up the certificate store.
32	            tidy_revoked_certs:
33	                type: bool
34	                default: false
35	                description:
36	                    - Set to true to expire all revoked and expired certificates, removing them both from the CRL and
37	                      from storage.
38	                    - The CRL will be rotated if this causes any values to be removed.
39	            safety_buffer:
40	                type: str
41	                default: 72h
42	                description:
43	                    - Specifies A duration used as a safety buffer to ensure certificates are not expunged prematurely;
44	                    - as an example, this can keep certificates from being removed from the CRL that, due to clock skew,
45	                      might still be considered valid on other hosts.
46	                    - For a certificate to be expunged, the time must be after the expiration time of the certificate
47	                      (according to the local clock) plus the duration of safety_buffer.
48	extends_documentation_fragment:
49	    - hashivault
50	'''
51	
52	EXAMPLES = r'''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_pki_url.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	
41	EXAMPLES = r'''
42	---
43	- hosts: localhost
44	  tasks:
45	    - hashivault_pki_url:
46	        issuing_certificates:
47	            - 'http://127.0.0.1:8200/v1/pki/ca'
48	        crl_distribution_points:
49	            - 'http://127.0.0.1:8200/v1/pki/crl'
50	
51	'''
52	
53	
54	def main():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_ssh_role.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	}
20	DOCUMENTATION = r"""
21	---
22	module: hashivault_ssh_role
23	version_added: "4.7.0"
24	short_description: Hashicorp Vault SSH Create/Update/Delete Role
25	description:
26	    - This module creates or updates the role definition.
27	    - Note that the `allowed_domains`, `allow_subdomains`, `allow_glob_domains`, and `allow_any_name` attributes are
28	      additive; between them nearly and across multiple roles nearly any issuing policy can be accommodated.
29	      `server_flag`, `client_flag`, and `code_signing_flag` are additive as well.
30	    - If a client requests a certificate that is not allowed by the CN policy in the role, the request is denied.
31	options:
32	    mount_point:
33	        default: ssh
34	        description:
35	            - location where secrets engine is mounted. also known as path
36	    name:
37	        required: true
38	        description:
39	            - Specifies the name of the role to create.
40	    role_file:
41	        description:
42	            - file with a json object containing play parameters. pass all params but name, state, mount_point which
43	              stay in the ansible play
44	    state:
45	        description:
46	            - Do you want for this config to be present or absent
47	        choices: ["present", "absent"]
48	        default: present
49	    config:
50	        type: dict
51	        description:
52	            - Collection of properties from ssh role
53	              U(https://www.vaultproject.io/api/secret/ssh#create-role)
54	        suboptions:
55	            key:
56	                type: str
57	                default: ""
58	                description:
59	                    - Specifies the name of the registered key in Vault. Before
60	                      creating the role, use the `keys/` endpoint to create a
61	                      named key. This is required for "Dynamic Key" type.
62	            admin_user:
63	                type: str
64	                default: ""
65	                description:
66	                    - Specifies the admin user at remote host. The shared key
67	                      being registered should be for this user and should have
68	                      root or sudo privileges. Every time a dynamic credential
69	                      is generated for a client, Vault uses this admin username
70	                      to login to remote host and install the generated
71	                      credential. This is required for Dynamic Key type.
72	            default_user:
73	                type: str
74	                default: ""
75	                description:
76	                    - Specifies the default username for which a credential
77	                      will be generated. When the endpoint `creds/` is used
78	                      without a username, this value will be used as default
79	                      username. Its recommended to create individual roles for
80	                      each username to ensure absolute isolation between
81	                      usernames. This is required for Dynamic Key type and OTP
82	                      type.
83	                    - For the CA type, if you wish this to be a valid
84	                      principal, it must also be in `allowed_users`.
85	            cidr_list:
86	                type: str
87	                default: ""
88	                description:
89	                    - Specifies a comma separated list of CIDR blocks for which
90	                      the role is applicable for. It is possible that a same
91	                      set of CIDR blocks are part of multiple roles. This is a
92	                      required parameter, unless the role is registered under
93	                      the `/config/zeroaddress` endpoint.
94	            exclude_cidr_list:
95	                type: str
96	                default: ""
97	                description:
98	                    - Specifies a comma-separated list of CIDR blocks. IP
99	                      addresses belonging to these blocks are not accepted by
100	                      the role. This is particularly useful when big CIDR
101	                      blocks are being used by the role and certain parts need
102	                      to be kept out.
103	            port:
104	                type: int
105	                default: 22
106	                description:
107	                    - Specifies the port number for SSH connection. Port number
108	                      does not play any role in OTP generation. For the `otp`
109	                      secrets engine type, this is just a way to inform the
110	                      client about the port number to use. The port number will
111	                      be returned to the client by Vault along with the OTP.
112	            key_type:
113	                type: str
114	                choices: ["otp", "dynamic", "ca"]
115	                required: true
116	                description:
117	                    - Specifies the type of credentials generated by this role.
118	                      This can be either `otp`, `dynamic` or `ca`.
119	            key_bits:
120	                type: int
121	                choices: [1024, 2048]
122	                default: 1024
123	                description:
124	                    - Specifies the length of the RSA dynamic key in bits. This
125	                      can be either `1024` or `2048`.
126	            install_script:
127	                type: str
128	                default: ""
129	                description:
130	                    - Specifies the script used to install and uninstall public
131	                      keys in the target machine. Defaults to the built-in
132	                      script.
133	            allowed_users:
134	                type: str
135	                default: ""
136	                description:
137	                    - |-
138	                      If this option is not specified, or if it is `*`, the
139	                      client can request a credential for any valid user at the
140	                      remote host, including the admin user. If only certain
141	                      usernames are to be allowed, then this list enforces it.
142	                      If this field is set, then credentials can only be
143	                      created for `default_user` and usernames present in this
144	                      list. Setting this option will enable all the users with
145	                      access to this role to fetch credentials for all other
146	                      usernames in this list. When `allowed_users_template` is
147	                      set to `true`, this field can contain an identity template
148	                      with any prefix or suffix, like
149	                      `ssh-{{identity.entity.id}}-user`. Use with caution. N.B.:
150	                      if the type is `ca`, an empty list does not allow any
151	                      user; instead you must use `*` to enable this behavior.
152	            allowed_users_template:
153	                type: bool
154	                default: false
155	                description:
156	                    - If set, `allowed_users` can be specified using identity
157	                      template policies. Non-templated users are also
158	                      permitted.
159	            allowed_domains:
160	                type: str
161	                default: ""
162	                description:
163	                    - The list of domains for which a client can request a host
164	                      certificate. If this option is explicitly set to `"*"`,
165	                      then credentials can be created for any domain. See also
166	                      `allow_bare_domains` and `allow_subdomains`.
167	            key_option_specs:
168	                type: str
169	                default: ""
170	                description:
171	                    - |-
172	                      Specifies a comma separated option specification which
173	                      will be prefixed to RSA keys in the remote host's
174	                      authorized_keys file. N.B.: Vault does not check this
175	                      string for validity.
176	            ttl:
177	                type: str
178	                default: ""
179	                description:
180	                    - Specifies the Time To Live value provided as a string
181	                      duration with time suffix. Hour is the largest suffix. If
182	                      not set, uses the system default value or the value of
183	                      `max_ttl`, whichever is shorter.
184	            max_ttl:
185	                type: str
186	                default: ""
187	                description:
188	                    - Specifies the maximum Time To Live provided as a string
189	                      duration with time suffix. Hour is the largest suffix. If
190	                      not set, defaults to the system maximum lease TTL.
191	            allowed_critical_options:
192	                type: str
193	                default: ""
194	                description:
195	                - Specifies a comma-separated list of critical options that
196	                  certificates can have when signed. To allow any critical
197	                  options, set this to an empty string. Will default to
198	                  allowing any critical options.
199	            allowed_extensions:
200	                type: str
201	                default: ""
202	                description:
203	                    - Specifies a comma-separated list of extensions that
204	                      certificates can have when signed. To allow a user to
205	                      specify any extension, set this to `"*"`. If not set, users
206	                      will not be allowed to specify extensions and will get
207	                      the extensions specified within `default_extensions`. For
208	                      the list of extensions, take a look at the sshd manual's
209	                      U(https://man.openbsd.org/sshd#AUTHORIZED_KEYS_FILE_FORMAT)
210	                      `AUTHORIZED_KEYS FILE FORMAT` section. You should add a
211	                      `permit-` before the name of extension to allow it.
212	            default_critical_options:
213	                type: dict
214	                default: null
215	                description:
216	                    - Specifies a map of critical options certificates should
217	                      have if none are provided when signing. This field takes
218	                      in key value pairs in JSON format. Note that these are
219	                      not restricted by `allowed_critical_options`. Defaults to
220	                      none.
221	            default_extensions:
222	                type: dict
223	                default: null
224	                description:
225	                    - Specifies a map of extensions certificates should have if
226	                      none are provided when signing. This field takes in key
227	                      value pairs in JSON format. Note that these are not
228	                      restricted by `allowed_extensions`. Defaults to none.
229	            allow_user_certificates:
230	                type: bool
231	                default: false
232	                description:
233	                    - Specifies if certificates are allowed to be signed for
234	                      use as a 'user'.
235	            allow_host_certificates:
236	                type: bool
237	                default: false
238	                description:
239	                    - Specifies if certificates are allowed to be signed for
240	                      use as a 'host'.
241	            allow_bare_domains:
242	                type: bool
243	                default: false
244	                description:
245	                    - Specifies if host certificates that are requested are
246	                      allowed to use the base domains listed in
247	                      `allowed_domains`, e.g. "example.com". This is a separate
248	                      option as in some cases this can be considered a security
249	                      threat.
250	            allow_subdomains:
251	                type: bool
252	                default: false
253	                description:
254	                    - Specifies if host certificates that are requested are
255	                      allowed to be subdomains of those listed in
256	                      `allowed_domains`, e.g. if "example.com" is part of
257	                      `allowed_domains`, this allows "foo.example.com".
258	            allow_user_key_ids:
259	                type: bool
260	                default: false
261	                description:
262	                    - Specifies if users can override the key ID for a signed
263	                      certificate with the "key_id" field. When false, the key
264	                      ID will always be the token display name. The key ID is
265	                      logged by the SSH server and can be useful for auditing.
266	            key_id_format:
267	                type: str
268	                default: ""
269	                description:
270	                    - |-
271	                      When supplied, this value specifies a custom format for
272	                      the key id of a signed certificate. The following
273	                      variables are available for use: '{{token_display_name}}'
274	                      - The display name of the token used to make the request.
275	                      '{{role_name}}' - The name of the role signing the
276	                      request. '{{public_key_hash}}' - A SHA256 checksum of
277	                      the public key that is being signed. e.g.
278	                      "custom-keyid-{{token_display_name}}"
279	            allowed_user_key_lengths:
280	                type: dict
281	                default: null
282	                description:
283	                    - Specifies a map of ssh key types and their expected sizes
284	                      which are allowed to be signed by the CA type.
285	            algorithm_signer:
286	                type: str
287	                choices: ["", "ssh-rsa", "rsa-sha2-256", "rsa-sha2-512"]
288	                default: ""
289	                description:
290	                    - Algorithm to sign keys with. Valid values are `ssh-rsa`,
291	                      `rsa-sha2-256`, and `rsa-sha2-512`. This value may be left
292	                      blank to use the signer's default algorithm, and must be
293	                      left blank for CA key types other than RSA. Note that
294	                      `ssh-rsa` is now considered insecure and is not supported
295	                      by current OpenSSH versions.
296	extends_documentation_fragment:
297	    - hashivault
298	"""
299	EXAMPLES = r"""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/modules/hashivault/hashivault_token_role.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	}
20	DOCUMENTATION = r"""
21	---
22	module: hashivault_token_role
23	version_added: "4.7.0"
24	short_description: Hashicorp Vault Token Create/Update/Delete Role
25	description:
26	    - This module creates or updates the token role definition.
27	options:
28	    mount_point:
29	        default: token
30	        description:
31	            - location where secrets engine is mounted. also known as path
32	    name:
33	        required: true
34	        description:
35	            - Specifies the name of the role to create.
36	    role_file:
37	        description:
38	            - file with a json object containing play parameters. pass all params but name, state, mount_point which
39	              stay in the ansible play
40	    state:
41	        description:
42	            - Do you want for this config to be present or absent
43	        choices: ["present", "absent"]
44	        default: present
45	    config:
46	        type: dict
47	        description:
48	            - Collection of properties from token role
49	              U(https://www.vaultproject.io/api-docs/auth/token#create-update-token-role)
50	        suboptions:
51	            allowed_policies:
52	                type: list
53	                description:
54	                - If set, tokens can be created with any subset of the policies
55	                  in this list, rather than the normal semantics of tokens being
56	                  a subset of the calling token's policies. The parameter is a
57	                  comma-delimited string of policy names. If at creation time
58	                  `no_default_policy` is not set and `"default"` is not
59	                  contained in `disallowed_policies` or glob matched in
60	                  `disallowed_policies_glob`, the `"default"` policy will be
61	                  added to the created token automatically.
62	            disallowed_policies:
63	                type: list
64	                description:
65	                - If set, successful token creation via this role will require
66	                  that no policies in the given list are requested. The parameter
67	                  is a comma-delimited string of policy names. Adding `"default"`
68	                  to this list will prevent `"default"` from being added
69	                  automatically to created tokens.
70	            allowed_policies_glob:
71	                type: list
72	                description:
73	                - If set, tokens can be created with any subset of glob matched
74	                  policies in this list, rather than the normal semantics of
75	                  tokens being a subset of the calling token's policies. The
76	                  parameter is a comma-delimited string of policy name globs.
77	                  If at creation time `no_default_policy` is not set and
78	                  `"default"` is not contained in `disallowed_policies` or glob
79	                  matched in `disallowed_policies_glob`, the `"default"` policy
80	                  will be added to the created token automatically. If combined
81	                  with `allowed_policies` policies need to only match one of the
82	                  two lists to be permitted. Note that unlike `allowed_policies`
83	                  the policies listed in `allowed_policies_glob` will not be
84	                  added to the token when no policies are specified in the
85	                  call to `/auth/token/create/:role_name`.
86	            disallowed_policies_glob:
87	                type: list
88	                description:
89	                - If set, successful token creation via this role will require
90	                  that no requested policies glob match any of policies in this
91	                  list. The parameter is a comma-delimited string of policy
92	                  name globs. Adding any glob that matches `"default"` to this
93	                  list will prevent `"default"` from being added automatically
94	                  to created tokens. If combined with `disallowed_policies`
95	                  policies need to only match one of the two lists to be blocked.
96	            orphan:
97	                type: bool
98	                default: false
99	                description:
100	                - If `true`, tokens created against this policy will be orphan
101	                  tokens (they will have no parent). As such, they will not be
102	                  automatically revoked by the revocation of any other token.
103	            renewable:
104	                type: bool
105	                default: true
106	                description:
107	                - Set to `false` to disable the ability of the token to be
108	                  renewed past its initial TTL. Setting the value to `true`
109	                  will allow the token to be renewable up to the system/mount
110	                  maximum TTL.
111	            path_suffix:
112	                type: str
113	                description:
114	                - If set, tokens created against this role will have the given
115	                  suffix as part of their path in addition to the role name.
116	                  This can be useful in certain scenarios, such as keeping the
117	                  same role name in the future but revoking all tokens created
118	                  against it before some point in time. The suffix can be
119	                  changed, allowing new callers to have the new suffix as part
120	                  of their path, and then tokens with the old suffix can be
121	                  revoked via `/sys/leases/revoke-prefix`.
122	            allowed_entity_aliases:
123	                type: list
124	                description:
125	                - String or JSON list of allowed entity aliases. If set,
126	                  specifies the entity aliases which are allowed to be used
127	                  during token generation. This field supports globbing.
128	                  Note that `allowed_entity_aliases` is not case sensitive.
129	            token_bound_cidrs:
130	                type: list
131	                description:
132	                - List of CIDR blocks; if set, specifies blocks of IP
133	                  addresses which can authenticate successfully, and ties the
134	                  resulting token to these blocks as well.
135	            token_explicit_max_ttl:
136	                type: str
137	                description:
138	                - If set, will encode an explicit max TTL onto the token.
139	                  This is a hard cap even if token_ttl and token_max_ttl would
140	                  otherwise allow a renewal.
141	            token_no_default_policy:
142	                type: bool
143	                default: false
144	                description:
145	                - If set, the `default` policy will not be set on generated
146	                  tokens; otherwise it will be added to the policies set in
147	                  `token_policies`.
148	            token_num_uses:
149	                type: int
150	                default: 0
151	                description:
152	                - The maximum number of times a generated token may be used
153	                  (within its lifetime); 0 means unlimited. If you require
154	                  the token to have the ability to create child tokens, you
155	                  will need to set this value to 0.
156	            token_period:
157	                type: str
158	                default: ""
159	                description:
160	                - The period, if any, to set on the token.
161	            token_type:
162	                type: str
163	                default: ""
164	                description:
165	                - |-
166	                  The type of token that should be generated. Can be `service`,
167	                  `batch`, or `default` to use the mount's tuned default (which
168	                  unless changed will be `service` tokens). For token store
169	                  roles, there are two additional possibilities:
170	                  `default-service` and `default-batch` which specify the type
171	                  to return unless the client requests a different type at
172	                  generation time.
173	extends_documentation_fragment:
174	    - hashivault
175	"""
176	EXAMPLES = r"""

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/plugins/action/hashivault_read_to_file.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
105	            try:
106	                content = base64encode.b64decode(content)
107	            except Exception as ex:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/plugins/action/hashivault_read_to_file.py:106
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
105	            try:
106	                content = base64encode.b64decode(content)
107	            except Exception as ex:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/plugins/action/hashivault_read_to_file.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
125	                return results
126	        local_tmp.write(content)
127	        local_tmp.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/plugins/action/hashivault_read_to_file.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
125	                return results
126	        local_tmp.write(content)
127	        local_tmp.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/ansible/plugins/lookup/hashivault.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	        # self._display.v('PARAMS: ' + str(params))
63	        result = hashivault_read(params=params)
64	        if 'value' not in result:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ansible_modules_hashivault-5.3.0/ansible_modules_hashivault-5.3.0/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    author_email='terrylhowe@example.com',
25	    url='https://github.com/TerryHowe/ansible-modules-hashivault',
26	    py_modules=py_files,

--------------------------------------------------

Code scanned:
	Total lines of code: 9760
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 51.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 71.0
		High: 1.0
Files skipped (0):
