Run started:2025-04-12 18:52:15.439828

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/chains/graph_qa/neptune_cypher.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	        raise ValueError(
120	            "In order to use this chain, you must acknowledge that it can make "
121	            "dangerous requests by setting `allow_dangerous_requests` to `True`. "
122	            "You must narrowly scope the permissions of the database connection "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/chains/graph_qa/neptune_sparql.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        raise ValueError(
93	            "In order to use this chain, you must acknowledge that it can make "
94	            "dangerous requests by setting `allow_dangerous_requests` to `True`. "
95	            "You must narrowly scope the permissions of the database connection "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/chains/graph_qa/prompts.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	
84	NEPTUNE_SPARQL_GENERATION_TEMPLATE = """
85	Task: Generate a SPARQL SELECT statement for querying a graph database.
86	For instance, to find all email addresses of John Doe, the following 
87	query in backticks would be suitable:
88	```
89	PREFIX foaf: <http://xmlns.com/foaf/0.1/>
90	SELECT ?email
91	WHERE {{
92	    ?person foaf:name "John Doe" .
93	    ?person foaf:mbox ?email .
94	}}
95	```
96	Instructions:
97	Use only the node types and properties provided in the schema.
98	Do not use any node types and properties that are not explicitly provided.
99	Include all necessary prefixes.
100	
101	Examples:
102	
103	Schema:
104	{schema}
105	Note: Be as concise as possible.
106	Do not include any explanations or apologies in your responses.
107	Do not respond to any questions that ask for anything else than 
108	for you to construct a SPARQL query.
109	Do not include any text except the SPARQL query generated.
110	
111	The question is:
112	{prompt}"""
113	
114	NEPTUNE_SPARQL_GENERATION_PROMPT = PromptTemplate(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/chat_models/bedrock_converse.py:714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
713	                raise ValueError(
714	                    f"{supported} Please see "
715	                    f"https://docs.aws.amazon.com/bedrock/latest/APIReference/API_runtime_ToolChoice.html "  # noqa: E501

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/chat_models/bedrock_converse.py:948
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
947	        raise ValueError(
948	            "No 'output' key found in the response from the Bedrock Converse API.  This usually "
949	            "happens due to misconfiguration of endpoint or region, ensure that you are using valid "
950	            "values for endpoint_url (on AWS this starts with bedrock-runtime), see: "

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/chat_models/bedrock_converse.py:1356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1355	def _b64str_to_bytes(base64_str: str) -> bytes:
1356	    return base64.b64decode(base64_str.encode("utf-8"))
1357	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/chat_models/bedrock_converse.py:1356
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1355	def _b64str_to_bytes(base64_str: str) -> bytes:
1356	    return base64.b64decode(base64_str.encode("utf-8"))
1357	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/chat_models/bedrock_converse.py:1360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1359	def _bytes_to_b64_str(bytes_: bytes) -> str:
1360	    return base64.b64encode(bytes_).decode("utf-8")
1361	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/chat_models/bedrock_converse.py:1360
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1359	def _bytes_to_b64_str(bytes_: bytes) -> str:
1360	    return base64.b64encode(bytes_).decode("utf-8")
1361	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/embeddings/bedrock.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
201	
202	            response_body = json.loads(response.get("body").read())
203	            return response_body

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/graphs/neptune_rdf_graph.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
201	
202	        queryres = requests.request(
203	            method="POST", url=self.query_endpoint, headers=request_hdr, data=data
204	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langchain_aws-0.2.19/langchain_aws-0.2.19/langchain_aws/graphs/neptune_rdf_graph.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
280	        for elem in ELEM_TYPES:
281	            q = ELEM_TYPES.get(elem)
282	            if not q:

--------------------------------------------------

Code scanned:
	Total lines of code: 9730
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 5.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 2.0
Files skipped (0):
