Run started:2025-04-12 12:01:24.186533

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/__init__.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
304	        if base_path.is_dir():
305	            shutil.rmtree(base_path)
306	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/acme.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
171	            self.path_private_key.write_bytes(key_pem)
172	            self.path_private_key.chmod(0o600)
173	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/acme.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
196	            self.path_account_key.write_bytes(pem)
197	            self.path_account_key.chmod(0o600)
198	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/acme.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
271	        )
272	        self.path_registration_info.chmod(0o600)
273	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/acme.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
363	
364	        with atomic_write(self.path_fullchain, overwrite=True) as fp:
365	            fp.write(order.fullchain_pem)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/acme.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
364	        with atomic_write(self.path_fullchain, overwrite=True) as fp:
365	            fp.write(order.fullchain_pem)
366	        self.path_fullchain.chmod(0o600)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/acme.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
365	            fp.write(order.fullchain_pem)
366	        self.path_fullchain.chmod(0o600)
367	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/acme.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
539	            if self.path_account_key.exists():
540	                self.path_account_key.chmod(0o600)
541	            if self.path_registration_info.exists():

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/acme.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
541	            if self.path_registration_info.exists():
542	                self.path_registration_info.chmod(0o600)
543	            if self.path_fullchain.exists():

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/acme.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
543	            if self.path_fullchain.exists():
544	                self.path_fullchain.chmod(0o600)
545	            if self.path_private_key.exists():

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/acme.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
545	            if self.path_private_key.exists():
546	                self.path_private_key.chmod(0o600)
547	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/api.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
115	        try:
116	            resp = await self._cloud.websession.request(
117	                method=method,
118	                url=url,
119	                timeout=client_timeout,
120	                headers=headers,
121	                json=jsondata,
122	                data=data,
123	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/const.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	
55	MESSAGE_REMOTE_READY = """
56	Your remote access is now available.
57	You can manage your connectivity on the
58	[Cloud panel](/config/cloud) or with our [portal](https://account.nabucasa.com/).
59	"""
60	
61	MESSAGE_REMOTE_SETUP = """

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/iot_base.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
211	        try:
212	            self.client = await self.cloud.websession.ws_connect(
213	                self.ws_server_url,
214	                heartbeat=self.ws_heartbeat,
215	                headers={
216	                    hdrs.AUTHORIZATION: f"Bearer {self.cloud.id_token}",
217	                    hdrs.USER_AGENT: self.cloud.client.client_name,
218	                },

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/iot_base.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
297	                base_msg = "Connection closed"
298	                await self.client.close()
299	                self.client = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/iot_base.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
314	        if self.client is not None:
315	            await self.client.close()
316	        elif self.retry_task is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/remote.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
447	                "Home Assistant Cloud error",
448	                "Remote connection is disabled because this Home Assistant instance "
449	                "is marked as insecure. For more information and to enable it again, "
450	                "visit the [Nabu Casa Account page](https://account.nabucasa.com).",
451	            )
452	            insecure = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/voice.py:1327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1326	        xml_body = ET.Element("speak", version="1.0")
1327	        xml_body.set("{http://www.w3.org/XML/1998/namespace}lang", language)
1328	        voice_el = ET.SubElement(xml_body, "voice")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/voice.py:1329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1328	        voice_el = ET.SubElement(xml_body, "voice")
1329	        voice_el.set("{http://www.w3.org/XML/1998/namespace}lang", language)
1330	        voice_el.set(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_account_link.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	        received.append(data)
53	        await ws.send_json({"authorize_url": "http://mock-url"})
54	        await ws.send_json({"tokens": {"refresh_token": "abcd", "expires_in": 10}})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_account_link.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	
58	    assert await helper.async_get_authorize_url() == "http://mock-url"
59	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_account_link.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	        await ws.receive_json()
92	        await ws.send_json({"authorize_url": "http://mock-url"})
93	        await ws.send_json({"error": "timeout"})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_account_link.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	        await ws.receive_json()
109	        await ws.send_json({"authorize_url": "http://mock-url"})
110	        await ws.send_json({"error": "something"})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    aioclient_mock.post(
17	        "https://example.com/generate",
18	        json={"cloudhook_id": "mock-webhook", "url": "https://blabla"},
19	    )
20	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        "https://example.com/generate",
18	        json={"cloudhook_id": "mock-webhook", "url": "https://blabla"},
19	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        "cloudhook_id": "mock-webhook",
27	        "url": "https://blabla",
28	    }
29	
30	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    aioclient_mock.post(
34	        "https://example.com/bla/instance/register",
35	        json={
36	            "domain": "test.dui.nabu.casa",
37	            "email": "test@nabucasa.inc",
38	            "server": "rest-remote.nabu.casa",
39	        },
40	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    aioclient_mock.post(
56	        "https://example.com/instance/snitun_token",
57	        json={
58	            "token": "123456",
59	            "server": "rest-remote.nabu.casa",
60	            "valid": 12345,
61	            "throttling": 400,
62	        },
63	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	    """Test creating a cloudhook."""
80	    aioclient_mock.post("https://example.com/instance/dns_challenge_txt")
81	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	    """Test creating a cloudhook."""
91	    aioclient_mock.post("https://example.com/instance/dns_challenge_cleanup")
92	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	    """Test creating a cloudhook."""
102	    aioclient_mock.post("https://example.com/alexa/access_token")
103	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	    """Test creating a cloudhook."""
112	    aioclient_mock.get("https://example.com/voice/connection_details")
113	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	    aioclient_mock.get(
123	        "https://example.com/payments/subscription_info",
124	        json={
125	            "success": True,
126	            "provider": None,
127	        },
128	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
146	    aioclient_mock.get(
147	        "https://example.com/payments/subscription_info",
148	        json={
149	            "success": True,
150	            "provider": "mock-provider",
151	        },
152	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	    aioclient_mock.post(
171	        "https://example.com/payments/migrate_paypal_agreement",
172	        json={
173	            "url": "https://example.com/some/path",
174	        },
175	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	        json={
173	            "url": "https://example.com/some/path",
174	        },
175	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
181	    assert data == {
182	        "url": "https://example.com/some/path",
183	    }
184	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
192	    aioclient_mock.get(
193	        "https://example.com/files/download_details/test/test.txt",
194	        json={
195	            "url": "https://example.com/some/path",
196	        },
197	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
194	        json={
195	            "url": "https://example.com/some/path",
196	        },
197	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	    assert details == {
209	        "url": "https://example.com/some/path",
210	    }
211	    assert (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
211	    assert (
212	        "Fetched https://example.com/files/download_details/test/test.txt (200)"
213	        in caplog.text
214	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
223	    aioclient_mock.get(
224	        "https://example.com/files/download_details/test/test.txt",
225	        status=400,
226	        json={"message": "Boom!"},
227	    )
228	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	    assert (
240	        "Fetched https://example.com/files/download_details/test/test.txt (400) Boom!"
241	        in caplog.text
242	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
251	    aioclient_mock.get(
252	        "https://example.com/files/test",
253	        json=[{"Key": "test.txt", "LastModified": "2021-01-01T00:00:00Z", "Size": 2}],
254	    )
255	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	    ]
271	    assert "Fetched https://example.com/files/test (200)" in caplog.text
272	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
280	    aioclient_mock.get(
281	        "https://example.com/files/test",
282	        status=400,
283	        json={"message": "Boom!"},
284	    )
285	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
295	
296	    assert "Fetched https://example.com/files/test (400) Boom!" in caplog.text
297	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
305	    aioclient_mock.get(
306	        "https://example.com/files/upload_details",
307	        json={
308	            "url": "https://example.com/some/path",
309	            "headers": {"key": "value"},
310	        },
311	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
307	        json={
308	            "url": "https://example.com/some/path",
309	            "headers": {"key": "value"},
310	        },
311	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
336	    assert details == {
337	        "url": "https://example.com/some/path",
338	        "headers": {"key": "value"},
339	    }
340	    assert "Fetched https://example.com/files/upload_details (200)" in caplog.text

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
339	    }
340	    assert "Fetched https://example.com/files/upload_details (200)" in caplog.text
341	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
349	    aioclient_mock.get(
350	        "https://example.com/files/upload_details",
351	        status=400,
352	        json={"message": "Boom!"},
353	    )
354	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
377	
378	    assert "Fetched https://example.com/files/upload_details (400) Boom!" in caplog.text
379	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
387	    aioclient_mock.delete(
388	        "https://example.com/files",
389	    )
390	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
405	
406	    assert "Fetched https://example.com/files (200)" in caplog.text
407	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
415	    aioclient_mock.delete(
416	        "https://example.com/files",
417	        status=400,
418	        json={"message": "Boom!"},
419	    )
420	    auth_cloud_mock.id_token = "mock-id-token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloud_api.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
436	
437	    assert "Fetched https://example.com/files (400) Boom!" in caplog.text

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloudhooks.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    aioclient_mock.post(
22	        "https://webhook-create.url/generate",
23	        json={
24	            "cloudhook_id": "mock-cloud-id",
25	            "url": "https://hooks.nabu.casa/ZXCZCXZ",
26	        },
27	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloudhooks.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	            "cloudhook_id": "mock-cloud-id",
25	            "url": "https://hooks.nabu.casa/ZXCZCXZ",
26	        },
27	    )
28	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloudhooks.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	        "cloudhook_id": "mock-cloud-id",
32	        "cloudhook_url": "https://hooks.nabu.casa/ZXCZCXZ",
33	        "managed": False,
34	    }
35	
36	    assert hook == await mock_cloudhooks.async_create("mock-webhook-id", False)
37	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloudhooks.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	            "cloudhook_id": "mock-cloud-id",
52	            "cloudhook_url": "https://hooks.nabu.casa/ZXCZCXZ",
53	        },
54	    }
55	
56	    await mock_cloudhooks.async_delete("mock-webhook-id")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloudhooks.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	    aioclient_mock.post(
73	        "https://webhook-create.url/generate",
74	        json={
75	            "cloudhook_id": "mock-cloud-id",
76	            "url": "https://hooks.nabu.casa/ZXCZCXZ",
77	        },
78	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloudhooks.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	            "cloudhook_id": "mock-cloud-id",
76	            "url": "https://hooks.nabu.casa/ZXCZCXZ",
77	        },
78	    )
79	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_cloudhooks.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	        "cloudhook_id": "mock-cloud-id",
83	        "cloudhook_url": "https://hooks.nabu.casa/ZXCZCXZ",
84	        "managed": True,
85	    }
86	
87	    assert hook == await mock_cloudhooks.async_create("mock-webhook-id", True)
88	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	API_HOSTNAME = "example.com"
17	FILES_API_URL = "https://files.api.fakeurl/path?X-Amz-Algorithm=blah"
18	
19	
20	STORED_BACKUP = {

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
55	    with pytest.raises(FilesError, match=msg):
56	        await files.upload(
57	            storage_type="test",
58	            open_stream=AsyncMock(),
59	            filename="lorem.ipsum",
60	            base64md5hash="hash",
61	            size=1337,
62	            metadata={"awesome": True},
63	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
129	    with pytest.raises(FilesError, match=f"^{re.escape(msg)}$"):
130	        await files.upload(
131	            storage_type="test",
132	            open_stream=AsyncMock(),
133	            filename="lorem.ipsum",
134	            base64md5hash="hash",
135	            size=1337,
136	            metadata={"awesome": True},
137	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
175	    with pytest.raises(exception):
176	        await files.upload(
177	            storage_type="test",
178	            open_stream=AsyncMock(),
179	            filename="lorem.ipsum",
180	            base64md5hash="hash",
181	            size=1337,
182	            metadata={"awesome": True},
183	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
202	    with pytest.raises(CloudApiNonRetryableError, match="Subscription has expired"):
203	        await files.upload(
204	            storage_type="test",
205	            open_stream=AsyncMock(),
206	            filename="lorem.ipsum",
207	            base64md5hash="hash",
208	            size=1337,
209	            metadata={"awesome": True},
210	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
250	    with pytest.raises(exception):
251	        await files.upload(
252	            storage_type="test",
253	            open_stream=AsyncMock(),
254	            filename="lorem.ipsum",
255	            base64md5hash="hash",
256	            size=1337,
257	            metadata={"awesome": True},
258	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
276	
277	    await files.upload(
278	        storage_type="test",
279	        open_stream=AsyncMock(),
280	        filename="lorem.ipsum",
281	        base64md5hash="hash",
282	        size=1337,
283	        metadata={"awesome": True},
284	    )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
312	    with pytest.raises(FilesError, match=msg):
313	        await files.download(
314	            storage_type="test",
315	            filename="lorem.ipsum",
316	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
342	    with pytest.raises(FilesError, match=msg):
343	        await files.download(
344	            storage_type="test",
345	            filename="lorem.ipsum",
346	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
393	    with pytest.raises(exception):
394	        await files.download(
395	            storage_type="test",
396	            filename="lorem.ipsum",
397	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
434	    with pytest.raises(exception):
435	        await files.download(
436	            storage_type="test",
437	            filename="lorem.ipsum",
438	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_files.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
456	
457	    await files.download(
458	        storage_type="test",
459	        filename="lorem.ipsum",
460	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_ice_servers.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    aioclient_mock.get(
25	        "https://example.com/test/webrtc/ice_servers",
26	        json=[
27	            {
28	                "urls": "turn:example.com:80",
29	                "username": "12345678:test-user",
30	                "credential": "secret-value",
31	            },
32	        ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_ice_servers.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	    aioclient_mock.get(
129	        "https://example.com/test/webrtc/ice_servers",
130	        status=403,
131	        json={"message": "Boom!"},
132	    )
133	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_ice_servers.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
177	    aioclient_mock.get(
178	        "https://example.com/test/webrtc/ice_servers",
179	        status=500,
180	        json={"message": "Boom!"},
181	    )
182	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_iot.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
231	    assert not cloud_mock.client.pref_should_connect
232	    cloud_mock.remote.snitun_server = "1.1.1.1"
233	    resp = await iot.async_handle_remote_sni(cloud_mock, {"ip_address": "8.8.8.8"})

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_iot.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
232	    cloud_mock.remote.snitun_server = "1.1.1.1"
233	    resp = await iot.async_handle_remote_sni(cloud_mock, {"ip_address": "8.8.8.8"})
234	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_iot.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
235	    assert cloud_mock.client.pref_should_connect
236	    assert resp == {"server": "1.1.1.1"}
237	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_iot_base.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        """Server to connect to."""
28	        return "http://example.com"
29	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_iot_base.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	    conn = MockIoT(cloud_mock_iot)
161	    request_info = Mock(real_url="http://example.com")
162	    mock_iot_client.receive.side_effect = client_exceptions.WSServerHandshakeError(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	    aioclient_mock.post(
87	        "https://test.local/instance/register",
88	        json={
89	            "domain": "test.dui.nabu.casa",
90	            "email": "test@nabucasa.inc",
91	            "server": "rest-remote.nabu.casa",
92	        },
93	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	    aioclient_mock.post(
95	        "https://test.local/instance/snitun_token",
96	        json={
97	            "token": "test-token",
98	            "server": "rest-remote.nabu.casa",
99	            "valid": valid.timestamp(),
100	            "throttling": 400,
101	        },
102	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	    aioclient_mock.post(
161	        "https://test.local/instance/register",
162	        json={
163	            "domain": "test.dui.nabu.casa",
164	            "email": "test@nabucasa.inc",
165	            "server": "rest-remote.nabu.casa",
166	        },
167	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	    aioclient_mock.post(
169	        "https://test.local/instance/snitun_token",
170	        json={
171	            "token": "test-token",
172	            "server": "rest-remote.nabu.casa",
173	            "valid": valid.timestamp(),
174	            "throttling": 400,
175	        },
176	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
222	    aioclient_mock.post(
223	        "https://test.local/instance/register",
224	        json={
225	            "domain": "test.dui.nabu.casa",
226	            "email": "test@nabucasa.inc",
227	            "server": "rest-remote.nabu.casa",
228	        },
229	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
230	    aioclient_mock.post(
231	        "https://test.local/instance/snitun_token",
232	        json={
233	            "token": "test-token",
234	            "server": "rest-remote.nabu.casa",
235	            "valid": valid.timestamp(),
236	            "throttling": 400,
237	        },
238	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
285	    aioclient_mock.post(
286	        "https://test.local/instance/register",
287	        json={
288	            "domain": "test.dui.nabu.casa",
289	            "email": "test@nabucasa.inc",
290	            "server": "rest-remote.nabu.casa",
291	            "alias": ["example.com"],
292	        },
293	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
294	    aioclient_mock.post(
295	        "https://test.local/instance/snitun_token",
296	        json={
297	            "token": "test-token",
298	            "server": "rest-remote.nabu.casa",
299	            "valid": valid.timestamp(),
300	            "throttling": 400,
301	        },
302	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
304	    aioclient_mock.post(
305	        "https://example.com/instance/resolve_dns_cname",
306	        json=["test.dui.nabu.casa", "_acme-challenge.test.dui.nabu.casa"],
307	    )
308	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
353	    aioclient_mock.post(
354	        "https://test.local/instance/register",
355	        json={
356	            "domain": "test.dui.nabu.casa",
357	            "email": "test@nabucasa.inc",
358	            "server": "rest-remote.nabu.casa",
359	        },
360	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	    aioclient_mock.post(
362	        "https://test.local/instance/snitun_token",
363	        json={
364	            "token": "test-token",
365	            "server": "rest-remote.nabu.casa",
366	            "valid": valid.timestamp(),
367	            "throttling": 400,
368	        },
369	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
395	    aioclient_mock.post(
396	        "https://test.local/instance/register",
397	        json={
398	            "domain": "test.dui.nabu.casa",
399	            "email": "test@nabucasa.inc",
400	            "server": "rest-remote.nabu.casa",
401	        },
402	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
403	    aioclient_mock.post(
404	        "https://test.local/instance/snitun_token",
405	        json={
406	            "token": "test-token",
407	            "server": "rest-remote.nabu.casa",
408	            "valid": valid.timestamp(),
409	            "throttling": 400,
410	        },
411	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
451	    aioclient_mock.post(
452	        "https://test.local/instance/register",
453	        json={
454	            "domain": "test.dui.nabu.casa",
455	            "email": "test@nabucasa.inc",
456	            "server": "rest-remote.nabu.casa",
457	        },
458	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
459	    aioclient_mock.post(
460	        "https://test.local/instance/snitun_token",
461	        json={
462	            "token": "test-token",
463	            "server": "rest-remote.nabu.casa",
464	            "valid": valid.timestamp(),
465	            "throttling": 400,
466	        },
467	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
498	    aioclient_mock.post(
499	        "https://test.local/instance/register",
500	        json={
501	            "domain": "test.dui.nabu.casa",
502	            "email": "test@nabucasa.inc",
503	            "server": "rest-remote.nabu.casa",
504	        },
505	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
506	    aioclient_mock.post(
507	        "https://test.local/instance/snitun_token",
508	        json={
509	            "token": "test-token",
510	            "server": "rest-remote.nabu.casa",
511	            "valid": valid.timestamp(),
512	            "throttling": 400,
513	        },
514	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
547	    aioclient_mock.post(
548	        "https://test.local/instance/register",
549	        json={
550	            "domain": "test.dui.nabu.casa",
551	            "email": "test@nabucasa.inc",
552	            "server": "rest-remote.nabu.casa",
553	        },
554	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
555	    aioclient_mock.post(
556	        "https://test.local/instance/snitun_token",
557	        json={
558	            "token": "test-token",
559	            "server": "rest-remote.nabu.casa",
560	            "valid": valid.timestamp(),
561	            "throttling": 400,
562	        },
563	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
605	    aioclient_mock.post(
606	        "https://test.local/instance/register",
607	        json={
608	            "domain": "test.dui.nabu.casa",
609	            "email": "test@nabucasa.inc",
610	            "server": "rest-remote.nabu.casa",
611	        },
612	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
613	    aioclient_mock.post(
614	        "https://test.local/instance/snitun_token",
615	        json={
616	            "token": "test-token",
617	            "server": "rest-remote.nabu.casa",
618	            "valid": valid.timestamp(),
619	            "throttling": 400,
620	        },
621	        status=409,
622	    )
623	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
651	    aioclient_mock.post(
652	        "https://test.local/instance/register",
653	        json={
654	            "domain": "test.dui.nabu.casa",
655	            "email": "test@nabucasa.inc",
656	            "server": "rest-remote.nabu.casa",
657	        },
658	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
659	    aioclient_mock.post(
660	        "https://test.local/instance/snitun_token",
661	        json={
662	            "message": "lorem_ipsum",
663	        },
664	        status=403,
665	        headers={"content-type": "application/json; charset=utf-8"},
666	    )
667	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
693	    aioclient_mock.post(
694	        "https://test.local/instance/register",
695	        json={
696	            "domain": "test.dui.nabu.casa",
697	            "email": "test@nabucasa.inc",
698	            "server": "rest-remote.nabu.casa",
699	        },
700	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
701	    aioclient_mock.post(
702	        "https://test.local/instance/snitun_token",
703	        json={
704	            "token": "test-token",
705	            "server": "rest-remote.nabu.casa",
706	            "valid": valid.timestamp(),
707	            "throttling": 400,
708	        },
709	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
736	    aioclient_mock.post(
737	        "https://test.local/instance/register",
738	        json={
739	            "domain": "test.dui.nabu.casa",
740	            "email": "test@nabucasa.inc",
741	            "server": "rest-remote.nabu.casa",
742	            "alias": ["example.com"],
743	        },
744	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
745	    aioclient_mock.post(
746	        "https://test.local/instance/snitun_token",
747	        json={
748	            "token": "test-token",
749	            "server": "rest-remote.nabu.casa",
750	            "valid": valid.timestamp(),
751	            "throttling": 400,
752	        },
753	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
754	    aioclient_mock.post(
755	        "https://example.com/instance/resolve_dns_cname",
756	        json=["test.dui.nabu.casa"],
757	    )
758	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
820	    aioclient_mock.post(
821	        "https://test.local/instance/register",
822	        json={
823	            "domain": "test.dui.nabu.casa",
824	            "email": "test@nabucasa.inc",
825	            "server": "rest-remote.nabu.casa",
826	            "alias": ["example.com"],
827	        },
828	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
829	    aioclient_mock.post(
830	        "https://test.local/instance/snitun_token",
831	        json={
832	            "token": "test-token",
833	            "server": "rest-remote.nabu.casa",
834	            "valid": valid.timestamp(),
835	            "throttling": 400,
836	        },
837	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:839
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
838	    aioclient_mock.post(
839	        "https://example.com/instance/resolve_dns_cname",
840	        status=400,
841	    )
842	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
895	    aioclient_mock.post(
896	        "https://test.local/instance/register",
897	        json={
898	            "domain": "test.dui.nabu.casa",
899	            "email": "test@nabucasa.inc",
900	            "server": "rest-remote.nabu.casa",
901	            "alias": ["example.com"],
902	        },
903	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
904	    aioclient_mock.post(
905	        "https://test.local/instance/snitun_token",
906	        json={
907	            "token": "test-token",
908	            "server": "rest-remote.nabu.casa",
909	            "valid": valid.timestamp(),
910	            "throttling": 400,
911	        },
912	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
913	    aioclient_mock.post(
914	        "https://example.com/instance/resolve_dns_cname",
915	        json=["test.dui.nabu.casa", "_acme-challenge.test.dui.nabu.casa"],
916	    )
917	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:1016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1015	    aioclient_mock.post(
1016	        "https://test.local/instance/register",
1017	        json={
1018	            "domain": "test.dui.nabu.casa",
1019	            "email": "test@nabucasa.inc",
1020	            "server": "rest-remote.nabu.casa",
1021	        },
1022	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_remote.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1065	    aioclient_mock.post(
1066	        "https://test.local/instance/register",
1067	        json={
1068	            "domain": "test.dui.nabu.casa",
1069	            "email": "test@nabucasa.inc",
1070	            "server": "rest-remote.nabu.casa",
1071	        },
1072	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/tests/test_voice.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    aioclient_mock.get(
22	        "https://test.local/voice/connection_details",
23	        json={
24	            "authorized_key": "test-key",
25	            "endpoint_stt": "stt-url",
26	            "endpoint_tts": "tts-url",
27	            "valid": f"{(voice.utcnow() + timedelta(minutes=9)).timestamp()}",
28	        },
29	    )

--------------------------------------------------

Code scanned:
	Total lines of code: 8244
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 95.0
		High: 26.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 121.0
		High: 0.0
Files skipped (2):
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/files.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/hass_nabucasa-0.95.0/hass_nabucasa-0.95.0/hass_nabucasa/instance_api.py (syntax error while parsing AST from file)
