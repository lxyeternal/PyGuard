Run started:2025-04-12 14:41:38.909197

Test results:
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFCluster.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
142	
143	      signal.signal(signal.SIGALRM, timeout_handler)
144	      signal.alarm(timeout)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFCluster.py:143
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
142	
143	      signal.signal(signal.SIGALRM, timeout_handler)
144	      signal.alarm(timeout)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFCluster.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
210	      if node['tb_port'] != 0:
211	        return "http://{0}:{1}".format(node['host'], node['tb_port'])
212	    return None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFCluster.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
313	    for i in cluster_template['ps']:
314	      ps_thread = threading.Thread(target=lambda: _start_ps(i))
315	      ps_thread.daemon = True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFCluster.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
331	
332	  t = threading.Thread(target=_start, args=(tf_status,))
333	  # run as daemon thread so that in spark mode main thread can exit

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFCluster.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
347	    if node['tb_port'] != 0:
348	      tb_url = "http://{0}:{1}".format(node['host'], node['tb_port'])
349	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFNode.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
61	    if ctx.defaultFS.startswith("hdfs://") or ctx.defaultFS.startswith("viewfs://"):
62	      return "{0}/user/{1}/{2}".format(ctx.defaultFS, getpass.getuser(), path)
63	    elif ctx.defaultFS.startswith("file://"):

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFNode.py:62
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
61	    if ctx.defaultFS.startswith("hdfs://") or ctx.defaultFS.startswith("viewfs://"):
62	      return "{0}/user/{1}/{2}".format(ctx.defaultFS, getpass.getuser(), path)
63	    elif ctx.defaultFS.startswith("file://"):

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
142	      authkey = node['authkey']
143	      TFSparkNode.mgr = TFManager.connect(addr, authkey)
144	      break

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:303
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
302	        # otherwise, find a free port
303	        tb_sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
304	        tb_sock.bind(('', 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
305	        tb_port = tb_sock.getsockname()[1]
306	        tb_sock.close()
307	      logdir = log_dir if log_dir else "tensorboard_%d" % executor_id

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:349
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
348	        # otherwise, find a free port
349	        tmp_sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
350	        tmp_sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
369	      cluster_info = client.await_reservations()
370	      client.close()
371	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
402	      if cluster_meta.get('release_port', True):
403	        tmp_sock.close()
404	      else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
410	      # script runs on Windows or not.
411	      if os.name == 'nt' or platform.system() == 'Windows':
412	        raise Exception("Background mode is not supported on Windows.")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
410	      # script runs on Windows or not.
411	      if os.name == 'nt' or platform.system() == 'Windows':
412	        raise Exception("Background mode is not supported on Windows.")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:411
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
410	      # script runs on Windows or not.
411	      if os.name == 'nt' or platform.system() == 'Windows':
412	        raise Exception("Background mode is not supported on Windows.")

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
435	
436	      p = multiprocessing.Process(target=wrapper_fn_background, args=(tf_args, ctx))
437	      if job_name in ('ps', 'evaluator'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
504	      # wait for consumers to finish processing all items in queue before "finishing" this iterator
505	      joinThr = Thread(target=queue.join)
506	      joinThr.start()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
527	          client.request_stop()
528	          client.close()
529	        except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/TFSparkNode.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
572	    # wait for consumers to finish processing all items in queue before "finishing" this iterator
573	    joinThr = Thread(target=queue_in.join)
574	    joinThr.start()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
77	    while not recv_done:
78	      buf = sock.recv(BUFSIZE)
79	      if buf is None or len(buf) == 0:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
96	    buf = struct.pack('>I', len(data)) + data
97	    sock.sendall(buf)
98	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
134	      self.reservations.add(msg['data'])
135	      MessageSocket.send(self, sock, 'OK')
136	    elif msg_type == 'QUERY':

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
136	    elif msg_type == 'QUERY':
137	      MessageSocket.send(self, sock, self.reservations.done())
138	    elif msg_type == 'QINFO':

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
139	      rinfo = self.reservations.get()
140	      MessageSocket.send(self, sock, rinfo)
141	    elif msg_type == 'STOP':

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
142	      logger.info("setting server.done")
143	      MessageSocket.send(self, sock, 'OK')
144	      self.done = True

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
145	    else:
146	      MessageSocket.send(self, sock, 'ERR')
147	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
178	              logger.debug(e)
179	              sock.close()
180	              CONNECTIONS.remove(sock)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
181	
182	      server_sock.close()
183	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	
184	    t = threading.Thread(target=_listen, args=(self, server_sock))
185	    t.daemon = True

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:213
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
212	      try:
213	        server_sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
214	        server_sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:244
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
243	  def __init__(self, server_addr):
244	    self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
245	    self.sock.connect(server_addr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
244	    self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
245	    self.sock.connect(server_addr)
246	    self.server_addr = server_addr

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
259	      try:
260	        MessageSocket.send(self, self.sock, msg)
261	        done = True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
266	        print("Socket error: {}".format(e))
267	        self.sock.close()
268	        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:268
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
267	        self.sock.close()
268	        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
269	        self.sock.connect(self.server_addr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
268	        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
269	        self.sock.connect(self.server_addr)
270	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/reservation.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
277	    """Close the client socket."""
278	    self.sock.close()
279	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/util.py:55
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
54	  try:
55	    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
56	    s.connect(("8.8.8.8", 80))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/util.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
55	    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
56	    s.connect(("8.8.8.8", 80))
57	    ip_address = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/util.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
55	    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
56	    s.connect(("8.8.8.8", 80))
57	    ip_address = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/util.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
62	  finally:
63	    s.close()
64	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/util.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
79	  with open("executor_id", "w") as f:
80	    f.write(str(num))
81	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflowonspark-2.2.5/tensorflowonspark-2.2.5/tensorflowonspark/util.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	    with open("executor_id", "r") as f:
87	      return int(f.read())
88	  else:

--------------------------------------------------

Code scanned:
	Total lines of code: 2214
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 33.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 9.0
Files skipped (0):
