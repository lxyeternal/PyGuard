Run started:2025-04-12 10:57:47.170923

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
12	with open("README.md", "r") as f:
13	    long_description = f.read()
14	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/setup.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
31	            js_path = "sqllineagejs"
32	            use_shell = True if platform.system() == "Windows" else False
33	            subprocess.check_call(

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/setup.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
31	            js_path = "sqllineagejs"
32	            use_shell = True if platform.system() == "Windows" else False
33	            subprocess.check_call(

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/setup.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
31	            js_path = "sqllineagejs"
32	            use_shell = True if platform.system() == "Windows" else False
33	            subprocess.check_call(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/setup.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	    long_description_content_type="text/markdown",
51	    url="https://github.com/reata/sqllineage",
52	    packages=find_packages(exclude=("tests",)),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/sqllineage/core/parser/sqlfluff/extractors/merge.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
101	                if table := self.find_table(segment):
102	                    holder.add_write(table)
103	                tgt_flag = False

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/sqllineage/core/parser/sqlfluff/extractors/merge.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
105	                if table := self.find_table(segment):
106	                    holder.add_read(table)
107	                    direct_source = table

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/sqllineage/core/parser/sqlfluff/extractors/merge.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
117	                    )
118	                    holder.add_read(direct_source)
119	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/sqllineage/drawing.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	                with open(static_fname, "rb") as f:
68	                    text = f.read()
69	                return self.handle_200_text(start_response, mimetype, text)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/sqllineage/drawing.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
72	                    request_body_size = int(environ["CONTENT_LENGTH"])
73	                    request_body = environ["wsgi.input"].read(request_body_size)
74	                    payload = json.loads(request_body)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	            with StringIO() as f:
24	                length = f.write(body)
25	                f.seek(0)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
32	    # 200
33	    mock_request("GET", "/")
34	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
34	    assert container.status.startswith(str(HTTPStatus.OK.value))
35	    mock_request("GET", "/manifest.json")
36	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
36	    assert container.status.startswith(str(HTTPStatus.OK.value))
37	    mock_request("POST", "/lineage", {"e": "SELECT * FROM dual", "p": 5000})
38	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
38	    assert container.status.startswith(str(HTTPStatus.OK.value))
39	    mock_request("POST", "/script", {"e": "SELECT * FROM dual", "p": 5000})
40	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
40	    assert container.status.startswith(str(HTTPStatus.OK.value))
41	    mock_request(
42	        "POST",
43	        "/directory",
44	        {"f": os.path.join(SQLLineageConfig.DIRECTORY, "tpcds/query01.sql")},
45	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
46	    assert container.status.startswith(str(HTTPStatus.OK.value))
47	    mock_request(
48	        "POST",
49	        "/directory",
50	        {"d": os.path.join(SQLLineageConfig.DIRECTORY, "tpcds/")},
51	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
52	    assert container.status.startswith(str(HTTPStatus.OK.value))
53	    mock_request("POST", "/directory", {})
54	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
54	    assert container.status.startswith(str(HTTPStatus.OK.value))
55	    mock_request("OPTIONS", "/directory", {})
56	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
57	    # 400
58	    mock_request("POST", "/lineage", {"e": "SELECT * FROM where foo='bar'"})
59	    assert container.status.startswith(str(HTTPStatus.BAD_REQUEST.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
60	    # 403
61	    mock_request("POST", "/directory", {"f": "/etc/passwd"})
62	    assert container.status.startswith(str(HTTPStatus.FORBIDDEN.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
62	    assert container.status.startswith(str(HTTPStatus.FORBIDDEN.value))
63	    mock_request("POST", "/directory", {"d": "/"})
64	    assert container.status.startswith(str(HTTPStatus.FORBIDDEN.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
65	    # 404
66	    mock_request("GET", "/non-exist-resource")
67	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
67	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))
68	    mock_request("GET", "/static")
69	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
69	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))
70	    mock_request(
71	        "POST",
72	        "/script",
73	        {"f": os.path.join(SQLLineageConfig.DIRECTORY, "tpcds/query100.sql")},
74	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
75	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))
76	    mock_request("POST", "/non-exist-resource", {"e": "SELECT * FROM where foo='bar'"})
77	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
77	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))
78	    mock_request("GET", "/../cli.py")
79	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
79	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))
80	    mock_request("OPTIONS", "/non-exist-resource")
81	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
82	    # 405
83	    mock_request("PUT", "/")
84	    assert container.status.startswith(str(HTTPStatus.METHOD_NOT_ALLOWED.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
84	    assert container.status.startswith(str(HTTPStatus.METHOD_NOT_ALLOWED.value))
85	    mock_request("PATCH", "/")
86	    assert container.status.startswith(str(HTTPStatus.METHOD_NOT_ALLOWED.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_drawing.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
86	    assert container.status.startswith(str(HTTPStatus.METHOD_NOT_ALLOWED.value))
87	    mock_request("DELETE", "/")
88	    assert container.status.startswith(str(HTTPStatus.METHOD_NOT_ALLOWED.value))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_runner.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	            with open(".sqlfluff", "w") as f:
50	                f.write(sqlfluff_config)
51	            sql = "SELECT {{ num_things }} FROM {{ tbl_name }} WHERE id > 10 LIMIT 5"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_runner.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
49	            with open(".sqlfluff", "w") as f:
50	                f.write(sqlfluff_config)
51	            sql = "SELECT {{ num_things }} FROM {{ tbl_name }} WHERE id > 10 LIMIT 5"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_runner.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
67	            with open(os.path.join(nested_dir, ".sqlfluff"), "w") as f:
68	                f.write(sqlfluff_config)
69	            with open(os.path.join(nested_dir, "nested.sql"), "w") as f:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_runner.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
67	            with open(os.path.join(nested_dir, ".sqlfluff"), "w") as f:
68	                f.write(sqlfluff_config)
69	            with open(os.path.join(nested_dir, "nested.sql"), "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_runner.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
69	            with open(os.path.join(nested_dir, "nested.sql"), "w") as f:
70	                f.write(
71	                    "SELECT {{ num_things }} FROM {{ tbl_name }} WHERE id > 10 LIMIT 5"
72	                )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/core/test_runner.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
69	            with open(os.path.join(nested_dir, "nested.sql"), "w") as f:
70	                f.write(
71	                    "SELECT {{ num_things }} FROM {{ tbl_name }} WHERE id > 10 LIMIT 5"
72	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqllineage-1.5.4/sqllineage-1.5.4/tests/sql/table/test_path_dialect_specific.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        ("snowflake", "s3://mybucket/mypath"),
25	        ("tsql", "https://myaccount.blob.core.windows.net/myblobcontainer/folder1/"),
26	    ],

--------------------------------------------------

Code scanned:
	Total lines of code: 8163
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 35.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 1.0
Files skipped (0):
