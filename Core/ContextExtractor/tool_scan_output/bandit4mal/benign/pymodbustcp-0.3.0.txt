Run started:2025-04-12 16:49:28.697812

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/__init__.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	__description__ = 'A simple Modbus/TCP library for Python.'
15	__url__ = 'https://github.com/sourceperl/pyModbusTCP'
16	__version__ = VERSION

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:116
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
115	        self._auto_close = None
116	        self._sock = socket.socket()
117	        self._transaction_id = 0  # MBAP transaction ID

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
135	    def __del__(self):
136	        self.close()
137	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
186	            if self._host != value:
187	                self.close()
188	                self._host = value

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
208	            if self._port != value:
209	                self.close()
210	                self._port = value

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
250	            if self._timeout != value:
251	                self.close()
252	                self._timeout = value

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
298	        if self.is_open:
299	            self.close()
300	        # init socket and connect

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:308
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
307	            try:
308	                self._sock = socket.socket(af, sock_type, proto)
309	            except socket.error:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
311	            try:
312	                self._sock.settimeout(self.timeout)
313	                self._sock.connect(sa)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
312	                self._sock.settimeout(self.timeout)
313	                self._sock.connect(sa)
314	            except socket.error:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
314	            except socket.error:
315	                self._sock.close()
316	                continue

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
323	        """Close current TCP connection."""
324	        self._sock.close()
325	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:778
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
777	        try:
778	            self._sock.send(frame)
779	        except socket.timeout:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
779	        except socket.timeout:
780	            self._sock.close()
781	            raise ModbusClient._NetworkError(MB_TIMEOUT_ERR, 'timeout error')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
782	        except socket.error:
783	            self._sock.close()
784	            raise ModbusClient._NetworkError(MB_SEND_ERR, 'send error')

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
797	        # send frame with error check
798	        self._send(tx_frame)
799	        # debug

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
810	        try:
811	            r_buffer = self._sock.recv(size)
812	        except socket.timeout:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
812	        except socket.timeout:
813	            self._sock.close()
814	            raise ModbusClient._NetworkError(MB_TIMEOUT_ERR, 'timeout error')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:819
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
818	        if not r_buffer:
819	            self._sock.close()
820	            raise ModbusClient._NetworkError(MB_RECV_ERR, 'recv error')

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
832	        while len(r_buffer) < size:
833	            r_buffer += self._recv(size - len(r_buffer))
834	        return r_buffer

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
854	        if f_transaction_err or f_protocol_err or f_length_err or f_unit_id_err:
855	            self.close()
856	            self._on_tx_rx(frame=rx_mbap, is_tx=False)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/client.py:862
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
861	        if self.auto_close:
862	            self.close()
863	        # dump frame

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/server.py:797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
796	            try:
797	                self.request.sendall(data)
798	                return True

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/server.py:810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
809	                    # recv all data or a chunk of it
810	                    data_chunk = self.request.recv(size - len(data))
811	                    # check data chunk

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/server.py:824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
823	            # this avoids hang thread deletion when main server exit (see _recv_all method)
824	            self.request.settimeout(1.0)
825	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/server.py:853
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
852	                # on main loop except: exit from it and cleanly close the current socket
853	                self.request.close()
854	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/server.py:1288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1287	            self._service.shutdown()
1288	            self._service.server_close()
1289	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/server.py:1302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1301	        except Exception:
1302	            self._service.server_close()
1303	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/pyModbusTCP/server.py:1305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1304	        except KeyboardInterrupt:
1305	            self._service.server_close()
1306	        finally:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    license="MIT",
15	    url="https://github.com/sourceperl/pyModbusTCP",
16	    packages=["pyModbusTCP"],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymodbustcp-0.3.0/pyModbusTCP-0.3.0/tests/test_client.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
20	                                            '_test.example.com', '42.example.com',
21	                                            '127.0.0.1', '::1']]
22	        except ValueError:
23	            self.fail('ModbusClient.host property raised ValueError unexpectedly')
24	

--------------------------------------------------

Code scanned:
	Total lines of code: 2375
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 26.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 2.0
Files skipped (0):
