Run started:2025-04-12 19:01:49.800662

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/connections.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
433	                    raw_token = "token:{}".format(creds.token).encode()
434	                    token = base64.standard_b64encode(raw_token).decode()
435	                    transport.setCustomHeaders({"Authorization": "Basic {}".format(token)})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	    def cluster_id(self) -> str:
35	        return self.parsed_model["config"].get("cluster_id", self.credentials.cluster_id)
36	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	    def get_timeout(self) -> int:
38	        timeout = self.parsed_model["config"].get("timeout", DEFAULT_TIMEOUT)
39	        if timeout <= 0:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
48	    def _create_work_dir(self, path: str) -> None:
49	        response = requests.post(
50	            f"https://{self.credentials.host}/api/2.0/workspace/mkdirs",
51	            headers=self.auth_header,
52	            json={
53	                "path": path,
54	            },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
61	    def _upload_notebook(self, path: str, compiled_code: str) -> None:
62	        b64_encoded_content = base64.b64encode(compiled_code.encode()).decode()
63	        response = requests.post(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:62
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
61	    def _upload_notebook(self, path: str, compiled_code: str) -> None:
62	        b64_encoded_content = base64.b64encode(compiled_code.encode()).decode()
63	        response = requests.post(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
62	        b64_encoded_content = base64.b64encode(compiled_code.encode()).decode()
63	        response = requests.post(
64	            f"https://{self.credentials.host}/api/2.0/workspace/import",
65	            headers=self.auth_header,
66	            json={
67	                "path": path,
68	                "content": b64_encoded_content,
69	                "language": "PYTHON",
70	                "overwrite": True,
71	                "format": "SOURCE",
72	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	        # PYPI packages
86	        packages = self.parsed_model["config"].get("packages", [])
87	        # additional format of packages

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	        # additional format of packages
88	        additional_libs = self.parsed_model["config"].get("additional_libs", [])
89	        libraries = []

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
94	        job_spec.update({"libraries": libraries})  # type: ignore
95	        submit_response = requests.post(
96	            f"https://{self.credentials.host}/api/2.1/jobs/runs/submit",
97	            headers=self.auth_header,
98	            json=job_spec,
99	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	        # get end state to return to user
128	        run_output = requests.get(
129	            f"https://{self.credentials.host}" f"/api/2.1/jobs/runs/get-output?run_id={run_id}",
130	            headers=self.auth_header,
131	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	    def check_credentials(self) -> None:
180	        if not self.parsed_model["config"].get("job_cluster_config", None):
181	            raise ValueError("job_cluster_config is required for commands submission method.")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
195	        # https://docs.databricks.com/dev-tools/api/1.2/index.html#create-an-execution-context
196	        response = requests.post(
197	            f"https://{self.host}/api/1.2/contexts/create",
198	            headers=self.auth_header,
199	            json={
200	                "clusterId": self.cluster_id,
201	                "language": SUBMISSION_LANGUAGE,
202	            },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
209	        # https://docs.databricks.com/dev-tools/api/1.2/index.html#delete-an-execution-context
210	        response = requests.post(
211	            f"https://{self.host}/api/1.2/contexts/destroy",
212	            headers=self.auth_header,
213	            json={
214	                "clusterId": self.cluster_id,
215	                "contextId": context_id,
216	            },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
230	        # https://docs.databricks.com/dev-tools/api/1.2/index.html#run-a-command
231	        response = requests.post(
232	            f"https://{self.host}/api/1.2/commands/execute",
233	            headers=self.auth_header,
234	            json={
235	                "clusterId": self.cluster_id,
236	                "contextId": context_id,
237	                "language": SUBMISSION_LANGUAGE,
238	                "command": command,
239	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	        # https://docs.databricks.com/dev-tools/api/1.2/index.html#get-information-about-a-command
247	        response = requests.get(
248	            f"https://{self.host}/api/1.2/commands/status",
249	            headers=self.auth_header,
250	            params={
251	                "clusterId": self.cluster_id,
252	                "contextId": context_id,
253	                "commandId": command_id,
254	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_spark-1.9.2/dbt_spark-1.9.2/dbt/adapters/spark/python_submissions.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	    def submit(self, compiled_code: str) -> None:
269	        if self.parsed_model["config"].get("create_notebook", False):
270	            self._submit_through_notebook(compiled_code, {"existing_cluster_id": self.cluster_id})

--------------------------------------------------

Code scanned:
	Total lines of code: 1550
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 16.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 1.0
Files skipped (0):
