Run started:2025-04-12 12:17:12.044990

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/backend.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	        else:
84	            data["resource"] = 'https://graph.microsoft.com'
85	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/backend.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	        """
120	        graph_url = "https://{}/v1.0/me/transitiveMemberOf/microsoft.graph.group".format(
121	            provider_config.msgraph_endpoint

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
41	        raise ImproperlyConfigured(msg)
42	    cls = django_settings.AUTH_ADFS.get('SETTINGS_CLASS', DEFAULT_SETTINGS_CLASS)
43	    return import_string(cls)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	        if settings.VERSION != 'v1.0':
242	            config_url = "https://{}/{}/{}/.well-known/openid-configuration?appid={}".format(
243	                settings.SERVER, settings.TENANT_ID, settings.VERSION, settings.CLIENT_ID

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
245	        else:
246	            config_url = "https://{}/{}/.well-known/openid-configuration?appid={}".format(
247	                settings.SERVER, settings.TENANT_ID, settings.CLIENT_ID

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	            logger.info("Trying to get OpenID Connect config from %s", config_url)
252	            response = self.session.get(config_url, timeout=settings.TIMEOUT)
253	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
255	
256	            response = self.session.get(openid_cfg["jwks_uri"], timeout=settings.TIMEOUT)
257	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
257	            response.raise_for_status()
258	            signing_certificates = [x["x5c"][0] for x in response.json()["keys"] if x.get("use", "sig") == "sig"]
259	            #                               ^^^

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
280	    def _load_federation_metadata(self):
281	        server_url = "https://{}".format(settings.SERVER)
282	        base_url = "{}/{}".format(server_url, settings.TENANT_ID)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
289	            logger.info("Trying to get ADFS Metadata file %s", adfs_config_url)
290	            response = self.session.get(adfs_config_url, timeout=settings.TIMEOUT)
291	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
297	        cert_nodes = xml_tree.findall(
298	            "./{urn:oasis:names:tc:SAML:2.0:metadata}RoleDescriptor"
299	            "[@{http://www.w3.org/2001/XMLSchema-instance}type='fed:SecurityTokenServiceType']"
300	            "/{urn:oasis:names:tc:SAML:2.0:metadata}KeyDescriptor[@use='signing']"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
306	        self._load_keys(signing_certificates)
307	        self.issuer = xml_tree.get("entityID")
308	        self.authorization_endpoint = base_url + "/oauth2/authorize"

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
317	            logger.debug("Loading public key from certificate: %s", cert)
318	            cert_obj = load_der_x509_certificate(base64.b64decode(cert), backend)
319	            new_keys.append(cert_obj.public_key())

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:318
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
317	            logger.debug("Loading public key from certificate: %s", cert)
318	            cert_obj = load_der_x509_certificate(base64.b64decode(cert), backend)
319	            new_keys.append(cert_obj.public_key())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
340	        if request.method == 'POST':
341	            redirect_to = request.POST.get(REDIRECT_FIELD_NAME, None)
342	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
342	        else:
343	            redirect_to = request.GET.get(REDIRECT_FIELD_NAME, None)
344	        if not redirect_to:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/config.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
345	            redirect_to = django_settings.LOGIN_REDIRECT_URL
346	        redirect_to = base64.urlsafe_b64encode(redirect_to.encode()).decode()
347	        query = QueryDict(mutable=True)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_auth_adfs-1.15.0/django_auth_adfs-1.15.0/django_auth_adfs/views.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
50	                if redirect_to:
51	                    redirect_to = base64.urlsafe_b64decode(redirect_to.encode()).decode()
52	                else:

--------------------------------------------------

Code scanned:
	Total lines of code: 922
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 1.0
Files skipped (0):
