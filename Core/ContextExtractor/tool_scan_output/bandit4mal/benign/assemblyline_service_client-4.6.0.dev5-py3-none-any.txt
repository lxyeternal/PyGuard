Run started:2025-04-12 13:46:29.799526

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	SUPPORTED_API = 'v1'
36	DEFAULT_REQUEST_TIMEOUT = int(os.environ.get("SERVICE_CLIENT_DEFAULT_REQUEST_TIMEOUT", 180))
37	TASK_REQUEST_TIMEOUT = int(os.environ.get('TASK_REQUEST_TIMEOUT', 30))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	DEFAULT_REQUEST_TIMEOUT = int(os.environ.get("SERVICE_CLIENT_DEFAULT_REQUEST_TIMEOUT", 180))
37	TASK_REQUEST_TIMEOUT = int(os.environ.get('TASK_REQUEST_TIMEOUT', 30))
38	FILE_REQUEST_TIMEOUT = int(os.environ.get('FILE_REQUEST_TIMEOUT', 180))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	TASK_REQUEST_TIMEOUT = int(os.environ.get('TASK_REQUEST_TIMEOUT', 30))
38	FILE_REQUEST_TIMEOUT = int(os.environ.get('FILE_REQUEST_TIMEOUT', 180))
39	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	# By default there is no limit, but this lets the orchestration environment set one
43	TASK_COMPLETE_LIMIT = float(os.environ.get('AL_SERVICE_TASK_LIMIT', 'inf'))
44	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	
56	        self.service_manifest_yml = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_manifest.yml"
57	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	        self.wait_start = None
62	        self.task_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_task.fifo"
63	        self.done_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_done.fifo"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	        self.task_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_task.fifo"
63	        self.done_fifo_path = f"/tmp/{os.environ.get('RUNTIME_PREFIX', 'service')}_done.fifo"
64	        self.task_fifo = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	        self.file_required = None
73	        self.service_api_host: str = api_host or os.environ.get('SERVICE_API_HOST') or 'http://localhost:5003'
74	        self.service_api_key: str = api_key or os.environ.get('SERVICE_API_KEY') or DEFAULT_API_KEY

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        self.file_required = None
73	        self.service_api_host: str = api_host or os.environ.get('SERVICE_API_HOST') or 'http://localhost:5003'
74	        self.service_api_key: str = api_key or os.environ.get('SERVICE_API_KEY') or DEFAULT_API_KEY

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	        self.service_api_host: str = api_host or os.environ.get('SERVICE_API_HOST') or 'http://localhost:5003'
74	        self.service_api_key: str = api_key or os.environ.get('SERVICE_API_KEY') or DEFAULT_API_KEY
75	        self.container_id: str = container_id or os.environ.get('HOSTNAME') or 'dev-service'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	        self.service_api_key: str = api_key or os.environ.get('SERVICE_API_KEY') or DEFAULT_API_KEY
75	        self.container_id: str = container_id or os.environ.get('HOSTNAME') or 'dev-service'
76	        self.session = requests.Session()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	        self.task = None
79	        self.tasking_dir = os.environ.get('TASKING_DIR', tempfile.gettempdir())
80	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	        if self.service_api_host.startswith('https'):
111	            self.session.verify = os.environ.get('SERVICE_SERVER_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca.crt')
112	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
113	        super().start()
114	        signal.signal(signal.SIGUSR1, self.handle_service_crash)
115	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:114
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
113	        super().start()
114	        signal.signal(signal.SIGUSR1, self.handle_service_crash)
115	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	
133	                    self.service_tool_version = self.service_manifest_data.get('tool_version')
134	                    self.file_required = self.service_manifest_data.get('file_required', True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	                    self.service_tool_version = self.service_manifest_data.get('tool_version')
134	                    self.file_required = self.service_manifest_data.get('file_required', True)
135	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	                    # Save the heuristics from service manifest
137	                    for heuristic in self.service_manifest_data.get('heuristics', []):
138	                        self.service_heuristics.append(heuristic)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
173	                    elif os.path.isdir(file_path):
174	                        shutil.rmtree(file_path)
175	                except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	                time.sleep(min(2, 2 ** (retry - 7)))
192	                stream = kwargs.get('files', {}).get('file', None)
193	                if stream and 'seek' in dir(stream):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	                time.sleep(min(2, 2 ** (retry - 7)))
192	                stream = kwargs.get('files', {}).get('file', None)
193	                if stream and 'seek' in dir(stream):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
260	                    # Send tasking message to run_service
261	                    self.task_fifo.write(f"{task_json_path}\n")
262	                    self.task_fifo.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
260	                    # Send tasking message to run_service
261	                    self.task_fifo.write(f"{task_json_path}\n")
262	                    self.task_fifo.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
381	                        if chunk:  # filter out keep-alive new chunks
382	                            f.write(chunk)
383	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
381	                        if chunk:  # filter out keep-alive new chunks
382	                            f.write(chunk)
383	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
419	
420	        new_tool_version = result.get('response', {}).get('service_tool_version', None)
421	        if new_tool_version is not None and self.service_tool_version != new_tool_version:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
419	
420	        new_tool_version = result.get('response', {}).get('service_tool_version', None)
421	        if new_tool_version is not None and self.service_tool_version != new_tool_version:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
437	                            "Ttl": str(task.ttl),
438	                            "Is-Section-Image": str(file_info.get('is_section_image', False)),
439	                            "Is-Supplementary": str(file_info.get('is_supplementary', False))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
438	                            "Is-Section-Image": str(file_info.get('is_section_image', False)),
439	                            "Is-Supplementary": str(file_info.get('is_supplementary', False))
440	                        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
514	    import sys
515	    register_arg = os.environ.get('REGISTER_ONLY', 'False').lower() == 'true'
516	    register_arg |= '--register' in sys.argv

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_service_client-4.6.0.dev5-py3-none-any/assemblyline_service_client/task_handler.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
517	
518	    ctr_mode = os.environ.get("CONTAINER_MODE", "False").lower() == 'true'
519	    TaskHandler(register_only=register_arg, container_mode=ctr_mode).serve_forever()

--------------------------------------------------

Code scanned:
	Total lines of code: 408
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 29.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 1.0
Files skipped (0):
