Run started:2025-04-12 13:19:04.775135

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	            "Host": self.getControlHost(),
115	            "Referer": "https://{host}".format(host=self.getControlHost()),
116	            "Accept": "application/json",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	    def getHostURL(self):
158	        return "https://{host}/stok={stok}/ds".format(
159	            host=self.getControlHost(), stok=self.stok

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	            url = f"http://{self.host}:{self.controlPort}"
168	            response = requests.get(url, timeout=timeout)
169	            return "200 OK" in response.text

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
304	            self.debugLog(redactedKwargs)
305	        response = session.request(method, url, **kwargs)
306	        if self.printDebugInformation:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
345	        if self.isSecureConnectionCached is None:
346	            url = "https://{host}".format(host=self.getControlHost())
347	            data = {

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
353	            }
354	            res = self.request(
355	                "POST", url, data=json.dumps(data), headers=self.headers, verify=False
356	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
445	        self.cnonce = generate_nonce(8).decode().upper()
446	        url = "https://{host}".format(host=self.getControlHost())
447	        if self.isSecureConnection():

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
466	            }
467	        res = self.request(
468	            "POST", url, data=json.dumps(data), headers=self.headers, verify=False
469	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
520	                    }
521	                    res = self.request(
522	                        "POST",
523	                        url,
524	                        data=json.dumps(data),
525	                        headers=self.headers,
526	                        verify=False,
527	                    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
744	                    "params": {
745	                        "request": base64.b64encode(
746	                            self.encryptRequest(json.dumps(fullRequest).encode("utf-8"))
747	                        ).decode("utf8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:745
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
744	                    "params": {
745	                        "request": base64.b64encode(
746	                            self.encryptRequest(json.dumps(fullRequest).encode("utf-8"))
747	                        ).decode("utf8")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
762	
763	            res = self.request(
764	                "POST",
765	                url,
766	                data=json.dumps(fullRequest),
767	                headers=self.headers,
768	                verify=False,
769	            )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
776	                encryptedResponse = responseData["result"]["response"]
777	                encryptedResponse = base64.b64decode(responseData["result"]["response"])
778	                try:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:777
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
776	                encryptedResponse = responseData["result"]["response"]
777	                encryptedResponse = base64.b64decode(responseData["result"]["response"])
778	                try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/__init__.py:2697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2696	                for request in requestData["params"]["requests"]
2697	                if request.get("method") not in omit_methods
2698	            ]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
26	            async with aiofiles.open(tempVideoFileLocation, "wb") as file:
27	                await file.write(self.writer.getvalue())
28	            tempAudioFileLocation = fileLocation + ".alaw"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
26	            async with aiofiles.open(tempVideoFileLocation, "wb") as file:
27	                await file.write(self.writer.getvalue())
28	            tempAudioFileLocation = fileLocation + ".alaw"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
29	            async with aiofiles.open(tempAudioFileLocation, "wb") as file:
30	                await file.write(self.audioWriter.getvalue())
31	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
29	            async with aiofiles.open(tempAudioFileLocation, "wb") as file:
30	                await file.write(self.audioWriter.getvalue())
31	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
38	            )
39	            os.system(cmd)
40	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:39
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
38	            )
39	            os.system(cmd)
40	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	            with tempfile.NamedTemporaryFile(delete=False) as tmp:
62	                tmp.write(self.writer.getvalue())
63	                result = subprocess.run(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
61	            with tempfile.NamedTemporaryFile(delete=False) as tmp:
62	                tmp.write(self.writer.getvalue())
63	                result = subprocess.run(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	        self.addedChunks += 1
115	        return self.writer.write(data) and self.audioWriter.write(audioData)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
114	        self.addedChunks += 1
115	        return self.writer.write(data) and self.audioWriter.write(audioData)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	        self.addedChunks += 1
115	        return self.writer.write(data) and self.audioWriter.write(audioData)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/convert.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
114	        self.addedChunks += 1
115	        return self.writer.write(data) and self.audioWriter.write(audioData)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/downloader.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	            async with aiofiles.open(fileName, "rb") as file:
48	                contents = await file.read()
49	            return hashlib.md5(contents).hexdigest()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/downloader.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	                            dataChunks += 1
142	                            convert.write(resp.plaintext, resp.audioPayload)
143	                            detectedLength = convert.getLength()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/session.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
97	            # Step one: perform unauthenticated request
98	            await self._send_http_request(req_line, headers)
99	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/session.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
153	            # Step two: start actual communication
154	            await self._send_http_request(req_line, headers)
155	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/session.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
356	
357	                await self._send_http_request(b"--" + self.client_boundary, headers)
358	                chunk_size = 4096

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/session.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
443	
444	        await self._send_http_request(b"--" + self.client_boundary, headers)
445	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/streamer.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
182	                        try:
183	                            os.write(self.audio_w, resp.audioPayload)
184	                        except OSError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/streamer.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
187	                    else:
188	                        self.hlsProcess.stdin.write(resp.plaintext)
189	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/tmp.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	                        )  # Debugging
88	                        self.process.stdin.write(resp.plaintext)
89	                        self.process.stdin.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/pytapo/media_stream/tmp.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
93	
94	            stderr_output = self.process.stderr.read().decode()
95	            print(stderr_output)  # Print FFmpeg errors

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytapo-3.3.42/pytapo-3.3.42/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    long_description_content_type="text/markdown",
15	    url="https://github.com/JurajNyiri/pytapo",
16	    packages=setuptools.find_packages(),

--------------------------------------------------

Code scanned:
	Total lines of code: 3920
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 30.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 3.0
Files skipped (0):
