Run started:2025-04-12 12:05:10.067820

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_parse_requirements.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
260	        with open(pyproject_toml, encoding="utf-8") as f:
261	            pp_toml = tomli.loads(f.read())
262	            name = pp_toml.get("project", {}).get("name")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_parse_requirements.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
269	        with open(os.path.join(path, "setup.py")) as f:
270	            tree = ast.parse(f.read())
271	        setup_kwargs = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/__about__.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	__summary__ = "Core utilities for Python packages"
18	__uri__ = "https://github.com/pypa/packaging"
19	
20	__version__ = "21.0"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/_manylinux.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	            try:
38	                data = file.read(struct.calcsize(fmt))
39	                result: Tuple[int, ...] = struct.unpack(fmt, data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/_manylinux.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
55	        self.e_ident_abiversion = unpack("B")
56	        self.e_ident_pad = file.read(7)
57	        format_h = "<H" if self.e_ident_data == self.ELFDATA2LSB else ">H"

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/_manylinux.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
176	    try:
177	        process_namespace = ctypes.CDLL(None)
178	    except OSError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/_musllinux.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
18	def _read_unpacked(f: IO[bytes], fmt: str) -> Tuple[int, ...]:
19	    return struct.unpack(fmt, f.read(struct.calcsize(fmt)))
20	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/_musllinux.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
63	        f.seek(p_offset)
64	        interpreter = os.fsdecode(f.read(p_filesz)).strip("\0")
65	        if "musl" not in interpreter:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/markers.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
265	        "platform_release": platform.release(),
266	        "platform_system": platform.system(),
267	        "platform_version": platform.version(),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/markers.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
265	        "platform_release": platform.release(),
266	        "platform_system": platform.system(),
267	        "platform_version": platform.version(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/markers.py:266
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
265	        "platform_release": platform.release(),
266	        "platform_system": platform.system(),
267	        "platform_version": platform.version(),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/tags.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
437	    """
438	    if platform.system() == "Darwin":
439	        return mac_platforms()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/tags.py:438
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
437	    """
438	    if platform.system() == "Darwin":
439	        return mac_platforms()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/tags.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
439	        return mac_platforms()
440	    elif platform.system() == "Linux":
441	        return _linux_platforms()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/packaging/tags.py:440
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
439	        return mac_platforms()
440	    elif platform.system() == "Linux":
441	        return _linux_platforms()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/pip_api/_vendor/tomli/_parser.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
58	    """Parse TOML from a binary file object."""
59	    b = __fp.read()
60	    try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/setup.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	    python_requires=">=3.8",
29	    url="http://github.com/di/pip-api",
30	    summary="An unofficial, importable pip API",

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/tests/conftest.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
61	    # directory while running the tests.
62	    shutil.rmtree(str(tmpdir), ignore_errors=True)
63	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/tests/conftest.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
116	    del os.environ["PIPAPI_PYTHON_LOCATION"]
117	    shutil.rmtree(venv_location)
118	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/tests/test_parse_requirements.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    files = {
34	        "a.txt": ["{} https://example.com/pypi/simple\n".format(flag), "foo==1.2.3\n"]
35	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/tests/test_parse_requirements.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	PEP508_PIP_EXAMPLE_URL = (
45	    "https://github.com/pypa/pip/archive/1.3.1.zip"
46	    "#sha1=da9234ee9982d4bbb3c72346a6de940a148ea686"
47	)
48	PEP508_PIP_EXAMPLE_WHEEL = (
49	    "https://github.com/pypa/pip/archive/pip-1.3.1-py2.py3-none-any.whl"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/tests/test_parse_requirements.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	PEP508_PIP_EXAMPLE_WHEEL = (
49	    "https://github.com/pypa/pip/archive/pip-1.3.1-py2.py3-none-any.whl"
50	)
51	PEP508_PIP_EXAMPLE_EGG = (
52	    "ssh://git@github.com/pypa/pip.git@da9234ee9982d4bbb3c72346a6de940a148ea686#egg=pip"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/tests/test_parse_requirements.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	def test_parse_requirements_vcs(monkeypatch):
121	    requirement_text = "git+https://github.com/bar/foo"
122	    files = {"a.txt": [requirement_text + "\n"]}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/tests/test_parse_requirements.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	def test_include_invalid_requirement(monkeypatch):
130	    requirement_text = "git+https://github.com/bar/foo"
131	    files = {"a.txt": [requirement_text + "\n"]}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/tests/test_parse_requirements.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
182	    files = {
183	        "a.txt": ["Django==1.11\n" "-e git+https://github.com/foo/deal.git#egg=deal\n"]
184	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/tests/test_parse_requirements.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
191	    assert not result["django"].editable
192	    assert str(result["deal"]) == "deal@ git+https://github.com/foo/deal.git#egg=deal"
193	    assert result["deal"].editable

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pip_api-0.0.34/pip_api-0.0.34/tests/test_parse_requirements.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
268	    files = {
269	        "a.txt": ["https://github.com/pypa/pip/archive/" + INVALID_WHEEL_NAME],
270	    }

--------------------------------------------------

Code scanned:
	Total lines of code: 9525
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 3.0
Files skipped (0):
