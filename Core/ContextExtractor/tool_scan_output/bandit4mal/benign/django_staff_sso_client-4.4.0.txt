Run started:2025-04-12 14:48:13.608010

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/authbroker_client/utils.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	        scope=get_scope(),
31	        token=request.session.get(TOKEN_SESSION_KEY, None),
32	        **kwargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/authbroker_client/utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	def get_profile(client):
46	    return client.get(PROFILE_URL).json()
47	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/setup.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6	with open(os.path.join(os.path.dirname(__file__), 'README.md')) as readme:
7	    README = readme.read()
8	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
17	        return str(ast.literal_eval(
18	            pattern.search(src.read().decode('utf-8')).group(1)
19	        ))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    packages=find_packages(),
26	    url='https://github.com/uktrade/django-staff-sso-client/',
27	    author='Department for International Trade',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/tests/settings.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	# authbroker config
31	AUTHBROKER_URL = 'https://test.com'
32	AUTHBROKER_CLIENT_ID = 'debug'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/tests/test_utils.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	    with requests_mock.Mocker() as m:
24	        m.get('https://test.com/api/v1/user/me/', json={'a': 'b'})
25	        token = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/tests/test_utils.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    with requests_mock.Mocker() as m:
24	        m.get('https://test.com/api/v1/user/me/', json={'a': 'b'})
25	        token = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/tests/test_utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	        mock_request = mock.Mock(session={'_authbroker_token': token})
32	        mock_request.build_absolute_uri.return_value = 'https://test.com'
33	        client = get_client(request=mock_request)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/tests/test_utils.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    mock_request = mock.Mock(session={'_authbroker_token': token})
45	    mock_request.build_absolute_uri.return_value = 'https://test.com'
46	    client = get_client(request=mock_request)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/tests/test_utils.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	    mock_request = mock.Mock(session={'_authbroker_token': token})
89	    mock_request.build_absolute_uri.return_value = 'https://test.com'
90	    client = get_client(request=mock_request,)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/tests/test_views.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	def test_auth_view_retains_unsafe_next_url(client):
30	    url = reverse('authbroker:login') + '?next=https://danger.com'
31	    response = client.get(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_staff_sso_client-4.4.0/django_staff_sso_client-4.4.0/tests/test_views.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        f'{TOKEN_SESSION_KEY}_oauth_state': 'state',
95	        REDIRECT_SESSION_FIELD_NAME: 'https://danger.com/'
96	    }
97	    request.GET = {'code': 'foo'}
98	    response = AuthCallbackView.as_view()(request)

--------------------------------------------------

Code scanned:
	Total lines of code: 645
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 5.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 0.0
Files skipped (0):
