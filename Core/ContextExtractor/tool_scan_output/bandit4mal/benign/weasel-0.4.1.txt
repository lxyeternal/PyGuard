Run started:2025-04-12 11:34:14.398409

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/about.py:1
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	__projects__ = "https://github.com/explosion/projects"
2	__projects_branch__ = "v3"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/assets.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	        asset
66	        for asset in config.get("assets", [])
67	        if extra or not asset.get("extra", EXTRA_DEFAULT)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/assets.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	        for asset in config.get("assets", [])
67	        if extra or not asset.get("extra", EXTRA_DEFAULT)
68	    ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/assets.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	        dest = (project_dir / asset["dest"]).resolve()
78	        checksum = asset.get("checksum")
79	        if "git" in asset:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/assets.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
93	                    if dest.is_dir():
94	                        shutil.rmtree(dest)
95	                    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/assets.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	                dest,
110	                branch=asset["git"].get("branch"),
111	                sparse=sparse_checkout,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/assets.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	        else:
115	            url = asset.get("url")
116	            if not url:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/document.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	
8	DOCS_URL = "https://github.com/explosion/weasel"
9	INTRO_PROJECT = f"""The [`{PROJECT_FILE}`]({PROJECT_FILE}) defines the data assets required by the

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/dvc.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
192	            "to be installed and the 'dvc' command needs to be available",
193	            "You can install the Python package from pip (pip install dvc) or "
194	            "conda (conda install -c conda-forge dvc). For more details, see the "
195	            "documentation: https://dvc.org/doc/install",
196	            exits=1,
197	        )
198	    if not (project_dir / ".dvc").exists():
199	        msg.fail(
200	            "Project not initialized as a DVC project",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/dvc.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	            "Project not initialized as a DVC project",
201	            "To initialize a DVC project, you can run 'dvc init' in the project "
202	            "directory. For more details, see the documentation: "
203	            "https://dvc.org/doc/command-reference/init",
204	            exits=1,
205	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/main.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	NAME = "weasel"
5	HELP = """weasel Command-line Interface
6	
7	DOCS: https://github.com/explosion/weasel
8	"""
9	
10	PROJECT_FILE = "project.yml"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/remote_storage.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
50	            mode_string = f"w:{self.compression}" if self.compression else "w"
51	            with tarfile.open(tar_loc, mode=mode_string) as tar_file:
52	                tar_file.add(str(loc), arcname=str(path))

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/cli/remote_storage.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
83	                mode_string = f"r:{self.compression}" if self.compression else "r"
84	                with tarfile.open(tar_loc, mode=mode_string) as tar_file:
85	                    # This requires that the path is added correctly, relative

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	                "extra": True,
39	                "url": "https://example.com",
40	                "checksum": "63373dd656daa1fd3043ce166a59474c",
41	            },
42	            {
43	                "dest": "y",
44	                "git": {
45	                    "repo": "https://github.com/example/repo",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	                "git": {
45	                    "repo": "https://github.com/example/repo",
46	                    "branch": "develop",
47	                    "path": "y",
48	                },
49	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	                "extra": False,
53	                "url": "https://example.com",
54	                "checksum": "63373dd656daa1fd3043ce166a59474c",
55	            },
56	        ],
57	        "commands": [
58	            {

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
129	            with loc_file.open(mode="w") as file_:
130	                file_.write(content)
131	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
139	            with loc_file.open(mode="r") as file_:
140	                assert file_.read() == content
141	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	            with loc_file.open(mode="r") as file_:
146	                assert file_.read() == content
147	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
151	            with loc_file.open(mode="r") as file_:
152	                assert file_.read() == content
153	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
157	            with loc_file.open(mode="r") as file_:
158	                assert file_.read() == content
159	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
173	        git_checkout(
174	            "https://github.com/explosion/os-signpost.git",
175	            "os_signpost",
176	            d / "signpost",
177	            branch="v0.0.3",
178	        )
179	        assert os.path.isdir(d / "signpost")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	        git_checkout(
187	            "https://github.com/explosion/os-signpost.git",
188	            "README.md",
189	            d / "readme.md",
190	            branch="v0.0.3",
191	        )
192	        assert os.path.isfile(d / "readme.md")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli_app.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	            "dest": "assets/weasel-readme.md",
37	            "url": "https://github.com/explosion/weasel/raw/9a3632862b47069d2f9033b773e814d4c4e09c83/README.md",
38	            "checksum": "65f4c426a9b153b7683738c92d0d20f9",
39	        },
40	        {
41	            "dest": "assets/pyproject.toml",
42	            "url": "https://github.com/explosion/weasel/raw/9a3632862b47069d2f9033b773e814d4c4e09c83/pyproject.toml",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli_app.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	            "dest": "assets/pyproject.toml",
42	            "url": "https://github.com/explosion/weasel/raw/9a3632862b47069d2f9033b773e814d4c4e09c83/pyproject.toml",
43	            "checksum": "1e2da3a3030d6611520952d5322cd94e",
44	            "extra": True,
45	        },
46	    ],
47	    "commands": [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_cli_app.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	        "--branch v3",
151	        "--repo https://github.com/explosion/projects --branch v3",
152	    ],
153	)
154	def test_project_clone(tmp_path: Path, options_string: str):
155	    out = tmp_path / "project_clone"
156	    target = "benchmarks/ner_conll03"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_document.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	            "dest": "assets/weasel-readme.md",
19	            "url": "https://github.com/explosion/weasel/raw/9a3632862b47069d2f9033b773e814d4c4e09c83/README.md",
20	            "checksum": "65f4c426a9b153b7683738c92d0d20f9",
21	        },
22	        {
23	            "dest": "assets/pyproject.toml",
24	            "url": "https://github.com/explosion/weasel/raw/9a3632862b47069d2f9033b773e814d4c4e09c83/pyproject.toml",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_document.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	            "dest": "assets/pyproject.toml",
24	            "url": "https://github.com/explosion/weasel/raw/9a3632862b47069d2f9033b773e814d4c4e09c83/pyproject.toml",
25	            "checksum": "1e2da3a3030d6611520952d5322cd94e",
26	            "extra": True,
27	        },
28	    ],
29	    "commands": [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/cli/test_remote.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	    """Cloning shouldn't fail"""
30	    repo = "https://github.com/explosion/weasel"
31	    branch = "main"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/test_validation.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	                "extra": True,
33	                "url": "https://example.com",
34	                "checksum": "63373dd656daa1fd3043ce166a59474c",
35	            },
36	            {
37	                "dest": "y",
38	                "git": {
39	                    "repo": "https://github.com/example/repo",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/test_validation.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	                "git": {
39	                    "repo": "https://github.com/example/repo",
40	                    "branch": "develop",
41	                    "path": "y",
42	                },
43	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/tests/test_validation.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	                "extra": False,
47	                "url": "https://example.com",
48	                "checksum": "63373dd656daa1fd3043ce166a59474c",
49	            },
50	        ],
51	        "commands": [
52	            {

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/util/filesystem.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
44	    def force_remove(rmfunc, path, ex):
45	        os.chmod(path, stat.S_IWRITE)
46	        rmfunc(path)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/util/filesystem.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
44	    def force_remove(rmfunc, path, ex):
45	        os.chmod(path, stat.S_IWRITE)
46	        rmfunc(path)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/util/filesystem.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
49	        if sys.version_info >= (3, 12):
50	            shutil.rmtree(str(d), onexc=force_remove)
51	        else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/weasel-0.4.1/weasel-0.4.1/weasel/util/filesystem.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
51	        else:
52	            shutil.rmtree(str(d), onerror=force_remove)
53	    except PermissionError as e:

--------------------------------------------------

Code scanned:
	Total lines of code: 2543
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 16.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 1.0
Files skipped (0):
