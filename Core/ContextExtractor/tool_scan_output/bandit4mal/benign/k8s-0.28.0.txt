Run started:2025-04-12 12:11:24.771924

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/docs/source/conf.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
196	# Example configuration for intersphinx: refer to the Python standard library.
197	intersphinx_mapping = {'https://docs.python.org/': None}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	        selector = cls._label_selector(labels)
110	        resp = cls._client.get(url, params={"labelSelector": selector})
111	        return [cls.from_dict(item) for item in resp.json()["items"]]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	            url = cls._build_url(name="", namespace=namespace)
122	        resp = cls._client.get(url)
123	        return resp

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	            # so each time data is received, the timeout will reset.
161	            resp = cls._client.get(url, stream=True, timeout=config.stream_timeout, params=params)
162	            for line in resp.iter_lines(chunk_size=None):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
233	        url = cls._build_url(name=name, namespace=namespace)
234	        resp = cls._client.get(url)
235	        instance = cls.from_dict(resp.json())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	        try:
242	            metadata = kwargs.get("metadata")
243	            instance = cls.get(metadata.name, metadata.namespace)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
242	            metadata = kwargs.get("metadata")
243	            instance = cls.get(metadata.name, metadata.namespace)
244	            for field in cls._meta.fields:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
268	            url = self._build_url(name="", namespace=self.metadata.namespace)
269	            resp = self._client.post(url, self.as_dict())
270	            self._new = False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
365	        for field in self._meta.fields:
366	            field.load(self, d.get(_api_name(field.name)))
367	        self._validate_fields()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	        if event_json is not None:
400	            self.resource_version = event_json["object"].get("metadata", {}).get("resourceVersion")
401	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	        if event_json is not None:
400	            self.resource_version = event_json["object"].get("metadata", {}).get("resourceVersion")
401	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
531	        code = self.api_error["code"]
532	        reason = self.api_error.get("reason", "(unset)")
533	        message = self.api_error.get("message", "(unset)")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
532	        reason = self.api_error.get("reason", "(unset)")
533	        message = self.api_error.get("message", "(unset)")
534	        return f"{code}: reason={reason} message={message}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
537	    def match(cls, event_json):
538	        return event_json["type"] == "ERROR" and event_json["object"].get("kind") == "Status"
539	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
558	    def from_dict(cls, model_cls: type[Model], list_response_data: Dict):
559	        metadata = ListMeta.from_dict(list_response_data.get('metadata', {}))
560	        items = [model_cls.from_dict(item) for item in list_response_data.get('items', [])]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/base.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
559	        metadata = ListMeta.from_dict(list_response_data.get('metadata', {}))
560	        items = [model_cls.from_dict(item) for item in list_response_data.get('items', [])]
561	        return cls(metadata, items)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/client.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
124	        self.init_session()
125	        resp = self._session.request(method, config.api_server + url, json=body, timeout=timeout, **kwargs)
126	        if config.debug and not kwargs.get('stream', False):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/client.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	        resp = self._session.request(method, config.api_server + url, json=body, timeout=timeout, **kwargs)
126	        if config.debug and not kwargs.get('stream', False):
127	            message = ['{:d} for url: {:s}'.format(resp.status_code, resp.url)]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/client.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
127	            message = ['{:d} for url: {:s}'.format(resp.status_code, resp.url)]
128	            Client._add_request(message, resp.request)
129	            Client._add_response(message, resp)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/client.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
151	        Client._add_causes(message, resp)
152	        Client._add_request(message, request)
153	        Client._add_response(message, resp)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/client.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	            json_response = resp.json()
160	            json_causes = json_response.get(u"details", {}).get(u"causes", {})
161	            if json_causes:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/client.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	            json_response = resp.json()
160	            json_causes = json_response.get(u"details", {}).get(u"causes", {})
161	            if json_causes:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/config.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	#: API server URL
25	api_server = "https://kubernetes.default.svc.cluster.local"
26	#: API token
27	api_token = ""

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/k8s/config.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
91	            with open(self._token_file, 'r') as f:
92	                self._token = f.read().strip()
93	                self._expires_at = now + self._refresh_interval

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/setup.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
45	def _generate_description():
46	    description = [_read("README.rst")]
47	    changelog_file = os.getenv("CHANGELOG_FILE")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/setup.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	    if changelog_file:
49	        description.append(_read(changelog_file))
50	    return "\n".join(description)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/setup.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	    with open(os.path.join(os.path.dirname(__file__), filename)) as f:
62	        return f.read()
63	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/setup.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	        long_description=_generate_description(),
87	        url="https://github.com/fiaas/k8s",
88	        license=_get_license_name(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/conftest.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	    """Configure k8s for test-runs"""
43	    monkeypatch.setattr(config, "api_server", "http://localhost:8080")
44	    monkeypatch.setattr(config, "verify_ssl", False)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_client.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	
57	    @pytest.mark.parametrize("url", ["http://api.k8s.example.com", "https://api.k8s.example.com"])
58	    def test_session_configured_for_retry(self, url):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_client.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	
57	    @pytest.mark.parametrize("url", ["http://api.k8s.example.com", "https://api.k8s.example.com"])
58	    def test_session_configured_for_retry(self, url):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_client.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	    def test_get_should_use_default_timeout(self, session, client, url):
66	        client.get(url)
67	        session.request.assert_called_once_with("GET", _absolute_url(url), json=None, timeout=config.timeout)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_client.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	    def test_get_should_propagate_timeout(self, session, client, url, explicit_timeout):
70	        client.get(url, timeout=explicit_timeout)
71	        session.request.assert_called_once_with("GET", _absolute_url(url), json=None, timeout=explicit_timeout)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_client.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
97	        body = {"foo": "bar"}
98	        client.post(url, body=body)
99	        session.request.assert_called_once_with("POST", _absolute_url(url), json=body, timeout=config.timeout)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_client.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
102	        body = {"foo": "bar"}
103	        client.post(url, body=body, timeout=explicit_timeout)
104	        session.request.assert_called_once_with("POST", _absolute_url(url), json=body, timeout=explicit_timeout)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_model.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	                "generateName": "my-generated-name",
115	                "selfLink": "http://this.link.stays.example.com"
116	            }
117	        }
118	        metadata = ObjectMeta(name="my-name", namespace="my-namespace", generateName="my-new-generated-name")
119	        instance = ModelTest.get_or_create(metadata=metadata)
120	        assert instance.metadata.generateName == "my-new-generated-name"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_model.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	        assert instance.metadata.generateName == "my-new-generated-name"
121	        assert instance.metadata.selfLink == "http://this.link.stays.example.com"
122	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_secret.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
117	        for key, value in string_data.items():
118	            converted["data"][key] = base64.b64encode(value.encode("utf-8"))
119	    return converted

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_secret.py:118
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
117	        for key, value in string_data.items():
118	            converted["data"][key] = base64.b64encode(value.encode("utf-8"))
119	    return converted

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_service.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
86	                ],
87	                "clusterIP": "10.0.0.54", "type": "ClusterIP", "sessionAffinity": "None"
88	            },
89	            "status": {
90	                "loadBalancer": {}
91	            }
92	        }
93	        get.return_value = mock_response
94	
95	        metadata = ObjectMeta(name=SERVICE_NAME, namespace=SERVICE_NAMESPACE, labels={"app": "test"})

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_service.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
139	                        ],
140	                        "clusterIP": "10.0.0.1", "type": "ClusterIP", "sessionAffinity": "None"
141	                    },
142	                    "status": {
143	                        "loadBalancer": {}
144	                    }
145	                },
146	                {
147	                    "kind": "Service",
148	                    "apiVersion": "v1",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/k8s-0.28.0/k8s-0.28.0/tests/k8s/test_service.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
162	                        ],
163	                        "clusterIP": "10.0.0.2", "type": "ClusterIP", "sessionAffinity": "None"
164	                    },
165	                    "status": {
166	                        "loadBalancer": {}
167	                    }
168	                }
169	            ]
170	        }
171	        mock_response = mock.Mock()

--------------------------------------------------

Code scanned:
	Total lines of code: 4436
	Total lines skipped (#nosec): 5

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 30.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 41.0
		High: 1.0
Files skipped (0):
