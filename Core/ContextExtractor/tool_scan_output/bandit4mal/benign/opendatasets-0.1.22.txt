Run started:2025-04-12 15:16:16.445836

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/datasets/owid-covid-19-latest/__init__.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	URLs = [
4	    'https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-data.csv',
5	    'https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-data-last-updated-timestamp.txt',
6	    'https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-codebook.csv'
7	]
8	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/datasets/owid-covid-19-latest/__init__.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	    'https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-data.csv',
5	    'https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-data-last-updated-timestamp.txt',
6	    'https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-codebook.csv'
7	]
8	
9	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/datasets/owid-covid-19-latest/__init__.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	    'https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-data-last-updated-timestamp.txt',
6	    'https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-codebook.csv'
7	]
8	
9	
10	def download(dataset_id, data_dir, dry_run, **kwargs):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/__init__.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	
3	GITHUB_RAW_BASE_URL = 'https://raw.githubusercontent.com/JovianML/opendatasets/master/data/'
4	
5	
6	def download_raw_files(dataset_id, data_dir, dry_run, files):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/archive.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
39	    if _is_tar(from_path):
40	        with tarfile.open(from_path, 'r') as tar:
41	            tar.extractall(path=to_path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/archive.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
42	    elif _is_targz(from_path) or _is_tgz(from_path):
43	        with tarfile.open(from_path, 'r:gz') as tar:
44	            tar.extractall(path=to_path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/archive.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
45	    elif _is_tarxz(from_path):
46	        with tarfile.open(from_path, 'r:xz') as tar:
47	            tar.extractall(path=to_path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/archive.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
50	            os.path.basename(from_path))[0])
51	        with open(to_path, "wb") as out_f, gzip.GzipFile(from_path) as zip_f:
52	            out_f.write(zip_f.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/archive.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	        with open(to_path, "wb") as out_f, gzip.GzipFile(from_path) as zip_f:
52	            out_f.write(zip_f.read())
53	    elif _is_zip(from_path):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/archive.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	        with open(to_path, "wb") as out_f, gzip.GzipFile(from_path) as zip_f:
52	            out_f.write(zip_f.read())
53	    elif _is_zip(from_path):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/googledrive.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	def is_google_drive_url(url):
31	    return url.startswith('https://drive.google.com') or url.startswith('http://drive.google.com') or url.startswith('drive.google.com')
32	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/googledrive.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	def is_google_drive_url(url):
31	    return url.startswith('https://drive.google.com') or url.startswith('http://drive.google.com') or url.startswith('drive.google.com')
32	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/googledrive.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	        raise e
66	    url = "https://docs.google.com/uc?export=download"
67	
68	    root = os.path.expanduser(root)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/googledrive.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	        session = requests.Session()
77	        response = session.get(url, params={'id': file_id}, stream=True)
78	        token = _get_confirm_token(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/googledrive.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	            params = {'id': file_id, 'confirm': token}
81	            response = session.get(url, params=params, stream=True)
82	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/googledrive.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	            if chunk:  # filter out keep-alive new chunks
115	                f.write(chunk)
116	                progress += len(chunk)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/kaggle_api.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	            with open('./kaggle.json', 'r') as f:
24	                key = f.read()
25	                data = json.loads(key)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/kaggle_api.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    if not read_kaggle_creds():
45	        print("Please provide your Kaggle credentials to download this dataset. Learn more: http://bit.ly/kaggle-creds")
46	        os.environ['KAGGLE_USERNAME'] = click.prompt("Your Kaggle username")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/kaggle_direct.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	                'www.kaggle.com',
9	                'http://kaggle.com',
10	                'http://www.kaggle.com',
11	                'https://www.kaggle.com',
12	                'https://kaggle.com']
13	    return any((url.startswith(prefix) for prefix in prefixes))
14	
15	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/kaggle_direct.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	                'http://kaggle.com',
10	                'http://www.kaggle.com',
11	                'https://www.kaggle.com',
12	                'https://kaggle.com']
13	    return any((url.startswith(prefix) for prefix in prefixes))
14	
15	
16	def get_kaggle_dataset_id(dataset_id_or_url):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/kaggle_direct.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	                'http://www.kaggle.com',
11	                'https://www.kaggle.com',
12	                'https://kaggle.com']
13	    return any((url.startswith(prefix) for prefix in prefixes))
14	
15	
16	def get_kaggle_dataset_id(dataset_id_or_url):
17	    parts = []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/kaggle_direct.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	                'https://www.kaggle.com',
12	                'https://kaggle.com']
13	    return any((url.startswith(prefix) for prefix in prefixes))
14	
15	
16	def get_kaggle_dataset_id(dataset_id_or_url):
17	    parts = []
18	    dataset_id_or_url = dataset_id_or_url.replace("/datasets/", "/")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/kaggle_direct.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	def get_kaggle_download_hash(dataset_id):
30	    download_page_url = 'https://www.kaggle.com/' + dataset_id + '/download'
31	    with urlopen(download_page_url) as response:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/kaggle_direct.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    print('Kaggle dataset ID: ', dataset_id)
40	    raw_dataset_url = ('https://www.kaggle.com/' +
41	                       dataset_id +
42	                       '/download?resource=download&downloadHash=' +

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/md5.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	    with open(fpath, 'rb') as f:
8	        for chunk in iter(lambda: f.read(chunk_size), b''):
9	            md5.update(chunk)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/network.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
35	    if not filename:
36	        remotefile = urlopen(url)
37	        _, params = cgi.parse_header(remotefile.info().get('Content-Disposition', ''))

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/network.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
52	            if not dry_run:
53	                urlretrieve(
54	                    url, fpath,
55	                    reporthook=gen_bar_updater()
56	                )

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/network.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
62	                      ' Downloading ' + url + ' to ' + fpath)
63	                urlretrieve(
64	                    url, fpath,
65	                    reporthook=gen_bar_updater()
66	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    long_description_content_type="text/markdown",
25	    url="https://github.com/JovianML/opendatasets",
26	    packages=setuptools.find_packages(),

--------------------------------------------------

Code scanned:
	Total lines of code: 448
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 0.0
Files skipped (0):
