Run started:2025-04-12 10:32:19.663860

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
179	        auth_string = f"{self._api_key}:{self._secret_key}"
180	        auth_string_encoded = base64.b64encode(str.encode(auth_string))
181	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:180
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
179	        auth_string = f"{self._api_key}:{self._secret_key}"
180	        auth_string_encoded = base64.b64encode(str.encode(auth_string))
181	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	        total_items = 0
198	        page_size = params.get("limit", 100)
199	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	
207	            response = self.get(endpoint, params)
208	            if response is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
209	                break
210	            result = response.get(response_field, None)
211	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	
233	            page_token = response.get("next_page_token", None)
234	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
257	        data = account_data.to_request_fields()
258	        response = self.post("/accounts", data)
259	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
280	
281	        resp = self.get(f"/accounts/{account_id}", {"params": ""})
282	        return Account(**resp)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
359	
360	        self.post(f"/accounts/{account_id}/actions/close")
361	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
381	
382	        response = self.get(
383	            f"/accounts",
384	            params,
385	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
407	
408	        result = self.get(f"/trading/accounts/{account_id}/account")
409	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
446	
447	        self.post(
448	            f"/accounts/{account_id}/documents/upload",
449	            [document.to_request_fields() for document in document_data],
450	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
467	
468	        resp = self.get(f"/trading/accounts/{account_id}/account/configurations")
469	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
611	
612	            result = self.get("/accounts/activities", request_fields)
613	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
692	
693	        result = self.get(
694	            f"/accounts/{account_id}/documents",
695	            documents_filter.to_request_fields() if documents_filter else {},
696	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
724	
725	        response = self.get(f"/accounts/{account_id}/documents/{document_id}")
726	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:764
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
763	        while num_tries <= self._retry:
764	            response = self._session.get(
765	                url=target_url,
766	                headers=self._get_default_headers(),
767	                allow_redirects=True,
768	                stream=True,
769	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
794	            for chunk in response.iter_content(chunk_size=None):
795	                f.write(chunk)
796	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
824	
825	        response = self.post(
826	            f"/accounts/{account_id}/ach_relationships", ach_data.to_request_fields()
827	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
854	
855	        response = self.get(f"/accounts/{account_id}/ach_relationships", params)
856	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
898	        account_id = validate_uuid_id_param(account_id)
899	        response = self.post(
900	            f"/accounts/{account_id}/recipient_banks", bank_data.to_request_fields()
901	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
921	        account_id = validate_uuid_id_param(account_id)
922	        response = self.get(f"/accounts/{account_id}/recipient_banks")
923	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
964	        account_id = validate_uuid_id_param(account_id)
965	        response = self.post(
966	            f"/accounts/{account_id}/transfers", transfer_data.to_request_fields()
967	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1027	            request_fields["offset"] = total_items
1028	            result = self.get(f"/accounts/{account_id}/transfers", request_fields)
1029	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1085
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1084	        account_id = validate_uuid_id_param(account_id)
1085	        response = self.get(f"/trading/accounts/{account_id}/positions")
1086	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1099	        """
1100	        response = self.get("/accounts/positions")
1101	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1121	        symbol_or_asset_id = validate_symbol_or_asset_id(symbol_or_asset_id)
1122	        response = self.get(
1123	            f"/trading/accounts/{account_id}/positions/{symbol_or_asset_id}"
1124	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1206	
1207	        response = self.get(
1208	            f"/trading/accounts/{account_id}/account/portfolio/history",
1209	            history_filter.to_request_fields() if history_filter else {},
1210	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1227	
1228	        response = self.get("/clock")
1229	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1252	
1253	        result = self.get(
1254	            "/calendar", filters.to_request_fields() if filters is not None else {}
1255	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1278	
1279	        result = self.get(f"/trading/accounts/{account_id}/watchlists")
1280	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1303	
1304	        result = self.get(f"/trading/accounts/{account_id}/watchlists/{watchlist_id}")
1305	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1327	
1328	        result = self.post(
1329	            f"/trading/accounts/{account_id}/watchlists",
1330	            watchlist_data.to_request_fields(),
1331	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1390	
1391	        result = self.post(
1392	            f"/trading/accounts/{account_id}/watchlists/{watchlist_id}", params
1393	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1467	
1468	        response = self.post("/journals", params)
1469	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1491	
1492	        response = self.post("/journals/batch", params)
1493	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1515	
1516	        response = self.post("/journals/reverse_batch", params)
1517	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1536	
1537	        response = self.get("/journals", params)
1538	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1557	
1558	        response = self.get(f"/journals/{journal_id}")
1559	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1599	
1600	        response = self.get(f"/assets", params)
1601	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1622	
1623	        response = self.get(f"/assets/{symbol_or_asset_id}")
1624	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1648	
1649	        response = self.post(f"/trading/accounts/{account_id}/orders", data)
1650	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1676	
1677	        response = self.get(f"/trading/accounts/{account_id}/orders", params)
1678	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1708	
1709	        response = self.get(f"/trading/accounts/{account_id}/orders/{order_id}", params)
1710	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1732	
1733	        response = self.get(
1734	            f"/trading/accounts/{account_id}/orders:by_client_order_id", params
1735	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1831	
1832	        response = self.get("/corporate_actions/announcements", params)
1833	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1854	
1855	        response = self.get(
1856	            f"/corporate_actions/announcements/{corporate_announcment_id}"
1857	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1885	
1886	        response = self._session.get(
1887	            url=url,
1888	            params=params,
1889	            stream=True,
1890	            headers=self._get_sse_headers(),
1891	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1914	
1915	        response = self._session.get(
1916	            url=url,
1917	            params=params,
1918	            stream=True,
1919	            headers=self._get_sse_headers(),
1920	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1943	
1944	        response = self._session.get(
1945	            url=url,
1946	            params=params,
1947	            stream=True,
1948	            headers=self._get_sse_headers(),
1949	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:1975
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1974	
1975	        response = self._session.get(
1976	            url=url,
1977	            params=params,
1978	            stream=True,
1979	            headers=self._get_sse_headers(),
1980	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:2006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2005	
2006	        response = self._session.get(
2007	            url=url,
2008	            params=params,
2009	            stream=True,
2010	            headers=self._get_sse_headers(),
2011	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:2045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2044	
2045	        response = self.post(
2046	            "/rebalancing/portfolios", data=portfolio_request.to_request_fields()
2047	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:2070
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2069	
2070	        response = self.get(
2071	            "/rebalancing/portfolios", filter.to_request_fields() if filter else {}
2072	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:2094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2093	
2094	        response = self.get(f"/rebalancing/portfolios/{portfolio_id}")
2095	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:2162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2161	
2162	        response = self.post(
2163	            "/rebalancing/subscriptions", data=subscription_request.to_request_fields()
2164	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:2222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2221	
2222	        response = self.get(f"/rebalancing/subscriptions/{subscription_id}")
2223	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:2255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2254	
2255	        response = self.post(
2256	            "/rebalancing/runs", data=rebalancing_run_request.to_request_fields()
2257	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:2309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2308	
2309	        response = self.get(f"/rebalancing/runs/{run_id}")
2310	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/client.py:2357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2356	        params = req.to_request_fields()
2357	        self.post(
2358	            f"/trading/accounts/{account_id}/positions/{symbol_or_contract_id}/exercise",
2359	            params,
2360	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
90	    def root_validator(cls, values: dict) -> dict:
91	        content_is_none = values.get("content", None) is None
92	        content_data_is_none = values.get("content_data", None) is None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
91	        content_is_none = values.get("content", None) is None
92	        content_data_is_none = values.get("content_data", None) is None
93	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	        for model, field in nullable_fields_by_model.items():
153	            if dict(values[model]).get(field, None) is None:
154	                raise ValueError(f"{field} is required to create a new account.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
463	
464	        if values.get("document_sub_type", None) == UploadDocumentSubType.FORM_W8_BEN:
465	            raise ValueError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
680	        if (
681	            values.get("type") != OrderType.MARKET
682	            and "currency" in values

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
682	            and "currency" in values
683	            and values.get("currency", SupportedCurrencies.USD)
684	            != SupportedCurrencies.USD

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:853
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
852	    def root_validator(cls, values: dict) -> dict:
853	        entry_type = values.get("entry_type")
854	        symbol = values.get("symbol")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
853	        entry_type = values.get("entry_type")
854	        symbol = values.get("symbol")
855	        qty = values.get("qty")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
854	        symbol = values.get("symbol")
855	        qty = values.get("qty")
856	        amount = values.get("amount")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
855	        qty = values.get("qty")
856	        amount = values.get("amount")
857	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/broker/requests.py:1020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1019	            values["type"] == WeightType.ASSET.value
1020	            and values.get("symbol", None) is None
1021	        ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/enums.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	
7	    BROKER_SANDBOX = "https://broker-api.sandbox.alpaca.markets"
8	    BROKER_PRODUCTION = "https://broker-api.alpaca.markets"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/enums.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	    BROKER_SANDBOX = "https://broker-api.sandbox.alpaca.markets"
8	    BROKER_PRODUCTION = "https://broker-api.alpaca.markets"
9	    TRADING_PAPER = "https://paper-api.alpaca.markets"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/enums.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	    BROKER_PRODUCTION = "https://broker-api.alpaca.markets"
9	    TRADING_PAPER = "https://paper-api.alpaca.markets"
10	    TRADING_LIVE = "https://api.alpaca.markets"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/enums.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	    TRADING_PAPER = "https://paper-api.alpaca.markets"
10	    TRADING_LIVE = "https://api.alpaca.markets"
11	    DATA = "https://data.alpaca.markets"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/enums.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    TRADING_LIVE = "https://api.alpaca.markets"
11	    DATA = "https://data.alpaca.markets"
12	    DATA_SANDBOX = "https://data.sandbox.alpaca.markets"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/enums.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    DATA = "https://data.alpaca.markets"
12	    DATA_SANDBOX = "https://data.sandbox.alpaca.markets"
13	    MARKET_DATA_STREAM = "wss://stream.data.alpaca.markets"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
130	            try:
131	                return self._one_request(method, url, opts, retry)
132	            except RetryException:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
167	            ).encode("utf-8")
168	            encoded_api_key_secret = base64.b64encode(api_key_secret).decode("utf-8")
169	            headers["Authorization"] = "Basic " + encoded_api_key_secret

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:168
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
167	            ).encode("utf-8")
168	            encoded_api_key_secret = base64.b64encode(api_key_secret).decode("utf-8")
169	            headers["Authorization"] = "Basic " + encoded_api_key_secret

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
194	        """
195	        response = self._session.request(method, url, **opts)
196	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
224	        """
225	        return self._request("GET", path, data, **kwargs)
226	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
239	        """
240	        return self._request("POST", path, data)
241	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
252	        """
253	        return self._request("PUT", path, data)
254	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
265	        """
266	        return self._request("PATCH", path, data)
267	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
277	        """
278	        return self._request("DELETE", path, data)
279	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
375	        d = defaultdict(list)
376	        limit = params.get("limit")
377	        total_items = 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
377	        total_items = 0
378	        page_token = params.get("page_token")
379	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
392	
393	            response = self.get(path=path, data=params)
394	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/common/rest.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
404	
405	            page_token = response.get("next_page_token", None)
406	            if page_token is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/historical/option.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	        path = "/options/meta/exchanges"
108	        raw_exchange_code = self.get(
109	            path=path,
110	            api_version=self._api_version,
111	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/historical/screener.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	        """Returns most active stocks."""
54	        response = self.get(
55	            path="/screener/stocks/most-actives",
56	            data=request_params.to_request_fields(),
57	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/historical/screener.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	        """Return market movers."""
66	        response = self.get(
67	            path=f"/screener/{request_params.market_type.lower()}/movers",
68	            data=request_params.model_dump(exclude={"market_type"}),
69	        )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
97	        log.info(f"connecting to {self._endpoint}")
98	        self._ws = await websockets_legacy.connect(
99	            self._endpoint,
100	            extra_headers=extra_headers,
101	            **self._websocket_params,
102	        )

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
102	        )
103	        r = await self._ws.recv()
104	        msg = msgpack.unpackb(r)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
113	        """
114	        await self._ws.send(
115	            msgpack.packb(
116	                {
117	                    "action": "auth",
118	                    "key": self._api_key,
119	                    "secret": self._secret_key,
120	                }

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
122	        )
123	        r = await self._ws.recv()
124	        msg = msgpack.unpackb(r)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
133	        """
134	        await self._connect()
135	        await self._auth()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
140	        if self._ws:
141	            await self._ws.close()
142	            self._ws = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
156	                self._stop_stream_queue.get(timeout=1)
157	                await self.close()
158	                break

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
160	                try:
161	                    r = await asyncio.wait_for(self._ws.recv(), 5)
162	                    msgs = msgpack.unpackb(r)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
293	        )
294	        await self._ws.send(frames)
295	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
305	        if symbols:
306	            await self._ws.send(
307	                msgpack.packb(
308	                    {
309	                        "action": "unsubscribe",
310	                        channel: symbols,
311	                    }

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
347	            except websockets.WebSocketException as wse:
348	                await self.close()
349	                self._running = False

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/data/live/websocket.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
352	                if "insufficient subscription" in str(ve):
353	                    await self.close()
354	                    self._running = False

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
99	        data = order_data.to_request_fields()
100	        response = self.post("/orders", data)
101	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	
125	        response = self.get("/orders", params)
126	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149	
150	        response = self.get(f"/orders/{order_id}", params)
151	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	
169	        response = self.get(f"/orders:by_client_order_id", params)
170	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
243	        """
244	        response = self.get("/positions")
245	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
263	        symbol_or_asset_id = validate_symbol_or_asset_id(symbol_or_asset_id)
264	        response = self.get(f"/positions/{symbol_or_asset_id}")
265	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
343	        symbol_or_contract_id = validate_symbol_or_contract_id(symbol_or_contract_id)
344	        self.post(
345	            f"/positions/{symbol_or_contract_id}/exercise",
346	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
363	        """
364	        response = self.get(
365	            f"/account/portfolio/history",
366	            history_filter.to_request_fields() if history_filter else {},
367	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
391	
392	        response = self.get(f"/assets", params)
393	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
412	
413	        response = self.get(f"/assets/{symbol_or_asset_id}")
414	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
430	
431	        response = self.get("/clock")
432	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
455	
456	        result = self.get("/calendar", filters.to_request_fields() if filters else {})
457	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
473	
474	        response = self.get("/account")
475	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
488	        """
489	        response = self.get("/account/configurations")
490	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
526	
527	        result = self.get(f"/watchlists")
528	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
548	
549	        result = self.get(f"/watchlists/{watchlist_id}")
550	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
568	        """
569	        result = self.post(
570	            "/watchlists",
571	            watchlist_data.to_request_fields(),
572	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
626	
627	        result = self.post(f"/watchlists/{watchlist_id}", params)
628	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
691	
692	        response = self.get("/corporate_actions/announcements", params)
693	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
712	
713	        response = self.get(
714	            f"/corporate_actions/announcements/{corporate_announcment_id}"
715	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
745	
746	        response = self.get("/options/contracts", params)
747	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/client.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
767	
768	        response = self.get(f"/options/contracts/{symbol_or_id}")
769	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	    def root_validator(cls, values: dict) -> dict:
39	        qty = values.get("qty", None)
40	        percentage = values.get("percentage", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        qty = values.get("qty", None)
40	        percentage = values.get("percentage", None)
41	        if qty is None and percentage is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
186	    def root_validator(cls, values: dict) -> dict:
187	        side = values.get("side", None)
188	        position_intent = values.get("position_intent", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
187	        side = values.get("side", None)
188	        position_intent = values.get("position_intent", None)
189	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	    def root_validator(cls, values: dict) -> dict:
253	        qty = values.get("qty", None)
254	        limit_price = values.get("limit_price", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	        qty = values.get("qty", None)
254	        limit_price = values.get("limit_price", None)
255	        stop_price = values.get("stop_price", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
254	        limit_price = values.get("limit_price", None)
255	        stop_price = values.get("stop_price", None)
256	        trail = values.get("trail", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
255	        stop_price = values.get("stop_price", None)
256	        trail = values.get("trail", None)
257	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
454	        super().root_validator(values)
455	        if values.get("order_class", "") != OrderClass.OCO:
456	            limit_price = values.get("limit_price", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
455	        if values.get("order_class", "") != OrderClass.OCO:
456	            limit_price = values.get("limit_price", None)
457	            if limit_price is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
569	    def root_validator(cls, values: dict) -> dict:
570	        since = pd.Timestamp(values.get("since")).date()
571	        until = pd.Timestamp(values.get("until")).date()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/requests.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
570	        since = pd.Timestamp(values.get("since")).date()
571	        until = pd.Timestamp(values.get("until")).date()
572	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/stream.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
59	    async def _connect(self):
60	        self._ws = await websockets_legacy.connect(
61	            self._endpoint, **self._websocket_params
62	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/stream.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
64	    async def _auth(self):
65	        await self._ws.send(
66	            json.dumps(
67	                {
68	                    "action": "authenticate",
69	                    "data": {
70	                        "key_id": self._api_key,
71	                        "secret_key": self._secret_key,
72	                    },

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/stream.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
75	        )
76	        r = await self._ws.recv()
77	        msg = json.loads(r)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/stream.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
108	        if self._trade_updates_handler:
109	            await self._ws.send(
110	                json.dumps({"action": "listen", "data": {"streams": ["trade_updates"]}})
111	            )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/stream.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
130	    async def _start_ws(self):
131	        await self._connect()
132	        await self._auth()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/stream.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
139	                self._stop_stream_queue.get(timeout=1)
140	                await self.close()
141	                break

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/stream.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
143	                try:
144	                    r = await asyncio.wait_for(self._ws.recv(), 5)
145	                    msg = json.loads(r)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/stream.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
174	            except websockets.WebSocketException as wse:
175	                await self.close()
176	                self._running = False

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alpaca_py-0.39.1/alpaca_py-0.39.1/alpaca/trading/stream.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
191	        if self._ws:
192	            await self._ws.close()
193	            self._ws = None

--------------------------------------------------

Code scanned:
	Total lines of code: 9947
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 140.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 146.0
		High: 2.0
Files skipped (0):
