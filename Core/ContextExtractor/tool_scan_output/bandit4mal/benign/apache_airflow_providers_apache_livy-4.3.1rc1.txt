Run started:2025-04-12 16:27:49.644633

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/src/airflow/providers/apache/livy/get_provider_info.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        "name": "Apache Livy",
28	        "description": "`Apache Livy <https://livy.apache.org/>`__\n",
29	        "integrations": [
30	            {
31	                "integration-name": "Apache Livy",
32	                "external-doc-url": "https://livy.apache.org/",
33	                "how-to-guide": ["/docs/apache-airflow-providers-apache-livy/operators.rst"],
34	                "logo": "/docs/integration-logos/Livy.png",
35	                "tags": ["apache"],
36	            }
37	        ],
38	        "operators": [
39	            {
40	                "integration-name": "Apache Livy",
41	                "python-modules": ["airflow.providers.apache.livy.operators.livy"],
42	            }
43	        ],
44	        "sensors": [
45	            {
46	                "integration-name": "Apache Livy",
47	                "python-modules": ["airflow.providers.apache.livy.sensors.livy"],
48	            }
49	        ],
50	        "hooks": [
51	            {
52	                "integration-name": "Apache Livy",
53	                "python-modules": ["airflow.providers.apache.livy.hooks.livy"],
54	            }
55	        ],
56	        "triggers": [
57	            {
58	                "integration-name": "Apache Livy",
59	                "python-modules": ["airflow.providers.apache.livy.triggers.livy"],
60	            }
61	        ],
62	        "connection-types": [
63	            {
64	                "hook-class-name": "airflow.providers.apache.livy.hooks.livy.LivyHook",
65	                "connection-type": "livy",
66	            }
67	        ],
68	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/src/airflow/providers/apache/livy/get_provider_info.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	                "integration-name": "Apache Livy",
32	                "external-doc-url": "https://livy.apache.org/",
33	                "how-to-guide": ["/docs/apache-airflow-providers-apache-livy/operators.rst"],
34	                "logo": "/docs/integration-logos/Livy.png",
35	                "tags": ["apache"],
36	            }
37	        ],
38	        "operators": [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/src/airflow/providers/apache/livy/hooks/livy.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	        """
331	        return response.get("id")
332	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/src/airflow/providers/apache/livy/hooks/livy.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
340	        """
341	        return response.get(parameter, [])
342	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/src/airflow/providers/apache/livy/hooks/livy.py:722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
721	        """
722	        return response.get("id")
723	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/src/airflow/providers/apache/livy/hooks/livy.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
731	        """
732	        return response.get(parameter)
733	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	        )
70	        db.merge_conn(Connection(conn_id="default_port", conn_type="http", host="http://host"))
71	        db.merge_conn(Connection(conn_id="default_protocol", conn_type="http", host="host"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	        db.merge_conn(
75	            Connection(conn_id="dont_override_schema", conn_type="http", host="http://host", schema="https")
76	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	        db.merge_conn(Connection(conn_id="missing_host", conn_type="http", port=1234))
78	        db.merge_conn(Connection(conn_id="invalid_uri", uri="http://invalid_uri:4321"))
79	        db.merge_conn(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        [
93	            pytest.param("default_port", "http://host", id="default-port"),
94	            pytest.param("default_protocol", "http://host", id="default-protocol"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	            pytest.param("default_port", "http://host", id="default-port"),
94	            pytest.param("default_protocol", "http://host", id="default-protocol"),
95	            pytest.param("port_set", "http://host:1234", id="with-defined-port"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	            pytest.param("default_protocol", "http://host", id="default-protocol"),
95	            pytest.param("port_set", "http://host:1234", id="with-defined-port"),
96	            pytest.param("schema_set", "https://host", id="with-defined-schema"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	            pytest.param("port_set", "http://host:1234", id="with-defined-port"),
96	            pytest.param("schema_set", "https://host", id="with-defined-schema"),
97	            pytest.param("dont_override_schema", "http://host", id="ignore-defined-schema"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	            pytest.param("schema_set", "https://host", id="with-defined-schema"),
97	            pytest.param("dont_override_schema", "http://host", id="ignore-defined-schema"),
98	        ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
611	        hook.http_conn_id = mock_get_connection
612	        hook.http_conn_id.host = "https://localhost"
613	        hook.http_conn_id.login = "login"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
736	        )
737	        db.merge_conn(Connection(conn_id="default_port", conn_type="http", host="http://host"))
738	        db.merge_conn(Connection(conn_id="default_protocol", conn_type="http", host="host"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
741	        db.merge_conn(
742	            Connection(conn_id="dont_override_schema", conn_type="http", host="http://host", schema="zzz")
743	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
744	        db.merge_conn(Connection(conn_id="missing_host", conn_type="http", port=1234))
745	        db.merge_conn(Connection(conn_id="invalid_uri", uri="http://invalid_uri:4321"))
746	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
751	            # id, expected
752	            "default_port": "http://host",
753	            "default_protocol": "http://host",
754	            "port_set": "http://host:1234",
755	            "schema_set": "zzz://host",
756	            "dont_override_schema": "http://host",
757	        }
758	
759	        for conn_id, expected in connection_url_mapping.items():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
752	            "default_port": "http://host",
753	            "default_protocol": "http://host",
754	            "port_set": "http://host:1234",
755	            "schema_set": "zzz://host",
756	            "dont_override_schema": "http://host",
757	        }
758	
759	        for conn_id, expected in connection_url_mapping.items():
760	            hook = LivyAsyncHook(livy_conn_id=conn_id)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:754
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
753	            "default_protocol": "http://host",
754	            "port_set": "http://host:1234",
755	            "schema_set": "zzz://host",
756	            "dont_override_schema": "http://host",
757	        }
758	
759	        for conn_id, expected in connection_url_mapping.items():
760	            hook = LivyAsyncHook(livy_conn_id=conn_id)
761	            response_conn: Connection = hook.get_connection(conn_id=conn_id)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/hooks/test_livy.py:756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
755	            "schema_set": "zzz://host",
756	            "dont_override_schema": "http://host",
757	        }
758	
759	        for conn_id, expected in connection_url_mapping.items():
760	            hook = LivyAsyncHook(livy_conn_id=conn_id)
761	            response_conn: Connection = hook.get_connection(conn_id=conn_id)
762	            assert isinstance(response_conn, Connection)
763	            assert hook._generate_base_url(response_conn) == expected

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/operators/test_livy.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
378	            config=HttpConfig(
379	                url="http://localhost:5000",
380	                endpoint="api/v2/lineage",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/operators/test_livy.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
404	            "spark.openlineage.transport.type": "http",
405	            "spark.openlineage.transport.url": "http://localhost:5000",
406	            "spark.openlineage.transport.endpoint": "api/v2/lineage",
407	            "spark.openlineage.transport.timeoutInMillis": "5050000",
408	            "spark.openlineage.transport.compression": "gzip",
409	            "spark.openlineage.transport.auth.type": "api_key",
410	            "spark.openlineage.transport.auth.apiKey": "Bearer 12345",
411	            "spark.openlineage.transport.headers.X-OpenLineage-Custom-Header": "airflow",
412	        }
413	
414	    @patch.object(LivyOperator, "hook", new_callable=MagicMock)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/operators/test_livy.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
428	                            "type": "http",
429	                            "url": "http://localhost:5000",
430	                            "endpoint": "api/v2/lineage",
431	                            "timeout": 5050,
432	                            "auth": {
433	                                "type": "api_key",
434	                                "api_key": "12345",
435	                            },
436	                            "compression": "gzip",
437	                            "custom_headers": {"X-OpenLineage-Custom-Header": "airflow"},
438	                        },
439	                        "test2": {"type": "http", "url": "https://example.com:1234"},
440	                        "test3": {"type": "console"},
441	                    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/operators/test_livy.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
438	                        },
439	                        "test2": {"type": "http", "url": "https://example.com:1234"},
440	                        "test3": {"type": "console"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/operators/test_livy.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
477	            "spark.openlineage.transport.transports.test1.type": "http",
478	            "spark.openlineage.transport.transports.test1.url": "http://localhost:5000",
479	            "spark.openlineage.transport.transports.test1.endpoint": "api/v2/lineage",
480	            "spark.openlineage.transport.transports.test1.timeoutInMillis": "5050000",
481	            "spark.openlineage.transport.transports.test1.auth.type": "api_key",
482	            "spark.openlineage.transport.transports.test1.auth.apiKey": "Bearer 12345",
483	            "spark.openlineage.transport.transports.test1.compression": "gzip",
484	            "spark.openlineage.transport.transports.test1.headers.X-OpenLineage-Custom-Header": "airflow",
485	            "spark.openlineage.transport.transports.test2.type": "http",
486	            "spark.openlineage.transport.transports.test2.url": "https://example.com:1234",
487	            "spark.openlineage.transport.transports.test2.endpoint": "api/v1/lineage",
488	            "spark.openlineage.transport.transports.test2.timeoutInMillis": "5000",
489	        }
490	
491	    @patch.object(LivyOperator, "hook", new_callable=MagicMock)
492	    @patch("airflow.providers.apache.livy.hooks.livy.LivyAsyncHook.get_batch_state")
493	    @patch("airflow.providers.openlineage.utils.spark.get_openlineage_listener")
494	    def test_inject_openlineage_composite_config_wrong_transport_to_spark(
495	        self, mock_get_openlineage_listener, mock_get_batch_state, mock_hook, caplog
496	    ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/operators/test_livy.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
485	            "spark.openlineage.transport.transports.test2.type": "http",
486	            "spark.openlineage.transport.transports.test2.url": "https://example.com:1234",
487	            "spark.openlineage.transport.transports.test2.endpoint": "api/v1/lineage",
488	            "spark.openlineage.transport.transports.test2.timeoutInMillis": "5000",
489	        }
490	
491	    @patch.object(LivyOperator, "hook", new_callable=MagicMock)
492	    @patch("airflow.providers.apache.livy.hooks.livy.LivyAsyncHook.get_batch_state")
493	    @patch("airflow.providers.openlineage.utils.spark.get_openlineage_listener")
494	    def test_inject_openlineage_composite_config_wrong_transport_to_spark(
495	        self, mock_get_openlineage_listener, mock_get_batch_state, mock_hook, caplog
496	    ):
497	        # Given / When
498	        from openlineage.client.transport.composite import CompositeConfig, CompositeTransport
499	
500	        mock_get_openlineage_listener.return_value.adapter.get_or_create_openlineage_client.return_value.transport = CompositeTransport(
501	            CompositeConfig.from_dict({"transports": {"test1": {"type": "console"}}})
502	        )
503	        mock_get_batch_state.return_value = BatchState.SUCCESS
504	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_apache_livy-4.3.1rc1/apache_airflow_providers_apache_livy-4.3.1rc1/tests/unit/apache/livy/sensors/test_livy.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	        self.dag = DAG("test_dag_id", schedule=None, default_args=args)
39	        db.merge_conn(Connection(conn_id="livyunittest", conn_type="livy", host="http://localhost:8998"))
40	

--------------------------------------------------

Code scanned:
	Total lines of code: 2741
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 4.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 0.0
Files skipped (0):
