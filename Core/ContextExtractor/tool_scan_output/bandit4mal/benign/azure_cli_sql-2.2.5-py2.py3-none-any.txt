Run started:2025-04-12 17:09:08.762619

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_sql-2.2.5-py2.py3-none-any/azure/cli/command_modules/sql/_help.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	    """
114	helps['sql db audit-policy update'] = """
115	    type: command
116	    short-summary: Update a database's auditing policy.
117	    long-summary: If the policy is being enabled, `--storage-account` or both `--storage-endpoint` and `--storage-key` must be specified.
118	    examples:
119	        - name: Enable by storage account name.
120	          text: az sql db audit-policy update -g mygroup -s myserver -n mydb --state Enabled --storage-account mystorage
121	        - name: Enable by storage endpoint and key.
122	          text: |
123	            az sql db audit-policy update -g mygroup -s myserver -n mydb --state Enabled \\
124	                --storage-endpoint https://mystorage.blob.core.windows.net --storage-key MYKEY==
125	        - name: Set the list of audit actions.
126	          text: |
127	            az sql db audit-policy update -g mygroup -s myserver -n mydb \\
128	                --actions FAILED_DATABASE_AUTHENTICATION_GROUP 'UPDATE on database::mydb by public'
129	        - name: Add an audit action.
130	          text: |
131	            az sql db audit-policy update -g mygroup -s myserver -n mydb \\
132	                --add auditActionsAndGroups FAILED_DATABASE_AUTHENTICATION_GROUP
133	        - name: Remove an audit action by list index.
134	          text: az sql db audit-policy update -g mygroup -s myserver -n mydb --remove auditActionsAndGroups 0
135	        - name: Disable an auditing policy.
136	          text: az sql db audit-policy update -g mygroup -s myserver -n mydb --state Disabled
137	    """
138	helps['sql db op'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_sql-2.2.5-py2.py3-none-any/azure/cli/command_modules/sql/_help.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	    """
175	helps['sql db export'] = """
176	    type: command
177	    short-summary: Export a database to a bacpac.
178	    examples:
179	        - name: Get an SAS key for use in export operation.
180	          text: |
181	            az storage blob generate-sas --account-name myAccountName -c myContainer -n myBacpac.bacpac \\
182	                --permissions w --expiry 2018-01-01T00:00:00Z
183	        - name: Export bacpac using an SAS key.
184	          text: |
185	            az sql db export -s myserver -n mydatabase -g mygroup -p password -u login \\
186	                --storage-key "?sr=b&sp=rw&se=2018-01-01T00%3A00%3A00Z&sig=mysignature&sv=2015-07-08" \\
187	                --storage-key-type SharedAccessKey \\
188	                --storage-uri https://myAccountName.blob.core.windows.net/myContainer/myBacpac.bacpac
189	        - name: Export bacpac using a storage account key.
190	          text: |
191	            az sql db export -s myserver -n mydatabase -g mygroup -p password -u login \\
192	                --storage-key MYKEY== --storage-key-type StorageAccessKey \\
193	                --storage-uri https://myAccountName.blob.core.windows.net/myContainer/myBacpac.bacpac
194	    """
195	helps['sql db import'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_sql-2.2.5-py2.py3-none-any/azure/cli/command_modules/sql/_help.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
194	    """
195	helps['sql db import'] = """
196	    type: command
197	    short-summary: Imports a bacpac into an existing database.
198	    examples:
199	        - name: Get an SAS key for use in import operation.
200	          text: |
201	            az storage blob generate-sas --account-name myAccountName -c myContainer -n myBacpac.bacpac \\
202	                --permissions r --expiry 2018-01-01T00:00:00Z
203	        - name: Import bacpac into an existing database using an SAS key.
204	          text: |
205	            az sql db import -s myserver -n mydatabase -g mygroup -p password -u login \\
206	                --storage-key "?sr=b&sp=rw&se=2018-01-01T00%3A00%3A00Z&sig=mysignature&sv=2015-07-08" \\
207	                --storage-key-type SharedAccessKey \\
208	                --storage-uri https://myAccountName.blob.core.windows.net/myContainer/myBacpac.bacpac
209	        - name: Import bacpac into an existing database using a storage account key.
210	          text: |
211	            az sql db import -s myserver -n mydatabase -g mygroup -p password -u login --storage-key MYKEY== \\
212	                --storage-key-type StorageAccessKey \\
213	                --storage-uri https://myAccountName.blob.core.windows.net/myContainer/myBacpac.bacpac
214	    """
215	helps['sql db restore'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_sql-2.2.5-py2.py3-none-any/azure/cli/command_modules/sql/_help.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
222	    """
223	helps['sql db threat-policy update'] = """
224	    type: command
225	    short-summary: Update a database's threat detection policy.
226	    long-summary: If the policy is being enabled, storage_account or both storage_endpoint and
227	                  storage_account_access_key must be specified.
228	    examples:
229	        - name: Enable by storage account name.
230	          text: |
231	            az sql db threat-policy update -g mygroup -s myserver -n mydb \\
232	                --state Enabled --storage-account mystorage
233	        - name: Enable by storage endpoint and key.
234	          text: |
235	            az sql db threat-policy update -g mygroup -s myserver -n mydb \\
236	                --state Enabled --storage-endpoint https://mystorage.blob.core.windows.net \\
237	                --storage-key MYKEY==
238	        - name: Disable a subset of alert types.
239	          text: |
240	            az sql db threat-policy update -g mygroup -s myserver -n mydb \\
241	                --disabled-alerts Sql_Injection_Vulnerability Access_Anomaly
242	        - name: Configure email recipients for a policy.
243	          text: |
244	            az sql db threat-policy update -g mygroup -s myserver -n mydb \\
245	                --email-addresses me@examlee.com you@example.com \\
246	                --email-account-admins Enabled
247	        - name: Disable a threat policy.
248	          text: az sql db threat-policy update -g mygroup -s myserver -n mydb --state Disabled
249	    """
250	helps['sql db tde'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_sql-2.2.5-py2.py3-none-any/azure/cli/command_modules/sql/_params.py:1012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1011	                   required=True,
1012	                   help='The Azure Key Vault key identifier of the server key. An example key identifier is '
1013	                   '"https://YourVaultName.vault.azure.net/keys/YourKeyName/01234567890123456789012345678901"')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_sql-2.2.5-py2.py3-none-any/azure/cli/command_modules/sql/_params.py:1025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1024	                   options_list=['--kid', '-k'],
1025	                   help='The Azure Key Vault key identifier of the server key to be made encryption protector.'
1026	                   'An example key identifier is '

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_sql-2.2.5-py2.py3-none-any/azure/cli/command_modules/sql/custom.py:1761
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1760	    # Special start/end IP that represents allowing all azure ips
1761	    azure_ip_addr = '0.0.0.0'
1762	
1763	    return client.create_or_update(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_sql-2.2.5-py2.py3-none-any/azure/cli/command_modules/sql/custom.py:1870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1869	    if match is None:
1870	        raise CLIError('The provided uri is invalid. Please provide a valid Azure Key Vault key id.  For example: '
1871	                       '"https://YourVaultName.vault.azure.net/keys/YourKeyName/01234567890123456789012345678901"')

--------------------------------------------------

Code scanned:
	Total lines of code: 3750
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 0.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 0.0
Files skipped (0):
