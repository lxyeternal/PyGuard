Run started:2025-04-12 19:49:44.723405

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/client.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	##################
50	GENAI_API_DISCOVERY_URL = "https://generativelanguage.googleapis.com/$discovery/rest"
51	
52	
53	@contextlib.contextmanager
54	def patch_colab_gce_credentials():

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/client.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
111	        if isinstance(path, IOBase):
112	            media = googleapiclient.http.MediaIoBaseUpload(
113	                fd=path, mimetype=mime_type, resumable=resumable
114	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/client.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
115	        else:
116	            media = googleapiclient.http.MediaFileUpload(
117	                filename=path, mimetype=mime_type, resumable=resumable
118	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/client.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
119	
120	        request = self._local.discovery_api.media().upload(body={"file": file}, media_body=media)
121	        for key, value in metadata:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/client.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
243	            e.args = (
244	                "\n  No API_KEY or ADC found. Please either:\n"
245	                "    - Set the `GOOGLE_API_KEY` environment variable.\n"
246	                "    - Manually pass the key with `genai.configure(api_key=my_api_key)`.\n"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/content_types.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
118	        mime_type = "image/webp"
119	        image_bytes = image_io.read()
120	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/generation_types.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
470	            msg = (
471	                "Invalid operation: The `response.text` quick accessor requires the response to contain a valid "
472	                "`Part`, but none were returned. The candidate's "
473	                f"[finish_reason](https://ai.google.dev/api/generate-content#finishreason) is {fr}."
474	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/generation_types.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
502	                raise ValueError(
503	                    msg + " Meaning that model generated a `FunctionCall` that was invalid. "
504	                    "Setting the "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/image_types/_image_types.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	        mime_type = "image/webp"
81	        image_bytes = image_io.read()
82	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/image_types/_image_types.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
247	        # "received initial metadata size exceeds limit"
248	        return base64.b64encode(self._image_bytes).decode("ascii")
249	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/image_types/_image_types.py:248
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
247	        # "received initial metadata size exceeds limit"
248	        return base64.b64encode(self._image_bytes).decode("ascii")
249	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/image_types/_image_types.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
397	        # "received initial metadata size exceeds limit"
398	        return base64.b64encode(self._video_bytes).decode("ascii")
399	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/image_types/_image_types.py:398
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
397	        # "received initial metadata size exceeds limit"
398	        return base64.b64encode(self._video_bytes).decode("ascii")
399	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/image_types/_image_types.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
416	        if self._loaded_bytes is None:
417	            self._loaded_bytes = self.download()
418	        return self._loaded_bytes

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/model_types.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
248	        if isinstance(data, str):
249	            f = urllib.request.urlopen(data)
250	            # csv needs strings, json does not.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/types/model_types.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	def _normalize_url(url: str) -> str:
271	    sheet_base = "https://docs.google.com/spreadsheets"
272	    if url.startswith(sheet_base):

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/vision_models/_vision_models.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
197	            generated_image = image_types.GeneratedImage(
198	                image_bytes=base64.b64decode(encoded_bytes) if encoded_bytes else None,
199	                generation_parameters=generation_parameters,

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/vision_models/_vision_models.py:198
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
197	            generated_image = image_types.GeneratedImage(
198	                image_bytes=base64.b64decode(encoded_bytes) if encoded_bytes else None,
199	                generation_parameters=generation_parameters,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/vision_models/_vision_models.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
345	                    "image": {
346	                        "bytesBase64Encoded": base64.b64encode(img._loaded_bytes).decode(),
347	                        "mimeType": img._mime_type,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google_generativeai-0.8.4-py3-none-any/google/generativeai/vision_models/_vision_models.py:346
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
345	                    "image": {
346	                        "bytesBase64Encoded": base64.b64encode(img._loaded_bytes).decode(),
347	                        "mimeType": img._mime_type,

--------------------------------------------------

Code scanned:
	Total lines of code: 11988
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 4.0
Files skipped (0):
