Run started:2025-04-12 11:32:12.326361

Test results:
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
175	    yield loop
176	    loop.close()
177	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
273	        url = f"{url}?{urlencode(params)}"
274	    with urlopen(url) as resp:
275	        if 200 <= resp.status < 300:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
275	        if 200 <= resp.status < 300:
276	            return json.loads(resp.read())
277	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
284	
285	    CH_URL = "https://api.charmhub.io/v2"
286	
287	    def __init__(self, charmhub_name, channel):

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
314	        destination.parent.mkdir(parents=True, exist_ok=True)
315	        target, _msg = urlretrieve(rsc["download"]["url"], destination)
316	        return target

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
319	class CharmStore:
320	    CS_URL = "https://api.jujucharms.com/charmstore/v5"
321	
322	    def __init__(self, charmstore_name, channel="edge"):

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
363	        destination.parent.mkdir(parents=True, exist_ok=True)
364	        local_file, header = urlretrieve(url, destination)
365	        return local_file

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
665	        )
666	        await model.connect(state.full_name)
667	        state.config = await model.get_config()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
695	            self._controller = Controller()
696	            await self._controller.connect(self.controller_name)
697	        if not self._init_model_name:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
845	                await self._controller.destroy_model(model_name, force=True)
846	            await model.disconnect()
847	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
901	        assert controller is not None  # needed for type checker
902	        await controller.disconnect()
903	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_operator-1.0.0b1-py3-none-any/pytest_operator/plugin.py:977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
976	                # odd permissions which interfer with cleanup; just log and continue.
977	                shutil.rmtree(build_path, onerror=handle_file_delete_error)
978	

--------------------------------------------------

Code scanned:
	Total lines of code: 1153
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 10.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 0.0
Files skipped (0):
