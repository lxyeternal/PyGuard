Run started:2025-04-12 16:57:47.534325

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
57	is_PY3 = sys.version_info[0] >= 3
58	is_WIN = platform.system() == 'Windows'
59	is_CYGWIN = platform.system().startswith(('CYGWIN', 'MSYS'))

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
57	is_PY3 = sys.version_info[0] >= 3
58	is_WIN = platform.system() == 'Windows'
59	is_CYGWIN = platform.system().startswith(('CYGWIN', 'MSYS'))

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
57	is_PY3 = sys.version_info[0] >= 3
58	is_WIN = platform.system() == 'Windows'
59	is_CYGWIN = platform.system().startswith(('CYGWIN', 'MSYS'))

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
58	is_WIN = platform.system() == 'Windows'
59	is_CYGWIN = platform.system().startswith(('CYGWIN', 'MSYS'))
60	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
58	is_WIN = platform.system() == 'Windows'
59	is_CYGWIN = platform.system().startswith(('CYGWIN', 'MSYS'))
60	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
58	is_WIN = platform.system() == 'Windows'
59	is_CYGWIN = platform.system().startswith(('CYGWIN', 'MSYS'))
60	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
118	            ini_file = ConfigParser()
119	            ini_file.read(configfile)
120	            section = "nodeenv"

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
118	            ini_file = ConfigParser()
119	            ini_file.read(configfile)
120	            section = "nodeenv"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
139	        if os.path.exists(".node-version"):
140	            with open(".node-version", "r") as v_file:
141	                setattr(cls, "node", v_file.readlines(1)[0].strip())

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
189	    if args.node == 'system':
190	        out, err = subprocess.Popen(
191	            ["node", "--version"], stdout=subprocess.PIPE).communicate()
192	        return parse_version(clear_output(out))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
208	        fs = "%s" if getattr(record, "continued", False) else "%s\n"
209	        self.stream.write(fs % to_utf8(msg))
210	        self.flush()

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
423	                 stat.S_IRGRP | stat.S_IROTH | stat.S_IXOTH)
424	    os.chmod(filename, mode_0755)
425	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:424
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
423	                 stat.S_IRGRP | stat.S_IROTH | stat.S_IXOTH)
424	    os.chmod(filename, mode_0755)
425	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
436	        logger.debug(' * Writing %s ... ', dest, extra=dict(continued=True))
437	        with open(dest, 'wb') as f:
438	            f.write(content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
437	        with open(dest, 'wb') as f:
438	            f.write(content)
439	        make_executable(dest)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
442	    else:
443	        with open(dest, 'rb') as f:
444	            c = f.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
443	        with open(dest, 'rb') as f:
444	            c = f.read()
445	        if content in c:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
443	        with open(dest, 'rb') as f:
444	            c = f.read()
445	        if content in c:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
455	            logger.info(' * Appending data to %s', dest)
456	            with open(dest, 'ab') as f:
457	                f.write(content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
456	            with open(dest, 'ab') as f:
457	                f.write(content)
458	            return

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
460	        logger.info(' * Overwriting %s with new content', dest)
461	        with open(dest, 'wb') as f:
462	            f.write(content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
461	        with open(dest, 'wb') as f:
462	            f.write(content)
463	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
497	    try:
498	        proc = subprocess.Popen(
499	            cmd, stderr=subprocess.STDOUT, stdin=None, stdout=stdout,
500	            cwd=cwd, env=env, shell=in_shell)
501	    except Exception:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
568	    sysinfo = {
569	        'system': platform.system().lower(),
570	        'arch': archmap[platform.machine()],

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
568	    sysinfo = {
569	        'system': platform.system().lower(),
570	        'arch': archmap[platform.machine()],

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:569
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
568	    sysinfo = {
569	        'system': platform.system().lower(),
570	        'arch': archmap[platform.machine()],

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
589	    """Compatibility layer because py26."""
590	    tf = tarfile.open(*args, **kwargs)
591	    try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
601	        try:
602	            return io.BytesIO(urlopen(node_url).read())
603	        except IncompleteRead as e:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
601	        try:
602	            return io.BytesIO(urlopen(node_url).read())
603	        except IncompleteRead as e:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
601	        try:
602	            return io.BytesIO(urlopen(node_url).read())
603	        except IncompleteRead as e:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
601	        try:
602	            return io.BytesIO(urlopen(node_url).read())
603	        except IncompleteRead as e:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
625	    else:
626	        ctx = tarfile_open(fileobj=dl_contents)
627	        members = operator.methodcaller('getmembers')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
642	def urlopen(url):
643	    home_url = "https://github.com/ekalinin/nodeenv/"
644	    headers = {'User-Agent': 'nodeenv/%s (%s)' % (nodeenv_version, home_url)}

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
650	        context.verify_mode = ssl.CERT_NONE
651	        return urllib2.urlopen(req, context=context)
652	    return urllib2.urlopen(req)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
650	        context.verify_mode = ssl.CERT_NONE
651	        return urllib2.urlopen(req, context=context)
652	    return urllib2.urlopen(req)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
651	        return urllib2.urlopen(req, context=context)
652	    return urllib2.urlopen(req)
653	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
651	        return urllib2.urlopen(req, context=context)
652	    return urllib2.urlopen(req)
653	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:817
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
816	    )
817	    proc = subprocess.Popen(
818	        (
819	            'bash', '-c',
820	            '. {0} && npm install -g npm@{1}'.format(
821	                _quote(join(env_dir, 'bin', 'activate')),
822	                args.npm,
823	            )
824	        ),
825	        env=env,
826	        stdin=subprocess.PIPE,
827	        stdout=subprocess.PIPE,
828	        stderr=subprocess.STDOUT,
829	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:843
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
842	                extra=dict(continued=True))
843	    npm_url = 'https://github.com/npm/cli/archive/v%s.zip' % args.npm
844	    npm_contents = io.BytesIO(urlopen(npm_url).read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
843	    npm_url = 'https://github.com/npm/cli/archive/v%s.zip' % args.npm
844	    npm_contents = io.BytesIO(urlopen(npm_url).read())
845	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
843	    npm_url = 'https://github.com/npm/cli/archive/v%s.zip' % args.npm
844	    npm_contents = io.BytesIO(urlopen(npm_url).read())
845	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
843	    npm_url = 'https://github.com/npm/cli/archive/v%s.zip' % args.npm
844	    npm_contents = io.BytesIO(urlopen(npm_url).read())
845	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
843	    npm_url = 'https://github.com/npm/cli/archive/v%s.zip' % args.npm
844	    npm_contents = io.BytesIO(urlopen(npm_url).read())
845	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
849	    if os.path.exists(node_modules_path):
850	        shutil.rmtree(node_modules_path)
851	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:873
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
872	                        join(env_dir, 'bin', 'node_modules'))
873	        npm_gh_url = 'https://raw.githubusercontent.com/npm/cli'
874	        npm_bin_url = '{}/{}/bin/npm'.format(npm_gh_url, args.npm)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:875
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
874	        npm_bin_url = '{}/{}/bin/npm'.format(npm_gh_url, args.npm)
875	        writefile(join(env_dir, 'bin', 'npm'), urlopen(npm_bin_url).read())
876	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:875
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
874	        npm_bin_url = '{}/{}/bin/npm'.format(npm_gh_url, args.npm)
875	        writefile(join(env_dir, 'bin', 'npm'), urlopen(npm_bin_url).read())
876	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:875
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
874	        npm_bin_url = '{}/{}/bin/npm'.format(npm_gh_url, args.npm)
875	        writefile(join(env_dir, 'bin', 'npm'), urlopen(npm_bin_url).read())
876	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:875
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
874	        npm_bin_url = '{}/{}/bin/npm'.format(npm_gh_url, args.npm)
875	        writefile(join(env_dir, 'bin', 'npm'), urlopen(npm_bin_url).read())
876	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
884	    packages = [package.strip() for package in
885	                open(args.requirements).readlines()]
886	    activate_path = join(env_dir, 'bin', 'activate')

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
939	        for candidate in ("nodejs", "node"):
940	            which_node_output, _ = subprocess.Popen(
941	                ["which", candidate],
942	                stdout=subprocess.PIPE, env=env).communicate()
943	            shim_node = clear_output(which_node_output)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:990
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
989	    if not is_WIN:
990	        with open(join(env_dir, 'bin', 'predeactivate'), 'a') as hook:
991	            hook.write(PREDEACTIVATE_SH)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
990	        with open(join(env_dir, 'bin', 'predeactivate'), 'a') as hook:
991	            hook.write(PREDEACTIVATE_SH)
992	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:1024
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1023	    if args.clean_src:
1024	        shutil.rmtree(src_dir)
1025	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1027	def _get_versions_json():
1028	    response = urlopen('%s/index.json' % src_base_url)
1029	    return json.loads(response.read().decode('UTF-8'))

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1027	def _get_versions_json():
1028	    response = urlopen('%s/index.json' % src_base_url)
1029	    return json.loads(response.read().decode('UTF-8'))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:1029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1028	    response = urlopen('%s/index.json' % src_base_url)
1029	    return json.loads(response.read().decode('UTF-8'))
1030	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:1029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1028	    response = urlopen('%s/index.json' % src_base_url)
1029	    return json.loads(response.read().decode('UTF-8'))
1030	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:1091
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1090	    # noinspection PyProtectedMember
1091	    Config._load(args.config_file, args.verbose)
1092	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:1116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1115	    if src_base_url is None:
1116	        src_base_url = 'https://%s/download/release' % src_domain
1117	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:1137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1136	DISABLE_PROMPT = {
1137	    'activate': """
1138	# disable nodeenv's prompt
1139	# (prompt already changed by original virtualenv's script)
1140	# https://github.com/ekalinin/nodeenv/issues/26
1141	NODE_VIRTUAL_ENV_DISABLE_PROMPT=1
1142	""",
1143	    'activate.fish': """
1144	# disable nodeenv's prompt
1145	# (prompt already changed by original virtualenv's script)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:1143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1142	""",
1143	    'activate.fish': """
1144	# disable nodeenv's prompt
1145	# (prompt already changed by original virtualenv's script)
1146	# https://github.com/ekalinin/nodeenv/issues/26
1147	set NODE_VIRTUAL_ENV_DISABLE_PROMPT 1
1148	""",
1149	}
1150	
1151	ENABLE_PROMPT = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/nodeenv.py:1260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1259	
1260	ACTIVATE_SH = r"""
1261	
1262	# This file must be used with "source bin/activate" *from bash*
1263	# you cannot run it directly
1264	
1265	deactivate_node () {
1266	    # reset old environment variables
1267	    if [ -n "${_OLD_NODE_VIRTUAL_PATH:-}" ] ; then
1268	        PATH="${_OLD_NODE_VIRTUAL_PATH:-}"
1269	        export PATH
1270	        unset _OLD_NODE_VIRTUAL_PATH
1271	
1272	        NODE_PATH="${_OLD_NODE_PATH:-}"
1273	        export NODE_PATH
1274	        unset _OLD_NODE_PATH
1275	
1276	        NPM_CONFIG_PREFIX="${_OLD_NPM_CONFIG_PREFIX:-}"
1277	        npm_config_prefix="${_OLD_npm_config_prefix:-}"
1278	        export NPM_CONFIG_PREFIX
1279	        export npm_config_prefix
1280	        unset _OLD_NPM_CONFIG_PREFIX
1281	        unset _OLD_npm_config_prefix
1282	    fi
1283	
1284	    # This should detect bash and zsh, which have a hash command that must
1285	    # be called to get it to forget past commands.  Without forgetting
1286	    # past commands the $PATH changes we made may not be respected
1287	    if [ -n "${BASH:-}" -o -n "${ZSH_VERSION:-}" ] ; then
1288	        hash -r
1289	    fi
1290	
1291	    if [ -n "${_OLD_NODE_VIRTUAL_PS1:-}" ] ; then
1292	        PS1="${_OLD_NODE_VIRTUAL_PS1:-}"
1293	        export PS1
1294	        unset _OLD_NODE_VIRTUAL_PS1
1295	    fi
1296	
1297	    unset NODE_VIRTUAL_ENV
1298	    if [ ! "${1:-}" = "nondestructive" ] ; then
1299	    # Self destruct!
1300	        unset -f deactivate_node
1301	    fi
1302	}
1303	
1304	freeze () {
1305	    local NPM_VER=`npm -v | cut -d '.' -f 1`
1306	    local re="[a-zA-Z0-9\.\-]+@[0-9]+\.[0-9]+\.[0-9]+([\+\-][a-zA-Z0-9\.\-]+)*"
1307	    if [ "$NPM_VER" = '0' ]; then
1308	        NPM_LIST=`npm list installed active 2>/dev/null | \
1309	                  cut -d ' ' -f 1 | grep -v npm`
1310	    else
1311	        local npmls="npm ls -g"
1312	        if [ "${1:-}" = "-l" ]; then
1313	            npmls="npm ls"
1314	            shift
1315	        fi
1316	        NPM_LIST=$(eval ${npmls} | grep -E '^.{4}\w{1}'| \
1317	                                   grep -o -E "$re"| grep -v npm)
1318	    fi
1319	
1320	    if [ -z "$@" ]; then
1321	        echo "$NPM_LIST"
1322	    else
1323	        echo "$NPM_LIST" > $@
1324	    fi
1325	}
1326	
1327	# unset irrelevant variables
1328	deactivate_node nondestructive
1329	
1330	# find the directory of this script
1331	# http://stackoverflow.com/a/246128
1332	if [ "${BASH_SOURCE:-}" ] ; then
1333	    SOURCE="${BASH_SOURCE[0]}"
1334	
1335	    while [ -h "$SOURCE" ] ; do SOURCE="$(readlink "$SOURCE")"; done
1336	    DIR="$( command cd -P "$( dirname "$SOURCE" )" > /dev/null && pwd )"
1337	
1338	    NODE_VIRTUAL_ENV="$(dirname "$DIR")"
1339	else
1340	    # dash not movable. fix use case:
1341	    #   dash -c " . node-env/bin/activate && node -v"
1342	    NODE_VIRTUAL_ENV="__NODE_VIRTUAL_ENV__"
1343	fi
1344	
1345	# NODE_VIRTUAL_ENV is the parent of the directory where this script is
1346	export NODE_VIRTUAL_ENV
1347	
1348	_OLD_NODE_VIRTUAL_PATH="$PATH"
1349	PATH="$NODE_VIRTUAL_ENV/lib/node_modules/.bin:$NODE_VIRTUAL_ENV/__BIN_NAME__:$PATH"
1350	export PATH
1351	
1352	_OLD_NODE_PATH="${NODE_PATH:-}"
1353	NODE_PATH="$NODE_VIRTUAL_ENV/__MOD_NAME__"
1354	export NODE_PATH
1355	
1356	_OLD_NPM_CONFIG_PREFIX="${NPM_CONFIG_PREFIX:-}"
1357	_OLD_npm_config_prefix="${npm_config_prefix:-}"
1358	NPM_CONFIG_PREFIX="__NPM_CONFIG_PREFIX__"
1359	npm_config_prefix="__NPM_CONFIG_PREFIX__"
1360	export NPM_CONFIG_PREFIX
1361	export npm_config_prefix
1362	
1363	if [ -z "${NODE_VIRTUAL_ENV_DISABLE_PROMPT:-}" ] ; then
1364	    _OLD_NODE_VIRTUAL_PS1="${PS1:-}"
1365	    if [ "x__NODE_VIRTUAL_PROMPT__" != x ] ; then
1366	        PS1="__NODE_VIRTUAL_PROMPT__ ${PS1:-}"
1367	    else
1368	    if [ "`basename \"$NODE_VIRTUAL_ENV\"`" = "__" ] ; then
1369	        # special case for Aspen magic directories
1370	        # see http://www.zetadev.com/software/aspen/
1371	        PS1="[`basename \`dirname \"$NODE_VIRTUAL_ENV\"\``] ${PS1:-}"
1372	    else
1373	        PS1="(`basename \"$NODE_VIRTUAL_ENV\"`) ${PS1:-}"
1374	    fi
1375	    fi
1376	    export PS1
1377	fi
1378	
1379	# This should detect bash and zsh, which have a hash command that must
1380	# be called to get it to forget past commands.  Without forgetting
1381	# past commands the $PATH changes we made may not be respected
1382	if [ -n "${BASH:-}" -o -n "${ZSH_VERSION:-}" ] ; then
1383	    hash -r
1384	fi
1385	"""
1386	
1387	
1388	ACTIVATE_FISH = """

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	def read_file(file_name):
20	    return codecs.open(
21	        os.path.join(
22	            os.path.dirname(os.path.abspath(__file__)),
23	            file_name
24	        ),
25	        encoding='utf-8',
26	    ).read()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/setup.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    version=nodeenv_version,
35	    url='https://github.com/ekalinin/nodeenv',
36	    license='BSD',

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/tests/nodeenv_test.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	    p = tmpdir.join('bin').join('predeactivate')
108	    assert 'deactivate_node' in p.read()
109	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/tests/nodeenv_test.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	def test_mirror_option():
112	    urls = [('https://npm.taobao.org/mirrors/node',
113	             'https://npm.taobao.org/mirrors/node/index.json'),
114	            ('npm.some-mirror.com',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/tests/nodeenv_test.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	    urls = [('https://npm.taobao.org/mirrors/node',
113	             'https://npm.taobao.org/mirrors/node/index.json'),
114	            ('npm.some-mirror.com',
115	             'https://npm.some-mirror.com/download/release/index.json'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/tests/nodeenv_test.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	            ('npm.some-mirror.com',
115	             'https://npm.some-mirror.com/download/release/index.json'),
116	            ('',
117	             'https://nodejs.org/download/release/index.json')]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/tests/nodeenv_test.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	            ('',
117	             'https://nodejs.org/download/release/index.json')]
118	    sys_type = sysconfig.get_config_var('HOST_GNU_TYPE')
119	    musl_type = ['x86_64-pc-linux-musl', 'x86_64-unknown-linux-musl']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/tests/nodeenv_test.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	            nodeenv._download_node_file(
160	                "https://dummy/nodejs.tar.gz",
161	                n_attempt=5
162	            )
163	        assert m_urlopen.call_count == 5

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/tests/test_install_activate.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
54	    for n in FILES:
55	        bin_dir.join(n).write(n)
56	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/tests/test_install_activate.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	    content = getattr(nodeenv, content_var)
62	    assert bin_dir.join(name).read() == fix_content(content, tmpdir)
63	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/tests/test_install_activate.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	    for n in FILES:
73	        bin_dir.join(n).write(n)
74	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nodeenv-1.9.1/nodeenv-1.9.1/tests/test_install_activate.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	        content = name + disable_prompt + content + enable_prompt
87	    assert bin_dir.join(name).read() == fix_content(content, tmpdir)

--------------------------------------------------

Code scanned:
	Total lines of code: 1455
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 58.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 71.0
		High: 4.0
Files skipped (0):
