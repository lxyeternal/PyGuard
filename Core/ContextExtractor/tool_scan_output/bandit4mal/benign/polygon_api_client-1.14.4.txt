Run started:2025-04-12 11:30:37.349837

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/rest/__init__.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	BASE = "https://api.polygon.io"
21	ENV_KEY = "POLYGON_API_KEY"

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
99	
100	        async for s in connect(
101	            self.url, close_timeout=close_timeout, ssl=ssl_context, **kwargs
102	        ):

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
104	            try:
105	                msg = await s.recv()
106	                logger.debug("connected: %s", msg)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
107	                logger.debug("authing...")
108	                await s.send(
109	                    self.json.dumps({"action": "auth", "params": self.api_key})
110	                )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
107	                logger.debug("authing...")
108	                await s.send(
109	                    self.json.dumps({"action": "auth", "params": self.api_key})
110	                )

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
110	                )
111	                auth_msg = await s.recv()
112	                auth_msg_parsed = self.json.loads(auth_msg)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
130	                        cmsg: Union[List[WebSocketMessage], Union[str, bytes]] = (
131	                            await asyncio.wait_for(s.recv(), timeout=1)
132	                        )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
179	
180	        asyncio.run(self.connect(handle_msg_wrapper, close_timeout, **kwargs))
181	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
186	        logger.debug("subbing: %s", subs)
187	        await self.websocket.send(
188	            self.json.dumps({"action": "subscribe", "params": subs})
189	        )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
186	        logger.debug("subbing: %s", subs)
187	        await self.websocket.send(
188	            self.json.dumps({"action": "subscribe", "params": subs})
189	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
195	        logger.debug("unsubbing: %s", subs)
196	        await self.websocket.send(
197	            self.json.dumps({"action": "unsubscribe", "params": subs})
198	        )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
195	        logger.debug("unsubbing: %s", subs)
196	        await self.websocket.send(
197	            self.json.dumps({"action": "unsubscribe", "params": subs})
198	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/polygon_api_client-1.14.4/polygon_api_client-1.14.4/polygon/websocket/__init__.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
264	        if self.websocket:
265	            await self.websocket.close()
266	            self.websocket = None

--------------------------------------------------

Code scanned:
	Total lines of code: 4482
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 12.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 0.0
Files skipped (0):
