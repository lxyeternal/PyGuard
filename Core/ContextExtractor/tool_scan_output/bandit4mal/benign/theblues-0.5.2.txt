Run started:2025-04-12 11:02:02.627998

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
12	if sys.argv[-1] == 'publish':
13	    os.system('python setup.py sdist upload')
14	    sys.exit()

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
12	if sys.argv[-1] == 'publish':
13	    os.system('python setup.py sdist upload')
14	    sys.exit()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/setup.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
15	
16	readme = open('README.rst').read()
17	history = open('CHANGELOG.rst').read().replace('.. :changelog:', '')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/setup.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
16	readme = open('README.rst').read()
17	history = open('CHANGELOG.rst').read().replace('.. :changelog:', '')
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    author_email='juju-gui@lists.ubuntu.com',
26	    url='https://github.com/juju/theblues',
27	    packages=[

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	        try:
75	            response = self.session.get(url, verify=self.verify,
76	                                    cookies=self.cookies, timeout=self.timeout,
77	                                    auth=self._client.auth())
78	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	            url = '{}/{}/meta/any'.format(self.url, _get_path(entity_id))
127	        data = self._get(url)
128	        return data.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
158	        url = url[:-1]
159	        data = self._get(url)
160	        return data.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
194	        url = self.charm_icon_url(charm_id, channel=channel)
195	        response = self._get(url)
196	        return response.content

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	        url = self.bundle_visualization_url(bundle_id, channel=channel)
205	        response = self._get(url)
206	        return response.content

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
233	        readme_url = self.entity_readme_url(entity_id, channel=channel)
234	        response = self._get(readme_url)
235	        return response.text

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
284	            manifest_url = _add_channel(manifest_url, channel)
285	            manifest = self._get(manifest_url)
286	            manifest = manifest.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	        if filename:
295	            file_url = files.get(filename, None)
296	            if file_url is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
298	            if read_file:
299	                data = self._get(file_url)
300	                return data.text

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
325	        url = '{}/{}/meta/charm-config'.format(self.url, _get_path(charm_id))
326	        data = self._get(_add_channel(url, channel))
327	        return data.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
336	        url = '{}/{}/meta/any'.format(self.url, _get_path(partial))
337	        data = self._get(_add_channel(url, channel))
338	        return data.json()['Id']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
375	            url = '{}/search'.format(self.url)
376	        data = self._get(url)
377	        return data.json()['Results']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	            url = '{}/list'.format(self.url)
400	        data = self._get(url)
401	        return data.json()['Results']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
452	                   url=self.url, meta=meta)
453	        data = self._get(url)
454	        return data.json().values()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
472	               '&limit=1000&include=owner' + request)
473	        data = self._get(url)
474	        return data.json().values()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/charmstore.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	        url = '{}/debug/status'.format(self.url)
479	        data = self._get(url)
480	        return data.json()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/identity_manager.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
91	
92	        return base64.urlsafe_b64encode(json_macaroon.encode('utf-8'))
93	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/identity_manager.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
111	                'Invalid macaroon from discharger: {}'.format(err.message))
112	        return base64.urlsafe_b64encode("[{}]".format(
113	            json_macaroon).encode('utf-8'))
114	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/jimm.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
36	        """
37	        return make_request("{}model".format(self.url), timeout=self.timeout,
38	                            client=self._client, cookies=self.cookies)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/plans.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
52	        """
53	        response = make_request(
54	            '{}charm?charm-url={}'.format(self.url,
55	                                          'cs:' + reference.path()),
56	            timeout=self.timeout, client=self._client)
57	        try:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/plans.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
80	        """
81	        response = make_request(
82	            '{}wallet'.format(self.url),
83	            timeout=self.timeout,
84	            client=self._client)
85	        try:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/plans.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
120	        """
121	        response = make_request(
122	            '{}wallet/{}'.format(self.url, wallet_name),
123	            timeout=self.timeout,
124	            client=self._client)
125	        try:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/plans.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
156	        }
157	        return make_request(
158	            '{}wallet/{}'.format(self.url, wallet_name),
159	            method='PATCH',
160	            body=request,
161	            timeout=self.timeout,
162	            client=self._client)
163	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/plans.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
175	        }
176	        return make_request(
177	            '{}wallet'.format(self.url),
178	            method='POST',
179	            body=request,
180	            timeout=self.timeout,
181	            client=self._client)
182	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/plans.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
189	        """
190	        return make_request(
191	            '{}wallet/{}'.format(self.url, wallet_name),
192	            method='DELETE',
193	            timeout=self.timeout,
194	            client=self._client)
195	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/plans.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
208	        }
209	        return make_request(
210	            '{}wallet/{}/budget'.format(self.url, wallet_name),
211	            method='POST',
212	            body=request,
213	            timeout=self.timeout,
214	            client=self._client)
215	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/plans.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
230	        }
231	        return make_request(
232	            '{}model/{}/budget'.format(self.url, model_uuid),
233	            method='PATCH',
234	            body=request,
235	            timeout=self.timeout,
236	            client=self._client)
237	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/plans.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
245	        """
246	        return make_request(
247	            '{}model/{}/budget'.format(self.url, model_uuid),
248	            method='DELETE',
249	            timeout=self.timeout,
250	            client=self._client)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/support.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
83	        try:
84	            r = requests.post(self.url, data={
85	                'orgid': self.orgId,
86	                'recordType': self.recordType,
87	                'name': name,
88	                'email': email,
89	                'subject': subject,
90	                'description': description,
91	                self.BUSINESS_IMPACT: businessImpact,
92	                'priority': priority,
93	                'phone': phone,
94	                'external': 1
95	                }, timeout=self.timeout)
96	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/terms.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
49	            url = '{}?revision={}'.format(url, revision)
50	        json = make_request(url, timeout=self.timeout, client=self._client)
51	        try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/theblues-0.5.2/theblues-0.5.2/theblues/utils.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	API_URL = 'https://api.jujucharms.com/charmstore/v5'
19	DEFAULT_TIMEOUT = 3.05

--------------------------------------------------

Code scanned:
	Total lines of code: 1107
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 33.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 1.0
Files skipped (0):
