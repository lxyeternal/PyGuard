Run started:2025-04-12 18:47:14.683950

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/bottleneck/src/bn_config.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	        for setting in output:
117	            f.write("#define {} {}\n".format(*setting))
118	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/bottleneck/src/bn_config.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
119	        if inline_alias == "inline":
120	            f.write("/* undef inline */\n")
121	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/bottleneck/src/bn_config.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
121	        else:
122	            f.write("#define inline {}\n".format(inline_alias))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/bottleneck/src/bn_template.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	        with open(template_file, "r") as f:
27	            src_str = f.read()
28	        src_str = '#line 1 "{}"\n'.format(posix_template) + template(src_str)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/bottleneck/src/bn_template.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
31	        with open(target_file, "w") as f:
32	            f.write(src_str)
33	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/bottleneck/tests/test_template.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
16	    with open(os.path.join(dirpath, "truth.c")) as f:
17	        truth = f.read()
18	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/bottleneck/tests/test_template.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	    with open(os.path.join(dirpath, "test.c")) as f:
20	        test = f.read()
21	    test = test.replace(path.relpath(dirpath), "{DIRPATH}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/doc/source/conf.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	
229	extlinks = {"issue": ("https://github.com/pydata/bottleneck/issues/%s", "#")}
230	intersphinx_mapping = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/doc/source/conf.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
230	intersphinx_mapping = {
231	    "numpy": ("https://docs.scipy.org/doc/numpy/", None),
232	    "numpydoc": ("https://numpydoc.readthedocs.io/en/latest/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/doc/source/conf.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
231	    "numpy": ("https://docs.scipy.org/doc/numpy/", None),
232	    "numpydoc": ("https://numpydoc.readthedocs.io/en/latest/", None),
233	}

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/setup.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
58	        for delete_dir in self.delete_dirs:
59	            shutil.rmtree(delete_dir)
60	        for delete_file in self.delete_files:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/setup.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
148	    with open("README.rst", "r") as fid:
149	        long_description = fid.read()
150	    idx = max(0, long_description.find("Bottleneck is a collection"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/setup.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	    long_description_content_type="text/x-rst",
181	    url="https://github.com/pydata/bottleneck",
182	    download_url="http://pypi.python.org/pypi/Bottleneck",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/setup.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
181	    url="https://github.com/pydata/bottleneck",
182	    download_url="http://pypi.python.org/pypi/Bottleneck",
183	    license="Simplified BSD",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
425	
426	LONG_VERSION_PY['git'] = r'''
427	# This file helps to compute a version number in source trees obtained from
428	# git-archive tarball (such as those provided by githubs download-from-tag
429	# feature). Distribution tarballs (built by setup.py sdist) and build
430	# directories (produced by setup.py build) will contain a much shorter file
431	# that just contains the computed version number.
432	
433	# This file is released into the public domain. Generated by
434	# versioneer-0.22 (https://github.com/python-versioneer/python-versioneer)
435	
436	"""Git implementation of _version.py."""
437	
438	import errno
439	import os
440	import re
441	import subprocess
442	import sys
443	from typing import Callable, Dict
444	import functools
445	
446	
447	def get_keywords():
448	    """Get the keywords needed to look up the version information."""
449	    # these strings will be replaced by git during git-archive.
450	    # setup.py/versioneer.py will grep for the variable names, so they must
451	    # each be defined on a line of their own. _version.py will just call
452	    # get_keywords().
453	    git_refnames = "%(DOLLAR)sFormat:%%d%(DOLLAR)s"
454	    git_full = "%(DOLLAR)sFormat:%%H%(DOLLAR)s"
455	    git_date = "%(DOLLAR)sFormat:%%ci%(DOLLAR)s"
456	    keywords = {"refnames": git_refnames, "full": git_full, "date": git_date}
457	    return keywords
458	
459	
460	class VersioneerConfig:
461	    """Container for Versioneer configuration parameters."""
462	
463	
464	def get_config():
465	    """Create, populate and return the VersioneerConfig() object."""
466	    # these strings are filled in when 'setup.py versioneer' creates
467	    # _version.py
468	    cfg = VersioneerConfig()
469	    cfg.VCS = "git"
470	    cfg.style = "%(STYLE)s"
471	    cfg.tag_prefix = "%(TAG_PREFIX)s"
472	    cfg.parentdir_prefix = "%(PARENTDIR_PREFIX)s"
473	    cfg.versionfile_source = "%(VERSIONFILE_SOURCE)s"
474	    cfg.verbose = False
475	    return cfg
476	
477	
478	class NotThisMethod(Exception):
479	    """Exception raised if a method is not valid for the current scenario."""
480	
481	
482	LONG_VERSION_PY: Dict[str, str] = {}
483	HANDLERS: Dict[str, Dict[str, Callable]] = {}
484	
485	
486	def register_vcs_handler(vcs, method):  # decorator
487	    """Create decorator to mark a method as the handler of a VCS."""
488	    def decorate(f):
489	        """Store f in HANDLERS[vcs][method]."""
490	        if vcs not in HANDLERS:
491	            HANDLERS[vcs] = {}
492	        HANDLERS[vcs][method] = f
493	        return f
494	    return decorate
495	
496	
497	def run_command(commands, args, cwd=None, verbose=False, hide_stderr=False,
498	                env=None):
499	    """Call the given command(s)."""
500	    assert isinstance(commands, list)
501	    process = None
502	
503	    popen_kwargs = {}
504	    if sys.platform == "win32":
505	        # This hides the console window if pythonw.exe is used
506	        startupinfo = subprocess.STARTUPINFO()
507	        startupinfo.dwFlags |= subprocess.STARTF_USESHOWWINDOW
508	        popen_kwargs["startupinfo"] = startupinfo
509	
510	    for command in commands:
511	        try:
512	            dispcmd = str([command] + args)
513	            # remember shell=False, so use git.cmd on windows, not just git
514	            process = subprocess.Popen([command] + args, cwd=cwd, env=env,
515	                                       stdout=subprocess.PIPE,
516	                                       stderr=(subprocess.PIPE if hide_stderr
517	                                               else None), **popen_kwargs)
518	            break
519	        except OSError:
520	            e = sys.exc_info()[1]
521	            if e.errno == errno.ENOENT:
522	                continue
523	            if verbose:
524	                print("unable to run %%s" %% dispcmd)
525	                print(e)
526	            return None, None
527	    else:
528	        if verbose:
529	            print("unable to find command, tried %%s" %% (commands,))
530	        return None, None
531	    stdout = process.communicate()[0].strip().decode()
532	    if process.returncode != 0:
533	        if verbose:
534	            print("unable to run %%s (error)" %% dispcmd)
535	            print("stdout was %%s" %% stdout)
536	        return None, process.returncode
537	    return stdout, process.returncode
538	
539	
540	def versions_from_parentdir(parentdir_prefix, root, verbose):
541	    """Try to determine the version from the parent directory name.
542	
543	    Source tarballs conventionally unpack into a directory that includes both
544	    the project name and a version string. We will also support searching up
545	    two directory levels for an appropriately named parent directory
546	    """
547	    rootdirs = []
548	
549	    for _ in range(3):
550	        dirname = os.path.basename(root)
551	        if dirname.startswith(parentdir_prefix):
552	            return {"version": dirname[len(parentdir_prefix):],
553	                    "full-revisionid": None,
554	                    "dirty": False, "error": None, "date": None}
555	        rootdirs.append(root)
556	        root = os.path.dirname(root)  # up a level
557	
558	    if verbose:
559	        print("Tried directories %%s but none started with prefix %%s" %%
560	              (str(rootdirs), parentdir_prefix))
561	    raise NotThisMethod("rootdir doesn't start with parentdir_prefix")
562	
563	
564	@register_vcs_handler("git", "get_keywords")
565	def git_get_keywords(versionfile_abs):
566	    """Extract version information from the given file."""
567	    # the code embedded in _version.py can just fetch the value of these
568	    # keywords. When used from setup.py, we don't want to import _version.py,
569	    # so we do it with a regexp instead. This function is not used from
570	    # _version.py.
571	    keywords = {}
572	    try:
573	        with open(versionfile_abs, "r") as fobj:
574	            for line in fobj:
575	                if line.strip().startswith("git_refnames ="):
576	                    mo = re.search(r'=\s*"(.*)"', line)
577	                    if mo:
578	                        keywords["refnames"] = mo.group(1)
579	                if line.strip().startswith("git_full ="):
580	                    mo = re.search(r'=\s*"(.*)"', line)
581	                    if mo:
582	                        keywords["full"] = mo.group(1)
583	                if line.strip().startswith("git_date ="):
584	                    mo = re.search(r'=\s*"(.*)"', line)
585	                    if mo:
586	                        keywords["date"] = mo.group(1)
587	    except OSError:
588	        pass
589	    return keywords
590	
591	
592	@register_vcs_handler("git", "keywords")
593	def git_versions_from_keywords(keywords, tag_prefix, verbose):
594	    """Get version information from git keywords."""
595	    if "refnames" not in keywords:
596	        raise NotThisMethod("Short version file found")
597	    date = keywords.get("date")
598	    if date is not None:
599	        # Use only the last line.  Previous lines may contain GPG signature
600	        # information.
601	        date = date.splitlines()[-1]
602	
603	        # git-2.2.0 added "%%cI", which expands to an ISO-8601 -compliant
604	        # datestamp. However we prefer "%%ci" (which expands to an "ISO-8601
605	        # -like" string, which we must then edit to make compliant), because
606	        # it's been around since git-1.5.3, and it's too difficult to
607	        # discover which version we're using, or to work around using an
608	        # older one.
609	        date = date.strip().replace(" ", "T", 1).replace(" ", "", 1)
610	    refnames = keywords["refnames"].strip()
611	    if refnames.startswith("$Format"):
612	        if verbose:
613	            print("keywords are unexpanded, not using")
614	        raise NotThisMethod("unexpanded keywords, not a git-archive tarball")
615	    refs = {r.strip() for r in refnames.strip("()").split(",")}
616	    # starting in git-1.8.3, tags are listed as "tag: foo-1.0" instead of
617	    # just "foo-1.0". If we see a "tag: " prefix, prefer those.
618	    TAG = "tag: "
619	    tags = {r[len(TAG):] for r in refs if r.startswith(TAG)}
620	    if not tags:
621	        # Either we're using git < 1.8.3, or there really are no tags. We use
622	        # a heuristic: assume all version tags have a digit. The old git %%d
623	        # expansion behaves like git log --decorate=short and strips out the
624	        # refs/heads/ and refs/tags/ prefixes that would let us distinguish
625	        # between branches and tags. By ignoring refnames without digits, we
626	        # filter out many common branch names like "release" and
627	        # "stabilization", as well as "HEAD" and "master".
628	        tags = {r for r in refs if re.search(r'\d', r)}
629	        if verbose:
630	            print("discarding '%%s', no digits" %% ",".join(refs - tags))
631	    if verbose:
632	        print("likely tags: %%s" %% ",".join(sorted(tags)))
633	    for ref in sorted(tags):
634	        # sorting will prefer e.g. "2.0" over "2.0rc1"
635	        if ref.startswith(tag_prefix):
636	            r = ref[len(tag_prefix):]
637	            # Filter out refs that exactly match prefix or that don't start
638	            # with a number once the prefix is stripped (mostly a concern
639	            # when prefix is '')
640	            if not re.match(r'\d', r):
641	                continue
642	            if verbose:
643	                print("picking %%s" %% r)
644	            return {"version": r,
645	                    "full-revisionid": keywords["full"].strip(),
646	                    "dirty": False, "error": None,
647	                    "date": date}
648	    # no suitable tags, so version is "0+unknown", but full hex is still there
649	    if verbose:
650	        print("no suitable tags, using unknown + full revision id")
651	    return {"version": "0+unknown",
652	            "full-revisionid": keywords["full"].strip(),
653	            "dirty": False, "error": "no suitable tags", "date": None}
654	
655	
656	@register_vcs_handler("git", "pieces_from_vcs")
657	def git_pieces_from_vcs(tag_prefix, root, verbose, runner=run_command):
658	    """Get version from 'git describe' in the root of the source tree.
659	
660	    This only gets called if the git-archive 'subst' keywords were *not*
661	    expanded, and _version.py hasn't already been rewritten with a short
662	    version string, meaning we're inside a checked out source tree.
663	    """
664	    GITS = ["git"]
665	    if sys.platform == "win32":
666	        GITS = ["git.cmd", "git.exe"]
667	
668	    # GIT_DIR can interfere with correct operation of Versioneer.
669	    # It may be intended to be passed to the Versioneer-versioned project,
670	    # but that should not change where we get our version from.
671	    env = os.environ.copy()
672	    env.pop("GIT_DIR", None)
673	    runner = functools.partial(runner, env=env)
674	
675	    _, rc = runner(GITS, ["rev-parse", "--git-dir"], cwd=root,
676	                   hide_stderr=True)
677	    if rc != 0:
678	        if verbose:
679	            print("Directory %%s not under git control" %% root)
680	        raise NotThisMethod("'git rev-parse --git-dir' returned error")
681	
682	    MATCH_ARGS = ["--match", "%%s*" %% tag_prefix] if tag_prefix else []
683	
684	    # if there is a tag matching tag_prefix, this yields TAG-NUM-gHEX[-dirty]
685	    # if there isn't one, this yields HEX[-dirty] (no NUM)
686	    describe_out, rc = runner(GITS, ["describe", "--tags", "--dirty",
687	                                     "--always", "--long", *MATCH_ARGS],
688	                              cwd=root)
689	    # --long was added in git-1.5.5
690	    if describe_out is None:
691	        raise NotThisMethod("'git describe' failed")
692	    describe_out = describe_out.strip()
693	    full_out, rc = runner(GITS, ["rev-parse", "HEAD"], cwd=root)
694	    if full_out is None:
695	        raise NotThisMethod("'git rev-parse' failed")
696	    full_out = full_out.strip()
697	
698	    pieces = {}
699	    pieces["long"] = full_out
700	    pieces["short"] = full_out[:7]  # maybe improved later
701	    pieces["error"] = None
702	
703	    branch_name, rc = runner(GITS, ["rev-parse", "--abbrev-ref", "HEAD"],
704	                             cwd=root)
705	    # --abbrev-ref was added in git-1.6.3
706	    if rc != 0 or branch_name is None:
707	        raise NotThisMethod("'git rev-parse --abbrev-ref' returned error")
708	    branch_name = branch_name.strip()
709	
710	    if branch_name == "HEAD":
711	        # If we aren't exactly on a branch, pick a branch which represents
712	        # the current commit. If all else fails, we are on a branchless
713	        # commit.
714	        branches, rc = runner(GITS, ["branch", "--contains"], cwd=root)
715	        # --contains was added in git-1.5.4
716	        if rc != 0 or branches is None:
717	            raise NotThisMethod("'git branch --contains' returned error")
718	        branches = branches.split("\n")
719	
720	        # Remove the first line if we're running detached
721	        if "(" in branches[0]:
722	            branches.pop(0)
723	
724	        # Strip off the leading "* " from the list of branches.
725	        branches = [branch[2:] for branch in branches]
726	        if "master" in branches:
727	            branch_name = "master"
728	        elif not branches:
729	            branch_name = None
730	        else:
731	            # Pick the first branch that is returned. Good or bad.
732	            branch_name = branches[0]
733	
734	    pieces["branch"] = branch_name
735	
736	    # parse describe_out. It will be like TAG-NUM-gHEX[-dirty] or HEX[-dirty]
737	    # TAG might have hyphens.
738	    git_describe = describe_out
739	
740	    # look for -dirty suffix
741	    dirty = git_describe.endswith("-dirty")
742	    pieces["dirty"] = dirty
743	    if dirty:
744	        git_describe = git_describe[:git_describe.rindex("-dirty")]
745	
746	    # now we have TAG-NUM-gHEX or HEX
747	
748	    if "-" in git_describe:
749	        # TAG-NUM-gHEX
750	        mo = re.search(r'^(.+)-(\d+)-g([0-9a-f]+)$', git_describe)
751	        if not mo:
752	            # unparsable. Maybe git-describe is misbehaving?
753	            pieces["error"] = ("unable to parse git-describe output: '%%s'"
754	                               %% describe_out)
755	            return pieces
756	
757	        # tag
758	        full_tag = mo.group(1)
759	        if not full_tag.startswith(tag_prefix):
760	            if verbose:
761	                fmt = "tag '%%s' doesn't start with prefix '%%s'"
762	                print(fmt %% (full_tag, tag_prefix))
763	            pieces["error"] = ("tag '%%s' doesn't start with prefix '%%s'"
764	                               %% (full_tag, tag_prefix))
765	            return pieces
766	        pieces["closest-tag"] = full_tag[len(tag_prefix):]
767	
768	        # distance: number of commits since tag
769	        pieces["distance"] = int(mo.group(2))
770	
771	        # commit: short hex revision ID
772	        pieces["short"] = mo.group(3)
773	
774	    else:
775	        # HEX: no tags
776	        pieces["closest-tag"] = None
777	        count_out, rc = runner(GITS, ["rev-list", "HEAD", "--count"], cwd=root)
778	        pieces["distance"] = int(count_out)  # total number of commits
779	
780	    # commit date: see ISO-8601 comment in git_versions_from_keywords()
781	    date = runner(GITS, ["show", "-s", "--format=%%ci", "HEAD"], cwd=root)[0].strip()
782	    # Use only the last line.  Previous lines may contain GPG signature
783	    # information.
784	    date = date.splitlines()[-1]
785	    pieces["date"] = date.strip().replace(" ", "T", 1).replace(" ", "", 1)
786	
787	    return pieces
788	
789	
790	def plus_or_dot(pieces):
791	    """Return a + if we don't already have one, else return a ."""
792	    if "+" in pieces.get("closest-tag", ""):
793	        return "."
794	    return "+"
795	
796	
797	def render_pep440(pieces):
798	    """Build up version string, with post-release "local version identifier".
799	
800	    Our goal: TAG[+DISTANCE.gHEX[.dirty]] . Note that if you
801	    get a tagged build and then dirty it, you'll get TAG+0.gHEX.dirty
802	
803	    Exceptions:
804	    1: no tags. git_describe was just HEX. 0+untagged.DISTANCE.gHEX[.dirty]
805	    """
806	    if pieces["closest-tag"]:
807	        rendered = pieces["closest-tag"]
808	        if pieces["distance"] or pieces["dirty"]:
809	            rendered += plus_or_dot(pieces)
810	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
811	            if pieces["dirty"]:
812	                rendered += ".dirty"
813	    else:
814	        # exception #1
815	        rendered = "0+untagged.%%d.g%%s" %% (pieces["distance"],
816	                                          pieces["short"])
817	        if pieces["dirty"]:
818	            rendered += ".dirty"
819	    return rendered
820	
821	
822	def render_pep440_branch(pieces):
823	    """TAG[[.dev0]+DISTANCE.gHEX[.dirty]] .
824	
825	    The ".dev0" means not master branch. Note that .dev0 sorts backwards
826	    (a feature branch will appear "older" than the master branch).
827	
828	    Exceptions:
829	    1: no tags. 0[.dev0]+untagged.DISTANCE.gHEX[.dirty]
830	    """
831	    if pieces["closest-tag"]:
832	        rendered = pieces["closest-tag"]
833	        if pieces["distance"] or pieces["dirty"]:
834	            if pieces["branch"] != "master":
835	                rendered += ".dev0"
836	            rendered += plus_or_dot(pieces)
837	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
838	            if pieces["dirty"]:
839	                rendered += ".dirty"
840	    else:
841	        # exception #1
842	        rendered = "0"
843	        if pieces["branch"] != "master":
844	            rendered += ".dev0"
845	        rendered += "+untagged.%%d.g%%s" %% (pieces["distance"],
846	                                          pieces["short"])
847	        if pieces["dirty"]:
848	            rendered += ".dirty"
849	    return rendered
850	
851	
852	def pep440_split_post(ver):
853	    """Split pep440 version string at the post-release segment.
854	
855	    Returns the release segments before the post-release and the
856	    post-release version number (or -1 if no post-release segment is present).
857	    """
858	    vc = str.split(ver, ".post")
859	    return vc[0], int(vc[1] or 0) if len(vc) == 2 else None
860	
861	
862	def render_pep440_pre(pieces):
863	    """TAG[.postN.devDISTANCE] -- No -dirty.
864	
865	    Exceptions:
866	    1: no tags. 0.post0.devDISTANCE
867	    """
868	    if pieces["closest-tag"]:
869	        if pieces["distance"]:
870	            # update the post release segment
871	            tag_version, post_version = pep440_split_post(pieces["closest-tag"])
872	            rendered = tag_version
873	            if post_version is not None:
874	                rendered += ".post%%d.dev%%d" %% (post_version+1, pieces["distance"])
875	            else:
876	                rendered += ".post0.dev%%d" %% (pieces["distance"])
877	        else:
878	            # no commits, use the tag as the version
879	            rendered = pieces["closest-tag"]
880	    else:
881	        # exception #1
882	        rendered = "0.post0.dev%%d" %% pieces["distance"]
883	    return rendered
884	
885	
886	def render_pep440_post(pieces):
887	    """TAG[.postDISTANCE[.dev0]+gHEX] .
888	
889	    The ".dev0" means dirty. Note that .dev0 sorts backwards
890	    (a dirty tree will appear "older" than the corresponding clean one),
891	    but you shouldn't be releasing software with -dirty anyways.
892	
893	    Exceptions:
894	    1: no tags. 0.postDISTANCE[.dev0]
895	    """
896	    if pieces["closest-tag"]:
897	        rendered = pieces["closest-tag"]
898	        if pieces["distance"] or pieces["dirty"]:
899	            rendered += ".post%%d" %% pieces["distance"]
900	            if pieces["dirty"]:
901	                rendered += ".dev0"
902	            rendered += plus_or_dot(pieces)
903	            rendered += "g%%s" %% pieces["short"]
904	    else:
905	        # exception #1
906	        rendered = "0.post%%d" %% pieces["distance"]
907	        if pieces["dirty"]:
908	            rendered += ".dev0"
909	        rendered += "+g%%s" %% pieces["short"]
910	    return rendered
911	
912	
913	def render_pep440_post_branch(pieces):
914	    """TAG[.postDISTANCE[.dev0]+gHEX[.dirty]] .
915	
916	    The ".dev0" means not master branch.
917	
918	    Exceptions:
919	    1: no tags. 0.postDISTANCE[.dev0]+gHEX[.dirty]
920	    """
921	    if pieces["closest-tag"]:
922	        rendered = pieces["closest-tag"]
923	        if pieces["distance"] or pieces["dirty"]:
924	            rendered += ".post%%d" %% pieces["distance"]
925	            if pieces["branch"] != "master":
926	                rendered += ".dev0"
927	            rendered += plus_or_dot(pieces)
928	            rendered += "g%%s" %% pieces["short"]
929	            if pieces["dirty"]:
930	                rendered += ".dirty"
931	    else:
932	        # exception #1
933	        rendered = "0.post%%d" %% pieces["distance"]
934	        if pieces["branch"] != "master":
935	            rendered += ".dev0"
936	        rendered += "+g%%s" %% pieces["short"]
937	        if pieces["dirty"]:
938	            rendered += ".dirty"
939	    return rendered
940	
941	
942	def render_pep440_old(pieces):
943	    """TAG[.postDISTANCE[.dev0]] .
944	
945	    The ".dev0" means dirty.
946	
947	    Exceptions:
948	    1: no tags. 0.postDISTANCE[.dev0]
949	    """
950	    if pieces["closest-tag"]:
951	        rendered = pieces["closest-tag"]
952	        if pieces["distance"] or pieces["dirty"]:
953	            rendered += ".post%%d" %% pieces["distance"]
954	            if pieces["dirty"]:
955	                rendered += ".dev0"
956	    else:
957	        # exception #1
958	        rendered = "0.post%%d" %% pieces["distance"]
959	        if pieces["dirty"]:
960	            rendered += ".dev0"
961	    return rendered
962	
963	
964	def render_git_describe(pieces):
965	    """TAG[-DISTANCE-gHEX][-dirty].
966	
967	    Like 'git describe --tags --dirty --always'.
968	
969	    Exceptions:
970	    1: no tags. HEX[-dirty]  (note: no 'g' prefix)
971	    """
972	    if pieces["closest-tag"]:
973	        rendered = pieces["closest-tag"]
974	        if pieces["distance"]:
975	            rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
976	    else:
977	        # exception #1
978	        rendered = pieces["short"]
979	    if pieces["dirty"]:
980	        rendered += "-dirty"
981	    return rendered
982	
983	
984	def render_git_describe_long(pieces):
985	    """TAG-DISTANCE-gHEX[-dirty].
986	
987	    Like 'git describe --tags --dirty --always -long'.
988	    The distance/hash is unconditional.
989	
990	    Exceptions:
991	    1: no tags. HEX[-dirty]  (note: no 'g' prefix)
992	    """
993	    if pieces["closest-tag"]:
994	        rendered = pieces["closest-tag"]
995	        rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
996	    else:
997	        # exception #1
998	        rendered = pieces["short"]
999	    if pieces["dirty"]:
1000	        rendered += "-dirty"
1001	    return rendered
1002	
1003	
1004	def render(pieces, style):
1005	    """Render the given version pieces into the requested style."""
1006	    if pieces["error"]:
1007	        return {"version": "unknown",
1008	                "full-revisionid": pieces.get("long"),
1009	                "dirty": None,
1010	                "error": pieces["error"],
1011	                "date": None}
1012	
1013	    if not style or style == "default":
1014	        style = "pep440"  # the default
1015	
1016	    if style == "pep440":
1017	        rendered = render_pep440(pieces)
1018	    elif style == "pep440-branch":
1019	        rendered = render_pep440_branch(pieces)
1020	    elif style == "pep440-pre":
1021	        rendered = render_pep440_pre(pieces)
1022	    elif style == "pep440-post":
1023	        rendered = render_pep440_post(pieces)
1024	    elif style == "pep440-post-branch":
1025	        rendered = render_pep440_post_branch(pieces)
1026	    elif style == "pep440-old":
1027	        rendered = render_pep440_old(pieces)
1028	    elif style == "git-describe":
1029	        rendered = render_git_describe(pieces)
1030	    elif style == "git-describe-long":
1031	        rendered = render_git_describe_long(pieces)
1032	    else:
1033	        raise ValueError("unknown style '%%s'" %% style)
1034	
1035	    return {"version": rendered, "full-revisionid": pieces["long"],
1036	            "dirty": pieces["dirty"], "error": None,
1037	            "date": pieces.get("date")}
1038	
1039	
1040	def get_versions():
1041	    """Get version information or return default if unable to do so."""
1042	    # I am in _version.py, which lives at ROOT/VERSIONFILE_SOURCE. If we have
1043	    # __file__, we can work backwards from there to the root. Some
1044	    # py2exe/bbfreeze/non-CPython implementations don't do __file__, in which
1045	    # case we can only use expanded keywords.
1046	
1047	    cfg = get_config()
1048	    verbose = cfg.verbose
1049	
1050	    try:
1051	        return git_versions_from_keywords(get_keywords(), cfg.tag_prefix,
1052	                                          verbose)
1053	    except NotThisMethod:
1054	        pass
1055	
1056	    try:
1057	        root = os.path.realpath(__file__)
1058	        # versionfile_source is the relative path from the top of the source
1059	        # tree (where the .git directory might live) to this file. Invert
1060	        # this to find the root from __file__.
1061	        for _ in cfg.versionfile_source.split('/'):
1062	            root = os.path.dirname(root)
1063	    except NameError:
1064	        return {"version": "0+unknown", "full-revisionid": None,
1065	                "dirty": None,
1066	                "error": "unable to find root of source tree",
1067	                "date": None}
1068	
1069	    try:
1070	        pieces = git_pieces_from_vcs(cfg.tag_prefix, root, verbose)
1071	        return render(pieces, cfg.style)
1072	    except NotThisMethod:
1073	        pass
1074	
1075	    try:
1076	        if cfg.parentdir_prefix:
1077	            return versions_from_parentdir(cfg.parentdir_prefix, root, verbose)
1078	    except NotThisMethod:
1079	        pass
1080	
1081	    return {"version": "0+unknown", "full-revisionid": None,
1082	            "dirty": None,
1083	            "error": "unable to compute version", "date": None}
1084	'''
1085	
1086	
1087	@register_vcs_handler("git", "get_keywords")
1088	def git_get_keywords(versionfile_abs):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:1345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1344	        with open(".gitattributes", "a+") as fobj:
1345	            fobj.write(f"{versionfile_source} export-subst\n")
1346	        files.append(".gitattributes")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:1396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1395	        with open(filename) as f:
1396	            contents = f.read()
1397	    except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:1415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1414	    with open(filename, "w") as f:
1415	        f.write(SHORT_VERSION_PY % contents)
1416	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:1892
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1891	                    LONG = LONG_VERSION_PY[cfg.VCS]
1892	                    f.write(LONG %
1893	                            {"DOLLAR": "$",
1894	                             "STYLE": cfg.style,
1895	                             "TAG_PREFIX": cfg.tag_prefix,
1896	                             "PARENTDIR_PREFIX": cfg.parentdir_prefix,
1897	                             "VERSIONFILE_SOURCE": cfg.versionfile_source,
1898	                             })

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:1918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1917	                    LONG = LONG_VERSION_PY[cfg.VCS]
1918	                    f.write(LONG %
1919	                            {"DOLLAR": "$",
1920	                             "STYLE": cfg.style,
1921	                             "TAG_PREFIX": cfg.tag_prefix,
1922	                             "PARENTDIR_PREFIX": cfg.parentdir_prefix,
1923	                             "VERSIONFILE_SOURCE": cfg.versionfile_source,
1924	                             })

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:2020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2019	            with open(os.path.join(root, "setup.cfg"), "a") as f:
2020	                f.write(SAMPLE_CONFIG)
2021	        print(CONFIG_ERROR, file=sys.stderr)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:2027
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2026	        LONG = LONG_VERSION_PY[cfg.VCS]
2027	        f.write(LONG % {"DOLLAR": "$",
2028	                        "STYLE": cfg.style,
2029	                        "TAG_PREFIX": cfg.tag_prefix,
2030	                        "PARENTDIR_PREFIX": cfg.parentdir_prefix,
2031	                        "VERSIONFILE_SOURCE": cfg.versionfile_source,
2032	                        })

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:2039
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2038	            with open(ipy, "r") as f:
2039	                old = f.read()
2040	        except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:2047
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2046	            with open(ipy, "w") as f:
2047	                f.write(old.replace(OLD_SNIPPET, snippet))
2048	        elif snippet not in old:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:2051
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2050	            with open(ipy, "a") as f:
2051	                f.write(snippet)
2052	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:2079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2078	        with open(manifest_in, "a") as f:
2079	            f.write("include versioneer.py\n")
2080	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bottleneck-1.4.2/bottleneck-1.4.2/versioneer.py:2086
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2085	        with open(manifest_in, "a") as f:
2086	            f.write("include %s\n" % cfg.versionfile_source)
2087	    else:

--------------------------------------------------

Code scanned:
	Total lines of code: 4008
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 21.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 0.0
Files skipped (0):
