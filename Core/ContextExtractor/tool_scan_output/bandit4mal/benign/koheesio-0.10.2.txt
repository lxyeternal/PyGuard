Run started:2025-04-12 15:31:45.712389

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/__about__.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	LICENSE_INFO = "Licensed as Apache 2.0"
14	SOURCE = "https://github.com/Nike-Inc/koheesio"
15	__version__ = "0.10.2"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/asyncio/http.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
137	            asyncio.create_task(
138	                self.request(
139	                    method=method,
140	                    url=u,
141	                    headers=self.get_headers(),
142	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/asyncio/http.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
279	        """
280	        async with self.__retry_client.request(method=method, url=url, **kwargs) as response:
281	            res = await response.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/integrations/snowflake/__init__.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
480	        alias="permissions",
481	        description="The Privilege/Permission or list of Privileges/Permissions to grant on the given object. "
482	        "See https://docs.snowflake.com/en/sql-reference/sql/grant-privilege.html",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/integrations/snowflake/__init__.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
524	            raise ValueError(
525	                "You must provide a `type`, e.g. TABLE, VIEW, DATABASE. "
526	                "See https://docs.snowflake.com/en/sql-reference/sql/grant-privilege.html"
527	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/integrations/spark/snowflake.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
686	        default=None,
687	        description="Schema tracking location to use. "
688	        "Info: https://docs.delta.io/latest/delta-streaming.html#-schema-tracking",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/integrations/spark/tableau/hyper.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	        default=None,
161	        description="Table definition to write to the Hyper file as described in "
162	        "https://tableau.github.io/hyper-db/lang_docs/py/tableauhyperapi.html#tableauhyperapi.TableDefinition",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/integrations/spark/tableau/hyper.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	        default={"log_config": ""},
167	        description="Set HyperProcess parameters, see Tableau Hyper API documentation for more details: "
168	        "https://tableau.github.io/hyper-db/docs/hyper-api/hyper_process/#process-settings",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/integrations/spark/tableau/server.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        alias="site_id",
38	        description="Identifier for the Tableau site, as used in the URL: https://tableau.my-org.com/#/site/SITE_ID",
39	    )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/notifications/slack.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
67	        """
68	        self.data = self.get_payload()
69	        HttpPostStep.execute(self)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/notifications/slack.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
121	        self.message = self.get_payload_message()
122	        self.data = self.get_payload()
123	        HttpPostStep.execute(self)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/readers/databricks/autoloader.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        default_factory=dict,
95	        description="Extra inputs to provide to the autoloader. For a full list of inputs, "
96	        "see https://docs.databricks.com/ingestion/auto-loader/options.html",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/readers/delta.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	        alias="readChangeFeed",
107	        description="Change Data Feed (CDF) feature allows Delta tables to track row-level changes between versions of "
108	        "a Delta table. When enabled on a Delta table, the runtime records 'change events' for all the data written "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/readers/delta.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
135	        alias="ignoreDeletes",
136	        description="ignoreDeletes: Ignore transactions that delete data at partition boundaries. "
137	        "Note: Only supported for streaming tables. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/readers/delta.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	        alias="skipChangeCommits",
152	        description="skipChangeCommits: Skip processing of change commits. "
153	        "Note: Only supported for streaming tables. (not supported in Open Source Delta Implementation). "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/readers/delta.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	        alias="schemaTrackingLocation",
161	        description="schemaTrackingLocation: Track the location of source schema. "
162	        "Note: Recommend to enable Delta reader version: 3 and writer version: 7 for this option. "
163	        "For more info see https://docs.delta.io/latest/delta-column-mapping.html" + STREAMING_SCHEMA_WARNING,
164	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/transformations/date_time/__init__.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        ...,
80	        description="The format for the resulting string. See "
81	        "https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/transformations/date_time/__init__.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	        alias="source_timezone",
122	        description="Timezone of the source_column value. Timezone fields are validated against the `TZ database name` "
123	        "column in this list: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/transformations/date_time/__init__.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	        alias="target_timezone",
128	        description="Target timezone. Timezone fields are validated against the `TZ database name` column in this "
129	        "list: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/transformations/date_time/__init__.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	            raise ValueError(
158	                "Not a valid timezone. Refer to the `TZ database name` column here: "
159	                "https://en.wikipedia.org/wiki/List_of_tz_database_time_zones"
160	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/transformations/date_time/__init__.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
275	        default=...,  # TODO: should we set a logic default here? [future release]
276	        description="The date format for of the timestamp field. See "
277	        "https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/transformations/sql_transform.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	            raise RuntimeError(
38	                "SQL Transform is not supported in remote sessions with streaming dataframes."
39	                "See https://issues.apache.org/jira/browse/SPARK-45957"
40	                "It is fixed in PySpark 4.0.0"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/writers/buffer.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	            self.rewind_buffer()
63	            data = self.buffer.read()
64	            self.rewind_buffer()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/writers/buffer.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	            self.rewind_buffer()
81	            magic_number_present = self.buffer.read(2) == b"\x1f\x8b"
82	            self.rewind_buffer()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/writers/buffer.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
93	            file_buffer = self.buffer
94	            compressed = gzip.compress(file_buffer.read())
95	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/writers/buffer.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	            self.reset_buffer()
98	            self.buffer.write(compressed)
99	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/spark/writers/buffer.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
97	            self.reset_buffer()
98	            self.buffer.write(compressed)
99	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/sso/okta.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	
109	        if token := json_payload.get("access_token"):
110	            self.output.token = SecretStr(token)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/steps/download_file.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
199	
200	        with self._request(stream=True) as response:  # type: ignore
201	            with self.output.download_file_path.open(mode=_write_mode) as f:  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/steps/http.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
235	            del self.auth_header
236	        if auth := self.headers.get("Authorization"):
237	            self.headers["Authorization"] = auth if isinstance(auth, SecretStr) else SecretStr(auth)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/steps/http.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
258	        """
259	        return json.loads(self.model_dump_json()).get("headers")
260	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/steps/http.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
325	
326	        with self.session.request(method=_method, **options, stream=stream) as response:
327	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/steps/http.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
338	        self.method = HttpMethod.GET
339	        with self.request() as response:
340	            return response

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/steps/http.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
344	        self.method = HttpMethod.POST
345	        with self.request() as response:
346	            return response

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/steps/http.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
350	        self.method = HttpMethod.PUT
351	        with self.request() as response:
352	            return response

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/steps/http.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
356	        self.method = HttpMethod.DELETE
357	        with self.request() as response:
358	            return response

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/steps/http.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
371	        """
372	        with self._request() as response:
373	            self.log.info(f"HTTP request to {self.url}, status code {response.status_code}")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/src/koheesio/steps/http.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
524	
525	            with self._request() as response:
526	                if isinstance(response_json := response.json(), list):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/asyncio/test_asyncio_http.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	# noinspection HttpUrlsUsage
14	ASYNC_BASE_URL = "http://httpbin.org"
15	ASYNC_GET_ENDPOINT = URL(f"{ASYNC_BASE_URL}/get")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/notifications/test_slack.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	
11	URL = "https://hooks.slack.com/services/foo/bar/baz"
12	
13	
14	def test_slack_notification():

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/notifications/test_slack.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
16	    with Mocker() as rm:
17	        rm.post(URL, text="ok", status_code=int(200))
18	        sn.execute()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/notifications/test_slack.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
26	    with Mocker() as rm:
27	        rm.post(URL, text="ok", status_code=int(200))
28	        sn.execute()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/notifications/test_slack.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	        assert sn.output.status_code == 200
30	        assert not json.loads(sn.data).get("channel")
31	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/notifications/test_slack.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
43	    with Mocker() as rm:
44	        rm.post(URL, text="ok", status_code=int(200))
45	        sn.execute()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/snowflake/test_snowflake.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	        common_options = deepcopy(COMMON_OPTIONS)
142	        common_options["url"] = "https://host2.host1.snowflakecomputing.com"
143	        kls = SnowflakeRunQueryPython(**common_options, sql="SELECT * FROM table")

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/conftest.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
40	def is_port_free(port):
41	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
42	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/conftest.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	    """
146	    yield DummyReader(range=1).read()
147	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/integrations/box/test_box.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	            mf.get.return_value = Properties(name=mf.name)
76	            mf.get_shared_link.return_value = "https://my-ent.box.com/dummy"
77	            return mf

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/integrations/dq/test_spark_expectations.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	            "spark.expectations.notifications.slack.enabled": True,
150	            "spark.expectations.notifications.slack.webhook_url": "https://hooks.slack.com/...",
151	            "spark.expectations.notifications.on_start": True,
152	            "spark.expectations.notifications.on_completion": True,
153	            "spark.expectations.notifications.on_fail": True,
154	            "spark.expectations.notifications.on.error.drop.exceeds.threshold.breach": False,
155	            "spark.expectations.notifications.error.drop.threshold": 15,
156	        }
157	        instance = SparkExpectationsTransformation(
158	            product_id="test_product",
159	            product_rules_table="default.test_product_rules",
160	            dq_stats_table_name="default.test_product_dq_stats",
161	            target_table_name="default.output_table",
162	            drop_meta_column=True,
163	            se_user_conf=conf,
164	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/integrations/tableau/test_server.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	        yield TableauServer(
71	            url="https://tableau.domain.com", user="user", password="pass", site_id="site", project_id="1"
72	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/integrations/tableau/test_server.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	        p = TableauHyperPublisher(
117	            url="https://tableau.domain.com",
118	            user="user",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/readers/test_rest_api.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	ASYNC_BASE_URL = "http://httpbin.org"
14	ASYNC_GET_ENDPOINT = URL(f"{ASYNC_BASE_URL}/get")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/readers/test_rest_api.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	            data = [{"id": j, "page": i, "value": f"data_{i}_{j}"} for j in range(1, 11)]  # 10 records per page
24	            m.get(f"https://api.example.com/data?page={i}", json=data)
25	        yield m

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/readers/test_rest_api.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	            data = [{"id": j, "page": i, "value": f"data_{i}_{j}"} for j in range(1, 11)]  # 10 records per page
24	            m.get(f"https://api.example.com/data?page={i}", json=data)
25	        yield m

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/readers/test_rest_api.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	    # Test that the paginated API returns all the data
30	    transport = PaginatedHttpGetStep(url="https://api.example.com/data?page={page}", paginate=True, pages=3)
31	    task = RestApiReader(transport=transport, spark_schema="id: int, page:int, value: string")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/tasks/test_etl_task.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	
97	        assert "https://issues.apache.org/jira/browse/SPARK-45957" in str(excinfo.value.args[0])
98	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/test_spark.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	            OktaAccessToken(url="https://abc.okta.com", client_id="client_id", client_secret=secret)
30	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/transformations/test_download_files.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        [
14	            (101, "http://www.textfiles.com/100/adventur.txt"),
15	            (102, "http://www.textfiles.com/100/arttext.fun"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/transformations/test_download_files.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	            (101, "http://www.textfiles.com/100/adventur.txt"),
15	            (102, "http://www.textfiles.com/100/arttext.fun"),
16	        ],

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/spark/writers/delta/test_delta_writer.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
234	    )
235	    delta_writer.write()
236	    await_job_completion(spark, timeout=20, query_id=delta_writer.streaming_query.id)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/sso/test_okta.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	
26	    url = "https://host.okta.com/oauth2/auth/v1/token"
27	    ot = o.OktaAccessToken(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/sso/test_okta.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
41	        # Arrange
42	        requests_mocker.post(self.url, json={"access_token": "bar"}, status_code=int(200))
43	        # Act

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/sso/test_okta.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
49	        """Test OktaAccessToken without token"""
50	        requests_mocker.post(self.url, json={"foo": "bar"}, status_code=int(200))
51	        with pytest.raises(ValueError):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/sso/test_okta.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
55	        """Test OktaAccessToken with non-200 response"""
56	        requests_mocker.post(self.url, status_code=int(404))
57	        with pytest.raises(o.HTTPError):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/sso/test_okta.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
91	        # Arrange
92	        requests_mocker.post(self.url, status_code=int(404))
93	        with caplog.at_level("DEBUG"):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_download_file.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	URL = "http://example.com/testfile.txt"
11	log = LoggingFactory.get_logger(name="test_download_file", inherit_from_koheesio=True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_download_file.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	            # Arrange
81	            mocker.get(URL, content=large_file_path.read_bytes())
82	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_download_file.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	        with Mocker() as mocker:
106	            mocker.get(URL, content=b"bar")
107	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_download_file.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	        with Mocker() as mocker:
122	            mocker.get(URL, content=b"bar")
123	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_download_file.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	        with caplog.at_level("INFO"), Mocker() as mocker:
140	            mocker.get(URL, content=b"bar")
141	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_download_file.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	        with Mocker() as mocker:
158	            mocker.get(URL, content=b"bar")
159	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_download_file.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
170	        with Mocker() as mocker:
171	            mocker.get(URL, content=b"bar")
172	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_http.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	BASE_URL = "https://httpbin.org"
21	GET_ENDPOINT = f"{BASE_URL}/get"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_http.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
94	    with requests_mock.Mocker() as rm:
95	        rm.request(method=method, url=endpoint, json=return_value, status_code=int(expected_status_code))
96	        step = step(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_http.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
94	    with requests_mock.Mocker() as rm:
95	        rm.request(method=method, url=endpoint, json=return_value, status_code=int(expected_status_code))
96	        step = step(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_http.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	    with requests_mock.Mocker() as rm:
123	        rm.get(GET_ENDPOINT, status_code=int(200))
124	        response = HttpStep(method="get", url=GET_ENDPOINT).execute()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_http.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	    with requests_mock.Mocker() as rm:
130	        rm.get(GET_ENDPOINT, status_code=int(200))
131	        # Will be raised during class instantiation

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_http.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
141	        step = HttpStep(url=PUT_ENDPOINT)
142	        with step._request(method=HttpMethod.PUT) as response:
143	            assert response.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_http.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
141	        step = HttpStep(url=PUT_ENDPOINT)
142	        with step._request(method=HttpMethod.PUT) as response:
143	            assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_http.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	    with requests_mock.Mocker() as rm:
180	        rm.get(params["url"], status_code=int(200))  # Mock the request to be always successful
181	        step = HttpStep(**params)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/koheesio-0.10.2/koheesio-0.10.2/tests/steps/test_http.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	        caplog.set_level("DEBUG", logger=step.log.name)
183	        auth = step.headers.get("Authorization")
184	        step.execute()

--------------------------------------------------

Code scanned:
	Total lines of code: 24205
	Total lines skipped (#nosec): 5

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 45.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 80.0
		High: 1.0
Files skipped (0):
