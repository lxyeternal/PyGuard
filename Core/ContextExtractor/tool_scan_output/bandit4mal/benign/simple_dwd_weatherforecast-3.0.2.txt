Run started:2025-04-12 10:50:33.208570

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    long_description_content_type="text/markdown",
13	    url="https://github.com/FL550/simple_dwd_weatherforecast.git",
14	    packages=setuptools.find_packages(),

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
23	):
24	    stations = json.load(file)
25	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
32	):
33	    uv_stations = json.load(file)
34	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
138	    namespaces = {
139	        "kml": "http://www.opengis.net/kml/2.2",
140	        "dwd": "https://opendata.dwd.de/weather/lib/pointforecast_dwd_extension_V1_0.xsd",
141	    }
142	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	        "kml": "http://www.opengis.net/kml/2.2",
140	        "dwd": "https://opendata.dwd.de/weather/lib/pointforecast_dwd_extension_V1_0.xsd",
141	    }
142	
143	    weather_codes = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
310	            self.strip_to_day(
311	                arrow.get(
312	                    list(self.forecast_data.keys())[0],  # type: ignore
313	                    "YYYY-MM-DDTHH:mm:ss.SSSZ",  # type: ignore
314	                ).datetime

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
317	            <= self.strip_to_day(
318	                arrow.get(
319	                    list(self.forecast_data.keys())[-1],  # type: ignore
320	                    "YYYY-MM-DDTHH:mm:ss.SSSZ",  # type: ignore
321	                ).datetime

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
624	        result = []
625	        first_entry_date = arrow.get(
626	            next(iter(self.forecast_data)),  # type: ignore
627	            "YYYY-MM-DDTHH:mm:ss.SSSZ",  # type: ignore
628	        ).datetime  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
761	    def parse_issue_time(self, tree):
762	        issue_time_new = arrow.get(
763	            tree.xpath("//dwd:IssueTime", namespaces=self.namespaces)[0].text,
764	            "YYYY-MM-DDTHH:mm:ss.SSSZ",
765	        ).datetime

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
908	    def download_uv_index(self):
909	        url = "https://opendata.dwd.de/climate_environment/health/alerts/uvi.json"
910	        headers = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
914	        try:
915	            request = requests.get(url, headers=headers, timeout=30)
916	            # If resource has not been modified, return

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
933	    def download_weather_report(self, region_code):
934	        url = f"https://www.dwd.de/DWD/wetter/wv_allg/deutschland/text/vhdl13_{region_code}.html"
935	        headers = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
939	        try:
940	            request = requests.get(url, headers=headers, timeout=30)
941	            # If resource has not been modified, return

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:954
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
953	    def download_small_kml(self, stationid) -> bytes | None:
954	        url = f"https://opendata.dwd.de/weather/local_forecasts/mos/MOSMIX_L/single_stations/{stationid}/kml/MOSMIX_L_LATEST_{stationid}.kmz"
955	        headers = {"If-None-Match": self.etags[url] if url in self.etags else ""}  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:957
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
956	        try:
957	            request = requests.get(url, headers=headers, timeout=30)
958	            # If resource has not been modified, return

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
979	        placemark = b""
980	        url = "https://opendata.dwd.de/weather/local_forecasts/mos/MOSMIX_S/all_stations/kml/MOSMIX_S_LATEST_240.kmz"
981	        # Check if content has updated
982	        headers = {"If-None-Match": self.etags[url] if url in self.etags else ""}  # type: ignore

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:1047
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1046	        url = (
1047	            f"https://opendata.dwd.de/weather/weather_reports/poi/{station_id}-BEOB.csv"
1048	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdforecast.py:1051
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1050	        try:
1051	            response = requests.get(url, headers=headers, timeout=30)
1052	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdmap.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
185	
186	    url = f"https://maps.dwd.de/geoserver/dwd/wms?service=WMS&version=1.3.0&request=GetMap&layers={layers}&bbox={miny},{minx},{maxy},{maxx}&width={image_width}&height={image_height}&srs=EPSG:4326&styles=&format=image/png"
187	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdmap.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
187	
188	    request = requests.get(url, stream=True)
189	    if request.status_code == 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdmap.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
332	        )
333	        url = f"https://maps.dwd.de/geoserver/dwd/wms?service=WMS&version=1.3.0&request=GetMap&layers={layers}&bbox={self._miny},{self._minx},{self._maxy},{self._maxx}&width={self._image_width}&height={self._image_height}&srs=EPSG:4326&styles=&format=image/png&TIME={date.strftime('%Y-%m-%dT%H:%M:00.0Z')}"
334	        request = requests.get(url, stream=True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast/dwdmap.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
333	        url = f"https://maps.dwd.de/geoserver/dwd/wms?service=WMS&version=1.3.0&request=GetMap&layers={layers}&bbox={self._miny},{self._minx},{self._maxy},{self._maxx}&width={self._image_width}&height={self._image_height}&srs=EPSG:4326&styles=&format=image/png&TIME={date.strftime('%Y-%m-%dT%H:%M:00.0Z')}"
334	        request = requests.get(url, stream=True)
335	        if request.status_code != 200 or request.headers["content-type"] != "image/png":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/simple_dwd_weatherforecast-3.0.2/simple_dwd_weatherforecast-3.0.2/tests/test_update.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	        self.dwd_weather.etags[
107	            "https://opendata.dwd.de/weather/local_forecasts/mos/MOSMIX_L/single_stations/{stationid}/kml/MOSMIX_L_LATEST_{stationid}.kmz"
108	        ] = "invalid_etag"
109	        self.dwd_weather.download_latest_kml(stationid)

--------------------------------------------------

Code scanned:
	Total lines of code: 13434
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 12.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 0.0
Files skipped (0):
