Run started:2025-04-12 11:29:19.818262

Test results:
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
140	        self.cookies = self.cookies or cookies.SimpleCookie()
141	        self.cookies.load(header_tuple[1])
142	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
159	        if self.compressed == "gzip":
160	            self.body += gzip_decompress(data)
161	        elif self.compressed == "deflate":

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
161	        elif self.compressed == "deflate":
162	            self.body += zlib_decompress(data)
163	        else:

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:162
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
161	        elif self.compressed == "deflate":
162	            self.body += zlib_decompress(data)
163	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
341	
342	    connection.write(chunk_size.encode() + chunk + CRLF.encode())
343	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
357	        raise MissingWriterException("missing writer in connection")
358	    connection.write(("0" + CRLF * 2).encode())
359	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
445	        if connection.h2conn:
446	            return await connection.http2_request(to_send, body)
447	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
450	
451	        connection.write(to_send)
452	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
458	                    async for chunk in body:
459	                        connection.write(chunk)
460	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
460	            else:
461	                connection.write(body)
462	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
551	        """Do get http request."""
552	        return await self.request(
553	            url=url,
554	            method="GET",
555	            headers=headers,
556	            params=params,
557	            verify=verify,
558	            ssl=ssl,
559	            follow=follow,
560	            timeouts=timeouts,
561	            http2=http2,
562	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
579	        """Do post http request."""
580	        return await self.request(
581	            url=url,
582	            method="POST",
583	            headers=headers,
584	            params=params,
585	            data=data,
586	            json=json,
587	            json_serializer=json_serializer,
588	            multipart=multipart,
589	            verify=verify,
590	            ssl=ssl,
591	            follow=follow,
592	            timeouts=timeouts,
593	            http2=http2,
594	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
611	        """Do put http request."""
612	        return await self.request(
613	            url=url,
614	            method="PUT",
615	            headers=headers,
616	            params=params,
617	            data=data,
618	            json=json,
619	            json_serializer=json_serializer,
620	            multipart=multipart,
621	            verify=verify,
622	            ssl=ssl,
623	            follow=follow,
624	            timeouts=timeouts,
625	            http2=http2,
626	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
643	        """Do patch http request."""
644	        return await self.request(
645	            url=url,
646	            method="PATCH",
647	            headers=headers,
648	            params=params,
649	            data=data,
650	            json=json,
651	            json_serializer=json_serializer,
652	            multipart=multipart,
653	            verify=verify,
654	            ssl=ssl,
655	            follow=follow,
656	            timeouts=timeouts,
657	            http2=http2,
658	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
675	        """Do delete http request."""
676	        return await self.request(
677	            url=url,
678	            method="DELETE",
679	            headers=headers,
680	            params=params,
681	            data=data,
682	            json=json,
683	            json_serializer=json_serializer,
684	            multipart=multipart,
685	            verify=verify,
686	            ssl=ssl,
687	            follow=follow,
688	            timeouts=timeouts,
689	            http2=http2,
690	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
739	        if self.handle_cookies:
740	            self._add_cookies_to_request(str(urlparsed.hostname), headers)
741	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
754	        elif data:
755	            body = http_parser.setup_body_request(data, headers)
756	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
773	                response = await wait_for(
774	                    _do_request(
775	                        urlparsed,
776	                        headers_data,
777	                        self.connector,
778	                        body,
779	                        verify_ssl,
780	                        ssl,
781	                        timeouts,
782	                        http2,
783	                        self.proxy,
784	                        transfer_chunked=transfer_chunked,
785	                    ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
798	                    if self.handle_cookies:
799	                        self._add_cookies_to_request(str(urlparsed.hostname), headers)
800	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
864	    assert connection.writer
865	    connection.write(to_send.encode())
866	    await connection.writer.drain()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
867	
868	    connect_response = await connection.read(4096)
869	    if b"200 Connection established" not in connect_response:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/client.py:868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
867	
868	    connect_response = await connection.read(4096)
869	    if b"200 Connection established" not in connect_response:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/connection.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
113	            raise MissingWriterException("writer not set.")
114	        self.writer.write(data)
115	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/connection.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
159	            raise MissingReaderException("reader not set.")
160	        return await self.reader.read(size)
161	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/connection.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
159	            raise MissingReaderException("reader not set.")
160	        return await self.reader.read(size)
161	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/connection.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
313	        if self.h2handler:  # pragma: no cover
314	            return await self.h2handler.request(headers, body)
315	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/http2.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
31	        # h2conn.update_settings({SettingsFrame.HEADER_TABLE_SIZE: 4096})
32	        self.writer.write(h2conn.data_to_send())
33	        self.reader_task = loop.create_task(self.reader_t())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/http2.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
91	        while True:
92	            data = await asyncio.wait_for(self.reader.read(read_size), 2)
93	            events = self.h2conn.receive_data(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/http2.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
102	                else:
103	                    await self.check_to_write()
104	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/http2.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
153	            dlogger.debug(("writing data", data_to_send))
154	            self.writer.write(data_to_send)
155	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/proxy.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
17	        if auth:
18	            self.auth = b64encode(auth.encode())

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/proxy.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
17	        if auth:
18	            self.auth = b64encode(auth.encode())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/web_socket_client.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
189	        async with self._send_lock:
190	            self.conn.write(frame)
191	            await self.conn.writer.drain()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/web_socket_client.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
389	
390	        ws_key = base64.b64encode(os.urandom(16)).decode()
391	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/web_socket_client.py:390
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
389	
390	        ws_key = base64.b64encode(os.urandom(16)).decode()
391	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/web_socket_client.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
416	        )
417	        conn.write(request.encode())
418	        await conn.writer.drain()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/web_socket_client.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
423	
424	        expected_key = base64.b64encode(
425	            hashlib.sha1(f"{ws_key}{WEBSOCKET_GUID}".encode()).digest()
426	        ).decode()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosonic-0.24.0/aiosonic-0.24.0/aiosonic/web_socket_client.py:424
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
423	
424	        expected_key = base64.b64encode(
425	            hashlib.sha1(f"{ws_key}{WEBSOCKET_GUID}".encode()).digest()
426	        ).decode()

--------------------------------------------------

Code scanned:
	Total lines of code: 2378
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 34.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 4.0
Files skipped (0):
