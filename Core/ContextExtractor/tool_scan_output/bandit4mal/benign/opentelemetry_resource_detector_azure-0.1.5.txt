Run started:2025-04-12 17:42:38.354373

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resource_detector_azure-0.1.5/opentelemetry_resource_detector_azure-0.1.5/src/opentelemetry/resource/detector/azure/_constants.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	
55	_AZURE_VM_METADATA_ENDPOINT = "http://169.254.169.254/metadata/instance/compute?api-version=2021-12-13&format=json"
56	_AZURE_VM_SCALE_SET_NAME_ATTRIBUTE = "azure.vm.scaleset.name"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resource_detector_azure-0.1.5/opentelemetry_resource_detector_azure-0.1.5/src/opentelemetry/resource/detector/azure/vm.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
65	        # VM metadata service should not take more than 200ms on success case
66	        with urlopen(request, timeout=0.2) as response:
67	            return loads(response.read())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resource_detector_azure-0.1.5/opentelemetry_resource_detector_azure-0.1.5/tests/test_vm.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	LINUX_JSON = """
21	{
22	    "additionalCapabilities": {
23	        "hibernationEnabled": "false"
24	    },
25	    "azEnvironment": "AzurePublicCloud",
26	    "customData": "",
27	    "evictionPolicy": "",
28	    "extendedLocation": {
29	        "name": "",
30	        "type": ""
31	    },
32	    "host": {
33	        "id": ""
34	    },
35	    "hostGroup": {
36	        "id": ""
37	    },
38	    "isHostCompatibilityLayerVm": "true",
39	    "licenseType": "",
40	    "location": "westus",
41	    "name": "examplevmname",
42	    "offer": "0001-com-ubuntu-server-focal",
43	    "osProfile": {
44	        "adminUsername": "azureuser",
45	        "computerName": "examplevmname",
46	        "disablePasswordAuthentication": "true"
47	    },
48	    "osType": "Linux",
49	    "placementGroupId": "",
50	    "plan": {
51	        "name": "",
52	        "product": "",
53	        "publisher": ""
54	    },
55	    "platformFaultDomain": "0",
56	    "platformSubFaultDomain": "",
57	    "platformUpdateDomain": "0",
58	    "priority": "",
59	    "provider": "Microsoft.Compute",
60	    "publicKeys": [
61	        {
62	            "keyData": "ssh-rsa 0",
63	            "path": "/home/user/.ssh/authorized_keys0"
64	        },
65	        {
66	            "keyData": "ssh-rsa 1",
67	            "path": "/home/user/.ssh/authorized_keys1"
68	        }
69	    ],
70	    "publisher": "canonical",
71	    "resourceGroupName": "macikgo-test-may-23",
72	    "resourceId": "/subscriptions/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx/resourceGroups/macikgo-test-may-23/providers/Microsoft.Compute/virtualMachines/examplevmname",
73	    "securityProfile": {
74	        "encryptionAtHost": "false",
75	        "secureBootEnabled": "true",
76	        "securityType": "TrustedLaunch",
77	        "virtualTpmEnabled": "true"
78	    },
79	    "sku": "20_04-lts-gen2",
80	    "storageProfile": {
81	        "dataDisks": [
82	            {
83	                "bytesPerSecondThrottle": "979202048",
84	                "caching": "None",
85	                "createOption": "Empty",
86	                "diskCapacityBytes": "274877906944",
87	                "diskSizeGB": "1024",
88	                "image": {
89	                    "uri": ""
90	                },
91	                "isSharedDisk": "false",
92	                "isUltraDisk": "true",
93	                "lun": "0",
94	                "managedDisk": {
95	                    "id": "/subscriptions/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx/resourceGroups/macikgo-test-may-23/providers/Microsoft.Compute/disks/exampledatadiskname",
96	                    "storageAccountType": "StandardSSD_LRS"
97	                },
98	                "name": "exampledatadiskname",
99	                "opsPerSecondThrottle": "65280",
100	                "vhd": {
101	                    "uri": ""
102	                },
103	                "writeAcceleratorEnabled": "false"
104	            }
105	        ],
106	        "imageReference": {
107	            "id": "",
108	            "offer": "0001-com-ubuntu-server-focal",
109	            "publisher": "canonical",
110	            "sku": "20_04-lts-gen2",
111	            "version": "latest"
112	        },
113	        "osDisk": {
114	            "caching": "ReadWrite",
115	            "createOption": "FromImage",
116	            "diffDiskSettings": {
117	                "option": ""
118	            },
119	            "diskSizeGB": "30",
120	            "encryptionSettings": {
121	                "enabled": "false",
122	                "diskEncryptionKey": {
123	                    "sourceVault": {
124	                        "id": "/subscriptions/test-source-guid/resourceGroups/testrg/providers/Microsoft.KeyVault/vaults/test-kv"
125	                    },
126	                    "secretUrl": "https://test-disk.vault.azure.net/secrets/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
127	                },
128	                "keyEncryptionKey": {
129	                    "sourceVault": {
130	                        "id": "/subscriptions/test-key-guid/resourceGroups/testrg/providers/Microsoft.KeyVault/vaults/test-kv"
131	                    },
132	                    "keyUrl": "https://test-key.vault.azure.net/secrets/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
133	                }
134	            },
135	            "image": {
136	                "uri": ""
137	            },
138	            "managedDisk": {
139	                "id": "/subscriptions/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx/resourceGroups/macikgo-test-may-23/providers/Microsoft.Compute/disks/exampleosdiskname",
140	                "storageAccountType": "StandardSSD_LRS"
141	            },
142	            "name": "exampledatadiskname",
143	            "osType": "Linux",
144	            "vhd": {
145	                "uri": ""
146	            },
147	            "writeAcceleratorEnabled": "false"
148	        },
149	        "resourceDisk": {
150	            "size": "16384"
151	        }
152	    },
153	    "subscriptionId": "xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx",
154	    "tags": "azsecpack:nonprod;platformsettings.host_environment.service.platform_optedin_for_rootcerts:true",
155	    "tagsList": [
156	        {
157	            "name": "azsecpack",
158	            "value": "nonprod"
159	        },
160	        {
161	            "name": "platformsettings.host_environment.service.platform_optedin_for_rootcerts",
162	            "value": "true"
163	        }
164	    ],
165	    "userData": "",
166	    "version": "20.04.202307240",
167	    "virtualMachineScaleSet": {
168	        "id": "/subscriptions/xxxxxxxx-xxxxx-xxx-xxx-xxxx/resourceGroups/resource-group-name/providers/Microsoft.Compute/virtualMachineScaleSets/virtual-machine-scale-set-name"
169	    },
170	    "vmId": "02aab8a4-74ef-476e-8182-f6d2ba4166a6",
171	    "vmScaleSetName": "crpteste9vflji9",
172	    "vmSize": "Standard_A3",
173	    "zone": "1"
174	}
175	"""
176	WINDOWS_JSON = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resource_detector_azure-0.1.5/opentelemetry_resource_detector_azure-0.1.5/tests/test_vm.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	"""
176	WINDOWS_JSON = """
177	{
178	    "additionalCapabilities": {
179	        "hibernationEnabled": "false"
180	    },
181	    "azEnvironment": "AzurePublicCloud",
182	    "customData": "",
183	    "evictionPolicy": "",
184	    "extendedLocation": {
185	        "name": "",
186	        "type": ""
187	    },
188	    "host": {
189	        "id": ""
190	    },
191	    "hostGroup": {
192	        "id": ""
193	    },
194	    "isHostCompatibilityLayerVm": "true",
195	    "licenseType": "Windows_Client",
196	    "location": "westus",
197	    "name": "examplevmname",
198	    "offer": "WindowsServer",
199	    "osProfile": {
200	        "adminUsername": "azureuser",
201	        "computerName": "examplevmname",
202	        "disablePasswordAuthentication": "true"
203	    },
204	    "osType": "Windows",
205	    "placementGroupId": "",
206	    "plan": {
207	        "name": "",
208	        "product": "",
209	        "publisher": ""
210	    },
211	    "platformFaultDomain": "0",
212	    "platformSubFaultDomain": "",
213	    "platformUpdateDomain": "0",
214	    "priority": "",
215	    "provider": "Microsoft.Compute",
216	    "publicKeys": [
217	        {
218	            "keyData": "ssh-rsa 0",
219	            "path": "/home/user/.ssh/authorized_keys0"
220	        },
221	        {
222	            "keyData": "ssh-rsa 1",
223	            "path": "/home/user/.ssh/authorized_keys1"
224	        }
225	    ],
226	    "publisher": "RDFE-Test-Microsoft-Windows-Server-Group",
227	    "resourceGroupName": "macikgo-test-may-23",
228	    "resourceId": "/subscriptions/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx/resourceGroups/macikgo-test-may-23/providers/Microsoft.Compute/virtualMachines/examplevmname",
229	    "securityProfile": {
230	        "encryptionAtHost": "false",
231	        "secureBootEnabled": "true",
232	        "securityType": "TrustedLaunch",
233	        "virtualTpmEnabled": "true"
234	    },
235	    "sku": "2019-Datacenter",
236	    "storageProfile": {
237	        "dataDisks": [
238	            {
239	                "bytesPerSecondThrottle": "979202048",
240	                "caching": "None",
241	                "createOption": "Empty",
242	                "diskCapacityBytes": "274877906944",
243	                "diskSizeGB": "1024",
244	                "image": {
245	                    "uri": ""
246	                },
247	                "isSharedDisk": "false",
248	                "isUltraDisk": "true",
249	                "lun": "0",
250	                "managedDisk": {
251	                    "id": "/subscriptions/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx/resourceGroups/macikgo-test-may-23/providers/Microsoft.Compute/disks/exampledatadiskname",
252	                    "storageAccountType": "StandardSSD_LRS"
253	                },
254	                "name": "exampledatadiskname",
255	                "opsPerSecondThrottle": "65280",
256	                "vhd": {
257	                    "uri": ""
258	                },
259	                "writeAcceleratorEnabled": "false"
260	            }
261	        ],
262	        "imageReference": {
263	            "id": "",
264	            "offer": "WindowsServer",
265	            "publisher": "MicrosoftWindowsServer",
266	            "sku": "2019-Datacenter",
267	            "version": "latest"
268	        },
269	        "osDisk": {
270	            "caching": "ReadWrite",
271	            "createOption": "FromImage",
272	            "diffDiskSettings": {
273	                "option": ""
274	            },
275	            "diskSizeGB": "30",
276	            "encryptionSettings": {
277	                "enabled": "false",
278	                "diskEncryptionKey": {
279	                    "sourceVault": {
280	                        "id": "/subscriptions/test-source-guid/resourceGroups/testrg/providers/Microsoft.KeyVault/vaults/test-kv"
281	                    },
282	                    "secretUrl": "https://test-disk.vault.azure.net/secrets/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
283	                },
284	                "keyEncryptionKey": {
285	                    "sourceVault": {
286	                        "id": "/subscriptions/test-key-guid/resourceGroups/testrg/providers/Microsoft.KeyVault/vaults/test-kv"
287	                    },
288	                    "keyUrl": "https://test-key.vault.azure.net/secrets/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx"
289	                }
290	            },
291	            "image": {
292	                "uri": ""
293	            },
294	            "managedDisk": {
295	                "id": "/subscriptions/xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx/resourceGroups/macikgo-test-may-23/providers/Microsoft.Compute/disks/exampleosdiskname",
296	                "storageAccountType": "StandardSSD_LRS"
297	            },
298	            "name": "exampledatadiskname",
299	            "osType": "Windows",
300	            "vhd": {
301	                "uri": ""
302	            },
303	            "writeAcceleratorEnabled": "false"
304	        },
305	        "resourceDisk": {
306	            "size": "16384"
307	        }
308	    },
309	    "subscriptionId": "xxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx",
310	    "tags": "azsecpack:nonprod;platformsettings.host_environment.service.platform_optedin_for_rootcerts:true",
311	    "userData": "Zm9vYmFy",
312	    "tagsList": [
313	        {
314	            "name": "azsecpack",
315	            "value": "nonprod"
316	        },
317	        {
318	            "name": "platformsettings.host_environment.service.platform_optedin_for_rootcerts",
319	            "value": "true"
320	        }
321	    ],
322	    "userData": "",
323	    "version": "20.04.202307240",
324	    "virtualMachineScaleSet": {
325	        "id": "/subscriptions/xxxxxxxx-xxxxx-xxx-xxx-xxxx/resourceGroups/resource-group-name/providers/Microsoft.Compute/virtualMachineScaleSets/virtual-machine-scale-set-name"
326	    },
327	    "vmId": "02aab8a4-74ef-476e-8182-f6d2ba4166a6",
328	    "vmScaleSetName": "crpteste9vflji9",
329	    "vmSize": "Standard_A3",
330	    "zone": "1"
331	}
332	"""
333	LINUX_ATTRIBUTES = {

--------------------------------------------------

Code scanned:
	Total lines of code: 858
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 1.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 0.0
Files skipped (0):
