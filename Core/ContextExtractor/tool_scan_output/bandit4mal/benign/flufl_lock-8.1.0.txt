Run started:2025-04-12 12:16:21.472600

Test results:
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/conftest.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
29	    queue = multiprocessing.Queue()
30	    proc = multiprocessing.Process(
31	        target=child_locker,
32	        args=(filename, timedelta(seconds=lifetime), queue, extra_sleep))
33	    proc.start()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/conftest.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
48	    queue = multiprocessing.Queue()
49	    proc = multiprocessing.Process(
50	        target=child_waitfor,
51	        args=(filename, lifetime, queue))
52	    proc.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/conftest.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	    with open(lockfile) as fp:
61	        filename = fp.read().strip()
62	    lockfile, hostname, pid_str, random = filename.split(SEP)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/conftest.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66	    with open(lockfile, 'w') as fp:
67	        fp.write(SEP.join((lockfile, hostname, str(pid), random)))
68	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/conftest.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
66	    with open(lockfile, 'w') as fp:
67	        fp.write(SEP.join((lockfile, hostname, str(pid), random)))
68	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/docs/conf.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	intersphinx_mapping = {
34	    'python': ('https://docs.python.org/3/', None),
35	    }

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/src/flufl/lock/_lockfile.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
223	            with open(self._lockfile) as fp:
224	                filename = fp.read().strip()
225	        except OSError as error:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/src/flufl/lock/_lockfile.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
242	            with open(self._lockfile) as fp:
243	                filename = fp.read().strip()
244	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/src/flufl/lock/_lockfile.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
302	        if not self.is_locked and not unconditionally:
303	            raise NotLockedError(f'{self!r}: {self._read()}')
304	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/src/flufl/lock/_lockfile.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
321	        # Make sure the claim file exists, and that its contents are current.
322	        self._write()
323	        # XXX This next call can fail with an EPERM.  I have no idea why, but

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/src/flufl/lock/_lockfile.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
366	                    log.error(f'unexpected linkcount: {self._linkcount:d}')
367	                elif self._read() == self._claimfile:
368	                    # It was us that already had the link.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/src/flufl/lock/_lockfile.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
437	            return False
438	        return self._read() == self._claimfile
439	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/src/flufl/lock/_lockfile.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
489	        with open(self._claimfile, 'w') as fp:
490	            fp.write(self._claimfile)
491	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/src/flufl/lock/_lockfile.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
529	                with open(self._lockfile) as fp:
530	                    return fp.read()
531	            except OSError as error:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/src/flufl/lock/_lockfile.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
610	        # Get the name of the old winner's claim file.
611	        winner = self._read()
612	        # Remove the global lockfile, which actually breaks the lock.

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_api.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
6	    attributes = set(flufl.lock.__all__)
7	    exec('from flufl.lock import *', namespace)
8	    # __builtins__ is implicitly added to the namespace.

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
206	    queue = Queue()
207	    Process(target=child_locker, args=(lock.lockfile, queue)).start()
208	    # Wait for the child process to acquire the lock.

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
215	    queue = Queue()
216	    Process(target=child_locker, args=(lock.lockfile, queue)).start()
217	    # Wait for the child process to acquire the lock.

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
228	            with open(lock.lockfile, 'w') as fp:
229	                fp.write('xxx')
230	            assert lock.state == LockState.unknown

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
228	            with open(lock.lockfile, 'w') as fp:
229	                fp.write('xxx')
230	            assert lock.state == LockState.unknown

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
247	                    ))
248	                fp.write(claimfile)
249	            assert lock.state == LockState.unknown

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
247	                    ))
248	                fp.write(claimfile)
249	            assert lock.state == LockState.unknown

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
308	    queue = Queue()
309	    Process(target=child_locker, args=(lock.lockfile, queue)).start()
310	    # Wait for the child process to acquire the lock.

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
320	    queue = Queue()
321	    Process(target=child_locker, args=(lock.lockfile, queue)).start()
322	    # Wait for the child process to acquire the lock.

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
402	    queue = Queue()
403	    Process(target=child_locker, args=(lock.lockfile, queue)).start()
404	    # Wait for the child process to acquire the lock.

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
436	    queue = Queue()
437	    Process(target=child_locker, args=(lock.lockfile, queue)).start()
438	    # Wait for the child process to acquire the lock.

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
449	    queue = Queue()
450	    Process(target=child_locker, args=(lock.lockfile, queue)).start()
451	    # Wait for the child process to acquire the lock.

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
460	    queue = Queue()
461	    Process(target=child_locker,
462	            # Give the child lock a lifetime of 5 seconds.  We'll provide a
463	            # shorter timeout in the constructor, which should time out, but a
464	            # longer time in the lock() call which will result in acquiring
465	            # the lock when the lifetime of the child expires.
466	            args=(lock.lockfile, queue), kwargs=dict(sleep=3, lifetime=5),
467	            ).start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
491	    with open(lock.lockfile, 'w') as fp:
492	        fp.write('save me')
493	    # Put the lock file's release time in the past.  This has to include the

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
491	    with open(lock.lockfile, 'w') as fp:
492	        fp.write('save me')
493	    # Put the lock file's release time in the past.  This has to include the

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
499	    with open(lock.lockfile) as fp:
500	        assert fp.read() == 'save me'
501	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
519	    queue = Queue()
520	    proc = Process(target=child_locker,
521	            # The child will acquire the lock and sleep for 5 seconds, which
522	            # is longer than lock's lifetime.  Once the second boolean is
523	            # placed in the queue, we know that the sleep has completed and
524	            # the lock should be ready for breakage in the parent.
525	            args=(lock.lockfile, queue),
526	            kwargs=dict(sleep=5, lifetime=3, keep=True),
527	            ).start()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
535	    # Windows.
536	    if platform.system() == 'Windows':
537	        monkeypatch.setattr(

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
535	    # Windows.
536	    if platform.system() == 'Windows':
537	        monkeypatch.setattr(

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:536
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
535	    # Windows.
536	    if platform.system() == 'Windows':
537	        monkeypatch.setattr(

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
549	    queue = Queue()
550	    proc = Process(target=child_locker,
551	            # The child will acquire the lock and sleep for 5 seconds, which
552	            # is longer than lock's lifetime.  Once the second boolean is
553	            # placed in the queue, we know that the sleep has completed and
554	            # the lock should be ready for breakage in the parent.
555	            args=(lock.lockfile, queue),
556	            kwargs=dict(sleep=5, lifetime=3, keep=True),
557	            ).start()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
575	        raise OSError(ENINES, 'Bad Unlink')
576	    if platform.system() == 'Windows':
577	        monkeypatch.setattr(

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
575	        raise OSError(ENINES, 'Bad Unlink')
576	    if platform.system() == 'Windows':
577	        monkeypatch.setattr(

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flufl_lock-8.1.0/flufl_lock-8.1.0/test/test_lock.py:576
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
575	        raise OSError(ENINES, 'Bad Unlink')
576	    if platform.system() == 'Windows':
577	        monkeypatch.setattr(

--------------------------------------------------

Code scanned:
	Total lines of code: 952
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 35.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 3.0
Files skipped (0):
