Run started:2025-04-12 15:06:33.655478

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/__init__.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	api_key_path: Optional[str] = None
39	api_base: str = "https://api.voyageai.com/v1"
40	
41	verify_ssl_certs = True  # No effect. Certificates are always verified.

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/_base.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
181	                        image_str = segment.image_base64.split(",")[1]
182	                        image_data = base64.b64decode(image_str)
183	                        image = PIL.Image.open(io.BytesIO(image_data))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/_base.py:182
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
181	                        image_str = segment.image_base64.split(",")[1]
182	                        image_data = base64.b64decode(image_str)
183	                        image = PIL.Image.open(io.BytesIO(image_data))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	    def request_id(self) -> Optional[str]:
94	        return self._headers.get("request-id")
95	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	        try:
99	            return int(self._headers.get("retry-after"))
100	        except TypeError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	    def operation_location(self) -> Optional[str]:
105	        return self._headers.get("operation-location")
106	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	    def organization(self) -> Optional[str]:
109	        return self._headers.get("Voyage-Organization")
110	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	    def response_ms(self) -> Optional[int]:
113	        h = self._headers.get("Voyage-Processing-Ms")
114	        return None if h is None else round(float(h))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
313	        try:
314	            result = _thread_context.session.request(
315	                method,
316	                abs_url,
317	                headers=headers,
318	                data=data,
319	                files=files,
320	                stream=stream,
321	                timeout=request_timeout if request_timeout else TIMEOUT_SECS,
322	                proxies=_thread_context.session.proxies,
323	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
313	        try:
314	            result = _thread_context.session.request(
315	                method,
316	                abs_url,
317	                headers=headers,
318	                data=data,
319	                files=files,
320	                stream=stream,
321	                timeout=request_timeout if request_timeout else TIMEOUT_SECS,
322	                proxies=_thread_context.session.proxies,
323	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
333	            response_code=result.status_code,
334	            processing_ms=result.headers.get("Voyage-Processing-Ms"),
335	            request_id=result.headers.get("X-Request-Id"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
334	            processing_ms=result.headers.get("Voyage-Processing-Ms"),
335	            request_id=result.headers.get("X-Request-Id"),
336	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
385	        try:
386	            result = await session.request(**request_kwargs)
387	            util.log_info(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
385	        try:
386	            result = await session.request(**request_kwargs)
387	            util.log_info(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
390	                response_code=result.status,
391	                processing_ms=result.headers.get("Voyage-Processing-Ms"),
392	                request_id=result.headers.get("X-Request-Id"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
391	                processing_ms=result.headers.get("Voyage-Processing-Ms"),
392	                request_id=result.headers.get("X-Request-Id"),
393	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
451	        try:
452	            if "text/plain" in rheaders.get("Content-Type", ""):
453	                data = rbody

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/api_resources/api_requestor.py:513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
512	    async def __aenter__(self):
513	        self._session = voyageai.aiosession.get()
514	        if self._session is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/client.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	            warnings.warn(
59	                f"The `model` argument is not specified and defaults to {voyageai.VOYAGE_EMBED_DEFAULT_MODEL}. "
60	                "It will be a required argument in the future. We recommend to specify the model when using this "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/client_async.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	            warnings.warn(
60	                f"The `model` argument is not specified and defaults to {voyageai.VOYAGE_EMBED_DEFAULT_MODEL}. "
61	                "It will be a required argument in the future. We recommend to specify the model when using this "

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/embeddings_utils.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
132	
133	    with ThreadPoolExecutor(max_workers=DEFAULT_CONCURRENCE) as executor:
134	        futures = [

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/object/multimodal_embeddings.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
248	        image.convert("RGB").save(buffered, format=target_format, **conversion_kwargs)
249	        img_base64 = base64.b64encode(buffered.getvalue()).decode("utf-8")
250	        return f"data:{target_mime_type};base64,{img_base64}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/object/multimodal_embeddings.py:249
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
248	        image.convert("RGB").save(buffered, format=target_format, **conversion_kwargs)
249	        img_base64 = base64.b64encode(buffered.getvalue()).decode("utf-8")
250	        return f"data:{target_mime_type};base64,{img_base64}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/util.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	        with open(api_key_path, "rt") as k:
81	            api_key = k.read().strip()
82	            return api_key

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/util.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	        raise voyageai.error.AuthenticationError(
87	            "No API key provided. You can set your API key in code using 'voyageai.api_key = <API-KEY>', "
88	            "or set the environment variable VOYAGE_API_KEY=<API-KEY>). If your API key is stored "
89	            "in a file, you can point the voyageai module at it with 'voyageai.api_key_path = <PATH>', "

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/util.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
110	def decode_base64_embedding(embedding: str, dtype: Optional[str] = None) -> Union[List[float], List[int]]:
111	    arr = np.frombuffer(base64.b64decode(embedding), _resolve_numpy_dtype(dtype))
112	    return arr.tolist()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/voyageai-0.3.2/voyageai-0.3.2/voyageai/util.py:111
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
110	def decode_base64_embedding(embedding: str, dtype: Optional[str] = None) -> Union[List[float], List[int]]:
111	    arr = np.frombuffer(base64.b64decode(embedding), _resolve_numpy_dtype(dtype))
112	    return arr.tolist()

--------------------------------------------------

Code scanned:
	Total lines of code: 1708
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 3.0
Files skipped (0):
