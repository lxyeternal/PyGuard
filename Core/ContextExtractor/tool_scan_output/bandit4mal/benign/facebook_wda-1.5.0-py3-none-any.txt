Run started:2025-04-12 16:40:56.295051

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/__init__.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
232	        if not url:
233	            url = os.environ.get('DEVICE_URL', 'http://localhost:8100')
234	        assert re.match(r"^(http\+usbmux|https?)://", url), "Invalid URL: %r" % url

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/__init__.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
480	        value = self.http.get('screenshot').value
481	        raw_value = base64.b64decode(value)
482	        png_header = b"\x89PNG\r\n\x1a\n"

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/__init__.py:481
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
480	        value = self.http.get('screenshot').value
481	        raw_value = base64.b64decode(value)
482	        png_header = b"\x89PNG\r\n\x1a\n"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/__init__.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
487	            with open(png_filename, 'wb') as f:
488	                f.write(raw_value)
489	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/__init__.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
702	            "/wda/setPasteboard", {
703	                "content": base64.b64encode(content.encode()).decode(),
704	                "contentType": content_type

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/__init__.py:703
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
702	            "/wda/setPasteboard", {
703	                "content": base64.b64encode(content.encode()).decode(),
704	                "contentType": content_type

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/__init__.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
740	        self.app_launch(current_app_bundle_id)
741	        return base64.b64decode(clipboard_text).decode('utf-8')
742	    

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/__init__.py:741
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
740	        self.app_launch(current_app_bundle_id)
741	        return base64.b64decode(clipboard_text).decode('utf-8')
742	    

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/__init__.py:1219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1218	
1219	        threading.Thread(name="alert", target=_inner, daemon=True).start()
1220	        yield None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/__init__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
60	        if not data:
61	            conn.request(method, urlpath)
62	        else:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/__init__.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
62	        else:
63	            conn.request(method, urlpath, json.dumps(data), headers={"Content-Type": "application/json"})
64	        response = conn.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/__init__.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
63	            conn.request(method, urlpath, json.dumps(data), headers={"Content-Type": "application/json"})
64	        response = conn.getresponse()
65	        content = _read_response(response, chunk_size)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
95	        try:
96	            return mux.connect(self, port)
97	        except:  # noqa: E722

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
97	        except:  # noqa: E722
98	            mux.close()
99	            raise

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:121
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
120	        self._offset = 0
121	        self.sock = socket.socket(family, socket.SOCK_STREAM)
122	        self.sock.connect(address)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
121	        self.sock = socket.socket(family, socket.SOCK_STREAM)
122	        self.sock.connect(address)
123	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
125	        self._offset += len(msg)
126	        self.sock.sendall(msg)
127	        return len(msg)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
131	        while len(msg) < size:
132	            chunk = self.sock.recv(size - len(msg))
133	            self._offset += len(chunk)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
139	    def close(self) -> None:
140	        self.sock.close()
141	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
142	    def settimeout(self, interval: float) -> None:
143	        self.sock.settimeout(interval)
144	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
156	    # used on Windows
157	    ITUNES_HOST = ('127.0.0.1', 27015)
158	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
195	        })
196	        sock.send(message)
197	        response = usbmuxd_response.parse_stream(sock)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
199	        # if we sent a bad request, we should re-create the socket in the correct version this time
200	        sock.close()
201	        sock = MuxConnection.create_usbmux_socket(usbmux_address=usbmux_address)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
236	        """ connect to a relay port on target machine and get a raw python socket object for the connection """
237	        self._connect(device.devid, socket.htons(port))
238	        self._connected = True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
242	        """ close current socket """
243	        self._sock.close()
244	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
263	    def __exit__(self, exc_type, exc_val, exc_tb):
264	        self.close()
265	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
279	        while time.time() < end:
280	            self._sock.settimeout(end - time.time())
281	            try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
287	                    self._sock.setblocking(True)
288	                    self.close()
289	                except OSError:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
297	    def _connect(self, device_id: int, port: int):
298	        self._send({'header': {'version': self._version,
299	                               'message': usbmuxd_msgtype.CONNECT,
300	                               'tag': self._tag},
301	                    'data': {'device_id': device_id, 'port': port},
302	                    })

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
313	        self._assert_not_connected()
314	        self._sock.send(usbmuxd_request.build(data))
315	        self._tag += 1

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
324	    def _send_receive(self, message_type: int):
325	        self._send({'header': {'version': self._version, 'message': message_type, 'tag': self._tag},
326	                    'data': b''})
327	        response = self._receive(self._tag - 1)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
361	        # serials are saved inside usbmuxd without '-'
362	        self._send({'MessageType': 'ReadPairRecord', 'PairRecordID': serial})
363	        response = self._receive(self._tag - 1)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
371	        self.devices = []
372	        self._send({'MessageType': 'ListDevices'})
373	        for response in self._receive(self._tag - 1)['DeviceList']:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
383	        """ get SystemBUID """
384	        self._send({'MessageType': 'ReadBUID'})
385	        return self._receive(self._tag - 1)['BUID']

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
399	        request.update(data)
400	        super()._send({'header': {'version': self._version,
401	                                  'message': usbmuxd_msgtype.PLIST,
402	                                  'tag': self._tag},
403	                       'data': plistlib.dumps(request),
404	                       })

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
412	    def _send_receive(self, data: Mapping):
413	        self._send(data)
414	        response = self._receive(self._tag - 1)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
428	    devices = mux.devices
429	    mux.close()
430	    return devices

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
478	    def connect(self):
479	        self.sock = self.__device.connect(self.__port)
480	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facebook_wda-1.5.0-py3-none-any/wda/usbmux/pyusbmux.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
484	    def __exit__(self, exc_type, exc_value, traceback):
485	        self.close()

--------------------------------------------------

Code scanned:
	Total lines of code: 2122
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 33.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 4.0
Files skipped (0):
