Run started:2025-04-12 19:35:02.744131

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/auth.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	    def _get_azure_metadata_endpoint(cls, config: PrometheusConfig):
36	        return requests.get(
37	            url=config.azure_metadata_endpoint,
38	            headers={
39	                "Metadata": "true",
40	            },
41	            data={
42	                "api-version": "2018-02-01",
43	                "client_id": config.azure_client_id,
44	                "resource": config.azure_resource,
45	            },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/auth.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
50	    def _post_azure_token_endpoint(cls, config: PrometheusConfig):
51	        return requests.post(
52	            url=config.azure_token_endpoint,
53	            headers={"Content-Type": "application/x-www-form-urlencoded"},
54	            data={
55	                "grant_type": "client_credentials",
56	                "client_id": config.azure_client_id,
57	                "client_secret": config.azure_client_secret,
58	                "resource": config.azure_resource,
59	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/auth.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	
82	            cls.bearer_token = res.json().get("access_token")
83	            logging.info("Generated new azure access token.")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/aws_connect.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
27	        self._sigv4auth.add_auth(request)
28	        return requests.request(
29	            method=method,
30	            url=url,
31	            headers=dict(request.headers),
32	            verify=verify,
33	            data=data,
34	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/aws_connect.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
55	        # using the query API to get raw data
56	        response = self.signed_request(
57	            method="POST",
58	            url="{0}/api/v1/query".format(self.url),
59	            data={**{"query": query}, **params},
60	            params={},
61	            verify=self.ssl_verification,
62	            headers=self.headers,
63	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/aws_connect.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
94	        query = str(query)
95	        response = self.signed_request(
96	            method="POST",
97	            url="{0}/api/v1/query_range".format(self.url),
98	            data={
99	                **{"query": query, "start": start, "end": end, "step": step},
100	                **params,
101	            },
102	            params={},
103	            headers=self.headers,
104	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/aws_connect.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
115	        params = params or {}
116	        response = self.signed_request(
117	            method="GET",
118	            url="{0}/api/v1/label/{1}/values".format(self.url, label_name),
119	            verify=self.ssl_verification,
120	            headers=self.headers,
121	            params=params,
122	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/aws_connect.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
146	    def _send_series(self, data: dict, params: dict) -> requests.Response:
147	        return self.signed_request(
148	            method="POST",
149	            url=f"{self.url}/api/v1/series",
150	            data=data,
151	            headers=self.headers,
152	            params=params,
153	            verify=self.ssl_verification,
154	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/custom_connect.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
41	        # using the query_range API to get raw data
42	        response = self._session.post(
43	            "{0}/api/v1/query_range".format(self.url),
44	            data={
45	                "query": query,
46	                "start": start,
47	                "end": end,
48	                "step": step,
49	                **params,
50	            },
51	            verify=self.ssl_verification,
52	            headers=self.headers,
53	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/custom_connect.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
70	        # using the query API to get raw data
71	        response = self._session.post(
72	            "{0}/api/v1/query".format(self.url),
73	            data={"query": query, **params},
74	            verify=self.ssl_verification,
75	            headers=self.headers,
76	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/custom_connect.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138	        try:
139	            response = self._session.get(
140	                f"{self.url}/api/v1/status/flags",
141	                verify=self.ssl_verification,
142	                headers=self.headers,
143	                # This query should return empty results, but is correct
144	                params={},
145	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/custom_connect.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	            response.raise_for_status()
147	            return response.json().get("data", {})
148	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/custom_connect.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
155	            # connecting to VictoriaMetrics
156	            response = self._session.get(
157	                f"{self.url}/flags",
158	                verify=self.ssl_verification,
159	                headers=self.headers,
160	                # This query should return empty results, but is correct
161	                params={},
162	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometrix-0.2.0/prometrix-0.2.0/prometrix/connect/custom_connect.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
172	    def _send_series(self, data: dict, params: dict) -> requests.Response:
173	        return self._session.post(
174	            f"{self.url}/api/v1/series",
175	            data=data,
176	            verify=self.ssl_verification,
177	            headers=self.headers,
178	            params=params,
179	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 631
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 0.0
Files skipped (0):
