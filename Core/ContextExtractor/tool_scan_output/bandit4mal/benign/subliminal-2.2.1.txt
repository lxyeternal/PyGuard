Run started:2025-04-12 13:23:09.212036

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/docs/conf.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	intersphinx_mapping = {
303	    'python': ('https://docs.python.org/3.12', None),
304	    'guessit': ('https://guessit.readthedocs.org/en/latest', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/docs/conf.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
303	    'python': ('https://docs.python.org/3.12', None),
304	    'guessit': ('https://guessit.readthedocs.org/en/latest', None),
305	    'babelfish': ('https://babelfish.readthedocs.org/en/latest', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/docs/conf.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
304	    'guessit': ('https://guessit.readthedocs.org/en/latest', None),
305	    'babelfish': ('https://babelfish.readthedocs.org/en/latest', None),
306	    'dogpilecache': ('https://dogpilecache.sqlalchemy.org/en/latest', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/docs/conf.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
305	    'babelfish': ('https://babelfish.readthedocs.org/en/latest', None),
306	    'dogpilecache': ('https://dogpilecache.sqlalchemy.org/en/latest', None),
307	    'stevedore': ('https://docs.openstack.org/stevedore/latest', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/docs/conf.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
306	    'dogpilecache': ('https://dogpilecache.sqlalchemy.org/en/latest', None),
307	    'stevedore': ('https://docs.openstack.org/stevedore/latest', None),
308	    'click': ('https://click.palletsprojects.com/en/latest/', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/docs/conf.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
307	    'stevedore': ('https://docs.openstack.org/stevedore/latest', None),
308	    'click': ('https://click.palletsprojects.com/en/latest/', None),
309	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/cli.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
181	    context_settings={'max_content_width': 100},
182	    epilog='Suggestions and bug reports are greatly appreciated: https://github.com/Diaoul/subliminal/',
183	)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/core.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
307	
308	        with ThreadPoolExecutor(self.max_workers) as executor:
309	            executor_map = executor.map(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/core.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
819	            with open(subtitle_path, 'wb') as f:
820	                f.write(subtitle.content)
821	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/core.py:823
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
822	            with open(subtitle_path, 'w', encoding=encoding) as f:
823	                f.write(subtitle.text)
824	        saved_subtitles.append(subtitle)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/addic7ed.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	    video_types: ClassVar = (Episode,)
209	    server_url: ClassVar[str] = 'https://www.addic7ed.com'
210	    subtitle_class: ClassVar = Addic7edSubtitle

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/addic7ed.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
283	        # r = self.session.get(self.server_url + 'ajax_getShows.php', timeout=10)
284	        r = self.session.get(self.server_url, timeout=self.timeout)
285	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/addic7ed.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
332	            link = f'{self.server_url}/{path}'
333	            r = self.session.get(link, timeout=self.timeout)
334	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/addic7ed.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
385	        logger.info('Searching with %r', params)
386	        r = self.session.get(self.server_url + '/search.php', params=params, timeout=self.timeout)
387	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/addic7ed.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
419	            return None
420	        return show_ids.get(best_matches[0])  # type: ignore[no-any-return]
421	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/addic7ed.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
435	            logger.debug('Getting show id with country')
436	            show_id = show_ids.get(f'{series} {country_code.lower()}')
437	            if show_id is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/addic7ed.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
443	            series_year = concat_all(series, year)
444	            show_id = show_ids.get(series_year)
445	            if show_id is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/addic7ed.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
449	        logger.debug('Getting show id')
450	        return show_ids.get(series)
451	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/addic7ed.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
532	        params: dict[str, Any] = {'show': show_id, 'season': season, 'langs': '|'}
533	        r = self.session.get(
534	            self.server_url + '/ajax_loadShow.php',
535	            params=params,
536	            timeout=self.timeout,
537	            headers={'referer': f'{self.server_url}/show/{show_id}', 'X-Requested-With': 'XMLHttpRequest'},
538	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/addic7ed.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
615	        logger.info('Downloading subtitle %r', subtitle)
616	        r = self.session.get(
617	            f'{self.server_url}/{subtitle.subtitle_id}',
618	            headers={'Referer': subtitle.page_link},
619	            timeout=self.timeout,
620	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/gestdown.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	    video_types: ClassVar = (Episode,)
155	    server_url: ClassVar[str] = 'https://api.gestdown.info'
156	    subtitle_class: ClassVar = GestdownSubtitle

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/gestdown.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	        # make the search
199	        r = self.session.get(query, timeout=self.timeout)
200	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/gestdown.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	        query = f'{self.server_url}/shows/{show_id}/{season}/{language.alpha3}'
249	        r = self.session.get(query, timeout=self.timeout)
250	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/gestdown.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
287	
288	        r = self.session.get(query, timeout=self.timeout)
289	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/gestdown.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
405	        logger.info('Downloading subtitle %r', subtitle)
406	        r = self.session.get(subtitle.page_link, timeout=self.timeout)
407	        try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/napiprojekt.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	    required_hash: ClassVar = 'napiprojekt'
90	    server_url: ClassVar[str] = 'http://napiprojekt.pl/unit_napisy/dl.php'
91	
92	    timeout: int

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/napiprojekt.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	        logger.info('Searching subtitle %r', params)
153	        r = self.session.get(self.server_url, params=params, timeout=self.timeout)
154	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitles.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	
189	    server_url: ClassVar[str] = 'https://api.opensubtitles.org/xml-rpc'
190	    # user_agent = 'subliminal v%s' % __short_version__
191	    user_agent: str = 'VLSub 0.11.1'

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitles.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
349	        response = checked(self.server.DownloadSubtitles(self.token, [str(subtitle.subtitle_id)]))  # type: ignore[arg-type]
350	        subtitle.content = fix_line_ending(zlib.decompress(base64.b64decode(response['data'][0]['data']), 47))
351	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitles.py:350
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
349	        response = checked(self.server.DownloadSubtitles(self.token, [str(subtitle.subtitle_id)]))  # type: ignore[arg-type]
350	        subtitle.content = fix_line_ending(zlib.decompress(base64.b64decode(response['data'][0]['data']), 47))
351	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitles.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
349	        response = checked(self.server.DownloadSubtitles(self.token, [str(subtitle.subtitle_id)]))  # type: ignore[arg-type]
350	        subtitle.content = fix_line_ending(zlib.decompress(base64.b64decode(response['data'][0]['data']), 47))
351	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitles.py:350
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
349	        response = checked(self.server.DownloadSubtitles(self.token, [str(subtitle.subtitle_id)]))  # type: ignore[arg-type]
350	        subtitle.content = fix_line_ending(zlib.decompress(base64.b64decode(response['data'][0]['data']), 47))
351	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitles.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	
362	    server_url = 'https://vip-api.opensubtitles.org/xml-rpc'
363	    subtitle_class = OpenSubtitlesVipSubtitle

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	        # read the response
233	        subtitle_id = str(int(response.get('id')))  # type: ignore[arg-type]
234	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
234	
235	        attributes = response.get('attributes', {})
236	        language = Language.fromopensubtitlescom(str(attributes.get('language')))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
235	        attributes = response.get('attributes', {})
236	        language = Language.fromopensubtitlescom(str(attributes.get('language')))
237	        hearing_impaired = bool(int(attributes.get('hearing_impaired')))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	        language = Language.fromopensubtitlescom(str(attributes.get('language')))
237	        hearing_impaired = bool(int(attributes.get('hearing_impaired')))
238	        release = str(attributes.get('release'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
237	        hearing_impaired = bool(int(attributes.get('hearing_impaired')))
238	        release = str(attributes.get('release'))
239	        moviehash_match = bool(attributes.get('moviehash_match', False))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238	        release = str(attributes.get('release'))
239	        moviehash_match = bool(attributes.get('moviehash_match', False))
240	        download_count = int(attributes.get('download_count'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
239	        moviehash_match = bool(attributes.get('moviehash_match', False))
240	        download_count = int(attributes.get('download_count'))
241	        machine_translated = bool(int(attributes.get('machine_translated')))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
240	        download_count = int(attributes.get('download_count'))
241	        machine_translated = bool(int(attributes.get('machine_translated')))
242	        # fps = float(attributes.get('fps'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	
247	        feature_details = attributes.get('feature_details', {})
248	        movie_year = int(feature_details.get('year')) if feature_details.get('year') else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
247	        feature_details = attributes.get('feature_details', {})
248	        movie_year = int(feature_details.get('year')) if feature_details.get('year') else None
249	        movie_title = str(feature_details.get('title'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
247	        feature_details = attributes.get('feature_details', {})
248	        movie_year = int(feature_details.get('year')) if feature_details.get('year') else None
249	        movie_title = str(feature_details.get('title'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	        movie_year = int(feature_details.get('year')) if feature_details.get('year') else None
249	        movie_title = str(feature_details.get('title'))
250	        movie_full_name = str(feature_details.get('movie_name'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	        movie_title = str(feature_details.get('title'))
250	        movie_full_name = str(feature_details.get('movie_name'))
251	        movie_kind = str(feature_details.get('feature_type').lower())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
250	        movie_full_name = str(feature_details.get('movie_name'))
251	        movie_kind = str(feature_details.get('feature_type').lower())
252	        movie_imdb_id = decorate_imdb_id(feature_details.get('imdb_id'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	        movie_kind = str(feature_details.get('feature_type').lower())
252	        movie_imdb_id = decorate_imdb_id(feature_details.get('imdb_id'))
253	        movie_tmdb_id = feature_details.get('tmdb_id')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	        movie_imdb_id = decorate_imdb_id(feature_details.get('imdb_id'))
253	        movie_tmdb_id = feature_details.get('tmdb_id')
254	        series_season = int(feature_details.get('season_number')) if feature_details.get('season_number') else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	        movie_tmdb_id = feature_details.get('tmdb_id')
254	        series_season = int(feature_details.get('season_number')) if feature_details.get('season_number') else None
255	        series_episode = int(feature_details.get('episode_number')) if feature_details.get('episode_number') else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	        movie_tmdb_id = feature_details.get('tmdb_id')
254	        series_season = int(feature_details.get('season_number')) if feature_details.get('season_number') else None
255	        series_episode = int(feature_details.get('episode_number')) if feature_details.get('episode_number') else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
254	        series_season = int(feature_details.get('season_number')) if feature_details.get('season_number') else None
255	        series_episode = int(feature_details.get('episode_number')) if feature_details.get('episode_number') else None
256	        series_title = str(feature_details.get('parent_title'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
254	        series_season = int(feature_details.get('season_number')) if feature_details.get('season_number') else None
255	        series_episode = int(feature_details.get('episode_number')) if feature_details.get('episode_number') else None
256	        series_title = str(feature_details.get('parent_title'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
255	        series_episode = int(feature_details.get('episode_number')) if feature_details.get('episode_number') else None
256	        series_title = str(feature_details.get('parent_title'))
257	        series_imdb_id = decorate_imdb_id(feature_details.get('parent_imdb_id'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
256	        series_title = str(feature_details.get('parent_title'))
257	        series_imdb_id = decorate_imdb_id(feature_details.get('parent_imdb_id'))
258	        series_tmdb_id = feature_details.get('parent_tmdb_id')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
257	        series_imdb_id = decorate_imdb_id(feature_details.get('parent_imdb_id'))
258	        series_tmdb_id = feature_details.get('parent_tmdb_id')
259	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	
260	        files = attributes.get('files', [])
261	        srt_file: dict[str, Any] = {'file_id': 0, 'file_name': ''} if len(files) == 0 else files[0]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
261	        srt_file: dict[str, Any] = {'file_id': 0, 'file_name': ''} if len(files) == 0 else files[0]
262	        file_id = int(srt_file.get('file_id'))  # type: ignore[arg-type]
263	        file_name = str(srt_file.get('file_name'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	        file_id = int(srt_file.get('file_id'))  # type: ignore[arg-type]
263	        file_name = str(srt_file.get('file_name'))
264	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
362	
363	    server_url: ClassVar[str] = 'https://api.opensubtitles.com/api/v1/'
364	    subtitle_class: ClassVar = OpenSubtitlesComSubtitle

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
424	        # Check cached token
425	        token = region.get('oscom_token', expiration_time=TOKEN_EXPIRATION_TIME)
426	        if token is NO_VALUE:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
448	        try:
449	            r = self.session.post(self.server_url + 'login', json=data, timeout=self.timeout)
450	            r = checked(r)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
518	
519	        response = self.api_get('infos/user')
520	        logger.debug(response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
537	        try:
538	            r = self.session.post(self.server_url + path, json=body, timeout=self.timeout)
539	            r = checked(r)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
564	        try:
565	            r = self.session.get(self.server_url + path, params=params, timeout=self.timeout)
566	            r = checked(r)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
579	        # GET request and add page information
580	        response = self.api_get('subtitles', {'page': page, **params})
581	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
722	            languages,
723	            moviehash=video.hashes.get('opensubtitles'),
724	            imdb_id=video.imdb_id,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
740	        body = {'file_id': subtitle.file_id, 'file_name': subtitle.file_name, 'sub_format': self.subtitle_format}
741	        r = self.api_post('download', body)
742	        if any(k not in r for k in ('link', 'remaining')):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
756	        # download the subtitle
757	        download_response = self.session.get(link, timeout=self.timeout)
758	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/opensubtitlescom.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
776	
777	    server_url: ClassVar[str] = 'https://vip-api.opensubtitles.com/api/v1/'
778	    subtitle_class: ClassVar = OpenSubtitlesComVipSubtitle

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/podnapisi.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	    subtitle_class: ClassVar = PodnapisiSubtitle
92	    server_url: ClassVar[str] = 'https://www.podnapisi.net/subtitles'
93	
94	    timeout: int

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/podnapisi.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	            # query the server
157	            r = self.session.get(self.server_url + '/search/advanced', params=params, timeout=self.timeout)
158	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/podnapisi.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	                title = data['movie']['title']
179	                season = int(data['movie']['episode_info'].get('season')) if is_episode else None
180	                episode = int(data['movie']['episode_info'].get('episode')) if is_episode else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/podnapisi.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	                season = int(data['movie']['episode_info'].get('season')) if is_episode else None
180	                episode = int(data['movie']['episode_info'].get('episode')) if is_episode else None
181	                year = int(data['movie']['year'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/podnapisi.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238	        logger.info('Downloading subtitle %r', subtitle)
239	        r = self.session.get(
240	            self.server_url + f'/{subtitle.subtitle_id}/download',
241	            params={'container': 'zip'},
242	            timeout=self.timeout,
243	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/tvsubtitles.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	    video_types: ClassVar = (Episode,)
130	    server_url: ClassVar[str] = 'https://www.tvsubtitles.net'
131	    subtitle_class: ClassVar = TVsubtitlesSubtitle

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/tvsubtitles.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
165	        logger.info('Searching show id for %r', series)
166	        r = self.session.post(self.server_url + '/search.php', data={'qs': series}, timeout=10)
167	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/tvsubtitles.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	        logger.info('Getting the page of show id %d, season %d', show_id, season)
204	        r = self.session.get(self.server_url + f'/tvshow-{show_id:d}-{season:d}.html', timeout=10)
205	        soup = ParserBeautifulSoup(r.content, ['lxml', 'html.parser'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/tvsubtitles.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	        logger.info('Getting the page for episode %d', episode_ids[episode])
247	        r = self.session.get(self.server_url + '/episode-%d.html' % episode_ids[episode], timeout=10)
248	        soup = ParserBeautifulSoup(r.content, ['lxml', 'html.parser'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/tvsubtitles.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
307	        url = self.server_url + f'/download-{subtitle.subtitle_id}.html'
308	        r = self.session.get(url, timeout=10)
309	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/providers/tvsubtitles.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
322	            direct_url = f'{self.server_url}/{filepath}'
323	            r = self.session.get(direct_url, timeout=10)
324	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/hash.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	        for _ in range(65536 // bytesize):
43	            filebuffer = f.read(bytesize)
44	            (l_value,) = struct.unpack(b'<q', filebuffer)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/hash.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	        for _ in range(65536 // bytesize):
49	            filebuffer = f.read(bytesize)
50	            (l_value,) = struct.unpack(b'<q', filebuffer)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/hash.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	    with open(video_path, 'rb') as f:
68	        data = f.read(readsize)
69	        f.seek(-readsize, os.SEEK_END)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/hash.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
69	        f.seek(-readsize, os.SEEK_END)
70	        data += f.read(readsize)
71	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/hash.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
84	    with open(video_path, 'rb') as f:
85	        data = f.read(readsize)
86	    return hashlib.md5(data).hexdigest()  # noqa: S324

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/hash.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
105	            f.seek(offset)
106	            filehash.append(hashlib.md5(f.read(readsize)).hexdigest())  # noqa: S324
107	    return ';'.join(filehash)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/omdb.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	
37	    base_url: ClassVar[str] = 'https://www.omdbapi.com'
38	    user_agent: ClassVar[str] = f'Subliminal/{__short_version__}'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/omdb.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	        # perform the request
101	        r = self.session.get(self.base_url, params=params, timeout=self.timeout)
102	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/omdb.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
130	        # perform the request
131	        r = self.session.get(self.base_url, params=params, timeout=self.timeout)
132	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/omdb.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	        # perform the request
161	        r = self.session.get(self.base_url, params=params, timeout=self.timeout)
162	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tmdb.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
25	    except (ValueError, KeyError, AttributeError):
26	        logger.exception(f'Cannot extract year from date in {data.get(key)}')
27	    return None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tmdb.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    #: Base URL of the API
45	    base_url: ClassVar[str] = f'https://api.themoviedb.org/{api_version}'
46	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tmdb.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	            params['year'] = year
96	        r = self.session.get(self.base_url + f'/search/{category}', params=params)
97	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tmdb.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	        r.raise_for_status()
99	        return cast(list, r.json().get('results'))
100	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tmdb.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	            # first try 'title' in result, fallback to 'name'
123	            res_title = sanitize(result.get(title_key))
124	            # res_title = sanitize(result.get('title', result.get('name'), None))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tmdb.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	        params: dict[str, Any] = {'append_to_response': 'external_ids'}
166	        r = self.session.get(self.base_url + path, params=params)
167	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tmdb.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	    video.series_imdb_id = decorate_imdb_id(
266	        sanitize_id(result_series['external_ids'].get('imdb_id', video.series_imdb_id))
267	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tmdb.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
267	    )
268	    video.series_tvdb_id = sanitize_id(result_series['external_ids'].get('tvdb_id', video.series_tvdb_id))
269	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tmdb.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
271	    video.tmdb_id = sanitize_id(result_episode['id'])
272	    video.imdb_id = decorate_imdb_id(sanitize_id(result_episode['external_ids'].get('imdb_id', video.imdb_id)))
273	    video.tvdb_id = sanitize_id(result_episode['external_ids'].get('tvdb_id', video.tvdb_id))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tmdb.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
272	    video.imdb_id = decorate_imdb_id(sanitize_id(result_episode['external_ids'].get('imdb_id', video.imdb_id)))
273	    video.tvdb_id = sanitize_id(result_episode['external_ids'].get('tvdb_id', video.tvdb_id))
274	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    #: Base URL of the API
60	    base_url: ClassVar[str] = 'https://api.thetvdb.com'
61	
62	    #: User agent
63	    user_agent: ClassVar[str] = f'Subliminal/{__short_version__}'

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
145	        data = {'apikey': self.apikey, 'username': self.username, 'password': self.password}
146	        r = self.session.post(self.base_url + '/login', json=data, timeout=self.timeout)
147	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	        # perform the request
158	        r = self.session.get(self.base_url + '/refresh_token', timeout=self.timeout)
159	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	            params['zap2itId'] = zap2it_id
185	        r = self.session.get(self.base_url + '/search/series', params=params, timeout=self.timeout)
186	        if r.status_code == 404:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	        }
215	        r = self.session.get(
216	            self.base_url + f'/series/{series_id:d}/episodes/query',
217	            params=params,
218	            timeout=self.timeout,
219	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	        # perform the request
237	        r = self.session.get(self.base_url + f'/series/{series_id:d}', timeout=self.timeout)
238	        if r.status_code == 404:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	        # perform the request
254	        r = self.session.get(self.base_url + f'/episodes/{episode_id:d}', timeout=self.timeout)
255	        if r.status_code == 404:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
273	        params = {'page': page}
274	        r = self.session.get(self.base_url + f'/series/{series_id:d}/episodes', params=params, timeout=self.timeout)
275	        if r.status_code == 404:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
308	        # perform the request
309	        r = self.session.get(self.base_url + f'/series/{series_id:d}/actors', timeout=self.timeout)
310	        if r.status_code == 404:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
434	                matching_result['match'] = {
435	                    'series': original_match.get('series', series),
436	                    'year': series_year or year,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/subliminal/refiners/tvdb.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
437	                    'country': country,
438	                    'original_series': original_match.get('year') is None and country is None,
439	                }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/conftest.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
443	    if not os.path.exists(data_path) or len(os.listdir(data_path)) != 8:
444	        r = requests.get('http://downloads.sourceforge.net/project/matroska/test_files/matroska_test_w1_1.zip')
445	        with ZipFile(BytesIO(r.content), 'r') as f:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/conftest.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
443	    if not os.path.exists(data_path) or len(os.listdir(data_path)) != 8:
444	        r = requests.get('http://downloads.sourceforge.net/project/matroska/test_files/matroska_test_w1_1.zip')
445	        with ZipFile(BytesIO(r.content), 'r') as f:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/conftest.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
463	    downloaded_files = {
464	        'pwd-protected': 'https://github.com/markokr/rarfile/blob/master/test/files/rar5-psw.rar?raw=true',
465	        'simple': 'https://github.com/markokr/rarfile/blob/master/test/files/rar5-quick-open.rar?raw=true',
466	    }
467	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/conftest.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
464	        'pwd-protected': 'https://github.com/markokr/rarfile/blob/master/test/files/rar5-psw.rar?raw=true',
465	        'simple': 'https://github.com/markokr/rarfile/blob/master/test/files/rar5-quick-open.rar?raw=true',
466	    }
467	
468	    generated_files = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/conftest.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
468	    generated_files = {
469	        'video': [mkv.get('test1')],
470	        'videos': [mkv.get('test3'), mkv.get('test4'), mkv.get('test5')],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/conftest.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
469	        'video': [mkv.get('test1')],
470	        'videos': [mkv.get('test3'), mkv.get('test4'), mkv.get('test5')],
471	    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/conftest.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
469	        'video': [mkv.get('test1')],
470	        'videos': [mkv.get('test3'), mkv.get('test4'), mkv.get('test5')],
471	    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/conftest.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
469	        'video': [mkv.get('test1')],
470	        'videos': [mkv.get('test3'), mkv.get('test4'), mkv.get('test5')],
471	    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/conftest.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
477	        if not os.path.exists(filename):
478	            r = requests.get(download_url)
479	            with open(filename, 'wb') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/conftest.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
479	            with open(filename, 'wb') as f:
480	                f.write(r.content)
481	        files[name] = filename

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/providers/test_addic7ed.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
471	    assert subtitle.hearing_impaired is True
472	    assert subtitle.page_link == 'https://www.addic7ed.com/serie/Game_of_Thrones/3/10/Mhysa'
473	    assert subtitle.series == video.series

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/providers/test_addic7ed.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
496	    assert (
497	        subtitle.page_link == 'https://www.addic7ed.com/serie/Marvel%27s_Agents_of_S.H.I.E.L.D./2/6/A_Fractured_House'
498	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/providers/test_addic7ed.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
520	    assert subtitle.hearing_impaired is False
521	    assert subtitle.page_link == 'https://www.addic7ed.com/serie/CSI%3A_Cyber/2/3/Brown_Eyes%2C_Blue_Eyes'
522	    assert subtitle.series == video.series

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/providers/test_addic7ed.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
542	    assert subtitle.hearing_impaired is False
543	    assert subtitle.page_link == 'https://www.addic7ed.com/serie/The_X-Files/10/2/Founder%27s_Mutation'
544	    assert subtitle.series == video.series

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/refiners/test_omdb.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
10	    path_transformer=lambda path: path + '.yaml',
11	    record_mode=os.environ.get('VCR_RECORD_MODE', 'once'),
12	    decode_compressed_response=True,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/refiners/test_tmdb.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
10	    path_transformer=lambda path: path + '.yaml',
11	    record_mode=os.environ.get('VCR_RECORD_MODE', 'once'),
12	    decode_compressed_response=True,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/refiners/test_tvdb.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
12	    path_transformer=lambda path: path + '.yaml',
13	    record_mode=os.environ.get('VCR_RECORD_MODE', 'once'),
14	    decode_compressed_response=True,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/test_core.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
294	    with open(mkv['test1'], 'rb') as original, tmpdir.join(broken_path).open('wb') as broken:
295	        broken.write(original.read(512))
296	    monkeypatch.chdir(str(tmpdir))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/test_core.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
294	    with open(mkv['test1'], 'rb') as original, tmpdir.join(broken_path).open('wb') as broken:
295	        broken.write(original.read(512))
296	    monkeypatch.chdir(str(tmpdir))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/test_core.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
627	    assert os.path.exists(path)
628	    assert open(path, 'rb').read() == b'Some content'
629	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/test_core.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
632	    assert os.path.exists(path)
633	    assert open(path, 'rb').read() == b'Some brazilian content'
634	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/subliminal-2.2.1/subliminal-2.2.1/tests/test_core.py:648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
647	    assert os.path.exists(path)
648	    assert open(path, encoding='utf-8').read() == ''
649	

--------------------------------------------------

Code scanned:
	Total lines of code: 11067
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 106.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 132.0
		High: 2.0
Files skipped (0):
