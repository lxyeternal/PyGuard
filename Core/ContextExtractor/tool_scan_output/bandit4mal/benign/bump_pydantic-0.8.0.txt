Run started:2025-04-12 17:10:43.679365

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/codemods/add_default_none.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	            )
139	            f.write(content)
140	        module = str(Path(module_path).relative_to(tmpdir))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/codemods/add_default_none.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
138	            )
139	            f.write(content)
140	        module = str(Path(module_path).relative_to(tmpdir))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/codemods/class_def_visitor.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
137	            )
138	            f.write(content)
139	        module = str(Path(module_path).relative_to(tmpdir))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/codemods/class_def_visitor.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
137	            )
138	            f.write(content)
139	        module = str(Path(module_path).relative_to(tmpdir))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/codemods/custom_types.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	COMMENT_BY_FUNC_NAME = {"__get_validators__": GET_VALIDATORS_COMMENT, "__modify_schema__": MODIFY_SCHEMA_COMMENT}
11	CHECK_LINK_COMMENT = "# Check https://docs.pydantic.dev/latest/migration/#defining-custom-types for more information."
12	
13	GET_VALIDATORS_FUNCTION = m.FunctionDef(name=m.Name("__get_validators__"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/codemods/replace_config.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	INHERIT_CONFIG_COMMENT = f"{PREFIX_COMMENT}The `Config` class inherits from another class, please create the `model_config` manually."  # noqa: E501
13	CHECK_LINK_COMMENT = "# Check https://docs.pydantic.dev/dev-v2/migration/#changes-to-config for more information."
14	
15	REMOVED_KEYS = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/codemods/validator.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	ROOT_VALIDATOR_COMMENT = REFACTOR_COMMENT.format(old_name="root_validator", new_name="model_validator")
13	CHECK_LINK_COMMENT = "# Check https://docs.pydantic.dev/dev-v2/migration/#changes-to-validators for more information."
14	
15	IMPORT_VALIDATOR = m.Module(

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/main.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
128	        difflines: List[List[str]] = []
129	        with multiprocessing.Pool() as pool:
130	            for error, _difflines in pool.imap_unordered(partial_run_codemods, files):

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/main.py:129
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
128	        difflines: List[List[str]] = []
129	        with multiprocessing.Pool() as pool:
130	            for error, _difflines in pool.imap_unordered(partial_run_codemods, files):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/main.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
179	        with file_path.open("r+", encoding="utf-8") as fp:
180	            code = fp.read()
181	            fp.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/main.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
200	                else:
201	                    fp.write(output_code)
202	                    fp.truncate()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/bump_pydantic/main.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
205	        return (
206	            f"A syntax error happened on {filename}. This file cannot be formatted.\n"
207	            "Check https://github.com/pydantic/bump-pydantic/issues/124 for more information.\n"
208	            f"{exc}"
209	        ), None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/integration/cases/config_to_model.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	config_to_model_after = """\
25	from pydantic import ConfigDict, BaseModel

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/integration/cases/custom_types.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	                "    # TODO[pydantic]: We couldn't refactor `__get_validators__`, please create the `__get_pydantic_core_schema__` manually.",  # noqa: E501
23	                "    # Check https://docs.pydantic.dev/latest/migration/#defining-custom-types for more information.",
24	                "    def __get_validators__(cls):",
25	                "        yield from []",
26	                "        return",
27	            ],
28	        ),
29	    ),
30	    Case(
31	        name="Mark __modify_schema__",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/integration/cases/custom_types.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	                "    # TODO[pydantic]: We couldn't refactor `__modify_schema__`, please create the `__get_pydantic_json_schema__` manually.",  # noqa: E501
50	                "    # Check https://docs.pydantic.dev/latest/migration/#defining-custom-types for more information.",
51	                "    def __modify_schema__(",
52	                "        cls, field_schema: Dict[str, Any], field: Optional[ModelField]",
53	                "    ):",
54	                "        if field:",
55	                "            field_schema['example'] = \"Weird example\"",
56	            ],
57	        ),
58	    ),
59	]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_custom_types.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	        """
19	        after = """
20	        class SomeThing:
21	            @classmethod
22	            # TODO[pydantic]: We couldn't refactor `__get_validators__`, please create the `__get_pydantic_core_schema__` manually.
23	            # Check https://docs.pydantic.dev/latest/migration/#defining-custom-types for more information.
24	            def __get_validators__(cls):
25	                yield from []
26	                return
27	        """  # noqa: E501
28	        self.assertCodemod(before, after)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_custom_types.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	        """
40	        after = """
41	        class SomeThing:
42	            @classmethod
43	            # TODO[pydantic]: We couldn't refactor `__modify_schema__`, please create the `__get_pydantic_json_schema__` manually.
44	            # Check https://docs.pydantic.dev/latest/migration/#defining-custom-types for more information.
45	            def __modify_schema__(
46	                cls, field_schema: Dict[str, Any], field: Optional[ModelField]
47	            ):
48	                if field:
49	                    field_schema['example'] = "Weird example"
50	        """  # noqa: E501
51	        self.assertCodemod(before, after)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_custom_types.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	    def test_already_commented(self) -> None:
54	        before = """
55	        class SomeThing:
56	            @classmethod
57	            # TODO[pydantic]: We couldn't refactor `__modify_schema__`, please create the `__get_pydantic_json_schema__` manually.
58	            # Check https://docs.pydantic.dev/latest/migration/#defining-custom-types for more information.
59	            def __modify_schema__(
60	                cls, field_schema: Dict[str, Any], field: Optional[ModelField]
61	            ):
62	                if field:
63	                    field_schema['example'] = "Weird example"
64	        """  # noqa: E501
65	        after = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_custom_types.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	        """  # noqa: E501
65	        after = """
66	        class SomeThing:
67	            @classmethod
68	            # TODO[pydantic]: We couldn't refactor `__modify_schema__`, please create the `__get_pydantic_json_schema__` manually.
69	            # Check https://docs.pydantic.dev/latest/migration/#defining-custom-types for more information.
70	            def __modify_schema__(
71	                cls, field_schema: Dict[str, Any], field: Optional[ModelField]
72	            ):
73	                if field:
74	                    field_schema['example'] = "Weird example"
75	        """  # noqa: E501
76	        self.assertCodemod(before, after)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_replace_config.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	        """
96	        after = """
97	        from pydantic import BaseModel
98	
99	        class Potato(BaseModel):
100	            # TODO[pydantic]: We couldn't refactor this class, please create the `model_config` manually.
101	            # Check https://docs.pydantic.dev/dev-v2/migration/#changes-to-config for more information.
102	            class Config:
103	                allow_arbitrary_types = True
104	
105	                def __init__(self):
106	                    self.allow_mutation = True
107	        """
108	        self.assertCodemod(before, after)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_replace_config.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	        """
120	        after = """
121	        from pydantic import BaseModel
122	
123	        from potato import SuperConfig
124	
125	        class Potato(BaseModel):
126	            # TODO[pydantic]: The `Config` class inherits from another class, please create the `model_config` manually.
127	            # Check https://docs.pydantic.dev/dev-v2/migration/#changes-to-config for more information.
128	            class Config(SuperConfig):
129	                allow_arbitrary_types = True
130	        """
131	        self.assertCodemod(before, after)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_replace_config.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	    def test_already_commented(self) -> None:
155	        before = """
156	        from pydantic import BaseModel
157	
158	        from potato import SuperConfig
159	
160	        class Potato(BaseModel):
161	            # TODO[pydantic]: The `Config` class inherits from another class, please create the `model_config` manually.
162	            # Check https://docs.pydantic.dev/dev-v2/migration/#changes-to-config for more information.
163	            class Config(SuperConfig):
164	                allow_arbitrary_types = True
165	        """
166	        after = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_replace_config.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	        """
166	        after = """
167	        from pydantic import BaseModel
168	
169	        from potato import SuperConfig
170	
171	        class Potato(BaseModel):
172	            # TODO[pydantic]: The `Config` class inherits from another class, please create the `model_config` manually.
173	            # Check https://docs.pydantic.dev/dev-v2/migration/#changes-to-config for more information.
174	            class Config(SuperConfig):
175	                allow_arbitrary_types = True
176	        """
177	        self.assertCodemod(before, after)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_replace_config.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
202	        """
203	        after = """
204	        from pydantic import ConfigDict, BaseModel
205	
206	        class Potato(BaseModel):
207	            # TODO[pydantic]: The following keys were removed: `allow_mutation`.
208	            # Check https://docs.pydantic.dev/dev-v2/migration/#changes-to-config for more information.
209	            model_config = ConfigDict(allow_mutation=True)
210	        """
211	        self.assertCodemod(before, after)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_replace_config.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
221	        """
222	        after = """
223	        from pydantic import ConfigDict, BaseModel
224	
225	        class Potato(BaseModel):
226	            # TODO[pydantic]: The following keys were removed: `allow_mutation`, `smart_union`.
227	            # Check https://docs.pydantic.dev/dev-v2/migration/#changes-to-config for more information.
228	            model_config = ConfigDict(allow_mutation=True, smart_union=True)
229	        """
230	        self.assertCodemod(before, after)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_validator.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
132	        """
133	        after = """
134	        import typing as t
135	
136	        from pydantic import BaseModel, validator
137	
138	
139	        class Potato(BaseModel):
140	            name: str
141	            dialect: str
142	
143	            # TODO[pydantic]: We couldn't refactor the `validator`, please replace it by `field_validator` manually.
144	            # Check https://docs.pydantic.dev/dev-v2/migration/#changes-to-validators for more information.
145	            @validator("name", "dialect")
146	            def _string_validator(cls, v: t.Any, values: t.Dict[str, t.Any], **kwargs) -> t.Optional[str]:
147	                if isinstance(v, exp.Expression):
148	                    return v.name.lower()
149	                return str(v).lower() if v is not None else None
150	        """
151	
152	        self.assertCodemod(before, after)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bump_pydantic-0.8.0/bump_pydantic-0.8.0/tests/unit/test_validator.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
354	    def test_noop_comment(self) -> None:
355	        code = """
356	        import typing as t
357	
358	        from pydantic import BaseModel, validator
359	
360	
361	        class Potato(BaseModel):
362	            name: str
363	            dialect: str
364	
365	            # TODO[pydantic]: We couldn't refactor the `validator`, please replace it by `field_validator` manually.
366	            # Check https://docs.pydantic.dev/dev-v2/migration/#changes-to-validators for more information.
367	            @validator("name", "dialect")
368	            def _string_validator(cls, v: t.Any, values: t.Dict[str, t.Any], **kwargs) -> t.Optional[str]:
369	                if isinstance(v, exp.Expression):
370	                    return v.name.lower()
371	                return str(v).lower() if v is not None else None
372	        """
373	        self.assertCodemod(code, code)

--------------------------------------------------

Code scanned:
	Total lines of code: 3311
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 7.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 1.0
Files skipped (0):
