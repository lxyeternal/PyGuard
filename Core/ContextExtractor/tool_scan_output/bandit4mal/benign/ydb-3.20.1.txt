Run started:2025-04-12 10:53:46.963744

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    author_email="ydb@yandex-team.ru",
20	    url="http://github.com/ydb-platform/ydb-python-sdk",
21	    license="Apache 2.0",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/aio/test_credentials.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
52	
53	    serve_thread = threading.Thread(target=serve, args=(server,))
54	    serve_thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/aio/test_credentials.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
75	
76	    serve_thread = threading.Thread(target=serve, args=(server,))
77	    serve_thread.start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/aio/test_credentials.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	    try:
99	        temp_cfg_file.write(json.dumps(cfg, indent=4).encode("utf-8"))
100	        temp_cfg_file.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/aio/test_credentials.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
98	    try:
99	        temp_cfg_file.write(json.dumps(cfg, indent=4).encode("utf-8"))
100	        temp_cfg_file.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/auth/test_credentials.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	        decoded = jwt.decode(
33	            request.jwt, key=PUBLIC_KEY, algorithms=["PS256"], audience="https://iam.api.cloud.yandex.net/iam/v1/tokens"
34	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/auth/test_credentials.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	        assert decoded["iss"] == SERVICE_ACCOUNT_ID
36	        assert decoded["aud"] == "https://iam.api.cloud.yandex.net/iam/v1/tokens"
37	        assert abs(decoded["iat"] - time.time()) <= 60

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/auth/test_credentials.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
46	    def __init__(self):
47	        self.server = grpc.server(concurrent.futures.ThreadPoolExecutor(max_workers=2))
48	        iam_token_service_pb2_grpc.add_IamTokenServiceServicer_to_server(IamTokenServiceForTest(), self.server)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
236	        content_length = int(self.headers["Content-Length"])
237	        post_data = self.rfile.read(content_length).decode("utf8")
238	        print("OauthExchangeServiceHandler.POST data: {}".format(post_data))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
247	            self.end_headers()
248	            self.wfile.write(json.dumps(response).encode("utf8"))
249	        except Exception as ex:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
247	            self.end_headers()
248	            self.wfile.write(json.dumps(response).encode("utf8"))
249	        except Exception as ex:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
252	            self.end_headers()
253	            self.wfile.write("Exception during text check: {}".format(ex).encode("utf8"))
254	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
252	            self.end_headers()
253	            self.wfile.write("Exception during text check: {}".format(ex).encode("utf8"))
254	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
271	    def endpoint(self):
272	        return "http://localhost:{}/token/exchange".format(self.port)
273	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
335	            # one request per test
336	            s.handle_request()
337	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
337	
338	    serve_thread = threading.Thread(target=serve, args=(server,))
339	    serve_thread.start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
403	            cfg_file = temp_cfg_file.name
404	            temp_cfg_file.write(self.get_cfg().encode("utf-8"))
405	            temp_cfg_file.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
403	            cfg_file = temp_cfg_file.name
404	            temp_cfg_file.write(self.get_cfg().encode("utf-8"))
405	            temp_cfg_file.close()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
424	            assert not self.get_token_error_text_part, "Exception is expected. Test:\n{}".format(self.get_cfg())
425	            if self.expect_http_request() and server.checker is not None:
426	                assert server.checker.check_successful

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
608	                    alg="HS512",
609	                    public_key=base64.b64decode(TEST_HMAC_SECRET_KEY_BASE64_CONTENT),
610	                ),

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:609
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
608	                    alg="HS512",
609	                    public_key=base64.b64decode(TEST_HMAC_SECRET_KEY_BASE64_CONTENT),
610	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
781	            # one request per test
782	            if t.expect_http_request():
783	                s.handle_request()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
782	            if t.expect_http_request():
783	                s.handle_request()
784	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/tests/oauth2_token_exchange/test_token_exchange.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
784	
785	    serve_thread = threading.Thread(target=serve, args=(server,))
786	    serve_thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_grpc/grpcwrapper/common_utils.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
125	        try:
126	            res = await to_thread(self._sync_iterator.__next__, executor=self._executor)
127	            return res

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_grpc/grpcwrapper/common_utils.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
196	        requests_iterator = AsyncQueueToSyncIteratorAsyncIO(self.from_client_grpc)
197	        self._wait_executor = concurrent.futures.ThreadPoolExecutor(max_workers=1)
198	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_grpc/grpcwrapper/common_utils.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
198	
199	        stream_call = await to_thread(driver, requests_iterator, stub, method, executor=self._wait_executor)
200	        self._stream_call = stream_call

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_sp_impl.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
30	        self._req_settings = settings.BaseRequestSettings().with_timeout(3)
31	        self._tp = futures.ThreadPoolExecutor(workers_threads_count)
32	        self._initializer = initializer

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_topic_common/common_test.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
38	
39	    t = threading.Thread(target=run_loop, name="test separate loop")
40	    t.start()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_topic_reader/topic_reader_asyncio_test.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
49	def default_executor():
50	    executor = concurrent.futures.ThreadPoolExecutor(max_workers=2, thread_name_prefix="decoder_executor")
51	    yield executor

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_topic_reader/topic_reader_asyncio_test.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
102	    def write(self, message: StreamReadMessage.FromClient):
103	        return super().write(message)
104	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_topic_writer/topic_writer_asyncio.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
265	        self._credentials = driver._credentials
266	        self._init_message = settings.create_init_request()
267	        self._new_messages = asyncio.Queue()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_topic_writer/topic_writer_asyncio.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
475	            while True:
476	                messages = await self._messages_for_encode.get()
477	                while not self._messages_for_encode.empty():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_topic_writer/topic_writer_asyncio.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
617	            while True:
618	                m = await self._new_messages.get()  # type: InternalMessage
619	                if m.seq_no > last_seq_no:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/_topic_writer/topic_writer_sync.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
122	
123	        self._caller.safe_call_with_result(self._async_writer.write(messages), timeout)
124	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/aio/iam.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
49	            stub = iam_token_service_pb2_grpc.IamTokenServiceStub(channel)
50	            response = await stub.Create(self._get_token_request(), timeout=self._get_token_request_timeout)
51	            self.logger.debug(str(response))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/auth_helpers.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	    with open(f, "rb") as fr:
8	        return fr.read()
9	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/credentials.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
74	        self._lock = threading.Lock()
75	        self._tp = futures.ThreadPoolExecutor(1)
76	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/iam/auth.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	
38	DEFAULT_METADATA_URL = "http://169.254.169.254/computeMetadata/v1/instance/service-accounts/default/token"
39	YANDEX_CLOUD_IAM_TOKEN_SERVICE_URL = "https://iam.api.cloud.yandex.net/iam/v1/tokens"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/iam/auth.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	DEFAULT_METADATA_URL = "http://169.254.169.254/computeMetadata/v1/instance/service-accounts/default/token"
39	YANDEX_CLOUD_IAM_TOKEN_SERVICE_URL = "https://iam.api.cloud.yandex.net/iam/v1/tokens"
40	YANDEX_CLOUD_JWT_ALGORITHM = "PS256"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/iam/auth.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
88	            stub = self._iam_token_service_pb2_grpc.IamTokenServiceStub(channel)
89	            response = stub.Create(self._get_token_request(), timeout=self._get_token_request_timeout)
90	            expires_in = max(0, response.expires_at.seconds - int(time.time()))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/iam/auth.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
111	        with open(os.path.expanduser(key_file), "r") as r:
112	            key = r.read()
113	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/iam/auth.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	        key_json = json.loads(key)
119	        account_id = key_json.get("service_account_id", None)
120	        if account_id is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/iam/auth.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	        if account_id is None:
121	            account_id = key_json.get("user_account_id", None)
122	        return cls(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/iam/auth.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	    def _make_token_request(self):
192	        response = requests.get(self._metadata_url, headers={"Metadata-Flavor": "Google"}, timeout=3)
193	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        token_type = response_json["token_type"]
72	        scope = response_json.get("scope")
73	        if token_type.lower() != "bearer":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	        signing_method = cls._required_string_from_config(cfg_json, "alg")
119	        is_hmac = _supported_uppercase_jwt_algs.get(signing_method.upper(), None)
120	        if is_hmac is not None:  # we know this method => do uppercase

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
123	        if is_hmac:  # decode from base64
124	            private_key = base64.b64decode(private_key + "===")  # to allow unpadded strings
125	        return JwtTokenSource(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:124
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
123	        if is_hmac:  # decode from base64
124	            private_key = base64.b64decode(private_key + "===")  # to allow unpadded strings
125	        return JwtTokenSource(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
144	    def _token_source_from_config(cls, cfg_json, key_name):
145	        value = cfg_json.get(key_name, None)
146	        if value is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	    def _list_of_strings_or_single_from_config(cls, cfg_json, key_name):
160	        value = cfg_json.get(key_name, None)
161	        if value is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	    def _required_string_from_config(cls, cfg_json, key_name):
177	        value = cfg_json.get(key_name, None)
178	        if value is None or not isinstance(value, str) or not value:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
183	    def _string_with_default_from_config(cls, cfg_json, key_name, default_value):
184	        value = cfg_json.get(key_name, None)
185	        if value is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
192	    def _duration_seconds_from_config(cls, cfg_json, key_name, default_value):
193	        value = cfg_json.get(key_name, None)
194	        if value is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
263	        with open(os.path.expanduser(cfg_file), "r") as r:
264	            cfg = r.read()
265	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
277	        else:
278	            token_endpoint = cfg_json.get("token-endpoint", "")
279	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_exchange.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
337	        headers = {"Content-Type": "application/x-www-form-urlencoded"}
338	        response = requests.post(self._token_endpoint, data=params, headers=headers)
339	        self._process_response_status_code(response.content, response.status_code)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/oauth2_token_exchange/token_source.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	            with open(private_key_file, "r") as key_file:
61	                self._private_key = key_file.read()
62	        self._issuer = issuer

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/topic.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
111	        self._settings = settings
112	        self._executor = concurrent.futures.ThreadPoolExecutor(
113	            max_workers=settings.encode_decode_threads_count,
114	            thread_name_prefix="topic_asyncio_executor",
115	        )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ydb-3.20.1/ydb-3.20.1/ydb/topic.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
347	        self._settings = settings
348	        self._executor = concurrent.futures.ThreadPoolExecutor(
349	            max_workers=settings.encode_decode_threads_count,
350	            thread_name_prefix="topic_asyncio_executor",
351	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 88828
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 52.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 58.0
		High: 2.0
Files skipped (0):
