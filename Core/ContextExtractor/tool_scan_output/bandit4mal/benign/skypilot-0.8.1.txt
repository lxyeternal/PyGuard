Run started:2025-04-12 16:46:08.958104

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
44	
45	system = platform.system()
46	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
44	
45	system = platform.system()
46	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
44	
45	system = platform.system()
46	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
53	        version_match = re.search(r'^__version__ = [\'"]([^\'"]*)[\'"]',
54	                                  fp.read(), re.M)
55	        if version_match:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	        commit_match = re.search(r'^_SKYPILOT_COMMIT_SHA = [\'"]([^\'"]*)[\'"]',
63	                                 fp.read(), re.M)
64	        if commit_match:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
97	        with open(INIT_FILE_PATH, 'r', encoding='utf-8') as fp:
98	            content = fp.read()
99	            global original_init_content

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
105	        with open(INIT_FILE_PATH, 'w', encoding='utf-8') as fp:
106	            fp.write(content)
107	    except Exception as e:  # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
118	            with open(INIT_FILE_PATH, 'w', encoding='utf-8') as fp:
119	                fp.write(original_init_content)
120	    except Exception as e:  # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	if os.path.exists(readme_filepath):
147	    long_description = io.open(readme_filepath, 'r', encoding='utf-8').read()
148	    long_description = parse_readme(long_description)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
185	    project_urls={
186	        'Homepage': 'https://github.com/skypilot-org/skypilot',
187	        'Issues': 'https://github.com/skypilot-org/skypilot/issues',
188	        'Discussion': 'https://github.com/skypilot-org/skypilot/discussions',
189	        'Documentation': 'https://docs.skypilot.co/',
190	    },
191	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	        'Homepage': 'https://github.com/skypilot-org/skypilot',
187	        'Issues': 'https://github.com/skypilot-org/skypilot/issues',
188	        'Discussion': 'https://github.com/skypilot-org/skypilot/discussions',
189	        'Documentation': 'https://docs.skypilot.co/',
190	    },
191	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
187	        'Issues': 'https://github.com/skypilot-org/skypilot/issues',
188	        'Discussion': 'https://github.com/skypilot-org/skypilot/discussions',
189	        'Documentation': 'https://docs.skypilot.co/',
190	    },
191	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/setup.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	        'Discussion': 'https://github.com/skypilot-org/skypilot/discussions',
189	        'Documentation': 'https://docs.skypilot.co/',
190	    },
191	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/adaptors/azure.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
360	        user = await graph_client.users.with_url(
361	            'https://graph.microsoft.com/v1.0/me').get()
362	        httpx_logger.setLevel(original_level)
363	        object_id = str(user.additional_data['id'])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/adaptors/cloudflare.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
179	        hints += f'\n{_INDENT_PREFIX}For more info: '
180	        hints += 'https://docs.skypilot.co/en/latest/getting-started/installation.html#cloudflare-r2'  # pylint: disable=line-too-long
181	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/adaptors/ibm.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
59	    # pylint: disable=line-too-long
60	    res = requests.post(
61	        'https://iam.cloud.ibm.com/identity/token',
62	        headers={'Content-Type': 'application/x-www-form-urlencoded'},
63	        data=
64	        f'grant_type=urn:ibm:params:oauth:grant-type:apikey&apikey={get_api_key()}'
65	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/adaptors/ibm.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	    res = requests.post(
61	        'https://iam.cloud.ibm.com/identity/token',
62	        headers={'Content-Type': 'application/x-www-form-urlencoded'},
63	        data=
64	        f'grant_type=urn:ibm:params:oauth:grant-type:apikey&apikey={get_api_key()}'
65	    )
66	    return json.loads(res.text)['access_token']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/adaptors/ibm.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	                                   authenticator=_get_authenticator())
85	        if kwargs.get('region'):
86	            vpc_client.set_service_url(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/adaptors/ibm.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	            endpoint_url=
124	            f'https://s3.{region}.cloud-object-storage.appdomain.cloud')
125	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/adaptors/ibm.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	            endpoint_url=
145	            f'https://s3.{region}.cloud-object-storage.appdomain.cloud')
146	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/authentication.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	    ) as f:
98	        f.write(private_key)
99	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/authentication.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
103	              opener=functools.partial(os.open, mode=0o644)) as f:
104	        f.write(public_key)
105	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/authentication.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
131	    with open(public_key_path, 'r', encoding='utf-8') as f:
132	        public_key = f.read().strip()
133	    config_str = common_utils.dump_yaml_str(config)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/authentication.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	        if ' API has not been used in project' in e.reason:
171	            match = re.fullmatch(r'(.+)(https://.*project=\d+) (.+)', e.reason)
172	            if match is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/authentication.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
280	    with open(public_key_path, 'r', encoding='utf-8') as f:
281	        public_key = f.read().strip()
282	    prefix = f'sky-key-{common_utils.get_user_hash()}'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/authentication.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
318	              encoding='utf-8') as file:
319	        ssh_key_data = file.read().strip()
320	    # pylint: disable=E1136

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/authentication.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
393	    with open(public_key_path, 'r', encoding='utf-8') as f:
394	        public_key = f.read()
395	        if not public_key.endswith('\n'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/authentication.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
482	    with open(public_key_path, 'r', encoding='UTF-8') as pub_key_file:
483	        public_key = pub_key_file.read().strip()
484	        runpod.runpod.cli.groups.ssh.functions.add_ssh_key(public_key)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/authentication.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
495	    with open(public_key_path, 'r', encoding='UTF-8') as pub_key_file:
496	        public_key = pub_key_file.read().strip()
497	        current_key_list = vast.vast().show_ssh_keys()  # pylint: disable=assignment-from-no-return

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/authentication.py:514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
513	    with open(public_key_path, 'r', encoding='utf-8') as f:
514	        public_key = f.read()
515	    client.get_or_add_ssh_key(public_key)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	# Refer to: https://stackoverflow.com/questions/3764291/how-can-i-see-if-theres-an-available-and-active-network-connection-in-python # pylint: disable=line-too-long
94	_TEST_IP_LIST = ['https://1.1.1.1', 'https://8.8.8.8']
95	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	# Refer to: https://stackoverflow.com/questions/3764291/how-can-i-see-if-theres-an-available-and-active-network-connection-in-python # pylint: disable=line-too-long
94	_TEST_IP_LIST = ['https://1.1.1.1', 'https://8.8.8.8']
95	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	
213	    file_mounts = yaml_config.get('file_mounts', {})
214	    # Remove the file mounts added by the newline.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
271	
272	    setup_commands = yaml_config.get('setup_commands', [])
273	    if setup_commands:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
546	                )
547	                f.write(''.join(config).strip())
548	                f.write('\n' * 2)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
546	                )
547	                f.write(''.join(config).strip())
548	                f.write('\n' * 2)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
547	                f.write(''.join(config).strip())
548	                f.write('\n' * 2)
549	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
547	                f.write(''.join(config).strip())
548	                f.write('\n' * 2)
549	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
549	
550	        proxy_command = auth_config.get('ssh_proxy_command', None)
551	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
580	                  opener=functools.partial(os.open, mode=0o644)) as f:
581	            f.write(codegen)
582	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
580	                  opener=functools.partial(os.open, mode=0o644)) as f:
581	            f.write(codegen)
582	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
813	    auth_config = {'ssh_private_key': auth.PRIVATE_SSH_KEY_PATH}
814	    region_name = resources_vars.get('region')
815	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
881	                'user': common_utils.get_cleaned_username(
882	                    os.environ.get(constants.USER_ENV_VAR, '')),
883	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
982	        with open(yaml_path, 'r', encoding='utf-8') as f:
983	            old_yaml_content = f.read()
984	        with open(tmp_yaml_path, 'r', encoding='utf-8') as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:985
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
984	        with open(tmp_yaml_path, 'r', encoding='utf-8') as f:
985	            new_yaml_content = f.read()
986	        restored_yaml_content = _replace_yaml_dicts(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
990	        with open(tmp_yaml_path, 'w', encoding='utf-8') as f:
991	            f.write(restored_yaml_content)
992	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
990	        with open(tmp_yaml_path, 'w', encoding='utf-8') as f:
991	            f.write(restored_yaml_content)
992	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:1184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1183	
1184	    file_mounts = yaml_config.get('file_mounts', {})
1185	    # Remove the file mounts added by the newline.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:1388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1387	        ssh_user = auth_section['ssh_user'].strip()
1388	    ssh_private_key = auth_section.get('ssh_private_key')
1389	    ssh_control_name = config.get('cluster_name', '__default__')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:1389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1388	    ssh_private_key = auth_section.get('ssh_private_key')
1389	    ssh_control_name = config.get('cluster_name', '__default__')
1390	    ssh_proxy_command = auth_section.get('ssh_proxy_command')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:1390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1389	    ssh_control_name = config.get('cluster_name', '__default__')
1390	    ssh_proxy_command = auth_section.get('ssh_proxy_command')
1391	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:1582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1581	            metadata = provision_lib.get_cluster_info(
1582	                provider_name, ray_config['provider'].get('region'),
1583	                ray_config['cluster_name'], ray_config['provider'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:1685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1684	    """
1685	    if env_options.Options.SKIP_CLOUD_IDENTITY_CHECK.get():
1686	        return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:1802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1801	    else:
1802	        region = provider_config.get('region') or provider_config.get(
1803	            'location')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:1802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1801	    else:
1802	        region = provider_config.get('region') or provider_config.get(
1803	            'location')
1804	        zone = ray_config['provider'].get('availability_zone')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/backend_utils.py:1804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1803	            'location')
1804	        zone = ray_config['provider'].get('availability_zone')
1805	        node_statuses = cloud.query_status(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	              encoding='utf-8') as f:
209	        ray_up_no_restart_script = f.read().format(
210	            ray_yaml_path=repr(cluster_config_path),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
215	                                     delete=False) as f:
216	        f.write(ray_up_no_restart_script)
217	        logger.debug(f'`ray up` script: {f.name}')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
215	                                     delete=False) as f:
216	        f.write(ray_up_no_restart_script)
217	        logger.debug(f'`ray up` script: {f.name}')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
268	        self._code = [
269	            textwrap.dedent(f"""\
270	            import getpass
271	            import hashlib
272	            import io
273	            import os
274	            import pathlib
275	            import selectors
276	            import shlex
277	            import subprocess
278	            import sys
279	            import tempfile
280	            import textwrap
281	            import time
282	            from typing import Dict, List, Optional, Tuple, Union
283	
284	            # Set the environment variables to avoid deduplicating logs and
285	            # scheduler events. This should be set in driver code, since we are
286	            # not using `ray job submit` anymore, and the environment variables
287	            # from the ray cluster is not inherited.
288	            os.environ['RAY_DEDUP_LOGS'] = '0'
289	            os.environ['RAY_SCHEDULER_EVENTS'] = '0'
290	
291	            import ray
292	            import ray.util as ray_util
293	
294	            from sky.skylet import autostop_lib
295	            from sky.skylet import constants
296	            from sky.skylet import job_lib
297	            from sky.utils import log_utils
298	            from sky.utils import subprocess_utils
299	
300	            SKY_REMOTE_WORKDIR = {constants.SKY_REMOTE_WORKDIR!r}
301	
302	            kwargs = dict()
303	            # Only set the `_temp_dir` to SkyPilot's ray cluster directory when
304	            # the directory exists for backward compatibility for the VM
305	            # launched before #1790.
306	            if os.path.exists({constants.SKY_REMOTE_RAY_TEMPDIR!r}):
307	                kwargs['_temp_dir'] = {constants.SKY_REMOTE_RAY_TEMPDIR!r}
308	            ray.init(
309	                address={ray_address!r},
310	                namespace='__sky__{job_id}__',
311	                log_to_driver=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:1098
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1097	                logger.info(
1098	                    'Skipping all regions due to service account not '
1099	                    'having the required permissions and the user '
1100	                    'account does not have enough permission to '
1101	                    'update it. Please contact your administrator and '
1102	                    'check out: https://docs.skypilot.co/en/latest/cloud-setup/cloud-permissions/gcp.html\n'  # pylint: disable=line-too-long
1103	                    f'Details: {message}')
1104	                _add_to_blocked_resources(

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:1361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1360	            os.makedirs(os.path.expanduser(self.log_dir), exist_ok=True)
1361	            os.system(f'touch {log_path}')
1362	        rich_utils.force_update_status(

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:1361
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1360	            os.makedirs(os.path.expanduser(self.log_dir), exist_ok=True)
1361	            os.system(f'touch {log_path}')
1362	        rich_utils.force_update_status(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:1393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1392	            raise exceptions.ResourcesUnavailableError(
1393	                f'{colorama.Fore.YELLOW}Found no quota for '
1394	                f'{to_provision.instance_type} {instance_descriptor} '
1395	                f'instances in region {to_provision.region} '
1396	                f'in {to_provision.cloud}. '
1397	                f'{colorama.Style.RESET_ALL}'
1398	                f'To request quotas, check the instruction: '

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3187	        os.makedirs(os.path.expanduser(self.log_dir), exist_ok=True)
3188	        os.system(f'touch {log_path}')
3189	        num_threads = subprocess_utils.get_parallel_threads(

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3188
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3187	        os.makedirs(os.path.expanduser(self.log_dir), exist_ok=True)
3188	        os.system(f'touch {log_path}')
3189	        num_threads = subprocess_utils.get_parallel_threads(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3237	                with tempfile.NamedTemporaryFile('w', prefix='sky_setup_') as f:
3238	                    f.write(setup_script)
3239	                    f.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3237	                with tempfile.NamedTemporaryFile('w', prefix='sky_setup_') as f:
3238	                    f.write(setup_script)
3239	                    f.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3279	                              encoding='utf-8') as f:
3280	                        if 'too long' in f.read():
3281	                            is_message_too_long = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3396	            with tempfile.NamedTemporaryFile('w', prefix='sky_app_') as fp:
3397	                fp.write(codegen)
3398	                fp.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3396	            with tempfile.NamedTemporaryFile('w', prefix='sky_app_') as fp:
3397	                fp.write(codegen)
3398	                fp.flush()

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
3508	                 job_name: Optional[str], resources_str: str) -> int:
3509	        username = getpass.getuser()
3510	        code = job_lib.JobLibCodeGen.add_job(job_name, username,

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3509
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
3508	                 job_name: Optional[str], resources_str: str) -> int:
3509	        username = getpass.getuser()
3510	        code = job_lib.JobLibCodeGen.add_job(job_name, username,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3854	        # kill the process, so we need to handle it manually here.
3855	        if threading.current_thread() is threading.main_thread():
3856	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3854	        # kill the process, so we need to handle it manually here.
3855	        if threading.current_thread() is threading.main_thread():
3856	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3855	        if threading.current_thread() is threading.main_thread():
3856	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
3857	            signal.signal(signal.SIGTSTP, backend_utils.stop_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3856
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
3855	        if threading.current_thread() is threading.main_thread():
3856	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
3857	            signal.signal(signal.SIGTSTP, backend_utils.stop_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3857
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3856	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
3857	            signal.signal(signal.SIGTSTP, backend_utils.stop_handler)
3858	        try:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3857
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
3856	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
3857	            signal.signal(signal.SIGTSTP, backend_utils.stop_handler)
3858	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3888	        # kill the process, so we need to handle it manually here.
3889	        if threading.current_thread() is threading.main_thread():
3890	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3888	        # kill the process, so we need to handle it manually here.
3889	        if threading.current_thread() is threading.main_thread():
3890	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3889	        if threading.current_thread() is threading.main_thread():
3890	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
3891	            signal.signal(signal.SIGTSTP, backend_utils.stop_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3890
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
3889	        if threading.current_thread() is threading.main_thread():
3890	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
3891	            signal.signal(signal.SIGTSTP, backend_utils.stop_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3891
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3890	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
3891	            signal.signal(signal.SIGTSTP, backend_utils.stop_handler)
3892	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:3891
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
3890	            signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
3891	            signal.signal(signal.SIGTSTP, backend_utils.stop_handler)
3892	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:4034
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4033	            # kill the process, so we need to handle it manually here.
4034	            if threading.current_thread() is threading.main_thread():
4035	                signal.signal(signal.SIGINT, backend_utils.interrupt_handler)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:4034
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4033	            # kill the process, so we need to handle it manually here.
4034	            if threading.current_thread() is threading.main_thread():
4035	                signal.signal(signal.SIGINT, backend_utils.interrupt_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:4035
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
4034	            if threading.current_thread() is threading.main_thread():
4035	                signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
4036	                signal.signal(signal.SIGTSTP, backend_utils.stop_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:4035
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
4034	            if threading.current_thread() is threading.main_thread():
4035	                signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
4036	                signal.signal(signal.SIGTSTP, backend_utils.stop_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:4036
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
4035	                signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
4036	                signal.signal(signal.SIGTSTP, backend_utils.stop_handler)
4037	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:4036
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
4035	                signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
4036	                signal.signal(signal.SIGTSTP, backend_utils.stop_handler)
4037	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:4724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
4723	        os.makedirs(os.path.expanduser(self.log_dir), exist_ok=True)
4724	        os.system(f'touch {log_path}')
4725	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/cloud_vm_ray_backend.py:4724
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
4723	        os.makedirs(os.path.expanduser(self.log_dir), exist_ok=True)
4724	        os.system(f'touch {log_path}')
4725	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/docker_utils.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	              encoding='utf-8') as f:
117	        f.write(dockerfile_contents)
118	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/docker_utils.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
116	              encoding='utf-8') as f:
117	        f.write(dockerfile_contents)
118	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/docker_utils.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
231	        with open(out_path, 'w', encoding='utf-8') as fp:
232	            fp.write(script_contents)
233	    return script_contents

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/docker_utils.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
231	        with open(out_path, 'w', encoding='utf-8') as fp:
232	            fp.write(script_contents)
233	    return script_contents

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/local_docker_backend.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
381	                multiline_cmds=task.run)
382	            temp_file.write(script_contents)
383	            temp_file.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/monkey_patches/monkey_patch_ray_up.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	                      encoding='utf-8') as key:
48	                full_auth[key_type] = key.read()
49	    hasher.update(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/wheel_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
46	            if f.is_dir() and not f.is_symlink():
47	                shutil.rmtree(f, ignore_errors=True)
48	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/backends/wheel_utils.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
126	        with open(wheel_path, 'rb') as f:
127	            contents = f.read()
128	        hash_of_latest_wheel = hashlib.md5(contents).hexdigest()

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/benchmark/benchmark_utils.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
168	    # TODO(woosuk): Ensure that the bucket name is globally unique.
169	    bucket_name = f'sky-bench-{uuid.uuid4().hex[:4]}-{getpass.getuser()}'
170	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/benchmark/benchmark_utils.py:169
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
168	    # TODO(woosuk): Ensure that the bucket name is globally unique.
169	    bucket_name = f'sky-bench-{uuid.uuid4().hex[:4]}-{getpass.getuser()}'
170	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/benchmark/benchmark_utils.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
198	                                          args: List[Any]) -> List[Any]:
199	    with pool.ThreadPool(processes=len(args)) as p:
200	        try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/check.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	            '\n' + click.style(
148	                'If any problems remain, refer to detailed docs at: '
149	                'https://docs.skypilot.co/en/latest/getting-started/installation.html',  # pylint: disable=line-too-long
150	                dim=True))
151	
152	        if disallowed_clouds_hint:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/cli.py:1654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
1653	    # object that can be used as a future.
1654	    with multiprocessing.Pool(2) as pool:
1655	        # Do not show job queue if user specifies clusters, and if user

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/cli.py:1654
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
1653	    # object that can be used as a future.
1654	    with multiprocessing.Pool(2) as pool:
1655	        # Do not show job queue if user specifies clusters, and if user

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/cli.py:3962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3961	        time.sleep(3)  # Added delay for ssh_command to initialize.
3962	        webbrowser.open(f'http://localhost:{free_port}')
3963	        click.secho(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/cli.py:3964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3963	        click.secho(
3964	            f'Dashboard is now available at: http://127.0.0.1:{free_port}',
3965	            fg='green')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/cli.py:5365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5364	        click.echo(
5365	            f'\n{colorama.Fore.GREEN}Local Kubernetes cluster created '
5366	            'successfully with '
5367	            f'{num_cpus} CPUs{gpu_message}.{style.RESET_ALL}\n`sky launch` can '
5368	            'now run tasks locally.'
5369	            '\nHint: To change the number of CPUs, change your docker '
5370	            'runtime settings. See https://kind.sigs.k8s.io/docs/user/quick-start/#settings-for-docker-desktop for more info.'  # pylint: disable=line-too-long
5371	            f'{gpu_hint}')
5372	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/cloud_stores.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	    _GET_AZCOPY = [
196	        'azcopy --version > /dev/null 2>&1 || '
197	        '(mkdir -p /usr/local/bin; '
198	        'curl -L https://aka.ms/downloadazcopy-v10-linux -o azcopy.tar.gz; '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/cloud_stores.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
420	    _GET_RCLONE = [
421	        'rclone version >/dev/null 2>&1 || '
422	        'curl https://rclone.org/install.sh | sudo bash',
423	    ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/aws.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	    _STATIC_CREDENTIAL_HELP_STR = (
148	        'Run the following commands:'
149	        f'\n{_INDENT_PREFIX}  $ aws configure'
150	        f'\n{_INDENT_PREFIX}  $ aws configure list  # Ensure that this shows identity is set.'
151	        f'\n{_INDENT_PREFIX}For more info: '
152	        'https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html'  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/aws.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	        help_str += (
181	            f'\n{cls._INDENT_PREFIX}  $ aws sso login --profile <profile_name>'
182	            f'\n{cls._INDENT_PREFIX}For more info: '
183	            'https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html'  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/aws.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
308	        image_not_found_message = (
309	            f'Image {image_id!r} not found in AWS region {region}.\n'
310	            f'\nTo find AWS AMI IDs: https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-images.html#examples\n'  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/aws.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
337	        command_str = (
338	            'TOKEN=`curl -X PUT "http://169.254.169.254/latest/api/token" '
339	            '-H "X-aws-ec2-metadata-token-ttl-seconds: 21600"` && '
340	            'curl -H "X-aws-ec2-metadata-token: $TOKEN" -s '
341	            'http://169.254.169.254/latest/dynamic/instance-identity/document'
342	            f' | {constants.SKY_PYTHON_CMD} -u -c "import sys, json; '
343	            'print(json.load(sys.stdin)[\'availabilityZone\'])"')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/aws.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
658	            return False, (
659	                'Failed to fetch the availability zones for the account '
660	                f'{identity_str}. It is likely due to permission issues, please'
661	                ' check the minimal permission required for AWS: '
662	                'https://docs.skypilot.co/en/latest/cloud-setup/cloud-permissions/aws.html'  # pylint: disable=
663	                f'\n{cls._INDENT_PREFIX}Details: '
664	                f'{common_utils.format_exception(e, use_bracket=True)}')
665	        return True, hints

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/aws.py:847
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
846	                with open(cache_path, 'r', encoding='utf-8') as f:
847	                    return json.loads(f.read())
848	            except json.JSONDecodeError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/aws.py:854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
853	        with open(cache_path, 'w', encoding='utf-8') as f:
854	            f.write(json.dumps(result))
855	        return result

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/azure.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
516	        help_str = (
517	            ' Run the following commands:'
518	            f'\n{cls._INDENT_PREFIX}  $ az login'
519	            f'\n{cls._INDENT_PREFIX}  $ az account set -s <subscription_id>'
520	            f'\n{cls._INDENT_PREFIX}For more info: '
521	            'https://docs.microsoft.com/en-us/cli/azure/get-started-with-azure-cli'  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/cudo.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    _CREDENTIAL_HINT = (
41	        'Install cudoctl and run the following commands:\n'
42	        f'{_INDENT_PREFIX}  $ cudoctl init\n'
43	        f'{_INDENT_PREFIX}For more info: '
44	        # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/cudo.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	    _PROJECT_HINT = (
48	        'Create a project and then set it as the default project,:\n'
49	        f'{_INDENT_PREFIX} $ cudoctl projects create my-project-name\n'
50	        f'{_INDENT_PREFIX} $ cudoctl init\n'
51	        f'{_INDENT_PREFIX}For more info: '
52	        # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/fluidstack.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
265	                      encoding='UTF-8') as f:
266	                api_key = f.read().strip()
267	                if not api_key.startswith('api_key'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/fluidstack.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
267	                if not api_key.startswith('api_key'):
268	                    return False, ('Invalid FluidStack API key format. '
269	                                   'To configure credentials, go to:\n    '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/fluidstack.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
274	        except AssertionError:
275	            return False, ('Failed to access FluidStack Cloud'
276	                           ' with credentials. '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/gcp.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	# controller and cloud stores.
66	GOOGLE_SDK_INSTALLATION_COMMAND: str = f'pushd /tmp &>/dev/null && \
67	    {{ gcloud --help > /dev/null 2>&1 || \
68	    {{ mkdir -p {os.path.dirname(_GCLOUD_INSTALLATION_LOG)} && \
69	    wget --quiet https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-{_GCLOUD_VERSION}-linux-x86_64.tar.gz > {_GCLOUD_INSTALLATION_LOG} && \
70	    tar xzf google-cloud-sdk-{_GCLOUD_VERSION}-linux-x86_64.tar.gz >> {_GCLOUD_INSTALLATION_LOG} && \
71	    rm -rf ~/google-cloud-sdk >> {_GCLOUD_INSTALLATION_LOG}  && \
72	    mv google-cloud-sdk ~/ && \
73	    ~/google-cloud-sdk/install.sh -q >> {_GCLOUD_INSTALLATION_LOG} 2>&1 && \
74	    echo "source ~/google-cloud-sdk/path.bash.inc > /dev/null 2>&1" >> ~/.bashrc && \
75	    source ~/google-cloud-sdk/path.bash.inc >> {_GCLOUD_INSTALLATION_LOG} 2>&1; }}; }} && \
76	    popd &>/dev/null'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/gcp.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	_IMAGE_NOT_FOUND_UX_MESSAGE = (
87	    'Image {image_id!r} not found in GCP.\n'
88	    '\nTo find GCP images: https://cloud.google.com/compute/docs/images\n'
89	    f'Format: {colorama.Style.BRIGHT}projects/<project-id>/global/images/<image-name>{colorama.Style.RESET_ALL}\n'
90	    'Example: projects/deeplearning-platform-release/global/images/common-cpu-v20230615-debian-11-py310\n'
91	    '\nTo find machine images: https://cloud.google.com/compute/docs/machine-images\n'
92	    f'Format: {colorama.Style.BRIGHT}projects/<project-id>/global/machineImages/<machine-image-name>{colorama.Style.RESET_ALL}\n'
93	    f'\nYou can query image id using: {colorama.Style.BRIGHT}gcloud compute images list --project <project-id> --no-standard-images{colorama.Style.RESET_ALL}'
94	    f'\nTo query common AI images: {colorama.Style.BRIGHT}gcloud compute images list --project deeplearning-platform-release | less{colorama.Style.RESET_ALL}'
95	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/gcp.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	_IMAGE_NOT_FOUND_UX_MESSAGE = (
87	    'Image {image_id!r} not found in GCP.\n'
88	    '\nTo find GCP images: https://cloud.google.com/compute/docs/images\n'
89	    f'Format: {colorama.Style.BRIGHT}projects/<project-id>/global/images/<image-name>{colorama.Style.RESET_ALL}\n'
90	    'Example: projects/deeplearning-platform-release/global/images/common-cpu-v20230615-debian-11-py310\n'
91	    '\nTo find machine images: https://cloud.google.com/compute/docs/machine-images\n'
92	    f'Format: {colorama.Style.BRIGHT}projects/<project-id>/global/machineImages/<machine-image-name>{colorama.Style.RESET_ALL}\n'
93	    f'\nYou can query image id using: {colorama.Style.BRIGHT}gcloud compute images list --project <project-id> --no-standard-images{colorama.Style.RESET_ALL}'
94	    f'\nTo query common AI images: {colorama.Style.BRIGHT}gcloud compute images list --project deeplearning-platform-release | less{colorama.Style.RESET_ALL}'
95	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/gcp.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	    _CREDENTIAL_HINT = (
166	        'Run the following commands:\n'
167	        # This authenticates the CLI to make `gsutil` work:
168	        f'{_INDENT_PREFIX}  $ gcloud init\n'
169	        # This will generate
170	        # ~/.config/gcloud/application_default_credentials.json.
171	        f'{_INDENT_PREFIX}  $ gcloud auth application-default login\n'
172	        f'{_INDENT_PREFIX}For more info: '
173	        'https://docs.skypilot.co/en/latest/getting-started/installation.html#google-cloud-platform-gcp'  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/gcp.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	    _APPLICATION_CREDENTIAL_HINT = (
176	        'Run the following commands:\n'
177	        f'{_INDENT_PREFIX}  $ gcloud auth application-default login\n'
178	        f'{_INDENT_PREFIX}Or set the environment variable GOOGLE_APPLICATION_CREDENTIALS '
179	        'to the path of your service account key file.\n'
180	        f'{_INDENT_PREFIX}For more info: '
181	        'https://docs.skypilot.co/en/latest/getting-started/installation.html#google-cloud-platform-gcp'  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/gcp.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	                clouds.CloudImplementationFeatures.STOP: (
196	                    'TPU VM pods cannot be stopped. Please refer to: '
197	                    'https://cloud.google.com/tpu/docs/managing-tpus-tpu-vm#stopping_your_resources'
198	                )
199	            }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/gcp.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	        command_str = (
303	            'curl -s http://metadata.google.internal/computeMetadata/v1/instance/zone'  # pylint: disable=line-too-long
304	            ' -H "Metadata-Flavor: Google" | awk -F/ \'{print $4}\'')
305	        return command_str
306	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/gcp.py:839
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
838	            return False, (
839	                'The following permissions are not enabled for the current '
840	                f'GCP identity ({identity_str}):\n    '
841	                f'{diffs}\n    '
842	                'For more details, visit: https://docs.skypilot.co/en/latest/cloud-setup/cloud-permissions/gcp.html')  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/ibm.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
369	                raise ValueError(
370	                    f'Image {image_id!r} not found in IBM region "{region}".\n'
371	                    '\nTo use image id in IBM, create a private VPC image and '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/lambda_cloud.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	        except (AssertionError, KeyError, lambda_utils.LambdaCloudError):
247	            return False, ('Failed to access Lambda Cloud with credentials. '
248	                           'To configure credentials, go to:\n    '

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/lambda_cloud.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
297	        for node in vms:
298	            if node.get('name') in possible_names:
299	                node_status = status_map[node['status']]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/oci.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
401	        short_credential_help_str = (
402	            'For more details, refer to: '
403	            # pylint: disable=line-too-long
404	            'https://docs.skypilot.co/en/latest/getting-started/installation.html#oracle-cloud-infrastructure-oci'
405	        )
406	        credential_help_str = (
407	            'To configure credentials, go to: '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/oci.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
406	        credential_help_str = (
407	            'To configure credentials, go to: '
408	            'https://docs.oracle.com/en-us/iaas/Content/API/Concepts/'
409	            'apisigningkey.htm\n'
410	            f'{cls._INDENT_PREFIX}Please make sure the API keys and the config '
411	            'files are placed under ~/.oci:\n'
412	            f'{cls._INDENT_PREFIX}  ~/.oci/config\n'
413	            f'{cls._INDENT_PREFIX}  ~/.oci/oci_api_key.pem\n'
414	            f'{cls._INDENT_PREFIX}The ~/.oci/config file should have the '
415	            'following format:\n'
416	            f'{cls._INDENT_PREFIX}  [DEFAULT]\n'
417	            f'{cls._INDENT_PREFIX}  user=ocid1.user.oc1..aaaaaaaa\n'
418	            f'{cls._INDENT_PREFIX}  '
419	            'fingerprint=aa:bb:cc:dd:ee:ff:gg:hh:ii:jj:kk:ll:mm:nn:oo:pp\n'
420	            f'{cls._INDENT_PREFIX}  tenancy=ocid1.tenancy.oc1..aaaaaaaa\n'
421	            f'{cls._INDENT_PREFIX}  region=us-sanjose-1\n'
422	            f'{cls._INDENT_PREFIX}  key_file=~/.oci/oci_api_key.pem')
423	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/paperspace.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	            return False, (
259	                'Failed to access Paperspace Cloud with credentials.\n    '
260	                'To configure credentials, follow the instructions at: '
261	                'https://docs.skypilot.co/en/latest/getting-started/installation.html#paperspace\n    '
262	                'Generate API key and create a json at `~/.paperspace/config.json` with \n     '
263	                '    {"apiKey": "[YOUR API KEY]"}\n    '
264	                f'Reason: {str(e)}')
265	        except requests.exceptions.ConnectionError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/runpod.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
251	                return False, (
252	                    f'{error} \n'  # First line is indented by 4 spaces
253	                    '    Credentials can be set up by running: \n'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/scp.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
319	            return False, (
320	                'Failed to access SCP with credentials. '
321	                'To configure credentials, see: '
322	                'https://cloud.samsungsds.com/openapiguide\n'
323	                f'{cls._INDENT_PREFIX}Generate API key and add the '
324	                'following line to ~/.scp/scp_credential:\n'
325	                f'{cls._INDENT_PREFIX}  access_key = [YOUR API ACCESS KEY]\n'
326	                f'{cls._INDENT_PREFIX}  secret_key = [YOUR API SECRET KEY]\n'
327	                f'{cls._INDENT_PREFIX}  project_id = [YOUR PROJECT ID]')
328	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/aws_catalog.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
95	        with open(az_mapping_path, 'r', encoding='utf-8') as f:
96	            az_mapping_hash = hashlib.md5(f.read().encode()).hexdigest()
97	        with open(az_mapping_md5_path, 'w', encoding='utf-8') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/aws_catalog.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	        with open(az_mapping_md5_path, 'w', encoding='utf-8') as f:
98	            f.write(az_mapping_hash)
99	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/common.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	        with open(md5_filepath, 'r', encoding='utf-8') as f:
75	            last_md5 = f.read()
76	        return file_md5 != last_md5

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/common.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	                    try:
206	                        r = requests.get(url=url,
207	                                         headers={'User-Agent': 'SkyPilot/0.7'})
208	                        r.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/common.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
227	                        with open(catalog_path, 'w', encoding='utf-8') as f:
228	                            f.write(r.text)
229	                        with open(meta_path + '.md5', 'w',

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/common.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
230	                                  encoding='utf-8') as f:
231	                            f.write(hashlib.md5(r.text.encode()).hexdigest())
232	                logger.debug(f'Updated {cloud} catalog {filename}.')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/common.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
297	                        faq_msg = (
298	                            '\nIf a region is not included in the following '
299	                            'list, please check the FAQ docs for how to fetch '
300	                            'its catalog info.\nhttps://docs.skypilot.co'
301	                            '/en/latest/reference/faq.html#advanced-how-to-'
302	                            'make-skypilot-use-all-global-regions')
303	                        error_msg += faq_msg + _get_all_supported_regions_str()
304	                    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/constants.py:2
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	"""Constants used for service catalog."""
2	HOSTED_CATALOG_DIR_URL = 'https://raw.githubusercontent.com/skypilot-org/skypilot-catalog/master/catalogs'  # pylint: disable=line-too-long
3	CATALOG_SCHEMA_VERSION = 'v6'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_aws.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	# regions.
75	PRICING_TABLE_URL_FMT = 'https://pricing.us-east-1.amazonaws.com/offers/v1.0/aws/AmazonEC2/current/{region}/index.csv'  # pylint: disable=line-too-long
76	# Hardcode the regions that offer p4de.24xlarge as our credential does not have
77	# the permission to query the offerings of the instance.
78	# Ref: https://aws.amazon.com/ec2/instance-types/p4/
79	P4DE_REGIONS = ['us-east-1', 'us-west-2']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_aws.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	                    raise RuntimeError(
95	                        'Failed to retrieve AWS regions. '
96	                        'Please ensure that the `ec2:DescribeRegions` action '
97	                        'is enabled for your AWS account in IAM. '

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_aws.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
248	        # within a multiprocessing.Pool, and Pool cannot be nested.
249	        with mp_pool.ThreadPool() as pool:
250	            futures = [

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_aws.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
356	def get_all_regions_instance_types_df(regions: Set[str]) -> 'pd.DataFrame':
357	    with mp_pool.Pool() as pool:
358	        df_or_regions = pool.map(_get_instance_types_df, regions)

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_aws.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
438	    ]
439	    with mp_pool.Pool() as pool:
440	        results = pool.starmap(_get_image_row, image_metas)

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_aws.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
471	    # a Pool, and Pool cannot be nested.
472	    with mp_pool.ThreadPool() as pool:
473	        az_mappings = pool.map(_get_availability_zones_with_error_handling,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_azure.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	    filters_str = urllib.parse.quote(' and '.join(filters))
120	    return f'https://prices.azure.com/api/retail/prices?$filter={filters_str}'
121	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_azure.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	            print(f'Fetched pricing pages {page}')
132	        r = requests.get(url)
133	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_azure.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	        content = json.loads(content_str)
136	        items = content.get('Items', [])
137	        if not items:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_azure.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	        all_items += items
140	        url = content.get('NextPageLink')
141	    print(f'Done fetching pricing {region}')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_azure.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	    family = family.replace(' ', '')
181	    return FAMILY_NAME_TO_SKYPILOT_GPU_NAME.get(family)
182	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_azure.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
189	    else:
190	        with mp_pool.Pool() as pool:
191	            dfs_result = pool.map_async(get_pricing_df, region_set)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_azure.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
193	
194	            dfs = dfs_result.get()
195	            df_sku = df_sku_result.get()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_azure.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
194	            dfs = dfs_result.get()
195	            df_sku = df_sku_result.get()
196	            df = pd.concat(dfs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_azure.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
278	    def _upd_a10_gpu_count(row):
279	        new_gpu_cnt = AZURE_FRACTIONAL_A10_INS_TYPE_TO_NUM_GPUS.get(
280	            row['InstanceType'])
281	        if new_gpu_cnt is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_cudo.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    configuration = cudo_compute.Configuration()
19	    configuration.host = 'https://rest.compute.cudo.org'
20	    client = cudo_compute.ApiClient(configuration)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_cudo.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	    with open(path, 'w', encoding='utf-8') as file:
83	        file.write(
84	            # pylint: disable=line-too-long
85	            'InstanceType,AcceleratorName,AcceleratorCount,vCPUs,MemoryGiB,Price,Region,GpuInfo,SpotPrice\n'
86	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_cudo.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	            ]
99	            file.write(','.join(data) + '\n')
100	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_fluidstack.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	
14	ENDPOINT = 'https://platform.fluidstack.io/list_available_configurations'
15	DEFAULT_FLUIDSTACK_API_KEY_PATH = os.path.expanduser('~/.fluidstack/api_key')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_fluidstack.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
199	    for plan in plans:
200	        for region in plan.get('regions', []):
201	            regions[region] = region

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_fluidstack.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
206	    with open(DEFAULT_FLUIDSTACK_API_KEY_PATH, 'r', encoding='UTF-8') as f:
207	        api_key = f.read().strip()
208	    response = requests.get(ENDPOINT, headers={'api-key': api_key})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_fluidstack.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
207	        api_key = f.read().strip()
208	    response = requests.get(ENDPOINT, headers={'api-key': api_key})
209	    plans = response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_fluidstack.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
257	                instance_type = f'{plan["gpu_type"]}::{gpu_cnt}'
258	                for region in plan.get('regions', []):
259	                    writer.writerow([

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_gcp.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
322	    else:
323	        with multiprocessing.Pool() as pool:
324	            all_machine_dfs = pool.map(_get_machine_type_for_zone, zones)

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_gcp.py:323
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
322	    else:
323	        with multiprocessing.Pool() as pool:
324	            all_machine_dfs = pool.map(_get_machine_type_for_zone, zones)

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_gcp.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
489	    else:
490	        with multiprocessing.Pool() as pool:
491	            all_gpu_dfs = pool.map(_get_gpus_for_zone, zones)

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_gcp.py:490
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
489	    else:
490	        with multiprocessing.Pool() as pool:
491	            all_gpu_dfs = pool.map(_get_gpus_for_zone, zones)

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_gcp.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
608	    else:
609	        with multiprocessing.Pool() as pool:
610	            all_tpu_dfs = pool.map(_get_tpu_for_zone, zones)

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_gcp.py:609
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
608	    else:
609	        with multiprocessing.Pool() as pool:
610	            all_tpu_dfs = pool.map(_get_tpu_for_zone, zones)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_lambda_cloud.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	ENDPOINT = 'https://cloud.lambdalabs.com/api/v1/instance-types'
19	DEFAULT_LAMBDA_KEYS_PATH = os.path.expanduser('~/.lambda_cloud/lambda_keys')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_lambda_cloud.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	    headers = {'Authorization': f'Bearer {api_key}'}
72	    response = requests.get(ENDPOINT, headers=headers)
73	    info = response.json()['data']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_lambda_cloud.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
121	                      encoding='utf-8') as f:
122	                api_key = f.read().strip()
123	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_vsphere.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
343	            for host in hosts_for_csv:
344	                f.write(f'{host.get("HostName")},{host.get("MoRefID")},'
345	                        f'{host.get("vCenter")},{host.get("Datacenter")},'
346	                        f'{host.get("Cluster")},{host.get("TotalCPUMHz")},'
347	                        f'{host.get("AvailableCPUCapacityMHz")},'
348	                        f'{host.get("TotalMemoryMB")},'
349	                        f'{host.get("AvailableMemoryMB")},'
350	                        f'"{host.get("Accelerators")}",'
351	                        f'{host.get("CPUMHz")},{host.get("UUID")}\n')
352	                return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_vsphere.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
447	                            gpu_info_str = gpu_info['GpuInfo']
448	                            f.write(f'gpu.{gpu_short_name},{gpu_short_name},'
449	                                    f'{accelerator_count},'
450	                                    f'{vcpus},'
451	                                    f'{memory_gb},'
452	                                    f'\"{gpu_info_str}\",0.0,0.0,'
453	                                    f'{vcenter_name},{cluster_name}\n')
454	            cpu_host_dict = summary_result.get('weakest_host_of_each_cluster')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_vsphere.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
472	                                'InstanceType')
473	                            f.write(f'{instance_type_str},,,'
474	                                    f'{vcpus},{memory_in_gb},,0.0,0.0,'
475	                                    f'{vcenter_name},{cluster_name}\n')
476	        return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_vsphere.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
527	                        if not cpu_image_added:
528	                            f.write(f'{item.id},{vcenter_name},{item_cpu},'
529	                                    f'{item_memory},,,\'[]\'\n')
530	                            cpu_image_added = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/data_fetchers/fetch_vsphere.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
538	                    gpu_tags_str = str(gpu_tags).replace('\'', '\"')
539	                    f.write(f'{item.id},{vcenter_name},{item_cpu},{item_memory}'
540	                            f',,,\'{gpu_tags_str}\'\n')
541	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/gcp_catalog.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
556	                raise exceptions.ResourcesMismatchError(
557	                    'TPU Nodes can be only used with N1 machines. '
558	                    'Please refer to: '
559	                    'https://cloud.google.com/compute/docs/general-purpose-machines#n1_machines')  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/gcp_catalog.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
566	                raise exceptions.ResourcesMismatchError(
567	                    f'{acc_name} GPUs cannot be attached to {instance_type}. '
568	                    f'Use one of {matching_types} instead. Please refer to '
569	                    'https://cloud.google.com/compute/docs/gpus')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/gcp_catalog.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
574	            raise exceptions.ResourcesMismatchError(
575	                f'{acc_name} GPUs cannot be attached to {instance_type}. '
576	                'Use N1 instance types instead. Please refer to: '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/gcp_catalog.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
611	            raise exceptions.ResourcesMismatchError(
612	                f'{acc_name}:{acc_count} cannot be attached to '
613	                f'{instance_type}. The maximum number of vCPUs is {max_cpus}. '
614	                'Please refer to: https://cloud.google.com/compute/docs/gpus')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/service_catalog/gcp_catalog.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
617	            raise exceptions.ResourcesMismatchError(
618	                f'{acc_name}:{acc_count} cannot be attached to '
619	                f'{instance_type}. The maximum CPU memory is {max_memory} GB. '
620	                'Please refer to: https://cloud.google.com/compute/docs/gpus')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	CREDENTIALS_PATH = '~/.scp/scp_credential'
20	API_ENDPOINT = 'https://openapi.samsungsdscloud.com'
21	TEMP_VM_JSON_PATH = '/tmp/json/tmp_vm_body.json'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	            metadata = json.load(f)
54	        return metadata.get(instance_id)
55	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
181	        url = f'{API_ENDPOINT}/virtual-server/v3/virtual-servers'
182	        return self._post(url, instance_config)
183	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	
190	        response = requests.get(url, headers=self.headers)
191	        raise_scp_error(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
192	        if contents_key is not None:
193	            return response.json().get(contents_key, [])
194	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
202	
203	        response = requests.post(url, json=request_body, headers=self.headers)
204	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
231	        }
232	        return self._post(url, request_body)
233	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
244	        }
245	        return self._post(url, request_body)
246	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
266	        }
267	        return self._post(url, request_body)
268	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
283	        }
284	        return self._post(url, request_body)
285	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
309	        }
310	        return self._post(url, request_body)
311	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
318	        url = f'{API_ENDPOINT}/virtual-server/v2/virtual-servers'
319	        return self._get(url)
320	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
322	        """List offered instances and their availability."""
323	        response = requests.get(f'{API_ENDPOINT}/instance-types',
324	                                headers=self.headers)
325	        raise_scp_error(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
325	        raise_scp_error(response)
326	        return response.json().get('data', [])
327	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
342	        signature = str(
343	            base64.b64encode(
344	                hmac.new(secret, message, digestmod=hashlib.sha256).digest()),
345	            'utf-8')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:343
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
342	        signature = str(
343	            base64.b64encode(
344	                hmac.new(secret, message, digestmod=hashlib.sha256).digest()),
345	            'utf-8')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
365	        url = f'{API_ENDPOINT}/virtual-server/v2/virtual-servers/{virtual_server_id}/nics'  # pylint: disable=line-too-long
366	        return self._get(url)
367	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
378	        url = f'{API_ENDPOINT}/project/v3/projects/{self.project_id}/zones'
379	        return self._get(url)
380	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
382	        url = f'{API_ENDPOINT}/product/v2/zones/{service_zone_id}/products'
383	        return self._get(url)
384	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
386	        url = f'{API_ENDPOINT}/product/v2/zones/{service_zone_id}/product-groups'  # pylint: disable=line-too-long
387	        return self._get(url)
388	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
390	        url = f'{API_ENDPOINT}/vpc/v2/vpcs?serviceZoneId={service_zone_id}'
391	        return self._get(url)
392	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
394	        url = f'{API_ENDPOINT}/subnet/v2/subnets?subnetTypes=PUBLIC'
395	        return self._get(url)
396	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
414	            url = url + '?' + '&'.join(parameter)
415	        return self._get(url)
416	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
418	        url = f'{API_ENDPOINT}/internet-gateway/v2/internet-gateways'
419	        return self._get(url)
420	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
422	        url = f'{API_ENDPOINT}/virtual-server/v3/virtual-servers/{vm_id}'
423	        return self._get(url, contents_key=None)
424	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
426	        url = f'{API_ENDPOINT}/firewall/v2/firewalls/{firewall_id}/rules/{rule_id}'  # pylint: disable=line-too-long
427	        return self._get(url, contents_key=None)
428	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
430	        url = f'{API_ENDPOINT}/firewall/v2/firewalls'
431	        return self._get(url)
432	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
434	        url = f'{API_ENDPOINT}/project/v3/projects/{self.project_id}/zones'
435	        zone_contents = self._get(url)
436	        return [content['serviceZoneName'] for content in zone_contents]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
439	        url = f'{API_ENDPOINT}/virtual-server/v2/virtual-servers/{vm_id}/start'
440	        return self._post(url=url, request_body={})
441	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/utils/scp_utils.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
443	        url = f'{API_ENDPOINT}/virtual-server/v2/virtual-servers/{vm_id}/stop'
444	        return self._post(url=url, request_body={})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/vast.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
244	                return False, (
245	                    'error \n'  # First line is indented by 4 spaces
246	                    '    Credentials can be set up by running: \n'
247	                    '        $ pip install vastai\n'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/clouds/vsphere.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
264	            return False, (
265	                'vSphere dependencies are not installed. '
266	                'Run the following commands:'
267	                f'\n{cls._INDENT_PREFIX}  $ pip install skypilot[vSphere]'
268	                f'\n{cls._INDENT_PREFIX}Credentials may also need to be set. '
269	                'For more details. See https://docs.skypilot.co/en/latest/getting-started/installation.html#vmware-vsphere'  # pylint: disable=line-too-long
270	                f'{common_utils.format_exception(e, use_bracket=True)}')
271	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/core.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
634	    all_jobs = not skip_finished
635	    username: Optional[str] = getpass.getuser()
636	    if all_users:

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/core.py:635
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
634	    all_jobs = not skip_finished
635	    username: Optional[str] = getpass.getuser()
636	    if all_users:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/data_transfer.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	            logger.info(
114	                f'Transfer timed out after {(time.time() - start) / 3600:.2f} '
115	                'hours. Please check the status of the transfer job in the GCP '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/data_utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	AZURE_CONTAINER_URL = (
32	    'https://{storage_account_name}.blob.core.windows.net/{container_name}')
33	
34	# Retry 5 times by default for delayed propagation to Azure system
35	# when creating Storage Account.
36	_STORAGE_ACCOUNT_KEY_RETRIEVE_MAX_ATTEMPT = 5
37	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/data_utils.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
293	    pattern = re.compile(
294	        r'^https://([a-z0-9]{3,24})\.blob\.core\.windows\.net(/[^/]+)*$')
295	    match = pattern.match(endpoint_url)
296	    if match is None:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/data_utils.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
379	    # https://github.com/skypilot-org/skypilot/pull/1966#issuecomment-1646992938
380	    with concurrent.futures.ProcessPoolExecutor() as executor:
381	        futures = []

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/data_utils.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
478	    # Run commands in parallel
479	    with pool.ThreadPool(processes=max_concurrent_uploads) as p:
480	        p.starmap(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/data_utils.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
632	                raise exceptions.StorageError(
633	                    'rclone wasn\'t detected. '
634	                    'Consider installing via: '
635	                    '"curl https://rclone.org/install.sh '

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/data_utils.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
655	                        config_data += '\n'
656	                file.write(config_data)
657	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/mounting_utils.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    """Returns a command to install S3 mount utility goofys."""
27	    install_cmd = ('sudo wget -nc https://github.com/romilbhardwaj/goofys/'
28	                   'releases/download/0.24.0-romilb-upstream/goofys '
29	                   '-O /usr/local/bin/goofys && '
30	                   'sudo chmod 755 /usr/local/bin/goofys')
31	    return install_cmd

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/mounting_utils.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    """Returns a command to install GCS mount utility gcsfuse."""
52	    install_cmd = ('wget -nc https://github.com/GoogleCloudPlatform/gcsfuse'
53	                   f'/releases/download/v{GCSFUSE_VERSION}/'
54	                   f'gcsfuse_{GCSFUSE_VERSION}_amd64.deb '
55	                   '-O /tmp/gcsfuse.deb && '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/mounting_utils.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	    """Returns a command to install AZ Container mount utility blobfuse2."""
80	    install_cmd = ('sudo apt-get update; '
81	                   'sudo apt-get install -y '
82	                   '-o Dpkg::Options::="--force-confdef" '
83	                   'fuse3 libfuse3-dev && '
84	                   'wget -nc https://github.com/Azure/azure-storage-fuse'
85	                   f'/releases/download/blobfuse2-{BLOBFUSE2_VERSION}'
86	                   f'/blobfuse2-{BLOBFUSE2_VERSION}-Debian-11.0.x86_64.deb '
87	                   '-O /tmp/blobfuse2.deb && '
88	                   'sudo dpkg --install /tmp/blobfuse2.deb && '
89	                   f'mkdir -p {_BLOBFUSE_CACHE_ROOT_DIR};')
90	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/mounting_utils.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	    """Returns a command to install IBM COS mount utility rclone."""
168	    install_cmd = ('rclone version >/dev/null 2>&1 || '
169	                   '(curl https://rclone.org/install.sh | '
170	                   'sudo bash)')
171	    return install_cmd

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/mounting_utils.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	    install_cmd = (
209	        f'(which dpkg > /dev/null 2>&1 && (which rclone > /dev/null || (cd ~ > /dev/null'
210	        f' && curl -O https://downloads.rclone.org/{RCLONE_VERSION}/rclone-{RCLONE_VERSION}-linux-amd64.deb'
211	        f' && sudo dpkg -i rclone-{RCLONE_VERSION}-linux-amd64.deb'
212	        f' && rm -f rclone-{RCLONE_VERSION}-linux-amd64.deb)))'
213	        f' || (which rclone > /dev/null || (cd ~ > /dev/null'
214	        f' && curl -O https://downloads.rclone.org/{RCLONE_VERSION}/rclone-{RCLONE_VERSION}-linux-amd64.rpm'
215	        f' && sudo yum --nogpgcheck install rclone-{RCLONE_VERSION}-linux-amd64.rpm -y'
216	        f' && rm -f rclone-{RCLONE_VERSION}-linux-amd64.rpm))')
217	    return install_cmd

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/mounting_utils.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	    install_cmd = (
209	        f'(which dpkg > /dev/null 2>&1 && (which rclone > /dev/null || (cd ~ > /dev/null'
210	        f' && curl -O https://downloads.rclone.org/{RCLONE_VERSION}/rclone-{RCLONE_VERSION}-linux-amd64.deb'
211	        f' && sudo dpkg -i rclone-{RCLONE_VERSION}-linux-amd64.deb'
212	        f' && rm -f rclone-{RCLONE_VERSION}-linux-amd64.deb)))'
213	        f' || (which rclone > /dev/null || (cd ~ > /dev/null'
214	        f' && curl -O https://downloads.rclone.org/{RCLONE_VERSION}/rclone-{RCLONE_VERSION}-linux-amd64.rpm'
215	        f' && sudo yum --nogpgcheck install rclone-{RCLONE_VERSION}-linux-amd64.rpm -y'
216	        f' && rm -f rclone-{RCLONE_VERSION}-linux-amd64.rpm))')
217	    return install_cmd

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/storage.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
784	                    raise exceptions.StorageSourceError(
785	                        f'Supported paths: local, s3://, gs://, https://, '
786	                        f'r2://, cos://, oci://. Got: {source}')
787	        return source, is_local_source

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/storage.py:1302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1301	                raise exceptions.ResourcesUnavailableError(
1302	                    'Storage \'store: s3\' specified, but ' \
1303	                    'AWS access is disabled. To fix, enable '\
1304	                    'AWS by running `sky check`. More info: '\

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/storage.py:1790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1789	                raise exceptions.ResourcesUnavailableError(
1790	                    'Storage \'store: gcs\' specified, but '
1791	                    'GCP access is disabled. To fix, enable '
1792	                    'GCP by running `sky check`. '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/storage.py:2373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2372	                raise exceptions.ResourcesUnavailableError(
2373	                    'Storage "store: azure" specified, but '
2374	                    'Azure access is disabled. To fix, enable '
2375	                    'Azure by running `sky check`. More info: '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/storage.py:3137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3136	                raise exceptions.ResourcesUnavailableError(
3137	                    'Storage \'store: r2\' specified, but ' \
3138	                    'Cloudflare R2 access is disabled. To fix, '\
3139	                    'enable Cloudflare R2 by running `sky check`. '\

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/data/storage.py:4058
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4057	                raise exceptions.ResourcesUnavailableError(
4058	                    'Storage \'store: oci\' specified, but ' \
4059	                    'OCI access is disabled. To fix, enable '\
4060	                    'OCI by running `sky check`. '\

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/exceptions.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
283	                return (
284	                    'Failed to retrieve availability zones. '
285	                    'Please ensure that the `ec2:DescribeAvailabilityZones` '
286	                    'action is enabled for your AWS account in IAM. '

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/jobs/controller.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
455	            with signal_file.open(mode='r', encoding='utf-8') as f:
456	                user_signal = f.read().strip()
457	                try:

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/jobs/controller.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
509	        #  start daemon processes like Ray.
510	        controller_process = multiprocessing.Process(target=_run_controller,
511	                                                     args=(job_id, dag_yaml))
512	        controller_process.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/jobs/dashboard/dashboard.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
174	                    with open(log_path, 'r', encoding='utf-8') as f:
175	                        log_content = f.read()
176	                        row[JobTableColumns.FAILOVER] = _extract_launch_history(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/jobs/utils.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
480	            with signal_file.open('w', encoding='utf-8') as f:
481	                f.write(UserSignal.CANCEL.value)
482	                f.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/jobs/utils.py:825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
824	            # Print any remaining logs including incomplete line.
825	            print(f.read(), end='', flush=True)
826	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/aws/instance.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
385	            inst = stopping_instances.pop(0)
386	            with pool.ThreadPool(processes=1) as pool_:
387	                # wait_until_stopped() is a blocking call, and sometimes it can

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/aws/utils.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        aws_session_script_url = (
61	            'https://gist.github.com/maximsmol/a0284e1d97b25d417bd9ae02e5f450cf'
62	        )
63	
64	        logger.error(generic_message)
65	        logger.info(vars(exc))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/azure/instance.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
255	    username = node_config['azure_arm_parameters']['adminUsername']
256	    os_linux_custom_data = base64.b64encode(
257	        node_config['azure_arm_parameters']['cloudInitSetupCommands'].encode(
258	            'utf-8')).decode('utf-8')
259	    os_profile = compute.OSProfile(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/azure/instance.py:256
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
255	    username = node_config['azure_arm_parameters']['adminUsername']
256	    os_linux_custom_data = base64.b64encode(
257	        node_config['azure_arm_parameters']['cloudInitSetupCommands'].encode(
258	            'utf-8')).decode('utf-8')
259	    os_profile = compute.OSProfile(

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/azure/instance.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
499	            compute_client.virtual_machines, 'start')
500	        with pool.ThreadPool() as p:
501	            p.starmap(

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/azure/instance.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
565	        # tagged.
566	        with pool.ThreadPool() as p:
567	            p.starmap(

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/azure/instance.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
653	        client=compute_client.virtual_machines, function_name='deallocate')
654	    with pool.ThreadPool() as p:
655	        p.starmap(stop_virtual_machine,

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/azure/instance.py:679
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
678	        nodes = _filter_instances(compute_client, resource_group, filters)
679	        with pool.ThreadPool() as p:
680	            p.starmap(delete_virtual_machine,

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/azure/instance.py:978
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
977	
978	    with pool.ThreadPool() as p:
979	        p.starmap(_fetch_and_map_status,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/fluidstack/fluidstack_utils.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	ENDPOINT = 'https://platform.fluidstack.io/'
18	FLUIDSTACK_API_KEY_PATH = '~/.fluidstack/api_key'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/fluidstack/fluidstack_utils.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	    with open(path, mode='r', encoding='utf-8') as f:
23	        return f.read().strip()
24	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/fluidstack/fluidstack_utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        resp_json = response.json()
40	        message = resp_json.get('error', response.text)
41	    except (KeyError, json.decoder.JSONDecodeError) as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/fluidstack/fluidstack_utils.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	    def get_plans(self):
57	        response = requests.get(ENDPOINT + 'list_available_configurations',
58	                                headers={'api-key': self.api_key})
59	        raise_fluidstack_error(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/fluidstack/fluidstack_utils.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	    def list_instances(self) -> List[Dict[str, Any]]:
64	        response = requests.get(
65	            ENDPOINT + 'instances',
66	            headers={'api-key': self.api_key},
67	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/fluidstack/fluidstack_utils.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
105	
106	            response = requests.post(ENDPOINT + 'instances',
107	                                     headers={'api-key': self.api_key},
108	                                     json=body)
109	            raise_fluidstack_error(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/fluidstack/fluidstack_utils.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	            raise_fluidstack_error(response)
110	            instance_id = response.json().get('id')
111	            instance_ids.append(instance_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/fluidstack/fluidstack_utils.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
116	    def list_ssh_keys(self):
117	        response = requests.get(ENDPOINT + 'ssh_keys',
118	                                headers={'api-key': self.api_key})
119	        raise_fluidstack_error(response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/fluidstack/fluidstack_utils.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
129	        ssh_key_name = 'skypilot-' + get_key_suffix()
130	        response = requests.post(
131	            ENDPOINT + 'ssh_keys',
132	            headers={'api-key': self.api_key},
133	            json=dict(name=ssh_key_name, public_key=ssh_pub_key),
134	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/fluidstack/fluidstack_utils.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	            for plan in plans:
146	                for region in plan.get('regions', []):
147	                    regions[region] = region

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/gcp/config.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	        cache_discovery=False,
105	        discoveryServiceUrl='https://tpu.googleapis.com/$discovery/rest',
106	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/gcp/config.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
374	        # account is limited by the IAM rights specified below.
375	        'scopes': ['https://www.googleapis.com/auth/cloud-platform'],
376	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/gcp/config.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
590	                    'SUBNET_NOT_FOUND_FOR_VPC',
591	                    f'No subnet for region {region} found for specified VPC '
592	                    f'{specific_vpc_to_use!r}. '
593	                    f'Check the subnets of VPC {specific_vpc_to_use!r} at '
594	                    'https://console.cloud.google.com/networking/networks')

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/gcp/instance.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
422	    for res, insts in handler_to_instances.items():
423	        with pool.ThreadPool() as p:
424	            inst_info = p.starmap(res.get_instance_info,

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/gcp/instance_utils.py:902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
901	        # assign labels for head node
902	        with pool.ThreadPool() as p:
903	            p.starmap(cls.create_node_tag,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/gcp/instance_utils.py:1209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1208	            cache_discovery=False,
1209	            discoveryServiceUrl='https://tpu.googleapis.com/$discovery/rest')
1210	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/gcp/instance_utils.py:1732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1731	                'domain': 'tpu',
1732	                'message': f'TPU {tpu_name} creation failed due to quota '
1733	                           'exhaustion. Please visit '

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/instance_setup.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
146	            cluster_info.provider_name)
147	    with futures.ThreadPoolExecutor(max_workers=max_workers) as pool:
148	        results = []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/instance.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
720	    except kubernetes.kubernetes.client.ApiException as e:
721	        logger.warning('run_instances: Error occurred while checking for '
722	                       f'nvidia RuntimeClass - '
723	                       f'{common_utils.format_exception(e)}'
724	                       'Continuing without using nvidia RuntimeClass.\n'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/network.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	        raise Exception(
76	            'Ingress controller not found. '
77	            'Install Nginx ingress controller first: '
78	            'https://github.com/kubernetes/ingress-nginx/blob/main/docs/deploy/index.md.'  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/network_utils.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	    with open(template_path, 'r', encoding='utf-8') as fin:
77	        template = fin.read()
78	    annotations = skypilot_config.get_nested(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/network_utils.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
105	    with open(template_path, 'r', encoding='utf-8') as fin:
106	        template = fin.read()
107	    annotations = skypilot_config.get_nested(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/utils.py:935
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
934	    if network_mode == kubernetes_enums.KubernetesNetworkingMode.PORTFORWARD:
935	        return '127.0.0.1'
936	    # Return the IP address of the first node with an external IP

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/utils.py:1140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1139	        ctx_name = context_obj['name']
1140	        exec_msg = ('exec-based authentication is used for '
1141	                    f'Kubernetes context {ctx_name!r}.'
1142	                    ' This may cause issues with autodown or when running '

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/utils.py:1230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1229	            with open(ns_path, encoding='utf-8') as f:
1230	                return f.read().strip()
1231	    # If not in-cluster, get the namespace from kubeconfig

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/utils.py:1418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1417	        # adding execution permission to the proxy command script
1418	        os.chmod(proxy_cmd_path, os.stat(proxy_cmd_path).st_mode | 0o111)
1419	        kube_context_flag = f'-c {current_kube_context} ' if (

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/utils.py:1418
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1417	        # adding execution permission to the proxy command script
1418	        os.chmod(proxy_cmd_path, os.stat(proxy_cmd_path).st_mode | 0o111)
1419	        kube_context_flag = f'-c {current_kube_context} ' if (

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/utils.py:1528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1527	    # and execute the file.
1528	    os.chmod(port_fwd_proxy_cmd_path, 0o700)
1529	    return port_fwd_proxy_cmd_path

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/utils.py:1528
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1527	    # and execute the file.
1528	    os.chmod(port_fwd_proxy_cmd_path, 0o700)
1529	    return port_fwd_proxy_cmd_path

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/utils.py:1756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1755	    with open(template_path, 'r', encoding='utf-8') as fin:
1756	        template = fin.read()
1757	    j2_template = jinja2.Template(template)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/utils.py:1934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1933	    with open(cluster_yaml_path, 'r', encoding='utf-8') as f:
1934	        yaml_content = f.read()
1935	    yaml_obj = yaml.safe_load(yaml_content)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/kubernetes/utils.py:1962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1961	    with open(cluster_yaml_path, 'r', encoding='utf-8') as f:
1962	        yaml_content = f.read()
1963	    yaml_obj = yaml.safe_load(yaml_content)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/instance.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
74	            # 127.0.0.1, as private IP is not critical for single-node case.
75	            return '127.0.0.1'
76	        msg = f'Failed to retrieve private IP for instance {instance_info}.'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	CREDENTIALS_PATH = '~/.lambda_cloud/lambda_keys'
13	API_ENDPOINT = 'https://cloud.lambdalabs.com/api/v1'
14	INITIAL_BACKOFF_SECONDS = 10

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	            metadata = json.load(f)
40	        return metadata.get(instance_id)
41	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	        resp_json = response.json()
89	        code = resp_json.get('error', {}).get('code')
90	        message = resp_json.get('error', {}).get('message')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	        resp_json = response.json()
89	        code = resp_json.get('error', {}).get('code')
90	        message = resp_json.get('error', {}).get('message')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	        code = resp_json.get('error', {}).get('code')
90	        message = resp_json.get('error', {}).get('message')
91	    except json.decoder.JSONDecodeError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	        code = resp_json.get('error', {}).get('code')
90	        message = resp_json.get('error', {}).get('message')
91	    except json.decoder.JSONDecodeError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	        if method == 'get':
107	            response = requests.get(url, headers=headers)
108	        elif method == 'post':

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
108	        elif method == 'post':
109	            response = requests.post(url, headers=headers, data=data)
110	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	        )
177	        return response.json().get('data', []).get('instance_ids', [])
178	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	        )
177	        return response.json().get('data', []).get('instance_ids', [])
178	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
187	        )
188	        return response.json().get('data', []).get('terminated_instances', [])
189	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
187	        )
188	        return response.json().get('data', []).get('terminated_instances', [])
189	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
194	                                             headers=self.headers)
195	        return response.json().get('data', [])
196	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	                                             headers=self.headers)
202	        return response.json().get('data', [])
203	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	            k for k in self.list_ssh_keys()
216	            if k.get('name', '').startswith(prefix)
217	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
224	        for key_info in candidate_keys:
225	            name = key_info.get('name', '')
226	            if key_info.get('public_key', '').strip() == pub_key.strip():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	            name = key_info.get('name', '')
226	            if key_info.get('public_key', '').strip() == pub_key.strip():
227	                # Pub key already exists. Use strip to avoid whitespace diffs.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/lambda_cloud/lambda_utils.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	                                             headers=self.headers)
247	        return response.json().get('data', [])

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/metadata_utils.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
115	    logger.debug(f'Remove metadata of cluster {cluster_name}.')
116	    shutil.rmtree(dirname, ignore_errors=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/paperspace/utils.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	CREDENTIALS_PATH = '~/.paperspace/config.json'
17	API_ENDPOINT = 'https://api.paperspace.com/v1'
18	INITIAL_BACKOFF_SECONDS = 10

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/paperspace/utils.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	        resp_json = response.json()
37	        code = resp_json.get('code')
38	        message = resp_json.get('message')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/paperspace/utils.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	        code = resp_json.get('code')
38	        message = resp_json.get('message')
39	    except json.decoder.JSONDecodeError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/paperspace/utils.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	        if method == 'get':
56	            response = requests.get(url, headers=headers, params=data)
57	        elif method == 'post':

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/paperspace/utils.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
57	        elif method == 'post':
58	            response = requests.post(url, headers=headers, data=data)
59	        elif method == 'put':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/paperspace/utils.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	        script = (
123	            'if ! command -v docker &> /dev/null; then \n'
124	            'apt-get update \n'
125	            'apt-get install -y ca-certificates curl \n'
126	            'install -m 0755 -d /etc/apt/keyrings \n'
127	            'curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc \n'  # pylint: disable=line-too-long
128	            'chmod a+r /etc/apt/keyrings/docker.asc \n'
129	            'echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n'  # pylint: disable=line-too-long
130	            '$(. /etc/os-release && echo "$VERSION_CODENAME") stable" | \\\n'
131	            'tee /etc/apt/sources.list.d/docker.list > /dev/null \n'
132	            'apt-get update \n'
133	            'apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin \n'  # pylint: disable=line-too-long
134	            'fi \n'
135	            # TODO(tian): Maybe remove this as well since we are now adding
136	            # users to docker group in the DockerInitializer. Need to test.
137	            'usermod -aG docker paperspace \n'
138	            f'echo "{public_key}" >> /home/paperspace/.ssh/authorized_keys \n')
139	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/paperspace/utils.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	                'templateId':
207	                    constants.INSTANCE_TO_TEMPLATEID.get(instance_type),
208	                'publicIpType': 'dynamic',

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/provisioner.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
287	        with socket.create_connection((ip, ssh_port), timeout=1) as s:
288	            if s.recv(100).startswith(b'SSH'):
289	                # Wait for SSH being actually ready, otherwise we may get the

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/provisioner.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
388	        ssh_port = ssh_ports.popleft()
389	        _retry_ssh_thread((ip, ssh_port))
390	    subprocess_utils.run_in_parallel(_retry_ssh_thread,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/runpod/utils.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
280	    # Use base64 to deal with the tricky quoting issues caused by runpod API.
281	    encoded = base64.b64encode(setup_cmd.encode('utf-8')).decode('utf-8')
282	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/runpod/utils.py:281
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
280	    # Use base64 to deal with the tricky quoting issues caused by runpod API.
281	    encoded = base64.b64encode(setup_cmd.encode('utf-8')).decode('utf-8')
282	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/common/cls_api_helper.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
191	                    context = ssl._create_unverified_context()  # pylint: disable=protected-access
192	                    urllib2.urlopen(request, context=context)
193	                else:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/common/cls_api_helper.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
195	                    # before 2.7.9 don't support it.
196	                    urllib2.urlopen(request)
197	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/common/cls_api_helper.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
223	                context = ssl._create_unverified_context()  # pylint: disable=protected-access
224	                response = urllib2.urlopen(  # pylint: disable=consider-using-with
225	                    url=download_info.download_endpoint.uri,
226	                    context=context)
227	            else:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/common/cls_api_helper.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
229	                # before 2.7.9 don't support it.
230	                response = urllib2.urlopen(download_info.download_endpoint.uri)  # pylint: disable=consider-using-with
231	            file_path = os.path.join(directory, file_info.name)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/common/cls_api_helper.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
232	            with open(file_path, 'wb') as local_file:
233	                local_file.write(response.read())
234	            downloaded_files_map[file_info.name] = file_path

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/common/cls_api_helper.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
232	            with open(file_path, 'wb') as local_file:
233	                local_file.write(response.read())
234	            downloaded_files_map[file_info.name] = file_path

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/common/cls_api_helper.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
232	            with open(file_path, 'wb') as local_file:
233	                local_file.write(response.read())
234	            downloaded_files_map[file_info.name] = file_path

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/common/vapiconnect.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    # of the vCenter system.
13	    return 'https://{}/api'.format(host)
14	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/instance.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
310	    with open(ssh_key_path, 'r', encoding='utf-8') as f:
311	        ssh_public_key = f.read()
312	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/vsphere_utils.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
324	    with open(credential_path, 'r', encoding='utf-8') as file:
325	        credential = yaml.safe_load(file)
326	        vcenters = credential['vcenters']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/vsphere_utils.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
340	    with open(vms_csv_path, 'w', encoding='utf-8') as f:
341	        f.write(vsphere_catalog.VSPHERE_CATALOG_HEADER + '\n')
342	    images_csv_path = get_catalog_path('vsphere/images.csv')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/vsphere_utils.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
343	    with open(images_csv_path, 'w', encoding='utf-8') as f:
344	        f.write('ImageID,vCenter,CPU,Memory,OS,OSVersion,GpuTags\n')
345	    hosts_csv_path = get_catalog_path('vsphere/hosts.csv')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/vsphere_utils.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
346	    with open(hosts_csv_path, 'w', encoding='utf-8') as f:
347	        f.write(
348	            'HostName,MobID,vCenter,Datacenter,Cluster,TotalCPUs,AvailableCPUs,'
349	            'TotalMemory(MB),AvailableMemory(MB),GPU,cpuMhz,UUID\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/provision/vsphere/vsphere_utils.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
352	    with open(instance_image_mapping_csv_path, 'w', encoding='utf-8') as f:
353	        f.write('InstanceType,ImageID,vCenter\n')
354	    skip_key = 'skip_verification'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/controller.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
231	
232	        threading.Thread(target=self._run_autoscaler).start()
233	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/core.py:810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
809	    if threading.current_thread() is threading.main_thread():
810	        signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
811	        signal.signal(signal.SIGTSTP, backend_utils.stop_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/core.py:810
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
809	    if threading.current_thread() is threading.main_thread():
810	        signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
811	        signal.signal(signal.SIGTSTP, backend_utils.stop_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/core.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
810	        signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
811	        signal.signal(signal.SIGTSTP, backend_utils.stop_handler)
812	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/core.py:811
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
810	        signal.signal(signal.SIGINT, backend_utils.interrupt_handler)
811	        signal.signal(signal.SIGTSTP, backend_utils.stop_handler)
812	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/load_balancer.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
151	                                   query=request.url.query.encode('utf-8'))
152	            proxy_request = client.build_request(
153	                request.method,
154	                worker_url,
155	                headers=request.headers.raw,
156	                content=await request.body(),
157	                timeout=constants.LB_STREAM_TIMEOUT)
158	            proxy_response = await client.send(proxy_request, stream=True)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/load_balancer.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
248	        uvicorn.run(self._app,
249	                    host='0.0.0.0',
250	                    port=self._load_balancer_port,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/load_balancer.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
279	                        required=True,
280	                        default='127.0.0.1',
281	                        help='The address of the controller.')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	    if resource_override is not None:
185	        use_spot_override = resource_override.get('use_spot')
186	        if use_spot_override is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
441	            return None
442	        endpoint = endpoint_dict.get(replica_port_int, None)
443	        if not endpoint:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
477	        info_dict = self.to_info_dict(
478	            with_handle=env_options.Options.SHOW_DEBUG_INFO.get())
479	        handle_str = ''

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
519	                msg += 'POST'
520	                response = requests.post(readiness_path,
521	                                         json=post_data,
522	                                         headers=headers,
523	                                         timeout=timeout)
524	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
525	                msg += 'GET'
526	                response = requests.get(readiness_path,
527	                                        headers=headers,
528	                                        timeout=timeout)
529	            msg += (f' request to {replica_identity} returned status '

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
634	
635	        threading.Thread(target=self._process_pool_refresher).start()
636	        threading.Thread(target=self._job_status_fetcher).start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
635	        threading.Thread(target=self._process_pool_refresher).start()
636	        threading.Thread(target=self._job_status_fetcher).start()
637	        threading.Thread(target=self._replica_prober).start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
636	        threading.Thread(target=self._job_status_fetcher).start()
637	        threading.Thread(target=self._replica_prober).start()
638	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
656	            self._service_name, replica_id)
657	        p = multiprocessing.Process(
658	            target=ux_utils.RedirectOutputForProcess(
659	                launch_cluster,
660	                log_file_name,
661	            ).run,
662	            args=(replica_id, self._task_yaml_path, cluster_name,
663	                  resources_override),
664	        )

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
657	        p = multiprocessing.Process(
658	            target=ux_utils.RedirectOutputForProcess(
659	                launch_cluster,
660	                log_file_name,
661	            ).run,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
719	                          encoding='utf-8') as launch_file:
720	                replica_log_file.write(launch_file.read())
721	            os.remove(launch_log_file_name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
719	                          encoding='utf-8') as launch_file:
720	                replica_log_file.write(launch_file.read())
721	            os.remove(launch_log_file_name)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
743	                              encoding='utf-8') as job_file:
744	                    replica_log_file.write(job_file.read())
745	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
743	                              encoding='utf-8') as job_file:
744	                    replica_log_file.write(job_file.read())
745	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
747	                          encoding='utf-8') as replica_log_file:
748	                    replica_log_file.write(
749	                        f'Failed to sync down job logs from replica'
750	                        f' {replica_id}.\n')
751	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
761	                    f'replica_id: {replica_id}')
762	        p = multiprocessing.Process(
763	            target=ux_utils.RedirectOutputForProcess(terminate_cluster,
764	                                                     log_file_name, 'a').run,
765	            args=(info.cluster_name, replica_drain_delay_seconds),
766	        )

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
762	        p = multiprocessing.Process(
763	            target=ux_utils.RedirectOutputForProcess(terminate_cluster,
764	                                                     log_file_name, 'a').run,
765	            args=(info.cluster_name, replica_drain_delay_seconds),

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:1037
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
1036	        replica_to_probe = []
1037	        with mp_pool.ThreadPool() as pool:
1038	            infos = serve_state.get_replica_infos(self._service_name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1060	            for future in probe_futures:
1061	                future_result: Tuple[ReplicaInfo, bool, float] = future.get()
1062	                info, probe_succeeded, probe_time = future_result

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:1193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1192	        # are not empty.
1193	        if new_config.get('file_mounts', None) != {}:
1194	            return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/replica_managers.py:1211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1210	                if (old_config == new_config and
1211	                        old_config.get('file_mounts', None) == {}):
1212	                    logger.info(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	                         constants.CONTROLLER_MEMORY_USAGE_GB)
48	_CONTROLLER_URL = 'http://localhost:{CONTROLLER_PORT}'
49	
50	# NOTE(dev): We assume log paths are either in ~/sky_logs/... or ~/.sky/...
51	# and always appear after a space. Be careful when changing UX as this
52	# assumption is used to expand some log files while ignoring others.
53	_SKYPILOT_LOG_DIRS = r'~/(sky_logs|\.sky)'

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
328	    controller_port = service_status['controller_port']
329	    resp = requests.post(
330	        _CONTROLLER_URL.format(CONTROLLER_PORT=controller_port) +
331	        '/controller/update_service',
332	        json={
333	            'version': version,
334	            'mode': mode,
335	        })

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
370	    controller_port = service_status['controller_port']
371	    resp = requests.post(
372	        _CONTROLLER_URL.format(CONTROLLER_PORT=controller_port) +
373	        '/controller/terminate_replica',
374	        json={
375	            'replica_id': replica_id,
376	            'purge': purge,
377	        })

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
420	        service_statuses.append({
421	            k: base64.b64encode(pickle.dumps(v)).decode('utf-8')
422	            for k, v in service_status.items()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:421
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
420	        service_statuses.append({
421	            k: base64.b64encode(pickle.dumps(v)).decode('utf-8')
422	            for k, v in service_status.items()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
431	        service_statuses.append({
432	            k: pickle.loads(base64.b64decode(v))
433	            for k, v in service_status.items()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:432
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
431	        service_statuses.append({
432	            k: pickle.loads(base64.b64decode(v))
433	            for k, v in service_status.items()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
472	        generate_remote_service_dir_name(service_name))
473	    shutil.rmtree(service_dir)
474	    serve_state.remove_service(service_name)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
531	                with signal_file.open(mode='w', encoding='utf-8') as f:
532	                    f.write(UserSignal.TERMINATE.value)
533	                    f.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
585	                      encoding='utf-8') as f:
586	                log_content = f.read()
587	            with ux_utils.print_exception_no_traceback():

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
711	        with open(log_file_name, 'r', encoding='utf-8') as f:
712	            print(f.read(), flush=True)
713	        return ''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
819	    try:
820	        endpoint = backend_utils.get_endpoints(handle.cluster_name,
821	                                               load_balancer_port).get(
822	                                                   load_balancer_port, None)
823	    except exceptions.ClusterNotUpError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/serve_utils.py:906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
905	    for record in replica_records:
906	        endpoint = record.get('endpoint', '-')
907	        service_name = record['service_name']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/service.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	            with signal_file.open(mode='r', encoding='utf-8') as f:
47	                user_signal_text = f.read().strip()
48	                try:

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/service.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
92	    for info in replica_infos:
93	        p = multiprocessing.Process(target=replica_managers.terminate_cluster,
94	                                    args=(info.cluster_name,))
95	        p.start()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/service.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
199	                if 'KUBERNETES_SERVICE_HOST' in os.environ:
200	                    return '0.0.0.0'
201	                # Not using localhost to avoid using ipv6 address and causing

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/service.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
204	                # ('::1', 20001, 0, 0): cannot assign requested address
205	                return '127.0.0.1'
206	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/service.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
209	            # Start the controller.
210	            controller_process = multiprocessing.Process(
211	                target=controller.run_controller,
212	                args=(service_name, service_spec, task_yaml, controller_host,
213	                      controller_port))
214	            controller_process.start()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/service.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
229	            # After that, we will have a mapping from replica port to endpoint.
230	            load_balancer_process = multiprocessing.Process(
231	                target=ux_utils.RedirectOutputForProcess(
232	                    load_balancer.run_load_balancer,
233	                    load_balancer_log_file).run,
234	                args=(controller_addr, load_balancer_port, policy_name,
235	                      service_spec.tls_credential))
236	            load_balancer_process.start()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/service.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
230	            load_balancer_process = multiprocessing.Process(
231	                target=ux_utils.RedirectOutputForProcess(
232	                    load_balancer.run_load_balancer,
233	                    load_balancer_log_file).run,
234	                args=(controller_addr, load_balancer_port, policy_name,

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/serve/service.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
262	        else:
263	            shutil.rmtree(service_dir)
264	            serve_state.remove_service(service_name)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
44	
45	system = platform.system()
46	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
44	
45	system = platform.system()
46	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
44	
45	system = platform.system()
46	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
53	        version_match = re.search(r'^__version__ = [\'"]([^\'"]*)[\'"]',
54	                                  fp.read(), re.M)
55	        if version_match:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	        commit_match = re.search(r'^_SKYPILOT_COMMIT_SHA = [\'"]([^\'"]*)[\'"]',
63	                                 fp.read(), re.M)
64	        if commit_match:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
97	        with open(INIT_FILE_PATH, 'r', encoding='utf-8') as fp:
98	            content = fp.read()
99	            global original_init_content

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
105	        with open(INIT_FILE_PATH, 'w', encoding='utf-8') as fp:
106	            fp.write(content)
107	    except Exception as e:  # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
118	            with open(INIT_FILE_PATH, 'w', encoding='utf-8') as fp:
119	                fp.write(original_init_content)
120	    except Exception as e:  # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	if os.path.exists(readme_filepath):
147	    long_description = io.open(readme_filepath, 'r', encoding='utf-8').read()
148	    long_description = parse_readme(long_description)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
185	    project_urls={
186	        'Homepage': 'https://github.com/skypilot-org/skypilot',
187	        'Issues': 'https://github.com/skypilot-org/skypilot/issues',
188	        'Discussion': 'https://github.com/skypilot-org/skypilot/discussions',
189	        'Documentation': 'https://docs.skypilot.co/',
190	    },
191	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	        'Homepage': 'https://github.com/skypilot-org/skypilot',
187	        'Issues': 'https://github.com/skypilot-org/skypilot/issues',
188	        'Discussion': 'https://github.com/skypilot-org/skypilot/discussions',
189	        'Documentation': 'https://docs.skypilot.co/',
190	    },
191	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
187	        'Issues': 'https://github.com/skypilot-org/skypilot/issues',
188	        'Discussion': 'https://github.com/skypilot-org/skypilot/discussions',
189	        'Documentation': 'https://docs.skypilot.co/',
190	    },
191	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/setup_files/setup.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	        'Discussion': 'https://github.com/skypilot-org/skypilot/discussions',
189	        'Documentation': 'https://docs.skypilot.co/',
190	    },
191	)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/attempt_skylet.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
31	    with open(VERSION_FILE, 'w', encoding='utf-8') as v_f:
32	        v_f.write(constants.SKYLET_VERSION)
33	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/attempt_skylet.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
45	    with open(VERSION_FILE, 'r', encoding='utf-8') as f:
46	        found_version = f.read().strip()
47	        if found_version == constants.SKYLET_VERSION:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/constants.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	# This won't reinstall uv if it's already installed, so it's safe to re-run.
60	SKY_UV_INSTALL_CMD = (f'{SKY_UV_CMD} -V >/dev/null 2>&1 || '
61	                      'curl -LsSf https://astral.sh/uv/install.sh '
62	                      f'| UV_INSTALL_DIR={SKY_UV_INSTALL_DIR} sh')
63	SKY_UV_PIP_CMD = f'VIRTUAL_ENV={SKY_REMOTE_PYTHON_ENV} {SKY_UV_CMD} pip'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/constants.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	CONDA_INSTALLATION_COMMANDS = (
140	    'which conda > /dev/null 2>&1 || '
141	    '{ curl https://repo.anaconda.com/miniconda/Miniconda3-py310_23.11.0-2-Linux-x86_64.sh -o Miniconda3-Linux-x86_64.sh && '  # pylint: disable=line-too-long
142	    # We do not use && for installation of conda and the following init commands
143	    # because for some images, conda is already installed, but not initialized.
144	    # In this case, we need to initialize conda and set auto_activate_base to
145	    # true.
146	    '{ bash Miniconda3-Linux-x86_64.sh -b; '
147	    'eval "$(~/miniconda3/bin/conda shell.bash hook)" && conda init && '
148	    # Caller should replace {conda_auto_activate} with either true or false.
149	    'conda config --set auto_activate_base {conda_auto_activate} && '
150	    'conda activate base; }; }; '
151	    'grep "# >>> conda initialize >>>" ~/.bashrc || '
152	    '{ conda init && source ~/.bashrc; };'
153	    # If Python version is larger then equal to 3.12, create a new conda env
154	    # with Python 3.10.
155	    # We don't use a separate conda env for SkyPilot dependencies because it is
156	    # costly to create a new conda env, and venv should be a lightweight and
157	    # faster alternative when the python version satisfies the requirement.
158	    '[[ $(python3 --version | cut -d " " -f 2 | cut -d "." -f 2) -ge 12 ]] && '
159	    'echo "Creating conda env with Python 3.10" && '
160	    f'conda create -y -n {SKY_REMOTE_PYTHON_ENV_NAME} python=3.10 && '
161	    f'conda activate {SKY_REMOTE_PYTHON_ENV_NAME};'
162	    # Install uv for venv management and pip installation.
163	    f'{SKY_UV_INSTALL_CMD};'
164	    # Create a separate conda environment for SkyPilot dependencies.
165	    f'[ -d {SKY_REMOTE_PYTHON_ENV} ] || '
166	    # Do NOT use --system-site-packages here, because if users upgrade any
167	    # packages in the base env, they interfere with skypilot dependencies.
168	    # Reference: https://github.com/skypilot-org/skypilot/issues/4097
169	    # --seed will include pip and setuptools, which are present in venvs created
170	    # with python -m venv.
171	    f'{SKY_UV_CMD} venv --seed {SKY_REMOTE_PYTHON_ENV};'
172	    f'echo "$(echo {SKY_REMOTE_PYTHON_ENV})/bin/python" > {SKY_PYTHON_PATH_FILE};'
173	)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/events.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
277	        with open(yaml_path, 'r', encoding='utf-8') as f:
278	            yaml_str = f.read()
279	        yaml_str = self._UPSCALING_PATTERN.sub(r'upscaling_speed: 0', yaml_str)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/job_lib.py:810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
809	    return job_submission.JobSubmissionClient(
810	        address=f'http://127.0.0.1:{port}')
811	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/job_lib.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
813	def _make_ray_job_id(sky_job_id: int) -> str:
814	    return f'{sky_job_id}-{getpass.getuser()}'
815	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/job_lib.py:814
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
813	def _make_ray_job_id(sky_job_id: int) -> str:
814	    return f'{sky_job_id}-{getpass.getuser()}'
815	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/log_lib.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	                if args.log_path != '/dev/null':
107	                    fout.write(line)
108	                    fout.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/log_lib.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
106	                if args.log_path != '/dev/null':
107	                    fout.write(line)
108	                    fout.flush()

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/log_lib.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
120	        # but it introduces buffering making the output not streaming.
121	        with multiprocessing.pool.ThreadPool(processes=1) as pool:
122	            err_args = copy.copy(args)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/log_lib.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
284	        bash_command = make_task_bash_script(bash_command, env_vars=env_vars)
285	        fp.write(bash_command)
286	        fp.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/log_lib.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
284	        bash_command = make_task_bash_script(bash_command, env_vars=env_vars)
285	        fp.write(bash_command)
286	        fp.flush()

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/node_provider.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
128	        else:
129	            name = socket.gethostname()  # returns the instance's (VSI) name
130	            logger.debug(f"Check if {name} is HEAD")

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/node_provider.py:129
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
128	        else:
129	            name = socket.gethostname()  # returns the instance's (VSI) name
130	            logger.debug(f"Check if {name} is HEAD")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/node_provider.py:782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
781	        if count:
782	            with cf.ThreadPoolExecutor(count) as ex:
783	                for _ in range(count):

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/node_provider.py:842
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
841	            # with its associated resources.
842	            hostname = socket.gethostname()  # returns the instance's (VSI) name
843	            if self._get_node_type(hostname) == NODE_KIND_HEAD:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/node_provider.py:842
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
841	            # with its associated resources.
842	            hostname = socket.gethostname()  # returns the instance's (VSI) name
843	            if self._get_node_type(hostname) == NODE_KIND_HEAD:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/node_provider.py:886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
885	        futures = []
886	        with cf.ThreadPoolExecutor(len(node_ids)) as ex:
887	            for node_id in node_ids:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/vpc_provider.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	                subnet_id = subnet_in_zone["id"]
84	                public_gateway = subnet_in_zone.get("public_gateway")
85	                if not public_gateway:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/vpc_provider.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	            # add missing security group rules if needed
98	            security_group = reused_vpc_data.get("default_security_group")
99	            if security_group:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/vpc_provider.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
314	            ).get_result()
315	            floating_ips = res.get("floating_ips", [])
316	            for ip in floating_ips:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/vpc_provider.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
329	            instances = res["instances"]
330	            with ThreadPoolExecutor(num_instances) as ex:
331	                for i in range(num_instances):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/vpc_provider.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
437	                # rule regards private traffic within the VSIs associated with the security group
438	                elif rule["remote"].get("id") == sg["id"]:
439	                    # validate that inbound traffic inside group available

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/vpc_provider.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
504	    function_code = textwrap.dedent(
505	        """
506	    import subprocess
507	    import time

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/vpc_provider.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
694	
695	            res = requests.post(
696	                self.cf_namespaces_url, headers=self.get_headers(), json=data
697	            ).json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/vpc_provider.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
708	
709	            res = requests.get(
710	                f"{self.cf_namespaces_url}?limit=200&offset={offset}",
711	                headers=self.get_headers(),
712	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/vpc_provider.py:779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
778	
779	        res = requests.get(
780	            f"{self.cf_namespaces_url}/{namespace_id}/actions?limit=200",
781	            headers=self.get_headers(),
782	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skylet/providers/ibm/vpc_provider.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
819	        }
820	        res = requests.post(
821	            f"{self.cf_namespaces_url}/{namespace_id}/actions/{self.action_name}?blocking=true",
822	            headers=self.get_headers(),
823	            data=json.dumps(payload),
824	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/skypilot_config.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	                schemas.get_config_schema(),
240	                f'Invalid config YAML ({config_path}). See: '
241	                'https://docs.skypilot.co/en/latest/reference/config.html. '  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/usage/constants.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	
3	LOG_URL = 'http://usage.skypilot.co:9090/loki/api/v1/push'  # pylint: disable=line-too-long
4	
5	USAGE_MESSAGE_SCHEMA_VERSION = 1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/usage/usage_lib.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
291	                  encoding='utf-8') as f:
292	            properties['run_id'] = f.read().strip()
293	        return properties

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/usage/usage_lib.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	    """Send the message to the Grafana Loki."""
331	    if env_options.Options.DISABLE_LOGGING.get():
332	        return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/usage/usage_lib.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
344	    environment = 'prod'
345	    if env_options.Options.IS_DEVELOPER.get():
346	        environment = 'dev'

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/usage/usage_lib.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
363	    payload = json.dumps(payload)
364	    response = requests.post(constants.LOG_URL,
365	                             data=payload,
366	                             headers=headers,
367	                             timeout=0.5)
368	    if response.status_code != 204:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/usage/usage_lib.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
460	    privacy_policy_indicator = os.path.expanduser(constants.PRIVACY_POLICY_PATH)
461	    if not env_options.Options.DISABLE_LOGGING.get():
462	        os.makedirs(os.path.dirname(privacy_policy_indicator), exist_ok=True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/usage/usage_lib.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
473	        messages.usage.update_entrypoint(name)
474	    if env_options.Options.DISABLE_LOGGING.get() or not is_entry:
475	        yield

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
94	            # Remove invalid characters.
95	            user_hash = f.read().strip()
96	        if _is_valid_user_hash(user_hash):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
110	        with open(_USER_HASH_FILE, 'w', encoding='utf-8') as f:
111	            f.write(user_hash)
112	    return user_hash

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
296	    """
297	    hostname_hash = hashlib.md5(socket.gethostname().encode()).hexdigest()[-4:]
298	    return f'{getpass.getuser()}-{hostname_hash}'

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:297
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
296	    """
297	    hostname_hash = hashlib.md5(socket.gethostname().encode()).hexdigest()[-4:]
298	    return f'{getpass.getuser()}-{hostname_hash}'

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
297	    hostname_hash = hashlib.md5(socket.gethostname().encode()).hexdigest()[-4:]
298	    return f'{getpass.getuser()}-{hostname_hash}'
299	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:298
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
297	    hostname_hash = hashlib.md5(socket.gethostname().encode()).hexdigest()[-4:]
298	    return f'{getpass.getuser()}-{hostname_hash}'
299	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
319	    with open(path, 'w', encoding='utf-8') as f:
320	        f.write(dump_yaml_str(config))
321	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:522
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
521	    for port in range(start_port, 65535):
522	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
523	            try:

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
625	    """
626	    username = username or getpass.getuser()
627	    username = username.lower()

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:626
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
625	    """
626	    username = username or getpass.getuser()
627	    username = username.lower()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
643	    with open(template_path, 'r', encoding='utf-8') as fin:
644	        template = fin.read()
645	    output_path = os.path.abspath(os.path.expanduser(output_path))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/common_utils.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
651	    with open(output_path, 'w', encoding='utf-8') as fout:
652	        fout.write(content)
653	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/controller_utils.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
237	            commands.append(
238	                f'echo -en "\\r{step_prefix}Kubernetes{empty_str}" && '
239	                # Install k8s + skypilot dependencies

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/controller_utils.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
256	            commands.append(
257	                f'echo -en "\\r{step_prefix}cudoctl{empty_str}" && '
258	                'wget https://download.cudo.org/compute/cudoctl-0.3.2-amd64.deb -O ~/cudoctl.deb > /dev/null 2>&1 && '  # pylint: disable=line-too-long

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/controller_utils.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
422	        # running in a container.
423	        constants.USER_ENV_VAR: getpass.getuser(),
424	        constants.USER_ID_ENV_VAR: common_utils.get_user_hash(),

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/controller_utils.py:423
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
422	        # running in a container.
423	        constants.USER_ENV_VAR: getpass.getuser(),
424	        constants.USER_ID_ENV_VAR: common_utils.get_user_hash(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/gpu_labeler.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	                  f'{str(e)}')
115	            print('Continuing without using nvidia RuntimeClass. '
116	                  'This may fail on K3s clusters. '

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	    if terminated:
81	        sys.stdout.write('[SSH Key Reloader] Terminated.\n')
82	        return True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
91	                                    shell=True)
92	            sys.stdout.write(
93	                '[SSH Key Reloader] No keys changed, continuing.\n')
94	        except subprocess.CalledProcessError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
95	            if e.returncode == 1:
96	                sys.stdout.write(
97	                    '[SSH Key Reloader] Changes detected, reloading.\n')
98	                subprocess.check_output(f'mv {tmpfile} ~/.ssh/authorized_keys',

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
102	    except Exception as e:
103	        sys.stdout.write(
104	            f'[SSH Key Reloader][ERROR] Failed to reload SSH keys: {e}\n')
105	        raise

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
124	    except Exception as e:
125	        sys.stdout.write('[Lifecycle] [ERROR] listing pods failed with '
126	                         f'error: {e}\n')
127	        raise

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
129	    if not ret.items:
130	        sys.stdout.write(
131	            f'[Lifecycle] Did not find pods with label '
132	            f'"{label_selector}" in namespace {current_namespace}\n')
133	        nocluster_delta = nocluster_delta + retry_interval_delta

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
133	        nocluster_delta = nocluster_delta + retry_interval_delta
134	        sys.stdout.write(
135	            f'[Lifecycle] Time since no pods found: {nocluster_delta}, alert '
136	            f'threshold: {alert_delta}\n')
137	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
137	    else:
138	        sys.stdout.write(
139	            f'[Lifecycle] Found pods with label "{label_selector}" in '
140	            f'namespace {current_namespace}\n')
141	        # reset ..

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
142	        nocluster_delta = datetime.timedelta()
143	        sys.stdout.write(
144	            f'[Lifecycle] nocluster_delta is reset: {nocluster_delta}\n')
145	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
146	    if nocluster_delta >= alert_delta:
147	        sys.stdout.write(
148	            f'[Lifecycle] nocluster_delta: {nocluster_delta} crossed alert '
149	            f'threshold: {alert_delta}. Time to terminate myself and my '
150	            'service.\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	        except Exception as e:
156	            sys.stdout.write('[Lifecycle][ERROR] Deletion failed. Exiting '
157	                             f'poll() with error: {e}\n')
158	            raise

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	def main():
165	    sys.stdout.write('SkyPilot SSH Jump Pod Lifecycle Manager\n')
166	    sys.stdout.write(f'current_name: {current_name}\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
165	    sys.stdout.write('SkyPilot SSH Jump Pod Lifecycle Manager\n')
166	    sys.stdout.write(f'current_name: {current_name}\n')
167	    sys.stdout.write(f'current_namespace: {current_namespace}\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
166	    sys.stdout.write(f'current_name: {current_name}\n')
167	    sys.stdout.write(f'current_namespace: {current_namespace}\n')
168	    sys.stdout.write(f'alert_threshold time: {alert_threshold}\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
167	    sys.stdout.write(f'current_namespace: {current_namespace}\n')
168	    sys.stdout.write(f'alert_threshold time: {alert_threshold}\n')
169	    sys.stdout.write(f'retry_interval time: {retry_interval}\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	    sys.stdout.write(f'alert_threshold time: {alert_threshold}\n')
169	    sys.stdout.write(f'retry_interval time: {retry_interval}\n')
170	    sys.stdout.write(f'reload_interval time: {reload_interval}\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
169	    sys.stdout.write(f'retry_interval time: {retry_interval}\n')
170	    sys.stdout.write(f'reload_interval time: {reload_interval}\n')
171	    sys.stdout.write(f'label_selector: {label_selector}\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	    sys.stdout.write(f'reload_interval time: {reload_interval}\n')
171	    sys.stdout.write(f'label_selector: {label_selector}\n')
172	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
178	    threads = [
179	        threading.Thread(target=manage_lifecycle),
180	        threading.Thread(target=reload_keys)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
179	        threading.Thread(target=manage_lifecycle),
180	        threading.Thread(target=reload_keys)
181	    ]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
181	    ]
182	    sys.stdout.write(f'Polling with {len(threads)} threads.\n')
183	    for t in threads:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/kubernetes/ssh_jump_lifecycle_manager.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
186	        t.join()
187	    sys.stdout.write('Done.\n')
188	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/schemas.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    return {
42	        '$schema': 'https://json-schema.org/draft/2020-12/schema',
43	        'type': 'object',
44	        'required': [],
45	        'additionalProperties': False,
46	        'properties': {
47	            'cloud': {
48	                'type': 'string',
49	                'case_insensitive_enum': list(service_catalog.ALL_CLOUDS)
50	            },
51	            'region': {
52	                'type': 'string',
53	            },
54	            'zone': {
55	                'type': 'string',
56	            },
57	            'cpus': {
58	                'anyOf': [{
59	                    'type': 'string',
60	                }, {
61	                    'type': 'number',
62	                }],
63	            },
64	            'memory': {
65	                'anyOf': [{
66	                    'type': 'string',
67	                }, {
68	                    'type': 'number',
69	                }],
70	            },
71	            'accelerators': {
72	                'anyOf': [{
73	                    'type': 'string',
74	                }, {
75	                    'type': 'object',
76	                    'required': [],
77	                    'maxProperties': 1,
78	                    'additionalProperties': {
79	                        'type': 'number'
80	                    }
81	                }]
82	            },
83	            'instance_type': {
84	                'type': 'string',
85	            },
86	            'use_spot': {
87	                'type': 'boolean',
88	            },
89	            'job_recovery': {
90	                # Either a string or a dict.
91	                'anyOf': [{
92	                    'type': 'string',
93	                }, {
94	                    'type': 'object',
95	                    'required': [],
96	                    'additionalProperties': False,
97	                    'properties': {
98	                        'strategy': {
99	                            'anyOf': [{
100	                                'type': 'string',
101	                            }, {
102	                                'type': 'null',
103	                            }],
104	                        },
105	                        'max_restarts_on_errors': {
106	                            'type': 'integer',
107	                            'minimum': 0,
108	                        },
109	                    }
110	                }],
111	            },
112	            'disk_size': {
113	                'type': 'integer',
114	            },
115	            'disk_tier': {
116	                'type': 'string',
117	            },
118	            'ports': {
119	                'anyOf': [{
120	                    'type': 'string',
121	                }, {
122	                    'type': 'integer',
123	                }, {
124	                    'type': 'array',
125	                    'items': {
126	                        'anyOf': [{
127	                            'type': 'string',
128	                        }, {
129	                            'type': 'integer',
130	                        }]
131	                    }
132	                }, {
133	                    'type': 'null',
134	                }],
135	            },
136	            'labels': {
137	                'type': 'object',
138	                'additionalProperties': {
139	                    'type': 'string'
140	                }
141	            },
142	            'accelerator_args': {
143	                'type': 'object',
144	                'required': [],
145	                'additionalProperties': False,
146	                'properties': {
147	                    'runtime_version': {
148	                        'type': 'string',
149	                    },
150	                    'tpu_name': {
151	                        'type': 'string',
152	                    },
153	                    'tpu_vm': {
154	                        'type': 'boolean',
155	                    }
156	                }
157	            },
158	            'image_id': {
159	                'anyOf': [{
160	                    'type': 'string',
161	                }, {
162	                    'type': 'object',
163	                    'required': [],
164	                }, {
165	                    'type': 'null',
166	                }]
167	            },
168	            # The following fields are for internal use only. Should not be
169	            # specified in the task config.
170	            '_docker_login_config': {
171	                'type': 'object',
172	                'required': ['username', 'password', 'server'],
173	                'additionalProperties': False,
174	                'properties': {
175	                    'username': {
176	                        'type': 'string',
177	                    },
178	                    'password': {
179	                        'type': 'string',
180	                    },
181	                    'server': {
182	                        'type': 'string',
183	                    }
184	                }
185	            },
186	            '_is_image_managed': {
187	                'type': 'boolean',
188	            },
189	            '_requires_fuse': {
190	                'type': 'boolean',
191	            },
192	            '_cluster_config_overrides': {
193	                'type': 'object',
194	            },
195	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/schemas.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
214	    return {
215	        '$schema': 'http://json-schema.org/draft-07/schema#',
216	        'type': 'object',
217	        'required': [],
218	        'additionalProperties': False,
219	        'properties': {
220	            **single_resources_schema,
221	            # We redefine the 'accelerators' field to allow one line list or
222	            # a set of accelerators.
223	            'accelerators': {
224	                # {'V100:1', 'A100:1'} will be
225	                # read as a string and converted to dict.
226	                'anyOf': [{
227	                    'type': 'string',
228	                }, {
229	                    'type': 'object',
230	                    'required': [],
231	                    'additionalProperties': {
232	                        'anyOf': [{
233	                            'type': 'null',
234	                        }, {
235	                            'type': 'number',
236	                        }]
237	                    }
238	                }, {
239	                    'type': 'array',
240	                    'items': {
241	                        'type': 'string',
242	                    }
243	                }]
244	            },
245	            'any_of': {
246	                'type': 'array',
247	                'items': multi_resources_schema,
248	            },
249	            'ordered': {
250	                'type': 'array',
251	                'items': multi_resources_schema,
252	            }
253	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/schemas.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
260	    return {
261	        '$schema': 'https://json-schema.org/draft/2020-12/schema',
262	        'type': 'object',
263	        'required': [],
264	        'additionalProperties': False,
265	        'properties': {
266	            'name': {
267	                'type': 'string',
268	            },
269	            'source': {
270	                'anyOf': [{
271	                    'type': 'string',
272	                }, {
273	                    'type': 'array',
274	                    'minItems': 1,
275	                    'items': {
276	                        'type': 'string'
277	                    }
278	                }]
279	            },
280	            'store': {
281	                'type': 'string',
282	                'case_insensitive_enum': [
283	                    type.value for type in storage.StoreType
284	                ]
285	            },
286	            'persistent': {
287	                'type': 'boolean',
288	            },
289	            'mode': {
290	                'type': 'string',
291	                'case_insensitive_enum': [
292	                    mode.value for mode in storage.StorageMode
293	                ]
294	            },
295	            '_is_sky_managed': {
296	                'type': 'boolean',
297	            },
298	            '_bucket_sub_path': {
299	                'type': 'string',
300	            },
301	            '_force_delete': {
302	                'type': 'boolean',
303	            }
304	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/schemas.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
313	    return {
314	        '$schema': 'https://json-schema.org/draft/2020-12/schema',
315	        'type': 'object',
316	        'required': ['readiness_probe'],
317	        'additionalProperties': False,
318	        'properties': {
319	            'readiness_probe': {
320	                'anyOf': [{
321	                    'type': 'string',
322	                }, {
323	                    'type': 'object',
324	                    'required': ['path'],
325	                    'additionalProperties': False,
326	                    'properties': {
327	                        'path': {
328	                            'type': 'string',
329	                        },
330	                        'initial_delay_seconds': {
331	                            'type': 'number',
332	                        },
333	                        'timeout_seconds': {
334	                            'type': 'number',
335	                        },
336	                        'post_data': {
337	                            'anyOf': [{
338	                                'type': 'string',
339	                            }, {
340	                                'type': 'object',
341	                            }]
342	                        },
343	                        'headers': {
344	                            'type': 'object',
345	                            'additionalProperties': {
346	                                'type': 'string'
347	                            }
348	                        },
349	                    }
350	                }]
351	            },
352	            'replica_policy': {
353	                'type': 'object',
354	                'required': ['min_replicas'],
355	                'additionalProperties': False,
356	                'properties': {
357	                    'min_replicas': {
358	                        'type': 'integer',
359	                        'minimum': 0,
360	                    },
361	                    'max_replicas': {
362	                        'type': 'integer',
363	                        'minimum': 0,
364	                    },
365	                    'target_qps_per_replica': {
366	                        'type': 'number',
367	                        'minimum': 0,
368	                    },
369	                    'dynamic_ondemand_fallback': {
370	                        'type': 'boolean',
371	                    },
372	                    'base_ondemand_fallback_replicas': {
373	                        'type': 'integer',
374	                        'minimum': 0,
375	                    },
376	                    'upscale_delay_seconds': {
377	                        'type': 'number',
378	                    },
379	                    'downscale_delay_seconds': {
380	                        'type': 'number',
381	                    },
382	                }
383	            },
384	            'ports': {
385	                'type': 'integer',
386	            },
387	            'replicas': {
388	                'type': 'integer',
389	            },
390	            'load_balancing_policy': {
391	                'type': 'string',
392	                'case_insensitive_enum': list(
393	                    load_balancing_policies.LB_POLICIES.keys())
394	            },
395	            'tls': {
396	                'type': 'object',
397	                'required': ['keyfile', 'certfile'],
398	                'additionalProperties': False,
399	                'properties': {
400	                    'keyfile': {
401	                        'type': 'string',
402	                    },
403	                    'certfile': {
404	                        'type': 'string',
405	                    },
406	                },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/schemas.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
481	    return {
482	        '$schema': 'https://json-schema.org/draft/2020-12/schema',
483	        'type': 'object',
484	        'required': [],
485	        'additionalProperties': False,
486	        'properties': {
487	            'name': {
488	                'type': 'string',
489	            },
490	            'workdir': {
491	                'type': 'string',
492	            },
493	            'event_callback': {
494	                'type': 'string',
495	            },
496	            'num_nodes': {
497	                'type': 'integer',
498	            },
499	            # resources config is validated separately using RESOURCES_SCHEMA
500	            'resources': {
501	                'type': 'object',
502	            },
503	            # storage config is validated separately using STORAGE_SCHEMA
504	            'file_mounts': {
505	                'type': 'object',
506	            },
507	            # service config is validated separately using SERVICE_SCHEMA
508	            'service': {
509	                'type': 'object',
510	            },
511	            'setup': {
512	                'type': 'string',
513	            },
514	            'run': {
515	                'type': 'string',
516	            },
517	            'envs': {
518	                'type': 'object',
519	                'required': [],
520	                'patternProperties': {
521	                    # Checks env keys are valid env var names.
522	                    '^[a-zA-Z_][a-zA-Z0-9_]*$': {
523	                        'type': ['string', 'null']
524	                    }
525	                },
526	                'additionalProperties': False,
527	            },
528	            # inputs and outputs are experimental
529	            'inputs': {
530	                'type': 'object',
531	                'required': [],
532	                'maxProperties': 1,
533	                'additionalProperties': {
534	                    'type': 'number'
535	                }
536	            },
537	            'outputs': {
538	                'type': 'object',
539	                'required': [],
540	                'maxProperties': 1,
541	                'additionalProperties': {
542	                    'type': 'number'
543	                }
544	            },
545	            **_experimental_task_schema(),
546	        }
547	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/schemas.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
551	    return {
552	        '$schema': 'https://json-schema.org/draft/2020-12/schema',
553	        'type': 'object',
554	        'required': ['cluster', 'auth'],
555	        'additionalProperties': False,
556	        'properties': {
557	            'cluster': {
558	                'type': 'object',
559	                'required': ['ips', 'name'],
560	                'additionalProperties': False,
561	                'properties': {
562	                    'ips': {
563	                        'type': 'array',
564	                        'items': {
565	                            'type': 'string',
566	                        }
567	                    },
568	                    'name': {
569	                        'type': 'string',
570	                    },
571	                }
572	            },
573	            'auth': {
574	                'type': 'object',
575	                'required': ['ssh_user', 'ssh_private_key'],
576	                'additionalProperties': False,
577	                'properties': {
578	                    'ssh_user': {
579	                        'type': 'string',
580	                    },
581	                    'ssh_private_key': {
582	                        'type': 'string',
583	                    },
584	                }
585	            },
586	            'python': {
587	                'type': 'string',
588	            },
589	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/schemas.py:955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
954	    return {
955	        '$schema': 'https://json-schema.org/draft/2020-12/schema',
956	        'type': 'object',
957	        'required': [],
958	        'additionalProperties': False,
959	        'properties': {
960	            'jobs': controller_resources_schema,
961	            'serve': controller_resources_schema,
962	            'allowed_clouds': allowed_clouds,
963	            'admin_policy': admin_policy_schema,
964	            'docker': docker_configs,
965	            'nvidia_gpus': gpu_configs,
966	            **cloud_configs,
967	        },
968	    }

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/subprocess_utils.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
126	
127	    with pool.ThreadPool(processes=processes) as p:
128	        ordered_iterators = p.imap(func, args)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/subprocess_utils.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
195	
196	    parent_process = psutil.Process()
197	    for child in parent_process.children(recursive=True):

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/subprocess_utils.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
264	    try:
265	        process = psutil.Process(process_pid)
266	        initial_children = [p.pid for p in process.children(recursive=True)]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/sky/utils/timeline.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	            'pid': str(os.getpid()),
38	            'tid': str(threading.current_thread().ident),
39	            'args': {

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/tests/test_cli.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
34	    with tempfile.NamedTemporaryFile('w', suffix='.yml') as f:
35	        f.write(spec)
36	        f.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/tests/test_jobs_and_serve.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
31	    with tempfile.NamedTemporaryFile(mode='w') as f:
32	        f.write(task_yaml)
33	        f.flush()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/tests/test_jobs_and_serve.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
313	            return 0, common_utils.encode_payload([{
314	                k: base64.b64encode(pickle.dumps(v)).decode('utf-8')
315	                for k, v in service.items()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/tests/test_jobs_and_serve.py:314
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
313	            return 0, common_utils.encode_payload([{
314	                k: base64.b64encode(pickle.dumps(v)).decode('utf-8')
315	                for k, v in service.items()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/tests/test_optimizer_dryruns.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
18	    with tempfile.NamedTemporaryFile('w') as f:
19	        f.write(spec)
20	        f.flush()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/tests/test_serve_autoscaler.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
9	    try:
10	        response = requests.get(url)
11	        print(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/tests/test_serve_autoscaler.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
35	    while True:
36	        send_get_request(ip_address, port)
37	        time.sleep(sending_frequency_seconds)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/tests/test_wheels.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
8	def test_build_wheels():
9	    shutil.rmtree(wheel_utils.WHEEL_DIR, ignore_errors=True)
10	    start = time.time()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/tests/test_wheels.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
22	    # simulate uncleaned symlinks due to interruption
23	    shutil.rmtree(wheel_utils.WHEEL_DIR, ignore_errors=True)
24	    wheel_utils.WHEEL_DIR.mkdir()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skypilot-0.8.1/skypilot-0.8.1/tests/test_wheels.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
32	
33	    shutil.rmtree(wheel_utils.WHEEL_DIR, ignore_errors=True)

--------------------------------------------------

Code scanned:
	Total lines of code: 75156
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 156.0
		High: 340.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 460.0
		High: 36.0
Files skipped (0):
