Run started:2025-04-12 14:12:14.807436

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/conftest.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
43	    os.chdir(curdir)
44	    shutil.rmtree(tempdir)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/electrode/tests/test_mea.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
104	    with open(path, 'w') as f:
105	        f.write('')
106	    with raises(KeyError):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/io/datasets.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	        response = requests.head(path)
28	        return int(response.headers.get('content-length', 0))
29	    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/io/datasets.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	    from requests import get
55	    r = get(url, stream=stream)
56	    if r.status_code != 200:  # pragma: no cover

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/io/datasets.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	
129	_BASE_URL = 'https://raw.githubusercontent.com/kwikteam/phy-data/master/'
130	
131	
132	def download_test_file(name, config_dir=None, force=False):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/io/tests/test_alf.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
128	    c = EphysAlfCreator(model)
129	    shutil.rmtree(out_path, ignore_errors=True)
130	    c.convert(out_path)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/io/tests/test_alf.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
202	    # test a straight export, make sure we can reload the data
203	    shutil.rmtree(out_path, ignore_errors=True)
204	    c.convert(out_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/io/tests/test_alf.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
205	    check_conversion_output()
206	    read_after_write()
207	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/io/tests/test_alf.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
208	    # test with a label after the attribute name
209	    shutil.rmtree(out_path)
210	    c.convert(out_path, label='probe00')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/io/tests/test_alf.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
211	    check_conversion_output()
212	    read_after_write()
213	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/io/tests/test_datasets.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	# Test URL and data
32	_URL = 'http://test/data'
33	_DATA = np.linspace(0., 1., 100000).astype(np.float32)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/utils/_misc.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
33	    b = arr.toBase64().data()
34	    data_b64 = base64.b64encode(b).decode('utf8')
35	    return data_b64

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/utils/_misc.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
33	    b = arr.toBase64().data()
34	    data_b64 = base64.b64encode(b).decode('utf8')
35	    return data_b64

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/utils/_misc.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
39	    """Decode binary arrays with base64."""
40	    encoded = base64.b64decode(data_b64)
41	    try:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/utils/_misc.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
39	    """Decode binary arrays with base64."""
40	    encoded = base64.b64decode(data_b64)
41	    try:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/utils/_misc.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
56	            obj_contiguous = np.ascontiguousarray(obj)
57	            data_b64 = base64.b64encode(obj_contiguous.data).decode('utf8')
58	            return dict(__ndarray__=data_b64, dtype=str(obj.dtype), shape=obj.shape)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/utils/_misc.py:57
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
56	            obj_contiguous = np.ascontiguousarray(obj)
57	            data_b64 = base64.b64encode(obj_contiguous.data).decode('utf8')
58	            return dict(__ndarray__=data_b64, dtype=str(obj.dtype), shape=obj.shape)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/utils/_misc.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
68	    if isinstance(d, dict) and '__ndarray__' in d:
69	        data = base64.b64decode(d['__ndarray__'])
70	        return np.frombuffer(data, d['dtype']).reshape(d['shape'])

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/utils/_misc.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
68	    if isinstance(d, dict) and '__ndarray__' in d:
69	        data = base64.b64decode(d['__ndarray__'])
70	        return np.frombuffer(data, d['dtype']).reshape(d['shape'])

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/utils/_misc.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
172	    metadata = {}
173	    exec(contents, {}, metadata)
174	    metadata = {k.lower(): v for (k, v) in metadata.items()}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/phylib/utils/_misc.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
196	                v = '"%s"' % v
197	            f.write('%s = %s\n' % (k, str(v)))
198	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/setup.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	with (Path(__file__).parent / 'phylib/__init__.py').open('r') as f:
36	    version = re.search(r"__version__ = '([^']+)'", f.read()).group(1)
37	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phylib-2.6.0/phylib-2.6.0/setup.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	    author_email='cyrille.rossant@gmail.com',
50	    url='https://github.com/cortex-lab/phylib',
51	    packages=_package_tree('phylib'),

--------------------------------------------------

Code scanned:
	Total lines of code: 5416
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 5.0
Files skipped (0):
