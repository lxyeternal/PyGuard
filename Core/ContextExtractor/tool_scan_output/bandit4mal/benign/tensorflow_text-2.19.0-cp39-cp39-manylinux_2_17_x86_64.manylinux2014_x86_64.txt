Run started:2025-04-12 17:42:04.381009

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensorflow_text-2.19.0-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64/tensorflow_text/python/ops/wordshape_ops.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	    WordShape.HAS_EMOJI:
254	        """
255	          The input contains an emoji character.
256	
257	          See http://www.unicode.org/Public/emoji/1.0//emoji-data.txt.
258	          Emojis are in unicode ranges `2600-26FF`, `1F300-1F6FF`, and
259	          `1F900-1F9FF`.
260	          """,
261	    WordShape.IS_ACRONYM_WITH_PERIODS:
262	        """
263	          The input is a period-separated acronym.
264	          This matches for strings of the form "I.B.M." but not "IBM".
265	          """,
266	    WordShape.IS_UPPERCASE:
267	        """
268	          The input contains only uppercase letterforms.
269	          """,
270	    WordShape.IS_LOWERCASE:
271	        """
272	          The input contains only lowercase letterforms.
273	          """,
274	    WordShape.HAS_MIXED_CASE:
275	        """
276	          The input contains both uppercase and lowercase letterforms.
277	          """,
278	    WordShape.IS_MIXED_CASE_LETTERS:
279	        """
280	          The input contains only uppercase and lowercase letterforms.
281	          """,
282	    WordShape.HAS_TITLE_CASE:
283	        """
284	          The input has title case (i.e. the first character is upper or title
285	          case, and the remaining characters are lowercase).
286	          """,
287	    # HAS_NO_QUOTES docs
288	    WordShape.BEGINS_WITH_OPEN_QUOTE:
289	        r"""
290	          The input begins with an open quote.
291	
292	          The following strings are considered open quotes:
293	
294	          ```
295	               "  QUOTATION MARK
296	               '  APOSTROPHE
297	               `  GRAVE ACCENT
298	              ``  Pair of GRAVE ACCENTs
299	          \uFF02  FULLWIDTH QUOTATION MARK
300	          \uFF07  FULLWIDTH APOSTROPHE
301	          \u00AB  LEFT-POINTING DOUBLE ANGLE QUOTATION MARK
302	          \u2018  LEFT SINGLE QUOTATION MARK
303	          \u201A  SINGLE LOW-9 QUOTATION MARK
304	          \u201B  SINGLE HIGH-REVERSED-9 QUOTATION MARK
305	          \u201C  LEFT DOUBLE QUOTATION MARK
306	          \u201E  DOUBLE LOW-9 QUOTATION MARK
307	          \u201F  DOUBLE HIGH-REVERSED-9 QUOTATION MARK
308	          \u2039  SINGLE LEFT-POINTING ANGLE QUOTATION MARK
309	          \u300C  LEFT CORNER BRACKET
310	          \u300E  LEFT WHITE CORNER BRACKET
311	          \u301D  REVERSED DOUBLE PRIME QUOTATION MARK
312	          \u2E42  DOUBLE LOW-REVERSED-9 QUOTATION MARK
313	          \uFF62  HALFWIDTH LEFT CORNER BRACKET
314	          \uFE41  PRESENTATION FORM FOR VERTICAL LEFT CORNER BRACKET
315	          \uFE43  PRESENTATION FORM FOR VERTICAL LEFT WHITE CORNER BRACKET
316	          ```
317	
318	          Note: U+B4 (acute accent) not included.
319	          """,
320	    WordShape.ENDS_WITH_CLOSE_QUOTE:
321	        r"""
322	          The input ends witha closing quote character.
323	
324	          The following strings are considered close quotes:
325	
326	          ```
327	               "  QUOTATION MARK
328	               '  APOSTROPHE
329	               `  GRAVE ACCENT
330	              ''  Pair of APOSTROPHEs
331	          \uFF02  FULLWIDTH QUOTATION MARK
332	          \uFF07  FULLWIDTH APOSTROPHE
333	          \u00BB  RIGHT-POINTING DOUBLE ANGLE QUOTATION MARK
334	          \u2019  RIGHT SINGLE QUOTATION MARK
335	          \u201D  RIGHT DOUBLE QUOTATION MARK
336	          \u203A  SINGLE RIGHT-POINTING ANGLE QUOTATION MARK
337	          \u300D  RIGHT CORNER BRACKET
338	          \u300F  RIGHT WHITE CORNER BRACKET
339	          \u301E  DOUBLE PRIME QUOTATION MARK
340	          \u301F  LOW DOUBLE PRIME QUOTATION MARK
341	          \uFE42  PRESENTATION FORM FOR VERTICAL RIGHT CORNER BRACKET
342	          \uFE44  PRESENTATION FORM FOR VERTICAL RIGHT WHITE CORNER BRACKET
343	          \uFF63  HALFWIDTH RIGHT CORNER BRACKET
344	          ```
345	
346	          Note: U+B4 (ACUTE ACCENT) is not included.
347	          """,
348	    # HAS_QUOTE docs
349	    WordShape.HAS_MATH_SYMBOL:
350	        """
351	          The input contains a mathematical symbol.
352	          """,
353	    WordShape.HAS_CURRENCY_SYMBOL:
354	        """
355	          The input contains a currency symbol.
356	          """,
357	    WordShape.HAS_NON_LETTER:
358	        """
359	          The input contains a non-letter character.
360	          """,
361	}
362	
363	
364	def _add_identifier_list_to_docstring(func):
365	  items = [("WordShape." + ws.name, doc) for ws, doc in _wordshape_doc.items()]
366	  identifier_list = "".join(
367	      "\n        * `%s`:%s\n" % (name, doc) for (name, doc) in sorted(items))
368	  func.__doc__ = func.__doc__ % dict(identifier_list=identifier_list)
369	
370	
371	# Use the wordshape docstring we created above.
372	_add_identifier_list_to_docstring(WordShape)
373	
374	
375	def wordshape(input_tensor, pattern, name=None):
376	  r"""Determine wordshape features for each input string.
377	
378	    In this example, we test for title case (the first character is upper or
379	    title case, and the remaining characters are lowercase).
380	    >>> input = [
381	    ... u"abc", u"ABc", u"ABC", u"Abc", u"aBcd", u"\u01c8bc".encode("utf-8")
382	    ... ]
383	    >>> wordshape(input, WordShape.HAS_TITLE_CASE)
384	    <tf.Tensor: shape=(6,), dtype=bool,
385	     numpy=array([False, False, False,  True, False,  True])>
386	
387	  Args:
388	    input_tensor: string `Tensor` with any shape.
389	    pattern: A `tftext.WordShape` or a list of WordShapes.
390	    name: A name for the operation (optional).
391	
392	  Returns:
393	    `<bool>[input_tensor.shape + pattern.shape]`: A tensor where
394	      `result[i1...iN, j]` is true if `input_tensor[i1...iN]` has the wordshape
395	      specified by `pattern[j]`.
396	
397	  Raises:
398	    ValueError: If `pattern` contains an unknown identifier.
399	  """
400	  if isinstance(pattern, WordShape):
401	    return string_ops.regex_full_match(input_tensor, pattern.value, name)
402	  elif (isinstance(pattern, (list, tuple)) and
403	        all(isinstance(s, WordShape) for s in pattern)):
404	    with ops.name_scope(name, "Wordshape", input_tensor):
405	      return array_ops_stack.stack(
406	          [wordshape(input_tensor, s) for s in pattern], axis=-1)
407	  else:
408	    raise TypeError(
409	        "Expected 'pattern' to be a single WordShape or a list of WordShapes.")

--------------------------------------------------

Code scanned:
	Total lines of code: 7804
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 0.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 0.0
Files skipped (0):
