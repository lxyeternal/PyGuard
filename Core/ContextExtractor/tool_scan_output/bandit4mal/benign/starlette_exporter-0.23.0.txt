Run started:2025-04-12 10:32:07.678280

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/setup.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    license="Apache License 2.0",
11	    url="https://github.com/stephenhillier/starlette_exporter",
12	    description="Prometheus metrics exporter for Starlette applications.",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/starlette_exporter/labels.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	    def __call__(self, headers: Dict) -> Any:
20	        v = headers.get(self.key, self.default)
21	        if self.allowed_values is not None and v not in self.allowed_values:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/starlette_exporter/labels.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	    def inner(r: Request):
48	        v = r.headers.get(key, "")
49	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/starlette_exporter/middleware.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
303	            k.decode("utf-8").lower(): v.decode("utf-8")
304	            for (k, v) in message.get("headers", ())
305	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/starlette_exporter/middleware.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
360	        ):
361	            if request.headers.get("content-length"):
362	                request_body_size = int(request.headers["content-length"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/starlette_exporter/middleware.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
428	
429	            endpoint = scope.get("endpoint", None)
430	            router = scope.get("router", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/starlette_exporter/middleware.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
429	            endpoint = scope.get("endpoint", None)
430	            router = scope.get("router", None)
431	            if endpoint and router:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	        async def test_mounted_function_param(request):
101	            return JSONResponse({"message": request.path_params.get("item")})
102	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	        """test that requests appear in the counter"""
125	        client.get("/200")
126	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	        client.get("/200")
126	        metrics = client.get("/metrics").content.decode()
127	        assert (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
134	
135	        client.get("/500")
136	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	        client.get("/500")
136	        metrics = client.get("/metrics").content.decode()
137	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	        client = TestClient(testapp(filter_unhandled_paths=False))
146	        client.get("/404")
147	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	        client.get("/404")
147	        metrics = client.get("/metrics").content.decode()
148	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	        try:
158	            client.get("/404")
159	        except:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	            pass
161	        metrics = client.get("/metrics").content.decode()
162	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	        client = TestClient(testapp(group_unhandled_paths=True, filter_unhandled_paths=False))
169	        client.get("/404")
170	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
170	
171	        metrics = client.get("/metrics").content.decode()
172	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	        with pytest.raises(KeyError, match="value_error"):
182	            client.get("/unhandled")
183	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
183	
184	        metrics = client.get("/metrics").content.decode()
185	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
195	
196	        client.get("/200/111")
197	        client.get("/500/1111")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
196	        client.get("/200/111")
197	        client.get("/500/1111")
198	        client.get("/404/11111")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	        client.get("/500/1111")
198	        client.get("/404/11111")
199	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	        with pytest.raises(KeyError, match="value_error"):
201	            client.get("/unhandled/123")
202	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
202	
203	        metrics = client.get("/metrics").content.decode()
204	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	
223	        client.get("/200")
224	        client.get("/500")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	        client.get("/200")
224	        client.get("/500")
225	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	        try:
226	            client.get("/unhandled")
227	        except:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	
230	        metrics = client.get("/metrics").content.decode()
231	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	        client = TestClient(testapp(buckets=buckets))
250	        client.get("/200")
251	        client.get("/500")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
250	        client.get("/200")
251	        client.get("/500")
252	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	        try:
253	            client.get("/unhandled")
254	        except:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
256	
257	        metrics = client.get("/metrics").content.decode()
258	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	
276	        client.get("/200")
277	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	        client.get("/200")
277	        metrics = client.get("/metrics").content.decode()
278	        assert (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
285	        client = TestClient(testapp(filter_unhandled_paths=True))
286	        client.get("/mounted/test")
287	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
286	        client.get("/mounted/test")
287	        metrics = client.get("/metrics").content.decode()
288	        assert (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
297	        client = TestClient(testapp(filter_unhandled_paths=True, group_paths=True))
298	        client.get("/mounted/test/123")
299	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
298	        client.get("/mounted/test/123")
299	        metrics = client.get("/metrics").content.decode()
300	        assert (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
308	        client = TestClient(testapp(filter_unhandled_paths=False))
309	        client.get("/mounted/404")
310	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
309	        client.get("/mounted/404")
310	        metrics = client.get("/metrics").content.decode()
311	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
319	        client = TestClient(testapp())
320	        client.get("/mounted/404")
321	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	        client.get("/mounted/404")
321	        metrics = client.get("/metrics").content.decode()
322	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
327	        client = TestClient(testapp(filter_unhandled_paths=False, group_paths=False))
328	        client.get("/static/test.txt")
329	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
328	        client.get("/static/test.txt")
329	        metrics = client.get("/metrics").content.decode()
330	        assert """path="/static/test.txt""" in metrics

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
335	
336	        client.get("/200")
337	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
336	        client.get("/200")
337	        metrics = client.get("/metrics").content.decode()
338	        assert (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
354	
355	        client1.get("/200")
356	        client2.get("/200")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
355	        client1.get("/200")
356	        client2.get("/200")
357	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	        # both will return the same metrics though
359	        metrics1 = client1.get("/metrics").content.decode()
360	        metrics2 = client2.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
359	        metrics1 = client1.get("/metrics").content.decode()
360	        metrics2 = client2.get("/metrics").content.decode()
361	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
385	
386	        metrics = client.get("/metrics").content.decode()
387	        assert (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
395	        # also being decremented.
396	        metrics = client.get("/metrics").content.decode()
397	        assert (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
404	        client = TestClient(testapp(skip_paths=["/health"]))
405	        client.get("/health")
406	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
405	        client.get("/health")
406	        metrics = client.get("/metrics").content.decode()
407	        assert """path="/health""" not in metrics

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
411	        client = TestClient(testapp(skip_paths=[r"/h.*"]))
412	        client.get("/health")
413	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
412	        client.get("/health")
413	        metrics = client.get("/metrics").content.decode()
414	        assert """path="/health""" not in metrics

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
418	        client = TestClient(testapp(skip_paths=[r"/h"]))
419	        client.get("/health")
420	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
419	        client.get("/health")
420	        metrics = client.get("/metrics").content.decode()
421	        assert """path="/health""" in metrics

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
425	        client = TestClient(testapp(skip_methods=["POST"]))
426	        client.post("/200")
427	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
426	        client.post("/200")
427	        metrics = client.get("/metrics").content.decode()
428	        assert """path="/200""" not in metrics

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
439	        """test that metrics are grouped by endpoint"""
440	        client.get("/200/111")
441	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
440	        client.get("/200/111")
441	        metrics = client.get("/metrics").content.decode()
442	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
450	        client.options("/200/111")
451	        metrics = client.get("/metrics").content.decode()
452	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
462	
463	        client.get("/500/1111")
464	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
463	        client.get("/500/1111")
464	        metrics = client.get("/metrics").content.decode()
465	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
473	        try:
474	            client.get("/404/11111")
475	        except:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
476	            pass
477	        metrics = client.get("/metrics").content.decode()
478	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
486	        with pytest.raises(KeyError, match="value_error"):
487	            client.get("/unhandled/123")
488	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
488	
489	        metrics = client.get("/metrics").content.decode()
490	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
498	        client = TestClient(testapp(group_paths=True, filter_unhandled_paths=False))
499	        client.get("/mounted/404")
500	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
499	        client.get("/mounted/404")
500	        metrics = client.get("/metrics").content.decode()
501	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
509	        client = TestClient(testapp(group_paths=True, filter_unhandled_paths=True))
510	        client.get("/mounted/404")
511	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
510	        client.get("/mounted/404")
511	        metrics = client.get("/metrics").content.decode()
512	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
517	        client = TestClient(testapp())
518	        client.get("/static/test.txt")
519	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
518	        client.get("/static/test.txt")
519	        metrics = client.get("/metrics").content.decode()
520	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
528	
529	        client.get("/200/111")
530	        client.get("/500/1111")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
529	        client.get("/200/111")
530	        client.get("/500/1111")
531	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
532	        with pytest.raises(KeyError, match="value_error"):
533	            client.get("/unhandled/123")
534	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
534	
535	        metrics = client.get("/metrics").content.decode()
536	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
554	
555	        client.get("/200/111")
556	        client.get("/500/1111")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
555	        client.get("/200/111")
556	        client.get("/500/1111")
557	        client.get("/404/123")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
556	        client.get("/500/1111")
557	        client.get("/404/123")
558	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
558	
559	        client.get("/api/200/111")
560	        client.get("/api/500/1111")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
559	        client.get("/api/200/111")
560	        client.get("/api/500/1111")
561	        client.get("/api/404/123")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
560	        client.get("/api/500/1111")
561	        client.get("/api/404/123")
562	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
563	        with pytest.raises(KeyError, match="value_error"):
564	            client.get("/unhandled/123")
565	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
566	        with pytest.raises(KeyError, match="value_error"):
567	            client.get("/api/unhandled/123")
568	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
568	
569	        client.get("/mounted/test/404")
570	        client.get("/static/404")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
569	        client.get("/mounted/test/404")
570	        client.get("/static/404")
571	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
571	
572	        client.get("/api/mounted/test/123")
573	        client.get("/api/static/test.txt")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
572	        client.get("/api/mounted/test/123")
573	        client.get("/api/static/test.txt")
574	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
574	
575	        client.get("/health")
576	        client.get("/api/health")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
575	        client.get("/health")
576	        client.get("/api/health")
577	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
577	
578	        metrics = client.get("/metrics").content.decode()
579	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
615	    def test_background_task_endpoint(self, client):
616	        client.get("/background")
617	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
617	
618	        metrics = client.get("/metrics").content.decode()
619	        background_metric = [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
645	    def test_response_body_size(self, client):
646	        client.get("/200")
647	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
647	
648	        metrics = client.get("/metrics").content.decode()
649	        response_size_metric = [

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
657	    def test_receive_body_size(self, client):
658	        client.post("/200", json={"test_post": ["d", "a"]})
659	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
659	
660	        metrics = client.get("/metrics").content.decode()
661	        rec_size_metric = [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
675	        client = TestClient(testapp(always_use_int_status=True))
676	        client.get("/200_or_httpstatus/OK")
677	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
676	        client.get("/200_or_httpstatus/OK")
677	        metrics = client.get("/metrics").content.decode()
678	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
686	        client = TestClient(testapp(always_use_int_status=True))
687	        client.get("/200")
688	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
687	        client.get("/200")
688	        metrics = client.get("/metrics").content.decode()
689	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
702	        client = TestClient(testapp(labels=labels))
703	        client.get("/200")
704	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
703	        client.get("/200")
704	        metrics = client.get("/metrics").content.decode()
705	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
714	        # set up a callable that retrieves a header value from the request
715	        f = lambda x: x.headers.get("foo")
716	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
719	        client = TestClient(testapp(labels=labels))
720	        client.get("/200", headers={"foo": "bar"})
721	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
720	        client.get("/200", headers={"foo": "bar"})
721	        metrics = client.get("/metrics").content.decode()
722	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
738	        client = TestClient(testapp(labels=labels))
739	        client.get("/200")
740	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
739	        client.get("/200")
740	        metrics = client.get("/metrics").content.decode()
741	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:751
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
750	        client = TestClient(testapp(labels=labels))
751	        client.get("/200", headers={"foo": "bar"})
752	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
751	        client.get("/200", headers={"foo": "bar"})
752	        metrics = client.get("/metrics").content.decode()
753	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
765	        client = TestClient(testapp(labels=labels))
766	        client.get("/200", headers={"foo": "bar"})
767	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
766	        client.get("/200", headers={"foo": "bar"})
767	        metrics = client.get("/metrics").content.decode()
768	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
781	        client = TestClient(testapp(labels=labels))
782	        client.get("/200", headers={"foo": "zounds"})
783	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
782	        client.get("/200", headers={"foo": "zounds"})
783	        metrics = client.get("/metrics").content.decode()
784	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
798	        client = TestClient(testapp(labels=labels))
799	        client.get("/200")
800	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:800
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
799	        client.get("/200")
800	        metrics = client.get("/metrics").content.decode()
801	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
810	        client = TestClient(testapp(labels=labels))
811	        client.get("/200")
812	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
811	        client.get("/200")
812	        metrics = client.get("/metrics").content.decode()
813	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:823
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
822	        client = TestClient(testapp(labels=labels))
823	        client.get("/500")
824	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
823	        client.get("/500")
824	        metrics = client.get("/metrics").content.decode()
825	        

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:838
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
837	        with pytest.raises(KeyError, match="value_error"):
838	            client.get("/unhandled")
839	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
839	
840	        metrics = client.get("/metrics").content.decode()
841	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
854	        client = TestClient(testapp(labels=labels))
855	        client.get("/200")
856	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
855	        client.get("/200")
856	        metrics = client.get("/metrics").content.decode()
857	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
870	        client = TestClient(testapp(labels=labels))
871	        client.get("/200")
872	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
871	        client.get("/200")
872	        metrics = client.get("/metrics").content.decode()
873	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
887	        client = TestClient(testapp(labels=labels))
888	        client.get("/200", headers={"foo": "zounds"})
889	        metrics = client.get("/metrics").content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
888	        client.get("/200", headers={"foo": "zounds"})
889	        metrics = client.get("/metrics").content.decode()
890	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
916	        client = TestClient(testapp(exemplars=exemplar_fn, labels=labels))
917	        client.get("/200")
918	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:919
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
918	
919	        metrics = client.get(
920	            "/openmetrics", headers={"Accept": "application/openmetrics-text"}
921	        ).content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
936	            def exemplar_fn(r: Request):
937	                return {"trace_id": r.headers.get("trace-id", "")}
938	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:942
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
941	            def exemplar_fn(request):
942	                return {"trace_id": request.headers.get("trace-id", "")}
943	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:948
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
947	        client = TestClient(testapp(exemplars=exemplar_fn, labels=labels))
948	        client.get("/200", headers={"Trace-ID": "abc123"})
949	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_exporter-0.23.0/starlette_exporter-0.23.0/tests/test_middleware.py:950
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
949	
950	        metrics = client.get(
951	            "/openmetrics",
952	            headers={"Accept": "application/openmetrics-text", "Trace-ID": "abc123"},
953	        ).content.decode()

--------------------------------------------------

Code scanned:
	Total lines of code: 1273
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 137.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 138.0
		High: 0.0
Files skipped (0):
