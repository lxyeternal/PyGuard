Run started:2025-04-12 13:46:37.387831

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/setup.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	    with open(path, 'r') as fobj:
21	        version_file = fobj.read()
22	    version_match = re.search(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/setup.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    license="Apache-2.0",
42	    url="https://scitokens.org",
43	    project_urls={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/setup.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	    project_urls={
44	        "Documentation": "https://scitokens.readthedocs.io/",
45	        "Issue Tracker": "https://github.com/scitokens/scitokens/issues",
46	        "Source Code": "https://github.com/scitokens/scitokens",
47	    },
48	    # contents

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/setup.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        "Documentation": "https://scitokens.readthedocs.io/",
45	        "Issue Tracker": "https://github.com/scitokens/scitokens/issues",
46	        "Source Code": "https://github.com/scitokens/scitokens",
47	    },
48	    # contents
49	    package_dir={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/setup.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        "Issue Tracker": "https://github.com/scitokens/scitokens/issues",
46	        "Source Code": "https://github.com/scitokens/scitokens",
47	    },
48	    # contents
49	    package_dir={
50	        "": "src",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/scitokens.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
336	            with open(os.environ.get('BEARER_TOKEN_FILE')) as t:
337	                token_data = t.read().strip()
338	                return SciToken.deserialize(token_data,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/scitokens.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
348	            with open(bt_path) as t:
349	                token_data = t.read().strip()
350	                return SciToken.deserialize(token_data,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/__init__.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
26	
27	    return base64.urlsafe_b64decode(data)
28	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/__init__.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
32	    """
33	    return base64.urlsafe_b64encode(cryptography.utils.int_to_bytes(data)).decode('ascii')
34	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/__init__.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
39	    """
40	    return base64.urlsafe_b64encode(cryptography.utils.int_to_bytes(data))

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/demo.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
16	    data = json.dumps({'algorithm': "ES256", 'payload': payload})
17	    resp = requests.post("https://demo.scitokens.org/issue", data=data)
18	    return resp.text

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/demo.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    data = json.dumps({'algorithm': "ES256", 'payload': payload})
17	    resp = requests.post("https://demo.scitokens.org/issue", data=data)
18	    return resp.text

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/keycache.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
244	                raise NonHTTPSIssuer("Issuer is not over HTTPS.  RFC requires it to be over HTTPS")
245	        response = request.urlopen(request.Request(meta_uri, headers=headers))
246	        data = json.loads(response.read().decode('utf-8'))

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/keycache.py:245
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
244	                raise NonHTTPSIssuer("Issuer is not over HTTPS.  RFC requires it to be over HTTPS")
245	        response = request.urlopen(request.Request(meta_uri, headers=headers))
246	        data = json.loads(response.read().decode('utf-8'))

--------------------------------------------------
>> Issue: [B321:blacklist] urllib2_Request
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/keycache.py:245
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b321-urllib2-request
244	                raise NonHTTPSIssuer("Issuer is not over HTTPS.  RFC requires it to be over HTTPS")
245	        response = request.urlopen(request.Request(meta_uri, headers=headers))
246	        data = json.loads(response.read().decode('utf-8'))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/keycache.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
245	        response = request.urlopen(request.Request(meta_uri, headers=headers))
246	        data = json.loads(response.read().decode('utf-8'))
247	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/keycache.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
255	                raise NonHTTPSIssuer("jwks_uri is not over HTTPS, insecure!")
256	        response = request.urlopen(request.Request(jwks_uri, headers=headers))
257	

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/keycache.py:256
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
255	                raise NonHTTPSIssuer("jwks_uri is not over HTTPS, insecure!")
256	        response = request.urlopen(request.Request(jwks_uri, headers=headers))
257	

--------------------------------------------------
>> Issue: [B321:blacklist] urllib2_Request
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/keycache.py:256
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b321-urllib2-request
255	                raise NonHTTPSIssuer("jwks_uri is not over HTTPS, insecure!")
256	        response = request.urlopen(request.Request(jwks_uri, headers=headers))
257	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/src/scitokens/utils/keycache.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
269	
270	        keys_data = json.loads(response.read().decode('utf-8'))
271	        # Loop through each key, looking for the right key id

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/create_sample_token.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
19	    """
20	    return base64.urlsafe_b64encode(int_to_bytes(data, size)).strip(b'=')
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/create_sample_token.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	    token_encoded = jwt.encode({"read": "/ligo"}, serialized_private, algorithm="ES256",
75	        headers={"x5u": "https://vo.example.com/JWS", "cwk": public_jwk})
76	    #child_token_encoded = jwt.encode({"read": "/ligo/brian"}, serialized_child_private, algorithm="ES256",

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/create_sample_token.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
113	    print("Child token, encoded:\n", child_token_encoded)
114	    print("Child token with key:\n", child_token_encoded+"."+base64.urlsafe_b64encode(json.dumps(private_jwk)))
115	    print("Child token headers:\n", jwt.get_unverified_header(child_token_encoded))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/create_webserver.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	        if self.path == "/.well-known/openid-configuration":
56	            to_write = json.dumps({"jwks_uri": "http://localhost:{}/oauth2/certs".format(HTTPD.server_address[1])})
57	        elif self.path == "/oauth2/certs":

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/create_webserver.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
119	
120	    server_address = ('127.0.0.1', 0)
121	    HTTPD = HTTPServer(server_address, OauthRequestHandler)

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/create_webserver.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
120	    server_address = ('127.0.0.1', 0)
121	    HTTPD = HTTPServer(server_address, OauthRequestHandler)
122	    THREAD = threading.Thread(target=HTTPD.serve_forever)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_admin_create_key.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
292	
293	        tmpfile.write(pem)
294	        tmpfile.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_admin_create_key.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
292	
293	        tmpfile.write(pem)
294	        tmpfile.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_admin_create_key.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
325	
326	        tmpfile.write(pem)
327	        tmpfile.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_admin_create_key.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
325	
326	        tmpfile.write(pem)
327	        tmpfile.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_create_scitoken.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
178	                                                   insecure = True,
179	                                                   audience = 'https://doesnotexist.edu')
180	        self.assertIsInstance(new_token, scitokens.SciToken)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_create_scitoken.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
357	        with open(bt_path, 'w') as f:
358	            f.write(tmp_file_token_s.decode('utf-8'))
359	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_create_scitoken.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
357	        with open(bt_path, 'w') as f:
358	            f.write(tmp_file_token_s.decode('utf-8'))
359	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_create_scitoken.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
370	        with open(xdg_path, 'w') as f:
371	            f.write(xdg_file_token_s.decode('utf-8'))
372	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_create_scitoken.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
370	        with open(xdg_path, 'w') as f:
371	            f.write(xdg_file_token_s.decode('utf-8'))
372	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_create_scitoken.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
387	        with open(bearer_token_file, 'w') as f:
388	            f.write(bearer_file_token_s.decode('utf-8'))
389	        os.close(fd)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_create_scitoken.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
387	        with open(bearer_token_file, 'w') as f:
388	            f.write(bearer_file_token_s.decode('utf-8'))
389	        os.close(fd)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_create_scitoken.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
417	        # clean up the files and directories created
418	        shutil.rmtree(xdg_dir)
419	        os.remove(bearer_token_file)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_create_scitoken.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
430	                "ver": "scitoken:2.0",
431	                "aud": "https://demo.scitokens.org",
432	                "exp": datetime.datetime.now(tz=datetime.timezone.utc) + datetime.timedelta(seconds=30),
433	                "iat": datetime.datetime.now(tz=datetime.timezone.utc),
434	                "nbf": datetime.datetime.now(tz=datetime.timezone.utc),
435	                "jti": "eab04181-b63a-42aa-b77d-804742829fc5",
436	                "kid": "key-rs256"
437	            },
438	            "secret",
439	            algorithm="HS256",
440	            headers={"typ": "JWT", "alg": "HS256", "kid": "key-hs256"}

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
46	    def tearDown(self):
47	        shutil.rmtree(self.tmp_dir)
48	        if self.old_xdg:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
72	        # Limiting access privilege to read-only for the $XDG_CACHE_HOME
73	        os.chmod(
74	            self.tmp_dir,
75	            stat.S_IRUSR |  # Read for user
76	            stat.S_IRGRP |  # Read for group
77	            stat.S_IROTH    # Read for other
78	        )

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:73
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
72	        # Limiting access privilege to read-only for the $XDG_CACHE_HOME
73	        os.chmod(
74	            self.tmp_dir,
75	            stat.S_IRUSR |  # Read for user
76	            stat.S_IRGRP |  # Read for group
77	            stat.S_IROTH    # Read for other
78	        )

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
85	        # Revert the access privilege alteration for the $XDG_CACHE_HOME
86	        os.chmod(
87	            self.tmp_dir,
88	            stat.S_IRWXU |  # Read, write, and execute for user
89	            stat.S_IRWXG |  # Read, write, and execute for group
90	            stat.S_IRWXO    # Read, write, and execute for other
91	        )

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:86
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
85	        # Revert the access privilege alteration for the $XDG_CACHE_HOME
86	        os.chmod(
87	            self.tmp_dir,
88	            stat.S_IRWXU |  # Read, write, and execute for user
89	            stat.S_IRWXG |  # Read, write, and execute for group
90	            stat.S_IRWXO    # Read, write, and execute for other
91	        )

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
64	    @unittest.skipIf(sys.platform.startswith("win"), "Test doesn't work on Windows")
65	    @unittest.skipIf(not sys.platform.startswith("win") and os.getuid() == 0, "Test doesn't work when root")
66	    def test_cannot_make_cache_permission_denied(self):

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
64	    @unittest.skipIf(sys.platform.startswith("win"), "Test doesn't work on Windows")
65	    @unittest.skipIf(not sys.platform.startswith("win") and os.getuid() == 0, "Test doesn't work when root")
66	    def test_cannot_make_cache_permission_denied(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	        # Now try to get the public key from the server
108	        pubkey_from_keycache = self.keycache.getkeyinfo("http://localhost:{}/".format(server_address[1]),
109	                                 test_id,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
142	
143	        self.keycache.addkeyinfo("https://doesnotexists.edu/", "blahstuff", public_key, cache_timer=60)
144	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        # Now extract the just inserted key
146	        pubkey = self.keycache.getkeyinfo("https://doesnotexists.edu/", "blahstuff")
147	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
156	        with self.assertRaises(URLError):
157	            self.keycache.getkeyinfo("https://doesnotexists.edu/", "asdf")
158	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
173	
174	        _, cache_timer = self.keycache._get_issuer_publickey("http://localhost:{}/".format(server_address[1]),
175	                                            key_id=test_id,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
196	
197	        self.keycache.addkeyinfo("https://doesnotexists.edu/", "blahstuff", public_key, cache_timer=60, next_update=-1)
198	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
201	        # (invalid url)
202	        pubkey = self.keycache.getkeyinfo("https://doesnotexists.edu/", "blahstuff")
203	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	        # Now try to get the public key from the server
240	        self.keycache.addkeyinfo("http://localhost:{}/".format(server_address[1]),
241	                                 test_id,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_keycache.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	        # Next update should trigger now
247	        pubkey_from_keycache = self.keycache.getkeyinfo("http://localhost:{}/".format(server_address[1]),
248	                                 test_id,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	
55	    _test_issuer = "https://scitokens.org/unittest"
56	
57	    @staticmethod
58	    def always_accept(value):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	        # Token is set to to ANY, so any audience will work
107	        enf = scitokens.Enforcer(self._test_issuer, audience = "https://example.unl.edu")
108	        self._token2["scp"] = "read:/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	        # Change the audience from ANY to https://example.com
112	        self._token2["aud"] = "https://example.com"
113	        self.assertFalse(enf.test(self._token2, "read", "/"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
135	        del self._token2["aud"]
136	        enf = scitokens.Enforcer(self._test_issuer, audience="https://example.unl.edu")
137	        self._token2["scope"] = "read:/foo/bar"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        # Now to the correct audience
146	        self._token2["aud"] = "https://example.unl.edu"
147	        self.assertTrue(enf.test(self._token2, "read", "/foo/bar"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	        # Now to the wrong audience
150	        self._token2["aud"] = "https://example.com"
151	        self.assertFalse(enf.test(self._token2, "read", "/foo/bar"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
178	
179	        enf = scitokens.Enforcer(self._test_issuer, audience = "https://example.unl.edu")
180	        enf.add_validator("foo", self.always_accept)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
210	
211	        enf = scitokens.Enforcer(self._test_issuer, audience = "https://example.unl.edu")
212	        enf.add_validator("foo", self.always_accept)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
235	        enf.add_validator("foo", lambda path : True)
236	        self._token['aud'] = "https://example.unl.edu"
237	        self.assertFalse(enf.test(self._token, "read", "/"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	
239	        enf = scitokens.Enforcer(self._test_issuer, audience = "https://example.unl.edu")
240	        enf.add_validator("foo", lambda path : True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
249	        # Test multiple audiences
250	        enf = scitokens.Enforcer(self._test_issuer, audience = ["https://example.unl.edu", "https://another.com"])
251	        enf.add_validator("foo", self.always_accept)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
249	        # Test multiple audiences
250	        enf = scitokens.Enforcer(self._test_issuer, audience = ["https://example.unl.edu", "https://another.com"])
251	        enf.add_validator("foo", self.always_accept)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
252	        self.assertTrue(enf.test(self._token, "read", "/"), msg=enf.last_failure)
253	        self._token['aud'] = "https://another.com"
254	        self.assertTrue(enf.test(self._token, "read", "/"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
254	        self.assertTrue(enf.test(self._token, "read", "/"), msg=enf.last_failure)
255	        self._token['aud'] = "https://doesnotwork.com"
256	        self.assertFalse(enf.test(self._token, "read", "/"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	        self._token2['scope'] = 'read:/'
259	        self._token2["aud"] = ["https://example.com", "https://another.com"]
260	        enf = scitokens.Enforcer(self._test_issuer, audience = "https://example.com")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	        self._token2['scope'] = 'read:/'
259	        self._token2["aud"] = ["https://example.com", "https://another.com"]
260	        enf = scitokens.Enforcer(self._test_issuer, audience = "https://example.com")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
259	        self._token2["aud"] = ["https://example.com", "https://another.com"]
260	        enf = scitokens.Enforcer(self._test_issuer, audience = "https://example.com")
261	        self.assertTrue(enf.test(self._token2, "read", "/foo"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
261	        self.assertTrue(enf.test(self._token2, "read", "/foo"), msg=enf.last_failure)
262	        self._token2["aud"] = ["notexist", "https://another.com"]
263	        self.assertFalse(enf.test(self._token2, "read", "/foo"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
264	
265	        self._token2["aud"] = ["https://example.com", "https://another.com"]
266	        enf = scitokens.Enforcer(self._test_issuer, audience = ["https://example.com", "blah.com"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
264	
265	        self._token2["aud"] = ["https://example.com", "https://another.com"]
266	        enf = scitokens.Enforcer(self._test_issuer, audience = ["https://example.com", "blah.com"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	        self._token2["aud"] = ["https://example.com", "https://another.com"]
266	        enf = scitokens.Enforcer(self._test_issuer, audience = ["https://example.com", "blah.com"])
267	        self.assertTrue(enf.test(self._token2, "read", "/foo"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
267	        self.assertTrue(enf.test(self._token2, "read", "/foo"), msg=enf.last_failure)
268	        self._token2["aud"] = ["notexist", "https://another.com"]
269	        self.assertFalse(enf.test(self._token2, "read", "/foo"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	
271	        self._token2["aud"] = ["https://example.com", "https://another.com"]
272	        enf = scitokens.Enforcer(self._test_issuer, audience = ["https://example.com", "blah.com"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	
271	        self._token2["aud"] = ["https://example.com", "https://another.com"]
272	        enf = scitokens.Enforcer(self._test_issuer, audience = ["https://example.com", "blah.com"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_scitokens.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
271	        self._token2["aud"] = ["https://example.com", "https://another.com"]
272	        enf = scitokens.Enforcer(self._test_issuer, audience = ["https://example.com", "blah.com"])
273	        self.assertTrue(enf.test(self._token2, "read", "/foo"), msg=enf.last_failure)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_with_http.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	            self.private_key = serialization.load_pem_private_key(
34	                key_file.read(),
35	                password=None,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_with_http.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	            self.ec_private_key = serialization.load_pem_private_key(
43	                key_file.read(),
44	                password=None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_with_http.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        print(server_address)
61	        issuer = "http://localhost:{}/".format(server_address[1])
62	        token = scitokens.SciToken(key=self.private_key, key_id=self.test_id)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scitokens-1.8.1/scitokens-1.8.1/tests/test_with_http.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        print(server_address)
89	        issuer = "http://localhost:{}/".format(server_address[1])
90	        token = scitokens.SciToken(key=self.ec_private_key, key_id=self.ec_test_id,

--------------------------------------------------

Code scanned:
	Total lines of code: 3009
	Total lines skipped (#nosec): 2

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 53.0
		High: 31.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 77.0
		High: 7.0
Files skipped (0):
