Run started:2025-04-12 11:23:42.694305

Test results:
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/examples/iti_21/client.py:33
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
32	    # establish the connection
33	    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
34	    try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/examples/iti_21/client.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
34	    try:
35	        sock.connect((host, port))
36	        # send the message

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/examples/iti_21/client.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
36	        # send the message
37	        sock.sendall(parse_message(msg).to_mllp().encode('UTF-8'))
38	        # receive the answer

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/examples/iti_21/client.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
38	        # receive the answer
39	        received = sock.recv(1024*1024)
40	        return received

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/examples/iti_21/client.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
41	    finally:
42	        sock.close()
43	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/hl7apy/__init__.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	                   '<federico.caboni@me.com>'
45	__url__ = 'http://crs4.github.io/hl7apy/'
46	
47	_DEFAULT_ENCODING_CHARS = DEFAULT_ENCODING_CHARS

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/hl7apy/mllp.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
74	        try:
75	            line = self.request.recv(3)
76	        except socket.timeout:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/hl7apy/mllp.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
76	        except socket.timeout:
77	            self.request.close()
78	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/hl7apy/mllp.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
80	        if line[:1] != self.sb:  # First MLLP char
81	            self.request.close()
82	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/hl7apy/mllp.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
90	            except socket.timeout:
91	                self.request.close()
92	                return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/hl7apy/mllp.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
98	            except Exception:
99	                self.request.close()
100	            else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/hl7apy/mllp.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
102	                self.wfile.write(response.encode(self.encoding))
103	        self.request.close()
104	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/setup.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	
32	long_desc = """
33	HL7apy: a lightweight Python library to parse, create and handle HL7 v2.x messages
34	----------------------------------------------------------------------------------
35	
36	HL7apy is a lightweight Python package to intuitively handle `HL7 <http://www.hl7.org>`_ v2 messages according to HL7 specifications.
37	
38	The main features includes:
39	 * Message parsing
40	 * Message creation
41	 * Message validation following the HL7 xsd specifications
42	 * Access to elements by name, long name or position
43	 * Support to all simple and complex datatypes
44	 * Encoding chars customization
45	 * Message encoding in ER7 format and compliant with MLLP protocol
46	"""
47	
48	
49	def _get_version():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/setup.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	    url=hl7apy.__url__,
62	    download_url='http://sourceforge.net/projects/hl7apy/files/',
63	    license='MIT License',

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_core.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
102	        self.rsp_k21_mp = hl7apy.load_message_profile(mp_path)
103	        if platform.system() == 'Windows':
104	            legacy_mp = os.path.join(base_path, 'profiles/old_pharm_h4_win')

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_core.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
102	        self.rsp_k21_mp = hl7apy.load_message_profile(mp_path)
103	        if platform.system() == 'Windows':
104	            legacy_mp = os.path.join(base_path, 'profiles/old_pharm_h4_win')

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_core.py:103
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
102	        self.rsp_k21_mp = hl7apy.load_message_profile(mp_path)
103	        if platform.system() == 'Windows':
104	            legacy_mp = os.path.join(base_path, 'profiles/old_pharm_h4_win')

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_mllp.py:118
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
117	        # establish the connection
118	        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
119	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_mllp.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
119	        try:
120	            sock.connect((HOST, PORT))
121	            sock.sendall(msg.encode('utf-8'))

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_mllp.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
120	            sock.connect((HOST, PORT))
121	            sock.sendall(msg.encode('utf-8'))
122	            res = []

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_mllp.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
123	            while True:
124	                received = sock.recv(1)
125	                if not received:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_mllp.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
128	        finally:
129	            sock.close()
130	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_mllp.py:174
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
173	        # establish the connection
174	        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
175	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_mllp.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
175	        try:
176	            sock.connect((HOST, PORT + 1))
177	            sock.sendall(msg.encode('utf-8'))

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_mllp.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
176	            sock.connect((HOST, PORT + 1))
177	            sock.sendall(msg.encode('utf-8'))
178	            res = []

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_mllp.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
179	            while True:
180	                received = sock.recv(1)
181	                if not received:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_mllp.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
184	        finally:
185	            sock.close()
186	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_validation.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
93	        with open(self.report_file, 'r') as f:
94	            s = f.read()
95	        if error_type == 'ERROR':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/tests/test_validation.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
414	        with open(self.report_file, 'r') as f:
415	            s = f.read()
416	        if error_type == 'ERROR':

--------------------------------------------------

Code scanned:
	Total lines of code: 158462
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 22.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 4.0
Files skipped (1):
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/hl7apy-1.3.5/hl7apy-1.3.5/examples/profiler.py (syntax error while parsing AST from file)
