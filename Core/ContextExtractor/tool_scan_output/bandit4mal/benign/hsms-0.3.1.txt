Run started:2025-04-12 18:09:14.004003

Test results:
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsm_dump_us.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
32	    try:
33	        blob = zlib.decompress(blob)
34	    except zlib.error:

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsm_dump_us.py:33
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
32	    try:
33	        blob = zlib.decompress(blob)
34	    except zlib.error:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsms.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
30	    try:
31	        uncompressed_blob = zlib.decompress(blob)
32	        return UnsignedSpend.from_bytes(uncompressed_blob)

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsms.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
30	    try:
31	        uncompressed_blob = zlib.decompress(blob)
32	        return UnsignedSpend.from_bytes(uncompressed_blob)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsmwizard.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
21	            )
22	            r = os.system(cmd)
23	            if r == 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsmwizard.py:22
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
21	            )
22	            r = os.system(cmd)
23	            if r == 0:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsmwizard.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	    with open(wallet_path, "w") as f:
51	        f.write(t)
52	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsmwizard.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
118	            )
119	            r = os.system(cmd)
120	            if r != 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsmwizard.py:119
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
118	            )
119	            r = os.system(cmd)
120	            if r != 0:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsmwizard.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
124	            cmd = f"/usr/bin/touch {wallet_path}.tmp && /bin/rm {wallet_path}.tmp"
125	            r = os.system(cmd)
126	            if r != 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsmwizard.py:125
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
124	            cmd = f"/usr/bin/touch {wallet_path}.tmp && /bin/rm {wallet_path}.tmp"
125	            r = os.system(cmd)
126	            if r != 0:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsmwizard.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
134	    input("hit return to power off> ")
135	    os.system("poweroff")
136	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/hsmwizard.py:135
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
134	    input("hit return to power off> ")
135	    os.system("poweroff")
136	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/qrint.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
9	        with open(p) as f:
10	            text = f.read().strip()
11	    except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/qrint.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	
24	    blob = open(path).read().strip()
25	    decoded = a2b_qrint(blob)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/qrint.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
28	        with open(new_path, "w") as f:
29	            f.write(decoded.hex())
30	        return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/qrint.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
32	    with open(new_path, "wb") as f:
33	        f.write(decoded)
34	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/qrint.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
40	
41	    blob = open(path, "rb").read()
42	    encoded = b2a_qrint(blob)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/qrint.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
43	    with open(new_path, "w") as f:
44	        f.write(encoded)
45	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/cmds/qrint.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	    with open(args.path, "rb") as f:
49	        blob = f.read()
50	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/util/byte_chunks.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
85	def blob_for_zlib_chunks(chunks: List[bytes]) -> bytes:
86	    return zlib.decompress(blob_for_chunks(chunks))
87	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/hsms/util/byte_chunks.py:86
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
85	def blob_for_zlib_chunks(chunks: List[bytes]) -> bytes:
86	    return zlib.decompress(blob_for_chunks(chunks))
87	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/tests/test_cmds.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	                comments.append(line + "\n")  # pragma: no cover
40	            expected_output = f.read()
41	            test_name = os.path.relpath(p, PREFIX).replace(".", "_").replace("/", "_")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/tests/test_cmds.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
79	                f = open(path, "w")
80	                f.write("".join(comments))
81	                for line in cmd_lines[:-1]:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/tests/test_cmds.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
81	                for line in cmd_lines[:-1]:
82	                    f.write(line)
83	                    f.write("\\\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/tests/test_cmds.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	                    f.write(line)
83	                    f.write("\\\n")
84	                f.write(cmd_lines[-1])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/tests/test_cmds.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
83	                    f.write("\\\n")
84	                f.write(cmd_lines[-1])
85	                f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/tests/test_cmds.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	                f.write(cmd_lines[-1])
85	                f.write("\n")
86	                f.write(actual_output)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/tests/test_cmds.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	                f.write("\n")
86	                f.write(actual_output)
87	                f.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/tests/test_coverage.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
102	    with tempfile.NamedTemporaryFile("w") as f:
103	        f.write(hex_blob)
104	        f.flush()

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/tests/test_lifecycle.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
127	    assert unsigned_spend == UnsignedSpend.from_bytes(
128	        zlib.decompress(ChunkAssembler(chunks).assemble())
129	    )

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hsms-0.3.1/hsms-0.3.1/tests/test_lifecycle.py:128
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
127	    assert unsigned_spend == UnsignedSpend.from_bytes(
128	        zlib.decompress(ChunkAssembler(chunks).assemble())
129	    )

--------------------------------------------------

Code scanned:
	Total lines of code: 2739
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 24.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 8.0
Files skipped (0):
