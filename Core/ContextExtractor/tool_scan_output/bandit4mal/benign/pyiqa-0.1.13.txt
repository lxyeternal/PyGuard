Run started:2025-04-12 12:50:52.390467

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/arch_util.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	    elif store_base == "github":
177	        url = f"https://github.com/chaofengc/IQA-PyTorch/releases/download/v0.1-weights/{name}"
178	    return url

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/brisque_arch.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	        assert kernel_size % 2 == 1, f'Kernel size must be odd, got [{kernel_size}]'
160	        assert test_y_channel, f'Only [test_y_channel=True] is supported for current BRISQUE model, which is taken directly from official codes: https://github.com/utlive/BRISQUE.'
161	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/ckdn_arch.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	model_urls = {
29	    'resnet50': 'https://download.pytorch.org/models/resnet50-19c8e357.pth',
30	}
31	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	_MODELS = {
18	    "RN50": "https://openaipublic.azureedge.net/clip/models/afeb0e10f9e5a86da6080e35cf09123aca3b358a0c3e3b6c78a7b63bc04b6762/RN50.pt",
19	    "RN101": "https://openaipublic.azureedge.net/clip/models/8fa8567bab74a42d41c5915025a8e4538c3bdbe8804a470a72f30b0d94fab599/RN101.pt",
20	    "RN50x4": "https://openaipublic.azureedge.net/clip/models/7e526bd135e493cef0776de27d5f42653e6b4c8bf9e0f653bb11773263205fdd/RN50x4.pt",
21	    "RN50x16": "https://openaipublic.azureedge.net/clip/models/52378b407f34354e150460fe41077663dd5b39c54cd0bfd2b27167a4a06ec9aa/RN50x16.pt",
22	    "RN50x64": "https://openaipublic.azureedge.net/clip/models/be1cfb55d75a9666199fb2206c106743da0f6468c9d327f3e0d0a543a9919d9c/RN50x64.pt",
23	    "ViT-B/32": "https://openaipublic.azureedge.net/clip/models/40d365715913c9da98579312b702a82c18be219cc2a73407c4526f58eba950af/ViT-B-32.pt",
24	    "ViT-B/16": "https://openaipublic.azureedge.net/clip/models/5806e77cd80f8b59890b7e101eabd078d9fb84e6937f9e85e4ecb61988df416f/ViT-B-16.pt",
25	    "ViT-L/14": "https://openaipublic.azureedge.net/clip/models/b8cca3fd41ae0c99ba7e8951adf17d267cdb84cd88be6f7c2e0eca1737a03836/ViT-L-14.pt",
26	    "ViT-L/14@336px": "https://openaipublic.azureedge.net/clip/models/3035c92b350959924f9f00213499208652fc7ea050643e8b385c2dac08641f02/ViT-L-14-336px.pt",
27	}
28	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    "RN50": "https://openaipublic.azureedge.net/clip/models/afeb0e10f9e5a86da6080e35cf09123aca3b358a0c3e3b6c78a7b63bc04b6762/RN50.pt",
19	    "RN101": "https://openaipublic.azureedge.net/clip/models/8fa8567bab74a42d41c5915025a8e4538c3bdbe8804a470a72f30b0d94fab599/RN101.pt",
20	    "RN50x4": "https://openaipublic.azureedge.net/clip/models/7e526bd135e493cef0776de27d5f42653e6b4c8bf9e0f653bb11773263205fdd/RN50x4.pt",
21	    "RN50x16": "https://openaipublic.azureedge.net/clip/models/52378b407f34354e150460fe41077663dd5b39c54cd0bfd2b27167a4a06ec9aa/RN50x16.pt",
22	    "RN50x64": "https://openaipublic.azureedge.net/clip/models/be1cfb55d75a9666199fb2206c106743da0f6468c9d327f3e0d0a543a9919d9c/RN50x64.pt",
23	    "ViT-B/32": "https://openaipublic.azureedge.net/clip/models/40d365715913c9da98579312b702a82c18be219cc2a73407c4526f58eba950af/ViT-B-32.pt",
24	    "ViT-B/16": "https://openaipublic.azureedge.net/clip/models/5806e77cd80f8b59890b7e101eabd078d9fb84e6937f9e85e4ecb61988df416f/ViT-B-16.pt",
25	    "ViT-L/14": "https://openaipublic.azureedge.net/clip/models/b8cca3fd41ae0c99ba7e8951adf17d267cdb84cd88be6f7c2e0eca1737a03836/ViT-L-14.pt",
26	    "ViT-L/14@336px": "https://openaipublic.azureedge.net/clip/models/3035c92b350959924f9f00213499208652fc7ea050643e8b385c2dac08641f02/ViT-L-14-336px.pt",
27	}
28	
29	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    "RN101": "https://openaipublic.azureedge.net/clip/models/8fa8567bab74a42d41c5915025a8e4538c3bdbe8804a470a72f30b0d94fab599/RN101.pt",
20	    "RN50x4": "https://openaipublic.azureedge.net/clip/models/7e526bd135e493cef0776de27d5f42653e6b4c8bf9e0f653bb11773263205fdd/RN50x4.pt",
21	    "RN50x16": "https://openaipublic.azureedge.net/clip/models/52378b407f34354e150460fe41077663dd5b39c54cd0bfd2b27167a4a06ec9aa/RN50x16.pt",
22	    "RN50x64": "https://openaipublic.azureedge.net/clip/models/be1cfb55d75a9666199fb2206c106743da0f6468c9d327f3e0d0a543a9919d9c/RN50x64.pt",
23	    "ViT-B/32": "https://openaipublic.azureedge.net/clip/models/40d365715913c9da98579312b702a82c18be219cc2a73407c4526f58eba950af/ViT-B-32.pt",
24	    "ViT-B/16": "https://openaipublic.azureedge.net/clip/models/5806e77cd80f8b59890b7e101eabd078d9fb84e6937f9e85e4ecb61988df416f/ViT-B-16.pt",
25	    "ViT-L/14": "https://openaipublic.azureedge.net/clip/models/b8cca3fd41ae0c99ba7e8951adf17d267cdb84cd88be6f7c2e0eca1737a03836/ViT-L-14.pt",
26	    "ViT-L/14@336px": "https://openaipublic.azureedge.net/clip/models/3035c92b350959924f9f00213499208652fc7ea050643e8b385c2dac08641f02/ViT-L-14-336px.pt",
27	}
28	
29	
30	def _download(url: str, root: str):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    "RN50x4": "https://openaipublic.azureedge.net/clip/models/7e526bd135e493cef0776de27d5f42653e6b4c8bf9e0f653bb11773263205fdd/RN50x4.pt",
21	    "RN50x16": "https://openaipublic.azureedge.net/clip/models/52378b407f34354e150460fe41077663dd5b39c54cd0bfd2b27167a4a06ec9aa/RN50x16.pt",
22	    "RN50x64": "https://openaipublic.azureedge.net/clip/models/be1cfb55d75a9666199fb2206c106743da0f6468c9d327f3e0d0a543a9919d9c/RN50x64.pt",
23	    "ViT-B/32": "https://openaipublic.azureedge.net/clip/models/40d365715913c9da98579312b702a82c18be219cc2a73407c4526f58eba950af/ViT-B-32.pt",
24	    "ViT-B/16": "https://openaipublic.azureedge.net/clip/models/5806e77cd80f8b59890b7e101eabd078d9fb84e6937f9e85e4ecb61988df416f/ViT-B-16.pt",
25	    "ViT-L/14": "https://openaipublic.azureedge.net/clip/models/b8cca3fd41ae0c99ba7e8951adf17d267cdb84cd88be6f7c2e0eca1737a03836/ViT-L-14.pt",
26	    "ViT-L/14@336px": "https://openaipublic.azureedge.net/clip/models/3035c92b350959924f9f00213499208652fc7ea050643e8b385c2dac08641f02/ViT-L-14-336px.pt",
27	}
28	
29	
30	def _download(url: str, root: str):
31	    os.makedirs(root, exist_ok=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    "RN50x16": "https://openaipublic.azureedge.net/clip/models/52378b407f34354e150460fe41077663dd5b39c54cd0bfd2b27167a4a06ec9aa/RN50x16.pt",
22	    "RN50x64": "https://openaipublic.azureedge.net/clip/models/be1cfb55d75a9666199fb2206c106743da0f6468c9d327f3e0d0a543a9919d9c/RN50x64.pt",
23	    "ViT-B/32": "https://openaipublic.azureedge.net/clip/models/40d365715913c9da98579312b702a82c18be219cc2a73407c4526f58eba950af/ViT-B-32.pt",
24	    "ViT-B/16": "https://openaipublic.azureedge.net/clip/models/5806e77cd80f8b59890b7e101eabd078d9fb84e6937f9e85e4ecb61988df416f/ViT-B-16.pt",
25	    "ViT-L/14": "https://openaipublic.azureedge.net/clip/models/b8cca3fd41ae0c99ba7e8951adf17d267cdb84cd88be6f7c2e0eca1737a03836/ViT-L-14.pt",
26	    "ViT-L/14@336px": "https://openaipublic.azureedge.net/clip/models/3035c92b350959924f9f00213499208652fc7ea050643e8b385c2dac08641f02/ViT-L-14-336px.pt",
27	}
28	
29	
30	def _download(url: str, root: str):
31	    os.makedirs(root, exist_ok=True)
32	    filename = os.path.basename(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    "RN50x64": "https://openaipublic.azureedge.net/clip/models/be1cfb55d75a9666199fb2206c106743da0f6468c9d327f3e0d0a543a9919d9c/RN50x64.pt",
23	    "ViT-B/32": "https://openaipublic.azureedge.net/clip/models/40d365715913c9da98579312b702a82c18be219cc2a73407c4526f58eba950af/ViT-B-32.pt",
24	    "ViT-B/16": "https://openaipublic.azureedge.net/clip/models/5806e77cd80f8b59890b7e101eabd078d9fb84e6937f9e85e4ecb61988df416f/ViT-B-16.pt",
25	    "ViT-L/14": "https://openaipublic.azureedge.net/clip/models/b8cca3fd41ae0c99ba7e8951adf17d267cdb84cd88be6f7c2e0eca1737a03836/ViT-L-14.pt",
26	    "ViT-L/14@336px": "https://openaipublic.azureedge.net/clip/models/3035c92b350959924f9f00213499208652fc7ea050643e8b385c2dac08641f02/ViT-L-14-336px.pt",
27	}
28	
29	
30	def _download(url: str, root: str):
31	    os.makedirs(root, exist_ok=True)
32	    filename = os.path.basename(url)
33	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    "ViT-B/32": "https://openaipublic.azureedge.net/clip/models/40d365715913c9da98579312b702a82c18be219cc2a73407c4526f58eba950af/ViT-B-32.pt",
24	    "ViT-B/16": "https://openaipublic.azureedge.net/clip/models/5806e77cd80f8b59890b7e101eabd078d9fb84e6937f9e85e4ecb61988df416f/ViT-B-16.pt",
25	    "ViT-L/14": "https://openaipublic.azureedge.net/clip/models/b8cca3fd41ae0c99ba7e8951adf17d267cdb84cd88be6f7c2e0eca1737a03836/ViT-L-14.pt",
26	    "ViT-L/14@336px": "https://openaipublic.azureedge.net/clip/models/3035c92b350959924f9f00213499208652fc7ea050643e8b385c2dac08641f02/ViT-L-14-336px.pt",
27	}
28	
29	
30	def _download(url: str, root: str):
31	    os.makedirs(root, exist_ok=True)
32	    filename = os.path.basename(url)
33	
34	    expected_sha256 = url.split("/")[-2]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    "ViT-B/16": "https://openaipublic.azureedge.net/clip/models/5806e77cd80f8b59890b7e101eabd078d9fb84e6937f9e85e4ecb61988df416f/ViT-B-16.pt",
25	    "ViT-L/14": "https://openaipublic.azureedge.net/clip/models/b8cca3fd41ae0c99ba7e8951adf17d267cdb84cd88be6f7c2e0eca1737a03836/ViT-L-14.pt",
26	    "ViT-L/14@336px": "https://openaipublic.azureedge.net/clip/models/3035c92b350959924f9f00213499208652fc7ea050643e8b385c2dac08641f02/ViT-L-14-336px.pt",
27	}
28	
29	
30	def _download(url: str, root: str):
31	    os.makedirs(root, exist_ok=True)
32	    filename = os.path.basename(url)
33	
34	    expected_sha256 = url.split("/")[-2]
35	    download_target = os.path.join(root, filename)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    "ViT-L/14": "https://openaipublic.azureedge.net/clip/models/b8cca3fd41ae0c99ba7e8951adf17d267cdb84cd88be6f7c2e0eca1737a03836/ViT-L-14.pt",
26	    "ViT-L/14@336px": "https://openaipublic.azureedge.net/clip/models/3035c92b350959924f9f00213499208652fc7ea050643e8b385c2dac08641f02/ViT-L-14-336px.pt",
27	}
28	
29	
30	def _download(url: str, root: str):
31	    os.makedirs(root, exist_ok=True)
32	    filename = os.path.basename(url)
33	
34	    expected_sha256 = url.split("/")[-2]
35	    download_target = os.path.join(root, filename)
36	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
40	    if os.path.isfile(download_target):
41	        if hashlib.sha256(open(download_target, "rb").read()).hexdigest() == expected_sha256:
42	            return download_target

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
45	
46	    with urllib.request.urlopen(url) as source, open(download_target, "wb") as output:
47	        with tqdm(total=int(source.info().get("Content-Length")), ncols=80, unit='iB', unit_scale=True, unit_divisor=1024) as loop:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	            while True:
49	                buffer = source.read(8192)
50	                if not buffer:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
52	
53	                output.write(buffer)
54	                loop.update(len(buffer))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/clip_model.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
55	
56	    if hashlib.sha256(open(download_target, "rb").read()).hexdigest() != expected_sha256:
57	        raise RuntimeError("Model has been downloaded but the SHA256 checksum does not not match")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/fid_arch.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	    """
109	    base_url = "https://www.cs.cmu.edu/~clean-fid/stats"
110	    if split == "custom":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	    'swin_base_patch4_window12_384': _cfg(
44	        url='https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window12_384_22kto1k.pth',
45	        input_size=(3, 384, 384), crop_pct=1.0),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	    'swin_base_patch4_window7_224': _cfg(
48	        url='https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22kto1k.pth',
49	    ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    'swin_large_patch4_window12_384': _cfg(
52	        url='https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_large_patch4_window12_384_22kto1k.pth',
53	        input_size=(3, 384, 384), crop_pct=1.0),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    'swin_large_patch4_window7_224': _cfg(
56	        url='https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_large_patch4_window7_224_22kto1k.pth',
57	    ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    'swin_small_patch4_window7_224': _cfg(
60	        url='https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_small_patch4_window7_224.pth',
61	    ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	    'swin_tiny_patch4_window7_224': _cfg(
64	        url='https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_tiny_patch4_window7_224.pth',
65	    ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	    'swin_base_patch4_window12_384_in22k': _cfg(
68	        url='https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window12_384_22k.pth',
69	        input_size=(3, 384, 384), crop_pct=1.0, num_classes=21841),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	    'swin_base_patch4_window7_224_in22k': _cfg(
72	        url='https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth',
73	        num_classes=21841),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    'swin_large_patch4_window12_384_in22k': _cfg(
76	        url='https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_large_patch4_window12_384_22k.pth',
77	        input_size=(3, 384, 384), crop_pct=1.0, num_classes=21841),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	    'swin_large_patch4_window7_224_in22k': _cfg(
80	        url='https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_large_patch4_window7_224_22k.pth',
81	        num_classes=21841),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	    'swin_s3_tiny_224': _cfg(
84	        url='https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/s3_t-1d53f6a8.pth'
85	    ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	    'swin_s3_small_224': _cfg(
87	        url='https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/s3_s-3bb4c69d.pth'
88	    ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/archs/topiq_swin.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	    'swin_s3_base_224': _cfg(
90	        url='https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/s3_b-a1e95db4.pth'
91	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/data/data_util.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	        img_paths = sorted(list(scandir(path, full_path=True)))
77	    imgs = [cv2.imread(v).astype(np.float32) / 255. for v in img_paths]
78	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/train_nsplits.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	        print(datasets, metrics)
39	        sf.write('Val Datasets\tSplits\t{}\n'.format('\t'.join(metrics)))
40	        for ds in datasets:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/train_nsplits.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	                results_msg += f"@{all_split_results[i][ds][mt]['iter']:05d}\n"
49	                sf.write(results_msg)
50	                all_results.append(tmp_metric_results)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/train_nsplits.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
52	            results_std =  np.array(all_results).std(axis=0)
53	            sf.write(f'Overall results in {ds}: {results_avg}\t{results_std}\n')
54	                    

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/download_util.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    session = requests.Session()
26	    URL = 'https://docs.google.com/uc?export=download'
27	    params = {'id': file_id}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/download_util.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	
29	    response = session.get(URL, params=params, stream=True)
30	    token = get_confirm_token(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/download_util.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	        params['confirm'] = token
33	        response = session.get(URL, params=params, stream=True)
34	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/download_util.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	    # get file size
36	    response_file_size = session.get(URL, params=params, stream=True, headers={'Range': 'bytes=0-2'})
37	    if 'Content-Range' in response_file_size.headers:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/download_util.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
67	            if chunk:  # filter out keep-alive new chunks
68	                f.write(chunk)
69	        if pbar is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/img_util.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
215	        os.makedirs(dir_name, exist_ok=True)
216	    ok = cv2.imwrite(file_path, img, params)
217	    if not ok:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/lmdb_util.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
83	
84	        pool = Pool(n_thread)
85	        for path, key in zip(img_path_list, keys):

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/lmdb_util.py:84
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
83	
84	        pool = Pool(n_thread)
85	        for path, key in zip(img_path_list, keys):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/lmdb_util.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
94	        # obtain data size for one image
95	        img = cv2.imread(osp.join(data_path, img_path_list[0]), cv2.IMREAD_UNCHANGED)
96	        _, img_byte = cv2.imencode('.png', img, [cv2.IMWRITE_PNG_COMPRESSION, compress_level])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/lmdb_util.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	        # write meta information
121	        txt_file.write(f'{key}.png ({h},{w},{c}) {compress_level}\n')
122	        if idx % batch == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/lmdb_util.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	
146	    img = cv2.imread(path, cv2.IMREAD_UNCHANGED)
147	    if img.ndim == 2:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/lmdb_util.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
187	        h, w, c = img_shape
188	        self.txt_file.write(f'{key}.png ({h},{w},{c}) {self.compress_level}\n')
189	        if self.counter % self.batch == 0:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/pyiqa/utils/options.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
149	            # using exec function
150	            exec(eval_str)
151	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
14	    with open('README.md', encoding='utf-8') as f:
15	        content = f.read()
16	    return content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/setup.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	    with open('VERSION', 'r') as f:
62	        SHORT_VERSION = f.read().strip()
63	    VERSION_INFO = ', '.join([x if x.isdigit() else f'"{x}"' for x in SHORT_VERSION.split('.')])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/setup.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66	    with open(version_file, 'w') as f:
67	        f.write(version_file_str)
68	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/setup.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
71	    with open(version_file, 'r') as f:
72	        exec(compile(f.read(), version_file, 'exec'))
73	    return locals()['__version__']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/setup.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	    with open(version_file, 'r') as f:
72	        exec(compile(f.read(), version_file, 'exec'))
73	    return locals()['__version__']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyiqa-0.1.13/pyiqa-0.1.13/setup.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	        keywords='image quality assessment, pytorch',
94	        url='https://github.com/chaofengc/IQA-PyTorch',
95	        include_package_data=True,

--------------------------------------------------

Code scanned:
	Total lines of code: 17024
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 51.0
		High: 3.0
Files skipped (0):
