Run started:2025-04-12 10:25:55.816613

Test results:
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
381	    def __exit__(self: "Connection", exc_type, exc_value, traceback) -> None:
382	        self.close()
383	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:615
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
614	                _logger.debug("creating tcp/ip socket")
615	                self._usock: typing.Union[socket.socket, "SSLSocket"] = socket.socket(
616	                    socket.AF_INET, socket.SOCK_STREAM
617	                )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:624
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
623	                _logger.debug("creating af_unix socket")
624	                self._usock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
625	            else:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
628	                _logger.debug("set socket timeout=%s", timeout)
629	                self._usock.settimeout(timeout)
630	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
633	                _logger.debug("Attempting to create connection socket with address %s", hostport)
634	                self._usock.connect(hostport)
635	            elif unix_sock is not None:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
636	                _logger.debug("connecting to socket with unix socket")
637	                self._usock.connect(unix_sock)
638	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
662	                    _logger.debug("Sending SSLRequestMessage to BE")
663	                    self._usock.sendall(ii_pack(8, 80877103))
664	                    resp: bytes = self._usock.recv(1)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
663	                    self._usock.sendall(ii_pack(8, 80877103))
664	                    resp: bytes = self._usock.recv(1)
665	                    if resp != b"S":

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
688	        except socket.timeout as timeout_error:
689	            self._usock.close()
690	            raise OperationalError("connection time out", timeout_error)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
696	                pass
697	            self._usock.close()
698	            raise InterfaceError("communication error", e)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
758	        # and then send the message to the database
759	        self._write(i_pack(len(val) + 4))
760	        self._write(val)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
759	        self._write(i_pack(len(val) + 4))
760	        self._write(val)
761	        self._flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
774	            # then can use this length to minus 4 to get the real data.
775	            buffer = self._read(5)
776	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
774	            # then can use this length to minus 4 to get the real data.
775	            buffer = self._read(5)
776	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
790	            _logger.debug("Wire message from BE Code=%s", code)
791	            self.message_types[code](self._read(data_len - 4), None)
792	        if self.error is not None:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
790	            _logger.debug("Wire message from BE Code=%s", code)
791	            self.message_types[code](self._read(data_len - 4), None)
792	        if self.error is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1195	        _logger.debug("CopyData received from BE")
1196	        ps.stream.write(data)
1197	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1242	                break
1243	            self._write(COPY_DATA + i_pack(bytes_read + 4))
1244	            self._write(bffr[:bytes_read])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1243	            self._write(COPY_DATA + i_pack(bytes_read + 4))
1244	            self._write(bffr[:bytes_read])
1245	            self._flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1250	        _logger.debug("Sending CopyDone message to BE")
1251	        self._write(COPY_DONE_MSG)
1252	        _logger.debug("Sending Sync message to BE")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1252	        _logger.debug("Sending Sync message to BE")
1253	        self._write(SYNC_MSG)
1254	        self._flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1373	            _logger.debug("Sending Terminate message to BE")
1374	            self._write(TERMINATE_MSG)
1375	            self._flush()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1376	            if self._sock is not None:
1377	                self._sock.close()
1378	        except AttributeError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1384	        finally:
1385	            self._usock.close()
1386	            self._sock = None  # type: ignore

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1469	            _logger.debug("Sending SASLInitialResponse to BE")
1470	            self._write(create_message(PASSWORD, b"SCRAM-SHA-256" + NULL_BYTE + i_pack(len(init)) + init))
1471	            self._flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1480	            msg: bytes = self.auth.get_client_final().encode("utf8")
1481	            self._write(create_message(PASSWORD, msg))
1482	            self._flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1500	            token: bytes = nativeidp_or_idcpez_token.encode(encoding="utf-8")
1501	            self._write(create_message(b"i", token))
1502	            # self._write(NULL_BYTE)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1554	
1555	            self._write(b"d")
1556	            self._write(i_pack(4 + 4 + len(digest) + 4 + len(client_nonce)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1555	            self._write(b"d")
1556	            self._write(i_pack(4 + 4 + len(digest) + 4 + len(client_nonce)))
1557	            self._write(i_pack(len(digest)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1556	            self._write(i_pack(4 + 4 + len(digest) + 4 + len(client_nonce)))
1557	            self._write(i_pack(len(digest)))
1558	            self._write(digest)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1557	            self._write(i_pack(len(digest)))
1558	            self._write(digest)
1559	            self._write(i_pack(len(client_nonce)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1558	            self._write(digest)
1559	            self._write(i_pack(len(client_nonce)))
1560	            self._write(client_nonce)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1559	            self._write(i_pack(len(client_nonce)))
1560	            self._write(client_nonce)
1561	            self._flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1901
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1900	            _logger.debug("Sending Sync message to BE")
1901	            self._write(SYNC_MSG)
1902	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1988	        _logger.debug("Sending Sync message to BE")
1989	        self._write(SYNC_MSG)
1990	        self._flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1994
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1993	        if self.merge_socket_read:
1994	            self.handle_messages_merge_socket_read(cursor)
1995	        else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:1994
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1993	        if self.merge_socket_read:
1994	            self.handle_messages_merge_socket_read(cursor)
1995	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2000	        try:
2001	            self._write(code)
2002	            self._write(i_pack(len(data) + 4))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2001	            self._write(code)
2002	            self._write(i_pack(len(data) + 4))
2003	            self._write(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2002	            self._write(i_pack(len(data) + 4))
2003	            self._write(data)
2004	            self._write(FLUSH_MSG)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2003	            self._write(data)
2004	            self._write(FLUSH_MSG)
2005	        except ValueError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2039	        _logger.debug("Sending Execute message to BE")
2040	        self._write(EXECUTE_MSG)
2041	        _logger.debug("Sending Flush message to BE")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2041	        _logger.debug("Sending Flush message to BE")
2042	        self._write(FLUSH_MSG)
2043	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2183	        while code != READY_FOR_QUERY:
2184	            buffer = self._read(5)
2185	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2183	        while code != READY_FOR_QUERY:
2184	            buffer = self._read(5)
2185	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2199	            _logger.debug("Message received from BE with code %s length %s ", code, data_len)
2200	            self.message_types[code](self._read(data_len - 4), cursor)
2201	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2199	            _logger.debug("Message received from BE with code %s length %s ", code, data_len)
2200	            self.message_types[code](self._read(data_len - 4), cursor)
2201	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2219	        # read 5 bytes of message firstly
2220	        buffer = self._read(5)
2221	        if len(buffer) == 0:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2219	        # read 5 bytes of message firstly
2220	        buffer = self._read(5)
2221	        if len(buffer) == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2238	                # for last message
2239	                self.message_types[code](self._read(data_len - 4), cursor)
2240	                break

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2238	                # for last message
2239	                self.message_types[code](self._read(data_len - 4), cursor)
2240	                break

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2242	                # read data body of last message and read next 5 bytes of next message
2243	                data = self._read(data_len - 4 + 5)
2244	                last_message_body = data[0:-5]

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2242	                # read data body of last message and read next 5 bytes of next message
2243	                data = self._read(data_len - 4 + 5)
2244	                last_message_body = data[0:-5]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/core.py:2281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2280	        _logger.debug("Sending Sync message to BE")
2281	        self._write(SYNC_MSG)
2282	        self._flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/adfs_credentials_provider.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	
50	        url: str = "https://{host}:{port}/adfs/ls/IdpInitiatedSignOn.aspx?loginToRp={loginToRp}".format(
51	            host=self.idp_host, port=str(self.idpPort), loginToRp=self.login_to_rp

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/adfs_credentials_provider.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	            _logger.debug("Issuing GET request uri=%s verify=%s", url, self.do_verify_ssl_cert())
58	            response: "requests.Response" = requests.get(url, verify=self.do_verify_ssl_cert())
59	            _logger.debug("Response code: %s", response.status_code)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/adfs_credentials_provider.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	        for inputtag in soup.find_all(re.compile("(INPUT|input)")):
98	            name: str = inputtag.get("name", "")
99	            value: str = inputtag.get("value", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/adfs_credentials_provider.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	            name: str = inputtag.get("name", "")
99	            value: str = inputtag.get("value", "")
100	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/adfs_credentials_provider.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	        if action and action.startswith("/"):
118	            url = "https://{host}:{port}{action}".format(host=self.idp_host, port=str(self.idpPort), action=action)
119	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/adfs_credentials_provider.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
124	            _logger.debug("Issuing POST request uri=%s verify=%s", url, self.do_verify_ssl_cert())
125	            response = requests.post(url, data=payload, verify=self.do_verify_ssl_cert())
126	            _logger.debug("Response code: %s", response.status_code)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/adfs_credentials_provider.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
155	        for inputtag in soup.find_all("input"):
156	            if inputtag.get("name") == "SAMLResponse":
157	                _logger.debug("SAMLResponse HTML input tag found in ADFS authentication response payload")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/adfs_credentials_provider.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	                _logger.debug("SAMLResponse HTML input tag found in ADFS authentication response payload")
158	                assertion = inputtag.get("value")
159	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/azure_credentials_provider.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	        # endpoint to connect with Microsoft Azure to get SAML Assertion token
66	        url: str = "https://login.microsoftonline.com/{tenant}/oauth2/token".format(tenant=self.idp_tenant)
67	        _logger.debug("Uri: %s", url)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/azure_credentials_provider.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
84	            _logger.debug("Issuing POST request uri=%s verify=%s", url, self.do_verify_ssl_cert())
85	            response: "requests.Response" = requests.post(
86	                url, data=payload, headers=headers, verify=self.do_verify_ssl_cert()
87	            )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/azure_credentials_provider.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
136	            _logger.debug("attempting to decode SAML assertion")
137	            decoded_saml_assertion = str(base64.urlsafe_b64decode(saml_assertion))
138	        except TypeError as e:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/azure_credentials_provider.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
159	        _logger.debug("Base64 encoding SAML response")
160	        saml_response = str(base64.b64encode(saml_response.encode("utf-8")))[2:-1]
161	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/azure_credentials_provider.py:160
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
159	        _logger.debug("Base64 encoding SAML response")
160	        saml_response = str(base64.b64encode(saml_response.encode("utf-8")))[2:-1]
161	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
35	    def get_listen_socket(self: "BrowserAzureCredentialsProvider") -> socket.socket:
36	        s: socket.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
37	        _logger.debug("Attempting socket bind on localhost with any free port")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
37	        _logger.debug("Attempting socket bind on localhost with any free port")
38	        s.bind(("127.0.0.1", 0))  # bind to any free port
39	        s.listen()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	        listen_socket: socket.socket = self.get_listen_socket()
68	        self.redirectUri = "http://localhost:{port}/redshift/".format(port=self.listen_port)
69	        _logger.debug("Listening for connection using %s", self.redirectUri)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
76	        finally:
77	            listen_socket.close()
78	        _logger.debug("Got SAML assertion")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
91	            return_value: str = ""
92	            with concurrent.futures.ThreadPoolExecutor() as executor:
93	                future = executor.submit(self.run_server, listen_socket, self.idp_response_timeout, state)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	
113	        url: str = "https://login.microsoftonline.com/{tenant}/oauth2/token".format(tenant=self.idp_tenant)
114	        # headers to pass with POST request

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
131	        try:
132	            response = requests.post(url, data=payload, headers=headers, verify=self.do_verify_ssl_cert())
133	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
178	
179	        return str(base64.urlsafe_b64decode(saml_assertion))
180	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
194	
195	        return str(base64.b64encode(saml_response.encode("utf-8")))[2:-1]
196	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:195
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
194	
195	        return str(base64.b64encode(saml_response.encode("utf-8")))[2:-1]
196	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
201	        conn, addr = listen_socket.accept()
202	        conn.settimeout(float(idp_response_timeout))
203	        size: int = 102400

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
205	            while True:
206	                part: bytes = conn.recv(size)
207	                decoded_part = part.decode()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
232	                        raise InterfaceError(exec_msg)
233	                    conn.send(self.close_window_http_resp())
234	                    return received_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_credentials_provider.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	        url: str = (
242	            "https://login.microsoftonline.com/{tenant}"
243	            "/oauth2/authorize"

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
117	        _logger.debug("local server socket connection established")
118	        conn.settimeout(float(idp_response_timeout))
119	        size: int = 102400

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
121	            while True:
122	                part: bytes = conn.recv(size)
123	                decoded_part = part.decode()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
151	                        raise InterfaceError(exec_msg)
152	                    conn.send(self.close_window_http_resp())
153	                    return received_code

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py:182
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
181	        """
182	        s: socket.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
183	        _logger.debug("attempting socket bind on localhost with any free port")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
183	        _logger.debug("attempting socket bind on localhost with any free port")
184	        s.bind(("127.0.0.1", 0))  # bind to any free port
185	        s.listen()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	        listen_socket: socket.socket = self.get_listen_socket()
229	        self.redirectUri = "http://localhost:{port}/redshift/".format(port=self.listen_port)
230	        _logger.debug("redirectUri=%s", self.redirectUri)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
232	            return_value: str = ""
233	            with concurrent.futures.ThreadPoolExecutor() as executor:
234	                future = executor.submit(self.run_server, listen_socket, self.idp_response_timeout, state)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
245	        finally:
246	            listen_socket.close()
247	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_azure_oauth2_credentials_provider.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
275	        _logger.debug("Issuing POST request uri=%s verify=%s", url, self.do_verify_ssl_cert())
276	        response: requests.Response = requests.post(
277	            url, data=params, headers=azure_headers, verify=self.do_verify_ssl_cert()
278	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    AUTH_CODE_GRANT_TYPE = "authorization_code"
56	    REDIRECT_URI = "http://127.0.0.1"
57	    AUTHORIZE_ENDPOINT = "/authorize"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
197	        random_bytes = os.urandom(self.CODE_VERIFIER_LENGTH)
198	        base64_encoded = base64.urlsafe_b64encode(random_bytes).decode("utf-8")
199	        base64_encoded_no_newline = base64_encoded.replace("\n", "")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
212	        sha256_hash = hashlib.sha256(code_verifier.encode("ascii")).digest()
213	        code_challenge = base64.urlsafe_b64encode(sha256_hash).rstrip(b"=").decode("ascii")
214	        return code_challenge

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
231	        try:
232	            listen_socket.settimeout(float(self.idp_response_timeout))
233	            server_thread = threading.Thread(target=self.run_server, args=(listen_socket, state))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
232	            listen_socket.settimeout(float(self.idp_response_timeout))
233	            server_thread = threading.Thread(target=self.run_server, args=(listen_socket, state))
234	            server_thread.start()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
245	        finally:
246	            listen_socket.close()
247	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
297	        random_bytes = os.urandom(self.STATE_LENGTH)
298	        random_state = base64.urlsafe_b64encode(random_bytes).decode("utf-8").rstrip("=")
299	        return random_state

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
319	            while True:
320	                part: bytes = conn.recv(size)
321	                decoded_part = part.decode()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
348	                        raise InterfaceError("No valid authorization code found")
349	                    conn.send(self.close_window_http_resp())
350	                    self.auth_code = received_code

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:408
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
407	        """
408	        s: socket.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
409	        s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_idc_auth_plugin.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
410	        _logger.debug("Attempting socket bind on port {}".format(str(listen_port)))
411	        s.bind(("127.0.0.1", listen_port))
412	        s.listen()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_saml_credentials_provider.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
60	        try:
61	            with concurrent.futures.ThreadPoolExecutor() as executor:
62	                _logger.debug("Listening for connection on port %s", self.listen_port)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_saml_credentials_provider.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
77	        _logger.debug("BrowserSamlCredentialsProvider.run_server")
78	        HOST: str = "127.0.0.1"
79	        PORT: int = listen_port

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_saml_credentials_provider.py:81
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
80	
81	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
82	            s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_saml_credentials_provider.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
87	            _logger.debug("Localhost socket connection established for Browser SAML IdP")
88	            conn.settimeout(float(idp_response_timeout))
89	            size: int = 102400

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_saml_credentials_provider.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
91	                while True:
92	                    part: bytes = conn.recv(size)
93	                    decoded_part: str = part.decode()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/browser_saml_credentials_provider.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
99	                    if result is not None:
100	                        conn.send(self.close_window_http_resp())
101	                        saml_resp_block: str = decoded_part[result.regs[0][1] :]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/okta_credentials_provider.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        # HTTP Post request to Okta API for session token
46	        url: str = "https://{host}/api/v1/authn".format(host=self.idp_host)
47	        _logger.debug("Okta authentication request uri: %s", url)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/okta_credentials_provider.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
54	            _logger.debug("Issuing Okta authentication request using uri %s verify %s", url, self.do_verify_ssl_cert())
55	            response: "requests.Response" = requests.post(
56	                url, data=json.dumps(payload), headers=headers, verify=self.do_verify_ssl_cert()
57	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/okta_credentials_provider.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	
117	        url: str = "https://{host}/home/{app_name}/{app_id}?onetimetoken={session_token}".format(
118	            host=self.idp_host, app_name=self.app_name, app_id=self.app_id, session_token=okta_session_token

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/okta_credentials_provider.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	            )
127	            response: "requests.Response" = requests.get(url, verify=self.do_verify_ssl_cert())
128	            _logger.debug("Response code: %s", response.status_code)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/ping_credentials_provider.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	
39	            url: str = "https://{host}:{port}/idp/startSSO.ping?PartnerSpId={sp_id}".format(
40	                host=self.idp_host, port=str(self.idpPort), sp_id=self.partner_sp_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/ping_credentials_provider.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	                )
47	                response: "requests.Response" = session.get(url, verify=self.do_verify_ssl_cert())
48	                _logger.debug("Response code: %s", response.status_code)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/ping_credentials_provider.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	            for inputtag in soup.find_all(re.compile("(INPUT|input)")):
95	                name: str = inputtag.get("name", "")
96	                id: str = inputtag.get("id", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/ping_credentials_provider.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	                name: str = inputtag.get("name", "")
96	                id: str = inputtag.get("id", "")
97	                value: str = inputtag.get("value", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/ping_credentials_provider.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	                id: str = inputtag.get("id", "")
97	                value: str = inputtag.get("value", "")
98	                _logger.debug("name=%s , id=%s", name, id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/ping_credentials_provider.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	                for inputtag in soup.find_all(re.compile("(INPUT|input)")):
118	                    name = inputtag.get("name", "")
119	                    if self.is_text(inputtag) and ("user" in name or "email" in name):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/ping_credentials_provider.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
135	            if action and action.startswith("/"):
136	                url = "https://{host}:{port}{action}".format(host=self.idp_host, port=str(self.idpPort), action=action)
137	            _logger.debug("Action uri: %s", url)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/ping_credentials_provider.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
142	                )
143	                response = session.post(url, data=payload, verify=self.do_verify_ssl_cert())
144	                _logger.debug("Response code: %s", response.status_code)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/ping_credentials_provider.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	            for inputtag in soup.find_all("input"):
178	                if inputtag.get("name") == "SAMLResponse":
179	                    _logger.debug("SAMLResponse tag found")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/ping_credentials_provider.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	                    _logger.debug("SAMLResponse tag found")
180	                    assertion = inputtag.get("value")
181	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
104	        # decode SAML assertion into xml format
105	        doc: bytes = base64.b64decode(saml_assertion)
106	        _logger.debug("decoded SAML assertion into xml format")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:105
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
104	        # decode SAML assertion into xml format
105	        doc: bytes = base64.b64decode(saml_assertion)
106	        _logger.debug("decoded SAML assertion into xml format")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	            values: typing.Any = attr.findAll("AttributeValue")
117	            if name == "https://aws.amazon.com/SAML/Attributes/Role":
118	                _logger.debug("Attribute with name %s found. Checking if pattern match occurs", name)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	        if len(roles) == 0:
137	            exec_msg = "No roles were found in SAML assertion. Please verify IdP configuration provides ARNs in the SAML https://aws.amazon.com/SAML/Attributes/Role Attribute."
138	            _logger.debug(exec_msg)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	            if role_arn not in roles:
146	                exec_msg = "User specified preferred_role was not found in SAML assertion https://aws.amazon.com/SAML/Attributes/Role Attribute"
147	                _logger.debug(exec_msg)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	            _logger.debug(
152	                "User did not specify a preferred_role. A randomly selected role from the SAML assertion https://aws.amazon.com/SAML/Attributes/Role Attribute will be used."
153	            )
154	            role_arn = random.choice(list(roles))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
256	
257	                if name == "https://redshift.amazon.com/SAML/Attributes/AllowDbUserOverride":
258	                    metadata.set_allow_db_user_override(value)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	                    metadata.set_allow_db_user_override(value)
259	                elif name == "https://redshift.amazon.com/SAML/Attributes/DbUser":
260	                    metadata.set_saml_db_user(value)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
260	                    metadata.set_saml_db_user(value)
261	                elif name == "https://aws.amazon.com/SAML/Attributes/RoleSessionName":
262	                    if metadata.get_saml_db_user() is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
263	                        metadata.set_saml_db_user(value)
264	                elif name == "https://redshift.amazon.com/SAML/Attributes/AutoCreate":
265	                    metadata.set_auto_create(value)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	                    metadata.set_auto_create(value)
266	                elif name == "https://redshift.amazon.com/SAML/Attributes/DbGroups":
267	                    metadata.set_db_groups([value.contents[0].lower() for value in values])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redshift_connector-2.1.5-py3-none-any/redshift_connector/plugin/saml_credentials_provider.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
267	                    metadata.set_db_groups([value.contents[0].lower() for value in values])
268	                elif name == "https://redshift.amazon.com/SAML/Attributes/ForceLowercase":
269	                    metadata.set_force_lowercase(value)

--------------------------------------------------

Code scanned:
	Total lines of code: 9926
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 98.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 124.0
		High: 9.0
Files skipped (0):
