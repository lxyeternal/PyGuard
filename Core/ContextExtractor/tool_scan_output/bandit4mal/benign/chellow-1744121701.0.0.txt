Run started:2025-04-12 11:37:35.235890

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/bank_holidays.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	
30	    if contract_props.get("enabled", False):
31	        url_str = contract_props["url"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/bank_holidays.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	        log_f(f"Downloading from {url_str}.")
34	        res = requests.get(url_str)
35	        log_f(" ".join(("Received", str(res.status_code), res.reason)))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/commands.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
19	    daemon.open()
20	    waitress.serve(app, host="0.0.0.0", port=chellow_port)
21	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/commands.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	    with open(pidfile_path) as pidfile:
25	        pid = int(pidfile.read())
26	        os.kill(pid, signal.SIGTERM)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/dloads.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
64	        self._check_exists()
65	        return self.f.write(*args, **kwargs)
66	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/bmarketidx.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	    month_finish_ct = to_ct(month_finish)
170	    base_url = "https://data.elexon.co.uk/bmrs/api/v1/balancing/pricing/market-index"
171	    for d in range(month_finish_ct.day):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/bmarketidx.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	        log_f(f"Attempting to download {base_url}?{q_str}")
183	        r = requests.get(base_url, params=params, timeout=60, verify=False)
184	        res = r.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/bsuos.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	
130	BASE_URL = "https://data.nationalgrideso.com/backend/dataset/"
131	PATHS = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/bsuos.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	                        s.verify = False
182	                        if props.get("enabled", False):
183	                            for path in PATHS:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/bsuos.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
210	    sess.rollback()  # Avoid long-running transaction
211	    res = s.get(url)
212	    logger(f"Received {res.status_code} {res.reason}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/bsuos.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
391	            rs_1_script = rs_1.make_script()
392	            if rs_1_script.get("a_file_name") != file_name:
393	                log(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/bsuos.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
400	            rs_2_script = rs_2.make_script()
401	            if rs_2_script.get("a_file_name") != file_name:
402	                log(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/bsuos.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
428	    }
429	    res_j = api_get(s, "datastore_search_sql", params=params)
430	    for record in res_j["result"]["records"]:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/computer.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
115	            ns = {"db_id": contract.id, "properties": contract.make_properties()}
116	            exec(contract.charge_script, ns)
117	            contr_func_cache[contract.id] = ns

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/elexon.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	def api_sql(s, sql):
23	    url = "https://dp.lowcarboncontracts.uk/api/3/action/datastore_search_sql"
24	    params = {"sql": sql}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/elexon.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	    params = {"sql": sql}
25	    res = s.get(url, params=params)
26	    try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/elexon.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	def api_search(s, resource_id, sort=None):
41	    url = "https://dp.lowcarboncontracts.uk/api/3/action/datastore_search"
42	    params = {"resource_id": resource_id}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/elexon.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	        params["sort"] = sort
45	    res = s.get(url, params=params)
46	    try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/elexon.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	                    state = config.make_state()
107	                    elexon_state = state.get(ELEXON_STATE_KEY, {})
108	                except BaseException as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/elexon.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	
114	            last_run = elexon_state.get(LAST_RUN_KEY)
115	            if last_run is None or utc_datetime_now() - last_run > timedelta(days=1):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/elexon.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	                        props = config.make_properties()
132	                        scripting_key = props.get(ELEXON_PORTAL_SCRIPTING_KEY_KEY)
133	                        sess.commit()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/hh_importer.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	                properties = contract.make_properties()
81	                mpan_map = properties.get("mpan_map", {})
82	                mod_name = self.conv_ext[0][1:].replace(".", "_")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/hh_importer.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
173	                    self.log(f"Protocol '{protocol}' not recognized.")
174	                self.wait_seconds = properties.get("check_minutes", 30) * 60
175	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/hh_importer.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
306	        username = properties["username"]
307	        password = properties.get("password")
308	        private_key = properties.get("private_key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/hh_importer.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
307	        password = properties.get("password")
308	        private_key = properties.get("private_key")
309	        pkey = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/hh_importer.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
314	
315	        port = properties.get("port", 22)
316	        file_type = properties["file_type"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/hh_importer.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
362	            with hfname.open() as hf:
363	                host_keys_str = hf.read().strip()
364	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/hh_importer.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
573	    url_template_str = properties["url_template"]
574	    url_values = properties.get("url_values", {})
575	    download_days = properties["download_days"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/hh_importer.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
605	            vals = {"chunk_start": chunk_start, "chunk_finish": chunk_finish}
606	            vals.update(url_values.get(mpan_core, {}))
607	            try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/hh_importer.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
621	            s.verify = False
622	            res = s.get(url, timeout=120)
623	            res.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/hh_importer.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
632	def get_hh_import_task(contract):
633	    return tasks.get(contract.id)
634	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/lcc.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	def api_records(log, s, resource_id, skip=0):
23	    url = f"https://dp.lowcarboncontracts.uk/datastore/dump/{resource_id}"
24	    params = {"format": "json"}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/lcc.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	    params = {"format": "json"}
25	    res = s.get(url, params=params)
26	    log(f"Requested URL {res.url}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/lcc.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	                    state = config.make_state()
93	                    lcc_state = state.get(LCC_STATE_KEY, {})
94	                except BaseException as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/lcc.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	
100	            last_run = lcc_state.get(LAST_RUN_KEY)
101	            if last_run is None or utc_datetime_now() - last_run > timedelta(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/rcrc.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
102	        params = {"key": scripting_key}
103	        url_str = "https://downloads.elexonportal.co.uk/file/download/RCRC_FILE"
104	        log(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/system_price.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	    params = {"key": scripting_key}
101	    url = "https://downloads.elexonportal.co.uk/file/download/BESTVIEWPRICES_FILE"
102	
103	    log(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/tlms.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	        params = {"key": scripting_key}
130	        url_str = "https://downloads.elexonportal.co.uk/file/download/TLM_FILE"
131	        complete_date = _find_complete_date(caches, sess, contract, cache)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/views.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
696	        batch_file = batch.insert_file(
697	            g.sess, file_item.filename, file_item.stream.read(), parser_name
698	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/views.py:1239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1238	        file_item = req_file("import_file")
1239	        f = BytesIO(file_item.stream.read())
1240	        f.seek(0, os.SEEK_END)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/views.py:2788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2787	        batch_file = batch.insert_file(
2788	            g.sess, file_item.filename, file_item.stream.read(), parser_name
2789	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/views.py:3807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3806	
3807	        bill.insert_read(
3808	            g.sess,
3809	            tpr,
3810	            coefficient,
3811	            units_str,
3812	            msn,
3813	            mpan_str,
3814	            previous_date,
3815	            previous_value,
3816	            previous_type,
3817	            present_date,
3818	            present_value,
3819	            present_type,
3820	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/views.py:4230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4229	        args = mem_id, site.id, start_date
4230	        threading.Thread(target=totals_runner, args=args).start()
4231	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/e/views.py:5122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5121	        batch_file = batch.insert_file(
5122	            g.sess, filename, file_item.stream.read(), parser_name
5123	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/gas/cv.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	    props = g_contract.make_properties()
97	    if not props.get("enabled", False):
98	        log_f(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/gas/cv.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	    url = (
115	        f"https://data.nationalgas.com/api/find-gas-data-download?applicableFor=N&"
116	        f"dateFrom={param_format(search_start)}&dateTo={param_format(search_finish)}&"
117	        f"dateType=NORMALDAY&latestFlag=Y&ids=PUBOBJ1660,PUBOB4507,PUBOB4508,PUBOB4510,"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/gas/cv.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	    s.verify = False
129	    res = s.get(url)
130	    log_f(f"Received {res.status_code} {res.reason}")

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/gas/engine.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
100	            ns = {"db_id": contract.id, "properties": contract.make_properties()}
101	            exec(contract.charge_script, ns)
102	            contr_func_cache[contract.id] = ns

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/models.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
179	def log_message(msg):
180	    sys.stderr.write(str(msg) + "\n")
181	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/models.py:6486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6485	    with open(os.path.join(pth, fname), "r") as f:
6486	        contents = f.read()
6487	    if attr is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/models.py:6788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6787	                "enabled": True,
6788	                "url": "https://www.gov.uk/bank-holidays/england-and-wales.ics",
6789	            },
6790	        ),
6791	        ("bmarketidx", {}),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/models.py:6863
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6862	                "enabled": True,
6863	                "url": "http://mip-prd-web.azurewebsites.net/DataItemViewer/"
6864	                "DownloadFile",
6865	            },
6866	            {},
6867	        ),
6868	        ("dn", {}, {}),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/national_grid.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	def api_get(s, path, params=None):
23	    url = f"https://api.nationalgrideso.com/api/3/action/{path}"
24	    res = s.get(url, params=params, timeout=120)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/national_grid.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	    url = f"https://api.nationalgrideso.com/api/3/action/{path}"
24	    res = s.get(url, params=params, timeout=120)
25	    try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/national_grid.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
86	                    state = config.make_state()
87	                    ng_state = state.get(NG_STATE_KEY, {})
88	                except BaseException as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/national_grid.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	
94	            last_run = ng_state.get(LAST_RUN_KEY)
95	            if last_run is None or utc_datetime_now() - last_run > timedelta(days=1):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	def api_get(s, url, params=None):
24	    res = s.get(url, params=params)
25	    try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	def download(s, url):
39	    fl_json = api_get(s, url)
40	    return b64decode(fl_json["content"])

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
39	    fl_json = api_get(s, url)
40	    return b64decode(fl_json["content"])
41	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
39	    fl_json = api_get(s, url)
40	    return b64decode(fl_json["content"])
41	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	    props = conf.make_properties()
47	    repo_props = props.get("rate_server", {})
48	    repo_url = repo_props.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	    repo_props = props.get("rate_server", {})
48	    repo_url = repo_props.get(
49	        "url", "https://api.github.com/repos/WessexWater/chellow-rates"
50	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	    repo_url = repo_props.get(
49	        "url", "https://api.github.com/repos/WessexWater/chellow-rates"
50	    )
51	    repo_branch = repo_props.get("branch", "main")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
50	    )
51	    repo_branch = repo_props.get("branch", "main")
52	    s = requests.Session()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	
55	    repo_entry = api_get(s, repo_url)
56	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	    )
61	    branch_entry = api_get(s, f"{repo_url}/branches/{repo_branch}")
62	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	
63	    tree_entry = api_get(
64	        s,
65	        branch_entry["commit"]["commit"]["tree"]["url"],
66	        params={"recursive": "true"},
67	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/rate_server.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	
142	            last_run = state.get(LAST_RUN_KEY)
143	            if last_run is None or utc_datetime_now() - last_run > timedelta(days=1):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_181.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
169	    year = req_int("year")
170	    threading.Thread(target=content, args=(year, site_id, g.user.id)).start()
171	    return redirect("/downloads", 303)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_33.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
54	        msg = traceback.format_exc()
55	        sys.stderr.write(msg)
56	        f.write(msg)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_33.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
55	        sys.stderr.write(msg)
56	        f.write(msg)
57	    finally:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_33.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
528	    args = user.id, date, supply_id, mpan_cores
529	    threading.Thread(target=content, args=args).start()
530	    return redirect("/downloads", 303)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_41.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
201	        msg = traceback.format_exc()
202	        sys.stderr.write(msg)
203	        writer.writerow([msg])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_41.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
211	    supply_id = req_int("supply_id") if "supply_id" in request.values else None
212	    threading.Thread(target=content, args=(year, supply_id, g.user.id)).start()
213	    return redirect("/downloads", 303)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_ecoes_comparison.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	            ignore_mpan_cores_msn = ecoes_props["ignore_mpan_cores_msn"]
79	            url_prefix = "https://www.ecoes.co.uk/"
80	
81	            proxies = props.get("proxies", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_ecoes_comparison.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	
81	            proxies = props.get("proxies", {})
82	            s = requests.Session()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_ecoes_comparison.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	            s.verify = False
84	            r = s.get(url_prefix, proxies=proxies)
85	            data = {

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_ecoes_comparison.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
88	            }
89	            login_j = s.post(url_prefix, data=data, allow_redirects=False).json()
90	            if not login_j["Success"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/reports/report_ecoes_comparison.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	
98	            r = s.get(
99	                f"{url_prefix}PortfolioAccess/ExportPortfolioMPANs?fileType=csv",
100	                proxies=proxies,
101	            )

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/testing.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
86	    ns = {"report_id": report.id, "template": report.template}
87	    exec(code, ns)
88	    if "test" in ns:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/testing.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
98	    ns = {"db_id": contract.id}
99	    exec(code, ns)
100	    if "test" in ns:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/testing.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
110	    ns = {"db_id": g_contract.id, "properties": g_contract.make_properties()}
111	    exec(code, ns)
112	    if "test" in ns:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/utils.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
122	    gb = {}
123	    exec(contract.charge_script, gb)
124	    return gb.get(func_name)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/views.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
169	        code = compile(report.script, f"<string report {report_id}>", "exec")
170	        exec(code, ns)
171	        return ns["do_get"]()

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/views.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
181	        code = compile(report.script, f"<string report {report_id}>", "exec")
182	        exec(code, ns)
183	        return ns["do_post"]()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/views.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
724	        f = StringIO(
725	            str(file_item.stream.read(), encoding="utf-8-sig", errors="ignore")
726	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/views.py:763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
762	            edi_str = str(
763	                file_item.stream.read(), encoding="utf-8-sig", errors="ignore"
764	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/chellow/views.py:1272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1271	                while True:
1272	                    data = fl.read(DEFAULT_BUFFER_SIZE)
1273	                    if len(data) == 0:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/e/system_price/test_system_price.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	        "Starting to check System Prices.",
54	        "Downloading from "
55	        "https://downloads.elexonportal.co.uk/file/download/BESTVIEWPRICES_FILE?"
56	        "key=xxx and extracting data from 2001-04-01 01:00",
57	        "Received 200 OK",
58	        "Successfully extracted data.",
59	        "Updating rate script starting at 2001-04-01 01:00.",
60	    ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/e/test_hh_importer.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	        "parser": "meniscus",
153	        "url_template": "https://example.com/?from="
154	        "{{chunk_start.strftime('%d/%m/%Y')}}&to="
155	        "{{chunk_finish.strftime('%d/%m/%Y')}}",
156	        "url_values": {"22 7907 4116 080": {"api_key": "768234ht"}},
157	    }
158	
159	    now = utc_datetime(2020, 12, 22)
160	
161	    https_handler(sess, log_f, properties, dc_contract, now=now)
162	    expected_log = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/e/test_hh_importer.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	        "Looking at MPAN core 22 7867 6232 781.",
166	        "Retrieving data from https://example.com/?from=14/12/2020&to=21/12/2020.",
167	        "Finished loading.",
168	    ]
169	    assert log == expected_log
170	    mock_s.get.assert_called_once()
171	
172	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/e/test_tlms.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
196	    Contract.insert_non_core(
197	        sess, "tlms", "", {"enabled": True, "url": "https://example.com"}, vf, None, {}
198	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/reports/test_report_183.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
26	    }
27	    response = client.post("/reports/183", data=data)
28	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/reports/test_report_183.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
56	    }
57	    response = client.post("/reports/183", data=data)
58	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/reports/test_report_183.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
95	    headers = {"Authorization": _basic_auth_str("admin@example.com", "admin")}
96	    response = raw_client.post("/reports/183", data=data, headers=headers)
97	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_rate_server.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        responses = {
23	            "https://api.github.com/repos/WessexWater/chellow-rates": {
24	                "html_url": "https://example.com"
25	            },
26	            "https://api.github.com/repos/WessexWater/chellow-rates/branches/main": {
27	                "commit": {"commit": {"tree": {"url": "https://example.com/tree"}}}
28	            },
29	            "https://example.com/tree": {"tree": [], "truncated": False},
30	        }
31	        return responses[url]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_rate_server.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	            },
26	            "https://api.github.com/repos/WessexWater/chellow-rates/branches/main": {
27	                "commit": {"commit": {"tree": {"url": "https://example.com/tree"}}}
28	            },
29	            "https://example.com/tree": {"tree": [], "truncated": False},
30	        }
31	        return responses[url]
32	
33	    mocker.patch("chellow.rate_server.api_get", mock_api_get)
34	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_rate_server.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	            },
29	            "https://example.com/tree": {"tree": [], "truncated": False},
30	        }
31	        return responses[url]
32	
33	    mocker.patch("chellow.rate_server.api_get", mock_api_get)
34	
35	    def log(message):
36	        messages.append(message)
37	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_rate_server.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	            "https://api.github.com/repos/WessexWater/chellow-rates": {
24	                "html_url": "https://example.com"
25	            },
26	            "https://api.github.com/repos/WessexWater/chellow-rates/branches/main": {
27	                "commit": {"commit": {"tree": {"url": "https://example.com/tree"}}}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_rate_server.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	            "https://api.github.com/repos/WessexWater/chellow-rates/branches/main": {
27	                "commit": {"commit": {"tree": {"url": "https://example.com/tree"}}}
28	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_rate_server.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        responses = {
61	            "https://api.github.com/repos/WessexWater/chellow-rates": {
62	                "html_url": "https://example.com"
63	            },
64	            "https://api.github.com/repos/WessexWater/chellow-rates/branches/main": {
65	                "commit": {"commit": {"tree": {"url": "https://example.com/tree"}}}
66	            },
67	            "https://example.com/tree": {
68	                "tree": [{"path": "readme.md"}],
69	                "truncated": False,
70	            },
71	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_rate_server.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	            },
64	            "https://api.github.com/repos/WessexWater/chellow-rates/branches/main": {
65	                "commit": {"commit": {"tree": {"url": "https://example.com/tree"}}}
66	            },
67	            "https://example.com/tree": {
68	                "tree": [{"path": "readme.md"}],
69	                "truncated": False,
70	            },
71	        }
72	        return responses[url]
73	
74	    mocker.patch("chellow.rate_server.api_get", mock_api_get)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_rate_server.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	            },
67	            "https://example.com/tree": {
68	                "tree": [{"path": "readme.md"}],
69	                "truncated": False,
70	            },
71	        }
72	        return responses[url]
73	
74	    mocker.patch("chellow.rate_server.api_get", mock_api_get)
75	
76	    def log(message):
77	        messages.append(message)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_rate_server.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	            "https://api.github.com/repos/WessexWater/chellow-rates": {
62	                "html_url": "https://example.com"
63	            },
64	            "https://api.github.com/repos/WessexWater/chellow-rates/branches/main": {
65	                "commit": {"commit": {"tree": {"url": "https://example.com/tree"}}}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_rate_server.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	            "https://api.github.com/repos/WessexWater/chellow-rates/branches/main": {
65	                "commit": {"commit": {"tree": {"url": "https://example.com/tree"}}}
66	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chellow-1744121701.0.0/chellow-1744121701.0.0/test/test_views.py:929
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
928	        "name": "g_cv",
929	        "properties": """{
930	"enabled": true,
931	"url": "http://localhost:8080/nationalgrid/cv.csv"}
932	""",

--------------------------------------------------

Code scanned:
	Total lines of code: 78782
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 39.0
		High: 67.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 97.0
		High: 9.0
Files skipped (0):
