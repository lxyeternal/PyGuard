Run started:2025-04-12 13:37:30.370001

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/commands/daemon.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
102	        with os.fdopen(reply_fd, "w") as f:
103	            f.write(json.dumps(all_ports) + "\n")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/commands/file.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
348	            async with aiofiles.open(destination_file, "rb") as f:
349	                data = await f.read()
350	                sys.stdout.buffer.write(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/commands/file.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
349	                data = await f.read()
350	                sys.stdout.buffer.write(data)
351	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/commands/file.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
349	                data = await f.read()
350	                sys.stdout.buffer.write(data)
351	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/commands/file.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
368	    ) -> None:
369	        data = sys.stdin.buffer.read()
370	        (destination_directory, destination_file_path) = os.path.split(args.dst)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/commands/file.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
379	            async with aiofiles.open(temporary_file_path, "wb") as f:
380	                await f.write(data)
381	            await client.push(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/commands/file.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
379	            async with aiofiles.open(temporary_file_path, "wb") as f:
380	                await f.write(data)
381	            await client.push(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/commands/file.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
407	        ):
408	            sys.stdout.buffer.write(data)
409	            sys.stdout.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/commands/file.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
407	        ):
408	            sys.stdout.buffer.write(data)
409	            sys.stdout.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/main.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	        description="idb: a versatile tool to communicate with iOS Simulators and Devices",
129	        epilog="See Also: https://www.fbidb.io/docs/guided-tour",
130	        formatter_class=argparse.RawTextHelpFormatter,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/cli/tests/parser_tests.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
620	        self.client_mock.open_url = AsyncMock(return_value=[])
621	        url = "http://facebook.com"
622	        await cli_main(cmd_input=["open", url])

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/companion.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
197	    ) -> Tuple[asyncio.subprocess.Process, str]:
198	        if os.getuid() == 0:
199	            logging.warning(

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/companion.py:198
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
197	    ) -> Tuple[asyncio.subprocess.Process, str]:
198	        if os.getuid() == 0:
199	            logging.warning(

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/companion_spawner.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
104	    def check_okay_to_spawn(self) -> None:
105	        if os.getuid() == 0:
106	            logging.warning(

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/companion_spawner.py:105
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
104	    def check_okay_to_spawn(self) -> None:
105	        if os.getuid() == 0:
106	            logging.warning(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/format.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
138	            {
139	                "payload": base64.b64encode(attachment.payload).decode("utf-8"),
140	                "timestap": attachment.timestamp,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/format.py:139
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
138	            {
139	                "payload": base64.b64encode(attachment.payload).decode("utf-8"),
140	                "timestap": attachment.timestamp,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/local_targets_manager.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	        async with aiofiles.open(self._local_targets_file, "w") as f:
50	            await f.write(json.dumps([]))

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/networking.py:22
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
21	def is_port_open(host: str, port: int) -> bool:
22	    with closing(socket.socket(socket.AF_INET6, socket.SOCK_STREAM)) as sock:
23	        sock.settimeout(DEFAULT_NETWORK_TIMEOUT)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/networking.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
22	    with closing(socket.socket(socket.AF_INET6, socket.SOCK_STREAM)) as sock:
23	        sock.settimeout(DEFAULT_NETWORK_TIMEOUT)
24	        return sock.connect_ex((host, port)) == 0

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/tar.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
215	        while not reader.at_eof():
216	            data = await reader.read(READ_CHUNK_SIZE)
217	            if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/tar.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
245	    async for data in generator:
246	        writer.write(data)
247	        await writer.drain()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/tar.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
245	    async for data in generator:
246	        writer.write(data)
247	        await writer.drain()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/tests/companion_set_tests.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
35	            with open(path, "w") as f:
36	                f.write("GARBAGEASDASDASD")
37	            yield CompanionSet(logger=mock.MagicMock(), state_file_path=path)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/tests/direct_companion_manager_tests.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
38	            with open(path, "w") as f:
39	                f.write("GARBAGEASDASDASD")
40	            yield DirectCompanionManager(logger=mock.MagicMock(), state_file_path=path)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/common/tests/local_targets_manager_tests.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
25	            with open(f.name, "w") as f:
26	                f.write(notifier_output)
27	            targets = await local_targets_manager.get_local_targets()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1098	            with open(coverage_output_path, "w") as f:
1099	                f.write(response.coverage_json)
1100	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1098	            with open(coverage_output_path, "w") as f:
1099	                f.write(response.coverage_json)
1100	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1125	        async with self.stub.xctest_run.open() as stream:
1126	            request = make_request(
1127	                test_bundle_id=test_bundle_id,
1128	                app_bundle_id=app_bundle_id,
1129	                test_host_app_bundle_id=test_host_app_bundle_id,
1130	                is_ui_test=is_ui_test,
1131	                is_logic_test=is_logic_test,
1132	                tests_to_run=tests_to_run,
1133	                tests_to_skip=tests_to_skip,
1134	                env=env,
1135	                args=args,
1136	                result_bundle_path=result_bundle_path,
1137	                timeout=timeout,
1138	                report_activities=(
1139	                    report_activities
1140	                    or activities_output_path is not None
1141	                    or report_attachments
1142	                ),
1143	                report_attachments=report_attachments,
1144	                collect_coverage=coverage_output_path is not None,
1145	                coverage_format=coverage_format,
1146	                collect_logs=log_directory_path is not None,
1147	                wait_for_debugger=wait_for_debugger,
1148	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1162	                    if idb_log_buffer:
1163	                        idb_log_buffer.write(line)
1164	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1162	                    if idb_log_buffer:
1163	                        idb_log_buffer.write(line)
1164	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1184	                if wait_for_debugger and response.debugger.pid:
1185	                    sys.stdout.buffer.write(
1186	                        json_format_debugger_info(response.debugger).encode()
1187	                    )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1184	                if wait_for_debugger and response.debugger.pid:
1185	                    sys.stdout.buffer.write(
1186	                        json_format_debugger_info(response.debugger).encode()
1187	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1187	                    )
1188	                    sys.stdout.buffer.write(os.linesep.encode())
1189	                    sys.stdout.buffer.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1187	                    )
1188	                    sys.stdout.buffer.write(os.linesep.encode())
1189	                    sys.stdout.buffer.flush()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1296	            if all_processes:
1297	                target = XctraceRecordRequest.Target(all_processes=all_processes)
1298	            elif process_to_attach:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1298	            elif process_to_attach:
1299	                target = XctraceRecordRequest.Target(
1300	                    process_to_attach=process_to_attach
1301	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/client.py:1303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1302	            else:
1303	                target = XctraceRecordRequest.Target(
1304	                    launch_process=XctraceRecordRequest.LauchProcess(
1305	                        process_to_launch=process_to_launch,
1306	                        launch_args=launch_args,
1307	                        target_stdin=target_stdin,
1308	                        target_stdout=target_stdout,
1309	                        process_env=process_env,
1310	                    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/install.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
31	        while True:
32	            chunk = await file.read(CHUNK_SIZE)
33	            if not chunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/install.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
96	    while True:
97	        chunk = io.read(CHUNK_SIZE)
98	        if not chunk:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fb_idb-1.1.7-py3-none-any/idb/grpc/xctest.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
244	        with open(attachment_path, "wb") as f:
245	            f.write(attachment.payload)
246	    for sub_activity in activity.sub_activities:

--------------------------------------------------

Code scanned:
	Total lines of code: 12414
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 35.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 4.0
Files skipped (0):
