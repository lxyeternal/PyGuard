Run started:2025-04-12 10:23:17.241863

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/aws_opentelemetry_configurator.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	OTEL_EXPORTER_OTLP_TRACES_ENDPOINT = "OTEL_EXPORTER_OTLP_TRACES_ENDPOINT"
87	XRAY_OTLP_ENDPOINT_PATTERN = r"https://xray\.([a-z0-9-]+)\.amazonaws\.com/v1/traces$"
88	# UDP package size is not larger than 64KB
89	LAMBDA_SPAN_EXPORT_BATCH_SIZE = 10

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/aws_opentelemetry_configurator.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
509	                APPLICATION_SIGNALS_EXPORTER_ENDPOINT_CONFIG,
510	                os.environ.get(DEPRECATED_APP_SIGNALS_EXPORTER_ENDPOINT_CONFIG, "http://localhost:4316/v1/metrics"),
511	            )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/aws_span_metrics_processor.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
26	# https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html#instancedata-inside-access
27	_EC2_METADATA_API_IP: str = "169.254.169.254"
28	
29	
30	class AwsSpanMetricsProcessor(SpanProcessor):

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/otlp_udp_exporter.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
33	        self._host, self._port = self._parse_endpoint(self._endpoint)
34	        self._socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
35	        self._socket.setblocking(False)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/otlp_udp_exporter.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
38	        # base64 encoding and then converting to string with utf-8
39	        base64_encoded_string: str = base64.b64encode(data).decode("utf-8")
40	        message = f"{PROTOCOL_HEADER}{signal_format_prefix}{base64_encoded_string}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/otlp_udp_exporter.py:39
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
38	        # base64 encoding and then converting to string with utf-8
39	        base64_encoded_string: str = base64.b64encode(data).decode("utf-8")
40	        message = f"{PROTOCOL_HEADER}{signal_format_prefix}{base64_encoded_string}"

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/otlp_udp_exporter.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
49	    def shutdown(self):
50	        self._socket.close()
51	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/patches/_resource_detector_patches.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
17	    def patch_ec2_aws_http_request(method, path, headers):
18	        with urlopen(
19	            Request("http://169.254.169.254" + path, headers=headers, method=method),
20	            timeout=5,
21	        ) as response:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/patches/_resource_detector_patches.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	        with urlopen(
19	            Request("http://169.254.169.254" + path, headers=headers, method=method),
20	            timeout=5,

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/patches/_resource_detector_patches.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
21	        ) as response:
22	            return response.read().decode("utf-8")
23	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/patches/_resource_detector_patches.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
24	    def patch_eks_aws_http_request(method, path, cred_value):
25	        with urlopen(
26	            Request(
27	                "https://kubernetes.default.svc" + path,
28	                headers={"Authorization": cred_value},
29	                method=method,
30	            ),
31	            timeout=5,
32	            context=ssl.create_default_context(cafile="/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"),
33	        ) as response:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/patches/_resource_detector_patches.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	            Request(
27	                "https://kubernetes.default.svc" + path,
28	                headers={"Authorization": cred_value},

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/patches/_resource_detector_patches.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
33	        ) as response:
34	            return response.read().decode("utf-8")
35	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/sampler/_aws_xray_sampling_client.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
31	        try:
32	            xray_response = self.__session.post(url=self.__get_sampling_rules_endpoint, headers=headers, timeout=20)
33	            if xray_response is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/sampler/_aws_xray_sampling_client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
64	        try:
65	            xray_response = self.__session.post(
66	                url=self.__get_sampling_targets_endpoint,
67	                headers=headers,
68	                timeout=20,
69	                json={"SamplingStatisticsDocuments": statistics},
70	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_opentelemetry_distro-0.9.0-py3-none-any/amazon/opentelemetry/distro/sampler/aws_xray_remote_sampler.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	DEFAULT_RULES_POLLING_INTERVAL_SECONDS = 300
24	DEFAULT_SAMPLING_PROXY_ENDPOINT = "http://127.0.0.1:2000"
25	
26	
27	# Wrapper class to ensure that all XRay Sampler Functionality in _AwsXRayRemoteSampler
28	# uses ParentBased logic to respect the parent span's sampling decision
29	class AwsXRayRemoteSampler(Sampler):

--------------------------------------------------

Code scanned:
	Total lines of code: 3276
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 8.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 2.0
Files skipped (0):
