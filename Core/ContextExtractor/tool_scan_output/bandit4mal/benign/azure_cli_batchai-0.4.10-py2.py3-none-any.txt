Run started:2025-04-12 13:56:51.175668

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	    client = get_mgmt_service_client(cli_ctx, ResourceType.MGMT_RESOURCE_RESOURCES)
86	    return client.resource_groups.get(resource_group).location
87	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	def _get_workspace_location(client, resource_group, workspace_name):
90	    workspace = client.workspaces.get(resource_group, workspace_name)
91	    return workspace.location

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	    try:
108	        client.get(resource_group, workspace, name)
109	        raise CLIError('"{0}" already exists in "{1}" resource group under {2} resource group.'.format(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	    try:
118	        client.get(resource_group, workspace, experiment, name)
119	        raise CLIError('A job with given name, experiment, workspace and resource group already exists.')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	    try:
136	        nfs = client.file_servers.get(nfs_resource_group, nfs_workspace, nfs_name)
137	    except CloudError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	        return account_name, _get_storage_account_key(cli_ctx, account_name, account_key) or ''
179	    return cli_ctx.config.get('batchai', 'storage_account', ''), cli_ctx.config.get('batchai', 'storage_key', '')
180	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	        return account_name, _get_storage_account_key(cli_ctx, account_name, account_key) or ''
179	    return cli_ctx.config.get('batchai', 'storage_account', ''), cli_ctx.config.get('batchai', 'storage_key', '')
180	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
305	            with open(os.path.expanduser(effective_key)) as f:
306	                effective_key = f.read()
307	    try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
353	    """
354	    return 'https://{0}.file.{1}/{2}'.format(account_name, cli_ctx.cloud.suffixes.storage_endpoint, azure_file_share)
355	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
668	    if nfs_name:
669	        file_server = client.file_servers.get(nfs_resource_group, nfs_workspace, nfs_name)
670	        mount_volumes = _add_nfs_to_mount_volumes(mount_volumes, file_server.id, nfs_mount_path)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
719	                          expiry=DEFAULT_URL_EXPIRY_MIN):
720	    cluster = client.get(resource_group, workspace_name, cluster_name)  # type: models.Cluster
721	    return _list_node_setup_files_for_cluster(cmd.cli_ctx, cluster, path, expiry)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
843	    # Check presence of the cluster.
844	    existing_cluster = client.clusters.get(cluster_resource_group, cluster_workspace, cluster_name)
845	    params.cluster = models.ResourceId(id=existing_cluster.id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
857	            nfs, resource_group, workspace_name)
858	        file_server = client.file_servers.get(nfs_resource_group, nfs_workspace, nfs_name)
859	        mount_volumes = _add_nfs_to_mount_volumes(mount_volumes, file_server.id, nfs_mount_path)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:891
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
890	              output_directory_id=STANDARD_OUTPUT_DIRECTORY_ID, path='.'):
891	    signal.signal(signal.SIGINT, sigint_handler)
892	    url = None

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:891
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
890	              output_directory_id=STANDARD_OUTPUT_DIRECTORY_ID, path='.'):
891	    signal.signal(signal.SIGINT, sigint_handler)
892	    url = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
902	        if url is None:
903	            job = client.get(resource_group, workspace_name, experiment_name, job_name)
904	            if job.execution_state in [models.ExecutionState.succeeded, models.ExecutionState.failed]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:916
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
915	    while True:
916	        r = requests.get(url, headers={'Range': 'bytes={0}-'.format(downloaded)})
917	        if int(r.status_code / 100) == 2:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
919	            print(r.content.decode(), end='')
920	        job = client.get(resource_group, workspace_name, experiment_name, job_name)
921	        if job.execution_state in [models.ExecutionState.succeeded, models.ExecutionState.failed]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:927
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
926	def wait_for_job_completion(client, resource_group, workspace_name, experiment_name, job_name, check_interval_sec=15):
927	    job = client.jobs.get(resource_group, workspace_name, experiment_name, job_name)  # type: models.Job
928	    logger.warning('Job submitted at %s', str(job.creation_time))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
946	        time.sleep(check_interval_sec)
947	        job = client.jobs.get(resource_group, workspace_name, experiment_name, job_name)
948	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:1026
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1025	    """
1026	    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  # pylint: disable=no-member
1027	    s.bind(('', 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:1030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1029	    port = s.getsockname()[1]
1030	    s.close()
1031	    return port

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:1069
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1068	    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
1069	    ssh.connect(ip, port, username, password=password, key_filename=ssh_private_key)
1070	    transport = ssh.get_transport()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:1080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1079	
1080	    threads = [threading.Thread(target=_worker, args=(s,)) for s in [out, err]]
1081	    for t in threads:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:1111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1110	
1111	    cluster = client.get(resource_group, workspace_name, cluster_name)  # type: models.Cluster
1112	    username = cluster.user_account_settings.admin_user_name

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1113	    try:
1114	        signal.signal(signal.SIGINT, sigint_handler)
1115	        if ports:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1113	    try:
1114	        signal.signal(signal.SIGINT, sigint_handler)
1115	        if ports:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:1116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1115	        if ports:
1116	            local_addresses = [('0.0.0.0', int(p.split(':')[0])) for p in ports]
1117	            remote_addresses = [(p.split(':')[1], int(p.split(':')[2])) for p in ports]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_batchai-0.4.10-py2.py3-none-any/azure/cli/command_modules/batchai/custom.py:1146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1145	    # find the cluster
1146	    job = client.jobs.get(resource_group, workspace_name, experiment_name, job_name)  # type: models.Job
1147	    cluster_id = parse_resource_id(job.cluster.id)

--------------------------------------------------

Code scanned:
	Total lines of code: 1802
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 24.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 3.0
Files skipped (0):
