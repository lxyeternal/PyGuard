Run started:2025-04-12 14:57:32.065392

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    long_description_content_type="text/markdown",
14	    url="https://github.com/dahlke/terrasnek",
15	    packages=setuptools.find_packages(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/_constants.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	TFC_SAAS_HOSTNAME = "app.terraform.io"
13	TFC_SAAS_URL = "https://app.terraform.io"
14	TERRASNEK_LOG_LEVEL = logging.CRITICAL

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/api.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
266	        results = None
267	        req = requests.get(url, headers=self._headers, verify=self._verify)
268	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/api.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
279	        # Make a GET request to the PyPI JSON API to get information about the package
280	        req = requests.get(f'https://pypi.org/pypi/{self.package_name}/json')
281	        data = req.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/api.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
279	        # Make a GET request to the PyPI JSON API to get information about the package
280	        req = requests.get(f'https://pypi.org/pypi/{self.package_name}/json')
281	        data = req.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/api.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
405	        url = f"{self._instance_url}/.well-known/terraform.json"
406	        return self._get(url)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/config_versions.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
97	
98	        with open(path_to_tarball, 'rb') as data_bytes:
99	            data = data_bytes.read()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/config_versions.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
123	        # add data to targz
124	        with tarfile.open(fileobj=targz_io, mode='w:gz') as tar:
125	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/endpoint.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	        self._logger.debug(f"Trying HTTP GET to URL: {url} ...")
182	        req = requests.get(
183	            url, headers=self._headers, verify=self._verify, allow_redirects=allow_redirects)
184	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/endpoint.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
272	        self._logger.debug(f"Trying HTTP POST to URL: {url} ...")
273	        req = requests.post(url, data=json.dumps(
274	            data), headers=self._headers, verify=self._verify)
275	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/endpoint.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
354	
355	        return self._post(url, data=payload)
356	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/endpoint.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
372	        """
373	        return self._get(url, query=query, filters=filters, page=page, \
374	            page_size=page_size, search=search, include=include, sort=sort, \
375	                offset=offset, limit=limit, provider=provider, namespace=namespace, \
376	                    verified=verified, since=since)
377	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/endpoint.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
419	        """
420	        return self._get(url, include=include)
421	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/endpoint.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
433	        if header_with_url is None:
434	            results = self._get(url, return_raw=True, allow_redirects=allow_redirects)
435	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/endpoint.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
435	        else:
436	            response = self._get(url, allow_redirects=allow_redirects)
437	            if "redirect-url" in response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/endpoint.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
437	            if "redirect-url" in response:
438	                response = self._get(response["redirect-url"])
439	            download_url = response[header_with_url]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/terrasnek/endpoint.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
439	            download_url = response[header_with_url]
440	            results = self._get(download_url, return_raw=True)
441	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/admin_settings_test.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	                    "idp-cert": "NEW-CERTIFICATE",
82	                    "slo-endpoint-url": "https://example.com/slo",
83	                    "sso-endpoint-url": "https://example.com/sso",
84	                    "attr-username": "Username",
85	                    "attr-groups": "MemberOf",
86	                    "attr-site-admin": "SiteAdmin",
87	                    "site-admin-role": "site-admins",
88	                    "sso-api-token-session-timeout": 1209600
89	                }
90	            }
91	        }
92	        updated_saml = self._api.admin_settings.update_saml(update_payload)["data"]
93	        self.assertTrue(updated_saml["attributes"]["enabled"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/admin_settings_test.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	                    "slo-endpoint-url": "https://example.com/slo",
83	                    "sso-endpoint-url": "https://example.com/sso",
84	                    "attr-username": "Username",
85	                    "attr-groups": "MemberOf",
86	                    "attr-site-admin": "SiteAdmin",
87	                    "site-admin-role": "site-admins",
88	                    "sso-api-token-session-timeout": 1209600
89	                }
90	            }
91	        }
92	        updated_saml = self._api.admin_settings.update_saml(update_payload)["data"]
93	        self.assertTrue(updated_saml["attributes"]["enabled"])
94	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/admin_terraform_versions_test.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	
7	TF_RELEASE_URL = "https://releases.hashicorp.com/terraform/0.11.8/terraform_0.11.8_linux_amd64.zip"
8	TF_RELEASE_SHA = "84ccfb8e13b5fce63051294f787885b76a1fedef6bdbecf51c5e586c9e20c9b7"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/base.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	                as tf_file:
68	            cls._config_version_upload_string = tf_file.read()
69	        cls._module_upload_tarball_path = \

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/base.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
395	        with open(self._test_state_path, "rb") as infile:
396	            raw_state_bytes = infile.read()
397	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/base.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
401	
402	        state_b64 = base64.b64encode(raw_state_bytes).decode("utf-8")
403	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/base.py:402
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
401	
402	        state_b64 = base64.b64encode(raw_state_bytes).decode("utf-8")
403	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/base.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
557	                    "service-provider": "github",
558	                    "http-url": "https://github.com",
559	                    "api-url": "https://api.github.com",
560	                    "oauth-token-string": GH_TOKEN
561	                }
562	            }
563	        }
564	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/base.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
558	                    "http-url": "https://github.com",
559	                    "api-url": "https://api.github.com",
560	                    "oauth-token-string": GH_TOKEN
561	                }
562	            }
563	        }
564	
565	    def _get_project_create_payload(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/notification_configs_test.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	                    "name": not_cnf_name,
51	                    "url": "https://httpstat.us/200",
52	                    "triggers": [
53	                        "run:applying"
54	                    ]
55	                }
56	            }
57	        }
58	        created_noti_config = self._api.notification_configs.create(self._ws_id, payload)["data"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/terrasnek-0.1.14/terrasnek-0.1.14/test/run_tasks_test.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	                    "name": task_name,
39	                    "url": "http://example.com",
40	                    "hmac_key": "secret",
41	                    "category": "task"
42	                }
43	            }
44	        }

--------------------------------------------------

Code scanned:
	Total lines of code: 9475
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 1.0
Files skipped (0):
