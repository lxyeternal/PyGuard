Run started:2025-04-12 16:17:45.236316

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/_cache.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
34	
35	    shutil.rmtree(get_cache_directory(), ignore_errors=True)
36	    global _SVG_CACHE

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	
41	ROOT = "https://api.iconify.design"
42	
43	API_FUNCTIONS: set[str] = {"collections", "collection", "last_modified", "css"}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	    query_params = {"prefixes": ",".join(prefixes)}
108	    resp = _session().get(f"{ROOT}/collections", params=query_params, timeout=2)
109	    resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138	        query_params["info"] = 1
139	    resp = _session().get(
140	        f"{ROOT}/collection?prefix={prefix}", params=query_params, timeout=2
141	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	        raise OSError(
144	            f"Icon set {prefix!r} not found. "
145	            "Search for icons at https://icon-sets.iconify.design",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
173	    query_params = {"prefixes": ",".join(prefixes)}
174	    resp = _session().get(f"{ROOT}/last-modified", params=query_params, timeout=2)
175	    resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	        query_params["box"] = 1
254	    resp = _session().get(f"{ROOT}/{prefix}/{name}.svg", params=query_params, timeout=2)
255	    if 400 <= resp.status_code < 500:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
256	        raise OSError(
257	            f"Icon '{prefix}:{name}' not found. "
258	            f"Search for icons at https://icon-sets.iconify.design?query={name}",
259	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
273	        # important not to rely on internet when looking for cached file
274	        last_mod = last_modified().get(prefix, NO_LAST_MOD)
275	    except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
361	    with os.fdopen(fd, "wb") as f:
362	        f.write(svg_bytes)
363	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
361	    with os.fdopen(fd, "wb") as f:
362	        f.write(svg_bytes)
363	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
441	
442	    resp = _session().get(
443	        f"{ROOT}/{prefix}.css?icons={','.join(icons)}", params=params, timeout=2
444	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
446	        raise OSError(
447	            f"Icon set {prefix!r} not found. "
448	            "Search for icons at https://icon-sets.iconify.design",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
452	        warnings.warn(
453	            f"Icon(s) {sorted(missing)} not found. "
454	            "Search for icons at https://icon-sets.iconify.design",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	    prefix, names = _split_prefix_name(keys, allow_many=True)
479	    resp = _session().get(f"{ROOT}/{prefix}.json?icons={','.join(names)}", timeout=2)
480	    if (content := resp.json()) == 404:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
481	        raise OSError(
482	            f"Icon set {prefix!r} not found. "
483	            "Search for icons at https://icon-sets.iconify.design",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
551	        params["category"] = category
552	    resp = _session().get(f"{ROOT}/search?query={query}", params=params, timeout=2)
553	    resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
588	        params = {}
589	    resp = _session().get(f"{ROOT}/keywords", params=params, timeout=2)
590	    resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/api.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
608	    """
609	    resp = _session().get(f"{ROOT}/version", timeout=2)
610	    resp.raise_for_status()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/src/pyconify/freedesktop.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
160	        def _cleanup() -> None:  # pragma: no cover
161	            shutil.rmtree(base, ignore_errors=True)
162	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyconify-0.2.1/pyconify-0.2.1/tests/conftest.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
34	        elif cache_dir.exists():
35	            shutil.rmtree(cache_dir, ignore_errors=True)
36	            raise AssertionError("Cache directory was created outside of test fixtures")

--------------------------------------------------

Code scanned:
	Total lines of code: 1468
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 0.0
Files skipped (0):
