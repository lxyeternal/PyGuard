Run started:2025-04-12 11:58:42.197566

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_compress_providers.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	ign_wmts_url = (
91	    "https://data.geopf.fr/wmts?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetCapabilities"
92	)
93	
94	response = requests.get(ign_wmts_url)
95	response_dict = xmltodict.parse(response.content)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_compress_providers.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	
94	response = requests.get(ign_wmts_url)
95	response_dict = xmltodict.parse(response.content)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_compress_providers.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	    layer = response_dict["Capabilities"]["Contents"]["Layer"][i]
101	    variant = layer.get("ows:Identifier")
102	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_compress_providers.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
123	    # Get layer style
124	    style = layer.get("Style")
125	    if isinstance(style, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_compress_providers.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	    if isinstance(style, dict):
126	        style = style.get("ows:Identifier")
127	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_compress_providers.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	    elif isinstance(style, list):
129	        style = style[1].get("ows:Identifier") if len(style) > 1 else None
130	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_compress_providers.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	    # Tile format
144	    output_format = layer.get("Format") # image/png...
145	    if output_format == "application/x-protobuf" or output_format == "image/x-bil;bits=32":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_compress_providers.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	    leaflet["GeoportailFrance"][name] = {
168	        "url": """https://data.geopf.fr/wmts?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&STYLE={style}&TILEMATRIXSET={TileMatrixSet}&FORMAT={format}&LAYER={variant}&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}""",
169	        "html_attribution": """<a target="_blank"href="https://www.geoportail.gouv.fr/">Geoportail France</a>""",
170	        "attribution": "Geoportail France",
171	        "bounds": bounds,
172	        "min_zoom": min_zoom,
173	        "max_zoom": max_zoom,
174	        "format": output_format,
175	        "style": style,
176	        "variant": variant,
177	        "name": "GeoportailFrance." + name,
178	        "TileMatrixSet": TileMatrixSet,
179	        "apikey": "your_api_key_here",
180	    }
181	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_compress_providers.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	        "url": """https://data.geopf.fr/wmts?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&STYLE={style}&TILEMATRIXSET={TileMatrixSet}&FORMAT={format}&LAYER={variant}&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}""",
169	        "html_attribution": """<a target="_blank"href="https://www.geoportail.gouv.fr/">Geoportail France</a>""",
170	        "attribution": "Geoportail France",
171	        "bounds": bounds,
172	        "min_zoom": min_zoom,
173	        "max_zoom": max_zoom,
174	        "format": output_format,
175	        "style": style,
176	        "variant": variant,
177	        "name": "GeoportailFrance." + name,
178	        "TileMatrixSet": TileMatrixSet,
179	        "apikey": "your_api_key_here",
180	    }
181	
182	    # Handle broken providers

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_parse_leaflet_providers.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	GIT_URL = "https://github.com/leaflet-extras/leaflet-providers.git"
25	
26	
27	# -----------------------------------------------------------------------------
28	# Downloading and processing the json data
29	
30	
31	def get_json_data():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/provider_sources/_parse_leaflet_providers.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
146	            "description": (
147	                "JSON representation of the leaflet providers defined by the "
148	                "leaflet-providers.js extension to Leaflet "
149	                "(https://github.com/leaflet-extras/leaflet-providers)"
150	            ),
151	            "date_of_creation": datetime.datetime.today().strftime("%Y-%m-%d"),
152	            "commit": description,
153	        }
154	        json.dump(result, f, indent=4)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/setup.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    long_description_content_type="text/markdown",
11	    url="https://github.com/geopandas/xyzservices",
12	    author="Dani Arribas-Bel, Martin Fleischmann",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/lib.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
561	        """
562	        qms_api_url = "https://qms.nextgis.com/api/v1/geoservices"
563	
564	        services = json.load(

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/lib.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
564	        services = json.load(
565	            urllib.request.urlopen(f"{qms_api_url}/?search={quote(name)}&type=tms")
566	        )

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/lib.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
575	        service_details = json.load(
576	            urllib.request.urlopen(f"{qms_api_url}/{service_id}")
577	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/providers.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
10	    with open(data_path) as f:
11	        json = f.read()
12	else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    return TileProvider(
12	        url="https://myserver.com/tiles/{z}/{x}/{y}.png",
13	        attribution="(C) xyzservices",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    return TileProvider(
21	        url="https://myserver.com/tiles/{z}/{x}/{y}{r}.png",
22	        attribution="(C) xyzservices",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    return TileProvider(
31	        url="https://myserver.com/tiles/{z}/{x}/{y}{r}.png",
32	        attribution="(C) xyzservices",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    return TileProvider(
40	        url="https://myserver.com/tiles/{z}/{x}/{y}?access_token={accessToken}",
41	        attribution="(C) xyzservices",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	    return TileProvider(
50	        url="https://myserver.com/tiles/{z}/{x}/{y}.png",
51	        attribution="(C) xyzservices",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	        attribution="(C) xyzservices",
52	        html_attribution='&copy; <a href="https://xyzservices.readthedocs.io">xyzservices</a>',  # noqa
53	        name="my_public_provider_html",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    return TileProvider(
60	        url="https://{s}.myserver.com/tiles/{z}/{x}/{y}.png",
61	        attribution="(C) xyzservices",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	):
110	    expected = "https://myserver.com/tiles/{z}/{x}/{y}.png"
111	    assert basic_provider.build_url() == expected

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	
113	    expected = "https://myserver.com/tiles/3/1/2.png"
114	    assert basic_provider.build_url(1, 2, 3) == expected

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	
118	    expected = "https://myserver.com/tiles/3/1/2@2x.png"
119	    assert retina_provider.build_url(1, 2, 3) == expected

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	
122	    expected = "https://myserver.com/tiles/3/1/2@5x.png"
123	    assert retina_provider.build_url(1, 2, 3, scale_factor="@5x") == expected

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
124	
125	    expected = "https://myserver.com/tiles/{z}/{x}/{y}?access_token=my_token"
126	    assert private_provider.build_url(accessToken="my_token") == expected

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
130	
131	    expected = "https://{s}.myserver.com/tiles/{z}/{x}/{y}.png"
132	    assert subdomain_provider.build_url(fill_subdomain=False)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	
134	    expected = "https://a.myserver.com/tiles/{z}/{x}/{y}.png"
135	    assert subdomain_provider.build_url()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	        '<dl class="xyz-attrs">',
151	        "<dt><span>url</span></dt><dd>https://myserver.com/tiles/{z}/{x}/{y}.png</dd>",
152	        "<dt><span>attribution</span></dt><dd>(C) xyzservices</dd>",
153	    ]
154	
155	    for html_string in provider_strings:
156	        assert html_string in basic_provider._repr_html_()
157	
158	    bunch = Bunch({"first": basic_provider, "second": retina_provider})
159	
160	    bunch_strings = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_lib.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
198	        html_attr_provider.html_attribution
199	        == '&copy; <a href="https://xyzservices.readthedocs.io">xyzservices</a>'
200	    )
201	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_providers.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	def get_tile(provider):
21	    bounds = provider.get("bounds", [[-180, -90], [180, 90]])
22	    lat = (bounds[0][0] + bounds[1][0]) / 2

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_providers.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	    lon = (bounds[0][1] + bounds[1][1]) / 2
24	    zoom = (provider.get("min_zoom", 0) + provider.get("max_zoom", 20)) // 2
25	    tile = mercantile.tile(lon, lat, zoom)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_providers.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	    lon = (bounds[0][1] + bounds[1][1]) / 2
24	    zoom = (provider.get("min_zoom", 0) + provider.get("max_zoom", 20)) // 2
25	    tile = mercantile.tile(lon, lat, zoom)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_providers.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	    try:
38	        r = s.get(url, timeout=30)
39	    except requests.ConnectionError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/xyzservices-2025.1.0/xyzservices-2025.1.0/xyzservices/tests/test_providers.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	def get_test_result(provider, allow_403=True):
45	    if provider.get("status"):
46	        pytest.xfail("Provider is known to be broken.")

--------------------------------------------------

Code scanned:
	Total lines of code: 1304
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 0.0
Files skipped (0):
