Run started:2025-04-12 11:03:44.442607

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/_help.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	helps['container create'] = """
16	    type: command
17	    short-summary: Create a container group.
18	    examples:
19	        - name: Create a container in a container group with 1 core and 1Gb of memory.
20	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --cpu 1 --memory 1
21	        - name: Create a container in a container group that runs Windows, with 2 cores and 3.5Gb of memory.
22	          text: az container create -g MyResourceGroup --name mywinapp --image winappimage:latest --os-type Windows --cpu 2 --memory 3.5
23	        - name: Create a container in a container group with public IP address, ports and DNS name label.
24	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --ports 80 443 --dns-name-label contoso
25	        - name: Create a container in a container group that invokes a script upon start.
26	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --command-line "/bin/sh -c '/path to/myscript.sh'"
27	        - name: Create a container in a container group that runs a command and stop the container afterwards.
28	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --command-line "echo hello" --restart-policy Never
29	        - name: Create a container in a container group with environment variables.
30	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --environment-variables key1=value1 key2=value2
31	        - name: Create a container in a container group using container image from Azure Container Registry.
32	          text: az container create -g MyResourceGroup --name myapp --image myAcrRegistry.azurecr.io/myimage:latest --registry-password password
33	        - name: Create a container in a container group that mounts an Azure File share as volume.
34	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --command-line "cat /mnt/azfile/myfile" --azure-file-volume-share-name myshare --azure-file-volume-account-name mystorageaccount --azure-file-volume-account-key mystoragekey --azure-file-volume-mount-path /mnt/azfile
35	        - name: Create a container in a container group that mounts a git repo as volume.
36	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --command-line "cat /mnt/gitrepo" --gitrepo-url https://github.com/user/myrepo.git --gitrepo-dir ./dir1 --gitrepo-mount-path /mnt/gitrepo
37	        - name: Create a container in a container group using a yaml file.
38	          text: az container create -g MyResourceGroup -f containerGroup.yaml
39	        - name: Create a container group using Log Analytics from a workspace name.
40	          text: az container create -g MyResourceGroup --name myapp --log-analytics-workspace myworkspace
41	        - name: Create a container group with a system assigned identity.
42	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --assign-identity
43	        - name: Create a container group with a system assigned identity. The group will have a 'Contributor' role with access to a storage account.
44	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --assign-identity --scope /subscriptions/99999999-1bf0-4dda-aec3-cb9272f09590/MyResourceGroup/myRG/providers/Microsoft.Storage/storageAccounts/storage1
45	        - name: Create a container group with a user assigned identity.
46	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --assign-identity  /subscriptions/mySubscrpitionId/resourcegroups/myRG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myID
47	        - name: Create a container group with both system and user assigned identity.
48	          text: az container create -g MyResourceGroup --name myapp --image myimage:latest --assign-identity [system] /subscriptions/mySubscrpitionId/resourcegroups/myRG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myID
49	          supported-profiles: latest
50	"""
51	
52	helps['container delete'] = """

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/_validators.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
35	            raise CLIError("Secrets need to be specifed in key=value format.")
36	        result = {comps[0]: b64encode(comps[1].encode('ascii')).decode('ascii')}
37	    return result

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/_validators.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
35	            raise CLIError("Secrets need to be specifed in key=value format.")
36	        result = {comps[0]: b64encode(comps[1].encode('ascii')).decode('ascii')}
37	    return result

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/_validators.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    if ns.image and ns.image.split(':')[0] in short_running_images and not ns.command_line:
47	        logger.warning('Image "%s" has no long running process. The "--command-line" argument must be used to start a '
48	                       'long running process inside the container for the container group to stay running. '
49	                       'Ex: "tail -f /dev/null" '
50	                       'For more imformation visit https://aka.ms/aci/troubleshoot',
51	                       ns.image)
52	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
618	
619	        if platform.system() is WINDOWS_NAME:
620	            _start_exec_pipe_win(execContainerResponse.web_socket_uri, execContainerResponse.password)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
618	
619	        if platform.system() is WINDOWS_NAME:
620	            _start_exec_pipe_win(execContainerResponse.web_socket_uri, execContainerResponse.password)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:619
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
618	
619	        if platform.system() is WINDOWS_NAME:
620	            _start_exec_pipe_win(execContainerResponse.web_socket_uri, execContainerResponse.password)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
630	    def _on_ws_open(ws):
631	        ws.send(password)
632	        t = threading.Thread(target=_capture_stdin, args=[ws])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
631	        ws.send(password)
632	        t = threading.Thread(target=_capture_stdin, args=[ws])
633	        t.daemon = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
641	def _on_ws_msg(ws, msg):
642	    sys.stdout.write(msg)
643	    sys.stdout.flush()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
649	            x = msvcrt.getch()
650	            ws.send(x)
651	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
656	    oldtty = termios.tcgetattr(sys.stdin)
657	    old_handler = signal.getsignal(signal.SIGWINCH)
658	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
661	        tty.setcbreak(sys.stdin.fileno())
662	        ws.send(password)
663	        while True:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
675	        termios.tcsetattr(sys.stdin, termios.TCSADRAIN, oldtty)
676	        signal.signal(signal.SIGWINCH, old_handler)
677	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:676
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
675	        termios.tcsetattr(sys.stdin, termios.TCSADRAIN, oldtty)
676	        signal.signal(signal.SIGWINCH, old_handler)
677	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
681	    if ws.sock in r:
682	        data = ws.recv()
683	        if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
684	            return False
685	        sys.stdout.write(data)
686	        sys.stdout.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
687	    if sys.stdin in r:
688	        x = sys.stdin.read(1)
689	        if not x:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
690	            return True
691	        ws.send(x)
692	    return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
718	    try:
719	        t = threading.Thread(target=stream_target, args=stream_args)
720	        t.daemon = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_container-0.3.18-py2.py3-none-any/azure/cli/command_modules/container/custom.py:822
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
821	        # Use stdout.write to support Python 2
822	        sys.stdout.write('\033[{}A\033[K\033[J'.format(lines))
823	

--------------------------------------------------

Code scanned:
	Total lines of code: 1012
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 16.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 3.0
Files skipped (0):
