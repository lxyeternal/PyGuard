Run started:2025-04-12 14:21:10.129514

Test results:
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/handler.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
55	            if not self.websocket.closed:
56	                self.websocket.close()
57	            self.environ.update({

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/handler.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
176	        try:
177	            key_len = len(base64.b64decode(key))
178	        except TypeError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/handler.py:177
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
176	        try:
177	            key_len = len(base64.b64decode(key))
178	        except TypeError:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/handler.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
214	        if PY3:
215	            accept = base64.b64encode(
216	                hashlib.sha1((key + self.GUID).encode("latin-1")).digest()
217	            ).decode("latin-1")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/handler.py:215
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
214	        if PY3:
215	            accept = base64.b64encode(
216	                hashlib.sha1((key + self.GUID).encode("latin-1")).digest()
217	            ).decode("latin-1")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/handler.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
218	        else:
219	            accept = base64.b64encode(hashlib.sha1(key + self.GUID).digest())
220	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/handler.py:219
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
218	        else:
219	            accept = base64.b64encode(hashlib.sha1(key + self.GUID).digest())
220	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/protocols/wamp.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
159	        ]
160	        self.app.ws.send(serialize(welcome))
161	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/protocols/wamp.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	    def _get_exception_info(self, e):
163	        uri = 'http://TODO#generic'
164	        desc = str(type(e))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
50	        try:
51	            self.close()
52	        except:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
69	        except UnicodeDecodeError:
70	            self.close(1007)
71	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
157	        if not payload:
158	            self.close(1000, None)
159	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
178	
179	        self.close(code, payload)
180	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
269	            elif f_opcode == self.OPCODE_CLOSE:
270	                self.handle_close(header, payload)
271	                return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
296	        if self.closed:
297	            self.current_app.on_close(MSG_ALREADY_CLOSED)
298	            raise WebSocketError(MSG_ALREADY_CLOSED)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
302	        except UnicodeError:
303	            self.close(1007)
304	        except ProtocolError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
304	        except ProtocolError:
305	            self.close(1002)
306	        except error:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
306	        except error:
307	            self.close()
308	            self.current_app.on_close(MSG_CLOSED)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
307	            self.close()
308	            self.current_app.on_close(MSG_CLOSED)
309	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
316	        if self.closed:
317	            self.current_app.on_close(MSG_ALREADY_CLOSED)
318	            raise WebSocketError(MSG_ALREADY_CLOSED)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
345	        except WebSocketError:
346	            self.current_app.on_close(MSG_SOCKET_DEAD)
347	            raise WebSocketError(MSG_SOCKET_DEAD)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gevent_websocket-0.10.1-py3-none-any/geventwebsocket/websocket.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
356	        if self.closed:
357	            self.current_app.on_close(MSG_ALREADY_CLOSED)
358	

--------------------------------------------------

Code scanned:
	Total lines of code: 1134
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 3.0
Files skipped (0):
