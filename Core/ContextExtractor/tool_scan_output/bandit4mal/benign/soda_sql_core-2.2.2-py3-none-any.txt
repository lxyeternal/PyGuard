Run started:2025-04-12 17:45:48.333559

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/cli/cli.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	        logger.exception(f'Exception: {str(e)}')
173	        logger.info("If you think this is a bug in Soda SQL, please open an issue at: "
174	                    "https://github.com/sodadata/soda-sql/issues/new/choose")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/cli/cli.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
350	        logger.exception(f'Exception: {str(e)}')
351	        logger.info("If you think this is a bug in Soda SQL, please open an issue at"
352	                    "https://github.com/sodadata/soda-sql/issues/new/choose")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/cli/cli.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
489	        logger.exception(f'Scan failed: {str(e)}')
490	        logger.info("If you think this is a bug in Soda SQL, please open an issue at: "
491	                    "https://github.com/sodadata/soda-sql/issues/new/choose")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/cli/ingest.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	KEY_DBT_CLOUD_API_TOKEN = "dbt_cloud_api_token"
34	DBT_ADMIN_API_BASE_URL = "https://cloud.getdbt.com/api/v2/accounts/"
35	
36	
37	@dataclasses.dataclass(frozen=True)
38	class Table:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/cli/ingest.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	            scan_time=dt.datetime.utcnow().isoformat(),
176	            origin=os.environ.get("SODA_SCAN_ORIGIN", "external"),
177	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/cli/ingest.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	    logger.info(f"Downloading artifact: {artifact}, from run: {run_id}")
250	    response = requests.get(url, headers=headers)
251	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/cli/ingest.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	    query_params = {"job_definition_id": job_id, "order_by": "-finished_at"}
266	    response = requests.get(url, headers=headers, params=query_params)
267	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/cli/ingest.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
270	    response_json = response.json()
271	    run_id = response_json.get("data")[0].get('id')
272	    return run_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/cli/ingest.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
270	    response_json = response.json()
271	    run_id = response_json.get("data")[0].get('id')
272	    return run_id

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/scan/file_system.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	            with open(expanded_path, encoding='utf-8') as f:
63	                return f.read()
64	        except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/scan/file_system.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
71	            with open(path_path, 'w+', encoding='utf-8') as f:
72	                f.write(file_content_str)
73	        except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/scan/parser.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	            with open(file_path, encoding='utf-8') as f:
72	                return f.read()
73	        except Exception as e:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/scan/sampler.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
148	                for row in sample_rows:
149	                    temp_file.write(bytearray(json.dumps(row), 'utf-8'))
150	                    temp_file.write(b'\n')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/scan/sampler.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
149	                    temp_file.write(bytearray(json.dumps(row), 'utf-8'))
150	                    temp_file.write(b'\n')
151	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/scan/sampler.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
243	                        sample_values.append(self.__serialize_file_upload_value(row[i]))
244	                    temp_file.write(bytearray(json.dumps(sample_values), 'utf-8'))
245	                    temp_file.write(b'\n')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/scan/sampler.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
244	                    temp_file.write(bytearray(json.dumps(sample_values), 'utf-8'))
245	                    temp_file.write(b'\n')
246	                    stored_rows += 1

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/soda_server_client/soda_server_client.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
168	    def _upload_file(self, headers, temp_file):
169	        upload_response = requests.post(
170	            f'{self.api_url}/scan/upload',
171	            headers=headers,
172	            data=temp_file)
173	        return upload_response.json()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/soda_server_client/soda_server_client.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
227	        logger.debug(f'executing {command}')
228	        return self._execute_request('command', command, False)
229	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/soda_server_client/soda_server_client.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
230	    def execute_query(self, command: dict):
231	        return self._execute_request('query', command, False)
232	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/soda_server_client/soda_server_client.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
236	        request_body['sodaSqlVersion'] = SODA_SQL_VERSION
237	        response = requests.post(f'{self.api_url}/{request_type}', json=request_body)
238	        response_json = response.json()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/soda_server_client/soda_server_client.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
242	            self.token = None
243	            response_json = self._execute_request(request_type, request_body, True)
244	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/soda_server_client/soda_server_client.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
263	
264	            login_response = requests.post(f'{self.api_url}/command', json=login_command)
265	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/soda_server_client/soda_server_client.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	            login_response_json = login_response.json()
269	            self.token = login_response_json.get('token')
270	            assert self.token, 'No token in login response?!'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/telemetry/soda_telemetry.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	
40	    ENDPOINT = 'https://collect.soda.io/v1/traces'
41	    __instance = None

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/telemetry/soda_telemetry.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
69	                        'python.implementation': platform.python_implementation(),
70	                        ResourceAttributes.OS_TYPE: platform.system(),
71	                        ResourceAttributes.OS_VERSION: platform.version(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/soda_sql_core-2.2.2-py3-none-any/sodasql/telemetry/soda_telemetry.py:70
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
69	                        'python.implementation': platform.python_implementation(),
70	                        ResourceAttributes.OS_TYPE: platform.system(),
71	                        ResourceAttributes.OS_VERSION: platform.version(),

--------------------------------------------------

Code scanned:
	Total lines of code: 5220
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 1.0
Files skipped (0):
