Run started:2025-04-12 19:46:15.018774

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	                       thread=thread, blocksize=blocksize) as f:
73	        f.write(data)
74	    return buf.getvalue()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
81	                       blocksize=blocksize) as f:
82	        return f.read()
83	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	                self.thread = os.cpu_count()
165	            self._init_write(filename)
166	            self.compress = zlib.compressobj(compresslevel,

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
173	            self.blocksize = blocksize # use 20M blocksize as default
174	            self.pool = Pool(self.thread)
175	            self.pool_result = []

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
241	        elif length < self.blocksize:
242	            self.small_buf.write(data)
243	            if self.small_buf.tell() >= self.blocksize:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
283	        size = self._write_member_header(len(cdata[0]) + len(cdata[1]) + len(cdata[2]), cdata[4])
284	        self.fileobj.write(cdata[0])                   # buffer data
285	        self.fileobj.write(cdata[1])                   # body data

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
284	        self.fileobj.write(cdata[0])                   # buffer data
285	        self.fileobj.write(cdata[1])                   # body data
286	        self.fileobj.write(cdata[2])                   # rest data

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
285	        self.fileobj.write(cdata[1])                   # body data
286	        self.fileobj.write(cdata[2])                   # rest data
287	        write32u(self.fileobj, cdata[3])               # CRC32

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
291	    def _write_member_header(self, compressed_size, raw_size):
292	        self.fileobj.write(b'\037\213')             # magic header, 2 bytes
293	        self.fileobj.write(b'\010')                 # compression method, 1 byte

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
292	        self.fileobj.write(b'\037\213')             # magic header, 2 bytes
293	        self.fileobj.write(b'\010')                 # compression method, 1 byte
294	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
306	            flags |= FNAME
307	        self.fileobj.write(chr(flags).encode('latin-1'))  # flags, 1 byte
308	        mtime = self._write_mtime

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
311	        write32u(self.fileobj, int(mtime))          # modified time, 4 bytes
312	        self.fileobj.write(b'\002')                 # fixed flag (maximum compression), 1 byte
313	        self.fileobj.write(b'\377')                 # OS (unknown), 1 byte

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
312	        self.fileobj.write(b'\002')                 # fixed flag (maximum compression), 1 byte
313	        self.fileobj.write(b'\377')                 # OS (unknown), 1 byte
314	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
316	        # XLEN, 8 bytes
317	        self.fileobj.write(b'\x08\x00')             # extra flag len, 2 bytes
318	        # EXTRA FLAG FORMAT:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
324	        # MEMBER SIZE:   The size of current member
325	        self.fileobj.write(SID)                   # subfield ID (IG), 2 bytes
326	        # LEN: 4 bytes

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
326	        # LEN: 4 bytes
327	        self.fileobj.write(b'\x04\x00')             # subfield len (4), 2 bytes
328	        # compressed data size: 16 + 4 + len(fname) + 1 + data + 8

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
332	            member_size -= 1
333	        self.fileobj.write(struct.pack("<I", member_size)) # member size, 4 bytes
334	        if fname:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
334	        if fname:
335	            self.fileobj.write(fname + b'\000')
336	        return member_size

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
353	            self.myfileobj.seek(3, 1)
354	            fByte = self.myfileobj.read(1)
355	            if not fByte:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
358	            self.myfileobj.seek(8, 1)
359	            extra_flag = self.myfileobj.read(8)
360	            if not extra_flag:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
366	                while True:
367	                    s = self.myfileobj.read(1)
368	                    if not s or s==b'\000':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
371	                while True:
372	                    s = self.myfileobj.read(1)
373	                    if not s or s==b'\000':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
380	            self.myfileobj.seek(self.index[-1][0] + self.index[-1][1] - 4)
381	            isize, = struct.unpack("<I", self.myfileobj.read(4))
382	            self.index[-1][2] = isize

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
471	        self._read_pool = []
472	        self._pool = Pool(self.thread)
473	        self._block_buff = b""

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
495	        ## not a good idea to read all of them in memory
496	        body_bytes = dpr.decompress(data, rsize)
497	        crc = zlib.crc32(body_bytes)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
506	    def _read_gzip_header(self):
507	        magic = self._fp.read(2)
508	        if magic == b'':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
533	            while True:
534	                s = self._fp.read(1)
535	                self._header_size += 1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
540	            while True:
541	                s = self._fp.read(1)
542	                self._header_size += 1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
580	                # jump to the next member, if there is one.
581	                self._init_read()
582	                if not self._read_gzip_header():

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
590	                        cpr_size = self.memberidx[-1] - self._header_size - 8
591	                        self._decompress_async(self._fp.read(cpr_size),
592	                                               *self._read_eof_crc())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
626	            # Read a chunk of data from the file
627	            buf = self._fp.read(io.DEFAULT_BUFFER_SIZE)
628	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
628	
629	            uncompress = self._decompressor.decompress(buf, size)
630	            if self._decompressor.unconsumed_tail != b"":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/mgzip/multiProcGzip.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
657	        while c == b"\x00":
658	            c = self._fp.read(1)
659	        if c:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/setup.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	with open('README.md') as fh:
5	    longDesc = fh.read().replace("CompressionBenchmark.png", "https://raw.githubusercontent.com/vinlyx/mgzip/master/CompressionBenchmark.png").replace("DecompressionBenchmark.png", "https://raw.githubusercontent.com/vinlyx/mgzip/master/DecompressionBenchmark.png")
6	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/setup.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	with open('README.md') as fh:
5	    longDesc = fh.read().replace("CompressionBenchmark.png", "https://raw.githubusercontent.com/vinlyx/mgzip/master/CompressionBenchmark.png").replace("DecompressionBenchmark.png", "https://raw.githubusercontent.com/vinlyx/mgzip/master/DecompressionBenchmark.png")
6	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mgzip-0.2.1/mgzip-0.2.1/setup.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    long_description_content_type="text/markdown",
16	    url='https://github.com/vinlyx/mgzip',
17	    license='MIT',

--------------------------------------------------

Code scanned:
	Total lines of code: 611
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 33.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 0.0
Files skipped (0):
