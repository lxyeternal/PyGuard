Run started:2025-04-12 16:18:26.445666

Test results:
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/comm.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
59	                            unicode_errors='surrogateescape')
60	        self.writesock.sendall(buf)
61	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/comm.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
90	                try:
91	                    buf = self.readsock.recv(4096)
92	                    if not buf:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/comm.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
139	        self.lock = threading.Lock()
140	        self.reader_thread = threading.Thread(
141	            name='privsep_reader',
142	            target=self._reader_main,
143	            args=(Deserializer(sock),),
144	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/comm.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
191	            try:
192	                self.writer.send((myid, msg))
193	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/comm.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
204	        with self.lock:
205	            self.writer.close()
206	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/comm.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
227	        with self.wlock:
228	            self.writer.send(msg)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
181	
182	        self.channel.send((None, (comm.Message.LOG, data)))
183	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
195	            # exchange "ready" messages
196	            reply = self.send_recv((comm.Message.PING.value,))
197	            success = reply[0] == comm.Message.PONG

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
207	    def remote_call(self, name, args, kwargs, timeout):
208	        result = self.send_recv((comm.Message.CALL.value, name, args, kwargs),
209	                                timeout)
210	        if result[0] == comm.Message.RET:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
257	            LOG.log(level, 'privsep log: %s', line.rstrip())
258	    t = threading.Thread(
259	        name='fd_logger',
260	        target=logger, args=(read_end,)
261	    )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
314	            channel = comm.ServerChannel(sock_b)
315	            sock_a.close()
316	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
326	
327	        sock_b.close()
328	        super().__init__(sock_a, context)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:338
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
337	
338	        listen_sock = socket.socket(socket.AF_UNIX)
339	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
369	            # Don't need listen_sock anymore, so clean up.
370	            listen_sock.close()
371	            try:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
389	        self.caps = set(context.conf.capabilities)
390	        self.thread_pool = futures.ThreadPoolExecutor(
391	            context.conf.thread_pool_size)
392	        self.communication_error = None

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
429	        LOG.info('privsep process running with uid/gid: %(uid)s/%(gid)s',
430	                 {'uid': os.getuid(), 'gid': os.getgid()})
431	

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:430
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
429	        LOG.info('privsep process running with uid/gid: %(uid)s/%(gid)s',
430	                 {'uid': os.getuid(), 'gid': os.getgid()})
431	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
504	                          {'msgid': msgid, 'reply': reply})
505	                channel.send((msgid, reply))
506	            except OSError:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
515	                try:
516	                    channel.send((msgid, reply))
517	                except OSError as exc:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:565
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
564	
565	    sock = socket.socket(socket.AF_UNIX)
566	    sock.connect(cfg.CONF.privsep_sock_path)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/daemon.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
565	    sock = socket.socket(socket.AF_UNIX)
566	    sock.connect(cfg.CONF.privsep_sock_path)
567	    set_cloexec(sock)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/tests/test_comm.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	        self.buf.seek(self.readpos, 0)
31	        data = self.buf.read(bufsize)
32	        self.readpos += len(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oslo_privsep-3.6.0/oslo_privsep-3.6.0/oslo_privsep/tests/test_comm.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
36	        self.buf.seek(0, 2)
37	        self.buf.write(data)
38	

--------------------------------------------------

Code scanned:
	Total lines of code: 1543
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 3.0
Files skipped (0):
