Run started:2025-04-12 12:09:42.992918

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/__init__.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
79	    if nvim.version.api_level < 1:
80	        sys.stderr.write("This version of pynvim "
81	                         "requires nvim 0.1.6 or later")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/api/nvim.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
198	        if (self._session._loop_thread is not None
199	                and threading.current_thread() != self._session._loop_thread):
200	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/api/nvim.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
446	        return (self._session._loop_thread is not None
447	                and threading.current_thread() != self._session._loop_thread)
448	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/msgpack_rpc/event_loop/asyncio.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
236	        assert self._transport, "connection has not been established."
237	        self._transport.write(data)
238	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/msgpack_rpc/event_loop/base.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
20	# default state, we keep a reference to the default handler
21	default_int_handler = signal.getsignal(signal.SIGINT)
22	main_thread = threading.current_thread()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/msgpack_rpc/event_loop/base.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
200	            self._teardown_signals()
201	            signal.signal(signal.SIGINT, default_int_handler)
202	        self._on_data = None

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/msgpack_rpc/event_loop/base.py:201
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
200	            self._teardown_signals()
201	            signal.signal(signal.SIGINT, default_int_handler)
202	        self._on_data = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/host.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
70	        # uncaught python exception
71	        self.nvim.err_write(msg, async_=True)
72	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/host.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	            self.name, decode_if_bytes(msg))
78	        self.nvim.err_write(errmsg, async_=True)
79	        return errmsg

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/host.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
289	        if path in self._load_errors:
290	            self.nvim.out_write(self._load_errors[path] + '\n')
291	        return self._specs.get(path, 0)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/script_host.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
33	        # it seems some plugins assume 'sys' is already imported, so do it now
34	        exec('import sys', self.module.__dict__)
35	        self.legacy_vim = LegacyVim.from_nvim(nvim)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/script_host.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
37	        # mimic Vim by importing vim module by default.
38	        exec('import vim', self.module.__dict__)
39	        # Handle DirChanged. #296

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/script_host.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        self.saved_stderr = sys.stderr
69	        sys.stdout = RedirectStream(lambda data: nvim.out_write(data))
70	        sys.stderr = RedirectStream(lambda data: nvim.err_write(data))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/script_host.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
69	        sys.stdout = RedirectStream(lambda data: nvim.out_write(data))
70	        sys.stderr = RedirectStream(lambda data: nvim.err_write(data))
71	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/script_host.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
97	            # pylint: disable-next=exec-used
98	            exec(script, self.module.__dict__)
99	        except Exception as exc:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/script_host.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
106	        with open(file_path, 'rb') as f:
107	            script = compile(f.read(), file_path, 'exec')
108	            try:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/script_host.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
109	                # pylint: disable-next=exec-used
110	                exec(script, self.module.__dict__)
111	            except Exception as exc:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/pynvim/plugin/script_host.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
123	        function_def = 'def %s(line, linenr):\n %s' % (fname, code,)
124	        exec(function_def, self.module.__dict__)
125	        # get the function

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/setup.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
41	    _version_env = {}
42	    exec(fp.read(), _version_env)  # pylint: disable=exec-used
43	    version = _version_env['__version__']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/setup.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
41	    _version_env = {}
42	    exec(fp.read(), _version_env)  # pylint: disable=exec-used
43	    version = _version_env['__version__']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/setup.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	      description='Python client for Neovim',
49	      url='http://github.com/neovim/pynvim',
50	      download_url=f'https://github.com/neovim/pynvim/archive/{version}.tar.gz',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/setup.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	      url='http://github.com/neovim/pynvim',
50	      download_url=f'https://github.com/neovim/pynvim/archive/{version}.tar.gz',
51	      author='Neovim Authors',

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/test/test_attach.py:63
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
62	    """Find a free, available port number."""
63	    with socket.socket() as sock:
64	        sock.bind(('', 0))  # Bind to a free port provided by the host.

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/test/test_attach.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
69	    """Tests TCP connection."""
70	    address = '127.0.0.1'
71	    port = find_free_port()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/test/test_attach.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
90	    with pytest.raises(ConnectionRefusedError):
91	        pynvim.attach('tcp', address='127.0.0.1', port=port)
92	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/test/test_attach.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
102	            with os.fdopen(fd, 'w') as f:
103	                f.write(code)
104	            vim.command('source ' + fname)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/test/test_attach.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
102	            with os.fdopen(fd, 'w') as f:
103	                f.write(code)
104	            vim.command('source ' + fname)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/test/test_logging.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	    assert os.path.exists(logfile)
23	    assert open(logfile, 'r').read() == ''
24	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/test/test_vim.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
15	    with os.fdopen(fd, 'w') as f:
16	        f.write(code)
17	    vim.command('source ' + fname)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/test/test_vim.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
15	    with os.fdopen(fd, 'w') as f:
16	        f.write(code)
17	    vim.command('source ' + fname)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pynvim-0.5.2/pynvim-0.5.2/test/test_vim.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	    with open(fname) as f:
35	        assert f.read() == 'testing\npython\napi\n'
36	    try:

--------------------------------------------------

Code scanned:
	Total lines of code: 3581
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 19.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 8.0
Files skipped (0):
