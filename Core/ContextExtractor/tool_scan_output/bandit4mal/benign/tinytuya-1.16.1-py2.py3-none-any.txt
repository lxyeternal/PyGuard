Run started:2025-04-12 12:28:08.803060

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    print("WARN: Unable to import requests library, Cloud functions will not work.")
40	    print("WARN: Check dependencies. See https://github.com/jasonacox/tinytuya/issues/377")
41	    print("WARN: Error: {}.".format(impErr.args[0]))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	        if ver:
142	            url = "https://%s/%s/%s" % (self.urlhost, ver, uri)
143	        elif uri[0] == '/':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	        elif uri[0] == '/':
144	            url = "https://%s%s" % (self.urlhost, uri)
145	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        else:
146	            url = "https://%s/%s" % (self.urlhost, uri)
147	        headers = {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
194	                ''.join(['%s:%s\n'%(key, headers[key])                                   # Headers
195	                            for key in headers.get("Signature-Headers", "").split(":")
196	                            if key in headers]) + '\n' +

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	        if action == 'GET':
217	            response = requests.get(url, headers=headers)
218	            log.debug(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
224	            )
225	            response = requests.post(url, headers=headers, data=body)
226	            log.debug(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
363	        while has_more:
364	            result = self.cloudrequest( uri, query=query )
365	            fetches += 1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
537	        tuyadevices = []
538	        icon_host = 'https://images.' + self.urlhost.split( '.', 1 )[1] + '/'
539	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
748	
749	        ret = self.cloudrequest( '/v1.0/devices/%s/logs' % deviceid, query=params)
750	        max_fetches -= 1

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Cloud.py:772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
771	                result['has_next'] = False
772	                res = self.cloudrequest( '/v1.0/devices/%s/logs' % deviceid, query=params)
773	                if res and 'result' in res:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/IRRemoteControlDevice.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
351	            code_base_64 = code_base_64[1:]
352	        raw_bytes = base64.b64decode(code_base_64)
353	        fmt = '<%dH' % (len(raw_bytes) >> 1)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/IRRemoteControlDevice.py:352
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
351	            code_base_64 = code_base_64[1:]
352	        raw_bytes = base64.b64decode(code_base_64)
353	        fmt = '<%dH' % (len(raw_bytes) >> 1)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/IRRemoteControlDevice.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
358	        fmt = '<' + str(len(pulses)) + 'H'
359	        return base64.b64encode( struct.pack(fmt, *pulses) ).decode("ascii")
360	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/IRRemoteControlDevice.py:359
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
358	        fmt = '<' + str(len(pulses)) + 'H'
359	        return base64.b64encode( struct.pack(fmt, *pulses) ).decode("ascii")
360	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/RFRemoteControlDevice.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
246	        try:
247	            jstr = base64.b64decode( base64_code )
248	            #jdata = json.loads( jstr )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/RFRemoteControlDevice.py:247
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
246	        try:
247	            jstr = base64.b64decode( base64_code )
248	            #jdata = json.loads( jstr )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/ThermostatDevice.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
397	        if 'base64' in ddata:
398	            val = base64.b64encode( val ).decode('ascii')
399	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/ThermostatDevice.py:398
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
397	        if 'base64' in ddata:
398	            val = base64.b64encode( val ).decode('ascii')
399	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/ThermostatDevice.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
474	                if ('base64' in self.dps_data[k]) and self.dps_data[k]:
475	                    val = base64.b64decode( val )
476	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/ThermostatDevice.py:475
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
474	                if ('base64' in self.dps_data[k]) and self.dps_data[k]:
475	                    val = base64.b64decode( val )
476	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/ThermostatDevice.py:849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
848	        def b64(self):
849	            return base64.b64encode( bytes(self) ).decode('ascii')
850	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/ThermostatDevice.py:849
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
848	        def b64(self):
849	            return base64.b64encode( bytes(self) ).decode('ascii')
850	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/ThermostatDevice.py:926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
925	        if isinstance(sensordata_list, str):
926	            sensordata_list = base64.b64decode( sensordata_list )
927	        elif not isinstance(sensordata_list, bytes):

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/ThermostatDevice.py:926
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
925	        if isinstance(sensordata_list, str):
926	            sensordata_list = base64.b64decode( sensordata_list )
927	        elif not isinstance(sensordata_list, bytes):

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/ThermostatDevice.py:981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
980	            b += bytearray( bytes( s ) )
981	        return base64.b64encode( b ).decode('ascii')
982	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/Contrib/ThermostatDevice.py:981
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
980	            b += bytearray( bytes( s ) )
981	        return base64.b64encode( b ).decode('ascii')
982	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
264	            self.parent._register_child(self)
265	        elif (not address) or address == "Auto" or address == "0.0.0.0":
266	            # try to determine IP address automatically

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
286	                # self.socket.shutdown(socket.SHUT_RDWR)
287	                self.socket.close()
288	                self.socket = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
303	            # self.socket.shutdown(socket.SHUT_RDWR)
304	            self.socket.close()
305	            self.socket = None

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:331
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
330	
331	                self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
332	                if self.socketNODELAY:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
333	                    self.socket.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
334	                self.socket.settimeout(self.connection_timeout)
335	                try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
336	                    retries = retries + 1
337	                    self.socket.connect((self.address, self.port))
338	                    if self.version >= 3.4:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
343	                            if self.socket:
344	                                self.socket.close()
345	                                self.socket = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
363	                if self.socket:
364	                    self.socket.close()
365	                    self.socket = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
376	        if (force or not self.socketPersistent) and self.socket:
377	            self.socket.close()
378	            self.socket = None

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
384	        while length > 0:
385	            newdata = self.socket.recv(length)
386	            if not newdata or len(newdata) == 0:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
450	        try:
451	            self.socket.sendall(enc_payload)
452	        except:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
452	        except:
453	            self._check_socket_close(True)
454	            return None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
510	                # unable to get a socket - device likely offline
511	                self._check_socket_close(True)
512	                return error_json( sock_result if sock_result else ERR_OFFLINE )

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
517	                    enc_payload = self._encode_message(payload) if type(payload) == MessagePayload else payload
518	                    self.socket.sendall(enc_payload)
519	                    if self.sendWait is not None:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
539	                    # legacy/default mode avoids persisting socket across commands
540	                    self._check_socket_close()
541	                    return None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
548	                    # Receive only mode - return None
549	                    self._check_socket_close()
550	                    return None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
553	                # toss old socket and get new one
554	                self._check_socket_close(True)
555	                log.debug(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
574	                    if partial_success:
575	                        self._check_socket_close()
576	                        return None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
577	                    # no valid messages received
578	                    self._check_socket_close(True)
579	                    return error_json(ERR_PAYLOAD)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
584	                # toss old socket and get new one
585	                self._check_socket_close(True)
586	                log.debug(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
606	            # legacy/default mode avoids persisting socket across commands
607	            self._check_socket_close()
608	            return msg

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
616	            # legacy/default mode avoids persisting socket across commands
617	            self._check_socket_close()
618	            return None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
673	        # legacy/default mode avoids persisting socket across commands
674	        self._check_socket_close()
675	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:1000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
999	        if self.socket and not persist:
1000	            self.socket.close()
1001	            self.socket = None

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/XenonDevice.py:1020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
1019	        if self.socket:
1020	            self.socket.settimeout(s)
1021	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
96	
97	        return base64.b64encode(crypted_text) if use_base64 else crypted_text
98	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:97
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
96	
97	        return base64.b64encode(crypted_text) if use_base64 else crypted_text
98	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
101	            if use_base64:
102	                enc = base64.b64decode(enc)
103	            if len(enc) % 16 != 0:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:102
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
101	            if use_base64:
102	                enc = base64.b64decode(enc)
103	            if len(enc) % 16 != 0:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
133	
134	        return base64.b64encode(crypted_text) if use_base64 else crypted_text
135	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:134
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
133	
134	        return base64.b64encode(crypted_text) if use_base64 else crypted_text
135	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
138	            if use_base64:
139	                enc = base64.b64decode(enc)
140	            if len(enc) % 16 != 0:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:139
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
138	            if use_base64:
139	                enc = base64.b64decode(enc)
140	            if len(enc) % 16 != 0:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
169	        crypted_text += cipher.feed()  # flush final block
170	        return base64.b64encode(crypted_text) if use_base64 else crypted_text
171	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:170
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
169	        crypted_text += cipher.feed()  # flush final block
170	        return base64.b64encode(crypted_text) if use_base64 else crypted_text
171	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
177	        if use_base64:
178	            enc = base64.b64decode(enc)
179	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/core/crypto_helper.py:178
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
177	        if use_base64:
178	            enc = base64.b64decode(enc)
179	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:101
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
100	    # Fetch my IP address and assume /24 network
101	    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
102	    s.connect(("8.8.8.8", 80))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
101	    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
102	    s.connect(("8.8.8.8", 80))
103	    r = str(s.getsockname()[0])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
101	    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
102	    s.connect(("8.8.8.8", 80))
103	    r = str(s.getsockname()[0])

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
103	    r = str(s.getsockname()[0])
104	    s.close()
105	    return r

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
201	
202	    ip_to_broadcast['255.255.255.255'] = getmyIPaddr()
203	    return ip_to_broadcast

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:221
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
220	        if 'socket' not in iface:
221	            iface['socket'] = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP
222	            iface['socket'].setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
245	        if close_sockets:
246	            iface['socket'].close()
247	            del iface['socket']

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
316	            print('Connecting to debug ip', self.ip)
317	        if self.sock: self.sock.close()
318	        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:318
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
317	        if self.sock: self.sock.close()
318	        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
319	        #self.sock.settimeout(TCPTIMEOUT)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
336	            print('in close 0', self.ip)
337	        if self.sock: self.sock.close()
338	        self.sock = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
345	        if self.sock:
346	            self.close()
347	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
364	                # this should throw either ConnectionResetError or ConnectionRefusedError
365	                r = self.sock.recv( 5000 )
366	                if self.debug:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
388	                    traceback.print_exc()
389	                self.close()
390	                return None

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
398	        step1 = self.device._negotiate_session_key_generate_step_1()
399	        self.sock.sendall( self.device._encode_message( step1 ) )
400	        if self.try_v35_with_v34 and self.device.version == 3.4:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
402	            step1 = self.device._negotiate_session_key_generate_step_1()
403	            self.sock.sendall( self.device._encode_message( step1 ) )
404	            self.device.version = 3.4

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
415	            return False
416	        self.sock.sendall( self.device._encode_message( step3 ) )
417	        self.device._negotiate_session_key_generate_finalize()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
429	
430	        self.connect()
431	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
435	        self.found = False
436	        self.close()
437	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
468	                self.retries += 1
469	                self.connect()
470	            else:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
479	                    self.step = FSCAN_NOT_STARTED
480	                    self.connect()
481	                    return

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
496	                else:
497	                    self.connect()
498	                    self.v34_connect_ok = False

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
503	                    self.retries += 1
504	                    self.connect()
505	                else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
510	                    self.displayed = True
511	                    self.close()
512	                return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
543	        if self.remove:
544	            self.close()
545	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
555	            # refused
556	            self.close()
557	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
562	            if self.sock:
563	                self.sock.close()
564	            self.connect()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
563	                self.sock.close()
564	            self.connect()
565	            return

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
573	        if len(self.send_queue) > 0:
574	            self.sock.sendall( self.device._encode_message( self.send_queue[0] ) )
575	            self.send_queue = self.send_queue[1:]

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
623	            try:
624	                self.sock.sendall( msg )
625	            except:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
631	        try:
632	            data = self.sock.recv( 5000 )
633	        except:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
754	                    try:
755	                        self.brute_force_data.append( base64.b64decode( payload ) )
756	                        self.brute_force_v3x_data()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:755
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
754	                    try:
755	                        self.brute_force_data.append( base64.b64decode( payload ) )
756	                        self.brute_force_v3x_data()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
784	                if finished:
785	                    self.close()
786	                else:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:852
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
851	                    print('ForceScannedDevice: v3.x brute force ran out of keys, restarting without skipping any', self.ip, self.cur_key.key)
852	                self.connect()
853	        else:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
855	                print('ForceScannedDevice: v3.x brute force trying next key', self.ip, self.cur_key.key)
856	            self.connect()
857	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
867	        self.device.local_key = self.device.real_local_key = self.cur_key.key_encoded
868	        self.sock.sendall( self.device._encode_message( self.device.generate_payload(tinytuya.DP_QUERY) ) )
869	        self.step = FSCAN_FINAL_POLL

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
893	    def close(self):
894	        super(PollDevice, self).close()
895	        if self.options['verbose']:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
905	            if self.sock:
906	                self.sock.close()
907	            self.connect()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:907
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
906	                self.sock.close()
907	            self.connect()
908	            self.timeo = time.time() + tinytuya.TIMEOUT

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
917	            self.message = "%s    Polling %s Failed: %s" % (self.options['termcolors'].alertdim, self.ip, err)
918	            self.close()
919	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
936	        if len(self.send_queue) > 0:
937	            self.sock.sendall( self.device._encode_message( self.send_queue[0] ) )
938	            self.send_queue = self.send_queue[1:]

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
951	            else:
952	                self.sock.sendall( self.device._encode_message( self.device.generate_payload(tinytuya.DP_QUERY) ) )
953	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
964	        try:
965	            data = self.sock.recv( 5000 )
966	        except:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
973	            self.message = "%s    Polling %s Failed: Read error" % (self.options['termcolors'].alertdim, self.ip)
974	            self.close()
975	            return

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
1020	                )
1021	                self.sock.sendall( self.device._encode_message( self.device.generate_payload(tinytuya.DP_QUERY) ) )
1022	                break

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1033
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1032	                self.deviceinfo["err"] = "Unable to poll"
1033	                self.close()
1034	            else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1037	                self.message = self.options['termcolors'].dim + "    Status: %s" % result["dps"]
1038	                self.close()
1039	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1180
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1179	        # Enable UDP listening broadcasting mode on UDP port 6666 - 3.1 Devices
1180	        client = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
1181	        client.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1191
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1190	        # Enable UDP listening broadcasting mode on encrypted UDP port 6667 - 3.3 Devices
1191	        clients = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
1192	        clients.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1202
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1201	        # Enable UDP listening broadcasting mode on encrypted UDP port 7000 - App
1202	        clientapp = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
1203	        clientapp.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1445	                                broadcasted_devices[ip] = PollDevice( ip, snapshot[current_ip], options, ip in debug_ips )
1446	                                broadcasted_devices[ip].connect()
1447	                                devicelist.append( broadcasted_devices[ip] )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1595	                else:
1596	                    broadcasted_devices[ip].close()
1597	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1622	        for ip in connect_this_round:
1623	            broadcasted_devices[ip].connect()
1624	            devicelist.append( broadcasted_devices[ip] )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1656	    for sock in read_socks:
1657	        sock.close()
1658	    for sock in write_socks:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1658	    for sock in write_socks:
1659	        sock.close()
1660	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1661	    if client:
1662	        client.close()
1663	        clients.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1662	        client.close()
1663	        clients.close()
1664	        clientapp.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1663	        clients.close()
1664	        clientapp.close()
1665	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tinytuya-1.16.1-py2.py3-none-any/tinytuya/scanner.py:1669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1668	        if 'socket' in iface:
1669	            iface['socket'].close()
1670	            del iface['socket']

--------------------------------------------------

Code scanned:
	Total lines of code: 8503
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 93.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 101.0
		High: 22.0
Files skipped (0):
