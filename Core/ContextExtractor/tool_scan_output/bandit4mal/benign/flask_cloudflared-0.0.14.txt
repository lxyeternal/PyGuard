Run started:2025-04-12 11:47:31.712833

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        'command': 'cloudflared-windows-amd64.exe',
18	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-windows-amd64.exe'
19	    },
20	    ('Windows', 'x86'): {
21	        'command': 'cloudflared-windows-386.exe',
22	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-windows-386.exe'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        'command': 'cloudflared-windows-386.exe',
22	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-windows-386.exe'
23	    },
24	    ('Linux', 'x86_64'): {
25	        'command': 'cloudflared-linux-amd64',
26	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	        'command': 'cloudflared-linux-amd64',
26	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64'
27	    },
28	    ('Linux', 'i386'): {
29	        'command': 'cloudflared-linux-386',
30	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-386'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	        'command': 'cloudflared-linux-386',
30	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-386'
31	    },
32	    ('Linux', 'arm'): {
33	        'command': 'cloudflared-linux-arm',
34	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	        'command': 'cloudflared-linux-arm',
34	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm'
35	    },
36	    ('Linux', 'arm64'): {
37	        'command': 'cloudflared-linux-arm64',
38	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm64'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        'command': 'cloudflared-linux-arm64',
38	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm64'
39	    },
40	    ('Linux', 'aarch64'): {
41	        'command': 'cloudflared-linux-arm64',
42	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm64'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	        'command': 'cloudflared-linux-arm64',
42	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm64'
43	    },
44	    ('Darwin', 'x86_64'): {
45	        'command': 'cloudflared',
46	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-darwin-amd64.tgz'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        'command': 'cloudflared',
46	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-darwin-amd64.tgz'
47	    },
48	    ('Darwin', 'arm64'): {
49	        'command': 'cloudflared',
50	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-darwin-amd64.tgz'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        'command': 'cloudflared',
50	        'url': 'https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-darwin-amd64.tgz'
51	    }
52	}
53	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
67	def _extract_tarball(tar_path, filename):
68	    tar = tarfile.open(tar_path+'/'+filename, 'r')
69	    for item in tar:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
74	def _download_cloudflared(cloudflared_path, command):
75	    system, machine = platform.system(), platform.machine()
76	    if Path(cloudflared_path, command).exists():

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
74	def _download_cloudflared(cloudflared_path, command):
75	    system, machine = platform.system(), platform.machine()
76	    if Path(cloudflared_path, command).exists():

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:75
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
74	def _download_cloudflared(cloudflared_path, command):
75	    system, machine = platform.system(), platform.machine()
76	    if Path(cloudflared_path, command).exists():

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
77	        executable = (cloudflared_path+'/'+'cloudflared') if (system == "Darwin" and machine in ["x86_64", "arm64"]) else (cloudflared_path+'/'+command)
78	        update_cloudflared = subprocess.Popen([executable, 'update'], stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT)
79	        return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	    local_filename = url.split('/')[-1]
86	    r = requests.get(url, stream=True)
87	    download_path = str(Path(tempfile.gettempdir(), local_filename))

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
87	    download_path = str(Path(tempfile.gettempdir(), local_filename))
88	    with open(download_path, 'wb') as f:
89	        shutil.copyfileobj(r.raw, f)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
92	def _run_cloudflared(port, metrics_port, tunnel_id=None, config_path=None):
93	    system, machine = platform.system(), platform.machine()
94	    command = _get_command(system, machine)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
92	def _run_cloudflared(port, metrics_port, tunnel_id=None, config_path=None):
93	    system, machine = platform.system(), platform.machine()
94	    command = _get_command(system, machine)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:93
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
92	def _run_cloudflared(port, metrics_port, tunnel_id=None, config_path=None):
93	    system, machine = platform.system(), platform.machine()
94	    command = _get_command(system, machine)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
102	    executable = str(Path(cloudflared_path, command))
103	    os.chmod(executable, 0o777)
104	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:103
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
102	    executable = str(Path(cloudflared_path, command))
103	    os.chmod(executable, 0o777)
104	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	    elif tunnel_id:
109	        cloudflared_command += ['--url', f'http://127.0.0.1:{port}', 'run', tunnel_id]
110	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	    else:
111	        cloudflared_command += ['--url', f'http://127.0.0.1:{port}']
112	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
113	    if system == "Darwin" and machine == "arm64":
114	        cloudflared = subprocess.Popen(['arch', '-x86_64'] + cloudflared_command, stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT)
115	    else:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
115	    else:
116	        cloudflared = subprocess.Popen(cloudflared_command, stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT)
117	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	    atexit.register(cloudflared.terminate)
119	    localhost_url = f"http://127.0.0.1:{metrics_port}/metrics"
120	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	        try:
123	            metrics = requests.get(localhost_url).text
124	            if tunnel_id or config_path:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/flask_cloudflared.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	    print(f" * Running on {cloudflared_address}")
144	    print(f" * Traffic stats available on http://127.0.0.1:{metrics_port}/metrics")
145	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_cloudflared-0.0.14/flask_cloudflared-0.0.14/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    long_description_content_type="text/markdown",
13	    url="https://github.com/UWUplus/flask-cloudflared",
14	    classifiers=[

--------------------------------------------------

Code scanned:
	Total lines of code: 159
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 12.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 3.0
Files skipped (0):
