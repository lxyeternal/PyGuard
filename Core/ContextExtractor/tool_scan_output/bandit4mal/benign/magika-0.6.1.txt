Run started:2025-04-12 10:18:59.419171

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	URLS_ALLOWLIST_PREFIXES = [
28	    "https://api.securityscorecards.dev/projects/github.com/google/magika/badge",
29	    "https://crates.io/crates/magika",
30	    "https://crates.io/crates/magika-cli",
31	    "https://www.unrealengine.com/en-US",
32	    "https://www.unrealengine.com/marketplace/en-US/store",
33	    "https://www.virustotal.com/",
34	]
35	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	    "https://api.securityscorecards.dev/projects/github.com/google/magika/badge",
29	    "https://crates.io/crates/magika",
30	    "https://crates.io/crates/magika-cli",
31	    "https://www.unrealengine.com/en-US",
32	    "https://www.unrealengine.com/marketplace/en-US/store",
33	    "https://www.virustotal.com/",
34	]
35	
36	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	    "https://crates.io/crates/magika",
30	    "https://crates.io/crates/magika-cli",
31	    "https://www.unrealengine.com/en-US",
32	    "https://www.unrealengine.com/marketplace/en-US/store",
33	    "https://www.virustotal.com/",
34	]
35	
36	
37	@click.command()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    "https://crates.io/crates/magika-cli",
31	    "https://www.unrealengine.com/en-US",
32	    "https://www.unrealengine.com/marketplace/en-US/store",
33	    "https://www.virustotal.com/",
34	]
35	
36	
37	@click.command()
38	@click.option("--skip-external-validity-check", is_flag=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    "https://www.unrealengine.com/en-US",
32	    "https://www.unrealengine.com/marketplace/en-US/store",
33	    "https://www.virustotal.com/",
34	]
35	
36	
37	@click.command()
38	@click.option("--skip-external-validity-check", is_flag=True)
39	@click.option("-v", "--verbose", is_flag=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	    "https://www.unrealengine.com/marketplace/en-US/store",
33	    "https://www.virustotal.com/",
34	]
35	
36	
37	@click.command()
38	@click.option("--skip-external-validity-check", is_flag=True)
39	@click.option("-v", "--verbose", is_flag=True)
40	def main(skip_external_validity_check: bool, verbose: bool) -> None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	    expected_lines = [
72	        f"> - The documentation on GitHub refers to the latest, potentially unreleased and unstable version of Magika. The latest stable release of the `magika` Python package is `{python_latest_stable_version}`, and you can consult the associated documenation [here](https://github.com/google/magika/tree/python-v{python_latest_stable_version}). You can install the latest stable version with: `pip install magika`.",
73	        f"- Trained and evaluated on a dataset of ~100M files across [200+ content types](./assets/models/{python_default_model_name}/README.md).",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	        f"| [Python `Magika` module](./python/README.md) | Stable enough for prod use cases | [`{python_default_model_name}`](./assets/models/{python_default_model_name}/README.md) |",
76	        f"| [Rust `magika` CLI](https://crates.io/crates/magika-cli) | Stable enough for prod use cases | [`{rust_default_model_name}`](./assets/models/{rust_default_model_name}/README.md) |",
77	        f"| [Rust `magika` library](https://docs.rs/magika) | Stable enough for prod use cases | [`{rust_default_model_name}`](./assets/models/{rust_default_model_name}/README.md) |",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	        f"| [Rust `magika` CLI](https://crates.io/crates/magika-cli) | Stable enough for prod use cases | [`{rust_default_model_name}`](./assets/models/{rust_default_model_name}/README.md) |",
77	        f"| [Rust `magika` library](https://docs.rs/magika) | Stable enough for prod use cases | [`{rust_default_model_name}`](./assets/models/{rust_default_model_name}/README.md) |",
78	    ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	def get_python_latest_stable_version() -> str:
95	    res = requests.get("https://pypi.org/pypi/magika/json")
96	    assert res.status_code == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	def get_python_latest_stable_version() -> str:
95	    res = requests.get("https://pypi.org/pypi/magika/json")
96	    assert res.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	    assert res.status_code == 200
97	    latest_stable_version = res.json().get("info", {}).get("version", None)
98	    assert latest_stable_version is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/check_documentation.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	    assert res.status_code == 200
97	    latest_stable_version = res.json().get("info", {}).get("version", None)
98	    assert latest_stable_version is not None

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/sync.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
60	    print(f"Deleting {PYTHON_MODELS_DIR}")
61	    shutil.rmtree(PYTHON_MODELS_DIR)
62	    for model_name in models_names:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/scripts/sync.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	
86	CONTENT_TYPE_LABEL_SOURCE_PREFIX = """
87	# Copyright 2024 Google LLC
88	#
89	# Licensed under the Apache License, Version 2.0 (the "License");
90	# you may not use this file except in compliance with the License.
91	# You may obtain a copy of the License at
92	#
93	#     http://www.apache.org/licenses/LICENSE-2.0
94	#
95	# Unless required by applicable law or agreed to in writing, software
96	# distributed under the License is distributed on an "AS IS" BASIS,
97	# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
98	# See the License for the specific language governing permissions and
99	# limitations under the License.
100	
101	
102	from magika.types.strenum import StrEnum
103	
104	# NOTE: DO NOT EDIT --- This file is automatically generated.
105	
106	
107	# This is the list of all possible content types we know about; however, models
108	# support a smaller subset of them. See model's README.md for details.
109	class ContentTypeLabel(StrEnum):
110	"""
111	
112	
113	def update_content_type_label_py() -> None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/src/magika/cli/magika_client.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
338	def get_magika_result_from_stdin(magika: Magika) -> MagikaResult:
339	    content = sys.stdin.buffer.read()
340	    result = magika.identify_bytes(content)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/src/magika/cli/magika_rust_client_not_found_warning.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	def main() -> None:
20	    message = """
21	WARNING: you have attempted to run `$ magika` (the Rust client), but this is not
22	available in the python package you installed, likely because magika pipeline
23	does not currently build binary wheels compatible with your platform settings.
24	
25	If you think this is a problem worth solving, please open an issue at
26	https://github.com/google/magika.
27	
28	In the meantime, you can use the old python magika client with `$ magika-python-client`.
29	"""
30	
31	    print(message.strip())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/src/magika/magika.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
917	            stream.seek(0)
918	            content = stream.read()
919	            result = self._get_result_from_few_bytes(content)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/src/magika/magika.py:942
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
941	                stream.seek(0)
942	                content = stream.read()
943	                result = self._get_result_from_few_bytes(content)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/src/magika/magika.py:956
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
955	        with open(path, "rb") as f:
956	            content = f.read(self._model_config.block_size)
957	        return self._get_result_from_few_bytes(content, path)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/tests/test_features_extraction.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
51	        test_info = TestInfo(**test_case["test_info"])
52	        test_content = base64.b64decode(test_case["content"])
53	        expected_features = ModelFeatures(**test_case["features_v2"])

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/tests/test_features_extraction.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
51	        test_info = TestInfo(**test_case["test_info"])
52	        test_content = base64.b64decode(test_case["content"])
53	        expected_features = ModelFeatures(**test_case["features_v2"])

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/tests/test_features_extraction.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
160	            "test_info": asdict(test_info),
161	            "content": base64.b64encode(test_content).decode("ascii"),
162	            "features_v2": asdict(features_v2),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/tests/test_features_extraction.py:161
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
160	            "test_info": asdict(test_info),
161	            "content": base64.b64encode(test_content).decode("ascii"),
162	            "features_v2": asdict(features_v2),

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/tests/test_magika_python_module.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
406	
407	    signal.signal(signal.SIGALRM, signal_handler)
408	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/magika-0.6.1/magika-0.6.1/tests/test_magika_python_module.py:407
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
406	
407	    signal.signal(signal.SIGALRM, signal_handler)
408	

--------------------------------------------------

Code scanned:
	Total lines of code: 3079
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 3.0
Files skipped (0):
