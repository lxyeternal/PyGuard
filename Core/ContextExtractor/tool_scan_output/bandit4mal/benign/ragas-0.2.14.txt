Run started:2025-04-12 18:41:53.468812

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/docs/alfred.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	            print("fixing: ", file)
27	            docs.append(File(file, f.read()))
28	    return docs

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/docs/alfred.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
71	        with open(doc.name, "w") as f:
72	            f.write(doc.content)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/docs/conf.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	        "discord": {
78	            "link": "https://discord.gg/5djav8GGNZ",
79	            "icon": """<svg height="26px" style="margin-right: 3px; display: inline" viewBox="0 0 22 22" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenod" clip-rule="evenod" d="M18.59 5.88997C17.36 5.31997 16.05 4.89997 14.67 4.65997C14.5 4.95997 14.3 5.36997 14.17 5.69997C12.71 5.47997 11.26 5.47997 9.83001 5.69997C9.69001 5.36997 9.49001 4.95997 9.32001 4.65997C7.94001 4.89997 6.63001 5.31997 5.40001 5.88997C2.92001 9.62997 2.25001 13.28 2.58001 16.87C4.23001 18.1 5.82001 18.84 7.39001 19.33C7.78001 18.8 8.12001 18.23 8.42001 17.64C7.85001 17.43 7.31001 17.16 6.80001 16.85C6.94001 16.75 7.07001 16.64 7.20001 16.54C10.33 18 13.72 18 16.81 16.54C16.94 16.65 17.07 16.75 17.21 16.85C16.7 17.16 16.15 17.42 15.59 17.64C15.89 18.23 16.23 18.8 16.62 19.33C18.19 18.84 19.79 18.1 21.43 16.87C21.82 12.7 20.76 9.08997 18.61 5.88997H18.59ZM8.84001 14.67C7.90001 14.67 7.13001 13.8 7.13001 12.73C7.13001 11.66 7.88001 10.79 8.84001 10.79C9.80001 10.79 10.56 11.66 10.55 12.73C10.55 13.79 9.80001 14.67 8.84001 14.67ZM15.15 14.67C14.21 14.67 13.44 13.8 13.44 12.73C13.44 11.66 14.19 10.79 15.15 10.79C16.11 10.79 16.87 11.66 16.86 12.73C16.86 13.79 16.11 14.67 15.15 14.67Z" fill="currentColor"/></svg>""",  # noqa
80	        },
81	        "github": {
82	            "link": "https://github.com/explodinggradients/ragas",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/docs/conf.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	            "link": "https://discord.gg/5djav8GGNZ",
79	            "icon": """<svg height="26px" style="margin-right: 3px; display: inline" viewBox="0 0 22 22" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenod" clip-rule="evenod" d="M18.59 5.88997C17.36 5.31997 16.05 4.89997 14.67 4.65997C14.5 4.95997 14.3 5.36997 14.17 5.69997C12.71 5.47997 11.26 5.47997 9.83001 5.69997C9.69001 5.36997 9.49001 4.95997 9.32001 4.65997C7.94001 4.89997 6.63001 5.31997 5.40001 5.88997C2.92001 9.62997 2.25001 13.28 2.58001 16.87C4.23001 18.1 5.82001 18.84 7.39001 19.33C7.78001 18.8 8.12001 18.23 8.42001 17.64C7.85001 17.43 7.31001 17.16 6.80001 16.85C6.94001 16.75 7.07001 16.64 7.20001 16.54C10.33 18 13.72 18 16.81 16.54C16.94 16.65 17.07 16.75 17.21 16.85C16.7 17.16 16.15 17.42 15.59 17.64C15.89 18.23 16.23 18.8 16.62 19.33C18.19 18.84 19.79 18.1 21.43 16.87C21.82 12.7 20.76 9.08997 18.61 5.88997H18.59ZM8.84001 14.67C7.90001 14.67 7.13001 13.8 7.13001 12.73C7.13001 11.66 7.88001 10.79 8.84001 10.79C9.80001 10.79 10.56 11.66 10.55 12.73C10.55 13.79 9.80001 14.67 8.84001 14.67ZM15.15 14.67C14.21 14.67 13.44 13.8 13.44 12.73C13.44 11.66 14.19 10.79 15.15 10.79C16.11 10.79 16.87 11.66 16.86 12.73C16.86 13.79 16.11 14.67 15.15 14.67Z" fill="currentColor"/></svg>""",  # noqa
80	        },
81	        "github": {
82	            "link": "https://github.com/explodinggradients/ragas",
83	            "icon": (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/docs/conf.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	        "github": {
82	            "link": "https://github.com/explodinggradients/ragas",
83	            "icon": (
84	                '<svg height="26px" style="margin-top:-2px;display:inline" '
85	                'viewBox="0 0 45 44" '
86	                'fill="currentColor" xmlns="http://www.w3.org/2000/svg">'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/docs/conf.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	            "icon": (
84	                '<svg height="26px" style="margin-top:-2px;display:inline" '
85	                'viewBox="0 0 45 44" '
86	                'fill="currentColor" xmlns="http://www.w3.org/2000/svg">'
87	                '<path fill-rule="evenodd" clip-rule="evenodd" '
88	                'd="M22.477.927C10.485.927.76 10.65.76 22.647c0 9.596 6.223 17.736 '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/_analytics.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	USAGE_TRACKING_URL = "https://t.explodinggradients.com"
30	USAGE_REQUESTS_TIMEOUT_SEC = 1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/_analytics.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	    # The function is cached for better performance.
41	    return os.environ.get(RAGAS_DO_NOT_TRACK, str(False)).lower() == "true"
42	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/_analytics.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	    # For Ragas developers only - debug and print event payload if turned on
47	    return os.environ.get(RAGAS_DEBUG_TRACKING, str(False)).lower() == "true"
48	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/_analytics.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
126	        # Create and start daemon thread
127	        self._flush_thread = Thread(target=self._flush_loop, daemon=True)
128	        logger.debug(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/_analytics.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
210	
211	    requests.post(USAGE_TRACKING_URL, json=payload, timeout=USAGE_REQUESTS_TIMEOUT_SEC)
212	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/dataset_schema.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
273	            for sample in self.to_list():
274	                jsonlfile.write(json.dumps(sample, ensure_ascii=False) + "\n")
275	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/dataset_schema.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
663	
664	        response = requests.get(
665	            f"{base_url}{endpoint}",
666	            headers={
667	                "Content-Type": "application/json",
668	                "x-app-token": app_token,
669	                "x-source": RAGAS_API_SOURCE,
670	                "x-app-version": __version__,
671	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/integrations/helicone.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    api_key: Optional[str] = None
14	    base_url: Optional[str] = "https://oai.helicone.ai"
15	    cache_config: Optional[CacheConfig] = None

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/prompt/multi_modal_prompt.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
183	                # Try to decode the string
184	                if base64.b64encode(base64.b64decode(s)).decode("utf-8") == s:
185	                    return True

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/prompt/multi_modal_prompt.py:184
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
183	                # Try to decode the string
184	                if base64.b64encode(base64.b64decode(s)).decode("utf-8") == s:
185	                    return True

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/prompt/multi_modal_prompt.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
183	                # Try to decode the string
184	                if base64.b64encode(base64.b64decode(s)).decode("utf-8") == s:
185	                    return True

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/prompt/multi_modal_prompt.py:184
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
183	                # Try to decode the string
184	                if base64.b64encode(base64.b64decode(s)).decode("utf-8") == s:
185	                    return True

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/prompt/multi_modal_prompt.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
198	        with open(file_path, "rb") as image_file:
199	            return base64.b64encode(image_file.read()).decode("utf-8")
200	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/prompt/multi_modal_prompt.py:199
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
198	        with open(file_path, "rb") as image_file:
199	            return base64.b64encode(image_file.read()).decode("utf-8")
200	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/prompt/multi_modal_prompt.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
201	    def download_and_encode_image(self, url):
202	        with urllib.request.urlopen(url) as response:
203	            return base64.b64encode(response.read()).decode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/prompt/multi_modal_prompt.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
202	        with urllib.request.urlopen(url) as response:
203	            return base64.b64encode(response.read()).decode("utf-8")
204	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/prompt/multi_modal_prompt.py:203
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
202	        with urllib.request.urlopen(url) as response:
203	            return base64.b64encode(response.read()).decode("utf-8")
204	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/sdk.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	# endpoint for uploading results
18	RAGAS_API_URL = "https://api.ragas.io"
19	RAGAS_APP_URL = "https://app.ragas.io"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/sdk.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	RAGAS_API_URL = "https://api.ragas.io"
19	RAGAS_APP_URL = "https://app.ragas.io"
20	RAGAS_API_SOURCE = "ragas_py"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/sdk.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	def get_app_token() -> str:
25	    app_token = os.environ.get("RAGAS_APP_TOKEN")
26	    if app_token is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/sdk.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	def get_api_url() -> str:
33	    return os.environ.get("RAGAS_API_URL", RAGAS_API_URL)
34	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/sdk.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	def get_app_url() -> str:
38	    return os.environ.get("RAGAS_APP_URL", RAGAS_APP_URL)
39	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/sdk.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	def get_enable_http_log() -> bool:
43	    log_value = os.environ.get("RAGAS_ENABLE_HTTP_LOG", "false").lower()
44	    return log_value == "true"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ragas-0.2.14/ragas-0.2.14/src/ragas/sdk.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
101	
102	    response = requests.post(
103	        f"{base_url}/api/v1{path}",
104	        data=data_json_string,
105	        headers=headers,
106	        timeout=(connection_timeout, read_timeout),
107	    )

--------------------------------------------------

Code scanned:
	Total lines of code: 16182
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 4.0
Files skipped (0):
