Run started:2025-04-12 12:19:00.500160

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
216	        svgz = gzout.getvalue()
217	        svg_b64 = base64.b64encode(svg).decode('ASCII')
218	        svgz_b64 = base64.b64encode(svgz).decode('ASCII')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:217
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
216	        svgz = gzout.getvalue()
217	        svg_b64 = base64.b64encode(svg).decode('ASCII')
218	        svgz_b64 = base64.b64encode(svgz).decode('ASCII')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
217	        svg_b64 = base64.b64encode(svg).decode('ASCII')
218	        svgz_b64 = base64.b64encode(svgz).decode('ASCII')
219	        urls = [

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:218
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
217	        svg_b64 = base64.b64encode(svg).decode('ASCII')
218	        svgz_b64 = base64.b64encode(svgz).decode('ASCII')
219	        urls = [

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
234	        data = b'123'
235	        data_b64 = base64.b64encode(data).decode('ASCII')
236	        urls = [

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:235
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
234	        data = b'123'
235	        data_b64 = base64.b64encode(data).decode('ASCII')
236	        urls = [

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
257	        data = b'123'
258	        data_b64 = base64.b64encode(data).decode('ASCII')
259	        urls = [

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:258
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
257	        data = b'123'
258	        data_b64 = base64.b64encode(data).decode('ASCII')
259	        urls = [

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
287	        data = b'123'
288	        data_b64 = base64.b64encode(data).decode('ASCII')
289	        url = "url(data:image/jpeg;base64,%s)" % data_b64

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:288
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
287	        data = b'123'
288	        data_b64 = base64.b64encode(data).decode('ASCII')
289	        url = "url(data:image/jpeg;base64,%s)" % data_b64

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
323	        # So, don't allow user to accidentally pass a string for host_whitelist.
324	        html = '<div><iframe src="https:///evil.com/page"></div>'
325	        with self.assertRaises(TypeError) as exc:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
333	        # Frame with valid hostname in src is allowed.
334	        html = '<div><iframe src="https://example.com/page"></div>'
335	        expected = '<div><iframe src="https://example.com/page"></iframe></div>'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
334	        html = '<div><iframe src="https://example.com/page"></div>'
335	        expected = '<div><iframe src="https://example.com/page"></iframe></div>'
336	        cleaner = Cleaner(frames=False, host_whitelist=["example.com"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
339	    def test_host_whitelist_invalid(self):
340	        html = '<div><iframe src="https://evil.com/page"></div>'
341	        expected = '<div></div>'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
346	        # Regression test: Don't be fooled by hostname and colon in userinfo.
347	        html = '<div><iframe src="https://example.com:@evil.com/page"></div>'
348	        expected = '<div></div>'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
379	            warnings.simplefilter("always")
380	            result = cleaner.clean_html(r"<p><iframe src='http://example.com:\@google.com'>  </iframe></p>")
381	            self.assertGreaterEqual(len(w), 1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lxml_html_clean-0.4.2/lxml_html_clean-0.4.2/tests/test_clean.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
391	            warnings.simplefilter("always")
392	            result = cleaner.clean_html(r"<p><iframe src='http://example.com:\@google.com'>  </iframe></p>")
393	            self.assertEqual(len(w), 0)

--------------------------------------------------

Code scanned:
	Total lines of code: 991
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 5.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 5.0
Files skipped (0):
