Run started:2025-04-12 15:09:17.255467

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/_modidx.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	                'doc_baseurl': '/',
5	                'doc_host': 'https://ghapi.fast.ai',
6	                'git_url': 'https://github.com/fastai/ghapi',
7	                'lib_path': 'ghapi'},
8	  'syms': { 'ghapi.actions': { 'ghapi.actions._create_file': ('actions.html#_create_file', 'ghapi/actions.py'),
9	                               'ghapi.actions._replace': ('actions.html#_replace', 'ghapi/actions.py'),
10	                               'ghapi.actions.actions_debug': ('actions.html#actions_debug', 'ghapi/actions.py'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/_modidx.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	                'doc_host': 'https://ghapi.fast.ai',
6	                'git_url': 'https://github.com/fastai/ghapi',
7	                'lib_path': 'ghapi'},
8	  'syms': { 'ghapi.actions': { 'ghapi.actions._create_file': ('actions.html#_create_file', 'ghapi/actions.py'),
9	                               'ghapi.actions._replace': ('actions.html#_replace', 'ghapi/actions.py'),
10	                               'ghapi.actions.actions_debug': ('actions.html#actions_debug', 'ghapi/actions.py'),
11	                               'ghapi.actions.actions_error': ('actions.html#actions_error', 'ghapi/actions.py'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/_nbdev.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	
87	doc_url = "https://ghapi.fast.ai/"
88	
89	git_url = "https://github.com/fastai/ghapi/tree/master/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/_nbdev.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	
89	git_url = "https://github.com/fastai/ghapi/tree/master/"
90	
91	def custom_doc_links(name): return None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/actions.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	# %% ../01_actions.ipynb 33
108	_example_url = 'https://raw.githubusercontent.com/fastai/ghapi/master/examples/{}.json'
109	
110	# %% ../01_actions.ipynb 34
111	def example_payload(event):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/auth.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    def __init__(self, client_id=_def_clientid, *scopes):
39	        url = 'https://github.com/login/device/code'
40	        self.client_id = client_id

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/auth.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	    resp = parse_qs(urlread(
63	        'https://github.com/login/oauth/access_token',
64	        client_id=self.client_id, device_code=self.device_code,
65	        grant_type='urn:ietf:params:oauth:grant-type:device_code'))
66	    err = nested_idx(resp, 'error', 0)
67	    if err == 'authorization_pending': return None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/build_lib.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	# %% ../90_build_lib.ipynb 4
15	GH_OPENAPI_URL = 'https://github.com/github/rest-api-description/raw/main/descriptions/api.github.com/api.github.com.json?raw=true'
16	_DOC_URL = 'https://docs.github.com/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/build_lib.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	GH_OPENAPI_URL = 'https://github.com/github/rest-api-description/raw/main/descriptions/api.github.com/api.github.com.json?raw=true'
16	_DOC_URL = 'https://docs.github.com/'
17	
18	# %% ../90_build_lib.ipynb 6
19	_lu_type = dict(zip(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/core.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	# %% ../00_core.ipynb 4
23	GH_HOST = os.getenv('GH_HOST', "https://api.github.com")
24	_DOC_URL = 'https://docs.github.com/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/core.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	GH_HOST = os.getenv('GH_HOST', "https://api.github.com")
24	_DOC_URL = 'https://docs.github.com/'
25	
26	# %% ../00_core.ipynb 6
27	def _preview_hdr(preview): return {'Accept': f'application/vnd.github.{preview}-preview+json'} if preview else {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/core.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	# %% ../00_core.ipynb 9
97	_docroot = 'https://docs.github.com/rest/reference/'
98	
99	# %% ../00_core.ipynb 10
100	def print_summary(req:Request):

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/core.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
250	    res = self.repos.get_content(path)
251	    return base64.b64decode(res.content)
252	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/core.py:251
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
250	    res = self.repos.get_content(path)
251	    return base64.b64decode(res.content)
252	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/core.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
257	    if not isinstance(content,bytes): content = content.encode()
258	    content = base64.b64encode(content).decode()
259	    kwargs = {'sha':sha} if sha else {}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/core.py:258
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
257	    if not isinstance(content,bytes): content = content.encode()
258	    content = base64.b64encode(content).decode()
259	    kwargs = {'sha':sha} if sha else {}

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/event.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
69	
70	for o in Event: exec(f'class {snake2camel(o)}Event(GhEvent):pass')
71	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/event.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	    name = 'sample_evts.json.gz'
105	    url = f'https://raw.githubusercontent.com/fastai/ghapi/master/examples/{name}'
106	    try: path = Path(__file__).parent

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/ghapi/templates.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	
45	context_example = """{
46	  "token": "***",
47	  "job": "build",
48	  "ref": "refs/heads/master",
49	  "sha": "4bd52759a74c8173301c39a45b9f7dbc3aa5a30c",
50	  "repository": "fastai/hugo-mathjax",
51	  "repository_owner": "fastai",
52	  "repositoryUrl": "git://github.com/fastai/hugo-mathjax.git",
53	  "run_id": "390437408",
54	  "run_number": "3",
55	  "retention_days": "90",
56	  "actor": "jph00",
57	  "workflow": "Python",
58	  "head_ref": "",
59	  "base_ref": "",
60	  "event_name": "workflow_dispatch",
61	  "event": {
62	    "inputs": null,
63	    "organization": {
64	      "avatar_url": "https://avatars3.githubusercontent.com/u/20547620?v=4",
65	      "description": null,
66	      "events_url": "https://api.github.com/orgs/fastai/events",
67	      "hooks_url": "https://api.github.com/orgs/fastai/hooks",
68	      "id": 20547620,
69	      "issues_url": "https://api.github.com/orgs/fastai/issues",
70	      "login": "fastai",
71	      "members_url": "https://api.github.com/orgs/fastai/members{/member}",
72	      "node_id": "MDEyOk9yZ2FuaXphdGlvbjIwNTQ3NjIw",
73	      "public_members_url": "https://api.github.com/orgs/fastai/public_members{/member}",
74	      "repos_url": "https://api.github.com/orgs/fastai/repos",
75	      "url": "https://api.github.com/orgs/fastai"
76	    },
77	    "ref": "refs/heads/master",
78	    "repository": {
79	      "archive_url": "https://api.github.com/repos/fastai/hugo-mathjax/{archive_format}{/ref}",
80	      "archived": false,
81	      "assignees_url": "https://api.github.com/repos/fastai/hugo-mathjax/assignees{/user}",
82	      "blobs_url": "https://api.github.com/repos/fastai/hugo-mathjax/git/blobs{/sha}",
83	      "branches_url": "https://api.github.com/repos/fastai/hugo-mathjax/branches{/branch}",
84	      "clone_url": "https://github.com/fastai/hugo-mathjax.git",
85	      "collaborators_url": "https://api.github.com/repos/fastai/hugo-mathjax/collaborators{/collaborator}",
86	      "comments_url": "https://api.github.com/repos/fastai/hugo-mathjax/comments{/number}",
87	      "commits_url": "https://api.github.com/repos/fastai/hugo-mathjax/commits{/sha}",
88	      "compare_url": "https://api.github.com/repos/fastai/hugo-mathjax/compare/{base}...{head}",
89	      "contents_url": "https://api.github.com/repos/fastai/hugo-mathjax/contents/{+path}",
90	      "contributors_url": "https://api.github.com/repos/fastai/hugo-mathjax/contributors",
91	      "created_at": "2020-11-11T18:59:57Z",
92	      "default_branch": "master",
93	      "deployments_url": "https://api.github.com/repos/fastai/hugo-mathjax/deployments",
94	      "description": "Hugo with goldmark-mathjax",
95	      "disabled": false,
96	      "downloads_url": "https://api.github.com/repos/fastai/hugo-mathjax/downloads",
97	      "events_url": "https://api.github.com/repos/fastai/hugo-mathjax/events",
98	      "fork": false,
99	      "forks": 0,
100	      "forks_count": 0,
101	      "forks_url": "https://api.github.com/repos/fastai/hugo-mathjax/forks",
102	      "full_name": "fastai/hugo-mathjax",
103	      "git_commits_url": "https://api.github.com/repos/fastai/hugo-mathjax/git/commits{/sha}",
104	      "git_refs_url": "https://api.github.com/repos/fastai/hugo-mathjax/git/refs{/sha}",
105	      "git_tags_url": "https://api.github.com/repos/fastai/hugo-mathjax/git/tags{/sha}",
106	      "git_url": "git://github.com/fastai/hugo-mathjax.git",
107	      "has_downloads": true,
108	      "has_issues": true,
109	      "has_pages": false,
110	      "has_projects": true,
111	      "has_wiki": true,
112	      "homepage": null,
113	      "hooks_url": "https://api.github.com/repos/fastai/hugo-mathjax/hooks",
114	      "html_url": "https://github.com/fastai/hugo-mathjax",
115	      "id": 312063075,
116	      "issue_comment_url": "https://api.github.com/repos/fastai/hugo-mathjax/issues/comments{/number}",
117	      "issue_events_url": "https://api.github.com/repos/fastai/hugo-mathjax/issues/events{/number}",
118	      "issues_url": "https://api.github.com/repos/fastai/hugo-mathjax/issues{/number}",
119	      "keys_url": "https://api.github.com/repos/fastai/hugo-mathjax/keys{/key_id}",
120	      "labels_url": "https://api.github.com/repos/fastai/hugo-mathjax/labels{/name}",
121	      "language": "Shell",
122	      "languages_url": "https://api.github.com/repos/fastai/hugo-mathjax/languages",
123	      "license": {
124	        "key": "apache-2.0",
125	        "name": "Apache License 2.0",
126	        "node_id": "MDc6TGljZW5zZTI=",
127	        "spdx_id": "Apache-2.0",
128	        "url": "https://api.github.com/licenses/apache-2.0"
129	      },
130	      "merges_url": "https://api.github.com/repos/fastai/hugo-mathjax/merges",
131	      "milestones_url": "https://api.github.com/repos/fastai/hugo-mathjax/milestones{/number}",
132	      "mirror_url": null,
133	      "name": "hugo-mathjax",
134	      "node_id": "MDEwOlJlcG9zaXRvcnkzMTIwNjMwNzU=",
135	      "notifications_url": "https://api.github.com/repos/fastai/hugo-mathjax/notifications{?since,all,participating}",
136	      "open_issues": 0,
137	      "open_issues_count": 0,
138	      "owner": {
139	        "avatar_url": "https://avatars3.githubusercontent.com/u/20547620?v=4",
140	        "events_url": "https://api.github.com/users/fastai/events{/privacy}",
141	        "followers_url": "https://api.github.com/users/fastai/followers",
142	        "following_url": "https://api.github.com/users/fastai/following{/other_user}",
143	        "gists_url": "https://api.github.com/users/fastai/gists{/gist_id}",
144	        "gravatar_id": "",
145	        "html_url": "https://github.com/fastai",
146	        "id": 20547620,
147	        "login": "fastai",
148	        "node_id": "MDEyOk9yZ2FuaXphdGlvbjIwNTQ3NjIw",
149	        "organizations_url": "https://api.github.com/users/fastai/orgs",
150	        "received_events_url": "https://api.github.com/users/fastai/received_events",
151	        "repos_url": "https://api.github.com/users/fastai/repos",
152	        "site_admin": false,
153	        "starred_url": "https://api.github.com/users/fastai/starred{/owner}{/repo}",
154	        "subscriptions_url": "https://api.github.com/users/fastai/subscriptions",
155	        "type": "Organization",
156	        "url": "https://api.github.com/users/fastai"
157	      },
158	      "private": false,
159	      "pulls_url": "https://api.github.com/repos/fastai/hugo-mathjax/pulls{/number}",
160	      "pushed_at": "2020-11-29T21:59:38Z",
161	      "releases_url": "https://api.github.com/repos/fastai/hugo-mathjax/releases{/id}",
162	      "size": 69,
163	      "ssh_url": "git@github.com:fastai/hugo-mathjax.git",
164	      "stargazers_count": 1,
165	      "stargazers_url": "https://api.github.com/repos/fastai/hugo-mathjax/stargazers",
166	      "statuses_url": "https://api.github.com/repos/fastai/hugo-mathjax/statuses/{sha}",
167	      "subscribers_url": "https://api.github.com/repos/fastai/hugo-mathjax/subscribers",
168	      "subscription_url": "https://api.github.com/repos/fastai/hugo-mathjax/subscription",
169	      "svn_url": "https://github.com/fastai/hugo-mathjax",
170	      "tags_url": "https://api.github.com/repos/fastai/hugo-mathjax/tags",
171	      "teams_url": "https://api.github.com/repos/fastai/hugo-mathjax/teams",
172	      "trees_url": "https://api.github.com/repos/fastai/hugo-mathjax/git/trees{/sha}",
173	      "updated_at": "2020-11-29T21:59:40Z",
174	      "url": "https://api.github.com/repos/fastai/hugo-mathjax",
175	      "watchers": 1,
176	      "watchers_count": 1
177	    },
178	    "sender": {
179	      "avatar_url": "https://avatars1.githubusercontent.com/u/346999?v=4",
180	      "events_url": "https://api.github.com/users/jph00/events{/privacy}",
181	      "followers_url": "https://api.github.com/users/jph00/followers",
182	      "following_url": "https://api.github.com/users/jph00/following{/other_user}",
183	      "gists_url": "https://api.github.com/users/jph00/gists{/gist_id}",
184	      "gravatar_id": "",
185	      "html_url": "https://github.com/jph00",
186	      "id": 346999,
187	      "login": "jph00",
188	      "node_id": "MDQ6VXNlcjM0Njk5OQ==",
189	      "organizations_url": "https://api.github.com/users/jph00/orgs",
190	      "received_events_url": "https://api.github.com/users/jph00/received_events",
191	      "repos_url": "https://api.github.com/users/jph00/repos",
192	      "site_admin": false,
193	      "starred_url": "https://api.github.com/users/jph00/starred{/owner}{/repo}",
194	      "subscriptions_url": "https://api.github.com/users/jph00/subscriptions",
195	      "type": "User",
196	      "url": "https://api.github.com/users/jph00"
197	    },
198	    "workflow": ".github/workflows/python.yml"
199	  },
200	  "server_url": "https://github.com",
201	  "api_url": "https://api.github.com",
202	  "graphql_url": "https://api.github.com/graphql",
203	  "workspace": "/home/runner/work/hugo-mathjax/hugo-mathjax",
204	  "action": "run",
205	  "event_path": "/home/runner/work/_temp/_github_workflow/event.json",
206	  "action_repository": "actions/setup-python",
207	  "action_ref": "v2",
208	  "path": "/home/runner/work/_temp/_runner_file_commands/add_path_d8387f6c-8c1b-44df-8a07-0c815679dd81",
209	  "env": "/home/runner/work/_temp/_runner_file_commands/set_env_d8387f6c-8c1b-44df-8a07-0c815679dd81"
210	}"""
211	
212	needs_example = """{

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/setup.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	for ext in ['png', 'svg']:
37	    long_description = re.sub(r'!\['+ext+'\]\((.*)\)', '!['+ext+']('+'https://raw.githubusercontent.com/{}/{}'.format(cfg['user'],cfg['lib_name'])+'/'+cfg['branch']+'/\\1)', long_description)
38	    long_description = re.sub(r'src=\"(.*)\.'+ext+'\"', 'src=\"https://raw.githubusercontent.com/{}/{}'.format(cfg['user'],cfg['lib_name'])+'/'+cfg['branch']+'/\\1.'+ext+'\"', long_description)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghapi-1.0.6/ghapi-1.0.6/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    long_description = re.sub(r'!\['+ext+'\]\((.*)\)', '!['+ext+']('+'https://raw.githubusercontent.com/{}/{}'.format(cfg['user'],cfg['lib_name'])+'/'+cfg['branch']+'/\\1)', long_description)
38	    long_description = re.sub(r'src=\"(.*)\.'+ext+'\"', 'src=\"https://raw.githubusercontent.com/{}/{}'.format(cfg['user'],cfg['lib_name'])+'/'+cfg['branch']+'/\\1.'+ext+'\"', long_description)
39	

--------------------------------------------------

Code scanned:
	Total lines of code: 2505
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 2.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 3.0
Files skipped (0):
