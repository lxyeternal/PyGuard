Run started:2025-04-12 11:34:25.503584

Test results:
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/compression.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
72	            data = [
73	                self._decompressobj.decompress(bytes(frame.payload))
74	                for frame in frames

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/compression.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
77	            data = [
78	                self._decompressobj.decompress(frame.payload)
79	                for frame in frames

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/compression.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
81	
82	        data.append(self._decompressobj.decompress(b"\x00\x00\xff\xff"))
83	        payload = b''.join(data)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/constants.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
20	    platform.python_version(),
21	    platform.system(),
22	    platform.release(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/constants.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
20	    platform.python_version(),
21	    platform.system(),
22	    platform.release(),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/proxy.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
34	        ).encode('utf-8')
35	        b64_credentials = base64.standard_b64encode(credentials)
36	        headers.append(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
75	        """Force the socket to disconnect."""
76	        raise _ForceDisconnect()
77	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
90	            try:
91	                self._sock.sendall(data)
92	            except socket.error as error:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:133
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
132	            try:
133	                sock = socket.socket(af, socktype, proto)
134	            except socket.error as error:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
138	            sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
139	            sock.settimeout(30)  # TODO: make a parameter for this?
140	            if ssl:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
143	            try:
144	                sock.connect(sa)
145	            except socket.error as error:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
146	                log.debug('socket error connecting to %r; %s', sa, error)
147	                sock.close()
148	                sock = None

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
174	        )
175	        sock.sendall(proxy_request)
176	        proxy_parser = proxy.ProxyParser()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
178	        while response is None:
179	            data = sock.recv(1024)
180	            for response in proxy_parser.feed(data):

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
204	        # We want to the socket to block after the connection
205	        sock.settimeout(None)
206	        return sock, proxy_url

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
236	                self._sock.shutdown(socket.SHUT_RDWR)
237	                self._sock.close()
238	        except socket.error:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
287	            if session_time >= sent_close_time + close_timeout:
288	                raise _ForceDisconnect(
289	                    "server didn't respond to close packet "
290	                    "within {}s".format(close_timeout)
291	                )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
311	            yield events.Unresponsive()
312	            raise _ForceDisconnect(
313	                'exceeded {:.0f}s ping timeout'.format(ping_timeout)
314	            )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
359	        try:
360	            sock, proxy = self._connect()
361	            self._sock = sock

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
398	                if readable:
399	                    data = self._recv(max_bytes)
400	                    if data:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/session.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
428	        finally:
429	            selector.close()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
53	            self.session = None
54	            self.key = b64encode(os.urandom(16))
55	            self.sent_request = False

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:54
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
53	            self.session = None
54	            self.key = b64encode(os.urandom(16))
55	            self.sent_request = False

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
162	        if self.session is not None:
163	            self.session.close()
164	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
247	            if not self.is_closing:
248	                self._send_close(code, reason)
249	                self.state.closing = True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
266	            yield events.Closing(message.code, message.reason)
267	            self.close(message.code, message.reason)
268	            self.state.closing = True

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
272	        if self.state.session is not None:
273	            self.state.session.force_disconnect()
274	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
277	        if self.state.session is not None:
278	            self.state.session.close()
279	        self.state.closing = False

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
299	                    except errors.HandshakeError as error:
300	                        self.on_disconnect()
301	                        yield events.Rejected(response, six.text_type(error))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
306	                    if message.is_close:
307	                        for event in self._on_close(message):
308	                            yield event

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
324	            yield events.ProtocolError(six.text_type(error), True)
325	            self.force_disconnect()
326	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
331	            yield events.ProtocolError(six.text_type(error), False)
332	            self.close(Status.PROTOCOL_ERROR, six.text_type(error))
333	            self.force_disconnect()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
332	            self.close(Status.PROTOCOL_ERROR, six.text_type(error))
333	            self.force_disconnect()
334	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
338	            log.warning('disconnecting websocket')
339	            self.on_disconnect()
340	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
401	
402	        challenge = b64encode(
403	            sha1(self.key + constants.WS_KEY).digest()
404	        ).decode('ascii')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:402
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
401	
402	        challenge = b64encode(
403	            sha1(self.key + constants.WS_KEY).digest()
404	        ).decode('ascii')

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
442	            raise ValueError('ping data should be <= 125 bytes')
443	        self.session.send(Opcode.PING, data)
444	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
461	            raise ValueError('pong data should be <= 125 bytes')
462	        self.session.send(Opcode.PONG, data)
463	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
478	        else:
479	            self.session.send(Opcode.BINARY, data)
480	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
522	        else:
523	            self.session.send(Opcode.TEXT, payload)
524	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/lomond/websocket.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
528	        try:
529	            self.session.send(Opcode.CLOSE, frame_bytes)
530	        except (errors.WebSocketUnavailable, errors.TransportFail):

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
19	with open('lomond/_version.py') as f:
20	    exec(f.read())
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lomond-0.3.3/lomond-0.3.3/setup.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	    author_email='willmcgugan@gmail.com',
33	    url='https://github.com/wildfoundry/dataplicity-lomond',
34	    platforms=['any'],

--------------------------------------------------

Code scanned:
	Total lines of code: 2556
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 37.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 38.0
		High: 5.0
Files skipped (0):
