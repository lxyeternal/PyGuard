Run started:2025-04-12 16:34:57.702720

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/_command_type.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
27	    if isinstance(item, (bytes, bytearray)):
28	        return base64.b64encode(item).decode('utf-8')
29	    return item

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/_command_type.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
27	    if isinstance(item, (bytes, bytearray)):
28	        return base64.b64encode(item).decode('utf-8')
29	    return item

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/_help.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	
59	helps['keyvault certificate get-default-policy'] = """
60	type: command
61	short-summary: Get the default policy for self-signed certificates.
62	long-summary: |
63	    This default policy can be used in conjunction with `az keyvault create` to create a self-signed certificate.
64	    The default policy can also be used as a starting point to create derivative policies.
65	
66	    For more details, see: https://docs.microsoft.com/en-us/rest/api/keyvault/certificates-and-policies
67	examples:
68	  - name: Create a self-signed certificate with the default policy
69	    text: |
70	        az keyvault certificate create --vault-name vaultname -n cert1 \\
71	          -p "$(az keyvault certificate get-default-policy)"
72	"""
73	
74	helps['keyvault certificate import'] = """

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/_validators.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
83	                encoded_str = encoded.decode('utf-8')
84	                decoded = base64.b64decode(encoded_str)
85	        elif encoding == 'hex':

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/_validators.py:84
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
83	                encoded_str = encoded.decode('utf-8')
84	                decoded = base64.b64decode(encoded_str)
85	        elif encoding == 'hex':

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/_validators.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
183	            for entry in re.findall(regex, cert_data):
184	                cert_list.append(base64.b64decode(entry.replace('\n', '')))
185	        return cert_list

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/_validators.py:184
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
183	            for entry in re.findall(regex, cert_data):
184	                cert_list.append(base64.b64decode(entry.replace('\n', '')))
185	        return cert_list

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/_validators.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
196	    with open(os.path.expanduser(string), 'rb') as f:
197	        cert_data = f.read()
198	    return cert_data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/_validators.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
218	    def vault_base_url_type(name):
219	        return 'https://{}{}'.format(name, suffix)
220	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
592	    with open(file_path, 'wb') as output:
593	        output.write(backup)
594	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
597	    with open(file_path, 'rb') as file_in:
598	        data = file_in.read()
599	    return client.restore_key(vault_base_url, data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
651	        with open(pem_file, 'rb') as f:
652	            pem_data = f.read()
653	            pem_password = str(pem_password).encode() if pem_password else None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
670	        with open(byok_file, 'rb') as f:
671	            byok_data = f.read()
672	        key_obj.kty = 'RSA-HSM'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
695	            with open(file_path, 'w') as f:
696	                f.write(secret_value)
697	        else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
699	                import base64
700	                decoded = base64.b64decode(secret_value)
701	            elif encoding == 'hex':

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:700
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
699	                import base64
700	                decoded = base64.b64decode(secret_value)
701	            elif encoding == 'hex':

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:706
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
705	            with open(file_path, 'wb') as f:
706	                f.write(decoded)
707	    except Exception as ex:  # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
716	    with open(file_path, 'wb') as output:
717	        output.write(backup)
718	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
721	    with open(file_path, 'rb') as file_in:
722	        data = file_in.read()
723	    return client.restore_secret(vault_base_url, data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
857	            if encoding == 'DER':
858	                f.write(cert)
859	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
864	                encoded = '-----BEGIN CERTIFICATE-----\n' + encoded + '-----END CERTIFICATE-----\n'
865	                f.write(encoded.encode("utf-8"))
866	    except Exception as ex:  # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
997	    with open(file_path, 'wb') as output:
998	        output.write(backup)
999	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_keyvault-2.2.16-py2.py3-none-any/azure/cli/command_modules/keyvault/custom.py:1003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1002	    with open(file_path, 'rb') as file_in:
1003	        data = file_in.read()
1004	        return client.restore_storage_account(vault_base_url, data)

--------------------------------------------------

Code scanned:
	Total lines of code: 1803
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 4.0
Files skipped (0):
