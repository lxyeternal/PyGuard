Run started:2025-04-12 15:45:20.164832

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/installer.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	        try:
31	            resp = requests.get(url, allow_redirects=True)
32	        except requests.exceptions.RequestException as e:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/installer.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
61	    tarball.seek(0)
62	    with tarfile.open(mode="r:bz2", fileobj=tarball) as tf:
63	        fo = tf.extractfile(filename)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/installer.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        with new_executable(target_path) as exe_fo:
69	            exe_fo.write(fo.read())
70	        return target_path

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/installer.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
68	        with new_executable(target_path) as exe_fo:
69	            exe_fo.write(fo.read())
70	        return target_path

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/installer.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	
132	        url = "https://api.anaconda.org/package/anaconda/conda-standalone/files"
133	        resp = request_url_with_retry(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/installer.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	        subdir = platform_subdir()
184	        url = f"https://micromamba.snakepit.net/api/micromamba/{subdir}/latest"
185	        resp = request_url_with_retry(url)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/installer.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
211	        temp_filename = target_filename.with_name(uuid.uuid4().hex)
212	        with open(temp_filename, "wb") as fo:
213	            yield fo

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/installer.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
214	        st = os.stat(temp_filename)
215	        os.chmod(temp_filename, st.st_mode | stat.S_IXUSR)
216	        # On Windows, we need to handle the case where the target file already exists

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/installer.py:215
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
214	        st = os.stat(temp_filename)
215	        os.chmod(temp_filename, st.st_mode | stat.S_IXUSR)
216	        # On Windows, we need to handle the case where the target file already exists

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/resolve.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
125	
126	is_windows = platform.system() == "Windows"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/resolve.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
125	
126	is_windows = platform.system() == "Windows"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ensureconda-1.4.7/ensureconda-1.4.7/src/python/ensureconda/resolve.py:126
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
125	
126	is_windows = platform.system() == "Windows"

--------------------------------------------------

Code scanned:
	Total lines of code: 491
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 8.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 2.0
Files skipped (0):
