Run started:2025-04-12 10:20:14.129937

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/__init__.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        app_name: str = sys.argv[0],
50	        api_endpoint: str = "https://api.traceloop.com",
51	        api_key: Optional[str] = None,
52	        enabled: bool = True,
53	        headers: Dict[str, str] = {},
54	        disable_batch=False,
55	        telemetry_enabled: bool = True,
56	        exporter: Optional[SpanExporter] = None,
57	        metrics_exporter: MetricExporter = None,
58	        metrics_headers: Dict[str, str] = None,
59	        logging_exporter: LogExporter = None,
60	        logging_headers: Dict[str, str] = None,
61	        processor: Optional[SpanProcessor] = None,
62	        propagator: TextMapPropagator = None,
63	        traceloop_sync_enabled: bool = False,
64	        should_enrich_metrics: bool = True,
65	        resource_attributes: dict = {},
66	        instruments: Optional[Set[Instruments]] = None,
67	        block_instruments: Optional[Set[Instruments]] = None,
68	        image_uploader: Optional[ImageUploader] = None,
69	    ) -> Optional[Client]:
70	        if not enabled:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/__init__.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	            and not processor
107	            and api_endpoint == "https://api.traceloop.com"
108	            and not api_key

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/__init__.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	                + "Error: Missing Traceloop API key,"
113	                + " go to https://app.traceloop.com/settings/api-keys to create one"
114	            )
115	            print("Set the TRACELOOP_API_KEY environment variable to the key")
116	            print(Fore.RESET)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/client/client.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	    def __init__(self, api_key: str, app_name: str = sys.argv[0], api_endpoint: str = "https://api.traceloop.com"):
25	        """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/client/client.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	        self.app_name = app_name
37	        self.api_endpoint = api_endpoint or "https://api.traceloop.com"
38	        self.api_key = api_key

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/client/http.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
27	        try:
28	            response = requests.post(f"{self.base_url}/v2/{path.lstrip('/')}", json=data, headers=self._headers())
29	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/client/http.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        try:
40	            response = requests.get(f"{self.base_url}/v2/{path.lstrip('/')}", params=params, headers=self._headers())
41	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/fetcher.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
38	        self._stop_polling_event = Event()
39	        self._exit_monitor = Thread(
40	            target=monitor_exit, args=(self._stop_polling_event,), daemon=True
41	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/fetcher.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
41	        )
42	        self._poller_thread = Thread(
43	            target=thread_func,
44	            args=(
45	                self._prompt_registry,
46	                self._content_allow_list,
47	                self._base_url,
48	                self._api_key,
49	                self._stop_polling_event,
50	                POLLING_INTERVAL,
51	            ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/fetcher.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	def fetch_url(url: str, api_key: str):
98	    response = requests.get(
99	        url,
100	        headers={
101	            "Authorization": f"Bearer {api_key}",
102	            "X-Traceloop-SDK-Version": __version__,
103	        },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/fetcher.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
117	def post_url(url: str, api_key: str, body: Dict[str, typing.Any]):
118	    response = requests.post(
119	        url,
120	        headers={
121	            "Authorization": f"Bearer {api_key}",
122	            "X-Traceloop-SDK-Version": __version__,
123	        },
124	        json=body,
125	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/fetcher.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
162	def monitor_exit(exit_event: Event):
163	    main_thread = threading.main_thread()
164	    main_thread.join()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/images/image_uploader.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
19	
20	        await self._async_upload(url, image_file)
21	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/images/image_uploader.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
24	    def _get_image_url(self, trace_id, span_id, image_name):
25	        response = requests.post(
26	            f"{self.base_url}/v2/traces/{trace_id}/spans/{span_id}/images",
27	            json={
28	                "image_name": image_name,
29	            },
30	            headers={
31	                "Authorization": f"Bearer {self.api_key}",
32	                "Content-Type": "application/json",
33	            },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/images/image_uploader.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
47	        async with aiohttp.ClientSession() as session:
48	            async with session.post(url, json=payload, headers=headers) as response:
49	                if response.status < 200 or response.status >= 300:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/telemetry.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	                        project_api_key=POSTHOG_API_KEY,
29	                        host="https://app.posthog.com",
30	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/telemetry.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	                    new_anon_id = str(uuid.uuid4())
50	                    f.write(new_anon_id)
51	                self._curr_anon_id = new_anon_id

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/traceloop_sdk-0.39.0/traceloop_sdk-0.39.0/traceloop/sdk/telemetry.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
53	                with open(self.ANON_ID_PATH, "r") as f:
54	                    self._curr_anon_id = f.read()
55	        except Exception:

--------------------------------------------------

Code scanned:
	Total lines of code: 2435
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 12.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 0.0
Files skipped (0):
