Run started:2025-04-12 12:10:07.553215

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/src/airflow/providers/sftp/get_provider_info.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        "name": "SFTP",
28	        "description": "`SSH File Transfer Protocol (SFTP) <https://tools.ietf.org/wg/secsh/draft-ietf-secsh-filexfer/>`__\n",
29	        "integrations": [
30	            {
31	                "integration-name": "SSH File Transfer Protocol (SFTP)",
32	                "external-doc-url": "https://tools.ietf.org/wg/secsh/draft-ietf-secsh-filexfer/",
33	                "logo": "/docs/integration-logos/SFTP.png",
34	                "tags": ["protocol"],
35	            }
36	        ],
37	        "operators": [
38	            {
39	                "integration-name": "SSH File Transfer Protocol (SFTP)",
40	                "python-modules": ["airflow.providers.sftp.operators.sftp"],
41	            }
42	        ],
43	        "sensors": [
44	            {
45	                "integration-name": "SSH File Transfer Protocol (SFTP)",
46	                "python-modules": [
47	                    "airflow.providers.sftp.sensors.sftp",
48	                    "airflow.providers.sftp.decorators.sensors.sftp",
49	                ],
50	            }
51	        ],
52	        "hooks": [
53	            {
54	                "integration-name": "SSH File Transfer Protocol (SFTP)",
55	                "python-modules": ["airflow.providers.sftp.hooks.sftp"],
56	            }
57	        ],
58	        "connection-types": [
59	            {"hook-class-name": "airflow.providers.sftp.hooks.sftp.SFTPHook", "connection-type": "sftp"}
60	        ],
61	        "task-decorators": [
62	            {
63	                "class-name": "airflow.providers.sftp.decorators.sensors.sftp.sftp_sensor_task",
64	                "name": "sftp_sensor",
65	            }
66	        ],
67	        "triggers": [
68	            {
69	                "integration-name": "SSH File Transfer Protocol (SFTP)",
70	                "python-modules": ["airflow.providers.sftp.triggers.sftp"],
71	            }
72	        ],
73	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/src/airflow/providers/sftp/get_provider_info.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	                "integration-name": "SSH File Transfer Protocol (SFTP)",
32	                "external-doc-url": "https://tools.ietf.org/wg/secsh/draft-ietf-secsh-filexfer/",
33	                "logo": "/docs/integration-logos/SFTP.png",
34	                "tags": ["protocol"],
35	            }
36	        ],
37	        "operators": [

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/src/airflow/providers/sftp/hooks/sftp.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
274	            for dir_path in dirs:
275	                conn.rmdir(dir_path)
276	            conn.rmdir(path)

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/src/airflow/providers/sftp/hooks/sftp.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
275	                conn.rmdir(dir_path)
276	            conn.rmdir(path)
277	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/src/airflow/providers/sftp/hooks/sftp.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
383	            self.log.info("Retrieving files concurrently with %s threads", workers)
384	            with concurrent.futures.ThreadPoolExecutor(max_workers=workers) as executor:
385	                futures = [

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/src/airflow/providers/sftp/hooks/sftp.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
479	            self.log.info("Storing files concurrently with %s threads", workers)
480	            with concurrent.futures.ThreadPoolExecutor(max_workers=workers) as executor:
481	                futures = [

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/src/airflow/providers/sftp/operators/sftp.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
228	        scheme = "file"
229	        local_host = socket.gethostname()
230	        try:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/src/airflow/providers/sftp/operators/sftp.py:229
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
228	        scheme = "file"
229	        local_host = socket.gethostname()
230	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/hooks/test_sftp.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
75	        with open(os.path.join(self.temp_dir, file_name), "a") as file:
76	            file.write("Test file")
77	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/hooks/test_sftp.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	            with open(os.path.join(temp_dir, file_name), "a") as file:
88	                file.write("Test file")
89	        with open(os.path.join(temp_dir, TMP_DIR_FOR_TESTS, SUB_DIR, TMP_FILE_FOR_TESTS), "a") as file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/hooks/test_sftp.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	        with open(os.path.join(temp_dir, TMP_DIR_FOR_TESTS, SUB_DIR, TMP_FILE_FOR_TESTS), "a") as file:
90	            file.write("Test file")
91	        try:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/hooks/test_sftp.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
99	
100	        shutil.rmtree(os.path.join(temp_dir, TMP_DIR_FOR_TESTS))
101	        for file_name in [TMP_FILE_FOR_TESTS, ANOTHER_FILE_FOR_TESTS, LOG_FILE_FOR_TESTS]:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/hooks/test_sftp.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
355	        file_obj.seek(0)
356	        key_content_str = file_obj.read()
357	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
50	LOCAL_DATASET = [
51	    Dataset(namespace=f"file://{socket.gethostbyname(socket.gethostname())}:22", name=LOCAL_FILEPATH)
52	]

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
50	LOCAL_DATASET = [
51	    Dataset(namespace=f"file://{socket.gethostbyname(socket.gethostname())}:22", name=LOCAL_FILEPATH)
52	]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
107	        with open(self.test_local_filepath, "wb") as file:
108	            file.write(test_local_file_content)
109	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	        with open(self.test_local_filepath, "wb") as file:
142	            file.write(test_local_file_content)
143	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	        with open(self.test_local_filepath, "wb") as file:
171	            file.write(test_local_file_content)
172	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
202	        with open(self.test_local_filepath, "wb") as file:
203	            file.write(test_local_file_content)
204	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
225	        pulled = tis["check_file_task"].xcom_pull(task_ids="check_file_task", key="return_value")
226	        assert pulled.strip() == b64encode(test_local_file_content).decode("utf-8")
227	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:226
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
225	        pulled = tis["check_file_task"].xcom_pull(task_ids="check_file_task", key="return_value")
226	        assert pulled.strip() == b64encode(test_local_file_content).decode("utf-8")
227	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
230	        with open(self.test_remote_filepath, "wb") as file:
231	            file.write(self.test_remote_file_content)
232	        yield

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
250	        with open(self.test_local_filepath, "rb") as file:
251	            content_received = file.read()
252	        assert content_received == self.test_remote_file_content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
269	        with open(self.test_local_filepath, "rb") as file:
270	            content_received = file.read()
271	        assert content_received == self.test_remote_file_content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_sftp-5.2.0rc1/apache_airflow_providers_sftp-5.2.0rc1/tests/unit/sftp/operators/test_sftp.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
312	        with open(self.test_local_filepath_int_dir, "rb") as file:
313	            content_received = file.read()
314	        assert content_received == self.test_remote_file_content

--------------------------------------------------

Code scanned:
	Total lines of code: 3126
	Total lines skipped (#nosec): 1

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 3.0
Files skipped (0):
