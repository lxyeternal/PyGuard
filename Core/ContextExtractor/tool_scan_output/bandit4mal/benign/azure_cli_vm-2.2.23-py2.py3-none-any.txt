Run started:2025-04-12 13:00:20.373212

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_actions.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
61	    if publisher_num > 1:
62	        with ThreadPoolExecutor(max_workers=_get_thread_count()) as executor:
63	            tasks = [executor.submit(_load_images_from_publisher, p.name) for p in publishers]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_actions.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	    # under hack mode(say through proxies with unsigned cert), opt out the cert verification
82	    response = requests.get(target_url, verify=(not should_disable_connection_verify()))
83	    if response.status_code != 200:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_actions.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
150	    if publisher_num > 1:
151	        with ThreadPoolExecutor(max_workers=_get_thread_count()) as executor:
152	            tasks = [executor.submit(_load_extension_images_from_publisher,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	helps['disk'] = """
11	type: group
12	short-summary: Manage Azure Managed Disks.
13	long-summary: >4
14	
15	    Azure Virtual Machines use disks as a place to store an operating system, applications, and data.
16	    All Azure virtual machines have at least two disks: An operating system disk, and a temporary disk.
17	    The operating system disk is created from an image, and both the operating system disk and the image are actually virtual hard disks (VHDs)
18	    stored in an Azure storage account. Virtual machines also can have one or more data disks, that are also stored as VHDs.
19	
20	
21	    Azure Managed and Unmanaged Data Disks have a maximum size of 4095 GB (with the exception of larger disks in preview). Azure Unmanaged Disks also have a maximum capacity of 4095 GB.
22	
23	
24	    For more information, see:
25	
26	    - Azure Disks - https://docs.microsoft.com/en-us/azure/virtual-machines/linux/about-disks-and-vhds and https://docs.microsoft.com/en-us/azure/virtual-machines/windows/about-disks-and-vhds.
27	
28	    - Larger Managed Disks in Public Preview - https://azure.microsoft.com/en-us/blog/introducing-the-public-preview-of-larger-managed-disks-sizes/
29	
30	    - Ultra SSD Managed Disks in Public Preview - https://docs.microsoft.com/en-us/azure/virtual-machines/windows/disks-ultra-ssd
31	
32	
33	"""
34	
35	helps['disk create'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	
35	helps['disk create'] = """
36	type: command
37	short-summary: Create a managed disk.
38	examples:
39	  - name: Create a managed disk by importing from a blob uri.
40	    text: >
41	        az disk create -g MyResourceGroup -n MyDisk --source https://vhd1234.blob.core.windows.net/vhds/osdisk1234.vhd
42	  - name: Create an empty managed disk.
43	    text: >
44	        az disk create -g MyResourceGroup -n MyDisk --size-gb 10
45	  - name: Create a managed disk by copying an existing disk or snapshot.
46	    text: >
47	        az disk create -g MyResourceGroup -n MyDisk2 --source MyDisk
48	  - name: Create a disk in an availability zone in the region of "East US 2"
49	    text: >
50	        az disk create -n MyDisk -g MyResourceGroup --size-gb 10 --location eastus2 --zone 1
51	"""
52	
53	helps['disk delete'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
240	
241	helps['snapshot create'] = """
242	type: command
243	short-summary: Create a snapshot.
244	examples:
245	  - name: Create a snapshot by importing from a blob uri.
246	    text: az snapshot create -g MyResourceGroup -n MySnapshot --source https://vhd1234.blob.core.windows.net/vhds/osdisk1234.vhd
247	  - name: Create an empty snapshot.
248	    text: az snapshot create -g MyResourceGroup -n MySnapshot --size-gb 10
249	  - name: Create a snapshot by copying an existing disk in the same resource group.
250	    text: az snapshot create -g MyResourceGroup -n MySnapshot2 --source MyDisk
251	  - name: Create a snapshot from an existing disk in another resource group.
252	    text: az snapshot create -g MyResourceGroup -n MySnapshot2 --source "/subscriptions/00000/resourceGroups/AnotherResourceGroup/providers/Microsoft.Compute/disks/MyDisk"
253	"""
254	
255	helps['snapshot grant-access'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
316	
317	helps['vm availability-set create'] = """
318	type: command
319	short-summary: Create an Azure Availability Set.
320	long-summary: 'For more information, see https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-manage-availability.'
321	examples:
322	  - name: Create an availability set.
323	    text: az vm availability-set create -n MyAvSet -g MyResourceGroup --platform-fault-domain-count 2 --platform-update-domain-count 2
324	"""
325	
326	helps['vm availability-set delete'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
389	
390	helps['vm boot-diagnostics enable'] = """
391	type: command
392	short-summary: Enable the boot diagnostics on a VM.
393	parameters:
394	  - name: --storage
395	    short-summary: Name or URI of a storage account (e.g. https://your_storage_account_name.blob.core.windows.net/)
396	examples:
397	  - name: Enable boot diagnostics on all VMs in a resource group.
398	    text: >
399	        az vm boot-diagnostics enable --storage https://mystor.blob.core.windows.net/ --ids $(az vm list -g MyResourceGroup --query "[].id" -o tsv)
400	
401	  - name: Enable the boot diagnostics on a VM. (autogenerated)
402	    text: az vm boot-diagnostics enable --name MyVirtualMachine --resource-group MyResourceGroup --storage https://mystor.blob.core.windows.net/
403	    crafted: true
404	"""
405	
406	helps['vm boot-diagnostics get-boot-log'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
418	
419	helps['vm capture'] = """
420	type: command
421	short-summary: Capture information for a stopped VM.
422	long-summary: 'For an end-to-end tutorial, see https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-capture-image'
423	parameters:
424	  - name: --vhd-name-prefix
425	    type: string
426	    short-summary: The VHD name prefix specify for the VM disks.
427	  - name: --storage-container
428	    short-summary: The storage account container name in which to save the disks.
429	  - name: --overwrite
430	    short-summary: Overwrite the existing disk file.
431	examples:
432	  - name: Deallocate, generalize, and capture a stopped virtual machine.
433	    text: |
434	        az vm deallocate -g MyResourceGroup -n MyVm
435	        az vm generalize -g MyResourceGroup -n MyVm
436	        az vm capture -g MyResourceGroup -n MyVm --vhd-name-prefix MyPrefix
437	  - name: Deallocate, generalize, and capture multiple stopped virtual machines.
438	    text: |
439	        vms_ids=$(az vm list -g MyResourceGroup --query "[].id" -o tsv)
440	        az vm deallocate --ids {vms_ids}
441	        az vm generalize --ids {vms_ids}
442	        az vm capture --ids {vms_ids} --vhd-name-prefix MyPrefix
443	
444	"""
445	
446	helps['vm convert'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
457	
458	helps['vm create'] = """
459	type: command
460	short-summary: Create an Azure Virtual Machine.
461	long-summary: 'For an end-to-end tutorial, see https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-quick-create-cli.'
462	parameters:
463	  - name: --image
464	    type: string
465	    short-summary: >
466	        The name of the operating system image as a URN alias, URN, custom image name or ID, or VHD blob URI.
467	        This parameter is required unless using `--attach-os-disk.` Valid URN format: "Publisher:Offer:Sku:Version".
468	    populator-commands:
469	      - az vm image list
470	      - az vm image show
471	  - name: --ssh-key-values
472	    short-summary: Space-separated list of SSH public keys or public key file paths.
473	  - name: --computer-name
474	    short-summary: The host OS name of the virtual machine. Defaults to the name of the VM.
475	examples:
476	  - name: Create a default Ubuntu VM with automatic SSH authentication.
477	    text: >
478	        az vm create -n MyVm -g MyResourceGroup --image UbuntuLTS
479	  - name: Create a default RedHat VM with automatic SSH authentication using an image URN.
480	    text: >
481	        az vm create -n MyVm -g MyResourceGroup --image RedHat:RHEL:7-RAW:7.4.2018010506
482	  - name: Create a default Windows Server VM with a private IP address.
483	    text: >
484	        az vm create -n MyVm -g MyResourceGroup --public-ip-address "" --image Win2012R2Datacenter
485	  - name: Create a VM from a custom managed image.
486	    text: >
487	        az vm create -g MyResourceGroup -n MyVm --image MyImage
488	  - name: Create a VM by attaching to a managed operating system disk.
489	    text: >
490	        az vm create -g MyResourceGroup -n MyVm --attach-os-disk MyOsDisk --os-type linux
491	  - name: 'Create an Ubuntu Linux VM using a cloud-init script for configuration. See: https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-using-cloud-init.'
492	    text: >
493	        az vm create -g MyResourceGroup -n MyVm --image debian --custom-data MyCloudInitScript.yml
494	  - name: Create a Debian VM with SSH key authentication and a public DNS entry, located on an existing virtual network and availability set.
495	    text: |
496	        az vm create -n MyVm -g MyResourceGroup --image debian --vnet-name MyVnet --subnet subnet1 \\
497	            --availability-set MyAvailabilitySet --public-ip-address-dns-name MyUniqueDnsName \\
498	            --ssh-key-value @key-file
499	  - name: Create a simple Ubuntu Linux VM with a public IP address, DNS entry, two data disks (10GB and 20GB), and then generate ssh key pairs.
500	    text: |
501	        az vm create -n MyVm -g MyResourceGroup --public-ip-address-dns-name MyUniqueDnsName \\
502	            --image ubuntults --data-disk-sizes-gb 10 20 --size Standard_DS2_v2 \\
503	            --generate-ssh-keys
504	  - name: Create a Debian VM using Key Vault secrets.
505	    text: >
506	        az keyvault certificate create --vault-name vaultname -n cert1 \\
507	          -p "$(az keyvault certificate get-default-policy)"
508	
509	        secrets=$(az keyvault secret list-versions --vault-name vaultname \\
510	          -n cert1 --query "[?attributes.enabled].id" -o tsv)
511	
512	        vm_secrets=$(az vm secret format -s "$secrets")
513	
514	
515	        az vm create -g group-name -n vm-name --admin-username deploy  \\
516	          --image debian --secrets "$vm_secrets"
517	  - name: Create a CentOS VM with a system assigned identity. The VM will have a 'Contributor' role with access to a storage account.
518	    text: >
519	        az vm create -n MyVm -g rg1 --image centos --assign-identity --scope /subscriptions/99999999-1bf0-4dda-aec3-cb9272f09590/MyResourceGroup/myRG/providers/Microsoft.Storage/storageAccounts/storage1
520	  - name: Create a debian VM with a user assigned identity.
521	    text: >
522	        az vm create -n MyVm -g rg1 --image debian --assign-identity  /subscriptions/99999999-1bf0-4dda-aec3-cb9272f09590/resourcegroups/myRG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myID
523	  - name: Create a debian VM with both system and user assigned identity.
524	    text: >
525	        az vm create -n MyVm -g rg1 --image debian --assign-identity  [system] /subscriptions/99999999-1bf0-4dda-aec3-cb9272f09590/resourcegroups/myRG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myID
526	  - name: Create a VM in an availability zone in the current resource group's region
527	    supported-profiles: latest
528	    text: >
529	        az vm create -n MyVm -g MyResourceGroup --image Centos --zone 1
530	"""
531	
532	helps['vm deallocate'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
531	
532	helps['vm deallocate'] = """
533	type: command
534	short-summary: Deallocate a VM.
535	long-summary: 'For an end-to-end tutorial, see https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-capture-image'
536	examples:
537	  - name: Deallocate, generalize, and capture a stopped virtual machine.
538	    text: |
539	        az vm deallocate -g MyResourceGroup -n MyVm
540	        az vm generalize -g MyResourceGroup -n MyVm
541	        az vm capture -g MyResourceGroup -n MyVm --vhd-name-prefix MyPrefix
542	  - name: Deallocate, generalize, and capture multiple stopped virtual machines.
543	    text: |
544	        vms_ids=$(az vm list -g MyResourceGroup --query "[].id" -o tsv)
545	        az vm deallocate --ids {vms_ids}
546	        az vm generalize --ids {vms_ids}
547	        az vm capture --ids {vms_ids} --vhd-name-prefix MyPrefix
548	
549	"""
550	
551	helps['vm delete'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
644	
645	helps['vm disk'] = """
646	type: group
647	short-summary: Manage the managed data disks attached to a VM.
648	long-summary: >4
649	
650	    Azure Virtual Machines use disks as a place to store an operating system, applications, and data.
651	    All Azure virtual machines have at least two disks: An operating system disk, and a temporary disk.
652	    The operating system disk is created from an image, and both the operating system disk and the image are actually virtual hard disks (VHDs)
653	    stored in an Azure storage account. Virtual machines also can have one or more data disks, that are also stored as VHDs.
654	
655	
656	    Azure Managed and Unmanaged Data Disks have a maximum size of 4095 GB (with the exception of larger disks in preview). Azure Unmanaged Disks also have a maximum capacity of 4095 GB.
657	
658	
659	    For more information, see:
660	
661	    - Azure Disks - https://docs.microsoft.com/en-us/azure/virtual-machines/linux/about-disks-and-vhds and https://docs.microsoft.com/en-us/azure/virtual-machines/windows/about-disks-and-vhds.
662	
663	    - Larger Managed Disks in Public Preview - https://azure.microsoft.com/en-us/blog/introducing-the-public-preview-of-larger-managed-disks-sizes/
664	
665	    - Ultra SSD Managed Disks in Public Preview - https://docs.microsoft.com/en-us/azure/virtual-machines/windows/disks-ultra-ssd
666	
667	
668	"""
669	
670	helps['vm disk attach'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
690	
691	helps['vm encryption'] = """
692	type: group
693	short-summary: "Manage encryption of VM disks."
694	long-summary: |
695	    For more information, see:
696	    https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption-overview"
697	"""
698	
699	helps['vm encryption disable'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
710	
711	helps['vm encryption enable'] = """
712	type: command
713	short-summary: "Enable disk encryption on the OS disk and/or data disks. Encrypt mounted disks."
714	long-summary: |
715	    Note that Azure Active Directory / service principal arguments are unnecessary for vm encryption. The older version of Azure Disk Encryption required AAD arguments.
716	    For more information, see:
717	    https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption-overview
718	parameters:
719	  - name: --aad-client-id
720	    short-summary: Client ID of an AAD app with permissions to write secrets to the key vault.
721	  - name: --aad-client-secret
722	    short-summary: Client secret of the AAD app with permissions to write secrets to the key vault.
723	  - name: --aad-client-cert-thumbprint
724	    short-summary: Thumbprint of the AAD app certificate with permissions to write secrets to the key vault.
725	examples:
726	  - name: encrypt a VM using a key vault in the same resource group
727	    text: >
728	        az vm encryption enable -g MyResourceGroup -n MyVm --disk-encryption-keyvault MyVault
729	"""
730	
731	helps['vm encryption show'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
870	
871	helps['vm generalize'] = """
872	type: command
873	short-summary: Mark a VM as generalized, allowing it to be imaged for multiple deployments.
874	long-summary: 'For an end-to-end tutorial, see https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-capture-image'
875	examples:
876	  - name: Deallocate, generalize, and capture a stopped virtual machine.
877	    text: |
878	        az vm deallocate -g MyResourceGroup -n MyVm
879	        az vm generalize -g MyResourceGroup -n MyVm
880	        az vm capture -g MyResourceGroup -n MyVm --vhd-name-prefix MyPrefix
881	  - name: Deallocate, generalize, and capture multiple stopped virtual machines.
882	    text: |
883	        vms_ids=$(az vm list -g MyResourceGroup --query "[].id" -o tsv)
884	        az vm deallocate --ids {vms_ids}
885	        az vm generalize --ids {vms_ids}
886	        az vm capture --ids {vms_ids} --vhd-name-prefix MyPrefix
887	
888	"""
889	
890	helps['vm get-instance-view'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:1023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1022	
1023	helps['vm list'] = """
1024	type: command
1025	short-summary: List details of Virtual Machines.
1026	long-summary: 'For more information on querying information about Virtual Machines, see https://docs.microsoft.com/en-us/cli/azure/query-az-cli2'
1027	examples:
1028	  - name: List all VMs.
1029	    text: az vm list
1030	  - name: List all VMs by resource group.
1031	    text: az vm list -g MyResourceGroup
1032	  - name: List all VMs by resource group with details.
1033	    text: az vm list -g MyResourceGroup -d
1034	"""
1035	
1036	helps['vm list-ip-addresses'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:1091
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1090	
1091	helps['vm nic'] = """
1092	type: group
1093	short-summary: Manage network interfaces. See also `az network nic`.
1094	long-summary: >
1095	    A network interface (NIC) is the interconnection between a VM and the underlying software
1096	    network. For more information, see https://docs.microsoft.com/azure/virtual-network/virtual-network-network-interface-overview.
1097	"""
1098	
1099	helps['vm nic add'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1200	
1201	helps['vm run-command'] = """
1202	type: group
1203	short-summary: Manage run commands on a Virtual Machine.
1204	long-summary: 'For more information, see https://docs.microsoft.com/en-us/azure/virtual-machines/windows/run-command or https://docs.microsoft.com/en-us/azure/virtual-machines/linux/run-command.'
1205	"""
1206	
1207	helps['vm run-command invoke'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:1327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1326	
1327	helps['vm unmanaged-disk'] = """
1328	type: group
1329	short-summary: Manage the unmanaged data disks attached to a VM.
1330	long-summary: >4
1331	
1332	    Azure Virtual Machines use disks as a place to store an operating system, applications, and data.
1333	    All Azure virtual machines have at least two disks: An operating system disk, and a temporary disk.
1334	    The operating system disk is created from an image, and both the operating system disk and the image are actually virtual hard disks (VHDs)
1335	    stored in an Azure storage account. Virtual machines also can have one or more data disks, that are also stored as VHDs.
1336	
1337	
1338	    Azure Managed and Unmanaged Data Disks have a maximum size of 4095 GB (with the exception of larger disks in preview). Azure Unmanaged Disks also have a maximum capacity of 4095 GB.
1339	
1340	
1341	    For more information, see:
1342	
1343	    - Azure Disks - https://docs.microsoft.com/en-us/azure/virtual-machines/linux/about-disks-and-vhds and https://docs.microsoft.com/en-us/azure/virtual-machines/windows/about-disks-and-vhds.
1344	
1345	    - Larger Managed Disks in Public Preview - https://azure.microsoft.com/en-us/blog/introducing-the-public-preview-of-larger-managed-disks-sizes/
1346	
1347	    - Ultra SSD Managed Disks in Public Preview - https://docs.microsoft.com/en-us/azure/virtual-machines/windows/disks-ultra-ssd
1348	
1349	
1350	"""
1351	
1352	helps['vm unmanaged-disk attach'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:1352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1351	
1352	helps['vm unmanaged-disk attach'] = """
1353	type: command
1354	short-summary: Attach an unmanaged persistent disk to a VM.
1355	long-summary: This allows for the preservation of data, even if the VM is reprovisioned due to maintenance or resizing.
1356	examples:
1357	  - name: Attach a new default sized (1023 GB) unmanaged data disk to a VM.
1358	    text: az vm unmanaged-disk attach -g MyResourceGroup --vm-name MyVm --new
1359	  - name: Attach an existing data disk to a VM as unmanaged.
1360	    text: >
1361	        az vm unmanaged-disk attach -g MyResourceGroup --vm-name MyVm \\
1362	            --vhd-uri https://mystorage.blob.core.windows.net/vhds/d1.vhd
1363	  - name: Attach an unmanaged persistent disk to a VM. (autogenerated)
1364	    text: az vm unmanaged-disk attach --name MyDataDisk --new --resource-group MyResourceGroup --size-gb 50 --vm-name MyVm
1365	    crafted: true
1366	"""
1367	
1368	helps['vm unmanaged-disk detach'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:1471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1470	
1471	helps['vmss create'] = """
1472	type: command
1473	short-summary: Create an Azure Virtual Machine Scale Set.
1474	long-summary: 'For an end-to-end tutorial, see https://docs.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-linux-create-cli.'
1475	parameters:
1476	  - name: --image
1477	    type: string
1478	    short-summary: >
1479	        The name of the operating system image as a URN alias, URN, custom image name or ID, or VHD blob URI.
1480	        Valid URN format: "Publisher:Offer:Sku:Version".
1481	    populator-commands:
1482	      - az vm image list
1483	      - az vm image show
1484	  - name: --ssh-key-values
1485	    short-summary: Space-separated list of SSH public keys or public key file paths.
1486	examples:
1487	  - name: Create a Windows VM scale set with 5 instances, a load balancer, a public IP address, and a 2GB data disk.
1488	    text: >
1489	        az vmss create -n MyVmss -g MyResourceGroup --instance-count 5 --image Win2016Datacenter --data-disk-sizes-gb 2
1490	  - name: Create a Linux VM scale set with an auto-generated ssh key pair, a public IP address, a DNS entry, an existing load balancer, and an existing virtual network.
1491	    text: |
1492	        az vmss create -n MyVmss -g MyResourceGroup --public-ip-address-dns-name my-globally-dns-name \\
1493	            --load-balancer MyLoadBalancer --vnet-name MyVnet --subnet MySubnet --image UbuntuLTS \\
1494	            --generate-ssh-keys
1495	  - name: Create a Linux VM scale set from a custom image using the default existing public SSH key.
1496	    text: >
1497	        az vmss create -n MyVmss -g MyResourceGroup --image MyImage
1498	  - name: Create a Linux VM scale set with a load balancer and custom DNS servers. Each VM has a public-ip address and a custom domain name.
1499	    text: >
1500	        az vmss create -n MyVmss -g MyResourceGroup --image centos \\
1501	            --public-ip-per-vm --vm-domain-name myvmss --dns-servers 10.0.0.6 10.0.0.5
1502	  - name: 'Create a Linux VM scale set using a cloud-init script for configuration. See: https://docs.microsoft.com/azure/virtual-machines/virtual-machines-linux-using-cloud-init'
1503	    text: >
1504	        az vmss create -g MyResourceGroup -n MyVmss --image debian --custom-data MyCloudInitScript.yml
1505	  - name: Create a Debian VM scaleset using Key Vault secrets.
1506	    text: >
1507	        az keyvault certificate create --vault-name vaultname -n cert1 \\
1508	          -p "$(az keyvault certificate get-default-policy)"
1509	
1510	        secrets=$(az keyvault secret list-versions --vault-name vaultname \\
1511	          -n cert1 --query "[?attributes.enabled].id" -o tsv)
1512	
1513	        vm_secrets=$(az vm secret format -s "$secrets")
1514	
1515	
1516	        az vmss create -g group-name -n vm-name --admin-username deploy  \\
1517	          --image debian --secrets "$vm_secrets"
1518	  - name: Create a VM scaleset with system assigned identity. The VM will have a 'Contributor' Role with access to a storage account.
1519	    text: >
1520	        az vmss create -n MyVmss -g MyResourceGroup --image centos --assign-identity --scope /subscriptions/99999999-1bf0-4dda-aec3-cb9272f09590/MyResourceGroup/myRG/providers/Microsoft.Storage/storageAccounts/storage1
1521	  - name: Create a debian VM scaleset with a user assigned identity.
1522	    text: >
1523	        az vmss create -n MyVmss -g rg1 --image debian --assign-identity  /subscriptions/99999999-1bf0-4dda-aec3-cb9272f09590/resourcegroups/myRG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myID
1524	  - name: Create a debian VM scaleset with both system and user assigned identity.
1525	    text: >
1526	        az vmss create -n MyVmss -g rg1 --image debian --assign-identity  [system] /subscriptions/99999999-1bf0-4dda-aec3-cb9272f09590/resourcegroups/myRG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myID
1527	  - name: Create a single zone VM scaleset in the current resource group's region
1528	    supported-profiles: latest
1529	    text: >
1530	        az vmss create -n MyVmss -g MyResourceGroup --image Centos --zones 1
1531	"""
1532	
1533	helps['vmss deallocate'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:1597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1596	
1597	helps['vmss encryption'] = """
1598	type: group
1599	short-summary: "Manage encryption of VMSS."
1600	long-summary: "For more information, see: https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption-overview"
1601	"""
1602	
1603	helps['vmss encryption disable'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:1612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1611	
1612	helps['vmss encryption enable'] = """
1613	type: command
1614	short-summary: "Encrypt a VMSS with managed disks."
1615	long-summary: "For more information, see: For more information, see: https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption-overview"
1616	examples:
1617	  - name: encrypt a VM scale set using a key vault in the same resource group
1618	    text: >
1619	        az vmss encryption enable -g MyResourceGroup -n MyVmss --disk-encryption-keyvault MyVault
1620	"""
1621	
1622	helps['vmss encryption show'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:1803
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1802	
1803	helps['vmss run-command'] = """
1804	type: group
1805	short-summary: Manage run commands on a Virtual Machine Scale Set.
1806	long-summary: 'For more information, see https://docs.microsoft.com/en-us/azure/virtual-machines/windows/run-command or https://docs.microsoft.com/en-us/azure/virtual-machines/linux/run-command.'
1807	"""
1808	
1809	helps['vmss run-command invoke'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:1974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1973	
1974	helps['image template customizer add'] = """
1975	    type: command
1976	    short-summary: Add an image builder customizer to an image builder template.
1977	    long-summary: Must be used with --defer
1978	    examples:
1979	    - name: Add an inline shell customizer to an image template in the cli object cache
1980	      text: |
1981	            az image template customizer add -n mytemplate -g my-group \\
1982	                --inline-script "sudo mkdir /buildArtifacts" \\
1983	                                "sudo cp /tmp/index.html /buildArtifacts/index.html" \\
1984	                --customizer-name shell-script-inline --type shell --defer
1985	
1986	    - name: Add a file customizer to an image template in the cli object cache
1987	      text: |
1988	            az image template customizer add -n mytemplate -g my-group \\
1989	                --customizer-name my-file --type file \\
1990	                --file-source "https://my-remote-file.html" --dest-path "/tmp/index.html" --defer
1991	
1992	    - name: Add a windows restart customizer to an image template in the cli object cache
1993	      text: |
1994	            az image template customizer add -n mytemplate -g my-group \\
1995	            --customizer-name shell-script-url \\
1996	            --restart-check-command "echo Azure-Image-Builder-Restarted-the-VM  > \\
1997	                                    c:\\buildArtifacts\\restart.txt" \\
1998	                --type windows-restart --restart-timeout 10m --defer
1999	
2000	"""
2001	
2002	helps['image template customizer remove'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_help.py:2078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2077	
2078	helps['image template create'] = """
2079	    type: command
2080	    short-summary: Create an image builder template.
2081	    parameters:
2082	    - name: --image-source -i
2083	      populator-commands:
2084	      - az vm image list
2085	      - az vm image show
2086	    examples:
2087	        - name: Create an image builder template from an UbuntuLTS 18.04 image. Distribute it as a managed image and a shared image gallery image version
2088	          text: |
2089	            scripts="https://my-script-url.net/customize_script.sh"
2090	            imagesource="Canonical:UbuntuServer:18.04-LTS:18.04.201903060"
2091	
2092	            az image template create --image-source $imagesource -n mytemplate -g my-group \\
2093	                --scripts $scripts --managed-image-destinations image_1=westus \\
2094	                --shared-image-destinations my_shared_gallery/linux_image_def=westus,brazilsouth
2095	
2096	        - name: >
2097	            [Advanced] Create an image template with multiple customizers and distributors using
2098	            the CLI's object cache via --defer. Supports features such as: customizer and output names,
2099	            powershell exit codes, inline scripts, windows restart, file customizers, artifact tags and vhd output distributors.
2100	          text: |
2101	            script="https://my-script-url.com/customize_script.ps1"
2102	            imagesource="MicrosoftWindowsServer:WindowsServer:2019-Datacenter:2019.0.20190214"
2103	
2104	            # create and update template object in local cli cache. Defers put request to ARM
2105	            # Cache object ttl set via az configure.
2106	            az image template create --image-source $imagesource -n mytemplate \\
2107	                -g my-group --scripts $script --defer
2108	
2109	            # add customizers
2110	            az image template customizer add -n mytemplate -g my-group  \\
2111	                --customizer-name my-pwsh-script --exit-codes 0 1 --inline-script \\
2112	                "mkdir c:\\buildActions" "echo Azure-Image-Builder-Was-Here \\
2113	                 > c:\\buildActions\\Output.txt" --type powershell --defer
2114	
2115	            az image template customizer add -n mytemplate -g my-group \\
2116	                --customizer-name my-file-customizer --type file \\
2117	                --file-source "https://my-file-source.net/file.txt"  \\
2118	                --dest-path "c:\\buildArtifacts\\file.txt" --defer
2119	
2120	            # add distributors
2121	            az image template output add -n mytemplate -g my-group --is-vhd \\
2122	                --output-name my-win-image-vhd --artifact-tags "is_vhd=True" --defer
2123	
2124	            az image template output add -n mytemplate -g my-group \\
2125	                --output-name my-win-image-managed --managed-image winImage \\
2126	                --managed-image-location eastus \\
2127	                --artifact-tags "is_vhd=False" --defer
2128	
2129	            # Stop deferring put request to ARM. Create the template from the object cache.
2130	            # Cache object will be deleted.
2131	            az image template update -n mytemplate -g my-group
2132	"""
2133	
2134	helps['image template list'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_params.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
365	        c.argument('lun', type=int, help='0-based logical unit number (LUN). Max value depends on the Virtual Machine size.')
366	        c.argument('vhd_uri', help="Virtual hard disk URI. For example: https://mystorage.blob.core.windows.net/vhds/d1.vhd")
367	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_params.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
418	        c.argument('nat_backend_port', default=None, help='Backend port to open with NAT rules.  Defaults to 22 on Linux and 3389 on Windows.')
419	        c.argument('single_placement_group', arg_type=get_three_state_flag(), help="Enable replicate using fault domains within the same cluster. Default to 'false' for any zonals, or with 100+ instances"
420	                   " See https://docs.microsoft.com/en-us/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-placement-groups for details")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_params.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
423	        c.argument('instance_count', help='Number of VMs in the scale set.', type=int)
424	        c.argument('disable_overprovision', help='Overprovision option (see https://azure.microsoft.com/en-us/documentation/articles/virtual-machine-scale-sets-overview/ for details).', action='store_true')
425	        c.argument('upgrade_policy_mode', help=None, arg_type=get_enum_type(UpgradeMode))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_params.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
426	        c.argument('health_probe', help='Probe name from the existing load balancer, mainly used for rolling upgrade')
427	        c.argument('vm_sku', help='Size of VMs in the scale set. Default to "Standard_DS1_v2". See https://azure.microsoft.com/en-us/pricing/details/virtual-machines/ for size info.')
428	        c.argument('nsg', help='Name or ID of an existing Network Security Group.', arg_group='Network')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_params.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
539	            c.argument('validate', options_list=['--validate'], help='Generate and validate the ARM template without creating any resources.', action='store_true')
540	            c.argument('size', help='The VM size to be created. See https://azure.microsoft.com/en-us/pricing/details/virtual-machines/ for size info.')
541	            c.argument('image', completer=get_urn_aliases_completion_list)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_validators.py:971
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
970	        with open(string_or_file, 'r') as f:
971	            content = f.read()
972	    elif not keys.is_valid_ssh_rsa_public_key(content):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_vm_utils.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
38	        with open(string_or_file, 'r') as f:
39	            content = f.read()
40	    return content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/_vm_utils.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	    suffix = cli_ctx.cloud.suffixes.keyvault_dns
114	    return 'https://{}{}'.format(vault_name, suffix)
115	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/custom.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
618	            len(storage_account_name) > 1 else storage_account_name[0]
619	        os_vhd_uri = 'https://{}.blob.{}/{}/{}.vhd'.format(
620	            storage_account_name, cmd.cli_ctx.cloud.suffixes.storage_endpoint, storage_container_name, os_disk_name)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/custom.py:1089
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1088	        try:
1089	            self.out.write(content)
1090	        except UnicodeEncodeError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/custom.py:1094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1093	            ascii_content = unicodedata.normalize('NFKD', content).encode('ascii', 'ignore')
1094	            self.out.write(ascii_content.decode())
1095	            logger.warning("A few unicode characters have been ignored because the shell is not able to display. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_vm-2.2.23-py2.py3-none-any/azure/cli/command_modules/vm/custom.py:2015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2014	        master_template.add_variable('vhdContainers', [
2015	            "[concat('https://', variables('storageAccountNames')[{}], '.blob.{}/{}')]".format(
2016	                x, cmd.cli_ctx.cloud.suffixes.storage_endpoint, storage_container_name) for x in range(5)

--------------------------------------------------

Code scanned:
	Total lines of code: 9055
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 7.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 38.0
		High: 0.0
Files skipped (0):
