Run started:2025-04-12 18:20:51.079206

Test results:
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/archives.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
59	    mode = f"w:{compression}" if compression else "w"
60	    with tarfile.open(path, mode=mode) as file:  # type: ignore
61	        for content_path in content_paths:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/archives.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	            filepath = join_path(basedir, filename)
90	            file.write(path, filepath)
91	        elif is_dir(path):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/info.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
140	    with open(path, "rb") as file:
141	        for chunk in iter(lambda: file.read(4096), b""):
142	            hash.update(chunk)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/io.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
27	    with open(path, encoding=encoding) as file:
28	        content = file.read()
29	    return content

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/io.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	    requests = require_requests()
37	    response = requests.get(url, **kwargs)
38	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/io.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
139	    dirpath, _ = split_filepath(path)
140	    auto_delete_temp_file = False if platform.system() == "Windows" else True
141	    try:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/io.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
139	    dirpath, _ = split_filepath(path)
140	    auto_delete_temp_file = False if platform.system() == "Windows" else True
141	    try:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/io.py:140
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
139	    dirpath, _ = split_filepath(path)
140	    auto_delete_temp_file = False if platform.system() == "Windows" else True
141	    try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/io.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	        ) as file:
149	            file.write(content)
150	            file.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/io.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
148	        ) as file:
149	            file.write(content)
150	            file.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/io.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
177	    with open(path, mode, encoding=encoding) as file:
178	        file.write(content)
179	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/io.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
177	    with open(path, mode, encoding=encoding) as file:
178	        file.write(content)
179	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/operations.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	    kwargs["stream"] = True
206	    with requests.get(url, **kwargs) as response:
207	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/operations.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
211	            # detect filename from headers
212	            content_disposition = response.headers.get("content-disposition", "") or ""
213	            filename_pattern = r'filename="(.*)"'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/operations.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
234	                if chunk:
235	                    file.write(chunk)
236	    return filepath

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/operations.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
234	                if chunk:
235	                    file.write(chunk)
236	    return filepath

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/operations.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
351	    assert_dir(path)
352	    shutil.rmtree(path, **kwargs)
353	    return not exists(path)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/perms.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
27	    permissions = int(str(value), 8) & 0o777
28	    os.chmod(path, permissions)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/fsutil/perms.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
27	    permissions = int(str(value), 8) & 0o777
28	    os.chmod(path, permissions)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/tests/test_io.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	def test_read_file_from_url():
17	    url = "https://raw.githubusercontent.com/fabiocaccamo/python-fsutil/main/README.md"
18	    content = fsutil.read_file_from_url(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/tests/test_operations.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
205	def test_download_file(temp_path):
206	    url = "https://raw.githubusercontent.com/fabiocaccamo/python-fsutil/main/README.md"
207	    path = fsutil.download_file(url, dirpath=temp_path())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/tests/test_operations.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
217	    for _ in range(3):
218	        url = "https://raw.githubusercontent.com/fabiocaccamo/python-fsutil/main/README.md"
219	        path = fsutil.download_file(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/tests/test_operations.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	def test_download_file_without_requests_installed(temp_path):
229	    url = "https://raw.githubusercontent.com/fabiocaccamo/python-fsutil/main/README.md"
230	    with patch("fsutil.operations.require_requests", side_effect=ModuleNotFoundError()):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/tests/test_paths.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    assert (
15	        fsutil.get_file_basename("https://domain-name.com/Document.txt?p=1")
16	        == "Document"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/tests/test_paths.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    assert (
26	        fsutil.get_file_extension("https://domain-name.com/Document.txt?p=1") == "txt"
27	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/tests/test_paths.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	    assert (
36	        fsutil.get_filename("https://domain-name.com/Document.txt?p=1")
37	        == "Document.txt"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/python_fsutil-0.15.0/python_fsutil-0.15.0/tests/test_paths.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	    assert fsutil.split_filename("/root/a/b/c/Document.txt") == ("Document", "txt")
109	    assert fsutil.split_filename("https://domain-name.com/Document.txt?p=1") == (
110	        "Document",

--------------------------------------------------

Code scanned:
	Total lines of code: 2714
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 2.0
Files skipped (0):
