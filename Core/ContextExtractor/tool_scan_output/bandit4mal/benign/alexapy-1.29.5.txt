Run started:2025-04-12 14:33:06.667839

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	        self._session = login.session
71	        self._url: str = "https://alexa." + login.url
72	        self._login._headers["Referer"] = f"{self._url}/spa/index.html"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	            self._session = login.session
106	            self._url: str = "https://alexa." + login.url
107	            self._login._headers["Referer"] = f"{self._url}/spa/index.html"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
245	    ) -> ClientResponse:
246	        return await self._request("post", uri, data, query)
247	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
253	    ) -> ClientResponse:
254	        return await self._request("put", uri, data, query)
255	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
261	    ) -> ClientResponse:
262	        return await self._request("get", uri, data, query)
263	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
269	    ) -> ClientResponse:
270	        return await self._request("delete", uri, data, query)
271	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
475	        )
476	        await self._post_request("/api/behaviors/preview", data=data)
477	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1093	        """Select the media player."""
1094	        await self._post_request(
1095	            "/api/np/command",
1096	            data=data,
1097	            query={
1098	                "deviceSerialNumber": self._device.device_serial_number,
1099	                "deviceType": self._device._device_type,
1100	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1179	        """Get playing state."""
1180	        response = await self._get_request(
1181	            "/api/np/player",
1182	            query={
1183	                "deviceSerialNumber": self._device.device_serial_number,
1184	                "deviceType": self._device._device_type,
1185	                "screenWidth": 2560,
1186	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1192	        """Get wifi details."""
1193	        response = await self._get_request(
1194	            "/api/device-wifi-details",
1195	            query={
1196	                "deviceSerialNumber": self._device.device_serial_number,
1197	                "deviceType": self._device._device_type,
1198	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1222	        )
1223	        response = await self._put_request("/api/dnd/status", data=data)
1224	        response_json = await response.json(content_type=None) if response else None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1237	        """Get paired bluetooth devices."""
1238	        response = await AlexaAPI._static_request(
1239	            "get", login, "/api/bluetooth", query={"cached": "false"}
1240	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1245	        """Pair with bluetooth device with mac address."""
1246	        await self._post_request(
1247	            "/api/bluetooth/pair-sink/"
1248	            + self._device._device_type
1249	            + "/"
1250	            + self._device.device_serial_number,
1251	            data={"bluetoothDeviceAddress": mac},
1252	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1256	        """Disconnect all bluetooth devices."""
1257	        await self._post_request(
1258	            "/api/bluetooth/disconnect-sink/"
1259	            + self._device._device_type
1260	            + "/"
1261	            + self._device.device_serial_number,
1262	            data=None,
1263	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1268	        """Identify all Alexa devices."""
1269	        response = await AlexaAPI._static_request(
1270	            "get", login, "/api/devices-v2/device", query=None
1271	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1282	        """Get the wake words for the devices."""
1283	        response = await AlexaAPI._static_request(
1284	            "get", login, "/api/wake-word", query={"cached": "true"}
1285	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1317	        """Get authentication json."""
1318	        response = await AlexaAPI._static_request(
1319	            "get", login, "/api/bootstrap", query=None
1320	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1341	        )
1342	        response = await AlexaAPI._static_request(
1343	            "get",
1344	            login,
1345	            "/alexa-privacy/apd/rvh/customer-history-records",
1346	            query={
1347	                "startTime": start_time,
1348	                "endTime": end_time,
1349	                "recordType": "VOICE_HISTORY",
1350	                "maxRecordSize": max_record_size,
1351	            },
1352	            sub_domain="www",
1353	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1433	        """Get activities json."""
1434	        response = await AlexaAPI._static_request(
1435	            "get",
1436	            login,
1437	            "/api/activities",
1438	            query={"startTime": "", "size": items, "offset": 1},
1439	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1446	        """Identify all Alexa device preferences."""
1447	        response = await AlexaAPI._static_request(
1448	            "get", login, "/api/device-preferences", query={}
1449	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1457	        """Identify all Alexa automations."""
1458	        response = await AlexaAPI._static_request(
1459	            "get", login, "/api/behaviors/v2/automations", query={"limit": items}
1460	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1573	        data = {"stateRequests": state_requests}
1574	        response = await AlexaAPI._static_request(
1575	            "post", login, "/api/phoenix/state", data=data
1576	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1607	        }
1608	        response = await AlexaAPI._static_request(
1609	            "put", login, "/api/phoenix/state", data=data
1610	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1684	
1685	        response = await AlexaAPI._static_request(
1686	            "put", login, "/api/phoenix/state", data=data
1687	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1706	        """
1707	        response = await AlexaAPI._static_request("get", login, "/api/phoenix")
1708	        # _LOGGER.debug("%s: Response: %s", hide_email(login.email),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1744	        """
1745	        response = await AlexaAPI._static_request("get", login, "/api/notifications")
1746	        # _LOGGER.debug("%s: Response: %s", hide_email(login.email),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1765	        """
1766	        response = await AlexaAPI._static_request(
1767	            "put", login, "/api/notifications", data=data
1768	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1783	        """
1784	        response = await AlexaAPI._static_request(
1785	            "get",
1786	            login,
1787	            "/api/dnd/device-status-list",
1788	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1796
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1795	        email = login.email
1796	        response = await AlexaAPI._static_request(
1797	            "get", login, "/api/activities", query={"size": items, "offset": -1}
1798	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1814	        for activity in response_json:
1815	            response = await AlexaAPI._static_request(
1816	                "delete",
1817	                login,
1818	                f"/api/activities/{urllib.parse.quote_plus(activity['id'])}",
1819	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1874
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1873	            _LOGGER.warning("Background URL should be a valid https image")
1874	        response = await self._post_request("/api/background-image", data=data)
1875	        response_json = await response.json(content_type=None) if response else None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexaapi.py:1907
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1906	        """
1907	        response = await AlexaAPI._static_request(
1908	            "get",
1909	            login,
1910	            "/api/ping",
1911	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	        self._hass_domain: str = "alexa_media"
107	        self._prefix: str = "https://alexa."
108	        self._url: str = url

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
149	            "code_verifier",
150	            base64.urlsafe_b64encode(secrets.token_bytes(32)).rstrip(b"=").decode(),
151	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
153	            "code_challenge",
154	            base64.urlsafe_b64encode(
155	                hashlib.sha256(self.code_verifier.encode()).digest()
156	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	        if self.oauth_login:
213	            site: URL = URL("https://www.amazon.com/ap/register")
214	            query = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
214	            query = {
215	                "openid.return_to": "https://www.amazon.com/ap/maplanding",
216	                "openid.assoc_handle": "amzn_dp_project_dee_ios",
217	                "openid.identity": "http://specs.openid.net/auth/2.0/identifier_select",
218	                "pageId": "amzn_dp_project_dee_ios",
219	                "accountStatusPolicy": "P1",
220	                "openid.claimed_id": "http://specs.openid.net/auth/2.0/identifier_select",
221	                "openid.mode": "checkid_setup",
222	                "openid.ns.oa2": "http://www.amazon.com/ap/ext/oauth/2",
223	                "openid.oa2.client_id": f"device:{self.deviceid}",
224	                "openid.ns.pape": "http://specs.openid.net/extensions/pape/1.0",
225	                "openid.oa2.response_type": "code",
226	                "openid.ns": "http://specs.openid.net/auth/2.0",
227	                "openid.pape.max_auth_age": "0",
228	                "openid.oa2.scope": "device_auth_access offline_access",
229	                "openid.oa2.code_challenge_method": "S256",
230	                "openid.oa2.code_challenge": self.code_challenge,
231	                "language": (
232	                    LOCALE_KEY.get(self.url.replace("amazon", ""))
233	                    if LOCALE_KEY.get(self.url.replace("amazon", ""))
234	                    else "en_US"
235	                ),
236	            }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
216	                "openid.assoc_handle": "amzn_dp_project_dee_ios",
217	                "openid.identity": "http://specs.openid.net/auth/2.0/identifier_select",
218	                "pageId": "amzn_dp_project_dee_ios",
219	                "accountStatusPolicy": "P1",
220	                "openid.claimed_id": "http://specs.openid.net/auth/2.0/identifier_select",
221	                "openid.mode": "checkid_setup",
222	                "openid.ns.oa2": "http://www.amazon.com/ap/ext/oauth/2",
223	                "openid.oa2.client_id": f"device:{self.deviceid}",
224	                "openid.ns.pape": "http://specs.openid.net/extensions/pape/1.0",
225	                "openid.oa2.response_type": "code",
226	                "openid.ns": "http://specs.openid.net/auth/2.0",
227	                "openid.pape.max_auth_age": "0",
228	                "openid.oa2.scope": "device_auth_access offline_access",
229	                "openid.oa2.code_challenge_method": "S256",
230	                "openid.oa2.code_challenge": self.code_challenge,
231	                "language": (
232	                    LOCALE_KEY.get(self.url.replace("amazon", ""))
233	                    if LOCALE_KEY.get(self.url.replace("amazon", ""))
234	                    else "en_US"
235	                ),
236	            }
237	            site = site.update_query(query)
238	            _LOGGER.debug("Attempting oauth login to %s", site)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	                "accountStatusPolicy": "P1",
220	                "openid.claimed_id": "http://specs.openid.net/auth/2.0/identifier_select",
221	                "openid.mode": "checkid_setup",
222	                "openid.ns.oa2": "http://www.amazon.com/ap/ext/oauth/2",
223	                "openid.oa2.client_id": f"device:{self.deviceid}",
224	                "openid.ns.pape": "http://specs.openid.net/extensions/pape/1.0",
225	                "openid.oa2.response_type": "code",
226	                "openid.ns": "http://specs.openid.net/auth/2.0",
227	                "openid.pape.max_auth_age": "0",
228	                "openid.oa2.scope": "device_auth_access offline_access",
229	                "openid.oa2.code_challenge_method": "S256",
230	                "openid.oa2.code_challenge": self.code_challenge,
231	                "language": (
232	                    LOCALE_KEY.get(self.url.replace("amazon", ""))
233	                    if LOCALE_KEY.get(self.url.replace("amazon", ""))
234	                    else "en_US"
235	                ),
236	            }
237	            site = site.update_query(query)
238	            _LOGGER.debug("Attempting oauth login to %s", site)
239	        else:
240	            site: URL = URL(self._prefix + self.url)
241	            self._headers["authority"] = f"www.{self._url}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
221	                "openid.mode": "checkid_setup",
222	                "openid.ns.oa2": "http://www.amazon.com/ap/ext/oauth/2",
223	                "openid.oa2.client_id": f"device:{self.deviceid}",
224	                "openid.ns.pape": "http://specs.openid.net/extensions/pape/1.0",
225	                "openid.oa2.response_type": "code",
226	                "openid.ns": "http://specs.openid.net/auth/2.0",
227	                "openid.pape.max_auth_age": "0",
228	                "openid.oa2.scope": "device_auth_access offline_access",
229	                "openid.oa2.code_challenge_method": "S256",
230	                "openid.oa2.code_challenge": self.code_challenge,
231	                "language": (
232	                    LOCALE_KEY.get(self.url.replace("amazon", ""))
233	                    if LOCALE_KEY.get(self.url.replace("amazon", ""))
234	                    else "en_US"
235	                ),
236	            }
237	            site = site.update_query(query)
238	            _LOGGER.debug("Attempting oauth login to %s", site)
239	        else:
240	            site: URL = URL(self._prefix + self.url)
241	            self._headers["authority"] = f"www.{self._url}"
242	        return site
243	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
223	                "openid.oa2.client_id": f"device:{self.deviceid}",
224	                "openid.ns.pape": "http://specs.openid.net/extensions/pape/1.0",
225	                "openid.oa2.response_type": "code",
226	                "openid.ns": "http://specs.openid.net/auth/2.0",
227	                "openid.pape.max_auth_age": "0",
228	                "openid.oa2.scope": "device_auth_access offline_access",
229	                "openid.oa2.code_challenge_method": "S256",
230	                "openid.oa2.code_challenge": self.code_challenge,
231	                "language": (
232	                    LOCALE_KEY.get(self.url.replace("amazon", ""))
233	                    if LOCALE_KEY.get(self.url.replace("amazon", ""))
234	                    else "en_US"
235	                ),
236	            }
237	            site = site.update_query(query)
238	            _LOGGER.debug("Attempting oauth login to %s", site)
239	        else:
240	            site: URL = URL(self._prefix + self.url)
241	            self._headers["authority"] = f"www.{self._url}"
242	        return site
243	
244	    @property
245	    def lastreq(self) -> Optional[aiohttp.ClientResponse]:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
225	                "openid.oa2.response_type": "code",
226	                "openid.ns": "http://specs.openid.net/auth/2.0",
227	                "openid.pape.max_auth_age": "0",
228	                "openid.oa2.scope": "device_auth_access offline_access",
229	                "openid.oa2.code_challenge_method": "S256",
230	                "openid.oa2.code_challenge": self.code_challenge,
231	                "language": (
232	                    LOCALE_KEY.get(self.url.replace("amazon", ""))
233	                    if LOCALE_KEY.get(self.url.replace("amazon", ""))
234	                    else "en_US"
235	                ),
236	            }
237	            site = site.update_query(query)
238	            _LOGGER.debug("Attempting oauth login to %s", site)
239	        else:
240	            site: URL = URL(self._prefix + self.url)
241	            self._headers["authority"] = f"www.{self._url}"
242	        return site
243	
244	    @property
245	    def lastreq(self) -> Optional[aiohttp.ClientResponse]:
246	        """Return last response for last request for this Login."""
247	        return self._lastreq

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
329	                    try:
330	                        await localfile.write(cookies_txt)
331	                    except (OSError, EOFError, TypeError, AttributeError) as ex:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
348	                    async with aiofiles.open(cookiefile, "rb") as myfile:
349	                        cookies = pickle.loads(await myfile.read())
350	                        if self._debug:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
348	                    async with aiofiles.open(cookiefile, "rb") as myfile:
349	                        cookies = pickle.loads(await myfile.read())
350	                        if self._debug:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
356	                        cookies = http.cookiejar.MozillaCookieJar(cookiefile)
357	                        cookies.load(ignore_discard=True, ignore_expires=True)
358	                        if self._debug:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
515	        self._log_cookies_for_url(path)
516	        get_resp = await self._session.get(
517	            path,
518	            cookies=cookies,
519	            ssl=self._ssl,
520	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
538	            self._log_cookies_for_url(path)
539	            get_resp = await self._session.get(path)
540	            await self._process_resp(get_resp)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
549	                return False
550	        self.customer_id = json.get("authentication", {}).get("customerId")
551	        if (email and email.lower() == self.email.lower()) or "@" not in self.email:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
549	                return False
550	        self.customer_id = json.get("authentication", {}).get("customerId")
551	        if (email and email.lower() == self.email.lower()) or "@" not in self.email:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
658	                assert self._links is not None
659	                if self._links.get(digit):
660	                    (text, site) = self._links[digit]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
669	        else:
670	            resp = await self._session.get(
671	                site, headers=self._headers, ssl=self._ssl, params=self._data
672	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:678
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
677	            async with aiofiles.open(self._debugget, mode="wb") as localfile:
678	                await localfile.write(await resp.read())
679	        # This commented block can be used to read a file directly to process.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:678
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
677	            async with aiofiles.open(self._debugget, mode="wb") as localfile:
678	                await localfile.write(await resp.read())
679	        # This commented block can be used to read a file directly to process.

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:678
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
677	            async with aiofiles.open(self._debugget, mode="wb") as localfile:
678	                await localfile.write(await resp.read())
679	        # This commented block can be used to read a file directly to process.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
688	            return
689	        if not self.status.get("ap_error"):
690	            missing_params = self._populate_data(site, data)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
702	            post_resp = None
703	            if self.status.get("force_get"):
704	                if not self.status.get("approval") and not self.status.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
703	            if self.status.get("force_get"):
704	                if not self.status.get("approval") and not self.status.get(
705	                    "action_required"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
703	            if self.status.get("force_get"):
704	                if not self.status.get("approval") and not self.status.get(
705	                    "action_required"
706	                ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
706	                ):
707	                    post_resp = await self._session.get(
708	                        site,
709	                        params=self._data,
710	                        headers=self._headers,
711	                        ssl=self._ssl,
712	                    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
713	            else:
714	                post_resp = await self._session.post(
715	                    site,
716	                    data=self._data,
717	                    headers=self._headers,
718	                    ssl=self._ssl,
719	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
724	                    async with aiofiles.open(self._debugpost, mode="wb") as localfile:
725	                        await localfile.write(await post_resp.read())
726	                self._lastreq = post_resp

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
724	                    async with aiofiles.open(self._debugpost, mode="wb") as localfile:
725	                        await localfile.write(await post_resp.read())
726	                self._lastreq = post_resp

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
724	                    async with aiofiles.open(self._debugpost, mode="wb") as localfile:
725	                        await localfile.write(await post_resp.read())
726	                self._lastreq = post_resp

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
785	        """
786	        frc = base64.b64encode(secrets.token_bytes(313)).decode("ascii").rstrip("=")
787	        map_md_raw = {

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:786
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
785	        """
786	        frc = base64.b64encode(secrets.token_bytes(313)).decode("ascii").rstrip("=")
787	        map_md_raw = {

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
794	        }
795	        map_md = base64.b64encode(dumps(map_md_raw).encode()).decode().rstrip("=")
796	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:795
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
794	        }
795	        map_md = base64.b64encode(dumps(map_md_raw).encode()).decode().rstrip("=")
796	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
839	            try:
840	                response = await self._session.post(
841	                    "https://api." + url + "/auth/register",
842	                    json=data,
843	                    headers=headers,
844	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
840	                response = await self._session.post(
841	                    "https://api." + url + "/auth/register",
842	                    json=data,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:847
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
846	                _LOGGER.debug("Fallback attempt to register with api.amazon.com")
847	                response = await self._session.post(
848	                    "https://api.amazon.com/auth/register",
849	                    json=data,
850	                    headers=headers,
851	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
847	                response = await self._session.post(
848	                    "https://api.amazon.com/auth/register",
849	                    json=data,
850	                    headers=headers,
851	                )
852	            _LOGGER.debug("auth response %s with \n%s", response, dumps(data))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
858	            return False
859	        response = (await response.json()).get("response")
860	        if response.get("success"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
859	        response = (await response.json()).get("response")
860	        if response.get("success"):
861	            _LOGGER.debug(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1149	        response = await self._session.put(
1150	            "https://api.amazonalexa.com/v1/devices/@self/capabilities",
1151	            json=data,
1152	            headers=headers,
1153	        )
1154	        _LOGGER.debug(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1197	        try:
1198	            response = await self._session.post(
1199	                "https://api." + self.url + "/auth/token",
1200	                data=data,
1201	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1198	            response = await self._session.post(
1199	                "https://api." + self.url + "/auth/token",
1200	                data=data,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1205	            )
1206	            response = await self._session.post(
1207	                "https://api.amazon.com/auth/token",
1208	                data=data,
1209	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1206	            response = await self._session.post(
1207	                "https://api.amazon.com/auth/token",
1208	                data=data,
1209	            )
1210	        _LOGGER.debug("refresh response %s with \n%s", response, dumps(data))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1219	            _LOGGER.debug("Refresh token json:\n%s ", response)
1220	        if response.get("access_token"):
1221	            self.access_token = response.get("access_token")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1220	        if response.get("access_token"):
1221	            self.access_token = response.get("access_token")
1222	            self.expires_in = datetime.datetime.now().timestamp() + int(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1222	            self.expires_in = datetime.datetime.now().timestamp() + int(
1223	                response.get("expires_in")
1224	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1264	        try:
1265	            response = await self._session.post(
1266	                "https://www." + self.url + "/ap/exchangetoken/cookies",
1267	                data=data,
1268	                headers=headers,
1269	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1265	            response = await self._session.post(
1266	                "https://www." + self.url + "/ap/exchangetoken/cookies",
1267	                data=data,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1271	            _LOGGER.debug("Fallback attempt to exchange tokens with www.amazon.com")
1272	            response = await self._session.post(
1273	                "https://www.amazon.com/ap/exchangetoken/cookies",
1274	                data=data,
1275	                headers=headers,
1276	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1272	            response = await self._session.post(
1273	                "https://www.amazon.com/ap/exchangetoken/cookies",
1274	                data=data,
1275	                headers=headers,
1276	            )
1277	        if response.status != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1284	            return False
1285	        response = (await response.json()).get("response")
1286	        if self._debug:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1331	        cookies = self._get_cookies_from_session()
1332	        if cookies.get("csrf"):
1333	            _LOGGER.debug("CSRF already exists; no need to discover")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1348	                self._log_cookies_for_url(path)
1349	                response = await self._session.get(path)
1350	            except aiohttp.ClientConnectionError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1356	            cookies = self._get_cookies_from_session()
1357	            if cookies.get("csrf"):
1358	                _LOGGER.debug("CSRF token found from %s", url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1379	        }
1380	        response = await self._session.get(
1381	            f"{self._prefix}{self.url}/api/users/me?platform=ios&version={CALL_VERSION}",
1382	            headers=headers,
1383	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1393	            return True
1394	        domain = URL(response.get("marketPlaceDomainName")).host.replace("www.", "", 1)
1395	        if self.url != domain:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1463	                    if (
1464	                        form.get("method")
1465	                        and form.get("method") == "get"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1464	                        form.get("method")
1465	                        and form.get("method") == "get"
1466	                        and form.get("action")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1465	                        and form.get("method") == "get"
1466	                        and form.get("action")
1467	                    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1467	                    ):
1468	                        string = form.get("id")
1469	                        action = form.get("action")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1468	                        string = form.get("id")
1469	                        action = form.get("action")
1470	                        params = {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1474	                                item
1475	                                and item.get("type")
1476	                                and item.get("type") == "hidden"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1475	                                and item.get("type")
1476	                                and item.get("type") == "hidden"
1477	                            ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1477	                            ):
1478	                                params[item.get("name")] = item.get("value")
1479	                        href = f"{self._prefix}{self.url}{action}?{urlencode(params)}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1477	                            ):
1478	                                params[item.get("name")] = item.get("value")
1479	                        href = f"{self._prefix}{self.url}{action}?{urlencode(params)}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1534	            status["captcha_required"] = True
1535	            status["captcha_image_url"] = captcha_tag.get("src")
1536	            self._data = self.get_inputs(soup)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1604	            status["captcha_required"] = True
1605	            status["captcha_image_url"] = verification_captcha_tag.get("src")
1606	            status["verification_captcha_required"] = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1651	            )
1652	            status["approval_status"] = approval_status.get("value")
1653	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1655	            query = site_url.query
1656	            self.access_token = query.get("openid.oa2.access_token")
1657	            if await self.test_loggedin():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1668	        # determine post url if not logged in
1669	        if status.get("approval_status") == "TransactionCompleted":
1670	            site = self._data.get("openid.return_to")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1669	        if status.get("approval_status") == "TransactionCompleted":
1670	            site = self._data.get("openid.return_to")
1671	        elif form_tag and "login_successful" not in status:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1671	        elif form_tag and "login_successful" not in status:
1672	            formsite: str = form_tag.get("action")
1673	            if self._debug:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1680	            elif formsite and formsite == "get":
1681	                if "ap_error" in status and status.get("ap_error_href"):
1682	                    assert isinstance(status["ap_error_href"], str)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1683	                    site = status["ap_error_href"]
1684	                elif self._headers.get("Referer"):
1685	                    site = self._headers["Referer"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1709	        # pull data from configurator
1710	        password: Optional[str] = data.get("password", "")
1711	        captcha: Optional[str] = data.get("captcha", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1710	        password: Optional[str] = data.get("password", "")
1711	        captcha: Optional[str] = data.get("captcha", "")
1712	        if data.get("otp_secret"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1711	        captcha: Optional[str] = data.get("captcha", "")
1712	        if data.get("otp_secret"):
1713	            self.set_totp(data.get("otp_secret", ""))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1712	        if data.get("otp_secret"):
1713	            self.set_totp(data.get("otp_secret", ""))
1714	        securitycode: Optional[str] = data.get("securitycode", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1713	            self.set_totp(data.get("otp_secret", ""))
1714	        securitycode: Optional[str] = data.get("securitycode", "")
1715	        if not securitycode and self._totp:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1718
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1717	            securitycode = self.get_totp_token()
1718	        claimsoption: Optional[str] = data.get("claimsoption", "")
1719	        authopt: Optional[str] = data.get("authselectoption", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1718	        claimsoption: Optional[str] = data.get("claimsoption", "")
1719	        authopt: Optional[str] = data.get("authselectoption", "")
1720	        verificationcode: Optional[str] = data.get("verificationcode", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexalogin.py:1720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1719	        authopt: Optional[str] = data.get("authselectoption", "")
1720	        verificationcode: Optional[str] = data.get("verificationcode", "")
1721	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexawebsocket.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
206	        # aiohttp does not and is necessary for Amazon to accept a login
207	        self._headers["Origin"] = "https://alexa." + login.url
208	        self._headers["Host"] = f"dp-gw-na.{login.url}"

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexawebsocket.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
245	        _LOGGER.debug("Connecting to %s with %s", self._wsurl, self._headers)
246	        self.websocket = await self._session.ws_connect(
247	            self._wsurl, headers=self._headers, heartbeat=180, ssl=self._ssl
248	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexawebsocket.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
457	        )
458	        signed_encoded = base64.b64encode(cipher)
459	        signature = f"{signed_encoded.decode()}:{date}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/alexapy-1.29.5/alexapy-1.29.5/alexapy/alexawebsocket.py:458
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
457	        )
458	        signed_encoded = base64.b64encode(cipher)
459	        signature = f"{signed_encoded.decode()}:{date}"

--------------------------------------------------

Code scanned:
	Total lines of code: 4381
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 101.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 119.0
		High: 3.0
Files skipped (0):
