Run started:2025-04-12 11:21:16.207954

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/aws/load_partitions.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	            with fm as f:
135	                athena_list = f.read().decode().splitlines()
136	            athena_list = {'{table}/{partition}/'.format(table=s3_path, partition=partition) for partition in

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/aws/s3_location.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	        else:
97	            raise ValueError("S3 URLs must be either s3://, http://, or https://, "
98	                                "current val: {}".format(s3_str))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/athena.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
199	        with open(sql_loc) as f:
200	            return f.read()
201	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/cached_query.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
128	            with open(file, 'rb') as afile:
129	                buf = afile.read()
130	                hasher.update(buf)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/cached_query.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
568	        with open(sql_file, 'rt') as f:
569	            sql = f.read()
570	            # check for unescaped %

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/cached_query.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
588	
589	        if '{s3_path' in open(query_file).read():
590	            # many of our queries include an UNLOAD to S3 path statement and require s3_path

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/cached_query.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
685	        with self.dfs.open(f'{file_hash}.sql', 'wb') as f:  # FileDoggo does not support "wt" for S3 files
686	            f.write('-- Ran query on: {:%Y-%m-%d %H:%M:%S}\n'.format(datetime.datetime.now()).encode('UTF-8'))
687	            f.write('-- Parameters: {0}\n'.format(self._clean_dict(parameters)).encode('UTF-8'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/cached_query.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
686	            f.write('-- Ran query on: {:%Y-%m-%d %H:%M:%S}\n'.format(datetime.datetime.now()).encode('UTF-8'))
687	            f.write('-- Parameters: {0}\n'.format(self._clean_dict(parameters)).encode('UTF-8'))
688	            f.write((logged_query + ';\n').encode('UTF-8'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/cached_query.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
687	            f.write('-- Parameters: {0}\n'.format(self._clean_dict(parameters)).encode('UTF-8'))
688	            f.write((logged_query + ';\n').encode('UTF-8'))
689	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/cached_query.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
699	        with open(query_file) as f:
700	            actual_query = f.read()
701	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/sql_client.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	        if self.am_archiving:
50	            self._archive.write(
51	                '-- Ran query on: {:%Y-%m-%d %H:%M:%S}\n'.format(datetime.datetime.now()).encode('utf-8'))
52	            self._archive.write('-- Parameters: {0}\n'.format(_clean_dict(parameters)).encode('utf-8'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/sql_client.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	                '-- Ran query on: {:%Y-%m-%d %H:%M:%S}\n'.format(datetime.datetime.now()).encode('utf-8'))
52	            self._archive.write('-- Parameters: {0}\n'.format(_clean_dict(parameters)).encode('utf-8'))
53	            self._archive.write(logged_query.encode('utf-8') + b';\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/sql_client.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
52	            self._archive.write('-- Parameters: {0}\n'.format(_clean_dict(parameters)).encode('utf-8'))
53	            self._archive.write(logged_query.encode('utf-8') + b';\n')
54	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/sql_client.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	                s3 = boto3.client('s3')
62	                _ = self._archive.read()  # boto closes this, but i want to keep it just in case
63	                self._archive.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/sql_client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66	                with open(self._file, 'wb') as f:
67	                    f.write(self._archive.read())
68	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/sql_client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	                with open(self._file, 'wb') as f:
67	                    f.write(self._archive.read())
68	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/db/sql_client.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	                f = open(query_file, "r")
182	                text = f.read()
183	                f.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/doggo/csv.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	        with DoggoFileSystem().open(full_path, mode="rb") as f:
68	            sample = f.read(self.SAMPLE_SIZE)
69	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/doggo/doggo.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
176	        with fm as f:
177	            f.write(df.to_csv(None, *args, **kwargs).encode('utf-8'))
178	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/doggo/fs.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
278	            if is_directory:
279	                return shutil.rmtree(source)
280	            else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/newtools/doggo/fs.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
291	                shutil.copytree(source, destination)
292	                return shutil.rmtree(source)
293	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/setup.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6	with open('README.md') as f:
7	    long_description = f.read()
8	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/setup.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
9	with open(os.path.join(os.path.split(__file__)[0], 'requirements.txt')) as f:
10	    reqs = f.read().splitlines()
11	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
14	setup(name='newtools',
15	      version=open('version.txt', 'r').read().strip(),  # read version from file as it's bumped by the build process
16	      description='Provides useful libraries for processing large data sets.',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/setup.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	      description='Provides useful libraries for processing large data sets.',
17	      long_description="""
18	      Provides libraries for processing large data sets on AWS with Pandas.
19	      
20	      Developed by the team at [deductive.com](https://deductive.com) as we find them useful in our projects.
21	      
22	      &copy; Deductive 2012-2020, all rights reserved. This code is licensed under MIT license. See [license.txt](https://bitbucket.org/deductive/newtools/src/master/licence.txt) for details.
23	
24	      For documentation see [read the docs](http://newtools.readthedocs.io)
25	      """,
26	      long_description_content_type="text/markdown",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/setup.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	      long_description_content_type="text/markdown",
27	      url='https://bitbucket.org/deductive/newtools/',
28	      project_urls={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/setup.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	      project_urls={
29	          'Documentation': 'https://newtools.readthedocs.io/en/latest/',
30	          'Source': 'https://bitbucket.org/deductive/newtools/'
31	      },
32	      author='Deductive',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/newtools-2.2.489/newtools-2.2.489/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	          'Documentation': 'https://newtools.readthedocs.io/en/latest/',
30	          'Source': 'https://bitbucket.org/deductive/newtools/'
31	      },
32	      author='Deductive',
33	      author_email='hello@deductive.com',

--------------------------------------------------

Code scanned:
	Total lines of code: 3336
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 0.0
Files skipped (0):
