Run started:2025-04-12 16:25:47.548236

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setup.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
136	    else:
137	        sys_name = plat_to_system(pl_name)
138	        libname = libname_for_system(sys_name)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setup.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
137	        sys_name = plat_to_system(pl_name)
138	        libname = libname_for_system(sys_name)
139	        kwargs["package_data"]["pypdfium2_raw"] = [VersionFN, BindingsFN, libname]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/autorelease.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
103	    if is_beta:
104	        content += f"- See the beta release notes on GitHub [here](https://github.com/pypdfium2-team/pypdfium2/releases/tag/{new_tag})\n"
105	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	
50	RepositoryURL  = "https://github.com/pypdfium2-team/pypdfium2"
51	PdfiumURL      = "https://pdfium.googlesource.com/pdfium"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	RepositoryURL  = "https://github.com/pypdfium2-team/pypdfium2"
51	PdfiumURL      = "https://pdfium.googlesource.com/pdfium"
52	DepotToolsURL  = "https://chromium.googlesource.com/chromium/tools/depot_tools.git"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	PdfiumURL      = "https://pdfium.googlesource.com/pdfium"
52	DepotToolsURL  = "https://chromium.googlesource.com/chromium/tools/depot_tools.git"
53	ReleaseRepo    = "https://github.com/bblanchon/pdfium-binaries"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	DepotToolsURL  = "https://chromium.googlesource.com/chromium/tools/depot_tools.git"
53	ReleaseRepo    = "https://github.com/bblanchon/pdfium-binaries"
54	ReleaseURL     = ReleaseRepo + "/releases/download/chromium%2F"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
178	            print(f"Fetching chromium refs ...", file=sys.stderr)
179	            ChromiumURL = "https://chromium.googlesource.com/chromium/src"
180	            rc["lines"] = run_cmd(["git", "ls-remote", "--sort", "-version:refname", "--tags", ChromiumURL, '*.*.*.0'], cwd=None, capture=True).split("\n")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
198	def read_json(fp):
199	    with open(fp, "r") as buf:
200	        return json.load(buf)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
202	def write_json(fp, data, indent=2):
203	    with open(fp, "w") as buf:
204	        return json.dump(data, buf, indent=indent)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
310	        # For the machine name, the platform module just passes through info provided by the OS (e.g. the uname command on unix), so we can determine the relevant names from Python's source code, system specs or info available online (e.g. https://en.wikipedia.org/wiki/Uname)
311	        self._system_name = platform.system().lower()
312	        self._machine_name = platform.machine().lower()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
310	        # For the machine name, the platform module just passes through info provided by the OS (e.g. the uname command on unix), so we can determine the relevant names from Python's source code, system specs or info available online (e.g. https://en.wikipedia.org/wiki/Uname)
311	        self._system_name = platform.system().lower()
312	        self._machine_name = platform.machine().lower()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:311
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
310	        # For the machine name, the platform module just passes through info provided by the OS (e.g. the uname command on unix), so we can determine the relevant names from Python's source code, system specs or info available online (e.g. https://en.wikipedia.org/wiki/Uname)
311	        self._system_name = platform.system().lower()
312	        self._machine_name = platform.machine().lower()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
328	        if self.platform is not None:
329	            return plat_to_system(self.platform)
330	        else:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
328	        if self.platform is not None:
329	            return plat_to_system(self.platform)
330	        else:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
503	    src_buf = tar.extractfile(src)  # src: path str or tar member object
504	    with open(dst_path, "wb") as dst_buf:
505	        shutil.copyfileobj(src_buf, dst_buf)

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
620	        archive_path = DataDir_Bindings / "pdfium_public.tar.gz"
621	        url_request.urlretrieve(archive_url, archive_path)
622	        with tarfile.open(archive_path) as tar:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
621	        url_request.urlretrieve(archive_url, archive_path)
622	        with tarfile.open(archive_path) as tar:
623	            for m in tar.getmembers():

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/base.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
645	        elif fp.is_dir():
646	            shutil.rmtree(fp)
647	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/craft.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
79	        
80	        file_names = [VersionFN, BindingsFN, libname_for_system(Host.system)]
81	        self.files = [fp for fp in [ModuleDir_Raw / fn for fn in file_names] if fp.exists()]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/craft.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	    if not pin:
115	        head_url = "https://api.github.com/repos/pypdfium2-team/ctypesgen/git/refs/heads/pypdfium2"
116	        with url_request.urlopen(head_url) as rq:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/craft.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
115	        head_url = "https://api.github.com/repos/pypdfium2-team/ctypesgen/git/refs/heads/pypdfium2"
116	        with url_request.urlopen(head_url) as rq:
117	            content = rq.read().decode()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/craft.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	        with url_request.urlopen(head_url) as rq:
117	            content = rq.read().decode()
118	        content = json.loads(content)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/craft.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	    
122	    base_txt = "ctypesgen @ git+https://github.com/pypdfium2-team/ctypesgen@"
123	    ctx = tmp_replace_ctx(ProjectDir/"pyproject.toml", base_txt+"pypdfium2", base_txt+pin)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/emplace.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
20	    
21	    system = plat_to_system(pl_name)
22	    pl_dir = DataDir / pl_name

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/emplace.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
22	    pl_dir = DataDir / pl_name
23	    binary = pl_dir / libname_for_system(system)
24	    binary_ver = pl_dir / VersionFN

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/emplace.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
61	        pl_dir = DataDir/pl_name
62	        system = plat_to_system(pl_name)
63	        

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/emplace.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
70	        
71	        platfiles += [pl_dir/libname_for_system(system), pl_dir/VersionFN]
72	        for fp in platfiles:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/sourcebuild.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	    tool_file = tool_dir / "generate_shim_headers.py"
119	    tool_url = "https://raw.githubusercontent.com/chromium/chromium/main/tools/generate_shim_headers/generate_shim_headers.py"
120	
121	    if not tool_file.exists():

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/sourcebuild.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
122	        tool_dir.mkdir(parents=True, exist_ok=True)
123	        url_request.urlretrieve(tool_url, tool_file)
124	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/sourcebuild.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
183	    
184	    libname = libname_for_system(Host.system)
185	    shutil.copy(PDFiumBuildDir/libname, dest_dir/libname)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/update.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
21	        if pl_dir.exists():
22	            shutil.rmtree(pl_dir)
23	

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/update.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
39	    try:
40	        url_request.urlretrieve(fu, fp)
41	    except Exception as e:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/update.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
56	    archives = {}
57	    with ThreadPoolExecutor(max_workers=max_workers) as pool:
58	        func = functools.partial(_get_package, version=version, robust=robust, use_v8=use_v8)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/setupsrc/pypdfium2_setup/update.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
69	        
70	        with tarfile.open(arc_path) as tar:
71	            pl_dir = DataDir/pl_name

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/src/pypdfium2/_cli/render.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
344	        np_array = self.postprocess(np_array, bitmap, page, **postproc_kwargs)
345	        cv2.imwrite(str(out_path), np_array)
346	    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pypdfium2-5.0.0b1/pypdfium2-5.0.0b1/src/pypdfium2/internal/bases.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
18	    try:
19	        os.write(sys.stderr.fileno(), (msg+"\n").encode())
20	    except Exception:  # e.g. io.UnsupportedOperation

--------------------------------------------------

Code scanned:
	Total lines of code: 7676
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 27.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 1.0
Files skipped (0):
