Run started:2025-04-12 10:42:48.526476

Test results:
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/__init__.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
252	            if base64_data:
253	                jpg_raw = base64.b64decode(base64_data)
254	                pil_img = Image.open(io.BytesIO(jpg_raw))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/__init__.py:253
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
252	            if base64_data:
253	                jpg_raw = base64.b64decode(base64_data)
254	                pil_img = Image.open(io.BytesIO(jpg_raw))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/_input.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
102	            btext = text.encode('utf-8')
103	            base64text = base64.b64encode(btext).decode()
104	            cmd = "ADB_KEYBOARD_INPUT_TEXT"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/_input.py:103
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
102	            btext = text.encode('utf-8')
103	            base64text = base64.b64encode(btext).decode()
104	            cmd = "ADB_KEYBOARD_INPUT_TEXT"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/core.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	        
43	        t = threading.Thread(target=wait_finished)
44	        t.daemon = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/core.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        # so here use 127.0.0.1 instead of localhost
95	        url = f"http://127.0.0.1:{lport}{path}"
96	        if print_request:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/core.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
112	        }
113	        r = requests.request(method, url, json=data, timeout=timeout, headers=headers)
114	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/core.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
140	    }
141	    r = _http_request(dev, "POST", "/jsonrpc/0", payload, timeout=timeout, print_request=print_request)
142	    data = r.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/core.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	        logger.debug("jsonrpc error: %s", data)
148	        code = data['error'].get('code')
149	        message = data['error'].get('message', '')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/core.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
148	        code = data['error'].get('code')
149	        message = data['error'].get('message', '')
150	        stacktrace = data['error'].get('data')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/core.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149	        message = data['error'].get('message', '')
150	        stacktrace = data['error'].get('data')
151	        if "UiAutomation not connected" in r.text:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/core.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
219	        with open(local_file, "rb") as f:
220	            md5.update(f.read())
221	        local_md5 = md5.hexdigest()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/core.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
257	        try:
258	            response = _http_request(self._dev, "GET", "/ping")
259	            return response.content == b"pong"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/ext/htmlreport/__init__.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
121	        with open(record_file, 'wb') as f:
122	            f.write(json.dumps({'steps': self._steps}).encode('utf-8'))
123	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/ext/htmlreport/assets/simplehttpserver.py:12
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
11	def is_port_avaiable(port):
12	    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
13	    result = sock.connect_ex(('127.0.0.1', port))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/ext/htmlreport/assets/simplehttpserver.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
12	    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
13	    result = sock.connect_ex(('127.0.0.1', port))
14	    return result != 0

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/ext/htmlreport/assets/simplehttpserver.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
20	
21	    with closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as s:
22	        s.bind(('', 0))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/ext/htmlreport/assets/simplehttpserver.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    # I guess this is SimpleHTTPServer bug
35	    webbrowser.open('http://127.0.0.1:%d' % PORT, new=2)
36	    print("serving at port", PORT)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/ext/info/__init__.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	            with open(self.output_dir + filename, 'r') as f:
21	                return f.read()
22	        except IOError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/ext/info/__init__.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
78	        with open(self.output_dir + 'info.json', 'wb') as f:
79	            f.write(json.dumps(self.test_info))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/ext/perf/__init__.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
275	        self._condition = threading.Condition()
276	        self._th = threading.Thread(target=self.continue_collect, args=(f, ))
277	        self._th.daemon = True

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
118	    pil_image.save(buf, format=format)
119	    return base64.b64encode(buf.getvalue()).decode('utf-8')
120	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:119
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
118	    pil_image.save(buf, format=format)
119	    return base64.b64encode(buf.getvalue()).decode('utf-8')
120	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	    it into OpenCV format """
167	    content = requests.get(url).content
168	    image = np.asarray(bytearray(content), dtype="uint8")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
211	    elif os.path.isfile(data):
212	        im = cv2.imread(data)
213	        if im is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
248	        """
249	        cvimage = imread(imdata)
250	        fi = findit.FindIt(engine=['template'],

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
299	def _main():
300	    ima = imread("http://localhost:17310/widgets/00006/template.jpg")
301	    imb = imread("http://localhost:17310/widgets/00007/template.jpg")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
299	def _main():
300	    ima = imread("http://localhost:17310/widgets/00006/template.jpg")
301	    imb = imread("http://localhost:17310/widgets/00007/template.jpg")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
300	    ima = imread("http://localhost:17310/widgets/00006/template.jpg")
301	    imb = imread("http://localhost:17310/widgets/00007/template.jpg")
302	    compare_ssim_debug(ima, imb, color=(0, 0, 255))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
300	    ima = imread("http://localhost:17310/widgets/00006/template.jpg")
301	    imb = imread("http://localhost:17310/widgets/00007/template.jpg")
302	    compare_ssim_debug(ima, imb, color=(0, 0, 255))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
303	    return
304	    im = imread("https://www.baidu.com/img/bd_logo1.png")
305	    assert im.shape == (258, 540, 3)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
303	    return
304	    im = imread("https://www.baidu.com/img/bd_logo1.png")
305	    assert im.shape == (258, 540, 3)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
307	
308	    im = imread("../tests/testdata/AE86.jpg")
309	    print(im.shape)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/image.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
314	
315	    taobao = imread("screenshot.jpg")
316	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/screenrecord.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
19	        while True:
20	            msg = ws.recv()
21	            if isinstance(msg, str):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/screenrecord.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
25	    finally:
26	        ws.close()
27	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/screenrecord.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
47	            while not self._stop_event.is_set():
48	                msg = ws.recv()
49	                if isinstance(msg, str):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/screenrecord.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
54	        finally:
55	            ws.close()
56	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/xpath.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
156	    def find_elements(self, xpath: Union[str, XPath]) -> List["XMLElement"]:
157	        matches = self.root.xpath(xpath, namespaces={"re": "http://exslt.org/regular-expressions"})
158	        return [XMLElement(node) for node in matches]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/uiautomator2-3.2.9/uiautomator2-3.2.9/uiautomator2/xpath.py:662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
661	        matches = root.xpath(
662	            xpath, namespaces={"re": "http://exslt.org/regular-expressions"}
663	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 4841
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 27.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 5.0
Files skipped (0):
