Run started:2025-04-12 11:19:34.932814

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	            # acquisition attempt by the same owner).
81	            _index, value = self._client.kv.get(key=self._name,
82	                                                token=self._acl_token)
83	            if value and value.get('Session') == self._session_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	                                                token=self._acl_token)
83	            if value and value.get('Session') == self._session_id:
84	                if blocking is False:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	        # Get the lock to verify the session ID's are same
108	        _index, contents = self._client.kv.get(key=self._name,
109	                                               token=self._acl_token)
110	        if not contents:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	            return False
112	        owner = contents.get('Session')
113	        if owner == self._session_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
226	        self._session_name = encodeutils.safe_decode(member_id)
227	        self._ttl = int(options.get('ttl', self.DEFAULT_TTL))
228	        namespace = options.get('namespace', self.TOOZ_NAMESPACE)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	        self._ttl = int(options.get('ttl', self.DEFAULT_TTL))
228	        namespace = options.get('namespace', self.TOOZ_NAMESPACE)
229	        self._namespace = encodeutils.safe_decode(namespace)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	        self._namespace = encodeutils.safe_decode(namespace)
230	        self._acl_token = options.get('acl_token', self.ACL_TOKEN)
231	        # the empty group name adds a trailing / needed for lookups

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
336	    def _get_group_members(self, group_path):
337	        index, data = self._client.kv.get(group_path, recurse=True)
338	        group = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
351	            groups = []
352	            index, data = self._client.kv.get(self._groups_prefix, keys=True,
353	                                              separator="/")
354	            for key in (data or []):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
479	            member_path = self._path_member(group_id, member_id)
480	            index, data = self._client.kv.get(member_path)
481	            if not data:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/consul.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
492	            member_path = self._path_member(group_id, self._member_id)
493	            index, data = self._client.kv.get(member_path)
494	            if not data:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	            url = self.get_url(url)
70	        return self.session.get(url, **kwargs).json()
71	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	    def self_stats(self):
83	        return self.session.get(self.get_url("/stats/self"))
84	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	        reply = self.client.delete(self._lock_url, make_url=False)
107	        return reply.get('errorCode') is None
108	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
137	                # We got the lock!
138	                if reply.get("errorCode") is None:
139	                    with self._lock:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	            try:
153	                reply = self.client.get(
154	                    self._lock_url +
155	                    "?wait=true&waitIndex=%d" % lastindex,
156	                    make_url=False,
157	                    timeout=watch.leftover() if watch else None)
158	            except requests.exceptions.RequestException:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	            reply = self.client.delete(lock_url, make_url=False)
169	            errorcode = reply.get("errorCode")
170	            if errorcode is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	                LOG.warning("Unable to release '%s' due to %d, %s",
176	                            self.name, errorcode, reply.get('message'))
177	        return False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	            self._node = poked['node']
192	            errorcode = poked.get("errorCode")
193	            if not errorcode:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
196	                        "extended expiry of %s seconds: %d, %s", self.name,
197	                        self.ttl, errorcode, poked.get("message"))
198	        return False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	        self.client = _Client(host=host, port=port,
250	                              protocol=options.get('protocol', 'http'))
251	        default_timeout = options.get('timeout', self.DEFAULT_TIMEOUT)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
250	                              protocol=options.get('protocol', 'http'))
251	        default_timeout = options.get('timeout', self.DEFAULT_TIMEOUT)
252	        self.lock_encoder = self.lock_encoder_cls(self.client.get_url("keys"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	        self.lock_encoder = self.lock_encoder_cls(self.client.get_url("keys"))
253	        self.lock_timeout = int(options.get('lock_timeout', default_timeout))
254	        self._acquired_locks = set()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd3gw.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
35	    """Safely encode data for consumption of the gateway."""
36	    return base64.b64encode(data).decode("ascii")
37	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/etcd3gw.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
35	    """Safely encode data for consumption of the gateway."""
36	    return base64.b64encode(data).decode("ascii")
37	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/file.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	                self._barrier.cond.wait(watch.leftover(return_none=True))
130	            self._barrier.owner = (threading.current_thread().ident,
131	                                   os.getpid(), self._member_id)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/file.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
288	        with os.fdopen(fd, "wb") as fh:
289	            fh.write(details_blob)
290	        os.rename(name, path)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/file.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
288	        with os.fdopen(fd, "wb") as fh:
289	            fh.write(details_blob)
290	        os.rename(name, path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/file.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
331	            with open(me_path, "wb") as fh:
332	                fh.write(details_blob)
333	            self._joined_groups.add(group_id)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/file.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
331	            with open(me_path, "wb") as fh:
332	                fh.write(details_blob)
333	            self._joined_groups.add(group_id)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/file.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
382	        with open(path, 'rb') as fh:
383	            details = self._load_and_validate(fh.read(), 'member')
384	            if details.get("encoded"):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/file.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
437	                with open(member_path, "rb") as fh:
438	                    contents = fh.read()
439	            except EnvironmentError as e:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/file.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
477	                    try:
478	                        shutil.rmtree(group_dir)
479	                    except EnvironmentError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/file.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
487	        with open(path, 'rb') as fh:
488	            details = self._load_and_validate(fh.read(), 'group')
489	            if details.get("encoded"):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/ipc.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
191	    def _read_group_list(self):
192	        data = self._group_list.read(byte_count=2)
193	        length = struct.unpack("H", data)[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/ipc.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
195	            return set()
196	        data = self._group_list.read(byte_count=length, offset=2)
197	        return set(msgpack.loads(data))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/ipc.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
202	            raise tooz.ToozError("Group list is too big")
203	        self._group_list.write(struct.pack('H', len(data)))
204	        self._group_list.write(data, offset=2)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/ipc.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
203	        self._group_list.write(struct.pack('H', len(data)))
204	        self._group_list.write(data, offset=2)
205	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/drivers/memcached.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
307	        self.client.delete(self._encode_member_id(self._member_id))
308	        self.client.close()
309	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/tests/drivers/test_etcd3gw.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	               'timeout': etcd3gw_driver.Etcd3Driver.DEFAULT_TIMEOUT},
39	              {'coord_url': ('etcd3+https://my_host:666?ca_cert=/my/ca_cert&'
40	                             'cert_key=/my/cert_key&cert_cert=/my/cert_cert&'
41	                             'timeout=42&api_version=v3alpha'),
42	               'protocol': 'https',
43	               'host': 'my_host',
44	               'port': 666,
45	               'ca_cert': '/my/ca_cert',
46	               'cert_key': '/my/cert_key',
47	               'cert_cert': '/my/cert_cert',
48	               'api_path': '/v3alpha/',
49	               'timeout': 42})
50	    @ddt.unpack

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tooz-6.3.0/tooz-6.3.0/tooz/utils.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
50	            name = name.encode("ascii")
51	        enc_name = base64.urlsafe_b64encode(name)
52	        return self.keyspace_url + "/" + enc_name.decode("ascii")

--------------------------------------------------

Code scanned:
	Total lines of code: 6334
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 39.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 1.0
Files skipped (0):
