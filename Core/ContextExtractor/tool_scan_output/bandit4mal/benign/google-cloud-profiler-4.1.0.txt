Run started:2025-04-12 18:59:04.042106

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	# Auth scope to use for the profiler API calls.
54	_SCOPE = ['https://www.googleapis.com/auth/monitoring.write']
55	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	
56	_GCE_METADATA_URL = 'http://metadata/computeMetadata/v1/'
57	_GCE_METADATA_HEADERS = {'Metadata-Flavor': 'Google'}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	  try:
85	    response = requests.get(url, headers=_GCE_METADATA_HEADERS)
86	    if response.status_code == requests.codes.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	        with open(service_account_json_file) as f:
127	          project_id = json.load(f).get('project_id')
128	    else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
126	        with open(service_account_json_file) as f:
127	          project_id = json.load(f).get('project_id')
128	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	
176	    service = service or os.environ.get('GAE_SERVICE') or os.environ.get(
177	        'K_SERVICE')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	
176	    service = service or os.environ.get('GAE_SERVICE') or os.environ.get(
177	        'K_SERVICE')
178	    if not service:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	    deployment_labels = {_LANGUAGE_LABEL: 'python'}
186	    service_version = service_version or os.environ.get(
187	        'GAE_VERSION') or os.environ.get('K_REVISION')
188	    if service_version:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
186	    service_version = service_version or os.environ.get(
187	        'GAE_VERSION') or os.environ.get('K_REVISION')
188	    if service_version:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
224	      self._profilers['WALL'].register_handler()
225	    self._polling_thread = threading.Thread(target=self._poll_profiler_service)
226	    self._polling_thread.name = 'Profiler API polling thread'

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
293	      profile_bytes = self._profilers[profile_type].profile(duration_ns)
294	      profile['profileBytes'] = base64.b64encode(profile_bytes).decode('UTF-8')
295	      logger.debug('Starting to upload profile')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/client.py:294
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
293	      profile_bytes = self._profilers[profile_type].profile(duration_ns)
294	      profile['profileBytes'] = base64.b64encode(profile_bytes).decode('UTF-8')
295	      logger.debug('Starting to upload profile')

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/pythonprofiler.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
97	    """
98	    signal.signal(signal.SIGALRM, self._handler)
99	    # Requires that the system restarts system calls interrupted by SIGALRM.

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/googlecloudprofiler/pythonprofiler.py:98
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
97	    """
98	    signal.signal(signal.SIGALRM, self._handler)
99	    # Requires that the system restarts system calls interrupted by SIGALRM.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/google-cloud-profiler-4.1.0/google-cloud-profiler-4.1.0/setup.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	    long_description_content_type='text/markdown',
96	    url='https://github.com/GoogleCloudPlatform/cloud-profiler-python',
97	    author='Google LLC',

--------------------------------------------------

Code scanned:
	Total lines of code: 890
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 10.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 2.0
Files skipped (0):
