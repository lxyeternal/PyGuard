Run started:2025-04-12 10:26:55.499191

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__init__.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	    igz_domain = environ["IGZ_NAMESPACE_DOMAIN"]
85	    kfp_ep = f"https://dashboard.{igz_domain}/pipelines"
86	    environ["KF_PIPELINES_UI_ENDPOINT"] = kfp_ep

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
263	        runobj.metadata.labels[mlrun_constants.MLRunInternalLabels.runner_pod] = (
264	            socket.gethostname()
265	        )

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:264
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
263	        runobj.metadata.labels[mlrun_constants.MLRunInternalLabels.runner_pod] = (
264	            socket.gethostname()
265	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
298	                with open(url_file) as fp:
299	                    body = fp.read()
300	                based = mlrun.utils.helpers.encode_user_code(body)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
317	    if from_env and code:
318	        code = b64decode(code).decode("utf-8")
319	        origin_file = pathlib.Path(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:318
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
317	    if from_env and code:
318	        code = b64decode(code).decode("utf-8")
319	        origin_file = pathlib.Path(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
355	        with open(url_file, "w") as fp:
356	            fp.write(code)
357	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
557	        with open(source) as fp:
558	            body = fp.read()
559	        based = mlrun.utils.helpers.encode_user_code(body)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
598	            with open(state_file_path, "w") as fp:
599	                fp.write(state or "none")
600	            full_image = func.full_image_path(image) or ""

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
601	            with open(image_file_path, "w") as fp:
602	                fp.write(image)
603	            with open(full_image_file_path, "w") as fp:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
603	            with open(full_image_file_path, "w") as fp:
604	                fp.write(full_image)
605	            print("Full image path = ", full_image)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
709	    with open("/tmp/output", "w") as fp:
710	        fp.write(addr)
711	    with open("/tmp/name", "w") as fp:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
711	    with open("/tmp/name", "w") as fp:
712	        fp.write(function.status.nuclio_name)
713	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/__main__.py:944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
943	    default=None,
944	    help="To create a schedule define a standard crontab expression string."
945	    "for help see: "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/artifacts/base.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
293	            with open(self.src_path, "rb") as fp:
294	                return fp.read()
295	        return mlrun.get_dataitem(self.get_target_path()).get()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/artifacts/model.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
403	            with open(src_model_path, "rb") as fp:
404	                return fp.read()
405	        target_model_path = path.join(self.spec.target_path, self.spec.model_file)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/artifacts/plots.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
70	
71	        data_uri = base64.b64encode(data).decode("utf-8")
72	        return self._TEMPLATE.format(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/artifacts/plots.py:71
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
70	
71	        data_uri = base64.b64encode(data).decode("utf-8")
72	        return self._TEMPLATE.format(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	    #  configure this values on field systems, for newer system this will be configured correctly
176	    "v3io_api": "http://v3io-webapi:8081",
177	    "redis": {
178	        "url": "",
179	        "type": "standalone",  # deprecated.
180	    },
181	    "sql": {
182	        "url": "",
183	    },
184	    "v3io_framesd": "http://framesd:8080",
185	    # default node selector to be applied to all functions - json string base64 encoded format
186	    "default_function_node_selector": "e30=",
187	    # default priority class to be applied to functions running on k8s cluster
188	    "default_function_priority_class_name": "",
189	    # valid options for priority classes - separated by a comma
190	    "valid_function_priority_class_names": "",
191	    # default path prefix for demo data and models
192	    "default_samples_path": "https://s3.wasabisys.com/iguazio/",
193	    # default path for tensorboard logs
194	    "default_tensorboard_logs_path": "/User/.tensorboard/{{project}}",
195	    # ";" separated list of notebook cell tag names to ignore e.g. "ignore-this;ignore-that"
196	    "ignored_notebook_tags": "",
197	    # when set it will force the local=True in run_function(), set to "auto" will run local if there is no k8s
198	    "force_run_local": "auto",
199	    # when set (True or non empty str) it will force the mock=True in deploy_function(),
200	    # set to "auto" will use mock of Nuclio if not detected (no nuclio_version)
201	    "mock_nuclio_deployment": "",
202	    # Configurations for `mlrun.track` - tracking runs and experiments from 3rd party vendors like MLFlow
203	    # by running them as a MLRun function, capturing their logs, results and artifacts to mlrun.
204	    "external_platform_tracking": {
205	        # General enabler for the entire tracking mechanism (all tracking services):
206	        "enabled": False,
207	        # Specific enablement and other configurations for the supported trackers:
208	        "mlflow": {
209	            # Enabler of MLFlow tracking:
210	            "enabled": True,
211	            # Whether to match the experiment name to the runtime name (sets mlflow experiment name to mlrun
212	            # context name):
213	            "match_experiment_to_runtime": False,
214	            # Whether to determine the mlflow run id before tracking starts, by doing so we can be positive that we
215	            # are tracking the correct run, this is useful especially for when we run number of runs simultaneously
216	            # in the same experiment. the default is set to false because in the process a mlflow run is created in
217	            # advance, and we want to avoid creating unnecessary runs.
218	            "control_run": False,
219	        },
220	    },
221	    "background_tasks": {
222	        # enabled / disabled
223	        "timeout_mode": "enabled",
224	        "function_deletion_batch_size": 10,
225	        # timeout in seconds to wait for background task to be updated / finished by the worker responsible for the task
226	        "default_timeouts": {
227	            "operations": {
228	                "migrations": "3600",
229	                "load_project": "60",
230	                "run_abortion": "600",
231	                "abort_grace_period": "10",
232	                "delete_project": "900",
233	                "delete_function": "900",
234	                "model_endpoint_creation": "600",
235	                "model_endpoint_tsdb_leftovers": "900",
236	            },
237	            "runtimes": {"dask": "600"},
238	            "push_notifications": "60",
239	        },
240	    },
241	    "function": {
242	        "spec": {
243	            "image_pull_secret": {"default": None},
244	            "security_context": {
245	                # default security context to be applied to all functions - json string base64 encoded format
246	                # in camelCase format: {"runAsUser": 1000, "runAsGroup": 3000}
247	                "default": "e30=",  # encoded empty dict
248	                # see mlrun.common.schemas.function.SecurityContextEnrichmentModes for available options
249	                "enrichment_mode": "disabled",
250	                # default 65534 (nogroup), set to -1 to use the user unix id or
251	                # function.spec.security_context.pipelines.kfp_pod_user_unix_id for kfp pods
252	                "enrichment_group_id": 65534,
253	                "pipelines": {
254	                    # sets the user id to be used for kfp pods when enrichment mode is not disabled
255	                    "kfp_pod_user_unix_id": 5,
256	                },
257	            },
258	            "service_account": {"default": None},
259	            "state_thresholds": {
260	                "default": {
261	                    "pending_scheduled": "1h",
262	                    "pending_not_scheduled": "-1",  # infinite
263	                    "image_pull_backoff": "1h",
264	                    "executing": "24h",
265	                }
266	            },
267	            # When the module is reloaded, the maximum depth recursion configuration for the recursive reload
268	            # function is used to prevent infinite loop
269	            "reload_max_recursion_depth": 100,
270	            "source_code_max_bytes": 10000,
271	        },
272	        "databricks": {
273	            "artifact_directory_path": "/mlrun_databricks_runtime/artifacts_dictionaries"
274	        },
275	        "application": {
276	            "default_sidecar_internal_port": 8050,
277	            "default_authentication_mode": mlrun.common.schemas.APIGatewayAuthenticationMode.none,
278	        },
279	    },
280	    # TODO: function defaults should be moved to the function spec config above
281	    "function_defaults": {
282	        "image_by_kind": {
283	            "job": "mlrun/mlrun",
284	            "serving": "mlrun/mlrun",
285	            "nuclio": "mlrun/mlrun",
286	            "remote": "mlrun/mlrun",
287	            "dask": "mlrun/ml-base",
288	            "mpijob": "mlrun/mlrun",
289	            "application": "python:3.9",
290	        },
291	        # see enrich_function_preemption_spec for more info,
292	        # and mlrun.common.schemas.function.PreemptionModes for available options
293	        "preemption_mode": "prevent",
294	    },
295	    "httpdb": {
296	        "clusterization": {
297	            # one of chief/worker
298	            "role": "chief",
299	            "chief": {
300	                # when url is specified, it takes precedence over service and port
301	                "url": "",
302	                "service": "mlrun-api-chief",
303	                "port": 8080,
304	                "feature_gates": {
305	                    "scheduler": "enabled",
306	                    "project_sync": "enabled",
307	                    "cleanup": "enabled",
308	                    "runs_monitoring": "enabled",
309	                    "pagination_cache": "enabled",
310	                    "project_summaries": "enabled",
311	                    "start_logs": "enabled",
312	                    "stop_logs": "enabled",
313	                },
314	            },
315	            "worker": {
316	                "sync_with_chief": {
317	                    # enabled / disabled
318	                    "mode": "enabled",
319	                    "interval": 15,  # seconds
320	                },
321	                "request_timeout": 45,  # seconds
322	            },
323	            # see server.py.services.api.utils.helpers.ensure_running_on_chief
324	            "ensure_function_running_on_chief_mode": "enabled",
325	        },
326	        "port": 8080,
327	        "dirpath": expanduser("~/.mlrun/db"),
328	        # in production envs we recommend to use a real db (e.g. mysql)
329	        "dsn": "sqlite:///db/mlrun.db?check_same_thread=false",
330	        "debug": False,
331	        "user": "",
332	        "password": "",
333	        "token": "",
334	        "logs_path": "./db/logs",
335	        # when set, these will replace references to the data_volume with the real_path
336	        "data_volume": "",
337	        "real_path": "",
338	        # comma delimited prefixes of paths allowed through the /files API (v3io & the real_path are always allowed).
339	        # These paths must be schemas (cannot be used for local files). For example "s3://mybucket,gcs://"
340	        "allowed_file_paths": "s3://,gcs://,gs://,az://,dbfs://,ds://",
341	        "db_type": "sqldb",
342	        "max_workers": 64,
343	        # See mlrun.common.schemas.APIStates for options
344	        "state": "online",
345	        "retry_api_call_on_exception": "enabled",
346	        "http_connection_timeout_keep_alive": 11,
347	        # http client used by httpdb
348	        "http": {
349	            # when True, the client will verify the server's TLS
350	            # set to False for backwards compatibility.
351	            "verify": True,
352	        },
353	        "db": {
354	            "commit_retry_timeout": 30,
355	            "commit_retry_interval": 3,
356	            "conflict_retry_timeout": 15,
357	            "conflict_retry_interval": None,
358	            # Whether to perform data migrations on initialization. enabled or disabled
359	            "data_migrations_mode": "enabled",
360	            # Whether to perform database migration from sqlite to mysql on initialization
361	            "database_migration_mode": "enabled",
362	            "backup": {
363	                # Whether to use db backups on initialization
364	                "mode": "enabled",
365	                "file_format": "db_backup_%Y%m%d%H%M.db",
366	                "use_rotation": True,
367	                "rotation_limit": 3,
368	                # default is 16MB, max 1G, for more info https://dev.mysql.com/doc/refman/8.0/en/packet-too-large.html
369	                "max_allowed_packet": 64000000,  # 64MB
370	            },
371	            # tests connections for liveness upon each checkout
372	            "connections_pool_pre_ping": True,
373	            # this setting causes the pool to recycle connections after the given number of seconds has passed
374	            "connections_pool_recycle": 60 * 60,
375	            # None defaults to httpdb.max_workers
376	            "connections_pool_size": None,
377	            "connections_pool_max_overflow": None,
378	            # below is a db-specific configuration
379	            "mysql": {
380	                # comma separated mysql modes (globally) to set on runtime
381	                # optional values (as per https://dev.mysql.com/doc/refman/8.0/en/sql-mode.html#sql-mode-full):
382	                #
383	                # if set to "nil" or "none", nothing would be set
384	                "modes": (
385	                    "STRICT_TRANS_TABLES"
386	                    ",NO_ZERO_IN_DATE"
387	                    ",NO_ZERO_DATE"
388	                    ",ERROR_FOR_DIVISION_BY_ZERO"
389	                    ",NO_ENGINE_SUBSTITUTION",
390	                )
391	            },
392	        },
393	        "jobs": {
394	            # whether to allow to run local runtimes in the API - configurable to allow the scheduler testing to work
395	            "allow_local_run": False,
396	        },
397	        "authentication": {
398	            "mode": "none",  # one of none, basic, bearer, iguazio
399	            "basic": {"username": "", "password": ""},
400	            "bearer": {"token": ""},
401	            "iguazio": {
402	                "session_verification_endpoint": "data_sessions/verifications/app_service",
403	            },
404	        },
405	        "nuclio": {
406	            # One of ClusterIP | NodePort
407	            "default_service_type": "NodePort",
408	            # The following modes apply when user did not configure an ingress
409	            #
410	            #   name        |  description
411	            #  ---------------------------------------------------------------------
412	            #   never       |  never enrich with an ingress
413	            #   always      |  always enrich with an ingress, regardless the service type
414	            #   onClusterIP |  enrich with an ingress only when `mlrun.config.httpdb.nuclio.default_service_type`
415	            #                  is set to ClusterIP
416	            #  ---------------------------------------------------------------------
417	            # Note: adding a mode requires special handling on
418	            # - mlrun.common.runtimes.constants.NuclioIngressAddTemplatedIngressModes
419	            # - mlrun.runtimes.nuclio.function.enrich_function_with_ingress
420	            "add_templated_ingress_host_mode": "never",
421	            "explicit_ack": "enabled",
422	            # size of serving spec to move to config maps
423	            "serving_spec_env_cutoff": 0,
424	        },
425	        "logs": {
426	            "decode": {
427	                # Replace with a replacement marker. Uses � (U+FFFD, the official REPLACEMENT CHARACTER).
428	                # see https://docs.python.org/3/library/codecs.html#error-handlers for more info and options
429	                "errors": "replace",
430	            },
431	            "pipelines": {
432	                # pull state mode was introduced to have a way to pull the state of a run which was spawned by a
433	                # pipeline step instead of pulling the state by getting the run logs
434	                "pull_state": {
435	                    # enabled - pull state of a run every "pull_state_interval" seconds and pull logs every
436	                    # "pull_logs_interval" seconds
437	                    # disabled - pull logs every "pull_logs_default_interval" seconds
438	                    "mode": "disabled",
439	                    # those params are used when mode is enabled
440	                    "pull_logs_interval": 30,  # seconds
441	                    "pull_state_interval": 5,  # seconds
442	                },
443	            },
444	            "nuclio": {
445	                # setting interval to a higher interval than regular jobs / build, because pulling the retrieved logs
446	                # from nuclio for the deploy status doesn't include the actual live "builder" container logs, but
447	                # rather a high level status
448	                "pull_deploy_status_default_interval": 10  # seconds
449	            },
450	            # this is the default interval period for pulling logs, if not specified different timeout interval
451	            "pull_logs_default_interval": 3,  # seconds
452	            "pull_logs_backoff_no_logs_default_interval": 10,  # seconds
453	            "pull_logs_default_size_limit": 1024 * 1024,  # 1 MB
454	        },
455	        "authorization": {
456	            "mode": "none",  # one of none, opa
457	            "opa": {
458	                "address": "",
459	                "request_timeout": 10,
460	                "permission_query_path": "",
461	                "permission_filter_path": "",
462	                "log_level": 0,
463	            },
464	        },
465	        "scheduling": {
466	            # the minimum interval that will be allowed between two scheduled jobs - e.g. a job wouldn't be
467	            # allowed to be scheduled to run more than 2 times in X. Can't be less than 1 minute, "0" to disable
468	            "min_allowed_interval": "10 minutes",
469	            "default_concurrency_limit": 1,
470	            # Firing our jobs include things like creating pods which might not be instant, therefore in the case of
471	            # multiple schedules scheduled to the same time, there might be delays, the default of the scheduler for
472	            # misfire_grace_time is 1 second, we do not want jobs not being scheduled because of the delays so setting
473	            # it to None. the default for coalesce it True just adding it here to be explicit
474	            "scheduler_config": '{"job_defaults": {"misfire_grace_time": null, "coalesce": true}}',
475	        },
476	        "projects": {
477	            "leader": "mlrun",
478	            "retry_leader_request_on_exception": "enabled",
479	            "followers": "",
480	            # This is used as the interval for the sync loop both when mlrun is leader and follower
481	            "periodic_sync_interval": "1 minute",
482	            "project_owners_cache_ttl": "30 seconds",
483	            # access key to be used when the leader is iguazio and polling is done from it
484	            "iguazio_access_key": "",
485	            "iguazio_list_projects_default_page_size": 200,
486	            "iguazio_client_job_cache_ttl": "20 minutes",
487	            "nuclio_project_deletion_verification_timeout": "300 seconds",
488	            "nuclio_project_deletion_verification_interval": "5 seconds",
489	            "summaries": {
490	                # Number of days back to include when calculating the project pipeline summary.
491	                "list_pipelines_time_period_in_days": 7,
492	            },
493	        },
494	        # The API needs to know what is its k8s svc url so it could enrich it in the jobs it creates
495	        "api_url": "",
496	        "builder": {
497	            # setting the docker registry to be used for built images, can include the repository as well, e.g.
498	            # index.docker.io/<username>, if not included repository will default to mlrun
499	            "docker_registry": "",
500	            # dockerconfigjson type secret to attach to kaniko pod.
501	            # For amazon ECR, the secret is expected to provide AWS credentials. Leave empty to use EC2 IAM policy.
502	            # https://github.com/GoogleContainerTools/kaniko#pushing-to-amazon-ecr
503	            "docker_registry_secret": "",
504	            # whether to allow the docker registry we're pulling from to be insecure. "enabled", "disabled" or "auto"
505	            # which will resolve by the existence of secret
506	            "insecure_pull_registry_mode": "auto",
507	            # whether to allow the docker registry we're pushing to, to be insecure. "enabled", "disabled" or "auto"
508	            # which will resolve by the existence of secret
509	            "insecure_push_registry_mode": "auto",
510	            # the requirement specifier used by the builder when installing mlrun in images when it runs
511	            # pip install <requirement_specifier>, e.g. mlrun==0.5.4, mlrun~=0.5,
512	            # git+https://github.com/mlrun/mlrun@development. by default uses the version
513	            "mlrun_version_specifier": "",
514	            "kaniko_image": "gcr.io/kaniko-project/executor:v1.23.2",  # kaniko builder image
515	            "kaniko_init_container_image": "alpine:3.18",
516	            # image for kaniko init container when docker registry is ECR
517	            "kaniko_aws_cli_image": "amazon/aws-cli:2.17.16",
518	            # kaniko sometimes fails to get filesystem from image, this is a workaround to retry the process
519	            # a known issue in Kaniko - https://github.com/GoogleContainerTools/kaniko/issues/1717
520	            "kaniko_image_fs_extraction_retries": "3",
521	            # kaniko sometimes fails to push image to registry due to network issues
522	            "kaniko_image_push_retry": "3",
523	            # additional docker build args in json encoded base64 format
524	            "build_args": "",
525	            "pip_ca_secret_name": "",
526	            "pip_ca_secret_key": "",
527	            "pip_ca_path": "/etc/ssl/certs/mlrun/pip-ca-certificates.crt",
528	            # template for the prefix that the function target image will be enforced to have (as long as it's targeted
529	            # to be in the configured registry). Supported template values are: {project} {name}
530	            "function_target_image_name_prefix_template": "func-{project}-{name}",
531	            "pip_version": "~=23.0",
532	        },
533	        "v3io_api": "",
534	        "v3io_framesd": "",
535	        # If running from sdk and MLRUN_DBPATH is not set, the db will fallback to a nop db which will not preform any
536	        # run db operations.
537	        "nop_db": {
538	            # if set to true, will raise an error for trying to use run db functionality
539	            # if set to false, will use a nop db which will not preform any run db operations
540	            "raise_error": False,
541	            # if set to true, will log a warning for trying to use run db functionality while in nop db mode
542	            "verbose": True,
543	        },
544	        "pagination": {
545	            "default_page_size": 200,
546	            "page_limit": 1000000,
547	            "page_size_limit": 1000000,
548	            "pagination_cache": {
549	                "interval": 60,
550	                "ttl": 3600,
551	                "max_size": 10000,
552	            },
553	        },
554	    },
555	    "model_endpoint_monitoring": {
556	        # Scaling Rule
557	        # The fundamental scaling rule to maintain is: Shards/Partitions = Replicas * Workers
558	        # In other words, the number of shards (V3IO) or partitions (Kafka) must be equal to the
559	        # total number of worker processes across all pods.
560	        "serving_stream": {
561	            "v3io": {
562	                "shard_count": 2,
563	                "retention_period_hours": 24,
564	                "num_workers": 1,
565	                "min_replicas": 2,
566	                "max_replicas": 2,
567	            },
568	            "kafka": {
569	                "partition_count": 8,
570	                "replication_factor": 1,
571	                "num_workers": 2,
572	                "min_replicas": 1,
573	                "max_replicas": 4,
574	            },
575	        },
576	        "application_stream_args": {
577	            "v3io": {
578	                "shard_count": 4,
579	                "retention_period_hours": 24,
580	                "num_workers": 4,
581	                "min_replicas": 1,
582	                "max_replicas": 1,
583	            },
584	            "kafka": {
585	                "partition_count": 4,
586	                "replication_factor": 1,
587	                "num_workers": 4,
588	                "min_replicas": 1,
589	                "max_replicas": 1,
590	            },
591	        },
592	        "writer_stream_args": {
593	            "v3io": {
594	                "shard_count": 1,
595	                "retention_period_hours": 24,
596	                "num_workers": 1,
597	                "min_replicas": 1,
598	                "max_replicas": 1,
599	            },
600	            "kafka": {
601	                "partition_count": 1,
602	                # TODO: add retention period configuration
603	                "replication_factor": 1,
604	                "num_workers": 1,
605	                "min_replicas": 1,
606	                "max_replicas": 1,
607	            },
608	        },
609	        "controller_stream_args": {
610	            "v3io": {
611	                "shard_count": 10,
612	                "retention_period_hours": 24,
613	                "num_workers": 10,
614	                "min_replicas": 1,
615	                "max_replicas": 1,
616	            },
617	            "kafka": {
618	                "partition_count": 10,
619	                "replication_factor": 1,
620	                "num_workers": 10,
621	                "min_replicas": 1,
622	                "max_replicas": 1,
623	            },
624	        },
625	        # Store prefixes are used to handle model monitoring storing policies based on project and kind, such as events,
626	        # stream, and endpoints.
627	        "store_prefixes": {
628	            "default": "v3io:///users/pipelines/{project}/model-endpoints/{kind}",
629	            "user_space": "v3io:///projects/{project}/model-endpoints/{kind}",
630	            "monitoring_application": "v3io:///users/pipelines/{project}/monitoring-apps/",
631	        },
632	        # Offline storage path can be either relative or a full path. This path is used for general offline data
633	        # storage such as the parquet file which is generated from the monitoring stream function for the drift analysis
634	        "offline_storage_path": "model-endpoints/{kind}",
635	        "parquet_batching_max_events": 10_000,
636	        "parquet_batching_timeout_secs": timedelta(minutes=1).total_seconds(),
637	        "tdengine": {
638	            "run_directly": True,
639	            # timeout and retry are ignored when run_directly is set to True
640	            "timeout": 10,
641	            "retries": 1,
642	        },
643	    },
644	    "secret_stores": {
645	        # Use only in testing scenarios (such as integration tests) to avoid using k8s for secrets (will use in-memory
646	        # "secrets")
647	        "test_mode_mock_secrets": False,
648	        "vault": {
649	            # URLs to access Vault. For example, in a local env (Minikube on Mac) these would be:
650	            # http://docker.for.mac.localhost:8200
651	            "url": "",
652	            "remote_url": "",
653	            "role": "",
654	            "token_path": "~/.mlrun/vault",
655	            "project_service_account_name": "mlrun-vault-{project}",
656	            "token_ttl": 180000,
657	            # This config is for debug/testing purposes only!
658	            "user_token": "",
659	        },
660	        "azure_vault": {
661	            "url": "https://{name}.vault.azure.net",
662	            "default_secret_name": None,
663	            "secret_path": "~/.mlrun/azure_vault",
664	        },
665	        "kubernetes": {
666	            # When this is True (the default), all project secrets will be automatically added to each job,
667	            # unless user asks for a specific list of secrets.
668	            "auto_add_project_secrets": True,
669	            "project_secret_name": "mlrun-project-secrets-{project}",
670	            "auth_secret_name": "mlrun-auth-secrets.{hashed_access_key}",
671	            "env_variable_prefix": "",
672	            "global_function_env_secret_name": None,
673	        },
674	    },
675	    "feature_store": {
676	        "data_prefixes": {
677	            "default": "v3io:///projects/{project}/FeatureStore/{name}/{kind}",
678	            "nosql": "v3io:///projects/{project}/FeatureStore/{name}/nosql",
679	            # "authority" is optional and generalizes [userinfo "@"] host [":" port]
680	            "redisnosql": "redis://{authority}/projects/{project}/FeatureStore/{name}/nosql",
681	            "dsnosql": "ds://{ds_profile_name}/projects/{project}/FeatureStore/{name}/{kind}",
682	        },
683	        "default_targets": "parquet,nosql",
684	        "default_job_image": "mlrun/mlrun",
685	        "flush_interval": None,
686	    },
687	    "ui": {
688	        "projects_prefix": "projects",  # The UI link prefix for projects
689	        "url": "",  # remote/external mlrun UI url (for hyperlinks)
690	    },
691	    "hub": {
692	        "k8s_secrets_project_name": "-hub-secrets",
693	        "catalog_filename": "catalog.json",
694	        "default_source": {
695	            # Set false to avoid creating a global source (for example in a dark site)
696	            "create": True,
697	            "name": "default",
698	            "description": "MLRun global function hub",
699	            "url": "https://mlrun.github.io/marketplace",
700	            "object_type": "functions",
701	            "channel": "master",
702	        },
703	    },
704	    "storage": {
705	        # What type of auto-mount to use for functions. One of: none, auto, v3io_credentials, v3io_fuse, pvc, s3, env.
706	        # Default is auto - which is v3io_credentials when running on Iguazio. If not Iguazio: pvc if the
707	        # MLRUN_PVC_MOUNT env is configured or auto_mount_params contain "pvc_name". Otherwise will do nothing (none).
708	        "auto_mount_type": "auto",
709	        # Extra parameters to pass to the mount call (will be passed as kwargs). Parameters can be either:
710	        # 1. A string of comma-separated parameters, using this format: "param1=value1,param2=value2"
711	        # 2. A base-64 encoded json dictionary containing the list of parameters
712	        "auto_mount_params": "",
713	        # map file data items starting with virtual path to the real path, used when consumers have different mounts
714	        # e.g. Windows client (on host) and Linux container (Jupyter, Nuclio..) need to access the same files/artifacts
715	        # need to map container path to host windows paths, e.g. "\data::c:\\mlrun_data" ("::" used as splitter)
716	        "item_to_real_path": "",
717	    },
718	    "default_function_pod_resources": {
719	        "requests": {"cpu": None, "memory": None, "gpu": None},
720	        "limits": {"cpu": None, "memory": None, "gpu": None},
721	    },
722	    "default_spark_resources": {
723	        "driver": {
724	            "requests": {"cpu": "1", "memory": "2g"},
725	            "limits": {"cpu": "2", "memory": "2g"},
726	        },
727	        "executor": {
728	            "requests": {"cpu": "1", "memory": "5g"},
729	            "limits": {"cpu": "2", "memory": "5g"},
730	        },
731	    },
732	    # preemptible node selector and tolerations to be added when running on spot nodes
733	    "preemptible_nodes": {
734	        # encoded empty dict
735	        "node_selector": "e30=",
736	        # encoded empty list
737	        "tolerations": "W10=",
738	    },
739	    "http_retry_defaults": {
740	        "max_retries": 3,
741	        "backoff_factor": 1,
742	        "status_codes": [500, 502, 503, 504],
743	    },
744	    "ce": {
745	        # ce mode can be one of: "", lite, full
746	        "mode": "",
747	        # not possible to call this "version" because the Config class has a "version" property
748	        # which returns the version from the version.json file
749	        "release": "",
750	    },
751	    "debug": {
752	        "expose_internal_api_endpoints": False,
753	    },
754	    "workflows": {
755	        "default_workflow_runner_name": "workflow-runner-{}",
756	        "concurrent_delete_worker_count": 20,
757	        # Default timeout seconds for retrieving workflow id after execution
758	        # Remote workflow timeout is the maximum between remote and the inner engine timeout
759	        "timeouts": {"local": 120, "kfp": 60, "remote": 60 * 5},
760	    },
761	    "log_collector": {
762	        "address": "localhost:8282",
763	        # log collection mode can be one of: "sidecar", "legacy", "best-effort"
764	        # "sidecar" - use the sidecar to collect logs
765	        # "legacy" - use the legacy log collection method (logs are collected straight from the pod)
766	        # "best-effort" - use the sidecar, but if for some reason it's not available use the legacy method
767	        # note that this mode also effects the log querying method as well, meaning if the mode is "best-effort"
768	        # the log query will try to use the sidecar first and if it's not available it will use the legacy method
769	        # TODO: once this is changed to "sidecar" by default, also change in common_fixtures.py
770	        "mode": "legacy",
771	        # interval for collecting and sending runs which require their logs to be collected
772	        "periodic_start_log_interval": 10,
773	        "failed_runs_grace_period": 3600,
774	        "verbose": True,
775	        # the number of workers which will be used to trigger the start log collection
776	        "concurrent_start_logs_workers": 50,
777	        # the number of runs for which to start logs on api startup
778	        "start_logs_startup_run_limit": 150,
779	        # the time in hours in which to start log collection from.
780	        # after upgrade, we might have runs which completed in the mean time or still in non-terminal state and
781	        # we want to collect their logs in the new log collection method (sidecar)
782	        # default is 4 hours = 4*60*60 = 14400 seconds
783	        "api_downtime_grace_period": 14400,
784	        "get_logs": {
785	            # the number of retries to get logs from the log collector
786	            "max_retries": 3,
787	        },
788	        # interval for stopping log collection for runs which are in a terminal state
789	        "stop_logs_interval": 3600,
790	    },
791	    # Configurations for the `mlrun.package` sub-package involving packagers - logging returned outputs and parsing
792	    # inputs data items:
793	    "packagers": {
794	        # Whether to enable packagers. True will wrap each run in the `mlrun.package.handler` decorator to log and parse
795	        # using packagers.
796	        "enabled": True,
797	        # Whether to treat returned tuples from functions as a tuple and not as multiple returned items. If True, all
798	        # returned values will be packaged together as the tuple they are returned in. Default is False to enable
799	        # logging multiple returned items.
800	        "pack_tuples": False,
801	        # In multi-workers run, only the logging worker will pack the outputs and log the results and artifacts.
802	        # Otherwise, the workers will log the results and artifacts using the same keys, overriding them. It is common
803	        # that only the main worker (usualy rank 0) will log, so this is the default value.
804	        "logging_worker": 0,
805	        # TODO: Consider adding support for logging from all workers (ignoring the `logging_worker`) and add the worker
806	        #       number to the artifact / result key (like "<key>-rank<#>". Results can have reduce operation in the
807	        #       log hint to average / min / max them across all the workers (default operation should be average).
808	    },
809	    # Events are currently (and only) used to audit changes and record access to MLRun entities (such as secrets)
810	    "events": {
811	        # supported modes "enabled", "disabled".
812	        # "enabled" - events are emitted.
813	        # "disabled" - a nop client is used (aka doing nothing).
814	        "mode": "disabled",
815	        "verbose": False,
816	        # used for igz client when emitting events
817	        "access_key": "",
818	    },
819	    "grafana_url": "",
820	    "alerts": {
821	        # supported modes: "enabled", "disabled".
822	        "mode": "enabled",
823	        # maximum number of alerts we allow to be configured.
824	        # user will get an error when exceeding this
825	        "max_allowed": 20000,
826	        # maximum allowed value for count in criteria field inside AlertConfig
827	        "max_criteria_count": 100,
828	        # interval for periodic events generation job
829	        "events_generation_interval": 30,  # seconds
830	        # number of alerts to delete in each chunk
831	        "chunk_size_during_project_deletion": 100,
832	        # maximum allowed alert config cache size in alert's CRUD
833	        # for the best performance, it is recommended to set this value to the maximum number of alerts
834	        "max_allowed_cache_size": 20000,
835	        # default limit for listing alert configs
836	        "default_list_alert_configs_limit": 2000,
837	    },
838	    "auth_with_client_id": {
839	        "enabled": False,
840	        "request_timeout": 5,
841	    },
842	    "services": {
843	        # The running service name. One of: "api", "alerts"
844	        "service_name": "api",
845	        "hydra": {
846	            # Comma separated list of services to run on the instance.
847	            # Currently, this is only considered when the service_name is "api".
848	            # "*" starts all services on the same instance,
849	            # other options are considered as running only the api service.
850	            "services": "*",
851	        },
852	    },
853	    "notifications": {
854	        "smtp": {
855	            "config_secret_name": "mlrun-smtp-config",
856	            "refresh_interval": "30",
857	        }
858	    },
859	    "system_id": "",
860	}
861	_is_running_as_api = None
862	
863	
864	def is_running_as_api():
865	    # MLRUN_IS_API_SERVER is set when running the api server which is being done through the CLI command mlrun db
866	    global _is_running_as_api
867	
868	    if _is_running_as_api is None:
869	        _is_running_as_api = os.getenv("MLRUN_IS_API_SERVER", "false").lower() == "true"
870	
871	    return _is_running_as_api
872	
873	
874	class Config:
875	    _missing = object()
876	
877	    def __init__(self, cfg=None):
878	        cfg = {} if cfg is None else cfg
879	
880	        # Can't use self._cfg = cfg → infinite recursion
881	        object.__setattr__(self, "_cfg", cfg)
882	
883	    def __getattr__(self, attr):
884	        val = self._cfg.get(attr, self._missing)
885	        if val is self._missing:
886	            raise AttributeError(attr)
887	
888	        if isinstance(val, Mapping):
889	            return self.__class__(val)
890	        return val
891	
892	    def __deepcopy__(self, memo):
893	        cls = self.__class__
894	        # create a new Config without calling __init__ (avoid recursion)
895	        result = cls.__new__(cls)
896	        # manually deep-copy _cfg
897	        object.__setattr__(result, "_cfg", copy.deepcopy(self._cfg, memo))
898	        return result
899	
900	    def __setattr__(self, attr, value):
901	        # in order for the dbpath setter to work
902	        if attr == "dbpath":
903	            super().__setattr__(attr, value)
904	        else:
905	            self._cfg[attr] = value
906	
907	    def __dir__(self):
908	        return list(self._cfg) + dir(self.__class__)
909	
910	    def __repr__(self):
911	        name = self.__class__.__name__
912	        return f"{name}({self._cfg!r})"
913	
914	    def __iter__(self):
915	        if isinstance(self._cfg, Mapping):
916	            return self._cfg.__iter__()
917	
918	    def items(self):
919	        if isinstance(self._cfg, Mapping):
920	            return iter(self._cfg.items())
921	
922	    def keys(self):
923	        if isinstance(self._cfg, Mapping):
924	            return iter(self.data.keys())
925	
926	    def values(self):
927	        if isinstance(self._cfg, Mapping):
928	            return iter(self.data.values())
929	
930	    def update(self, cfg, skip_errors=False):
931	        for key, value in cfg.items():
932	            if hasattr(self, key):
933	                if isinstance(value, dict):
934	                    # ignore the `skip_errors` flag here
935	                    # if the key does not align with what mlrun config expects it is a user
936	                    # input error that can lead to unexpected behavior.
937	                    # raise the exception to ensure configuration is loaded correctly and do not
938	                    # ignore any errors.
939	                    config_value = getattr(self, key)
940	                    try:
941	                        config_value.update(value)
942	                    except AttributeError as exc:
943	                        if not isinstance(config_value, (dict, Config)):
944	                            raise ValueError(
945	                                f"Can not update `{key}` config. "
946	                                f"Expected a configuration but received {type(value)}"
947	                            ) from exc
948	                        raise exc
949	                else:
950	                    try:
951	                        setattr(self, key, value)
952	                    except mlrun.errors.MLRunRuntimeError as exc:
953	                        if not skip_errors:
954	                            raise exc
955	                        print(
956	                            f"Warning, failed to set config key {key}={value}, {mlrun.errors.err_to_str(exc)}"
957	                        )
958	
959	    def dump_yaml(self, stream=None):
960	        return yaml.dump(self._cfg, stream, default_flow_style=False)
961	
962	    @classmethod
963	    def from_dict(cls, dict_):
964	        return cls(copy.deepcopy(dict_))
965	
966	    @staticmethod
967	    def get_build_args():
968	        build_args = {}
969	        if config.httpdb.builder.build_args:
970	            build_args_json = base64.b64decode(
971	                config.httpdb.builder.build_args
972	            ).decode()
973	            build_args = json.loads(build_args_json)
974	
975	        return build_args
976	
977	    @staticmethod
978	    def is_pip_ca_configured():
979	        return (
980	            config.httpdb.builder.pip_ca_secret_name
981	            and config.httpdb.builder.pip_ca_secret_key
982	            and config.httpdb.builder.pip_ca_path
983	        )
984	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	    },
184	    "v3io_framesd": "http://framesd:8080",
185	    # default node selector to be applied to all functions - json string base64 encoded format
186	    "default_function_node_selector": "e30=",
187	    # default priority class to be applied to functions running on k8s cluster
188	    "default_function_priority_class_name": "",
189	    # valid options for priority classes - separated by a comma
190	    "valid_function_priority_class_names": "",
191	    # default path prefix for demo data and models
192	    "default_samples_path": "https://s3.wasabisys.com/iguazio/",
193	    # default path for tensorboard logs
194	    "default_tensorboard_logs_path": "/User/.tensorboard/{{project}}",
195	    # ";" separated list of notebook cell tag names to ignore e.g. "ignore-this;ignore-that"
196	    "ignored_notebook_tags": "",
197	    # when set it will force the local=True in run_function(), set to "auto" will run local if there is no k8s
198	    "force_run_local": "auto",
199	    # when set (True or non empty str) it will force the mock=True in deploy_function(),
200	    # set to "auto" will use mock of Nuclio if not detected (no nuclio_version)
201	    "mock_nuclio_deployment": "",
202	    # Configurations for `mlrun.track` - tracking runs and experiments from 3rd party vendors like MLFlow
203	    # by running them as a MLRun function, capturing their logs, results and artifacts to mlrun.
204	    "external_platform_tracking": {
205	        # General enabler for the entire tracking mechanism (all tracking services):
206	        "enabled": False,
207	        # Specific enablement and other configurations for the supported trackers:
208	        "mlflow": {
209	            # Enabler of MLFlow tracking:
210	            "enabled": True,
211	            # Whether to match the experiment name to the runtime name (sets mlflow experiment name to mlrun
212	            # context name):
213	            "match_experiment_to_runtime": False,
214	            # Whether to determine the mlflow run id before tracking starts, by doing so we can be positive that we
215	            # are tracking the correct run, this is useful especially for when we run number of runs simultaneously
216	            # in the same experiment. the default is set to false because in the process a mlflow run is created in
217	            # advance, and we want to avoid creating unnecessary runs.
218	            "control_run": False,
219	        },
220	    },
221	    "background_tasks": {
222	        # enabled / disabled
223	        "timeout_mode": "enabled",
224	        "function_deletion_batch_size": 10,
225	        # timeout in seconds to wait for background task to be updated / finished by the worker responsible for the task
226	        "default_timeouts": {
227	            "operations": {
228	                "migrations": "3600",
229	                "load_project": "60",
230	                "run_abortion": "600",
231	                "abort_grace_period": "10",
232	                "delete_project": "900",
233	                "delete_function": "900",
234	                "model_endpoint_creation": "600",
235	                "model_endpoint_tsdb_leftovers": "900",
236	            },
237	            "runtimes": {"dask": "600"},
238	            "push_notifications": "60",
239	        },
240	    },
241	    "function": {
242	        "spec": {
243	            "image_pull_secret": {"default": None},
244	            "security_context": {
245	                # default security context to be applied to all functions - json string base64 encoded format
246	                # in camelCase format: {"runAsUser": 1000, "runAsGroup": 3000}
247	                "default": "e30=",  # encoded empty dict
248	                # see mlrun.common.schemas.function.SecurityContextEnrichmentModes for available options
249	                "enrichment_mode": "disabled",
250	                # default 65534 (nogroup), set to -1 to use the user unix id or
251	                # function.spec.security_context.pipelines.kfp_pod_user_unix_id for kfp pods
252	                "enrichment_group_id": 65534,
253	                "pipelines": {
254	                    # sets the user id to be used for kfp pods when enrichment mode is not disabled
255	                    "kfp_pod_user_unix_id": 5,
256	                },
257	            },
258	            "service_account": {"default": None},
259	            "state_thresholds": {
260	                "default": {
261	                    "pending_scheduled": "1h",
262	                    "pending_not_scheduled": "-1",  # infinite
263	                    "image_pull_backoff": "1h",
264	                    "executing": "24h",
265	                }
266	            },
267	            # When the module is reloaded, the maximum depth recursion configuration for the recursive reload
268	            # function is used to prevent infinite loop
269	            "reload_max_recursion_depth": 100,
270	            "source_code_max_bytes": 10000,
271	        },
272	        "databricks": {
273	            "artifact_directory_path": "/mlrun_databricks_runtime/artifacts_dictionaries"
274	        },
275	        "application": {
276	            "default_sidecar_internal_port": 8050,
277	            "default_authentication_mode": mlrun.common.schemas.APIGatewayAuthenticationMode.none,
278	        },
279	    },
280	    # TODO: function defaults should be moved to the function spec config above
281	    "function_defaults": {
282	        "image_by_kind": {
283	            "job": "mlrun/mlrun",
284	            "serving": "mlrun/mlrun",
285	            "nuclio": "mlrun/mlrun",
286	            "remote": "mlrun/mlrun",
287	            "dask": "mlrun/ml-base",
288	            "mpijob": "mlrun/mlrun",
289	            "application": "python:3.9",
290	        },
291	        # see enrich_function_preemption_spec for more info,
292	        # and mlrun.common.schemas.function.PreemptionModes for available options
293	        "preemption_mode": "prevent",
294	    },
295	    "httpdb": {
296	        "clusterization": {
297	            # one of chief/worker
298	            "role": "chief",
299	            "chief": {
300	                # when url is specified, it takes precedence over service and port
301	                "url": "",
302	                "service": "mlrun-api-chief",
303	                "port": 8080,
304	                "feature_gates": {
305	                    "scheduler": "enabled",
306	                    "project_sync": "enabled",
307	                    "cleanup": "enabled",
308	                    "runs_monitoring": "enabled",
309	                    "pagination_cache": "enabled",
310	                    "project_summaries": "enabled",
311	                    "start_logs": "enabled",
312	                    "stop_logs": "enabled",
313	                },
314	            },
315	            "worker": {
316	                "sync_with_chief": {
317	                    # enabled / disabled
318	                    "mode": "enabled",
319	                    "interval": 15,  # seconds
320	                },
321	                "request_timeout": 45,  # seconds
322	            },
323	            # see server.py.services.api.utils.helpers.ensure_running_on_chief
324	            "ensure_function_running_on_chief_mode": "enabled",
325	        },
326	        "port": 8080,
327	        "dirpath": expanduser("~/.mlrun/db"),
328	        # in production envs we recommend to use a real db (e.g. mysql)
329	        "dsn": "sqlite:///db/mlrun.db?check_same_thread=false",
330	        "debug": False,
331	        "user": "",
332	        "password": "",
333	        "token": "",
334	        "logs_path": "./db/logs",
335	        # when set, these will replace references to the data_volume with the real_path
336	        "data_volume": "",
337	        "real_path": "",
338	        # comma delimited prefixes of paths allowed through the /files API (v3io & the real_path are always allowed).
339	        # These paths must be schemas (cannot be used for local files). For example "s3://mybucket,gcs://"
340	        "allowed_file_paths": "s3://,gcs://,gs://,az://,dbfs://,ds://",
341	        "db_type": "sqldb",
342	        "max_workers": 64,
343	        # See mlrun.common.schemas.APIStates for options
344	        "state": "online",
345	        "retry_api_call_on_exception": "enabled",
346	        "http_connection_timeout_keep_alive": 11,
347	        # http client used by httpdb
348	        "http": {
349	            # when True, the client will verify the server's TLS
350	            # set to False for backwards compatibility.
351	            "verify": True,
352	        },
353	        "db": {
354	            "commit_retry_timeout": 30,
355	            "commit_retry_interval": 3,
356	            "conflict_retry_timeout": 15,
357	            "conflict_retry_interval": None,
358	            # Whether to perform data migrations on initialization. enabled or disabled
359	            "data_migrations_mode": "enabled",
360	            # Whether to perform database migration from sqlite to mysql on initialization
361	            "database_migration_mode": "enabled",
362	            "backup": {
363	                # Whether to use db backups on initialization
364	                "mode": "enabled",
365	                "file_format": "db_backup_%Y%m%d%H%M.db",
366	                "use_rotation": True,
367	                "rotation_limit": 3,
368	                # default is 16MB, max 1G, for more info https://dev.mysql.com/doc/refman/8.0/en/packet-too-large.html
369	                "max_allowed_packet": 64000000,  # 64MB
370	            },
371	            # tests connections for liveness upon each checkout
372	            "connections_pool_pre_ping": True,
373	            # this setting causes the pool to recycle connections after the given number of seconds has passed
374	            "connections_pool_recycle": 60 * 60,
375	            # None defaults to httpdb.max_workers
376	            "connections_pool_size": None,
377	            "connections_pool_max_overflow": None,
378	            # below is a db-specific configuration
379	            "mysql": {
380	                # comma separated mysql modes (globally) to set on runtime
381	                # optional values (as per https://dev.mysql.com/doc/refman/8.0/en/sql-mode.html#sql-mode-full):
382	                #
383	                # if set to "nil" or "none", nothing would be set
384	                "modes": (
385	                    "STRICT_TRANS_TABLES"
386	                    ",NO_ZERO_IN_DATE"
387	                    ",NO_ZERO_DATE"
388	                    ",ERROR_FOR_DIVISION_BY_ZERO"
389	                    ",NO_ENGINE_SUBSTITUTION",
390	                )
391	            },
392	        },
393	        "jobs": {
394	            # whether to allow to run local runtimes in the API - configurable to allow the scheduler testing to work
395	            "allow_local_run": False,
396	        },
397	        "authentication": {
398	            "mode": "none",  # one of none, basic, bearer, iguazio
399	            "basic": {"username": "", "password": ""},
400	            "bearer": {"token": ""},
401	            "iguazio": {
402	                "session_verification_endpoint": "data_sessions/verifications/app_service",
403	            },
404	        },
405	        "nuclio": {
406	            # One of ClusterIP | NodePort
407	            "default_service_type": "NodePort",
408	            # The following modes apply when user did not configure an ingress
409	            #
410	            #   name        |  description
411	            #  ---------------------------------------------------------------------
412	            #   never       |  never enrich with an ingress
413	            #   always      |  always enrich with an ingress, regardless the service type
414	            #   onClusterIP |  enrich with an ingress only when `mlrun.config.httpdb.nuclio.default_service_type`
415	            #                  is set to ClusterIP
416	            #  ---------------------------------------------------------------------
417	            # Note: adding a mode requires special handling on
418	            # - mlrun.common.runtimes.constants.NuclioIngressAddTemplatedIngressModes
419	            # - mlrun.runtimes.nuclio.function.enrich_function_with_ingress
420	            "add_templated_ingress_host_mode": "never",
421	            "explicit_ack": "enabled",
422	            # size of serving spec to move to config maps
423	            "serving_spec_env_cutoff": 0,
424	        },
425	        "logs": {
426	            "decode": {
427	                # Replace with a replacement marker. Uses � (U+FFFD, the official REPLACEMENT CHARACTER).
428	                # see https://docs.python.org/3/library/codecs.html#error-handlers for more info and options
429	                "errors": "replace",
430	            },
431	            "pipelines": {
432	                # pull state mode was introduced to have a way to pull the state of a run which was spawned by a
433	                # pipeline step instead of pulling the state by getting the run logs
434	                "pull_state": {
435	                    # enabled - pull state of a run every "pull_state_interval" seconds and pull logs every
436	                    # "pull_logs_interval" seconds
437	                    # disabled - pull logs every "pull_logs_default_interval" seconds
438	                    "mode": "disabled",
439	                    # those params are used when mode is enabled
440	                    "pull_logs_interval": 30,  # seconds
441	                    "pull_state_interval": 5,  # seconds
442	                },
443	            },
444	            "nuclio": {
445	                # setting interval to a higher interval than regular jobs / build, because pulling the retrieved logs
446	                # from nuclio for the deploy status doesn't include the actual live "builder" container logs, but
447	                # rather a high level status
448	                "pull_deploy_status_default_interval": 10  # seconds
449	            },
450	            # this is the default interval period for pulling logs, if not specified different timeout interval
451	            "pull_logs_default_interval": 3,  # seconds
452	            "pull_logs_backoff_no_logs_default_interval": 10,  # seconds
453	            "pull_logs_default_size_limit": 1024 * 1024,  # 1 MB
454	        },
455	        "authorization": {
456	            "mode": "none",  # one of none, opa
457	            "opa": {
458	                "address": "",
459	                "request_timeout": 10,
460	                "permission_query_path": "",
461	                "permission_filter_path": "",
462	                "log_level": 0,
463	            },
464	        },
465	        "scheduling": {
466	            # the minimum interval that will be allowed between two scheduled jobs - e.g. a job wouldn't be
467	            # allowed to be scheduled to run more than 2 times in X. Can't be less than 1 minute, "0" to disable
468	            "min_allowed_interval": "10 minutes",
469	            "default_concurrency_limit": 1,
470	            # Firing our jobs include things like creating pods which might not be instant, therefore in the case of
471	            # multiple schedules scheduled to the same time, there might be delays, the default of the scheduler for
472	            # misfire_grace_time is 1 second, we do not want jobs not being scheduled because of the delays so setting
473	            # it to None. the default for coalesce it True just adding it here to be explicit
474	            "scheduler_config": '{"job_defaults": {"misfire_grace_time": null, "coalesce": true}}',
475	        },
476	        "projects": {
477	            "leader": "mlrun",
478	            "retry_leader_request_on_exception": "enabled",
479	            "followers": "",
480	            # This is used as the interval for the sync loop both when mlrun is leader and follower
481	            "periodic_sync_interval": "1 minute",
482	            "project_owners_cache_ttl": "30 seconds",
483	            # access key to be used when the leader is iguazio and polling is done from it
484	            "iguazio_access_key": "",
485	            "iguazio_list_projects_default_page_size": 200,
486	            "iguazio_client_job_cache_ttl": "20 minutes",
487	            "nuclio_project_deletion_verification_timeout": "300 seconds",
488	            "nuclio_project_deletion_verification_interval": "5 seconds",
489	            "summaries": {
490	                # Number of days back to include when calculating the project pipeline summary.
491	                "list_pipelines_time_period_in_days": 7,
492	            },
493	        },
494	        # The API needs to know what is its k8s svc url so it could enrich it in the jobs it creates
495	        "api_url": "",
496	        "builder": {
497	            # setting the docker registry to be used for built images, can include the repository as well, e.g.
498	            # index.docker.io/<username>, if not included repository will default to mlrun
499	            "docker_registry": "",
500	            # dockerconfigjson type secret to attach to kaniko pod.
501	            # For amazon ECR, the secret is expected to provide AWS credentials. Leave empty to use EC2 IAM policy.
502	            # https://github.com/GoogleContainerTools/kaniko#pushing-to-amazon-ecr
503	            "docker_registry_secret": "",
504	            # whether to allow the docker registry we're pulling from to be insecure. "enabled", "disabled" or "auto"
505	            # which will resolve by the existence of secret
506	            "insecure_pull_registry_mode": "auto",
507	            # whether to allow the docker registry we're pushing to, to be insecure. "enabled", "disabled" or "auto"
508	            # which will resolve by the existence of secret
509	            "insecure_push_registry_mode": "auto",
510	            # the requirement specifier used by the builder when installing mlrun in images when it runs
511	            # pip install <requirement_specifier>, e.g. mlrun==0.5.4, mlrun~=0.5,
512	            # git+https://github.com/mlrun/mlrun@development. by default uses the version
513	            "mlrun_version_specifier": "",
514	            "kaniko_image": "gcr.io/kaniko-project/executor:v1.23.2",  # kaniko builder image
515	            "kaniko_init_container_image": "alpine:3.18",
516	            # image for kaniko init container when docker registry is ECR
517	            "kaniko_aws_cli_image": "amazon/aws-cli:2.17.16",
518	            # kaniko sometimes fails to get filesystem from image, this is a workaround to retry the process
519	            # a known issue in Kaniko - https://github.com/GoogleContainerTools/kaniko/issues/1717
520	            "kaniko_image_fs_extraction_retries": "3",
521	            # kaniko sometimes fails to push image to registry due to network issues
522	            "kaniko_image_push_retry": "3",
523	            # additional docker build args in json encoded base64 format
524	            "build_args": "",
525	            "pip_ca_secret_name": "",
526	            "pip_ca_secret_key": "",
527	            "pip_ca_path": "/etc/ssl/certs/mlrun/pip-ca-certificates.crt",
528	            # template for the prefix that the function target image will be enforced to have (as long as it's targeted
529	            # to be in the configured registry). Supported template values are: {project} {name}
530	            "function_target_image_name_prefix_template": "func-{project}-{name}",
531	            "pip_version": "~=23.0",
532	        },
533	        "v3io_api": "",
534	        "v3io_framesd": "",
535	        # If running from sdk and MLRUN_DBPATH is not set, the db will fallback to a nop db which will not preform any
536	        # run db operations.
537	        "nop_db": {
538	            # if set to true, will raise an error for trying to use run db functionality
539	            # if set to false, will use a nop db which will not preform any run db operations
540	            "raise_error": False,
541	            # if set to true, will log a warning for trying to use run db functionality while in nop db mode
542	            "verbose": True,
543	        },
544	        "pagination": {
545	            "default_page_size": 200,
546	            "page_limit": 1000000,
547	            "page_size_limit": 1000000,
548	            "pagination_cache": {
549	                "interval": 60,
550	                "ttl": 3600,
551	                "max_size": 10000,
552	            },
553	        },
554	    },
555	    "model_endpoint_monitoring": {
556	        # Scaling Rule
557	        # The fundamental scaling rule to maintain is: Shards/Partitions = Replicas * Workers
558	        # In other words, the number of shards (V3IO) or partitions (Kafka) must be equal to the
559	        # total number of worker processes across all pods.
560	        "serving_stream": {
561	            "v3io": {
562	                "shard_count": 2,
563	                "retention_period_hours": 24,
564	                "num_workers": 1,
565	                "min_replicas": 2,
566	                "max_replicas": 2,
567	            },
568	            "kafka": {
569	                "partition_count": 8,
570	                "replication_factor": 1,
571	                "num_workers": 2,
572	                "min_replicas": 1,
573	                "max_replicas": 4,
574	            },
575	        },
576	        "application_stream_args": {
577	            "v3io": {
578	                "shard_count": 4,
579	                "retention_period_hours": 24,
580	                "num_workers": 4,
581	                "min_replicas": 1,
582	                "max_replicas": 1,
583	            },
584	            "kafka": {
585	                "partition_count": 4,
586	                "replication_factor": 1,
587	                "num_workers": 4,
588	                "min_replicas": 1,
589	                "max_replicas": 1,
590	            },
591	        },
592	        "writer_stream_args": {
593	            "v3io": {
594	                "shard_count": 1,
595	                "retention_period_hours": 24,
596	                "num_workers": 1,
597	                "min_replicas": 1,
598	                "max_replicas": 1,
599	            },
600	            "kafka": {
601	                "partition_count": 1,
602	                # TODO: add retention period configuration
603	                "replication_factor": 1,
604	                "num_workers": 1,
605	                "min_replicas": 1,
606	                "max_replicas": 1,
607	            },
608	        },
609	        "controller_stream_args": {
610	            "v3io": {
611	                "shard_count": 10,
612	                "retention_period_hours": 24,
613	                "num_workers": 10,
614	                "min_replicas": 1,
615	                "max_replicas": 1,
616	            },
617	            "kafka": {
618	                "partition_count": 10,
619	                "replication_factor": 1,
620	                "num_workers": 10,
621	                "min_replicas": 1,
622	                "max_replicas": 1,
623	            },
624	        },
625	        # Store prefixes are used to handle model monitoring storing policies based on project and kind, such as events,
626	        # stream, and endpoints.
627	        "store_prefixes": {
628	            "default": "v3io:///users/pipelines/{project}/model-endpoints/{kind}",
629	            "user_space": "v3io:///projects/{project}/model-endpoints/{kind}",
630	            "monitoring_application": "v3io:///users/pipelines/{project}/monitoring-apps/",
631	        },
632	        # Offline storage path can be either relative or a full path. This path is used for general offline data
633	        # storage such as the parquet file which is generated from the monitoring stream function for the drift analysis
634	        "offline_storage_path": "model-endpoints/{kind}",
635	        "parquet_batching_max_events": 10_000,
636	        "parquet_batching_timeout_secs": timedelta(minutes=1).total_seconds(),
637	        "tdengine": {
638	            "run_directly": True,
639	            # timeout and retry are ignored when run_directly is set to True
640	            "timeout": 10,
641	            "retries": 1,
642	        },
643	    },
644	    "secret_stores": {
645	        # Use only in testing scenarios (such as integration tests) to avoid using k8s for secrets (will use in-memory
646	        # "secrets")
647	        "test_mode_mock_secrets": False,
648	        "vault": {
649	            # URLs to access Vault. For example, in a local env (Minikube on Mac) these would be:
650	            # http://docker.for.mac.localhost:8200
651	            "url": "",
652	            "remote_url": "",
653	            "role": "",
654	            "token_path": "~/.mlrun/vault",
655	            "project_service_account_name": "mlrun-vault-{project}",
656	            "token_ttl": 180000,
657	            # This config is for debug/testing purposes only!
658	            "user_token": "",
659	        },
660	        "azure_vault": {
661	            "url": "https://{name}.vault.azure.net",
662	            "default_secret_name": None,
663	            "secret_path": "~/.mlrun/azure_vault",
664	        },
665	        "kubernetes": {
666	            # When this is True (the default), all project secrets will be automatically added to each job,
667	            # unless user asks for a specific list of secrets.
668	            "auto_add_project_secrets": True,
669	            "project_secret_name": "mlrun-project-secrets-{project}",
670	            "auth_secret_name": "mlrun-auth-secrets.{hashed_access_key}",
671	            "env_variable_prefix": "",
672	            "global_function_env_secret_name": None,
673	        },
674	    },
675	    "feature_store": {
676	        "data_prefixes": {
677	            "default": "v3io:///projects/{project}/FeatureStore/{name}/{kind}",
678	            "nosql": "v3io:///projects/{project}/FeatureStore/{name}/nosql",
679	            # "authority" is optional and generalizes [userinfo "@"] host [":" port]
680	            "redisnosql": "redis://{authority}/projects/{project}/FeatureStore/{name}/nosql",
681	            "dsnosql": "ds://{ds_profile_name}/projects/{project}/FeatureStore/{name}/{kind}",
682	        },
683	        "default_targets": "parquet,nosql",
684	        "default_job_image": "mlrun/mlrun",
685	        "flush_interval": None,
686	    },
687	    "ui": {
688	        "projects_prefix": "projects",  # The UI link prefix for projects
689	        "url": "",  # remote/external mlrun UI url (for hyperlinks)
690	    },
691	    "hub": {
692	        "k8s_secrets_project_name": "-hub-secrets",
693	        "catalog_filename": "catalog.json",
694	        "default_source": {
695	            # Set false to avoid creating a global source (for example in a dark site)
696	            "create": True,
697	            "name": "default",
698	            "description": "MLRun global function hub",
699	            "url": "https://mlrun.github.io/marketplace",
700	            "object_type": "functions",
701	            "channel": "master",
702	        },
703	    },
704	    "storage": {
705	        # What type of auto-mount to use for functions. One of: none, auto, v3io_credentials, v3io_fuse, pvc, s3, env.
706	        # Default is auto - which is v3io_credentials when running on Iguazio. If not Iguazio: pvc if the
707	        # MLRUN_PVC_MOUNT env is configured or auto_mount_params contain "pvc_name". Otherwise will do nothing (none).
708	        "auto_mount_type": "auto",
709	        # Extra parameters to pass to the mount call (will be passed as kwargs). Parameters can be either:
710	        # 1. A string of comma-separated parameters, using this format: "param1=value1,param2=value2"
711	        # 2. A base-64 encoded json dictionary containing the list of parameters
712	        "auto_mount_params": "",
713	        # map file data items starting with virtual path to the real path, used when consumers have different mounts
714	        # e.g. Windows client (on host) and Linux container (Jupyter, Nuclio..) need to access the same files/artifacts
715	        # need to map container path to host windows paths, e.g. "\data::c:\\mlrun_data" ("::" used as splitter)
716	        "item_to_real_path": "",
717	    },
718	    "default_function_pod_resources": {
719	        "requests": {"cpu": None, "memory": None, "gpu": None},
720	        "limits": {"cpu": None, "memory": None, "gpu": None},
721	    },
722	    "default_spark_resources": {
723	        "driver": {
724	            "requests": {"cpu": "1", "memory": "2g"},
725	            "limits": {"cpu": "2", "memory": "2g"},
726	        },
727	        "executor": {
728	            "requests": {"cpu": "1", "memory": "5g"},
729	            "limits": {"cpu": "2", "memory": "5g"},
730	        },
731	    },
732	    # preemptible node selector and tolerations to be added when running on spot nodes
733	    "preemptible_nodes": {
734	        # encoded empty dict
735	        "node_selector": "e30=",
736	        # encoded empty list
737	        "tolerations": "W10=",
738	    },
739	    "http_retry_defaults": {
740	        "max_retries": 3,
741	        "backoff_factor": 1,
742	        "status_codes": [500, 502, 503, 504],
743	    },
744	    "ce": {
745	        # ce mode can be one of: "", lite, full
746	        "mode": "",
747	        # not possible to call this "version" because the Config class has a "version" property
748	        # which returns the version from the version.json file
749	        "release": "",
750	    },
751	    "debug": {
752	        "expose_internal_api_endpoints": False,
753	    },
754	    "workflows": {
755	        "default_workflow_runner_name": "workflow-runner-{}",
756	        "concurrent_delete_worker_count": 20,
757	        # Default timeout seconds for retrieving workflow id after execution
758	        # Remote workflow timeout is the maximum between remote and the inner engine timeout
759	        "timeouts": {"local": 120, "kfp": 60, "remote": 60 * 5},
760	    },
761	    "log_collector": {
762	        "address": "localhost:8282",
763	        # log collection mode can be one of: "sidecar", "legacy", "best-effort"
764	        # "sidecar" - use the sidecar to collect logs
765	        # "legacy" - use the legacy log collection method (logs are collected straight from the pod)
766	        # "best-effort" - use the sidecar, but if for some reason it's not available use the legacy method
767	        # note that this mode also effects the log querying method as well, meaning if the mode is "best-effort"
768	        # the log query will try to use the sidecar first and if it's not available it will use the legacy method
769	        # TODO: once this is changed to "sidecar" by default, also change in common_fixtures.py
770	        "mode": "legacy",
771	        # interval for collecting and sending runs which require their logs to be collected
772	        "periodic_start_log_interval": 10,
773	        "failed_runs_grace_period": 3600,
774	        "verbose": True,
775	        # the number of workers which will be used to trigger the start log collection
776	        "concurrent_start_logs_workers": 50,
777	        # the number of runs for which to start logs on api startup
778	        "start_logs_startup_run_limit": 150,
779	        # the time in hours in which to start log collection from.
780	        # after upgrade, we might have runs which completed in the mean time or still in non-terminal state and
781	        # we want to collect their logs in the new log collection method (sidecar)
782	        # default is 4 hours = 4*60*60 = 14400 seconds
783	        "api_downtime_grace_period": 14400,
784	        "get_logs": {
785	            # the number of retries to get logs from the log collector
786	            "max_retries": 3,
787	        },
788	        # interval for stopping log collection for runs which are in a terminal state
789	        "stop_logs_interval": 3600,
790	    },
791	    # Configurations for the `mlrun.package` sub-package involving packagers - logging returned outputs and parsing
792	    # inputs data items:
793	    "packagers": {
794	        # Whether to enable packagers. True will wrap each run in the `mlrun.package.handler` decorator to log and parse
795	        # using packagers.
796	        "enabled": True,
797	        # Whether to treat returned tuples from functions as a tuple and not as multiple returned items. If True, all
798	        # returned values will be packaged together as the tuple they are returned in. Default is False to enable
799	        # logging multiple returned items.
800	        "pack_tuples": False,
801	        # In multi-workers run, only the logging worker will pack the outputs and log the results and artifacts.
802	        # Otherwise, the workers will log the results and artifacts using the same keys, overriding them. It is common
803	        # that only the main worker (usualy rank 0) will log, so this is the default value.
804	        "logging_worker": 0,
805	        # TODO: Consider adding support for logging from all workers (ignoring the `logging_worker`) and add the worker
806	        #       number to the artifact / result key (like "<key>-rank<#>". Results can have reduce operation in the
807	        #       log hint to average / min / max them across all the workers (default operation should be average).
808	    },
809	    # Events are currently (and only) used to audit changes and record access to MLRun entities (such as secrets)
810	    "events": {
811	        # supported modes "enabled", "disabled".
812	        # "enabled" - events are emitted.
813	        # "disabled" - a nop client is used (aka doing nothing).
814	        "mode": "disabled",
815	        "verbose": False,
816	        # used for igz client when emitting events
817	        "access_key": "",
818	    },
819	    "grafana_url": "",
820	    "alerts": {
821	        # supported modes: "enabled", "disabled".
822	        "mode": "enabled",
823	        # maximum number of alerts we allow to be configured.
824	        # user will get an error when exceeding this
825	        "max_allowed": 20000,
826	        # maximum allowed value for count in criteria field inside AlertConfig
827	        "max_criteria_count": 100,
828	        # interval for periodic events generation job
829	        "events_generation_interval": 30,  # seconds
830	        # number of alerts to delete in each chunk
831	        "chunk_size_during_project_deletion": 100,
832	        # maximum allowed alert config cache size in alert's CRUD
833	        # for the best performance, it is recommended to set this value to the maximum number of alerts
834	        "max_allowed_cache_size": 20000,
835	        # default limit for listing alert configs
836	        "default_list_alert_configs_limit": 2000,
837	    },
838	    "auth_with_client_id": {
839	        "enabled": False,
840	        "request_timeout": 5,
841	    },
842	    "services": {
843	        # The running service name. One of: "api", "alerts"
844	        "service_name": "api",
845	        "hydra": {
846	            # Comma separated list of services to run on the instance.
847	            # Currently, this is only considered when the service_name is "api".
848	            # "*" starts all services on the same instance,
849	            # other options are considered as running only the api service.
850	            "services": "*",
851	        },
852	    },
853	    "notifications": {
854	        "smtp": {
855	            "config_secret_name": "mlrun-smtp-config",
856	            "refresh_interval": "30",
857	        }
858	    },
859	    "system_id": "",
860	}
861	_is_running_as_api = None
862	
863	
864	def is_running_as_api():
865	    # MLRUN_IS_API_SERVER is set when running the api server which is being done through the CLI command mlrun db
866	    global _is_running_as_api
867	
868	    if _is_running_as_api is None:
869	        _is_running_as_api = os.getenv("MLRUN_IS_API_SERVER", "false").lower() == "true"
870	
871	    return _is_running_as_api
872	
873	
874	class Config:
875	    _missing = object()
876	
877	    def __init__(self, cfg=None):
878	        cfg = {} if cfg is None else cfg
879	
880	        # Can't use self._cfg = cfg → infinite recursion
881	        object.__setattr__(self, "_cfg", cfg)
882	
883	    def __getattr__(self, attr):
884	        val = self._cfg.get(attr, self._missing)
885	        if val is self._missing:
886	            raise AttributeError(attr)
887	
888	        if isinstance(val, Mapping):
889	            return self.__class__(val)
890	        return val
891	
892	    def __deepcopy__(self, memo):
893	        cls = self.__class__
894	        # create a new Config without calling __init__ (avoid recursion)
895	        result = cls.__new__(cls)
896	        # manually deep-copy _cfg
897	        object.__setattr__(result, "_cfg", copy.deepcopy(self._cfg, memo))
898	        return result
899	
900	    def __setattr__(self, attr, value):
901	        # in order for the dbpath setter to work
902	        if attr == "dbpath":
903	            super().__setattr__(attr, value)
904	        else:
905	            self._cfg[attr] = value
906	
907	    def __dir__(self):
908	        return list(self._cfg) + dir(self.__class__)
909	
910	    def __repr__(self):
911	        name = self.__class__.__name__
912	        return f"{name}({self._cfg!r})"
913	
914	    def __iter__(self):
915	        if isinstance(self._cfg, Mapping):
916	            return self._cfg.__iter__()
917	
918	    def items(self):
919	        if isinstance(self._cfg, Mapping):
920	            return iter(self._cfg.items())
921	
922	    def keys(self):
923	        if isinstance(self._cfg, Mapping):
924	            return iter(self.data.keys())
925	
926	    def values(self):
927	        if isinstance(self._cfg, Mapping):
928	            return iter(self.data.values())
929	
930	    def update(self, cfg, skip_errors=False):
931	        for key, value in cfg.items():
932	            if hasattr(self, key):
933	                if isinstance(value, dict):
934	                    # ignore the `skip_errors` flag here
935	                    # if the key does not align with what mlrun config expects it is a user
936	                    # input error that can lead to unexpected behavior.
937	                    # raise the exception to ensure configuration is loaded correctly and do not
938	                    # ignore any errors.
939	                    config_value = getattr(self, key)
940	                    try:
941	                        config_value.update(value)
942	                    except AttributeError as exc:
943	                        if not isinstance(config_value, (dict, Config)):
944	                            raise ValueError(
945	                                f"Can not update `{key}` config. "
946	                                f"Expected a configuration but received {type(value)}"
947	                            ) from exc
948	                        raise exc
949	                else:
950	                    try:
951	                        setattr(self, key, value)
952	                    except mlrun.errors.MLRunRuntimeError as exc:
953	                        if not skip_errors:
954	                            raise exc
955	                        print(
956	                            f"Warning, failed to set config key {key}={value}, {mlrun.errors.err_to_str(exc)}"
957	                        )
958	
959	    def dump_yaml(self, stream=None):
960	        return yaml.dump(self._cfg, stream, default_flow_style=False)
961	
962	    @classmethod
963	    def from_dict(cls, dict_):
964	        return cls(copy.deepcopy(dict_))
965	
966	    @staticmethod
967	    def get_build_args():
968	        build_args = {}
969	        if config.httpdb.builder.build_args:
970	            build_args_json = base64.b64decode(
971	                config.httpdb.builder.build_args
972	            ).decode()
973	            build_args = json.loads(build_args_json)
974	
975	        return build_args
976	
977	    @staticmethod
978	    def is_pip_ca_configured():
979	        return (
980	            config.httpdb.builder.pip_ca_secret_name
981	            and config.httpdb.builder.pip_ca_secret_key
982	            and config.httpdb.builder.pip_ca_path
983	        )
984	
985	    @staticmethod
986	    def get_default_hub_source() -> str:
987	        default_source = config.hub.default_source
988	        return f"{default_source.url}/{default_source.object_type}/{default_source.channel}/"
989	
990	    @staticmethod
991	    def decode_base64_config_and_load_to_object(
992	        attribute_path: str, expected_type=dict

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
191	    # default path prefix for demo data and models
192	    "default_samples_path": "https://s3.wasabisys.com/iguazio/",
193	    # default path for tensorboard logs
194	    "default_tensorboard_logs_path": "/User/.tensorboard/{{project}}",
195	    # ";" separated list of notebook cell tag names to ignore e.g. "ignore-this;ignore-that"
196	    "ignored_notebook_tags": "",
197	    # when set it will force the local=True in run_function(), set to "auto" will run local if there is no k8s
198	    "force_run_local": "auto",
199	    # when set (True or non empty str) it will force the mock=True in deploy_function(),
200	    # set to "auto" will use mock of Nuclio if not detected (no nuclio_version)
201	    "mock_nuclio_deployment": "",
202	    # Configurations for `mlrun.track` - tracking runs and experiments from 3rd party vendors like MLFlow
203	    # by running them as a MLRun function, capturing their logs, results and artifacts to mlrun.
204	    "external_platform_tracking": {
205	        # General enabler for the entire tracking mechanism (all tracking services):
206	        "enabled": False,
207	        # Specific enablement and other configurations for the supported trackers:
208	        "mlflow": {
209	            # Enabler of MLFlow tracking:
210	            "enabled": True,
211	            # Whether to match the experiment name to the runtime name (sets mlflow experiment name to mlrun
212	            # context name):
213	            "match_experiment_to_runtime": False,
214	            # Whether to determine the mlflow run id before tracking starts, by doing so we can be positive that we
215	            # are tracking the correct run, this is useful especially for when we run number of runs simultaneously
216	            # in the same experiment. the default is set to false because in the process a mlflow run is created in
217	            # advance, and we want to avoid creating unnecessary runs.
218	            "control_run": False,
219	        },
220	    },
221	    "background_tasks": {
222	        # enabled / disabled
223	        "timeout_mode": "enabled",
224	        "function_deletion_batch_size": 10,
225	        # timeout in seconds to wait for background task to be updated / finished by the worker responsible for the task
226	        "default_timeouts": {
227	            "operations": {
228	                "migrations": "3600",
229	                "load_project": "60",
230	                "run_abortion": "600",
231	                "abort_grace_period": "10",
232	                "delete_project": "900",
233	                "delete_function": "900",
234	                "model_endpoint_creation": "600",
235	                "model_endpoint_tsdb_leftovers": "900",
236	            },
237	            "runtimes": {"dask": "600"},
238	            "push_notifications": "60",
239	        },
240	    },
241	    "function": {
242	        "spec": {
243	            "image_pull_secret": {"default": None},
244	            "security_context": {
245	                # default security context to be applied to all functions - json string base64 encoded format
246	                # in camelCase format: {"runAsUser": 1000, "runAsGroup": 3000}
247	                "default": "e30=",  # encoded empty dict
248	                # see mlrun.common.schemas.function.SecurityContextEnrichmentModes for available options
249	                "enrichment_mode": "disabled",
250	                # default 65534 (nogroup), set to -1 to use the user unix id or
251	                # function.spec.security_context.pipelines.kfp_pod_user_unix_id for kfp pods
252	                "enrichment_group_id": 65534,
253	                "pipelines": {
254	                    # sets the user id to be used for kfp pods when enrichment mode is not disabled
255	                    "kfp_pod_user_unix_id": 5,
256	                },
257	            },
258	            "service_account": {"default": None},
259	            "state_thresholds": {
260	                "default": {
261	                    "pending_scheduled": "1h",
262	                    "pending_not_scheduled": "-1",  # infinite
263	                    "image_pull_backoff": "1h",
264	                    "executing": "24h",
265	                }
266	            },
267	            # When the module is reloaded, the maximum depth recursion configuration for the recursive reload
268	            # function is used to prevent infinite loop
269	            "reload_max_recursion_depth": 100,
270	            "source_code_max_bytes": 10000,
271	        },
272	        "databricks": {
273	            "artifact_directory_path": "/mlrun_databricks_runtime/artifacts_dictionaries"
274	        },
275	        "application": {
276	            "default_sidecar_internal_port": 8050,
277	            "default_authentication_mode": mlrun.common.schemas.APIGatewayAuthenticationMode.none,
278	        },
279	    },
280	    # TODO: function defaults should be moved to the function spec config above
281	    "function_defaults": {
282	        "image_by_kind": {
283	            "job": "mlrun/mlrun",
284	            "serving": "mlrun/mlrun",
285	            "nuclio": "mlrun/mlrun",
286	            "remote": "mlrun/mlrun",
287	            "dask": "mlrun/ml-base",
288	            "mpijob": "mlrun/mlrun",
289	            "application": "python:3.9",
290	        },
291	        # see enrich_function_preemption_spec for more info,
292	        # and mlrun.common.schemas.function.PreemptionModes for available options
293	        "preemption_mode": "prevent",
294	    },
295	    "httpdb": {
296	        "clusterization": {
297	            # one of chief/worker
298	            "role": "chief",
299	            "chief": {
300	                # when url is specified, it takes precedence over service and port
301	                "url": "",
302	                "service": "mlrun-api-chief",
303	                "port": 8080,
304	                "feature_gates": {
305	                    "scheduler": "enabled",
306	                    "project_sync": "enabled",
307	                    "cleanup": "enabled",
308	                    "runs_monitoring": "enabled",
309	                    "pagination_cache": "enabled",
310	                    "project_summaries": "enabled",
311	                    "start_logs": "enabled",
312	                    "stop_logs": "enabled",
313	                },
314	            },
315	            "worker": {
316	                "sync_with_chief": {
317	                    # enabled / disabled
318	                    "mode": "enabled",
319	                    "interval": 15,  # seconds
320	                },
321	                "request_timeout": 45,  # seconds
322	            },
323	            # see server.py.services.api.utils.helpers.ensure_running_on_chief
324	            "ensure_function_running_on_chief_mode": "enabled",
325	        },
326	        "port": 8080,
327	        "dirpath": expanduser("~/.mlrun/db"),
328	        # in production envs we recommend to use a real db (e.g. mysql)
329	        "dsn": "sqlite:///db/mlrun.db?check_same_thread=false",
330	        "debug": False,
331	        "user": "",
332	        "password": "",
333	        "token": "",
334	        "logs_path": "./db/logs",
335	        # when set, these will replace references to the data_volume with the real_path
336	        "data_volume": "",
337	        "real_path": "",
338	        # comma delimited prefixes of paths allowed through the /files API (v3io & the real_path are always allowed).
339	        # These paths must be schemas (cannot be used for local files). For example "s3://mybucket,gcs://"
340	        "allowed_file_paths": "s3://,gcs://,gs://,az://,dbfs://,ds://",
341	        "db_type": "sqldb",
342	        "max_workers": 64,
343	        # See mlrun.common.schemas.APIStates for options
344	        "state": "online",
345	        "retry_api_call_on_exception": "enabled",
346	        "http_connection_timeout_keep_alive": 11,
347	        # http client used by httpdb
348	        "http": {
349	            # when True, the client will verify the server's TLS
350	            # set to False for backwards compatibility.
351	            "verify": True,
352	        },
353	        "db": {
354	            "commit_retry_timeout": 30,
355	            "commit_retry_interval": 3,
356	            "conflict_retry_timeout": 15,
357	            "conflict_retry_interval": None,
358	            # Whether to perform data migrations on initialization. enabled or disabled
359	            "data_migrations_mode": "enabled",
360	            # Whether to perform database migration from sqlite to mysql on initialization
361	            "database_migration_mode": "enabled",
362	            "backup": {
363	                # Whether to use db backups on initialization
364	                "mode": "enabled",
365	                "file_format": "db_backup_%Y%m%d%H%M.db",
366	                "use_rotation": True,
367	                "rotation_limit": 3,
368	                # default is 16MB, max 1G, for more info https://dev.mysql.com/doc/refman/8.0/en/packet-too-large.html
369	                "max_allowed_packet": 64000000,  # 64MB
370	            },
371	            # tests connections for liveness upon each checkout
372	            "connections_pool_pre_ping": True,
373	            # this setting causes the pool to recycle connections after the given number of seconds has passed
374	            "connections_pool_recycle": 60 * 60,
375	            # None defaults to httpdb.max_workers
376	            "connections_pool_size": None,
377	            "connections_pool_max_overflow": None,
378	            # below is a db-specific configuration
379	            "mysql": {
380	                # comma separated mysql modes (globally) to set on runtime
381	                # optional values (as per https://dev.mysql.com/doc/refman/8.0/en/sql-mode.html#sql-mode-full):
382	                #
383	                # if set to "nil" or "none", nothing would be set
384	                "modes": (
385	                    "STRICT_TRANS_TABLES"
386	                    ",NO_ZERO_IN_DATE"
387	                    ",NO_ZERO_DATE"
388	                    ",ERROR_FOR_DIVISION_BY_ZERO"
389	                    ",NO_ENGINE_SUBSTITUTION",
390	                )
391	            },
392	        },
393	        "jobs": {
394	            # whether to allow to run local runtimes in the API - configurable to allow the scheduler testing to work
395	            "allow_local_run": False,
396	        },
397	        "authentication": {
398	            "mode": "none",  # one of none, basic, bearer, iguazio
399	            "basic": {"username": "", "password": ""},
400	            "bearer": {"token": ""},
401	            "iguazio": {
402	                "session_verification_endpoint": "data_sessions/verifications/app_service",
403	            },
404	        },
405	        "nuclio": {
406	            # One of ClusterIP | NodePort
407	            "default_service_type": "NodePort",
408	            # The following modes apply when user did not configure an ingress
409	            #
410	            #   name        |  description
411	            #  ---------------------------------------------------------------------
412	            #   never       |  never enrich with an ingress
413	            #   always      |  always enrich with an ingress, regardless the service type
414	            #   onClusterIP |  enrich with an ingress only when `mlrun.config.httpdb.nuclio.default_service_type`
415	            #                  is set to ClusterIP
416	            #  ---------------------------------------------------------------------
417	            # Note: adding a mode requires special handling on
418	            # - mlrun.common.runtimes.constants.NuclioIngressAddTemplatedIngressModes
419	            # - mlrun.runtimes.nuclio.function.enrich_function_with_ingress
420	            "add_templated_ingress_host_mode": "never",
421	            "explicit_ack": "enabled",
422	            # size of serving spec to move to config maps
423	            "serving_spec_env_cutoff": 0,
424	        },
425	        "logs": {
426	            "decode": {
427	                # Replace with a replacement marker. Uses � (U+FFFD, the official REPLACEMENT CHARACTER).
428	                # see https://docs.python.org/3/library/codecs.html#error-handlers for more info and options
429	                "errors": "replace",
430	            },
431	            "pipelines": {
432	                # pull state mode was introduced to have a way to pull the state of a run which was spawned by a
433	                # pipeline step instead of pulling the state by getting the run logs
434	                "pull_state": {
435	                    # enabled - pull state of a run every "pull_state_interval" seconds and pull logs every
436	                    # "pull_logs_interval" seconds
437	                    # disabled - pull logs every "pull_logs_default_interval" seconds
438	                    "mode": "disabled",
439	                    # those params are used when mode is enabled
440	                    "pull_logs_interval": 30,  # seconds
441	                    "pull_state_interval": 5,  # seconds
442	                },
443	            },
444	            "nuclio": {
445	                # setting interval to a higher interval than regular jobs / build, because pulling the retrieved logs
446	                # from nuclio for the deploy status doesn't include the actual live "builder" container logs, but
447	                # rather a high level status
448	                "pull_deploy_status_default_interval": 10  # seconds
449	            },
450	            # this is the default interval period for pulling logs, if not specified different timeout interval
451	            "pull_logs_default_interval": 3,  # seconds
452	            "pull_logs_backoff_no_logs_default_interval": 10,  # seconds
453	            "pull_logs_default_size_limit": 1024 * 1024,  # 1 MB
454	        },
455	        "authorization": {
456	            "mode": "none",  # one of none, opa
457	            "opa": {
458	                "address": "",
459	                "request_timeout": 10,
460	                "permission_query_path": "",
461	                "permission_filter_path": "",
462	                "log_level": 0,
463	            },
464	        },
465	        "scheduling": {
466	            # the minimum interval that will be allowed between two scheduled jobs - e.g. a job wouldn't be
467	            # allowed to be scheduled to run more than 2 times in X. Can't be less than 1 minute, "0" to disable
468	            "min_allowed_interval": "10 minutes",
469	            "default_concurrency_limit": 1,
470	            # Firing our jobs include things like creating pods which might not be instant, therefore in the case of
471	            # multiple schedules scheduled to the same time, there might be delays, the default of the scheduler for
472	            # misfire_grace_time is 1 second, we do not want jobs not being scheduled because of the delays so setting
473	            # it to None. the default for coalesce it True just adding it here to be explicit
474	            "scheduler_config": '{"job_defaults": {"misfire_grace_time": null, "coalesce": true}}',
475	        },
476	        "projects": {
477	            "leader": "mlrun",
478	            "retry_leader_request_on_exception": "enabled",
479	            "followers": "",
480	            # This is used as the interval for the sync loop both when mlrun is leader and follower
481	            "periodic_sync_interval": "1 minute",
482	            "project_owners_cache_ttl": "30 seconds",
483	            # access key to be used when the leader is iguazio and polling is done from it
484	            "iguazio_access_key": "",
485	            "iguazio_list_projects_default_page_size": 200,
486	            "iguazio_client_job_cache_ttl": "20 minutes",
487	            "nuclio_project_deletion_verification_timeout": "300 seconds",
488	            "nuclio_project_deletion_verification_interval": "5 seconds",
489	            "summaries": {
490	                # Number of days back to include when calculating the project pipeline summary.
491	                "list_pipelines_time_period_in_days": 7,
492	            },
493	        },
494	        # The API needs to know what is its k8s svc url so it could enrich it in the jobs it creates
495	        "api_url": "",
496	        "builder": {
497	            # setting the docker registry to be used for built images, can include the repository as well, e.g.
498	            # index.docker.io/<username>, if not included repository will default to mlrun
499	            "docker_registry": "",
500	            # dockerconfigjson type secret to attach to kaniko pod.
501	            # For amazon ECR, the secret is expected to provide AWS credentials. Leave empty to use EC2 IAM policy.
502	            # https://github.com/GoogleContainerTools/kaniko#pushing-to-amazon-ecr
503	            "docker_registry_secret": "",
504	            # whether to allow the docker registry we're pulling from to be insecure. "enabled", "disabled" or "auto"
505	            # which will resolve by the existence of secret
506	            "insecure_pull_registry_mode": "auto",
507	            # whether to allow the docker registry we're pushing to, to be insecure. "enabled", "disabled" or "auto"
508	            # which will resolve by the existence of secret
509	            "insecure_push_registry_mode": "auto",
510	            # the requirement specifier used by the builder when installing mlrun in images when it runs
511	            # pip install <requirement_specifier>, e.g. mlrun==0.5.4, mlrun~=0.5,
512	            # git+https://github.com/mlrun/mlrun@development. by default uses the version
513	            "mlrun_version_specifier": "",
514	            "kaniko_image": "gcr.io/kaniko-project/executor:v1.23.2",  # kaniko builder image
515	            "kaniko_init_container_image": "alpine:3.18",
516	            # image for kaniko init container when docker registry is ECR
517	            "kaniko_aws_cli_image": "amazon/aws-cli:2.17.16",
518	            # kaniko sometimes fails to get filesystem from image, this is a workaround to retry the process
519	            # a known issue in Kaniko - https://github.com/GoogleContainerTools/kaniko/issues/1717
520	            "kaniko_image_fs_extraction_retries": "3",
521	            # kaniko sometimes fails to push image to registry due to network issues
522	            "kaniko_image_push_retry": "3",
523	            # additional docker build args in json encoded base64 format
524	            "build_args": "",
525	            "pip_ca_secret_name": "",
526	            "pip_ca_secret_key": "",
527	            "pip_ca_path": "/etc/ssl/certs/mlrun/pip-ca-certificates.crt",
528	            # template for the prefix that the function target image will be enforced to have (as long as it's targeted
529	            # to be in the configured registry). Supported template values are: {project} {name}
530	            "function_target_image_name_prefix_template": "func-{project}-{name}",
531	            "pip_version": "~=23.0",
532	        },
533	        "v3io_api": "",
534	        "v3io_framesd": "",
535	        # If running from sdk and MLRUN_DBPATH is not set, the db will fallback to a nop db which will not preform any
536	        # run db operations.
537	        "nop_db": {
538	            # if set to true, will raise an error for trying to use run db functionality
539	            # if set to false, will use a nop db which will not preform any run db operations
540	            "raise_error": False,
541	            # if set to true, will log a warning for trying to use run db functionality while in nop db mode
542	            "verbose": True,
543	        },
544	        "pagination": {
545	            "default_page_size": 200,
546	            "page_limit": 1000000,
547	            "page_size_limit": 1000000,
548	            "pagination_cache": {
549	                "interval": 60,
550	                "ttl": 3600,
551	                "max_size": 10000,
552	            },
553	        },
554	    },
555	    "model_endpoint_monitoring": {
556	        # Scaling Rule
557	        # The fundamental scaling rule to maintain is: Shards/Partitions = Replicas * Workers
558	        # In other words, the number of shards (V3IO) or partitions (Kafka) must be equal to the
559	        # total number of worker processes across all pods.
560	        "serving_stream": {
561	            "v3io": {
562	                "shard_count": 2,
563	                "retention_period_hours": 24,
564	                "num_workers": 1,
565	                "min_replicas": 2,
566	                "max_replicas": 2,
567	            },
568	            "kafka": {
569	                "partition_count": 8,
570	                "replication_factor": 1,
571	                "num_workers": 2,
572	                "min_replicas": 1,
573	                "max_replicas": 4,
574	            },
575	        },
576	        "application_stream_args": {
577	            "v3io": {
578	                "shard_count": 4,
579	                "retention_period_hours": 24,
580	                "num_workers": 4,
581	                "min_replicas": 1,
582	                "max_replicas": 1,
583	            },
584	            "kafka": {
585	                "partition_count": 4,
586	                "replication_factor": 1,
587	                "num_workers": 4,
588	                "min_replicas": 1,
589	                "max_replicas": 1,
590	            },
591	        },
592	        "writer_stream_args": {
593	            "v3io": {
594	                "shard_count": 1,
595	                "retention_period_hours": 24,
596	                "num_workers": 1,
597	                "min_replicas": 1,
598	                "max_replicas": 1,
599	            },
600	            "kafka": {
601	                "partition_count": 1,
602	                # TODO: add retention period configuration
603	                "replication_factor": 1,
604	                "num_workers": 1,
605	                "min_replicas": 1,
606	                "max_replicas": 1,
607	            },
608	        },
609	        "controller_stream_args": {
610	            "v3io": {
611	                "shard_count": 10,
612	                "retention_period_hours": 24,
613	                "num_workers": 10,
614	                "min_replicas": 1,
615	                "max_replicas": 1,
616	            },
617	            "kafka": {
618	                "partition_count": 10,
619	                "replication_factor": 1,
620	                "num_workers": 10,
621	                "min_replicas": 1,
622	                "max_replicas": 1,
623	            },
624	        },
625	        # Store prefixes are used to handle model monitoring storing policies based on project and kind, such as events,
626	        # stream, and endpoints.
627	        "store_prefixes": {
628	            "default": "v3io:///users/pipelines/{project}/model-endpoints/{kind}",
629	            "user_space": "v3io:///projects/{project}/model-endpoints/{kind}",
630	            "monitoring_application": "v3io:///users/pipelines/{project}/monitoring-apps/",
631	        },
632	        # Offline storage path can be either relative or a full path. This path is used for general offline data
633	        # storage such as the parquet file which is generated from the monitoring stream function for the drift analysis
634	        "offline_storage_path": "model-endpoints/{kind}",
635	        "parquet_batching_max_events": 10_000,
636	        "parquet_batching_timeout_secs": timedelta(minutes=1).total_seconds(),
637	        "tdengine": {
638	            "run_directly": True,
639	            # timeout and retry are ignored when run_directly is set to True
640	            "timeout": 10,
641	            "retries": 1,
642	        },
643	    },
644	    "secret_stores": {
645	        # Use only in testing scenarios (such as integration tests) to avoid using k8s for secrets (will use in-memory
646	        # "secrets")
647	        "test_mode_mock_secrets": False,
648	        "vault": {
649	            # URLs to access Vault. For example, in a local env (Minikube on Mac) these would be:
650	            # http://docker.for.mac.localhost:8200
651	            "url": "",
652	            "remote_url": "",
653	            "role": "",
654	            "token_path": "~/.mlrun/vault",
655	            "project_service_account_name": "mlrun-vault-{project}",
656	            "token_ttl": 180000,
657	            # This config is for debug/testing purposes only!
658	            "user_token": "",
659	        },
660	        "azure_vault": {
661	            "url": "https://{name}.vault.azure.net",
662	            "default_secret_name": None,
663	            "secret_path": "~/.mlrun/azure_vault",
664	        },
665	        "kubernetes": {
666	            # When this is True (the default), all project secrets will be automatically added to each job,
667	            # unless user asks for a specific list of secrets.
668	            "auto_add_project_secrets": True,
669	            "project_secret_name": "mlrun-project-secrets-{project}",
670	            "auth_secret_name": "mlrun-auth-secrets.{hashed_access_key}",
671	            "env_variable_prefix": "",
672	            "global_function_env_secret_name": None,
673	        },
674	    },
675	    "feature_store": {
676	        "data_prefixes": {
677	            "default": "v3io:///projects/{project}/FeatureStore/{name}/{kind}",
678	            "nosql": "v3io:///projects/{project}/FeatureStore/{name}/nosql",
679	            # "authority" is optional and generalizes [userinfo "@"] host [":" port]
680	            "redisnosql": "redis://{authority}/projects/{project}/FeatureStore/{name}/nosql",
681	            "dsnosql": "ds://{ds_profile_name}/projects/{project}/FeatureStore/{name}/{kind}",
682	        },
683	        "default_targets": "parquet,nosql",
684	        "default_job_image": "mlrun/mlrun",
685	        "flush_interval": None,
686	    },
687	    "ui": {
688	        "projects_prefix": "projects",  # The UI link prefix for projects
689	        "url": "",  # remote/external mlrun UI url (for hyperlinks)
690	    },
691	    "hub": {
692	        "k8s_secrets_project_name": "-hub-secrets",
693	        "catalog_filename": "catalog.json",
694	        "default_source": {
695	            # Set false to avoid creating a global source (for example in a dark site)
696	            "create": True,
697	            "name": "default",
698	            "description": "MLRun global function hub",
699	            "url": "https://mlrun.github.io/marketplace",
700	            "object_type": "functions",
701	            "channel": "master",
702	        },
703	    },
704	    "storage": {
705	        # What type of auto-mount to use for functions. One of: none, auto, v3io_credentials, v3io_fuse, pvc, s3, env.
706	        # Default is auto - which is v3io_credentials when running on Iguazio. If not Iguazio: pvc if the
707	        # MLRUN_PVC_MOUNT env is configured or auto_mount_params contain "pvc_name". Otherwise will do nothing (none).
708	        "auto_mount_type": "auto",
709	        # Extra parameters to pass to the mount call (will be passed as kwargs). Parameters can be either:
710	        # 1. A string of comma-separated parameters, using this format: "param1=value1,param2=value2"
711	        # 2. A base-64 encoded json dictionary containing the list of parameters
712	        "auto_mount_params": "",
713	        # map file data items starting with virtual path to the real path, used when consumers have different mounts
714	        # e.g. Windows client (on host) and Linux container (Jupyter, Nuclio..) need to access the same files/artifacts
715	        # need to map container path to host windows paths, e.g. "\data::c:\\mlrun_data" ("::" used as splitter)
716	        "item_to_real_path": "",
717	    },
718	    "default_function_pod_resources": {
719	        "requests": {"cpu": None, "memory": None, "gpu": None},
720	        "limits": {"cpu": None, "memory": None, "gpu": None},
721	    },
722	    "default_spark_resources": {
723	        "driver": {
724	            "requests": {"cpu": "1", "memory": "2g"},
725	            "limits": {"cpu": "2", "memory": "2g"},
726	        },
727	        "executor": {
728	            "requests": {"cpu": "1", "memory": "5g"},
729	            "limits": {"cpu": "2", "memory": "5g"},
730	        },
731	    },
732	    # preemptible node selector and tolerations to be added when running on spot nodes
733	    "preemptible_nodes": {
734	        # encoded empty dict
735	        "node_selector": "e30=",
736	        # encoded empty list
737	        "tolerations": "W10=",
738	    },
739	    "http_retry_defaults": {
740	        "max_retries": 3,
741	        "backoff_factor": 1,
742	        "status_codes": [500, 502, 503, 504],
743	    },
744	    "ce": {
745	        # ce mode can be one of: "", lite, full
746	        "mode": "",
747	        # not possible to call this "version" because the Config class has a "version" property
748	        # which returns the version from the version.json file
749	        "release": "",
750	    },
751	    "debug": {
752	        "expose_internal_api_endpoints": False,
753	    },
754	    "workflows": {
755	        "default_workflow_runner_name": "workflow-runner-{}",
756	        "concurrent_delete_worker_count": 20,
757	        # Default timeout seconds for retrieving workflow id after execution
758	        # Remote workflow timeout is the maximum between remote and the inner engine timeout
759	        "timeouts": {"local": 120, "kfp": 60, "remote": 60 * 5},
760	    },
761	    "log_collector": {
762	        "address": "localhost:8282",
763	        # log collection mode can be one of: "sidecar", "legacy", "best-effort"
764	        # "sidecar" - use the sidecar to collect logs
765	        # "legacy" - use the legacy log collection method (logs are collected straight from the pod)
766	        # "best-effort" - use the sidecar, but if for some reason it's not available use the legacy method
767	        # note that this mode also effects the log querying method as well, meaning if the mode is "best-effort"
768	        # the log query will try to use the sidecar first and if it's not available it will use the legacy method
769	        # TODO: once this is changed to "sidecar" by default, also change in common_fixtures.py
770	        "mode": "legacy",
771	        # interval for collecting and sending runs which require their logs to be collected
772	        "periodic_start_log_interval": 10,
773	        "failed_runs_grace_period": 3600,
774	        "verbose": True,
775	        # the number of workers which will be used to trigger the start log collection
776	        "concurrent_start_logs_workers": 50,
777	        # the number of runs for which to start logs on api startup
778	        "start_logs_startup_run_limit": 150,
779	        # the time in hours in which to start log collection from.
780	        # after upgrade, we might have runs which completed in the mean time or still in non-terminal state and
781	        # we want to collect their logs in the new log collection method (sidecar)
782	        # default is 4 hours = 4*60*60 = 14400 seconds
783	        "api_downtime_grace_period": 14400,
784	        "get_logs": {
785	            # the number of retries to get logs from the log collector
786	            "max_retries": 3,
787	        },
788	        # interval for stopping log collection for runs which are in a terminal state
789	        "stop_logs_interval": 3600,
790	    },
791	    # Configurations for the `mlrun.package` sub-package involving packagers - logging returned outputs and parsing
792	    # inputs data items:
793	    "packagers": {
794	        # Whether to enable packagers. True will wrap each run in the `mlrun.package.handler` decorator to log and parse
795	        # using packagers.
796	        "enabled": True,
797	        # Whether to treat returned tuples from functions as a tuple and not as multiple returned items. If True, all
798	        # returned values will be packaged together as the tuple they are returned in. Default is False to enable
799	        # logging multiple returned items.
800	        "pack_tuples": False,
801	        # In multi-workers run, only the logging worker will pack the outputs and log the results and artifacts.
802	        # Otherwise, the workers will log the results and artifacts using the same keys, overriding them. It is common
803	        # that only the main worker (usualy rank 0) will log, so this is the default value.
804	        "logging_worker": 0,
805	        # TODO: Consider adding support for logging from all workers (ignoring the `logging_worker`) and add the worker
806	        #       number to the artifact / result key (like "<key>-rank<#>". Results can have reduce operation in the
807	        #       log hint to average / min / max them across all the workers (default operation should be average).
808	    },
809	    # Events are currently (and only) used to audit changes and record access to MLRun entities (such as secrets)
810	    "events": {
811	        # supported modes "enabled", "disabled".
812	        # "enabled" - events are emitted.
813	        # "disabled" - a nop client is used (aka doing nothing).
814	        "mode": "disabled",
815	        "verbose": False,
816	        # used for igz client when emitting events
817	        "access_key": "",
818	    },
819	    "grafana_url": "",
820	    "alerts": {
821	        # supported modes: "enabled", "disabled".
822	        "mode": "enabled",
823	        # maximum number of alerts we allow to be configured.
824	        # user will get an error when exceeding this
825	        "max_allowed": 20000,
826	        # maximum allowed value for count in criteria field inside AlertConfig
827	        "max_criteria_count": 100,
828	        # interval for periodic events generation job
829	        "events_generation_interval": 30,  # seconds
830	        # number of alerts to delete in each chunk
831	        "chunk_size_during_project_deletion": 100,
832	        # maximum allowed alert config cache size in alert's CRUD
833	        # for the best performance, it is recommended to set this value to the maximum number of alerts
834	        "max_allowed_cache_size": 20000,
835	        # default limit for listing alert configs
836	        "default_list_alert_configs_limit": 2000,
837	    },
838	    "auth_with_client_id": {
839	        "enabled": False,
840	        "request_timeout": 5,
841	    },
842	    "services": {
843	        # The running service name. One of: "api", "alerts"
844	        "service_name": "api",
845	        "hydra": {
846	            # Comma separated list of services to run on the instance.
847	            # Currently, this is only considered when the service_name is "api".
848	            # "*" starts all services on the same instance,
849	            # other options are considered as running only the api service.
850	            "services": "*",
851	        },
852	    },
853	    "notifications": {
854	        "smtp": {
855	            "config_secret_name": "mlrun-smtp-config",
856	            "refresh_interval": "30",
857	        }
858	    },
859	    "system_id": "",
860	}
861	_is_running_as_api = None
862	
863	
864	def is_running_as_api():
865	    # MLRUN_IS_API_SERVER is set when running the api server which is being done through the CLI command mlrun db
866	    global _is_running_as_api
867	
868	    if _is_running_as_api is None:
869	        _is_running_as_api = os.getenv("MLRUN_IS_API_SERVER", "false").lower() == "true"
870	
871	    return _is_running_as_api
872	
873	
874	class Config:
875	    _missing = object()
876	
877	    def __init__(self, cfg=None):
878	        cfg = {} if cfg is None else cfg
879	
880	        # Can't use self._cfg = cfg → infinite recursion
881	        object.__setattr__(self, "_cfg", cfg)
882	
883	    def __getattr__(self, attr):
884	        val = self._cfg.get(attr, self._missing)
885	        if val is self._missing:
886	            raise AttributeError(attr)
887	
888	        if isinstance(val, Mapping):
889	            return self.__class__(val)
890	        return val
891	
892	    def __deepcopy__(self, memo):
893	        cls = self.__class__
894	        # create a new Config without calling __init__ (avoid recursion)
895	        result = cls.__new__(cls)
896	        # manually deep-copy _cfg
897	        object.__setattr__(result, "_cfg", copy.deepcopy(self._cfg, memo))
898	        return result
899	
900	    def __setattr__(self, attr, value):
901	        # in order for the dbpath setter to work
902	        if attr == "dbpath":
903	            super().__setattr__(attr, value)
904	        else:
905	            self._cfg[attr] = value
906	
907	    def __dir__(self):
908	        return list(self._cfg) + dir(self.__class__)
909	
910	    def __repr__(self):
911	        name = self.__class__.__name__
912	        return f"{name}({self._cfg!r})"
913	
914	    def __iter__(self):
915	        if isinstance(self._cfg, Mapping):
916	            return self._cfg.__iter__()
917	
918	    def items(self):
919	        if isinstance(self._cfg, Mapping):
920	            return iter(self._cfg.items())
921	
922	    def keys(self):
923	        if isinstance(self._cfg, Mapping):
924	            return iter(self.data.keys())
925	
926	    def values(self):
927	        if isinstance(self._cfg, Mapping):
928	            return iter(self.data.values())
929	
930	    def update(self, cfg, skip_errors=False):
931	        for key, value in cfg.items():
932	            if hasattr(self, key):
933	                if isinstance(value, dict):
934	                    # ignore the `skip_errors` flag here
935	                    # if the key does not align with what mlrun config expects it is a user
936	                    # input error that can lead to unexpected behavior.
937	                    # raise the exception to ensure configuration is loaded correctly and do not
938	                    # ignore any errors.
939	                    config_value = getattr(self, key)
940	                    try:
941	                        config_value.update(value)
942	                    except AttributeError as exc:
943	                        if not isinstance(config_value, (dict, Config)):
944	                            raise ValueError(
945	                                f"Can not update `{key}` config. "
946	                                f"Expected a configuration but received {type(value)}"
947	                            ) from exc
948	                        raise exc
949	                else:
950	                    try:
951	                        setattr(self, key, value)
952	                    except mlrun.errors.MLRunRuntimeError as exc:
953	                        if not skip_errors:
954	                            raise exc
955	                        print(
956	                            f"Warning, failed to set config key {key}={value}, {mlrun.errors.err_to_str(exc)}"
957	                        )
958	
959	    def dump_yaml(self, stream=None):
960	        return yaml.dump(self._cfg, stream, default_flow_style=False)
961	
962	    @classmethod
963	    def from_dict(cls, dict_):
964	        return cls(copy.deepcopy(dict_))
965	
966	    @staticmethod
967	    def get_build_args():
968	        build_args = {}
969	        if config.httpdb.builder.build_args:
970	            build_args_json = base64.b64decode(
971	                config.httpdb.builder.build_args
972	            ).decode()
973	            build_args = json.loads(build_args_json)
974	
975	        return build_args
976	
977	    @staticmethod
978	    def is_pip_ca_configured():
979	        return (
980	            config.httpdb.builder.pip_ca_secret_name
981	            and config.httpdb.builder.pip_ca_secret_key
982	            and config.httpdb.builder.pip_ca_path
983	        )
984	
985	    @staticmethod
986	    def get_default_hub_source() -> str:
987	        default_source = config.hub.default_source
988	        return f"{default_source.url}/{default_source.object_type}/{default_source.channel}/"
989	
990	    @staticmethod
991	    def decode_base64_config_and_load_to_object(
992	        attribute_path: str, expected_type=dict
993	    ):
994	        """
995	        decodes and loads the config attribute to expected type
996	
997	        :param attribute_path: the path in the default_config e.g. preemptible_nodes.node_selector
998	        :param expected_type: the object type valid values are : `dict`, `list` etc...
999	        :return: the expected type instance
1000	        """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
660	        "azure_vault": {
661	            "url": "https://{name}.vault.azure.net",
662	            "default_secret_name": None,
663	            "secret_path": "~/.mlrun/azure_vault",
664	        },
665	        "kubernetes": {
666	            # When this is True (the default), all project secrets will be automatically added to each job,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
698	            "description": "MLRun global function hub",
699	            "url": "https://mlrun.github.io/marketplace",
700	            "object_type": "functions",
701	            "channel": "master",
702	        },
703	    },
704	    "storage": {
705	        # What type of auto-mount to use for functions. One of: none, auto, v3io_credentials, v3io_fuse, pvc, s3, env.
706	        # Default is auto - which is v3io_credentials when running on Iguazio. If not Iguazio: pvc if the
707	        # MLRUN_PVC_MOUNT env is configured or auto_mount_params contain "pvc_name". Otherwise will do nothing (none).

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
969	        if config.httpdb.builder.build_args:
970	            build_args_json = base64.b64decode(
971	                config.httpdb.builder.build_args
972	            ).decode()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:970
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
969	        if config.httpdb.builder.build_args:
970	            build_args_json = base64.b64decode(
971	                config.httpdb.builder.build_args
972	            ).decode()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:1014
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1013	            try:
1014	                decoded_attribute_value = base64.b64decode(raw_attribute_value).decode()
1015	            except Exception:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:1014
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1013	            try:
1014	                decoded_attribute_value = base64.b64decode(raw_attribute_value).decode()
1015	            except Exception:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:1161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1160	            try:
1161	                auto_mount_params = base64.b64decode(
1162	                    config.storage.auto_mount_params, validate=True
1163	                ).decode()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:1161
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1160	            try:
1161	                auto_mount_params = base64.b64decode(
1162	                    config.storage.auto_mount_params, validate=True
1163	                ).decode()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:1526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1525	    is_remote_mlrun = (
1526	        env_dbpath.startswith("https://mlrun-api.") and "tenant." in env_dbpath
1527	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:1536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1535	        # in remote mlrun we can't use http, so we'll use https
1536	        config["v3io_api"] = env_dbpath.replace("https://mlrun-api.", "https://webapi.")
1537	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:1536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1535	        # in remote mlrun we can't use http, so we'll use https
1536	        config["v3io_api"] = env_dbpath.replace("https://mlrun-api.", "https://webapi.")
1537	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:1545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1544	        config["v3io_framesd"] = env_dbpath.replace(
1545	            "https://mlrun-api.", "https://framesd."
1546	        )
1547	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:1545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1544	        config["v3io_framesd"] = env_dbpath.replace(
1545	            "https://mlrun-api.", "https://framesd."
1546	        )
1547	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/config.py:1576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1575	        if igz_domain:
1576	            config["ui_url"] = f"https://mlrun-ui.{igz_domain}"
1577	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/alibaba_oss.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	        if size or offset:
87	            return oss.get_object(key, byte_range=self.get_range(size, offset)).read()
88	        return oss.get_object(key).read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/alibaba_oss.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
87	            return oss.get_object(key, byte_range=self.get_range(size, offset)).read()
88	        return oss.get_object(key).read()
89	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/azure_blob.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	                res[f"spark.hadoop.fs.azure.account.oauth2.client.endpoint.{host}"] = (
282	                    f"https://login.microsoftonline.com/{tenant_id}/oauth2/token"
283	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	    def _get_secret(self, key: str, default=None):
130	        return self._secrets.get(key, default) or self._get_parent_secret(key)
131	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	    def download(self, key, target_path):
168	        data = self.get(key)
169	        mode = "wb"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
172	        with open(target_path, mode) as fp:
173	            fp.write(data)
174	            fp.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
172	        with open(target_path, mode) as fp:
173	            fp.write(data)
174	            fp.close()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
505	        """
506	        body = self._store.get(self._path, size=size, offset=offset)
507	        if encoding and isinstance(body, bytes):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
635	        if suffix in [".jpg", ".png", ".gif"]:
636	            display.display(display.Image(self.get(), format=suffix[1:]))
637	        elif suffix in [".htm", ".html"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
637	        elif suffix in [".htm", ".html"]:
638	            display.display(display.HTML(self.get(encoding="utf-8")))
639	        elif suffix in [".csv", ".pq", ".parquet"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
641	        elif suffix in [".yaml", ".txt", ".py"]:
642	            display.display(display.Pretty(self.get(encoding="utf-8")))
643	        elif suffix == ".json":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	        elif suffix == ".json":
644	            display.display(display.JSON(orjson.loads(self.get())))
645	        elif suffix == ".md":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
645	        elif suffix == ".md":
646	            display.display(display.Markdown(self.get(encoding="utf-8")))
647	        else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
672	    password = password.encode("latin1")
673	    base = b64encode(b":".join((username, password))).strip()
674	    authstr = "Basic " + base.decode("ascii")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:673
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
672	    password = password.encode("latin1")
673	    base = b64encode(b":".join((username, password))).strip()
674	    authstr = "Basic " + base.decode("ascii")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
693	        if not self._filesystem:
694	            self._filesystem = fsspec.filesystem("http")
695	        return self._filesystem

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
709	            headers = copy(self._headers)
710	            headers["Accept"] = headers.get("Accept", "application/vnd.github.raw")
711	        data = self._http_get(self.url + self._join(key), headers, self.auth)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
710	            headers["Accept"] = headers.get("Accept", "application/vnd.github.raw")
711	        data = self._http_get(self.url + self._join(key), headers, self.auth)
712	        if offset:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/base.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
741	        try:
742	            response = requests.get(url, headers=headers, auth=auth, verify=verify_ssl)
743	        except OSError as exc:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/datastore.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
220	        if schema == "ds":
221	            datastore_profile = datastore_profile_read(url, project_name, secrets)
222	            if secrets and datastore_profile.secrets():

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/datastore_profile.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
537	        encoded_dict = {
538	            k: base64.b64encode(str(v).encode()).decode() for k, v in attributes.items()
539	        }

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/datastore_profile.py:538
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
537	        encoded_dict = {
538	            k: base64.b64encode(str(v).encode()).decode() for k, v in attributes.items()
539	        }

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/datastore_profile.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
566	        attributes_public = {
567	            k: base64.b64decode(str(v).encode()).decode() for k, v in attributes.items()
568	        }

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/datastore_profile.py:567
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
566	        attributes_public = {
567	            k: base64.b64decode(str(v).encode()).decode() for k, v in attributes.items()
568	        }

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/datastore_profile.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
570	        attributes_private = {
571	            k: base64.b64decode(str(v).encode()).decode() for k, v in attributes.items()
572	        }

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/datastore_profile.py:571
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
570	        attributes_private = {
571	            k: base64.b64decode(str(v).encode()).decode() for k, v in attributes.items()
572	        }

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/filestore.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
56	        if not self._filesystem:
57	            self._filesystem = fsspec.filesystem("file")
58	        return self._filesystem

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/filestore.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	                size = -1
66	            return fp.read(size)
67	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/filestore.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	        with open(self._join(key), mode) as fp:
74	            fp.write(data)
75	            fp.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/google_cloud_storage.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        token = self._get_credentials().get("token")
50	        access = "https://www.googleapis.com/auth/devstorage.full_control"
51	        if isinstance(token, str):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/google_cloud_storage.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	        with self.filesystem.open(path, mode) as f:
139	            f.write(data)
140	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/hdfs.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
40	        if not self._filesystem:
41	            self._filesystem = fsspec.filesystem(
42	                "webhdfs",
43	                host=self.host,
44	                port=self.http_port,
45	                user=self.user,
46	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/sources.py:711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
710	        if credentials:
711	            options["credentials"] = b64encode(credentials.encode("utf-8")).decode(
712	                "utf-8"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/sources.py:711
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
710	        if credentials:
711	            options["credentials"] = b64encode(credentials.encode("utf-8")).decode(
712	                "utf-8"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/sources.py:1120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1119	        if self.path and self.path.startswith("ds://"):
1120	            datastore_profile = datastore_profile_read(self.path)
1121	            extra_attributes = datastore_profile.attributes()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/targets.py:1409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1408	
1409	            frames_client.write("kv", path, df, index_cols=key_column, **kwargs)
1410	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/targets.py:1495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1494	        if endpoint.startswith("ds://"):
1495	            datastore_profile = datastore_profile_read(endpoint)
1496	            if not datastore_profile:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/targets.py:1798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1797	
1798	        frames_client.write(
1799	            "tsdb", path, df, index_cols=new_index if new_index else None, **kwargs
1800	        )

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/utils.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
64	    with tempfile.NamedTemporaryFile(suffix=".tar.gz") as temp_fh:
65	        with tarfile.open(mode="w:gz", fileobj=temp_fh) as tar:
66	            tar.add(source_dir, arcname="")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/datastore/v3io.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
91	            return self._filesystem
92	        self._filesystem = fsspec.filesystem("v3io", **self.get_storage_options())
93	        return self._filesystem

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/auth_utils.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
88	
89	        self._issue_token_request()
90	        return self.token

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/auth_utils.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
99	            }
100	            response = self._session.request(
101	                "POST",
102	                self.token_endpoint,
103	                timeout=self.timeout,
104	                headers=headers,
105	                data=request_body,
106	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/auth_utils.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	                    data = response.json()
120	                    error = data.get("error")
121	                except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/auth_utils.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
134	        # According to spec, there isn't a refresh token - just the access token and its expiry time (in seconds).
135	        self.token = data.get("access_token")
136	        expires_in = data.get("expires_in")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/auth_utils.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	        self.token = data.get("access_token")
136	        expires_in = data.get("expires_in")
137	        if not self.token or not expires_in:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
130	        self._wait_for_project_deletion_interval = 3
131	        self.client_version = version.Version().get()["version"]
132	        self.python_version = str(version.Version().get_python_version())

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
277	        try:
278	            response = self.session.request(
279	                method,
280	                url,
281	                timeout=timeout,
282	                verify=config.httpdb.http.verify,
283	                **kw,
284	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
277	        try:
278	            response = self.session.request(
279	                method,
280	                url,
281	                timeout=timeout,
282	                verify=config.httpdb.http.verify,
283	                **kw,
284	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
292	                    data = response.json()
293	                    error_details = data.get("detail", {})
294	                    if not error_details:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
359	        if return_all:
360	            page_token = response.json().get("pagination", {}).get("page-token", None)
361	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
359	        if return_all:
360	            page_token = response.json().get("pagination", {}).get("page-token", None)
361	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
373	                page_token = (
374	                    response.json().get("pagination", {}).get("page-token", None)
375	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
373	                page_token = (
374	                    response.json().get("pagination", {}).get("page-token", None)
375	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
386	        for response in responses:
387	            page_token = response.json().get("pagination", {}).get("page-token", None)
388	            data.extend(response.json().get(key, []))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
386	        for response in responses:
387	            page_token = response.json().get("pagination", {}).get("page-token", None)
388	            data.extend(response.json().get(key, []))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
387	            page_token = response.json().get("pagination", {}).get("page-token", None)
388	            data.extend(response.json().get(key, []))
389	        return data, page_token

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
433	            self._validate_version_compatibility(self.server_version, config.version)
434	            config.namespace = config.namespace or server_cfg.get("namespace")
435	            if (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
442	                )
443	            config.ce = server_cfg.get("ce") or config.ce
444	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
445	            # get defaults from remote server
446	            config.remote_host = config.remote_host or server_cfg.get("remote_host")
447	            config.mpijob_crd_version = config.mpijob_crd_version or server_cfg.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
446	            config.remote_host = config.remote_host or server_cfg.get("remote_host")
447	            config.mpijob_crd_version = config.mpijob_crd_version or server_cfg.get(
448	                "mpijob_crd_version"
449	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
449	            )
450	            config.ui.url = config.resolve_ui_url() or server_cfg.get("ui_url")
451	            config.artifact_path = config.artifact_path or server_cfg.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
450	            config.ui.url = config.resolve_ui_url() or server_cfg.get("ui_url")
451	            config.artifact_path = config.artifact_path or server_cfg.get(
452	                "artifact_path"
453	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
453	            )
454	            config.spark_app_image = config.spark_app_image or server_cfg.get(
455	                "spark_app_image"
456	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
456	            )
457	            config.spark_app_image_tag = config.spark_app_image_tag or server_cfg.get(
458	                "spark_app_image_tag"
459	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
461	                config.spark_history_server_path
462	                or server_cfg.get("spark_history_server_path")
463	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
465	                config.httpdb.builder.docker_registry
466	                or server_cfg.get("docker_registry")
467	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
467	            )
468	            config.httpdb.api_url = config.httpdb.api_url or server_cfg.get("api_url")
469	            config.nuclio_version = config.nuclio_version or server_cfg.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
468	            config.httpdb.api_url = config.httpdb.api_url or server_cfg.get("api_url")
469	            config.nuclio_version = config.nuclio_version or server_cfg.get(
470	                "nuclio_version"
471	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
473	                config.default_function_priority_class_name
474	                or server_cfg.get("default_function_priority_class_name")
475	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
477	                config.valid_function_priority_class_names
478	                or server_cfg.get("valid_function_priority_class_names")
479	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
482	                if config.artifacts.calculate_hash is not None
483	                else server_cfg.get("calculate_artifact_hash")
484	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
487	                if config.artifacts.generate_target_path_from_artifact_hash is not None
488	                else server_cfg.get("generate_artifact_target_path_from_artifact_hash")
489	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
490	
491	            config.redis.url = config.redis.url or server_cfg.get("redis_url")
492	            # allow client to set the default partial WA for lack of support of per-target auxiliary options

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
492	            # allow client to set the default partial WA for lack of support of per-target auxiliary options
493	            config.redis.type = config.redis.type or server_cfg.get("redis_type")
494	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
494	
495	            config.sql.url = config.sql.url or server_cfg.get("sql_url")
496	            # These have a default value, therefore local config will always have a value, prioritize the

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
498	            config.ui.projects_prefix = (
499	                server_cfg.get("ui_projects_prefix") or config.ui.projects_prefix
500	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
500	            )
501	            config.kfp_image = server_cfg.get("kfp_image") or config.kfp_image
502	            config.kfp_url = server_cfg.get("kfp_url") or config.kfp_url

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
501	            config.kfp_image = server_cfg.get("kfp_image") or config.kfp_image
502	            config.kfp_url = server_cfg.get("kfp_url") or config.kfp_url
503	            config.dask_kfp_image = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
503	            config.dask_kfp_image = (
504	                server_cfg.get("dask_kfp_image") or config.dask_kfp_image
505	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
507	                server_cfg.get("scrape_metrics")
508	                if server_cfg.get("scrape_metrics") is not None
509	                else config.scrape_metrics

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
506	            config.scrape_metrics = (
507	                server_cfg.get("scrape_metrics")
508	                if server_cfg.get("scrape_metrics") is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
511	            config.default_function_node_selector = (
512	                server_cfg.get("default_function_node_selector")
513	                or config.default_function_node_selector

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
514	            )
515	            config.igz_version = server_cfg.get("igz_version") or config.igz_version
516	            config.storage.auto_mount_type = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
516	            config.storage.auto_mount_type = (
517	                server_cfg.get("auto_mount_type") or config.storage.auto_mount_type
518	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
519	            config.storage.auto_mount_params = (
520	                server_cfg.get("auto_mount_params") or config.storage.auto_mount_params
521	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
522	            config.spark_operator_version = (
523	                server_cfg.get("spark_operator_version")
524	                or config.spark_operator_version

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
526	            config.default_tensorboard_logs_path = (
527	                server_cfg.get("default_tensorboard_logs_path")
528	                or config.default_tensorboard_logs_path

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
530	            config.default_function_pod_resources = (
531	                server_cfg.get("default_function_pod_resources")
532	                or config.default_function_pod_resources

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
534	            config.function_defaults.preemption_mode = (
535	                server_cfg.get("default_preemption_mode")
536	                or config.function_defaults.preemption_mode

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
538	            config.preemptible_nodes.node_selector = (
539	                server_cfg.get("preemptible_nodes_node_selector")
540	                or config.preemptible_nodes.node_selector

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
542	            config.preemptible_nodes.tolerations = (
543	                server_cfg.get("preemptible_nodes_tolerations")
544	                or config.preemptible_nodes.tolerations

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
546	            config.force_run_local = (
547	                server_cfg.get("force_run_local") or config.force_run_local
548	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
548	            )
549	            config.function = server_cfg.get("function") or config.function
550	            config.httpdb.logs = server_cfg.get("logs") or config.httpdb.logs

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
549	            config.function = server_cfg.get("function") or config.function
550	            config.httpdb.logs = server_cfg.get("logs") or config.httpdb.logs
551	            config.external_platform_tracking = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
551	            config.external_platform_tracking = (
552	                server_cfg.get("external_platform_tracking")
553	                or config.external_platform_tracking

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
554	            )
555	            config.packagers = server_cfg.get("packagers") or config.packagers
556	            server_data_prefixes = server_cfg.get("feature_store_data_prefixes") or {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
555	            config.packagers = server_cfg.get("packagers") or config.packagers
556	            server_data_prefixes = server_cfg.get("feature_store_data_prefixes") or {}
557	            for prefix in ["default", "nosql", "redisnosql"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
557	            for prefix in ["default", "nosql", "redisnosql"]:
558	                server_prefix_value = server_data_prefixes.get(prefix)
559	                if server_prefix_value is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
563	            config.feature_store.default_targets = (
564	                server_cfg.get("feature_store_default_targets")
565	                or config.feature_store.default_targets

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
566	            )
567	            config.alerts.mode = server_cfg.get("alerts_mode") or config.alerts.mode
568	            config.system_id = server_cfg.get("system_id") or config.system_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
567	            config.alerts.mode = server_cfg.get("alerts_mode") or config.alerts.mode
568	            config.system_id = server_cfg.get("system_id") or config.system_id
569	            model_monitoring_store_prefixes = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
569	            model_monitoring_store_prefixes = (
570	                server_cfg.get("model_endpoint_monitoring_store_prefixes") or {}
571	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
572	            for prefix in ["default", "user_space", "monitoring_application"]:
573	                store_prefix_value = model_monitoring_store_prefixes.get(prefix)
574	                if server_prefix_value is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
638	        if resp.headers:
639	            state = resp.headers.get("x-mlrun-run-state", "")
640	            return state.lower(), resp.content

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:1456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1455	        # hash key optional to be backwards compatible to API v<0.4.10 in which it wasn't in the response
1456	        return resp.json().get("hash_key")
1457	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:1934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1933	            last_log_timestamp = float(
1934	                resp.headers.get("x-mlrun-last-timestamp", "0.0")
1935	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:1994
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1993	        if resp.headers:
1994	            func.status.state = resp.headers.get("x-mlrun-function-status", "")
1995	            last_log_timestamp = float(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:1996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1995	            last_log_timestamp = float(
1996	                resp.headers.get("x-mlrun-last-timestamp", "0.0")
1997	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:2003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2002	
2003	            builder_pod = resp.headers.get("builder_pod", "")
2004	            if builder_pod:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:2007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2006	
2007	            function_image = resp.headers.get("function_image", "")
2008	            if function_image:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:2011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2010	
2011	            deploy_status_text_kind = resp.headers.get(
2012	                "deploy_status_text_kind",
2013	                mlrun.common.constants.DeployStatusTextKind.logs,
2014	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:2235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2234	        with open(pipe_file, "rb") as fp:
2235	            data = fp.read()
2236	        if not isinstance(pipeline, str):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:2437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2436	            project
2437	            or feature_set["metadata"].get("project", None)
2438	            or config.default_project

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:2771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2770	        project = (
2771	            project or feature_set["metadata"].get("project") or config.default_project
2772	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:2860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2859	            project
2860	            or feature_vector["metadata"].get("project", None)
2861	            or config.default_project

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:2996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2995	            project
2996	            or feature_vector["metadata"].get("project")
2997	            or config.default_project

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:4550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4549	            if hasattr(workflow_spec, "image")
4550	            else workflow_spec.get("image", None)
4551	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:4555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4554	            if hasattr(workflow_spec, "name")
4555	            else workflow_spec.get("name", None)
4556	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:4832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4831	        results = []
4832	        for item in response.get("alerts", []):
4833	            results.append(AlertConfig(**item))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:5368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5367	        page_params = deepcopy(params) or {}
5368	        if page_params.get("page-token") is None and page_params.get("page") is None:
5369	            page_params["page"] = 1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:5368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5367	        page_params = deepcopy(params) or {}
5368	        if page_params.get("page-token") is None and page_params.get("page") is None:
5369	            page_params["page"] = 1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:5370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5369	            page_params["page"] = 1
5370	        if page_params.get("page-size") is None:
5371	            page_size = config.httpdb.pagination.default_page_size

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:5373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5372	
5373	            if page_params.get("limit") is not None:
5374	                page_size = page_params["limit"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:5383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5382	        # but rather simply fallback to use page-size.
5383	        if page_params.get("page-size") and page_params.get("limit"):
5384	            logger.warning(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/db/httpdb.py:5383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5382	        # but rather simply fallback to use page-size.
5383	        if page_params.get("page-size") and page_params.get("limit"):
5384	            logger.warning(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/execution.py:1318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1317	            with open(self._tmpfile, "w") as fp:
1318	                fp.write(data)
1319	                fp.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/frameworks/_common/model_handler.py:863
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
862	            with open(self._modules_map) as map_json_file:
863	                self._modules_map = json.loads(map_json_file.read())
864	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/frameworks/_common/model_handler.py:893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
892	            with open(self._custom_objects_map) as map_json_file:
893	                self._custom_objects_map = json.loads(map_json_file.read())
894	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/frameworks/parallel_coordinates.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
212	                # add runs table after the plot
213	                fp.write(html[: html.rfind("</body>")])
214	                fp.write("<br>" + html_table)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/frameworks/parallel_coordinates.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
213	                fp.write(html[: html.rfind("</body>")])
214	                fp.write("<br>" + html_table)
215	                fp.write("</body></html>")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/frameworks/parallel_coordinates.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
214	                fp.write("<br>" + html_table)
215	                fp.write("</body></html>")
216	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/frameworks/parallel_coordinates.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
216	            else:
217	                fp.write(html)
218	    if show or (show is None and mlrun.utils.is_jupyter):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/frameworks/tf_keras/model_handler.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
261	            with open(self._model_file, "w") as json_file:
262	                json_file.write(model_architecture)
263	            # Save the model weights (h5):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/frameworks/tf_keras/model_handler.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
315	            with open(self._model_file) as json_file:
316	                model_architecture = json_file.read()
317	            self._model = keras.models.model_from_json(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/launcher/remote.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	            run.metadata.labels[mlrun_constants.MLRunInternalLabels.v3io_user] = (
110	                os.environ.get("V3IO_USERNAME")
111	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model.py:679
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
678	            with open(requirements_file) as fp:
679	                requirements_to_resolve.extend(fp.read().splitlines())
680	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/applications/base.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
523	                    labels={
524	                        mlrun_constants.MLRunInternalLabels.runner_pod: socket.gethostname(),
525	                        mlrun_constants.MLRunInternalLabels.producer_type: "model-monitoring-job",

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/applications/base.py:524
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
523	                    labels={
524	                        mlrun_constants.MLRunInternalLabels.runner_pod: socket.gethostname(),
525	                        mlrun_constants.MLRunInternalLabels.producer_type: "model-monitoring-job",

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/applications/context.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
199	        labels = {
200	            mlrun_constants.MLRunInternalLabels.runner_pod: socket.gethostname(),
201	            mlrun_constants.MLRunInternalLabels.producer_type: "model-monitoring-app",

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/applications/context.py:200
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
199	        labels = {
200	            mlrun_constants.MLRunInternalLabels.runner_pod: socket.gethostname(),
201	            mlrun_constants.MLRunInternalLabels.producer_type: "model-monitoring-app",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/applications/evidently/base.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
119	                with location.open(metadata_path) as f:
120	                    print(f.read())
121	                continue

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/controller.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
715	        }
716	        with concurrent.futures.ThreadPoolExecutor(
717	            max_workers=min(len(endpoints), 10)
718	        ) as pool:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
193	        with StringIO() as query:
194	            query.write("SELECT ")
195	            if interval:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
195	            if interval:
196	                query.write("_wstart, _wend, ")
197	            if agg_funcs:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
202	                )
203	                query.write(
204	                    ", ".join(
205	                        [
206	                            f"{a}({col})"
207	                            if col.upper()
208	                            in map(
209	                                str.upper, preform_agg_funcs_columns
210	                            )  # Case-insensitive check
211	                            else f"{col}"
212	                            for a in agg_funcs
213	                            for col in columns_to_filter
214	                        ]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
217	            elif columns_to_filter:
218	                query.write(", ".join(columns_to_filter))
219	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
219	            else:
220	                query.write("*")
221	            query.write(f" FROM {database}.{table}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
220	                query.write("*")
221	            query.write(f" FROM {database}.{table}")
222	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
223	            if any([filter_query, start, end]):
224	                query.write(" WHERE ")
225	                if filter_query:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
225	                if filter_query:
226	                    query.write(f"{filter_query} AND ")
227	                if start:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
227	                if start:
228	                    query.write(f"{timestamp_column} >= '{start}' AND ")
229	                if end:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
229	                if end:
230	                    query.write(f"{timestamp_column} <= '{end}'")
231	            if group_by:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
233	                    group_by = ", ".join(group_by)
234	                query.write(f" GROUP BY {group_by}")
235	            if order_by:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
236	                desc = " DESC" if desc else ""
237	                query.write(f" ORDER BY {order_by}{desc}")
238	            if interval:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
238	            if interval:
239	                query.write(f" INTERVAL({interval})")
240	            if sliding_window_step:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
240	            if sliding_window_step:
241	                query.write(f" SLIDING({sliding_window_step})")
242	            if limit:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
242	            if limit:
243	                query.write(f" LIMIT {limit}")
244	            query.write(";")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/db/tsdb/tdengine/schemas.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
243	                query.write(f" LIMIT {limit}")
244	            query.write(";")
245	            return query.getvalue()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/model_monitoring/helpers.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
267	        )
268	    return mlrun.datastore.datastore_profile.datastore_profile_read(
269	        url=f"ds://{profile_name}", project_name=project, secrets=secret_provider
270	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/package/packagers/pandas_packagers.py:817
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
816	            read_kwargs = {}
817	        return formatter.read(file_path=file_path, **read_kwargs)
818	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/package/packagers/python_standard_library_packagers.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
215	        file_path = temp_directory / f"{key}.{file_format}"
216	        formatter.write(obj=obj, file_path=str(file_path))
217	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/package/packagers/python_standard_library_packagers.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
215	        file_path = temp_directory / f"{key}.{file_format}"
216	        formatter.write(obj=obj, file_path=str(file_path))
217	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/package/packagers/python_standard_library_packagers.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
249	        formatter = StructFileSupportedFormat.get_format_handler(fmt=file_format)
250	        obj = formatter.read(file_path=file_path)
251	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/package/packagers_manager.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
357	                if os.path.isdir(path):
358	                    shutil.rmtree(path)
359	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/package/utils/_archiver.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	            for path in directory_path.rglob("*"):
86	                zip_file.write(filename=path, arcname=path.relative_to(directory_path))
87	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/package/utils/_archiver.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
148	        # Archive:
149	        with tarfile.open(archive_path, f"w:{cls._MODE_STRING}") as tar_file:
150	            for path in directory_path.rglob("*"):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/package/utils/_archiver.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
180	        # Extract:
181	        with tarfile.open(archive_path, f"r:{cls._MODE_STRING}") as tar_file:
182	            # use 'data' to ensure no security risks are imposed by the archive files

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/platforms/iguazio.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	
47	    access_key = access_key or environ.get("V3IO_ACCESS_KEY")
48	    opts = {"accessKey": access_key}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/platforms/iguazio.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	    opts = {"accessKey": access_key}
49	    user = user or environ.get("V3IO_USERNAME")
50	    if user:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/platforms/iguazio.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
185	            serialized_record = dump_record(record)
186	            response = requests.post(self._stream_path, data=serialized_record)
187	            if not response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/platforms/iguazio.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
343	
344	    username = username or os.environ.get("V3IO_USERNAME")
345	    password = password or os.environ.get("V3IO_PASSWORD")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/platforms/iguazio.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
344	    username = username or os.environ.get("V3IO_USERNAME")
345	    password = password or os.environ.get("V3IO_PASSWORD")
346	    # V3IO_ACCESS_KEY` is used by other packages like v3io, MLRun also uses it as the access key used to

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/platforms/iguazio.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
352	        # in the import execution path (when we're initializing the run db) and therefore we can't import mlrun.runtimes
353	        or os.environ.get("MLRUN_AUTH_SESSION")
354	        or os.environ.get("V3IO_ACCESS_KEY")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/platforms/iguazio.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
353	        or os.environ.get("MLRUN_AUTH_SESSION")
354	        or os.environ.get("V3IO_ACCESS_KEY")
355	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/pipelines.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
108	            ) as workflow_fh:
109	                workflow_fh.write(self.code)
110	                self._tmp_path = workflow_path = workflow_fh.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/pipelines.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
108	            ) as workflow_fh:
109	                workflow_fh.write(self.code)
110	                self._tmp_path = workflow_path = workflow_fh.name

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
240	            clone_git(from_template, context, secrets, clone=True)
241	            shutil.rmtree(path.join(context, ".git"))
242	            project = _load_project_dir(context, name, allow_cross_project=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
662	        with open(project_file_path) as fp:
663	            data = fp.read()
664	            struct = yaml.load(data, Loader=yaml.FullLoader)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
663	            data = fp.read()
664	            struct = yaml.load(data, Loader=yaml.FullLoader)
665	            project = _project_instance_from_struct(struct, name, allow_cross_project)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
708	            raise ValueError("user_project must be specified together with name")
709	        username = environ.get("V3IO_USERNAME") or getpass.getuser()
710	        normalized_username = mlrun.utils.normalize_project_username(username.lower())

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
708	            raise ValueError("user_project must be specified together with name")
709	        username = environ.get("V3IO_USERNAME") or getpass.getuser()
710	        normalized_username = mlrun.utils.normalize_project_username(username.lower())

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:709
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
708	            raise ValueError("user_project must be specified together with name")
709	        username = environ.get("V3IO_USERNAME") or getpass.getuser()
710	        normalized_username = mlrun.utils.normalize_project_username(username.lower())

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
742	        raise FileNotFoundError(f"cant find project file at {url}") from exc
743	    struct = yaml.load(obj, Loader=yaml.FullLoader)
744	    return _project_instance_from_struct(struct, name, allow_cross_project)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
747	def _project_instance_from_struct(struct, name, allow_cross_project):
748	    name_from_struct = struct.get("metadata", {}).get("name", "")
749	    if name and name_from_struct and name_from_struct != name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
747	def _project_instance_from_struct(struct, name, allow_cross_project):
748	    name_from_struct = struct.get("metadata", {}).get("name", "")
749	    if name and name_from_struct and name_from_struct != name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:956
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
955	            if isinstance(function, dict):
956	                name = function.get("name", "")
957	                if not name:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:1436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1435	            with open(workflow_path) as fp:
1436	                txt = fp.read()
1437	            workflow = {"name": name, "code": txt}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:1524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1523	                    artifact_dict["key"],
1524	                    tag=artifact_dict.get("tag"),
1525	                )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:2050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
2049	        if is_yaml_path(item_path):
2050	            artifact_dict = yaml.load(dataitem.get(), Loader=yaml.FullLoader)
2051	            artifact = get_artifact(artifact_dict)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:2050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2049	        if is_yaml_path(item_path):
2050	            artifact_dict = yaml.load(dataitem.get(), Loader=yaml.FullLoader)
2051	            artifact = get_artifact(artifact_dict)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:2053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2052	        elif item_path.endswith(".json"):
2053	            artifact_dict = json.loads(dataitem.get())
2054	            artifact = get_artifact(artifact_dict)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:2061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2060	                with open(f"{temp_dir}/_spec.yaml") as fp:
2061	                    data = fp.read()
2062	                spec = yaml.load(data, Loader=yaml.FullLoader)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:2062
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
2061	                    data = fp.read()
2062	                spec = yaml.load(data, Loader=yaml.FullLoader)
2063	                artifact = get_artifact(spec)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:2065
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2064	                with open(f"{temp_dir}/_body", "rb") as fp:
2065	                    artifact.spec._body = fp.read()
2066	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:3217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3216	        for name in names:
3217	            function_definition = self.spec._function_definitions.get(name)
3218	            if not function_definition:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:3227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3226	
3227	            function_object = self.spec._function_objects.get(name, None)
3228	            is_base_runtime = isinstance(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:3319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3318	        if self._secrets:
3319	            return self._secrets.get(key)
3320	        return None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:3378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3377	        if self.spec.params:
3378	            return self.spec.params.get(key, default)
3379	        return default

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:3654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3653	        with open(project_file_path, "w") as fp:
3654	            fp.write(self.to_yaml())
3655	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:3654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3653	        with open(project_file_path, "w") as fp:
3654	            fp.write(self.to_yaml())
3655	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:3666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3665	                        write_path = pathlib.Path(file_path)
3666	                        zipf.write(
3667	                            write_path, arcname=write_path.relative_to(project_dir)
3668	                        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:3666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3665	                        write_path = pathlib.Path(file_path)
3666	                        zipf.write(
3667	                            write_path, arcname=write_path.relative_to(project_dir)
3668	                        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:3670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
3669	                if remote_file:
3670	                    mlrun.get_dataitem(filepath).upload(zipf.filename)
3671	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:4855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4854	        """
4855	        profile = datastore_profile_read(f"ds://{name}", self.name)
4856	        return profile.attributes()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5317	
5318	            producer_tag = producer_dict.get("tag", None)
5319	            producer_project = producer_dict.get("project", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5318	            producer_tag = producer_dict.get("tag", None)
5319	            producer_project = producer_dict.get("project", None)
5320	            if not producer_tag or not producer_project:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5321	                # try resolving the producer tag from the uri
5322	                producer_uri = artifact.spec.producer.get("uri", "")
5323	                producer_project, producer_tag, _ = ArtifactProducer.parse_uri(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5326	
5327	            if producer_dict.get("kind", "") == "run":
5328	                return (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5329	                    ArtifactProducer(
5330	                        name=producer_dict.get("name", ""),
5331	                        kind=producer_dict.get("kind", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5330	                        name=producer_dict.get("name", ""),
5331	                        kind=producer_dict.get("kind", ""),
5332	                        project=producer_project,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5333	                        tag=producer_tag,
5334	                        owner=producer_dict.get("owner", ""),
5335	                    ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5402	) -> tuple[str, mlrun.runtimes.BaseRuntime]:
5403	    name = name or f.get("name", "")
5404	    url = f.get("url", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5403	    name = name or f.get("name", "")
5404	    url = f.get("url", "")
5405	    kind = f.get("kind", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5404	    url = f.get("url", "")
5405	    kind = f.get("kind", "")
5406	    image = f.get("image", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5405	    kind = f.get("kind", "")
5406	    image = f.get("image", None)
5407	    handler = f.get("handler", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5406	    image = f.get("image", None)
5407	    handler = f.get("handler", None)
5408	    with_repo = f.get("with_repo", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5407	    handler = f.get("handler", None)
5408	    with_repo = f.get("with_repo", False)
5409	    requirements = f.get("requirements", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5408	    with_repo = f.get("with_repo", False)
5409	    requirements = f.get("requirements", None)
5410	    requirements_file = f.get("requirements_file", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5409	    requirements = f.get("requirements", None)
5410	    requirements_file = f.get("requirements_file", None)
5411	    tag = f.get("tag", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/projects/project.py:5411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5410	    requirements_file = f.get("requirements_file", None)
5411	    tag = f.get("tag", None)
5412	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
166	                ) as temp_file:
167	                    code = b64decode(code).decode("utf-8")
168	                    command = temp_file.name

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:167
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
166	                ) as temp_file:
167	                    code = b64decode(code).decode("utf-8")
168	                    command = temp_file.name

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	                    command = temp_file.name
169	                    temp_file.write(code)
170	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
168	                    command = temp_file.name
169	                    temp_file.write(code)
170	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
326	    ctx = MLClientCtx.from_dict(
327	        newspec, rundb=out, autocommit=autocommit, tmp=tmp, host=socket.gethostname()
328	    )

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:327
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
326	    ctx = MLClientCtx.from_dict(
327	        newspec, rundb=out, autocommit=autocommit, tmp=tmp, host=socket.gethostname()
328	    )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
399	            ) as temp_file:
400	                code = b64decode(code).decode("utf-8")
401	                update_in(runtime, "spec.command", temp_file.name)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:400
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
399	            ) as temp_file:
400	                code = b64decode(code).decode("utf-8")
401	                update_in(runtime, "spec.command", temp_file.name)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
401	                update_in(runtime, "spec.command", temp_file.name)
402	                temp_file.write(code)
403	        elif remote and cmd:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
401	                update_in(runtime, "spec.command", temp_file.name)
402	                temp_file.write(code)
403	        elif remote and cmd:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
411	            with open(code_file, "wb") as fp:
412	                fp.write(code)
413	        elif cmd:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
411	            with open(code_file, "wb") as fp:
412	                fp.write(code)
413	        elif cmd:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:792
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
791	            with open(code_output, "w") as fp:
792	                fp.write(code)
793	        else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/run.py:792
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
791	            with open(code_output, "w") as fp:
792	                fp.write(code)
793	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/base.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	        return (
247	            self.metadata.labels.get(mm_constants.ModelMonitoringAppLabel.KEY, "")
248	            == mm_constants.ModelMonitoringAppLabel.VAL

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/base.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
523	                resp = self._update_run_state(resp, task=task)
524	                run_results = resp["status"].get("results", {})
525	                if generator.eval_stop_condition(run_results):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/base.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
670	            return f"{registry}/{image[1:]}"
671	        namespace_domain = environ.get("IGZ_NAMESPACE_DOMAIN", None)
672	        if namespace_domain is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/base.py:798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
797	                with open(from_file) as fp:
798	                    body = fp.read()
799	            if self.kind == mlrun.runtimes.RuntimeKinds.serving:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/base.py:929
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
928	            for name, entry in self.spec.entry_points.items():
929	                print(f"  {name}: {entry.get('doc', '')}")
930	                params = entry.get("parameters")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/base.py:930
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
929	                print(f"  {name}: {entry.get('doc', '')}")
930	                params = entry.get("parameters")
931	                if params:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/base.py:936
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
935	                            line += f"({p['type']})"
936	                        line += "  - " + p.get("doc", "")
937	                        if "default" in p:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/daskjob.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
292	            client.shutdown()
293	            client.close()
294	        except ValueError:

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/daskjob.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
542	            autocommit=False,
543	            host=socket.gethostname(),
544	        )

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/daskjob.py:543
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
542	            autocommit=False,
543	            host=socket.gethostname(),
544	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/databricks_job/databricks_runtime.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
147	
148	        decoded_code = b64decode(encoded_code).decode("utf-8")
149	        decoded_code, is_replaced = replace_log_artifact_function(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/databricks_job/databricks_runtime.py:148
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
147	
148	        decoded_code = b64decode(encoded_code).decode("utf-8")
149	        decoded_code, is_replaced = replace_log_artifact_function(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/databricks_job/databricks_wrapper.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
127	    )
128	    spark_app_code = b64decode(spark_app_code)
129	    if workspace.dbfs.exists(artifact_json_path):

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/databricks_job/databricks_wrapper.py:128
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
127	    )
128	    spark_app_code = b64decode(spark_app_code)
129	    if workspace.dbfs.exists(artifact_json_path):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
143	
144	        client.close()
145	        if function_name and generator.options.teardown_dask:

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
163	        autocommit=False,
164	        host=socket.gethostname(),
165	    )

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:164
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
163	        autocommit=False,
164	        host=socket.gethostname(),
165	    )

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
186	            tmp=tmp,
187	            host=socket.gethostname(),
188	        )

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:187
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
186	            tmp=tmp,
187	            host=socket.gethostname(),
188	        )

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
300	                tmp=tmp,
301	                host=socket.gethostname(),
302	            )

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:301
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
300	                tmp=tmp,
301	                host=socket.gethostname(),
302	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
366	                with open(tmp) as fp:
367	                    resp = fp.read()
368	                remove(tmp)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
437	                break
438	            stderr.write(nextline)
439	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
437	                break
438	            stderr.write(nextline)
439	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
442	    with io.StringIO() as stderr:
443	        stderr_consumer_thread = threading.Thread(target=read_stderr, args=[stderr])
444	        stderr_consumer_thread.start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
452	                sys.stdout.flush()
453	                stdout.write(nextline)
454	            out = stdout.getvalue()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
452	                sys.stdout.flush()
453	                stdout.write(nextline)
454	            out = stdout.getvalue()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
473	    def write(self, message):
474	        self.terminal.write(message)
475	        self.buf.write(message)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
473	    def write(self, message):
474	        self.terminal.write(message)
475	        self.buf.write(message)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
474	        self.terminal.write(message)
475	        self.buf.write(message)
476	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/local.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
474	        self.terminal.write(message)
475	        self.buf.write(message)
476	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/api_gateway.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	                return BasicAuth(
48	                    username=api_gateway_spec.authentication.get("username", ""),
49	                    password=api_gateway_spec.authentication.get("password", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/api_gateway.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	                    username=api_gateway_spec.authentication.get("username", ""),
49	                    password=api_gateway_spec.authentication.get("password", ""),
50	                )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/api_gateway.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
461	
462	        return requests.request(
463	            method=method,
464	            url=url,
465	            headers=headers or {},
466	            auth=auth,
467	            **kwargs,
468	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/api_gateway.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
603	    def from_scheme(cls, api_gateway: schemas.APIGateway):
604	        project = api_gateway.metadata.labels.get(
605	            mlrun_constants.MLRunInternalLabels.nuclio_project_name
606	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/api_gateway.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
693	    def _generate_basic_auth(username: str, password: str):
694	        token = base64.b64encode(f"{username}:{password}".encode()).decode()
695	        return f"Basic {token}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/api_gateway.py:694
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
693	    def _generate_basic_auth(username: str, password: str):
694	        token = base64.b64encode(f"{username}:{password}".encode()).decode()
695	        return f"Basic {token}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/api_gateway.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
701	        if len(upstreams) == 1:
702	            return [upstreams[0].nucliofunction.get("name")], None
703	        elif len(upstreams) == 2:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/api_gateway.py:706
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
705	            functions = [
706	                upstreams[0].nucliofunction.get("name"),
707	                upstreams[1].nucliofunction.get("name"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/api_gateway.py:707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
706	                upstreams[0].nucliofunction.get("name"),
707	                upstreams[1].nucliofunction.get("name"),
708	            ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/application/application.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
738	        self.set_env("SIDECAR_PORT", self.spec.internal_application_port)
739	        self.set_env("SIDECAR_HOST", "http://localhost")
740	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
305	                    for sub_key in nested_keys[:-1]:
306	                        target = target.get(sub_key, {})
307	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
361	            num_triggers = 0
362	            trigger_name = spec.get("name", "UNKNOWN")
363	            for key, config in [(f"spec.triggers.{trigger_name}", spec)] + list(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
368	                    explicit_ack_enabled = (
369	                        config.get("explicitAckMode", "disable") != "disable"
370	                    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
593	                seek_to=seek_to,
594	                webapi=endpoint or "http://v3io-webapi:8081",
595	                extra_attributes=extra_attributes,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
652	        data = db.deploy_nuclio_function(func=self, builder_env=builder_env)
653	        self.status = data["data"].get("status")
654	        self._update_credentials_from_remote_build(data["data"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
857	
858	            value = sanitized_env_var.get("value")
859	            if value is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
859	            if value is not None:
860	                env_dict[sanitized_env_var.get("name")] = value
861	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:863
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
862	
863	            value_from = sanitized_env_var.get("valueFrom")
864	            if value_from is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
864	            if value_from is not None:
865	                external_source_env_dict[sanitized_env_var.get("name")] = value_from
866	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1005	                self._http_session = requests.Session()
1006	            resp = self._http_session.request(
1007	                method, path, headers=headers, **http_client_kwargs
1008	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1005	                self._http_session = requests.Session()
1006	            resp = self._http_session.request(
1007	                method, path, headers=headers, **http_client_kwargs
1008	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1060	
1061	        if args and sidecar.get("command"):
1062	            sidecar["args"] = mlrun.utils.helpers.as_list(args)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1085
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1084	            if isinstance(spec, dict):
1085	                if spec.get("kind") == kind:
1086	                    return True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1125	
1126	        logs = resp.headers.get("X-Nuclio-Logs")
1127	        if logs:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1240	    def _update_credentials_from_remote_build(self, remote_data):
1241	        self.metadata.credentials = remote_data.get("metadata", {}).get(
1242	            "credentials", {}
1243	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1240	    def _update_credentials_from_remote_build(self, remote_data):
1241	        self.metadata.credentials = remote_data.get("metadata", {}).get(
1242	            "credentials", {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1269	        # add credentials env vars from remote build
1270	        for remote_env in remote_data.get("spec", {}).get("env", []):
1271	            if remote_env.get("name") in credentials_env_var_names:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1269	        # add credentials env vars from remote build
1270	        for remote_env in remote_data.get("spec", {}).get("env", []):
1271	            if remote_env.get("name") in credentials_env_var_names:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1270	        for remote_env in remote_data.get("spec", {}).get("env", []):
1271	            if remote_env.get("name") in credentials_env_var_names:
1272	                new_env.append(remote_env)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1364	            text = await response.text()
1365	            logs = response.headers.get("X-Nuclio-Logs", None)
1366	            return response.status, text, logs, run

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1442	):
1443	    func.status.state = headers.get("x-mlrun-function-status", "")
1444	    func.status.address = headers.get("x-mlrun-address", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1443	    func.status.state = headers.get("x-mlrun-function-status", "")
1444	    func.status.address = headers.get("x-mlrun-address", "")
1445	    func.status.nuclio_name = headers.get("x-mlrun-name", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1444	    func.status.address = headers.get("x-mlrun-address", "")
1445	    func.status.nuclio_name = headers.get("x-mlrun-name", "")
1446	    func.status.internal_invocation_urls = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1447	        headers.get("x-mlrun-internal-invocation-urls", "").split(",")
1448	        if headers.get("x-mlrun-internal-invocation-urls")
1449	        else []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1446	    func.status.internal_invocation_urls = (
1447	        headers.get("x-mlrun-internal-invocation-urls", "").split(",")
1448	        if headers.get("x-mlrun-internal-invocation-urls")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1452	        headers.get("x-mlrun-external-invocation-urls", "").split(",")
1453	        if headers.get("x-mlrun-external-invocation-urls")
1454	        else []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1451	    func.status.external_invocation_urls = (
1452	        headers.get("x-mlrun-external-invocation-urls", "").split(",")
1453	        if headers.get("x-mlrun-external-invocation-urls")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/function.py:1456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1455	    )
1456	    func.status.container_image = headers.get("x-mlrun-container-image", "")

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/nuclio.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
76	        log_stream=context.logger,
77	        host=socket.gethostname(),
78	        store_run=False,

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/nuclio/nuclio.py:77
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
76	        log_stream=context.logger,
77	        host=socket.gethostname(),
78	        store_run=False,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	                # we pull from self
331	                envs = struct.get(field_name, None) or getattr(self, field_name, None)
332	                if envs:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:942
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
941	            if value:
942	                spec_value = self_node_selector.get(key)
943	                if spec_value and spec_value == value:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:1458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1457	        )
1458	        self.status = data["data"].get("status", None)
1459	        self.spec.image = mlrun.utils.get_in(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:1469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1468	        ) or mlrun.utils.get_in(data, "data.spec.clone_target_dir")
1469	        ready = data.get("ready", False)
1470	        if not ready:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:1472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1471	            logger.info(
1472	                f"Started building image: {data.get('data', {}).get('spec', {}).get('build', {}).get('image')}"
1473	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:1472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1471	            logger.info(
1472	                f"Started building image: {data.get('data', {}).get('spec', {}).get('build', {}).get('image')}"
1473	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:1472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1471	            logger.info(
1472	                f"Started building image: {data.get('data', {}).get('spec', {}).get('build', {}).get('image')}"
1473	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:1472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1471	            logger.info(
1472	                f"Started building image: {data.get('data', {}).get('spec', {}).get('build', {}).get('image')}"
1473	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:1561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1560	            raise mlrun.errors.MLRunInvalidArgumentTypeError(
1561	                f"{attribute_name} must be instance of kubernetes {attribute_config.get('attribute_type_name')} class "
1562	                f"but contains not sanitized key: {key}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:1634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1633	            raise mlrun.errors.MLRunInvalidArgumentTypeError(
1634	                f"expected to be of type {attribute_config.get('not_sanitized_class')} but got dict"
1635	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/pod.py:1644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1643	            raise mlrun.errors.MLRunInvalidArgumentTypeError(
1644	                f"expected to be of type {attribute_config.get('not_sanitized_class')} but got list"
1645	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/sparkjob/spark3job.py:830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
829	    def _is_using_gpu(self):
830	        driver_limits = self.spec.driver_resources.get("limits")
831	        driver_gpu = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/sparkjob/spark3job.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
834	
835	        executor_limits = self.spec.executor_resources.get("limits")
836	        executor_gpu = None

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/utils.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
438	    labels_enrichment = {
439	        RunLabels.owner: os.environ.get("V3IO_USERNAME") or getpass.getuser(),
440	        # TODO: remove this in 1.9.0

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/runtimes/utils.py:439
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
438	    labels_enrichment = {
439	        RunLabels.owner: os.environ.get("V3IO_USERNAME") or getpass.getuser(),
440	        # TODO: remove this in 1.9.0

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/secrets.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	            with open(source) as fp:
52	                lines = fp.read().splitlines()
53	                secrets_dict = list2dict(lines)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
152	        body = self._get_event_or_body(event)
153	        method, url, headers, body = self._generate_request(event, body)
154	        kwargs = {}

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
152	        body = self._get_event_or_body(event)
153	        method, url, headers, body = self._generate_request(event, body)
154	        kwargs = {}

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
157	        try:
158	            resp = await self._client_session.request(
159	                method, url, headers=headers, data=body, ssl=False, **kwargs
160	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
157	        try:
158	            resp = await self._client_session.request(
159	                method, url, headers=headers, data=body, ssl=False, **kwargs
160	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
193	        body = _extract_input_data(self._input_path, event.body)
194	        method, url, headers, body = self._generate_request(event, body)
195	        try:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
193	        body = _extract_input_data(self._input_path, event.body)
194	        method, url, headers, body = self._generate_request(event, body)
195	        try:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
195	        try:
196	            resp = self._session.request(
197	                method,
198	                url,
199	                verify=mlrun.mlconf.httpdb.http.verify,
200	                headers=headers,
201	                data=body,
202	                timeout=self.timeout,
203	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
195	        try:
196	            resp = self._session.request(
197	                method,
198	                url,
199	                verify=mlrun.mlconf.httpdb.http.verify,
200	                headers=headers,
201	                data=body,
202	                timeout=self.timeout,
203	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
247	            self.return_json
248	            or headers.get("content-type", "").lower() == "application/json"
249	        ) and isinstance(data, (str, bytes)):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
408	    async def _submit(self, method, url, headers, body):
409	        async with self._client_session.request(
410	            method, url, headers=headers, data=body, ssl=False, **self._request_args
411	        ) as future:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
408	    async def _submit(self, method, url, headers, body):
409	        async with self._client_session.request(
410	            method, url, headers=headers, data=body, ssl=False, **self._request_args
411	        ) as future:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/remote.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
452	            self.return_json
453	            or headers.get("content-type", "").lower() == "application/json"
454	        ) and isinstance(data, (str, bytes)):

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/server.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
64	        self.enabled = False
65	        self.hostname = socket.gethostname()
66	        self.function_uri = function_uri

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/server.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
64	        self.enabled = False
65	        self.hostname = socket.gethostname()
66	        self.function_uri = function_uri

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/server.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
639	        "worker": context.worker_id,
640	        "host": socket.gethostname(),
641	        "source": source,

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/server.py:640
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
639	        "worker": context.worker_id,
640	        "host": socket.gethostname(),
641	        "source": source,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/states.py:1942
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1941	                    if stream_path and stream_path.startswith("ds://"):
1942	                        datastore_profile = datastore_profile_read(stream_path)
1943	                        if isinstance(

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/v1_serving.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
149	    # Initialize route handlers
150	    hostname = socket.gethostname()
151	    server_context = _ServerInfo(context, hostname, model_class)

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/v1_serving.py:150
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
149	    # Initialize route handlers
150	    hostname = socket.gethostname()
151	    server_context = _ServerInfo(context, hostname, model_class)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/v1_serving.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
235	                self.context.logger.debug_with(f"downloading data url={url}")
236	                data = urlopen(url).read()
237	                sample = BytesIO(data)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/serving/v1_serving.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
235	                self.context.logger.debug_with(f"downloading data url={url}")
236	                data = urlopen(url).read()
237	                sample = BytesIO(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/track/trackers/mlflow_tracker.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
455	            for path in model_uri.rglob("*"):
456	                zip_file.write(filename=path, arcname=path.relative_to(model_uri))
457	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/track/trackers/mlflow_tracker.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
455	            for path in model_uri.rglob("*"):
456	                zip_file.write(filename=path, arcname=path.relative_to(model_uri))
457	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/track/trackers/mlflow_tracker.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
518	                for path in local_path.rglob("*"):
519	                    zip_file.write(filename=path, arcname=path.relative_to(local_path))
520	            # Set the local path to the archive file:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/track/trackers/mlflow_tracker.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
518	                for path in local_path.rglob("*"):
519	                    zip_file.write(filename=path, arcname=path.relative_to(local_path))
520	            # Set the local path to the archive file:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/azure_vault.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	            with open(full_path) as secret_file:
67	                contents = secret_file.read()
68	            return contents

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/clones.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
35	        elif os.path.isdir(file_path):
36	            shutil.rmtree(file_path)
37	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/clones.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
71	    tmpfile = _prep_dir(source, target_dir, ".tar.gz", secrets, clone)
72	    with tarfile.TarFile.open(tmpfile, "r:*") as tf:
73	        tf.extractall(path=target_dir)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/condition_evaluator.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
27	    receiver, sender = multiprocessing.Pipe()
28	    p = multiprocessing.Process(
29	        target=_evaluate_condition_wrapper,
30	        args=(sender, condition, context),
31	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/helpers.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
307	        raise mlrun.errors.MLRunBadRequestError(
308	            "The body of the artifact exceeds the maximum allowed size. "
309	            "Avoid embedding the artifact body. "
310	            "This increases the size of the project yaml file and could affect the project during loading and saving. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/helpers.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
350	        logger.warning(
351	            "The image has an unexpected protocol prefix ('http://' or 'https://'). "
352	            "If you wish to use the default configured registry, no protocol prefix is required "
353	            "(note that you can also use '.<image-name>' instead of the full URL where <image-name> is a placeholder). "
354	            "Removing protocol prefix from image.",
355	            image=image,
356	        )
357	    return image

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/helpers.py:1872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1871	        with open(mlrun.common.constants.MLRUN_SERVING_SPEC_PATH) as f:
1872	            data = f.read()
1873	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/helpers.py:1884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1883	    try:
1884	        decoded_data = base64.b64decode(data)
1885	        decompressed_data = gzip.decompress(decoded_data)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/helpers.py:1884
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1883	    try:
1884	        decoded_data = base64.b64decode(data)
1885	        decompressed_data = gzip.decompress(decoded_data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/helpers.py:2248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
2247	        user_code = user_code.encode("utf-8")
2248	    encoded = base64.b64encode(user_code).decode("utf-8")
2249	    if len(encoded) > max_len_warning:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/helpers.py:2248
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
2247	        user_code = user_code.encode("utf-8")
2248	    encoded = base64.b64encode(user_code).decode("utf-8")
2249	    if len(encoded) > max_len_warning:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/http.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
116	            try:
117	                response = super().request(method, url, **kwargs)
118	                return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/notifications/notification/git.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	                with open(os.environ["GITHUB_EVENT_PATH"]) as fp:
138	                    data = fp.read()
139	                    event = json.loads(data)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/utils/notifications/notification_pusher.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
82	        """
83	        thread_pool_executor = ThreadPoolExecutor(1)
84	        async_event_loop = asyncio.new_event_loop()

--------------------------------------------------

Code scanned:
	Total lines of code: 87756
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 50.0
		High: 345.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 364.0
		High: 31.0
Files skipped (0):
