Run started:2025-04-12 14:03:20.395180

Test results:
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ai/_convert.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
140	                        "mime_type": content_type,
141	                        "data": base64.b64decode(
142	                            _extract_data(attachment.url)
143	                        ),

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ai/_convert.py:141
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
140	                        "mime_type": content_type,
141	                        "data": base64.b64decode(
142	                            _extract_data(attachment.url)
143	                        ),

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ai/_convert.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
160	        data = url.split(",")[1]
161	        return base64.b64decode(data).decode("utf-8")
162	    else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ai/_convert.py:161
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
160	        data = url.split(",")[1]
161	        return base64.b64decode(data).decode("utf-8")
162	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ai/text_to_notebook.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	TERMS = """
19	Before using marimo's Text-To-Notebook AI feature, you should know:
20	
21	1. Your prompt will be sent to marimo's API at `https://ai.marimo.app/`
22	2. The API uses OpenAI/Anthropic's models to convert your prompt into a notebook
23	3. Your prompt is securely stored for caching purposes (fast response times)
24	4. No personal data beyond the prompt itself is collected
25	5. You can revoke consent at any time by modifying ~/.marimo/state.toml
26	"""
27	
28	TERMS_LAST_UPDATED = datetime.datetime(2025, 4, 1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ai/text_to_notebook.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	    try:
69	        url = f"https://ai.marimo.app/api/notebook.py?prompt={urllib.parse.quote(prompt)}"
70	        print_(muted("Generating notebook this may take a few seconds..."))

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ai/text_to_notebook.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
75	
76	        with urllib.request.urlopen(req) as response:
77	            result = response.read().decode("utf-8")  # type: ignore[attr-defined]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/app.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	            for var in self._cell.defs:
144	                self._glbls[var] = self._frame.f_locals.get(var, None)
145	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/app.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
153	                app = self._cell._app._app
154	            self._frame.f_locals["app"] = self._previous.get("app", app)
155	            # lose ref

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/app.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190	        app_runners = self._runners.setdefault(threading.get_ident(), {})
191	        runner = app_runners.get(app, None)
192	        if runner is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/app.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	    def remove_runner(self, app: App) -> None:
198	        app_runners = self._runners.get(tid := threading.get_ident(), {})
199	        if app in app_runners:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/app.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
278	            # If the cell exists, the cell data should be set.
279	            cell_data = self._cell_manager._cell_data.get(cell_id)
280	            new_cell_id = app._cell_manager.create_cell_id()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/app.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
765	            layout_file = layout_path.read_bytes()
766	            data_uri = base64.b64encode(layout_file).decode()
767	            self.update_config(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/app.py:766
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
765	            layout_file = layout_path.read_bytes()
766	            data_uri = base64.b64encode(layout_file).decode()
767	            self.update_config(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/app.py:786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
785	            # If the cell exists, the cell data should be set.
786	            cell_data = self._app._cell_manager._cell_data.get(cell_id)
787	            if cell_data is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/codegen.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
424	    with open(filename, encoding="utf-8") as f:
425	        contents = f.read().strip()
426	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/codegen.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
470	    with open(filename, encoding="utf-8") as f:
471	        contents = f.read()
472	    cells = json.loads(contents)["cells"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_ast/codegen.py:513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
512	    with open(filename, encoding="utf-8") as f:
513	        contents = f.read()
514	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/cli.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
236	                and select.select([sys.stdin], [], [], 0)[0]
237	                and (contents := sys.stdin.read().strip())
238	            ):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/cli.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
274	    "--host",
275	    default="127.0.0.1",
276	    show_default=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/cli.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
480	        "",
481	        "Visit https://marimo.app/ai for more prompt examples.",
482	    ]
483	)
484	
485	
486	@main.command(help=new_help_msg)
487	@click.option(
488	    "-p",
489	    "--port",
490	    default=None,
491	    show_default=True,
492	    type=int,
493	    help="Port to attach to.",
494	)
495	@click.option(
496	    "--host",
497	    default="127.0.0.1",
498	    show_default=True,
499	    type=str,
500	    help="Host to attach to.",
501	)
502	@click.option(
503	    "--proxy",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/cli.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
591	            ) as temp_file:
592	                temp_file.write(notebook_content)
593	            file_router = AppFileRouter.infer(temp_file.name)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/cli.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
591	            ) as temp_file:
592	                temp_file.write(notebook_content)
593	            file_router = AppFileRouter.infer(temp_file.name)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/cli.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
496	    "--host",
497	    default="127.0.0.1",
498	    show_default=True,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/cli.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
655	    "--host",
656	    default="127.0.0.1",
657	    show_default=True,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/cli.py:860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
859	    "--host",
860	    default="127.0.0.1",
861	    show_default=True,

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/convert/utils.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
16	        notebook = (
17	            urllib.request.urlopen(get_github_src_url(file_path))
18	            .read()

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/convert/utils.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
21	    elif is_url(file_path):
22	        notebook = urllib.request.urlopen(file_path).read().decode("utf-8")
23	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/development/commands.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
243	            del processed_classes[cls]
244	        name = name_overrides.get(cls, cls.__name__)  # type: ignore[attr-defined]
245	        component_schemas[name] = converter.convert(cls, processed_classes)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/development/commands.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
255	            del processed_classes[cls]
256	        name = name_overrides.get(cls, cls.__name__)  # type: ignore[attr-defined]
257	        component_schemas[name] = converter.convert(cls, processed_classes)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/development/commands.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
396	        raise click.UsageError(
397	            "uv is not installed. See https://docs.astral.sh/uv/getting-started/installation/"
398	        )
399	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/development/commands.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
426	        pypi_names = [
427	            package_names.get(mod, mod.replace("_", "-"))
428	            for mod in imported_modules

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/envinfo.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
45	    os_version = platform.release()
46	    if platform.system() == "Windows" and is_win11():
47	        os_version = "11"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/envinfo.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
45	    os_version = platform.release()
46	    if platform.system() == "Windows" and is_win11():
47	        os_version = "11"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/envinfo.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
50	        "marimo": __version__,
51	        "OS": platform.system(),
52	        "OS Version": os_version,

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/envinfo.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
50	        "marimo": __version__,
51	        "OS": platform.system(),
52	        "OS Version": os_version,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    path = path.replace("/blob/", "/", 1)
39	    return f"https://raw.githubusercontent.com{path}"
40	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	        return is_url(name) and name.startswith(
69	            "https://github.com/marimo-team/marimo/issues/"
70	        )
71	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	        issue_number = name.split("/")[-1]
74	        api_url = f"https://api.github.com/repos/marimo-team/marimo/issues/{issue_number}"
75	        issue_response = urllib.request.urlopen(api_url).read().decode("utf-8")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	        api_url = f"https://api.github.com/repos/marimo-team/marimo/issues/{issue_number}"
75	        issue_response = urllib.request.urlopen(api_url).read().decode("utf-8")
76	        issue_json = json.loads(issue_response)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
74	        api_url = f"https://api.github.com/repos/marimo-team/marimo/issues/{issue_number}"
75	        issue_response = urllib.request.urlopen(api_url).read().decode("utf-8")
76	        issue_json = json.loads(issue_response)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
110	            file_contents = (
111	                urllib.request.urlopen(request).read().decode("utf-8")
112	            )

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
110	            file_contents = (
111	                urllib.request.urlopen(request).read().decode("utf-8")
112	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	        # Starts with https://static.marimo.app/, append /download
126	        if url.startswith("https://static.marimo.app/"):
127	            return download(os.path.join(url, "download"))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
154	        url = get_github_src_url(name)
155	        content = urllib.request.urlopen(url).read().decode("utf-8")
156	        return content, os.path.basename(url)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
154	        url = get_github_src_url(name)
155	        content = urllib.request.urlopen(url).read().decode("utf-8")
156	        return content, os.path.basename(url)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
163	    def read(self, name: str) -> tuple[str, str]:
164	        content = urllib.request.urlopen(name).read().decode("utf-8")
165	        # Remove query parameters from the URL

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
163	    def read(self, name: str) -> tuple[str, str]:
164	        content = urllib.request.urlopen(name).read().decode("utf-8")
165	        # Remove query parameters from the URL

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
193	        for reader in self.readers:
194	            if reader.can_read(name):
195	                return reader.read(name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/file_path.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
194	            if reader.can_read(name):
195	                return reader.read(name)
196	        raise ValueError(f"Unable to read file contents of {name}")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/run_docker.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
101	
102	    host = "0.0.0.0"
103	    if port is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/sandbox.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
202	                "This notebook has inlined package dependencies. \n"
203	                + "Consider installing uv so that marimo can create a "
204	                "temporary venv with the notebook's packages: "
205	                "https://github.com/astral-sh/uv"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/sandbox.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
311	    ) as temp_file:
312	        temp_file.write("\n".join(dependencies))
313	        temp_file_path = temp_file.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/sandbox.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
311	    ) as temp_file:
312	        temp_file.write("\n".join(dependencies))
313	        temp_file_path = temp_file.name

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/sandbox.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
389	
390	    signal.signal(signal.SIGINT, handler)
391	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/sandbox.py:390
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
389	
390	    signal.signal(signal.SIGINT, handler)
391	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/upgrade.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	    if is_test:
80	        api_url = "https://pypi.org/pypi/marimo/json"
81	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/upgrade.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	    else:
82	        api_url = "https://marimo.io/api/oss/latest-version"
83	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/upgrade.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
109	    try:
110	        with urllib.request.urlopen(url, timeout=FETCH_TIMEOUT) as response:
111	            status = response.status

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_cli/upgrade.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
112	            if status == 200:
113	                data = response.read()
114	                encoding = response.info().get_content_charset("utf-8")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_islands/_island_generator.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
355	
356	        base_url = f"https://cdn.jsdelivr.net/npm/@marimo-team/islands@{version_override}"
357	        # This should be kept in sync fonts.css in the frontend

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_islands/_island_generator.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
359	        # for the most compatible font loading
360	        font_url = "https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500;700&amp;family=Lora&amp;family=PT+Sans:wght@400;700&amp;display=swap"
361	
362	        fonts = f"""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_islands/_island_generator.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	
362	        fonts = f"""
363	            <link rel="preconnect" href="https://fonts.googleapis.com" />
364	            <link
365	                rel="preconnect"
366	                href="https://fonts.gstatic.com"
367	                crossorigin
368	            />
369	            <link href="{font_url}" rel="stylesheet" />
370	            <link

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_islands/_island_generator.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	
362	        fonts = f"""
363	            <link rel="preconnect" href="https://fonts.googleapis.com" />
364	            <link
365	                rel="preconnect"
366	                href="https://fonts.gstatic.com"
367	                crossorigin
368	            />
369	            <link href="{font_url}" rel="stylesheet" />
370	            <link

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_islands/_island_generator.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
378	        if _development_url:
379	            base_url = "http://localhost:5174"
380	            if isinstance(_development_url, str):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_islands/_island_generator.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
417	        init_cell_id = self._app.cell_manager.create_cell_id()
418	        init_output = """
419	        <div class="marimo">
420	          <div class="flex flex-col flex-1 items-center justify-center">
421	            <svg
422	              xmlns="http://www.w3.org/2000/svg"
423	              width="24"
424	              height="24"
425	              viewBox="0 0 24 24"
426	              fill="none"
427	              stroke="currentColor"
428	              stroke-width="1"
429	              stroke-linecap="round"
430	              stroke-linejoin="round"
431	              class="size-20 animate-spin text-primary"
432	            >
433	              <path d="M21 12a9 9 0 1 1-6.219-8.56"></path>
434	            </svg>
435	            <div>Initializing...</div>
436	          </div>
437	        </div>
438	        """
439	        init_island = dedent(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_messaging/ops.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	
167	            text = f"""
168	                <span class="text-error">**Your output is too large**</span>
169	
170	                Your output is too large for marimo to show. It has a size
171	                of {size} bytes. Did you output this object by accident?
172	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_messaging/streams.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
112	            self.console_msg_queue: deque[ConsoleMsg | None] = deque()
113	            self.buffered_console_thread = threading.Thread(
114	                target=buffered_writer,
115	                args=(self.console_msg_queue, self, self.console_msg_cv),
116	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_messaging/streams.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
155	        while not should_exit.is_set():
156	            data = os.read(fd, 1024)
157	            if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_messaging/streams.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
158	                break
159	            standard_stream.write(data.decode())
160	    except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_messaging/streams.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
173	        self._should_exit = threading.Event()
174	        self.thread = threading.Thread(
175	            target=_forward_os_stream,
176	            args=(self.standard_stream, self.read_fd, self._should_exit),
177	            daemon=True,
178	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_messaging/streams.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
248	        if sys.getsizeof(data) > max_bytes:
249	            sys.stderr.write(
250	                "Warning: marimo truncated a very large console output.\n"
251	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_messaging/streams.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
267	        for line in sequence:
268	            self.write(line)
269	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_messaging/streams.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
334	        for line in sequence:
335	            self.write(line)
336	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_output/data/data.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
143	        base64str = data.split(",")[1]
144	        buffer = base64.b64decode(base64str)
145	        item = VirtualFileLifecycleItem(ext=ext, buffer=buffer)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_output/data/data.py:144
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
143	        base64str = data.split(",")[1]
144	        buffer = base64.b64decode(base64str)
145	        item = VirtualFileLifecycleItem(ext=ext, buffer=buffer)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_output/formatters/arviz_formatters.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
108	        fig.savefig(buf, format="png", bbox_inches="tight")  # Retain default
109	        data = base64.b64encode(buf.getbuffer()).decode("ascii")
110	        return f"<img src='data:image/png;base64,{data}'/>"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_output/formatters/arviz_formatters.py:109
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
108	        fig.savefig(buf, format="png", bbox_inches="tight")  # Retain default
109	        data = base64.b64encode(buf.getbuffer()).decode("ascii")
110	        return f"<img src='data:image/png;base64,{data}'/>"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_output/formatters/matplotlib_formatters.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
40	            mimetype: KnownMimeType = "image/png"
41	            plot_bytes = base64.b64encode(buf.getvalue())
42	            return (

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_output/formatters/matplotlib_formatters.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
40	            mimetype: KnownMimeType = "image/png"
41	            plot_bytes = base64.b64encode(buf.getvalue())
42	            return (

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_output/md.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
249	    elif is_url(filename):
250	        with urlopen(filename) as response:
251	            text = response.read().decode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_output/mpl.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
45	    mimetype: KnownMimeType = "image/png"
46	    plot_bytes = base64.b64encode(buf.getvalue())
47	    CellOp.broadcast_console_output(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_output/mpl.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
45	    mimetype: KnownMimeType = "image/png"
46	    plot_bytes = base64.b64encode(buf.getvalue())
47	    CellOp.broadcast_console_output(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/core/media.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
78	        pos = src.tell()
79	        base64_string = base64.b64encode(src.read()).decode("utf-8")
80	        src.seek(pos)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/core/media.py:79
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
78	        pos = src.tell()
79	        base64_string = base64.b64encode(src.read()).decode("utf-8")
80	        src.seek(pos)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/core/media.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
85	    if isinstance(src, bytes):
86	        base64_string = base64.b64encode(src).decode("utf-8")
87	        return f"data:{fallback_mime_type};base64,{base64_string}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/core/media.py:86
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
85	    if isinstance(src, bytes):
86	        base64_string = base64.b64encode(src).decode("utf-8")
87	        return f"data:{fallback_mime_type};base64,{base64_string}"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/core/media.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
96	            img_byte_arr.seek(0)
97	            base64_string = base64.b64encode(img_byte_arr.read()).decode(
98	                "utf-8"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/core/media.py:97
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
96	            img_byte_arr.seek(0)
97	            base64_string = base64.b64encode(img_byte_arr.read()).decode(
98	                "utf-8"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/audio.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
70	        src.seek(0)
71	        resolved_src = mo_data.audio(src.read()).url
72	        src.seek(pos)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/audio.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	        with open(src, "rb") as f:
81	            return mo_data.audio(f.read(), ext=os.path.splitext(src)[1]).url
82	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/image.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
135	        src.seek(0)
136	        resolved_src = mo_data.image(src.read()).url
137	    elif isinstance(src, bytes):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	    """
70	    host = os.environ.get("MARIMO_MPL_HOST", "localhost")
71	    if not host or not isinstance(host, str):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	        raise ValueError(
75	            f"Invalid host '{host}': should not include protocol (http:// or https://)"
76	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	    """
90	    secure = os.environ.get("MARIMO_MPL_SECURE", "false")
91	    if not secure or not isinstance(secure, str):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	    async def main_page(request: Request) -> HTMLResponse:
127	        figure_id = request.query_params.get("figure")
128	        assert figure_id is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	    async def download(request: Request) -> Response:
148	        figure_id = request.query_params.get("figure")
149	        assert figure_id is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
150	        fmt = request.path_params["fmt"]
151	        mime_type = mimetypes.types_map.get(fmt, "binary")
152	        buff = io.BytesIO()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	        buff = io.BytesIO()
153	        figure_manager = figure_managers.get(figure_id)
154	        figure_manager.canvas.figure.savefig(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	
170	        figure_id = websocket.query_params.get("figure")
171	        if not figure_id:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
174	            )
175	            await websocket.close()
176	            return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	        try:
179	            figure_manager = figure_managers.get(figure_id)
180	        except RuntimeError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
186	            )
187	            await websocket.close()
188	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
211	                if websocket.application_state != WebSocketState.DISCONNECTED:
212	                    await websocket.close()
213	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	                while True:
217	                    (data, mode) = await queue.get()
218	                    if mode == "json":

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
231	                if websocket.application_state != WebSocketState.DISCONNECTED:
232	                    await websocket.close()
233	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
234	        try:
235	            await asyncio.gather(receive(), send())
236	        except Exception as e:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
238	                await websocket.send_json({"type": "error", "message": str(e)})
239	                await websocket.close()
240	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
296	            for signo, handler in signal_handlers.items():
297	                signal.signal(signo, handler)
298	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:297
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
296	            for signo, handler in signal_handlers.items():
297	                signal.signal(signo, handler)
298	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/stateless/mpl/_mpl.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
298	
299	        threading.Thread(target=start_server).start()
300	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_core/ui_element.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
443	            buffers=[
444	                base64.b64encode(buffer).decode() for buffer in (buffers or [])
445	            ],

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_core/ui_element.py:444
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
443	            buffers=[
444	                base64.b64encode(buffer).decode() for buffer in (buffers or [])
445	            ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/altair_chart.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
364	            sys.stderr.write(
365	                "Binning + selection is not yet supported in "
366	                "marimo.ui.chart.\n"
367	                "If you'd like this feature, please file an issue: "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/altair_chart.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
373	            sys.stderr.write(
374	                "Geoshapes + chart selection is not yet supported in "
375	                "marimo.ui.chart.\n"
376	                "If you'd like this feature, please file an issue: "

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/altair_chart.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
420	                # polars read_json does not support urls
421	                with urllib.request.urlopen(chart.data) as response:
422	                    return pl.read_json(response)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/charts/altair_transformer.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
91	        mimetype="text/csv",
92	        data=base64.b64encode(data_csv.encode("utf-8")),
93	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/charts/altair_transformer.py:92
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
91	        mimetype="text/csv",
92	        data=base64.b64encode(data_csv.encode("utf-8")),
93	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/chat/chat.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
247	            if isinstance(ctx, KernelRuntimeContext):
248	                ctx._kernel.enqueue_control_request(
249	                    SetUIElementValueRequest(
250	                        object_ids=[self._id],
251	                        values=[{"messages": self._chat_history}],
252	                        request=None,
253	                    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/comm.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
162	                buffers=[
163	                    base64.b64encode(buffer).decode() for buffer in buffers
164	                ],

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/comm.py:163
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
162	                buffers=[
163	                    base64.b64encode(buffer).decode() for buffer in buffers
164	                ],

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/from_panel.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
64	            buffers: dict[int, Any] = {
65	                i: memoryview(base64.b64decode(v))
66	                for i, v in enumerate(msg.buffers or [])

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/from_panel.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
64	            buffers: dict[int, Any] = {
65	                i: memoryview(base64.b64decode(v))
66	                for i, v in enumerate(msg.buffers or [])

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/input.py:1357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1356	        return tuple(
1357	            FileUploadResults(name=e[0], contents=base64.b64decode(e[1]))
1358	            for e in value

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/input.py:1357
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1356	        return tuple(
1357	            FileUploadResults(name=e[0], contents=base64.b64decode(e[1]))
1358	            for e in value

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/microphone.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
54	    def _convert_value(self, value: str) -> io.BytesIO:
55	        return io.BytesIO(base64.b64decode(value))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_plugins/ui/_impl/microphone.py:55
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
54	    def _convert_value(self, value: str) -> io.BytesIO:
55	        return io.BytesIO(base64.b64decode(value))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/bootstrap.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
45	
46	    session.put_control_request(
47	        CreationRequest(
48	            execution_requests=execution_requests,
49	            set_ui_element_value_request=SetUIElementValueRequest(
50	                object_ids=[], values=[], request=None
51	            ),
52	            auto_run=auto_instantiate,
53	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
184	        parsed = parse_raw({"body": json.loads(request)}, Container).body
185	        self.session.put_control_request(parsed)
186	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
191	        parsed = parse_raw(json.loads(request), requests.CodeCompletionRequest)
192	        self.session.put_completion_request(parsed)
193	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
219	        parsed = parse_raw(json.loads(request), requests.SetUserConfigRequest)
220	        self.session.put_control_request(parsed)
221	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
252	            decoded_contents = (
253	                base64.b64decode(body.contents)
254	                if body.contents is not None

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:253
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
252	            decoded_contents = (
253	                base64.b64decode(body.contents)
254	                if body.contents is not None

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
379	    if is_edit_mode:
380	        signal.signal(signal.SIGINT, handlers.construct_interrupt_handler(ctx))
381	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:380
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
379	    if is_edit_mode:
380	        signal.signal(signal.SIGINT, handlers.construct_interrupt_handler(ctx))
381	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
385	        while True:
386	            request: ControlRequest | None = await control_queue.get()
387	            LOGGER.debug("received request %s", request)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
388	            if isinstance(request, requests.SetUIElementValueRequest):
389	                request = ui_element_request_mgr.process_request(request)
390	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
395	        while True:
396	            request = await completion_queue.get()
397	            while not completion_queue.empty():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_pyodide/pyodide_session.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
398	                # discard stale requests to avoid choking the runtime
399	                request = await completion_queue.get()
400	            LOGGER.debug("received completion request %s", request)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/app/kernel_runner.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
141	        with self._runtime_context.install():
142	            return await self._kernel.function_call_request(request)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/app/script_runner.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	                    raise MarimoRuntimeException(
210	                        "Unexpected error occurred while running the app. "
211	                        "Improperly wrapped MarimoMissingRefError exception. "
212	                        "Please report this issue to "

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/complete.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
311	
312	    request = completion_queue.get()
313	    while not completion_queue.empty():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/complete.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
313	    while not completion_queue.empty():
314	        request = completion_queue.get()
315	    return request

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/context/types.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	        """Get the current request context if any."""
118	        return HTTP_REQUEST_CTX.get(None)
119	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/executor.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
116	            else:
117	                exec(cell.body, glbls)
118	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/executor.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
140	
141	            exec(cell.body, glbls)
142	            return eval(cell.last_expr, glbls)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/marimo_browser.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	            mo.image(
49	                "https://marimo.app/images/antigravity.png",
50	                alt=(
51	                    "The image shows 2 stick figures in XKCD style. The one "
52	                    'on the left says:"You\'re Flying! How?", a floating '
53	                    'stick figure on the right responds "marimo!"'
54	                ),
55	                caption=(
56	                    'Original alt text: "<i>I wrote 20 short programs in '
57	                    "Python yesterday."
58	                    "<b> It was wonderful. </b>"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/marimo_browser.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	                caption=(
56	                    'Original alt text: "<i>I wrote 20 short programs in '
57	                    "Python yesterday."
58	                    "<b> It was wonderful. </b>"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/packages/conda_package_manager.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    name = "conda"
16	    docs_url = "https://docs.conda.io/projects/conda/"
17	
18	    def _construct_module_name_mapping(self) -> dict[str, str]:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/packages/package_managers.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    raise RuntimeError(
31	        f"Unknown package manager {name}. "
32	        "This is a bug in marimo."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/packages/pypi_package_manager.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	    name = "pip"
46	    docs_url = "https://pip.pypa.io/"
47	
48	    async def _install(self, package: str) -> bool:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/packages/pypi_package_manager.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	    name = "micropip"
72	    docs_url = "https://micropip.pyodide.org/"
73	
74	    def should_auto_install(self) -> bool:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/packages/pypi_package_manager.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	    name = "uv"
117	    docs_url = "https://docs.astral.sh/uv/"
118	
119	    async def _install(self, package: str) -> bool:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/packages/pypi_package_manager.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
206	    name = "rye"
207	    docs_url = "https://rye.astral.sh/"
208	
209	    async def _install(self, package: str) -> bool:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/packages/pypi_package_manager.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
221	    name = "poetry"
222	    docs_url = "https://python-poetry.org/docs/"
223	
224	    async def _install(self, package: str) -> bool:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/params.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	        """Get the value of a query parameter as a list."""
76	        value = self._params.get(key)
77	        if value is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/params.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	    def __getitem__(self, key: str) -> Optional[Union[str, list[str]]]:
84	        return self.get(key)
85	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/params.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
210	        """Get the value of a CLI arg as a list."""
211	        value = self._params.get(key)
212	        if value is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/params.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	    def __getitem__(self, key: str) -> Optional[ListOrValue[Primitive]]:
219	        return self.get(key)
220	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/patches.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
130	
131	    exec(definitions, glbls)
132	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/patches.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
134	    # already has a package called micropip
135	    exec(
136	        "import sys; sys.meta_path.append(_MicropipFinder()); del sys",
137	        glbls,
138	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/redirect_streams.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	    while True:
21	        data = os.read(fd, 1024)
22	        if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/redirect_streams.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	            break
24	        stream_object.write(data.decode())
25	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/reload/autoreload.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
449	        # In this case, too, the failure shouldn't be silent!
450	        sys.stderr.write(
451	            f"Error trying to reload module {module.__name__}: {str(e)} \n"
452	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/reload/autoreload.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
455	        tmpio.seek(0)
456	        write_traceback(tmpio.read())
457	        raise

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
216	        # set the custom sigint handler during this context
217	        save_sigint = signal.signal(signal.SIGINT, handle_sigint)
218	        try:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:217
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
216	        # set the custom sigint handler during this context
217	        save_sigint = signal.signal(signal.SIGINT, handle_sigint)
218	        try:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
221	            # restore the previous sigint handler
222	            signal.signal(signal.SIGINT, save_sigint)
223	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:222
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
221	            # restore the previous sigint handler
222	            signal.signal(signal.SIGINT, save_sigint)
223	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
336	                )
337	                if threading.current_thread() == threading.main_thread():
338	                    # edit mode: need to handle user interrupts

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
336	                )
337	                if threading.current_thread() == threading.main_thread():
338	                    # edit mode: need to handle user interrupts

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
361	            tmpio.seek(0)
362	            write_traceback(tmpio.read())
363	        # Strict mode errors may also raise errors outside of execution.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
401	                    output = MarimoExceptionRaisedError(
402	                        f"marimo came across the undefined variable `{ref}` "
403	                        "during runtime. This is possible in strict mode when "
404	                        "static analysis is unable to properly resolve the "
405	                        "reference due  to direct access (e.g. "
406	                        "`globals()['var']`) or circuitous definitions (e.g.  "
407	                        "by reassigning variables to different functions). If "
408	                        "this failure is not the result of either of these "
409	                        "cases, please consider reporting this issue to "
410	                        "https://github.com/marimo-team/marimo/issues. "
411	                        "Definition expected in cell : ",
412	                        "NameError",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
486	                tmpio.seek(0)
487	                write_traceback(tmpio.read())
488	        except BaseException as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
499	                tmpio.seek(0)
500	                write_traceback(tmpio.read())
501	        finally:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/cell_runner.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
520	                LOGGER.error(
521	                    """Internal marimo error. Please copy this message and
522	                    paste it in a GitHub issue:
523	
524	                    https://github.com/marimo-team/marimo/issues
525	
526	                    An exception raised attempting to continue debugger (%s).
527	                    """,
528	                    str(debugger_error),
529	                )
530	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runner/hooks_post_execution.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
396	        # ensures that every cell gets a fresh axis.
397	        exec("__marimo__._output.mpl.close_figures()", runner.glbls)
398	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
489	        # Apply pythonpath from config at initialization
490	        pythonpath = user_config["runtime"].get("pythonpath")
491	        if pythonpath:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
517	        # Adds in a post_execution hook to run pytest immediately
518	        if user_config["runtime"].get("reactive_tests", False):
519	            from marimo._runtime.runner.hooks_post_execution import (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
525	        # Adds in a post_execution hook to run pytest immediately
526	        if user_config.get("experimental", {}).get("toplevel_defs", False):
527	            from marimo._runtime.runner.hooks_post_execution import (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
525	        # Adds in a post_execution hook to run pytest immediately
526	        if user_config.get("experimental", {}).get("toplevel_defs", False):
527	            from marimo._runtime.runner.hooks_post_execution import (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
583	        ]["on_cell_change"]
584	        self.execution_type: ExecutionType = user_config.get(
585	            "experimental", {}
586	        ).get("execution_type", "relaxed")
587	        self._update_runtime_from_user_config(user_config)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
583	        ]["on_cell_change"]
584	        self.execution_type: ExecutionType = user_config.get(
585	            "experimental", {}
586	        ).get("execution_type", "relaxed")

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
604	
605	        exec("import marimo as __marimo__", self.globals)
606	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
629	    def _execute_stale_cells_callback(self) -> None:
630	        return self.enqueue_control_request(ExecuteStaleRequest())
631	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
629	    def _execute_stale_cells_callback(self) -> None:
630	        return self.enqueue_control_request(ExecuteStaleRequest())
631	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
689	
690	        threading.Thread(
691	            target=completion_worker,
692	            args=(
693	                completion_queue,
694	                self.graph,
695	                self.globals,
696	                self._globals_lock,
697	                get_context().stream,
698	            ),
699	            daemon=True,
700	        ).start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:800
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
799	                tmpio.seek(0)
800	                syntax_error = tmpio.read().split("\n")
801	                # first line has the form File XXX, line XXX

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
812	                tmpio.seek(0)
813	                error = UnknownError(msg=tmpio.read())
814	        return cell, error

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
855	        if not self.graph.is_cell_cached(cell_id, code):
856	            previous_cell = self.graph.cells.get(cell_id, None)
857	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:895
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
894	            if self.packages_callbacks.should_update_script_metadata():
895	                cell = self.graph.cells.get(cell_id, None)
896	                if cell:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
917	        # returned cells are stale.
918	        children = self.graph.children.get(cell_id, set())
919	        return previous_children - children, error

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1601	            )
1602	            cell = self.graph.cells.get(cell_id)
1603	            if cell is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1699	                    # Internal marimo error
1700	                    sys.stderr.write(
1701	                        "An exception was raised when updating a UIElement's "
1702	                        "value. This is a bug in marimo. Please copy "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1700	                    sys.stderr.write(
1701	                        "An exception was raised when updating a UIElement's "
1702	                        "value. This is a bug in marimo. Please copy "
1703	                        "the below traceback and paste it in an "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1708	                    tmpio.seek(0)
1709	                    write_traceback(tmpio.read())
1710	                    # Don't run referring elements of this UI element

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1713	                    # User's on_change handler an exception ...
1714	                    sys.stderr.write(
1715	                        "An exception was raised by a "
1716	                        "UIElement's on_change handler:\n"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1721	                    tmpio.seek(0)
1722	                    write_traceback(tmpio.read())
1723	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1746	                    # Internal marimo error
1747	                    sys.stderr.write(
1748	                        "An exception was raised when finding cells that "
1749	                        f"refer to a UIElement value, for bound name {name}. "
1750	                        "This is a bug in marimo. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1747	                    sys.stderr.write(
1748	                        "An exception was raised when finding cells that "
1749	                        f"refer to a UIElement value, for bound name {name}. "
1750	                        "This is a bug in marimo. "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1756	                    tmpio.seek(0)
1757	                    write_traceback(tmpio.read())
1758	                    # Entering undefined behavior territory ...

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1778	                # Internal marimo error
1779	                sys.stderr.write(
1780	                    "An exception was raised when completing a UIElement's"
1781	                    "update. This is a bug in marimo. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1779	                sys.stderr.write(
1780	                    "An exception was raised when completing a UIElement's"
1781	                    "update. This is a bug in marimo. "
1782	                    "Please copy the below traceback and paste it in an "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1787	                tmpio.seek(0)
1788	                write_traceback(tmpio.read())
1789	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1933	    def load_dotenv(self) -> None:
1934	        dotenvs = self.user_config["runtime"].get("dotenv", [])
1935	        if not isinstance(dotenvs, list):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1986	        async def handle_function_call(request: FunctionCallRequest) -> None:
1987	            status, ret, _ = await self.function_call_request(request)
1988	            LOGGER.debug("Function returned with status %s", status)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:1987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1986	        async def handle_function_call(request: FunctionCallRequest) -> None:
1987	            status, ret, _ = await self.function_call_request(request)
1988	            LOGGER.debug("Function returned with status %s", status)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2136	            # Should we find the existing engine instead?
2137	            engine_val = self._kernel.globals.get(engine_name)
2138	            engines = get_engines_from_variables([(engine_name, engine_val)])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2340	            version = {pkg: "" for pkg in packages}
2341	            self._kernel.enqueue_control_request(
2342	                InstallMissingPackagesRequest(
2343	                    manager=self.package_manager.name, versions=version
2344	                )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2340	            version = {pkg: "" for pkg in packages}
2341	            self._kernel.enqueue_control_request(
2342	                InstallMissingPackagesRequest(
2343	                    manager=self.package_manager.name, versions=version
2344	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2392	            InstallingPackageAlert(packages=package_statuses).broadcast()
2393	            version = request.versions.get(pkg)
2394	            if await self.package_manager.install(pkg, version=version):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2470	    async def handle(self, request: ControlRequest) -> None:
2471	        handler = self._handlers.get(type(request))
2472	        if handler:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2611	
2612	        signal.signal(signal.SIGINT, handlers.construct_interrupt_handler(ctx))
2613	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2612
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
2611	
2612	        signal.signal(signal.SIGINT, handlers.construct_interrupt_handler(ctx))
2613	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2617	            # windows doesn't handle SIGTERM
2618	            signal.signal(
2619	                signal.SIGBREAK, handlers.construct_sigterm_handler(kernel)
2620	            )

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2618
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
2617	            # windows doesn't handle SIGTERM
2618	            signal.signal(
2619	                signal.SIGBREAK, handlers.construct_sigterm_handler(kernel)
2620	            )

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2621	        else:
2622	            signal.signal(
2623	                signal.SIGTERM, handlers.construct_sigterm_handler(kernel)
2624	            )

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2622
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
2621	        else:
2622	            signal.signal(
2623	                signal.SIGTERM, handlers.construct_sigterm_handler(kernel)
2624	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2630	            try:
2631	                request: ControlRequest | None = control_queue.get()
2632	            except Exception as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2639	            elif isinstance(request, SetUIElementValueRequest):
2640	                request = ui_element_request_mgr.process_request(request)
2641	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/runtime.py:2640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2639	            elif isinstance(request, SetUIElementValueRequest):
2640	                request = ui_element_request_mgr.process_request(request)
2641	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/virtual_file.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
73	                mimetype=cast(KnownMimeType, mimetype),
74	                data=base64.b64encode(buffer),
75	            )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/virtual_file.py:74
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
73	                mimetype=cast(KnownMimeType, mimetype),
74	                data=base64.b64encode(buffer),
75	            )

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_runtime/win32_interrupt_handler.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
25	                pass
26	            if callable(signal.getsignal(signal.SIGINT)):
27	                interrupt_main()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_save/hash.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	    raise ValueError(
159	        f"Expected a data primitive object, but got {type(tensor)} instead."
160	        "This maybe is an internal marimo issue. Please report to "

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_save/hash.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
484	            self._hash = (
485	                base64.urlsafe_b64encode(self.hash_alg.digest())
486	                .decode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_save/hash.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
495	            self._exe_hash = (
496	                base64.urlsafe_b64encode(self.exe_alg.digest())
497	                .decode("utf-8")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_save/hash.py:864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
863	        assert context is not None, (
864	            "Execution path could not be resolved. "
865	            "There may be cyclic definitions in the code. "
866	            f"The unresolved references are: {refs}. "
867	            "This is unexpected, please report this issue to "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_save/hash.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
881	        assert len(ref_cells) == 1, (
882	            "Inconsistent references, cannot determine execution path. "
883	            f"Got {ref_cells} expected set({self.cell_id}). "
884	            "This is unexpected, please report this issue to "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_save/hash.py:888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
887	        assert ref_cells == {self.cell_id}, (
888	            "Unexpected execution cell residual "
889	            f"{ref_cells.pop()} expected {self.cell_id}."
890	            "This is unexpected, please report this issue to "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_save/save.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	UNEXPECTED_FAILURE_BOILERPLATE = (
55	    " this is"
56	    " unexpected and is likely a bug in marimo. "
57	    "Please file an issue at "
58	    "https://github.com/marimo-team/marimo/issues"
59	)
60	
61	if TYPE_CHECKING:
62	    from types import FrameType, TracebackType

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_save/stores/file.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	        with open(path, "rb") as f:
29	            return f.read()
30	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_save/stores/file.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
36	        with open(path, "wb") as f:
37	            f.write(blob)
38	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/auth.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	        # Validate the access_token
60	        password = form_dict.get("password")
61	        if password == auth_token:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/auth.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	    # Check for basic auth
71	    auth = conn.headers.get("Authorization")
72	    if auth is not None:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/auth.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
93	
94	    decoded = base64.b64decode(credentials).decode("utf-8")
95	    username, _, password = decoded.partition(":")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/auth.py:94
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
93	
94	    decoded = base64.b64decode(credentials).decode("utf-8")
95	    username, _, password = decoded.partition(":")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/auth.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
137	    def get_access_token(self) -> str:
138	        access_token: str = self.session_state.get("access_token", "")
139	        return access_token

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/auth.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	    def get_username(self) -> str:
142	        username: str = self.session_state.get("username", "")
143	        return username

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/auth.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
235	            # Get the developer-defined that we saved earlier
236	            developer_defined_user = scope.get(self.KEY)
237	            # Store it back in the scope

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/auth.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	        # so that the wrapped app can access it
249	        developer_defined_user = scope.get("user")
250	        scope[self.KEY] = developer_defined_user

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/deps.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	    def maybe_port(self) -> Optional[int]:
68	        return self.state._state.get("port")
69	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/deps.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	        """Get the current session."""
111	        session_id = self.request.headers.get("Marimo-Session-Id")
112	        return SessionId(session_id) if session_id is not None else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ai.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	def get_ai_config(config: MarimoConfig) -> AiConfig:
48	    ai_config = config.get("ai", None)
49	    if ai_config is None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ai.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
82	    config = app_state.app_config_manager.get_config(hide_secrets=False)
83	    body = await parse_request(
84	        request, cls=AiCompletionRequest, allow_unknown_keys=True
85	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ai.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	
88	    custom_rules = ai_config.get("rules", None)
89	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ai.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
56	
57	@router.post("/completion")
58	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ai.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
137	    config = app_state.app_config_manager.get_config(hide_secrets=False)
138	    body = await parse_request(
139	        request, cls=ChatRequest, allow_unknown_keys=True
140	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ai.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	    ai_config = get_ai_config(config)
142	    custom_rules = ai_config.get("rules", None)
143	    messages = body.messages

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ai.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
119	
120	@router.post("/chat")
121	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ai.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
195	    config = app_state.app_config_manager.get_config(hide_secrets=False)
196	    body = await parse_request(
197	        request, cls=AiInlineCompletionRequest, allow_unknown_keys=True
198	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ai.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
170	
171	@router.post("/inline_completion")
172	@requires("edit")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/assets.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	server_config = (
39	    get_default_config_manager(current_path=None)
40	    .get_config()
41	    .get("server", {})
42	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/assets.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	assets_dir = root / "assets"
45	follow_symlinks = server_config.get("follow_symlink", False)
46	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/assets.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	
74	@router.get("/")
75	@requires("read", redirect="auth:login_page")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/assets.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	
161	@router.get("/@file/{filename_and_length:path}")
162	@requires("read")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/assets.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	
213	@router.get("/public-files-sw.js")
214	async def public_files_service_worker(request: Request) -> Response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/assets.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	    # Get notebook ID from header
254	    notebook_id = request.headers.get("X-Notebook-Id")
255	    if notebook_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/assets.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	
247	@router.get("/public/{filepath:path}")
248	@requires("read")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/assets.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
278	# Catch all for serving static files
279	@router.get("/{path:path}")
280	async def serve_static(request: Request) -> FileResponse:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/config.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
50	    # Allow unknown keys to handle backward/forward compatibility
51	    body = await parse_request(
52	        request, cls=SaveUserConfigurationRequest, allow_unknown_keys=True
53	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/config.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
64	    if session is not None:
65	        session.put_control_request(
66	            SetUserConfigRequest(body.config),
67	            from_consumer_id=ConsumerId(
68	                app_state.require_current_session_id()
69	            ),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/config.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
28	
29	@router.post("/save_user_config")
30	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/datasources.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
48	    app_state = AppState(request)
49	    body = await parse_request(request, PreviewDatasetColumnRequest)
50	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/datasources.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
49	    body = await parse_request(request, PreviewDatasetColumnRequest)
50	    app_state.require_current_session().put_control_request(
51	        body,
52	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
53	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/datasources.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
28	
29	@router.post("/preview_column")
30	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/datasources.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
74	    app_state = AppState(request)
75	    body = await parse_request(request, PreviewSQLTableRequest)
76	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/datasources.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
75	    body = await parse_request(request, PreviewSQLTableRequest)
76	    app_state.require_current_session().put_control_request(
77	        body,
78	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
79	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/datasources.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
56	
57	@router.post("/preview_sql_table")
58	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/datasources.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
100	    app_state = AppState(request)
101	    body = await parse_request(request, PreviewSQLTableListRequest)
102	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/datasources.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
101	    body = await parse_request(request, PreviewSQLTableListRequest)
102	    app_state.require_current_session().put_control_request(
103	        body,
104	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
105	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/datasources.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
82	
83	@router.post("/preview_sql_table_list")
84	@requires("edit")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/documentation.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	
22	@router.get("/snippets")
23	async def load_snippets(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
52	    app_state = AppState(request)
53	    body = await parse_request(request, cls=CodeCompletionRequest)
54	    app_state.require_current_session().put_completion_request(body)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
53	    body = await parse_request(request, cls=CodeCompletionRequest)
54	    app_state.require_current_session().put_completion_request(body)
55	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
34	
35	@router.post("/code_autocomplete")
36	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
76	    app_state = AppState(request)
77	    body = await parse_request(request, cls=DeleteCellRequest)
78	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
77	    body = await parse_request(request, cls=DeleteCellRequest)
78	    app_state.require_current_session().put_control_request(
79	        body,
80	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
81	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
58	
59	@router.post("/delete")
60	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
103	    app_state = AppState(request)
104	    body = await parse_request(request, cls=UpdateCellIdsRequest)
105	    session_id = app_state.require_current_session_id()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
85	
86	@router.post("/sync/cell_ids")
87	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
128	    """
129	    body = await parse_request(request, cls=FormatRequest)
130	    formatter = DefaultFormatter(line_length=body.line_length)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
111	
112	@router.post("/format")
113	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
152	    app_state = AppState(request)
153	    body = await parse_request(request, cls=SetCellConfigRequest)
154	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
153	    body = await parse_request(request, cls=SetCellConfigRequest)
154	    app_state.require_current_session().put_control_request(
155	        body,
156	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
157	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
134	
135	@router.post("/set_cell_config")
136	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
179	    app_state = AppState(request)
180	    body = await parse_request(request, cls=StdinRequest)
181	    app_state.require_current_session().put_input(body.text)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
161	
162	@router.post("/stdin")
163	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
203	    app_state = AppState(request)
204	    body = await parse_request(request, cls=InstallMissingPackagesRequest)
205	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
204	    body = await parse_request(request, cls=InstallMissingPackagesRequest)
205	    app_state.require_current_session().put_control_request(
206	        body,
207	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
208	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/editing.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
185	
186	@router.post("/install_missing_packages")
187	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
62	    app_state = AppState(request)
63	    body = await parse_request(request, cls=UpdateComponentValuesRequest)
64	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
63	    body = await parse_request(request, cls=UpdateComponentValuesRequest)
64	    app_state.require_current_session().put_control_request(
65	        SetUIElementValueRequest(
66	            object_ids=body.object_ids,
67	            values=body.values,
68	            token=str(uuid4()),
69	            request=HTTPRequest.from_request(request),
70	        ),
71	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
72	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
68	            token=str(uuid4()),
69	            request=HTTPRequest.from_request(request),
70	        ),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
42	
43	@router.post("/set_ui_element_value")
44	async def set_ui_element_values(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
96	    app_state = AppState(request)
97	    body = await parse_request(request, cls=InstantiateRequest)
98	    app_state.require_current_session().instantiate(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
99	        body,
100	        http_request=HTTPRequest.from_request(request),
101	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
76	
77	@router.post("/instantiate")
78	async def instantiate(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
125	    app_state = AppState(request)
126	    body = await parse_request(request, cls=FunctionCallRequest)
127	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
126	    body = await parse_request(request, cls=FunctionCallRequest)
127	    app_state.require_current_session().put_control_request(
128	        body,
129	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
130	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
105	
106	@router.post("/function_call")
107	async def function_call(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
134	
135	@router.post("/interrupt")
136	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
176	    app_state = AppState(request)
177	    body = await parse_request(request, cls=RunRequest)
178	    body.request = HTTPRequest.from_request(request)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
177	    body = await parse_request(request, cls=RunRequest)
178	    body.request = HTTPRequest.from_request(request)
179	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
178	    body.request = HTTPRequest.from_request(request)
179	    app_state.require_current_session().put_control_request(
180	        body.as_execution_request(),
181	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
182	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
179	    app_state.require_current_session().put_control_request(
180	        body.as_execution_request(),
181	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
155	
156	@router.post("/run")
157	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
207	    app_state = AppState(request)
208	    body = await parse_request(request, cls=RunScratchpadRequest)
209	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
208	    body = await parse_request(request, cls=RunScratchpadRequest)
209	    app_state.require_current_session().put_control_request(
210	        body.as_execution_request(),
211	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
212	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
209	    app_state.require_current_session().put_control_request(
210	        body.as_execution_request(),
211	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
186	
187	@router.post("/scratchpad/run")
188	@requires("edit")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
216	
217	@router.post("/restart_session")
218	@requires("edit")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
240	
241	@router.post("/shutdown")
242	@requires("edit")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/execution.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
285	
286	@router.post("/takeover")
287	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/export.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
55	    app_state = AppState(request)
56	    body = await parse_request(request, cls=ExportAsHTMLRequest)
57	    session = app_state.require_current_session()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/export.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
32	
33	@router.post("/html")
34	@requires("read")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/export.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
111	    app_state = AppState(request)
112	    body = await parse_request(request, cls=ExportAsHTMLRequest)
113	    session = app_state.require_current_session()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/export.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
88	
89	@router.post("/auto_export/html")
90	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/export.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
169	    app_state = AppState(request)
170	    body = await parse_request(request, cls=ExportAsScriptRequest)
171	    session = app_state.require_current_session()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/export.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
146	
147	@router.post("/script")
148	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/export.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
211	    app_state = AppState(request)
212	    body = await parse_request(request, cls=ExportAsMarkdownRequest)
213	    app_file_manager = app_state.require_current_session().app_file_manager

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/export.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
188	
189	@router.post("/markdown")
190	@requires("edit")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/export.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
238	
239	@router.post("/auto_export/markdown")
240	@requires("edit")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/export.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
292	
293	@router.post("/auto_export/ipynb")
294	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
64	    """
65	    body = await parse_request(request, cls=FileListRequest)
66	    root = body.path or file_system.get_root()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
44	
45	@router.post("/list_files")
46	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
90	    """
91	    body = await parse_request(request, cls=FileDetailsRequest)
92	    # This fails if the file isn't encoded as utf-8

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
70	
71	@router.post("/file_details")
72	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
116	    """
117	    body = await parse_request(request, cls=FileCreateRequest)
118	    try:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
119	        decoded_contents = (
120	            base64.b64decode(body.contents)
121	            if body.contents is not None

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:120
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
119	        decoded_contents = (
120	            base64.b64decode(body.contents)
121	            if body.contents is not None

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
96	
97	@router.post("/create")
98	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
153	    """
154	    body = await parse_request(request, cls=FileDeleteRequest)
155	    try:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
133	
134	@router.post("/delete")
135	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
183	    """
184	    body = await parse_request(request, cls=FileMoveRequest)
185	    try:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
163	
164	@router.post("/move")
165	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
213	    """
214	    body = await parse_request(request, cls=FileUpdateRequest)
215	    try:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
193	
194	@router.post("/update")
195	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
243	    """
244	    body = await parse_request(request, cls=FileOpenRequest)
245	    try:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/file_explorer.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
223	
224	@router.post("/open")
225	@requires("edit")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
34	
35	@router.post("/read_code")
36	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
85	    """
86	    body = await parse_request(request, cls=RenameFileRequest)
87	    app_state = AppState(request)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
98	
99	    app_state.require_current_session().put_control_request(
100	        body.as_execution_request(),
101	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
102	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
99	    app_state.require_current_session().put_control_request(
100	        body.as_execution_request(),
101	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
65	
66	@router.post("/rename")
67	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
133	    app_state = AppState(request)
134	    body = await parse_request(request, cls=SaveNotebookRequest)
135	    session = app_state.require_current_session()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
112	
113	@router.post("/save")
114	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
161	    app_state = AppState(request)
162	    body = await parse_request(request, cls=CopyNotebookRequest)
163	    session = app_state.require_current_session()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
140	
141	@router.post("/copy")
142	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
189	    app_state = AppState(request)
190	    body = await parse_request(request, cls=SaveAppConfigurationRequest)
191	    session = app_state.require_current_session()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/files.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
168	
169	@router.post("/save_app_config")
170	@requires("edit")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/health.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	
38	@router.get("/api/status")
39	@requires("edit")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/health.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
90	
91	@router.get("/api/version")
92	async def version(request: Request) -> PlainTextResponse:

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/health.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
168	    # Server memory (and children)
169	    main_process = psutil.Process()
170	    server_memory = main_process.memory_info().rss

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/health.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
181	    if session and isinstance(session.kernel_manager.kernel_task, Process):
182	        kernel_process = psutil.Process(session.kernel_manager.kernel_task.pid)
183	        kernel_memory = kernel_process.memory_info().rss

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/health.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	
106	@router.get("/api/usage")
107	@requires("edit")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/health.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	
216	@router.get("/api/status/connections")
217	async def connections(request: Request) -> JSONResponse:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/home.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
37	
38	@router.post("/recent_files")
39	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/home.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
77	    """
78	    body = await parse_request(request, cls=WorkspaceFilesRequest)
79	    session_manager = AppState(request).session_manager

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/home.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
57	
58	@router.post("/workspace_files")
59	@requires("edit")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/home.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
115	
116	@router.post("/running_notebooks")
117	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/home.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
155	    app_state = AppState(request)
156	    body = await parse_request(request, cls=ShutdownSessionRequest)
157	    app_state.session_manager.close_session(body.session_id)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/home.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
134	
135	@router.post("/shutdown_session")
136	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/home.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
182	    try:
183	        body = await parse_request(request, cls=OpenTutorialRequest)
184	    except ValueError:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/home.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
160	
161	@router.post("/tutorial/open")
162	@requires("edit")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/login.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	    error = ""
106	    redirect_url = request.query_params.get("next", base_url)
107	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/login.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	        data = dict(parse_qsl(body))
118	        password = data.get("password", "")
119	        if not password:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/login.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
73	
74	@router.post("/login")
75	async def login_submit(request: Request) -> Response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/login.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
140	
141	@router.get("/login", name="login_page")
142	async def login_page(request: Request) -> HTMLResponse:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/packages.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
45	    """
46	    body = await parse_request(request, cls=AddPackageRequest)
47	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/packages.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
28	
29	@router.post("/add")
30	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/packages.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
90	    """
91	    body = await parse_request(request, cls=RemovePackageRequest)
92	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/packages.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
73	
74	@router.post("/remove")
75	@requires("edit")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/packages.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	
119	@router.get("/list")
120	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/secrets.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
48	    app_state = AppState(request)
49	    body = await parse_request(request, cls=ListSecretKeysRequest)
50	    app_state.require_current_session().put_control_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/secrets.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
49	    body = await parse_request(request, cls=ListSecretKeysRequest)
50	    app_state.require_current_session().put_control_request(
51	        body,
52	        from_consumer_id=ConsumerId(app_state.require_current_session_id()),
53	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/secrets.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
29	
30	@router.post("/keys")
31	@requires("edit")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/secrets.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
74	    """
75	    body = await parse_request(request, cls=CreateSecretRequest)
76	    app_state = AppState(request)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/secrets.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
82	    # Refresh the secrets
83	    app_state.require_current_session().put_control_request(
84	        RefreshSecretsRequest(),
85	        from_consumer_id=ConsumerId(session_id),
86	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/secrets.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
56	
57	@router.post("/create")
58	@requires("edit")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/secrets.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
89	
90	@router.post("/delete")
91	@requires("edit")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/terminal.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
36	                        continue
37	                    data = os.read(master, 1024)
38	                    if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/terminal.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	
69	                    master_file.write(data.encode())
70	                    master_file.flush()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/terminal.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
83	    if app_state.mode != SessionMode.EDIT:
84	        await websocket.close()
85	        return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/terminal.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
112	            if websocket.application_state != WebSocketState.DISCONNECTED:
113	                await websocket.close()
114	        except RuntimeError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
72	    if raw_session_id is None:
73	        await websocket.close(
74	            WebSocketCodes.NORMAL_CLOSE, "MARIMO_NO_SESSION_ID"
75	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
85	    if file_key is None:
86	        await websocket.close(
87	            WebSocketCodes.NORMAL_CLOSE, "MARIMO_NO_FILE_KEY"
88	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
206	        LOGGER.warning("RTC: Closing websocket - no file key")
207	        await websocket.close(
208	            WebSocketCodes.NORMAL_CLOSE, "MARIMO_NO_FILE_KEY"
209	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
217	        )
218	        await websocket.close(WebSocketCodes.FORBIDDEN, "MARIMO_NOT_ALLOWED")
219	        return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
524	            else:
525	                _close()
526	        else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
553	            if self.websocket.application_state is WebSocketState.CONNECTED:
554	                await self.websocket.close(
555	                    WebSocketCodes.ALREADY_CONNECTED,
556	                    "MARIMO_ALREADY_CONNECTED",
557	                )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
564	                    LOGGER.debug("Kiosk mode is only supported in edit mode")
565	                    raise WebSocketDisconnect(
566	                        WebSocketCodes.FORBIDDEN, "MARIMO_KIOSK_NOT_ALLOWED"
567	                    )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
579	                    )
580	                    raise WebSocketDisconnect(
581	                        WebSocketCodes.NORMAL_CLOSE, "MARIMO_NO_SESSION"
582	                    )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
695	                except WebSocketDisconnect as e:
696	                    self._on_disconnect(
697	                        e,
698	                        cleanup_fn=lambda: listen_for_disconnect_task.cancel(),
699	                    )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
708	                    ):
709	                        self._on_disconnect(
710	                            e,
711	                            cleanup_fn=lambda: listen_for_disconnect_task.cancel(),  # noqa: E501
712	                        )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
718	            except WebSocketDisconnect as e:
719	                self._on_disconnect(
720	                    e, cleanup_fn=lambda: listen_for_messages_task.cancel()
721	                )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
724	        listen_for_disconnect_task = asyncio.create_task(
725	            listen_for_disconnect()
726	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
759	            asyncio.create_task(
760	                self.websocket.close(
761	                    WebSocketCodes.NORMAL_CLOSE, "MARIMO_SHUTDOWN"
762	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/endpoints/ws.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
790	            title = f"Update available {current_version}  {latest_version}"
791	            release_url = "https://github.com/marimo-team/marimo/releases"
792	            description = f"Check out the <a class='underline' target='_blank' href='{release_url}'>latest release on GitHub.</a>"  # noqa: E501

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/interrupt.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
19	        self.loop = asyncio.get_event_loop()
20	        self.original_handler = signal.getsignal(signal.SIGINT)
21	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/interrupt.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
28	            # Windows
29	            signal.signal(
30	                signal.SIGINT,
31	                lambda signum, frame: self._interrupt_handler(),  # noqa: ARG005,E501
32	            )

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/interrupt.py:29
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
28	            # Windows
29	            signal.signal(
30	                signal.SIGINT,
31	                lambda signum, frame: self._interrupt_handler(),  # noqa: ARG005,E501
32	            )

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/interrupt.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
41	            # Windows
42	            signal.signal(signal.SIGINT, self.original_handler)
43	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/interrupt.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
41	            # Windows
42	            signal.signal(signal.SIGINT, self.original_handler)
43	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/interrupt.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
51	            # Windows
52	            signal.signal(signal.SIGINT, self.original_handler)
53	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/interrupt.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
51	            # Windows
52	            signal.signal(signal.SIGINT, self.original_handler)
53	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/lifespans.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
114	            new=file_router.get_unique_file_key() == AppFileRouter.NEW_FILE,
115	            network=state.host == "0.0.0.0",
116	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	        # If is a form, then skip
101	        if request.headers.get("Content-Type", "").startswith(
102	            "application/x-www-form-urlencoded"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	        expected = state.session_manager.skew_protection_token
112	        server_token = request.headers.get(self.HEADER_NAME)
113	        if server_token is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
204	            while True:
205	                chunk = self.raw_response.read(8192)
206	                if not chunk:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
211	        finally:
212	            await self.aclose()
213	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
214	    async def aclose(self) -> None:
215	        self.raw_response.close()
216	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
270	        if hasattr(request.data, "read"):
271	            return request.data.read()  # type: ignore
272	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
290	        try:
291	            conn.request(
292	                method=method,
293	                url=path_and_query,  # Only path and query
294	                body=body,
295	                headers=request.headers,
296	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
290	        try:
291	            conn.request(
292	                method=method,
293	                url=path_and_query,  # Only path and query
294	                body=body,
295	                headers=request.headers,
296	            )

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
296	            )
297	            resp = conn.getresponse()
298	            return resp  # type: ignore[no-any-return]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
312	                response = await loop.run_in_executor(
313	                    None, lambda: self._send_request(request, body)
314	                )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
312	                response = await loop.run_in_executor(
313	                    None, lambda: self._send_request(request, body)
314	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
360	            if self.path_rewrite:
361	                ws_path = self.path_rewrite(ws_path)
362	            ws_url = urljoin(ws_target_url, ws_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
387	        if self.path_rewrite:
388	            target_path = self.path_rewrite(target_path)
389	        target_query = request.url.query.encode("utf-8")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
398	
399	        rp_req = client.build_request(
400	            request.method,
401	            url,
402	            headers=headers,
403	            content=request.stream(),
404	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
398	
399	        rp_req = client.build_request(
400	            request.method,
401	            url,
402	            headers=headers,
403	            content=request.stream(),
404	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
405	
406	        rp_resp = await client.send(rp_req, stream=True)
407	        response = StreamingResponse(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
424	
425	            async with connect(ws_url) as ws_client:
426	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
438	                            if "text" in msg:
439	                                await ws_client.send(msg["text"])
440	                            elif "bytes" in msg:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
440	                            elif "bytes" in msg:
441	                                await ws_client.send(msg["bytes"])
442	                    except Exception as e:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
451	                        while True:
452	                            msg = await ws_client.recv()
453	                            if isinstance(msg, bytes):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
482	                    if websocket.client_state != WebSocketState.DISCONNECTED:
483	                        await websocket.close()
484	                    await ws_client.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
483	                        await websocket.close()
484	                    await ws_client.close()
485	        except Exception as e:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/middleware.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
487	            if websocket.client_state != WebSocketState.DISCONNECTED:
488	                await websocket.close(code=1011)  # Internal error
489	            raise

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/api/utils.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	        else:
65	            webbrowser.get(browser).open(url)
66	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/export/__init__.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	                    if (
230	                        op_data.get("output")
231	                        and op_data["output"]["channel"]

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/export/exporter.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
92	                cast(KnownMimeType, mime_type),
93	                base64.b64encode(buffer_contents),
94	            )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/export/exporter.py:93
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
92	                cast(KnownMimeType, mime_type),
93	                base64.b64encode(buffer_contents),
94	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/export/exporter.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
524	        )
525	        url = f"https://cdn.jsdelivr.net/npm/@marimo-team/frontend@{__version__}/dist/index.html"
526	        with urllib.request.urlopen(url) as response:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/export/exporter.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
525	        url = f"https://cdn.jsdelivr.net/npm/@marimo-team/frontend@{__version__}/dist/index.html"
526	        with urllib.request.urlopen(url) as response:
527	            return cast(str, response.read().decode("utf-8"))

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/file_router.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
310	    # Set the timeout handler
311	    original_handler = signal.signal(signal.SIGALRM, timeout_handler)
312	    try:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/file_router.py:311
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
310	    # Set the timeout handler
311	    original_handler = signal.signal(signal.SIGALRM, timeout_handler)
312	    try:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/file_router.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
316	        signal.alarm(0)
317	        signal.signal(signal.SIGALRM, original_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/file_router.py:317
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
316	        signal.alarm(0)
317	        signal.signal(signal.SIGALRM, original_handler)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
109	            with open(path, encoding=encoding) as file:
110	                return file.read()
111	        except UnicodeDecodeError:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
113	            with open(path, mode="rb") as file:
114	                return base64.b64encode(file.read()).decode("utf-8")
115	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:114
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
113	            with open(path, mode="rb") as file:
114	                return base64.b64encode(file.read()).decode("utf-8")
115	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
113	            with open(path, mode="rb") as file:
114	                return base64.b64encode(file.read()).decode("utf-8")
115	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
154	        if os.path.isdir(path):
155	            shutil.rmtree(path)
156	        else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
191	            # Use system default if no editor specified
192	            if platform.system() == "Darwin":  # macOS
193	                subprocess.call(("open", path))

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
191	            # Use system default if no editor specified
192	            if platform.system() == "Darwin":  # macOS
193	                subprocess.call(("open", path))

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:192
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
191	            # Use system default if no editor specified
192	            if platform.system() == "Darwin":  # macOS
193	                subprocess.call(("open", path))

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
193	                subprocess.call(("open", path))
194	            elif platform.system() == "Windows":  # Windows
195	                # startfile only exists on Windows

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
193	                subprocess.call(("open", path))
194	            elif platform.system() == "Windows":  # Windows
195	                # startfile only exists on Windows

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/files/os_file_system.py:194
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
193	                subprocess.call(("open", path))
194	            elif platform.system() == "Windows":  # Windows
195	                # startfile only exists on Windows

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/lsp.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	                stderr_output = (
90	                    self.process.stderr.read()
91	                    if self.process.stderr

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/lsp.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	        return (
148	            "node.js binary is missing. Install node at https://nodejs.org/."
149	        )
150	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/lsp.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
171	            title="GitHub Copilot: Connection Error",
172	            description="<span><a class='hyperlink' href='https://docs.marimo.io/getting_started/index.html#github-copilot'>Install Node.js</a> to use copilot.</span>",
173	            variant="danger",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/lsp.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
201	            title="Python LSP: Connection Error",
202	            description="<span><a class='hyperlink' href='https://github.com/python-lsp/python-lsp-server'>Install python-lsp-server</a> for Python language support.</span>",
203	            variant="danger",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/main.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
57	    if allow_origins is None:
58	        allow_origins = ("localhost", "127.0.0.1") + (
59	            (host,) if host is not None else ()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/main.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	        port = path.split("/", 3)[2]
117	        return f"http://localhost:{port}"
118	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/main.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	                proxy_path=f"/lsp/{server.id}",
142	                target_url=f"http://localhost:{server.port}",
143	                path_rewrite=lambda path: path.replace(

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/print.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
64	
65	    hostname = socket.gethostname()
66	    try:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/print.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
64	
65	    hostname = socket.gethostname()
66	    try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/session/session_view.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
144	        if isinstance(operation, CellOp):
145	            previous = self.cell_operations.get(operation.cell_id)
146	            self.cell_operations[operation.cell_id] = merge_cell_operation(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/session/session_view.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	        for cell_id in ids:
249	            cell_op = self.cell_operations.get(cell_id)
250	            if cell_op is not None and cell_op.output is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/session/session_view.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	        for cell_id in ids:
260	            cell_op = self.cell_operations.get(cell_id)
261	            if cell_op is not None and cell_op.console:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/session/session_view.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	        elif event == "end":
276	            start = self.last_execution_time.get(cell_id)
277	            start = start if start else 0

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	            # queues to empty
138	            self.control_queue.cancel_join_thread()
139	            self.control_queue.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	        if isinstance(self.set_ui_element_queue, MPQueue):
146	            self.set_ui_element_queue.cancel_join_thread()
147	            self.set_ui_element_queue.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	            # again, don't make the child process wait for the queues to empty
151	            self.input_queue.cancel_join_thread()
152	            self.input_queue.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
154	        if isinstance(self.completion_queue, MPQueue):
155	            self.completion_queue.cancel_join_thread()
156	            self.completion_queue.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
158	        if isinstance(self.win32_interrupt_queue, MPQueue):
159	            self.win32_interrupt_queue.cancel_join_thread()
160	            self.win32_interrupt_queue.close()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
194	            listener = connection.Listener(family="AF_INET")
195	            self.kernel_task = mp.Process(
196	                target=runtime.launch_kernel,
197	                args=(
198	                    self.queue_manager.control_queue,
199	                    self.queue_manager.set_ui_element_queue,
200	                    self.queue_manager.completion_queue,
201	                    self.queue_manager.input_queue,
202	                    # stream queue unused
203	                    None,
204	                    listener.address,
205	                    is_edit_mode,
206	                    self.configs,
207	                    self.app_metadata,
208	                    self.config_manager.get_config(hide_secrets=False),
209	                    self._virtual_files_supported,
210	                    self.redirect_console_to_browser,
211	                    self.queue_manager.win32_interrupt_queue,
212	                    self.profile_path,
213	                    GLOBAL_SETTINGS.LOG_LEVEL,
214	                ),
215	                # The process can't be a daemon, because daemonic processes
216	                # can't create children
217	                # https://docs.python.org/3/library/multiprocessing.html#multiprocessing.Process.daemon  # noqa: E501
218	                daemon=False,
219	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
237	            # down all client sessions
238	            self.kernel_task = threading.Thread(
239	                target=launch_kernel_with_cleanup,
240	                args=(
241	                    self.queue_manager.control_queue,
242	                    self.queue_manager.set_ui_element_queue,
243	                    self.queue_manager.completion_queue,
244	                    self.queue_manager.input_queue,
245	                    self.queue_manager.stream_queue,
246	                    # IPC not used in run mode
247	                    None,
248	                    is_edit_mode,
249	                    self.configs,
250	                    self.app_metadata,
251	                    self.config_manager.get_config(hide_secrets=False),
252	                    self._virtual_files_supported,
253	                    self.redirect_console_to_browser,
254	                    # win32 interrupt queue
255	                    None,
256	                    # profile path
257	                    None,
258	                    # log level
259	                    GLOBAL_SETTINGS.LOG_LEVEL,
260	                ),
261	                # daemon threads can create child processes, unlike
262	                # daemon processes
263	                daemon=True,
264	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
583	                )
584	        self.session_view.add_control_request(request)
585	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
687	
688	        self.put_control_request(
689	            CreationRequest(
690	                execution_requests=execution_requests,
691	                set_ui_element_value_request=SetUIElementValueRequest(
692	                    object_ids=request.object_ids,
693	                    values=request.values,
694	                    token=str(uuid4()),
695	                    request=http_request,
696	                ),
697	                auto_run=request.auto_run,
698	                request=http_request,
699	            ),
700	            from_consumer_id=None,
701	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
909	                # This runs the request and also runs UpdateCellCodes
910	                session.put_control_request(
911	                    ExecuteMultipleRequest(
912	                        cell_ids=changed_cell_ids_list,
913	                        codes=changed_codes,
914	                        request=None,
915	                    ),
916	                    from_consumer_id=None,
917	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/sessions.py:978
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
977	    def get_session(self, session_id: SessionId) -> Optional[Session]:
978	        session = self.sessions.get(session_id)
979	        if session:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/templates/templates.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	    if asset_url is None:
123	        asset_url = f"https://cdn.jsdelivr.net/npm/@marimo-team/frontend@{__version__}/dist"
124	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/templates/templates.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
351	    # Encode the URL-encoded string to Base64
352	    base64_encoded = base64.b64encode(url_encoded.encode()).decode()
353	    return base64_encoded

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/templates/templates.py:352
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
351	    # Encode the URL-encoded string to Base64
352	    base64_encoded = base64.b64encode(url_encoded.encode()).decode()
353	    return base64_encoded

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/utils.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
44	
45	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
46	        try:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
46	        try:
47	            sock.settimeout(0.1)
48	            in_use = sock.connect_ex(("localhost", port)) == 0

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/uvicorn_utils.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
34	
35	        signal.signal(signal.SIGINT, noop)
36	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/uvicorn_utils.py:35
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
34	
35	        signal.signal(signal.SIGINT, noop)
36	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/uvicorn_utils.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
64	
65	            signal.signal(signal.SIGINT, noop)
66	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_server/uvicorn_utils.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
64	
65	            signal.signal(signal.SIGINT, noop)
66	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_snippets/data/huggingface-0.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    mo.md(
11	        r"""
12	        # Hugging Face: Datasets with Polars
13	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_snippets/data/huggingface-1.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    mo.md(
11	        r"""
12	        # Hugging Face: Datasets with SQL
13	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_snippets/data/pandas-25.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    mo.md(
21	        r"""
22	        You can group timestamped data into intervals of arbitrary duration using a Grouper object to specify groupby instructions.  The `freq` parameter is a string that may contain an integer followed by an [offset alias](https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases).  E.g. To see output for 2 minute long intervals:
23	        """

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tracer.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	                    for span in spans:
116	                        f.write(span.to_json(cast(Any, None)))
117	                        f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tracer.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	                        f.write(span.to_json(cast(Any, None)))
117	                        f.write("\n")
118	                return SpanExportResult.SUCCESS

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/__init__.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
54	    with open(file, "r", encoding="utf8") as f:
55	        return f.read()
56	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/for_jupyter_users.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	    mo.md(
88	        """
89	        ## Interactive elements built-in
90	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/for_jupyter_users.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
156	    mo.md(
157	        r"""
158	        ## Cell order
159	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/for_jupyter_users.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
297	    mo.md(
298	        r"""
299	        ## Parting thoughts
300	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/intro.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
276	    mo.md(
277	        """
278	        ## 5. The `marimo` command-line tool
279	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/intro.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
444	        "Code Formatting": (
445	            """
446	            If you have [ruff](https://github.com/astral-sh/ruff) installed,
447	            you can format a cell with the keyboard shortcut `Ctrl/Cmd+b`.
448	            """
449	        ),
450	        "Command Palette": (
451	            """
452	            Use `Ctrl/Cmd+k` to open the command palette.
453	            """
454	        ),
455	        "Keyboard Shortcuts": (
456	            """
457	            Open the notebook menu (top-right) or input `Ctrl/Cmd+Shift+h` to
458	            view a list of all keyboard shortcuts.
459	            """
460	        ),
461	        "Configuration": (
462	            """
463	           Configure the editor by clicking the gears icon near the top-right
464	           of the screen.
465	           """
466	        ),
467	        "Exit & Shutdown": (
468	            """
469	           You can leave Marimo & shut down the server by clicking the
470	           circled X at the top right of the screen and responding
471	           to the prompt. 
472	
473	           :floppy_disk: _Be sure to save your work first!_ 
474	           """
475	        ),
476	    }
477	    return (tips,)
478	
479	
480	if __name__ == "__main__":
481	    app.run()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/markdown.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	            "Note: KaTeX": mo.md(
120	                """
121	                marimo actually uses KaTeX, a math typesetting library for the
122	                web which supports a subset of LaTeX. For a list of

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/sql.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    mo.md(
24	        r"""
25	        With marimo, you can mix-and-match both **Python and SQL**. To create a
26	        SQL cell, you first need to install some additional dependencies,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/sql.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
335	    mo.md(
336	        r"""
337	        We're not limited to querying dataframes. We can also query an **HTTP URL, S3 path, or a file path to a local csv or parquet file**.
338	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/sql.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
358	    cars = mo.sql(
359	        f"""
360	        -- Download a CSV and create an in-memory table; this is optional.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/ui.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	def _(mo):
105	    mo.md("""marimo has a [large library of simple UI elements](https://docs.marimo.io/api/inputs/index.html). Here are a just few examples:""")
106	    return

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/ui.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	    mo.md(
112	        """
113	        See our [examples folder](https://github.com/marimo-team/marimo/tree/main/examples/ui) on GitHub for bite-sized notebooks showcasing all our UI elements. For
114	        a more detailed reference, see our [API docs](https://docs.marimo.io/api/inputs/).

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_tutorials/ui.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
334	    mo.md(
335	        r"""
336	        ### Building custom elements
337	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_utils/data_uri.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
20	    mime_type = mime_type.split(";")[0][5:]
21	    return mime_type, base64.b64decode(data)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_utils/data_uri.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
20	    mime_type = mime_type.split(";")[0][5:]
21	    return mime_type, base64.b64decode(data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_utils/distributor.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	    def start(self) -> threading.Thread:
130	        self.thread = threading.Thread(target=self._loop, daemon=True)
131	        self.thread.start()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_utils/signals.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
17	
18	    signal.signal(signal.SIGTERM, signal.SIG_DFL)
19	    signal.signal(signal.SIGINT, signal.SIG_DFL)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_utils/signals.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
17	
18	    signal.signal(signal.SIGTERM, signal.SIG_DFL)
19	    signal.signal(signal.SIGINT, signal.SIG_DFL)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_utils/signals.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
18	    signal.signal(signal.SIGTERM, signal.SIG_DFL)
19	    signal.signal(signal.SIGINT, signal.SIG_DFL)
20	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_utils/signals.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
18	    signal.signal(signal.SIGTERM, signal.SIG_DFL)
19	    signal.signal(signal.SIGINT, signal.SIG_DFL)
20	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_utils/signals.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
23	    return {
24	        signal.SIGTERM: signal.getsignal(signal.SIGTERM),
25	        signal.SIGINT: signal.getsignal(signal.SIGINT),

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marimo-0.12.8/marimo-0.12.8/marimo/_utils/signals.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
24	        signal.SIGTERM: signal.getsignal(signal.SIGTERM),
25	        signal.SIGINT: signal.getsignal(signal.SIGINT),
26	    }

--------------------------------------------------

Code scanned:
	Total lines of code: 60199
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 124.0
		High: 387.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 458.0
		High: 53.0
Files skipped (0):
