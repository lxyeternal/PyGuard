Run started:2025-04-12 16:04:18.695550

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/src/opentelemetry/util/http/httplib.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
157	
158	    instrument_connect(http.client.HTTPConnection)
159	    # No need to instrument HTTPSConnection, as it calls super().connect()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
52	    def test_basic(self):
53	        resp, body = self.perform_request()
54	        assert resp.status == 200

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
62	        ) as span, set_ip_on_next_http_connection(span):
63	            resp, body = self.perform_request()
64	        assert resp.status == 200

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
66	        span = self.assert_span(num_spans=1)
67	        self.assertEqual(span.attributes, {"net.peer.ip": "127.0.0.1"})
68	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
76	            ) as span2, set_ip_on_next_http_connection(span2):
77	                resp, body = self.perform_request()
78	        assert resp.status == 200

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
80	        for span in self.assert_span(num_spans=2):
81	            self.assertEqual(span.attributes, {"net.peer.ip": "127.0.0.1"})
82	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
90	            ):
91	                resp, body = self.perform_request()
92	        assert resp.status == 200

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
94	        span = self.assert_span(num_spans=1)
95	        self.assertEqual(span.attributes, {"net.peer.ip": "127.0.0.1"})
96	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
100	        ):
101	            resp, body = self.perform_request()
102	        assert resp.status == 200

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
110	        try:
111	            conn.request("GET", "/", headers={"Connection": "close"})
112	            resp = conn.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
111	            conn.request("GET", "/", headers={"Connection": "close"})
112	            resp = conn.getresponse()
113	            return resp, resp.read()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_http_base.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
125	        ) as span, set_ip_on_next_http_connection(span):
126	            body = self.perform_request()[1]
127	        self.assertEqual(b"Hello!", body)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_remove_credentials.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	    def test_remove_no_credentials(self):
8	        url = "http://opentelemetry.io:8080/test/path?query=value"
9	        cleaned_url = remove_url_credentials(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_remove_credentials.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    def test_remove_credentials(self):
13	        url = "http://someuser:somepass@opentelemetry.io:8080/test/path?query=value"
14	        cleaned_url = remove_url_credentials(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_remove_credentials.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	        self.assertEqual(
16	            cleaned_url, "http://opentelemetry.io:8080/test/path?query=value"
17	        )
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_remove_credentials.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    def test_remove_credentials_ipv4_literal(self):
20	        url = "http://someuser:somepass@127.0.0.1:8080/test/path?query=value"
21	        cleaned_url = remove_url_credentials(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_remove_credentials.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        self.assertEqual(
23	            cleaned_url, "http://127.0.0.1:8080/test/path?query=value"
24	        )
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_remove_credentials.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    def test_remove_credentials_ipv6_literal(self):
27	        url = "http://someuser:somepass@[::1]:8080/test/path?query=value"
28	        cleaned_url = remove_url_credentials(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_remove_credentials.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	        self.assertEqual(
30	            cleaned_url, "http://[::1]:8080/test/path?query=value"
31	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_try_set_ip.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
38	    def test_ip_set_successfully(self):
39	        self.conn.sock.getpeername.return_value = ("192.168.1.1", 8080)
40	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_util_http-0.53b0/opentelemetry_util_http-0.53b0/tests/test_try_set_ip.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
45	            span.set_attribute.assert_called_once_with(
46	                "net.peer.ip", "192.168.1.1"
47	            )
48	        self.assertTrue(success)

--------------------------------------------------

Code scanned:
	Total lines of code: 655
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 0.0
Files skipped (0):
