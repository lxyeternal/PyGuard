Run started:2025-04-12 18:30:10.544815

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/examples/matthews.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	    for path in get_file_paths_from_args():
67	        block = cif.read(path).sole_block()
68	        code = cif.as_string(block.find_value('_entry.id'))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/examples/monomers.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
54	    for path in get_monomer_cifs(mon_path):
55	        mon = cif.read(path)
56	        for mb in mon:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/examples/monomers.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
140	        sys.exit('Unknown monomer library path: use -m or set $CLIBD_MON.')
141	    ccd = cif.read(args.ccd_path)
142	    if args.f:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/examples/multiproc.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
13	def main(top_dir):
14	    with multiprocessing.Pool(processes=4) as pool:
15	        it = pool.imap_unordered(f, gemmi.CoorFileWalk(top_dir))

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/examples/multiproc.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
13	def main(top_dir):
14	    with multiprocessing.Pool(processes=4) as pool:
15	        it = pool.imap_unordered(f, gemmi.CoorFileWalk(top_dir))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/examples/refln-stats.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
17	def process(path):
18	    doc = gemmi.cif.read(path)
19	    code = os.path.basename(path)[1:5]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/examples/weight.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
115	    for path in get_file_paths_from_args():
116	        block = cif.read(path).sole_block()
117	        check_chem_comp_formula_weight(block)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_cif.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
223	        path = os.path.join(os.path.dirname(__file__), '5i55.cif')
224	        block = cif.read(path).sole_block()
225	        self.assertEqual(len(block.get_mmcif_category_names()), 54)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_cif.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
252	        path = os.path.join(os.path.dirname(__file__), '1pfe.cif.gz')
253	        cif_doc = cif.read(path)
254	        block = cif_doc.sole_block()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_cif.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
278	        with self.assertRaises(IOError):
279	            cif.read('file-that-does-not-exist.cif')
280	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_cif.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
296	        with open(path) as f:
297	            cif_string = f.read()
298	        doc = cif.read_string(cif_string)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_cif.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
372	    def test_frame_reading(self):
373	        block = cif.read(full_path('mmcif_pdbx_v50_frag.dic')).sole_block()
374	        self.assertIsNone(block.find_frame('heyho'))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_cif.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
392	        ddl = cif.Ddl(logger=(lambda msg: msg_list.append(msg), 6))
393	        ddl.read_ddl(cif.read(full_path('mmcif_pdbx_v50_frag.dic')))
394	        self.assertEqual(msg_list, [])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_hkl.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
191	    def test_reading(self):
192	        doc = gemmi.cif.read(full_path('r5wkdsf.ent'))
193	        rblock = gemmi.as_refln_blocks(doc)[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_hkl.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
200	    def test_scaling(self):
201	        doc = gemmi.cif.read(full_path('r5wkdsf.ent'))
202	        rblock = gemmi.as_refln_blocks(doc)[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_hkl.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
254	    def test_reading(self):
255	        doc = gemmi.cif.read(full_path('cc12-hkl.cif'))
256	        rblock = gemmi.as_refln_blocks(doc)[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_hkl.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	            self.assertEqual(d.wavelength, 0.97)
288	        doc = gemmi.cif.read(full_path('4aap-sf-subset.cif'))
289	        (rblock,) = gemmi.as_refln_blocks(doc)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
189	    def test_read_5i55_again(self):
190	        block = gemmi.cif.read(full_path('5i55.cif'))[0]
191	        st = gemmi.make_structure_from_block(block)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
490	        st = gemmi.read_structure(path)
491	        out_lines = self.write_and_read(st, via_cif)
492	        self.assertEqual(expected, out_lines)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
500	            expected = [line for line in f if is_written_to_pdb(line, via_cif)]
501	        out_lines = self.write_and_read(gemmi.read_structure(path), via_cif)
502	        self.assertEqual(expected[0], out_lines[0])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
531	            st = gemmi.make_structure_from_block(doc[0])
532	        out_lines = self.write_and_read(st, via_cif=False)
533	        if via_cif:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
548	        st = gemmi.read_structure(path, merge_chain_parts=False)
549	        out_lines = self.write_and_read(st, via_cif)
550	        self.assertEqual(expected, out_lines)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
612	        with open(path) as f:
613	            frag = f.read()
614	        st = gemmi.read_pdb_string(frag)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:877
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
876	                    for cra in st_out[0].all()]
877	        self.assertEqual(write_and_read(),
878	                         [('B OXT', 1), ('A CU', 3), ('B CU', 4)])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:880
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
879	        st.merge_chain_parts()
880	        self.assertEqual(write_and_read(),
881	                         [('B OXT', 1), ('B CU', 3), ('A CU', 4)])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
881	                         [('B OXT', 1), ('B CU', 3), ('A CU', 4)])
882	        self.assertEqual(write_and_read(numbered_ter=False),
883	                         [('B OXT', 1), ('B CU', 2), ('A CU', 3)])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
883	                         [('B OXT', 1), ('B CU', 2), ('A CU', 3)])
884	        self.assertEqual(write_and_read(preserve_serial=True),
885	                         [('B OXT', 1643), ('B CU', 1646), ('A CU', 1645)])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_mol.py:887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
886	        st.assign_serial_numbers(numbered_ter=True)
887	        self.assertEqual(write_and_read(preserve_serial=True),
888	                         [('B OXT', 1), ('B CU', 3), ('A CU', 4)])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_monlib.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	        path = full_path('SO3.cif')
22	        block = gemmi.cif.read(path)[-1]
23	        st = gemmi.make_structure_from_chemcomp_block(block)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_monlib.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	        cif_path = full_path('HEM.cif')
30	        cif_block = gemmi.cif.read(cif_path).sole_block()
31	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_monlib.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
58	        path = full_path('HEN.cif')
59	        block = gemmi.cif.read(path).sole_block()
60	        st = gemmi.make_structure_from_chemcomp_block(block)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_monlib.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	        path = os.path.join(os.path.dirname(__file__), 'HEM.cif')
67	        block = gemmi.cif.read(path).sole_block()
68	        cc = gemmi.make_chemcomp_from_block(block)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_monlib.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
79	        path = os.path.join(os.path.dirname(__file__), 'HEN.cif')
80	        block = gemmi.cif.read(path).sole_block()
81	        cc = gemmi.make_chemcomp_from_block(block)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_monlib.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	        path = os.path.join(os.path.dirname(__file__), 'SO3.cif')
87	        block = gemmi.cif.read(path)[-1]
88	        cc = gemmi.make_chemcomp_from_block(block)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gemmi-0.7.1/gemmi-0.7.1/tests/test_monlib.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
97	        path = full_path('HEM.cif')
98	        block = gemmi.cif.read(path)[-1]
99	        cc = gemmi.make_chemcomp_from_block(block)

--------------------------------------------------

Code scanned:
	Total lines of code: 4319
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 34.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 1.0
Files skipped (0):
