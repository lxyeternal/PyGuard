Run started:2025-04-12 17:01:51.866981

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/cache_lock.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	        file_handle = self._lock.__enter__()
62	        file_handle.write('{} {}'.format(pid, sys.argv[0]).encode('utf-8'))  # pylint: disable=consider-using-f-string
63	        return file_handle

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/filelock.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
35	                with open(self._lockpath, 'xb') as lock_file:  # pylint: disable=unspecified-encoding
36	                    lock_file.write(content)
37	                return None  # Happy path

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/libsecret.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	except ImportError:
20	    raise ImportError("""Unable to import module 'gi'
21	Runtime dependency of PyGObject is missing.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/osx.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        self.message = (
25	            '{} see https://opensource.apple.com/source/CarbonHeaders/CarbonHeaders-18.1/MacErrors.h'  # pylint: disable=consider-using-f-string,line-too-long
26	            .format(self.exit_status))

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/osx.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
38	# Load native MacOS libraries
39	_SECURITY = _ctypes.CDLL(_get_native_location('Security'))
40	_CORE = _ctypes.CDLL(_get_native_location('CoreFoundation'))

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/osx.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
39	_SECURITY = _ctypes.CDLL(_get_native_location('Security'))
40	_CORE = _ctypes.CDLL(_get_native_location('CoreFoundation'))
41	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/persistence.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
153	        with os.fdopen(_open(self._location), 'w+') as handle:
154	            handle.write(content)
155	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/persistence.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
160	            with open(self._location, 'r') as handle:  # pylint: disable=unspecified-encoding
161	                return handle.read()
162	        except EnvironmentError as exp:  # EnvironmentError in Py 2.7 works across platform

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/persistence.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
215	        with os.fdopen(_open(self._location), 'wb+') as handle:
216	            handle.write(data)
217	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/persistence.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
221	            with open(self._location, 'rb') as handle:
222	                data = handle.read()
223	        except EnvironmentError as exp:  # EnvironmentError in Py 2.7 works across platform

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/persistence.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	                err_no=getattr(exception, "winerror", None),  # Exists in Python 3 on Windows
240	                message="Decryption failed: {} "
241	                    "App developer may consider this guidance: "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/msal_extensions/windows.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    -2146893813: "Key not valid for use in specified state.",
45	    -2146892987: "The requested operation cannot be completed. "
46	        "The computer must be trusted for delegation and "
47	        "the current user account must be configured to allow delegation. "
48	        "See also https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/enable-computer-and-user-accounts-to-be-trusted-for-delegation",
49	    13: "The data is invalid.",
50	    }
51	
52	# This code is modeled from a StackOverflow question, which can be found here:
53	# https://stackoverflow.com/questions/463832/using-dpapi-with-python

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_agnostic_backend.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
18	    yield os.path.join(test_folder, 'token_cache.bin')
19	    shutil.rmtree(test_folder, ignore_errors=True)
20	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_agnostic_backend.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	def _test_token_cache_roundtrip(persistence):
22	    desired_scopes = ['https://graph.microsoft.com/.default']
23	    apps = [  # Multiple apps sharing same persistence

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_cache_lock_file_perf.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
14	    yield os.path.join(test_folder, 'persistence.bin')
15	    shutil.rmtree(test_folder, ignore_errors=True)
16	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_cache_lock_file_perf.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	    with open(cache_location) as handle:
20	        data = handle.read()
21	    prev_process_id = None

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_cache_lock_file_perf.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
40	    for i in range(no_of_processes):
41	        process = multiprocessing.Process(
42	            target=_acquire_lock_and_write_to_cache,
43	            args=(cache_location, sleep_interval))
44	        processes.append(process)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_macos_backend.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	            token_cache=subject)
40	        desired_scopes = ['https://graph.microsoft.com/.default']
41	        token1 = app.acquire_token_for_client(scopes=desired_scopes)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_macos_backend.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
46	    finally:
47	        shutil.rmtree(test_folder, ignore_errors=True)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_persistence.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
27	    yield os.path.join(test_folder, 'persistence.bin')
28	    shutil.rmtree(test_folder, ignore_errors=True)
29	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_windows_backend.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
58	            with open(loc, mode='rb') as fh:
59	                contents = fh.read()
60	            found = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_windows_backend.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	            token_cache=subject)
94	        desired_scopes = ['https://graph.microsoft.com/.default']
95	        token1 = app.acquire_token_for_client(scopes=desired_scopes)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal_extensions-1.3.1/msal_extensions-1.3.1/tests/test_windows_backend.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
100	    finally:
101	        shutil.rmtree(test_folder, ignore_errors=True)

--------------------------------------------------

Code scanned:
	Total lines of code: 1168
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 16.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 0.0
Files skipped (0):
