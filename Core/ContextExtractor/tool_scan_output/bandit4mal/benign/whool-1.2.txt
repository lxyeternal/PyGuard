Run started:2025-04-12 10:19:03.532831

Test results:
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/whool-1.2/whool-1.2/src/whool/buildapi.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
80	def _write_metadata(path: Path, msg: Message) -> None:
81	    with open(path, "w", encoding="utf-8") as f:
82	        Generator(f, mangle_from_=False, maxheaderlen=0).flatten(msg)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/whool-1.2/whool-1.2/src/whool/buildapi.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
123	        return None
124	    with open(pkg_info_path, encoding="utf-8") as f:
125	        return HeaderParser().parse(f)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/whool-1.2/whool-1.2/src/whool/buildapi.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
155	            if editable_dir.is_dir():
156	                shutil.rmtree(editable_dir)
157	            editable_addons_dir = editable_dir / "odoo" / "addons"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/whool-1.2/whool-1.2/src/whool/buildapi.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
213	        _make_pkg_info(metadata, sdist_tmpdir)
214	        with tarfile.open(
215	            str(sdist_directory / sdist_tar_name),
216	            mode="w|gz",
217	            format=tarfile.PAX_FORMAT,
218	        ) as tf:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/whool-1.2/whool-1.2/tests/test_build_editable.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
27	            assert "odoo-addon-addon1.pth" in names
28	            assert zf.open("odoo-addon-addon1.pth", "r").read().decode("utf-8") == str(
29	                editable_dir.resolve()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/whool-1.2/whool-1.2/tests/test_build_sdist.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
22	    tmp_path2.mkdir()
23	    with TarFile.open(tmp_path / sdist_name, mode="r:gz") as tf1:
24	        tf1_names = sorted(tf1.getnames())

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/whool-1.2/whool-1.2/tests/test_build_sdist.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
33	    # extract 2nd sdist and test that the root directory has the correct name
34	    with TarFile.open(tmp_path3 / sdist_name, mode="r:gz") as tf2:
35	        tf2_names = sorted(tf2.getnames())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/whool-1.2/whool-1.2/tests/test_prepare_metadata.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
39	    with addon1_with_pyproject.joinpath("pyproject.toml").open("a") as f:
40	        f.write(
41	            textwrap.dedent(
42	                """
43	                [tool.whool]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/whool-1.2/whool-1.2/tests/test_prepare_metadata.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
58	    with addon1_with_pyproject.joinpath("pyproject.toml").open("a") as f:
59	        f.write(
60	            textwrap.dedent(
61	                """
62	                [tool.whool]

--------------------------------------------------

Code scanned:
	Total lines of code: 607
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 0.0
Files skipped (0):
