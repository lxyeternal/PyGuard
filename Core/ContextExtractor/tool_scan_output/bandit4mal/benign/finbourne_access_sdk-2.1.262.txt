Run started:2025-04-12 19:53:00.796706

Test results:
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/api_client.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
109	            atexit.register(self.close)
110	            self._pool = ThreadPool(self.pool_threads)
111	        return self._pool

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/api_client.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
590	                        filename = os.path.basename(f.name)
591	                        filedata = f.read()
592	                        mimetype = (mimetypes.guess_type(filename)[0] or

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/api_client.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
704	        with open(path, "wb") as f:
705	            f.write(response.data)
706	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/api_client.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
704	        with open(path, "wb") as f:
705	            f.write(response.data)
706	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/configuration.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
130	        """
131	        self._base_path = "https://fbn-prd.lusid.com/access" if host is None else host
132	        """Default Base url

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/configuration.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
458	            {
459	                'url': "https://fbn-prd.lusid.com/access",
460	                'description': "No description provided",
461	            }
462	        ]

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/api_client.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
108	            atexit.register(self.close)
109	            self._pool = ThreadPool(self.pool_threads)
110	        return self._pool

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/api_client.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
588	                        filename = os.path.basename(f.name)
589	                        filedata = f.read()
590	                        mimetype = (mimetypes.guess_type(filename)[0] or

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/api_client.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
702	        with open(path, "wb") as f:
703	            f.write(response.data)
704	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/api_client.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
702	        with open(path, "wb") as f:
703	            f.write(response.data)
704	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/proxy_config.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	            raise ValueError(
28	                f"The provided proxy address of {address} does not contain a protocol, please specify in the full format e.g. http://myproxy.com:8080"
29	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/refreshing_token.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	        delta = timedelta(
69	            seconds=id_provider_json.get("expires_in", 3600) - self.expiry_offset
70	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/refreshing_token.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
107	        # make request to Okta to get an authentication token
108	        id_provider_response = requests.post(
109	            self.token_url, data=token_request_body, **kwargs
110	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/refreshing_token.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
147	        if self.token_data["expires"] <= datetime.utcnow():
148	            encoded_client = base64.b64encode(
149	                bytes(f"{self.client_id}:{self.client_secret}", "utf-8")
150	            )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/refreshing_token.py:148
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
147	        if self.token_data["expires"] <= datetime.utcnow():
148	            encoded_client = base64.b64encode(
149	                bytes(f"{self.client_id}:{self.client_secret}", "utf-8")
150	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/refreshing_token.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
167	
168	            id_provider_response = requests.post(
169	                self.token_url, data=request_body, **kwargs
170	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/refreshing_token.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	        if "Retry-After" in id_provider_response.headers:
216	            retry_value = id_provider_response.headers.get("Retry-After")
217	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/tcp_keep_alive_connector.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
54	    async def close(self) -> None:
55	        await self.__connector.close()
56	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/extensions/tcp_keep_alive_connector.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
71	        """
72	        connection = await self.__connector.connect(req, traces, timeout)
73	        sock = connection.protocol.transport.get_extra_info("socket")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/rest.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
214	
215	        r = await self.pool_manager.request(**args)
216	        if _preload_content:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/rest.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
217	
218	            data = await r.read()
219	            r = RESTResponse(r, data)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/rest.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
230	                  _preload_content=True, _request_timeout=None, opts=None):
231	        return (await self.request("GET", url,
232	                                   headers=headers,
233	                                   _preload_content=_preload_content,
234	                                   _request_timeout=_request_timeout,
235	                                   query_params=query_params,
236	                                   opts=opts))
237	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/rest.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
239	                   _preload_content=True, _request_timeout=None, opts=None):
240	        return (await self.request("HEAD", url,
241	                                   headers=headers,
242	                                   _preload_content=_preload_content,
243	                                   _request_timeout=_request_timeout,
244	                                   query_params=query_params,
245	                                   opts=opts))
246	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/rest.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
249	                      _request_timeout=None, opts=None):
250	        return (await self.request("OPTIONS", url,
251	                                   headers=headers,
252	                                   query_params=query_params,
253	                                   post_params=post_params,
254	                                   _preload_content=_preload_content,
255	                                   _request_timeout=_request_timeout,
256	                                   body=body,
257	                                   opts=opts))
258	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/rest.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
261	                     opts=None):
262	        return (await self.request("DELETE", url,
263	                                   headers=headers,
264	                                   query_params=query_params,
265	                                   _preload_content=_preload_content,
266	                                   _request_timeout=_request_timeout,
267	                                   body=body,
268	                                   opts=opts))
269	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/rest.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
272	                   _request_timeout=None, opts=None):
273	        return (await self.request("POST", url,
274	                                   headers=headers,
275	                                   query_params=query_params,
276	                                   post_params=post_params,
277	                                   _preload_content=_preload_content,
278	                                   _request_timeout=_request_timeout,
279	                                   body=body,
280	                                   opts=opts))
281	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/rest.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
284	                  opts=None):
285	        return (await self.request("PUT", url,
286	                                   headers=headers,
287	                                   query_params=query_params,
288	                                   post_params=post_params,
289	                                   _preload_content=_preload_content,
290	                                   _request_timeout=_request_timeout,
291	                                   body=body,
292	                                   opts=opts))
293	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finbourne_access_sdk-2.1.262/finbourne_access_sdk-2.1.262/finbourne_access/rest.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
296	                    _request_timeout=None, opts=None):
297	        return (await self.request("PATCH", url,
298	                                   headers=headers,
299	                                   query_params=query_params,
300	                                   post_params=post_params,
301	                                   _preload_content=_preload_content,
302	                                   _request_timeout=_request_timeout,
303	                                   body=body,
304	                                   opts=opts))

--------------------------------------------------

Code scanned:
	Total lines of code: 15343
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 24.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 1.0
Files skipped (0):
