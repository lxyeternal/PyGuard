Run started:2025-04-12 17:57:03.049802

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/rpc.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
117	            with open(context_file, 'r') as cf:
118	                file_settings = json.loads(cf.read()).get('settings', {})
119	            props.update(file_settings)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/rpc.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
218	            sio = compat.BytesIO()
219	            sio.write(struct.pack('<I', method.index))
220	            sio.write(request.SerializeToString())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/rpc.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
219	            sio.write(struct.pack('<I', method.index))
220	            sio.write(request.SerializeToString())
221	

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/runtime/ctypes_libs.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
38	try:
39	    odps_subproc = CDLL(_lib_path, mode=RTLD_GLOBAL)
40	except OSError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/runtime/ctypes_libs.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
226	                try:
227	                    chunk = self.read(READ_CHUNK)
228	                except SubprocessStreamEOFError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/runtime/ctypes_libs.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
229	                    chunk = b''
230	                buf_io.write(chunk)
231	                if len(chunk) < READ_CHUNK:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/runtime/ctypes_libs.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
235	            p = create_string_buffer(size)
236	            Subprocess_StdIStream_read(self._ptr, p, size)
237	            return p.raw

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/runtime/ctypes_libs.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
244	        p = array_cls.from_buffer(b, offset)
245	        ret_size = Subprocess_StdIStream_read(self._ptr, p, size)
246	        if ret_size == 0 and Subprocess_StdIStream_eof(self._ptr):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/runtime/ctypes_libs.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
310	        atype = c_char * length
311	        Subprocess_StdOStream_write(self._ptr, atype.from_buffer_copy(data), length)
312	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/runtime/ctypes_libs.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
377	    def write(self, data):
378	        self._stream.write(data)
379	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/runtime/runtime_test.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	        ri = self.client.create_file_reader('test', b'222')
52	        self.assertEqual(ri.read(), b'222_test')
53	        self.assertEqual(ri.result(), b'222_test')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/runtime/runtime_test.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	        ro = self.client.create_file_writer('test', b'333')
57	        ro.write(b'444')
58	        ro.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/runtime/runtime_test.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
70	        for _ in range(10):
71	            writer.write(rec)
72	        writer.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/cupid/session.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	        expired_in_hours = expired_in_hours or 30 * 24
110	        return 'http://%s.%s' % (self.get_proxy_token(instance, app_name, expired_in_hours),
111	                                 options.cupid.proxy_endpoint)
112	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	                headers_to_sign[k] = ""
67	        date_str = headers.get("Date")
68	        if not date_str:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
124	            # use legacy v2 sign
125	            signature = base64.b64encode(
126	                hmac.new(
127	                    utils.to_binary(self.secret_access_key),
128	                    utils.to_binary(canonical_str),
129	                    hashlib.sha1,
130	                ).digest()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:125
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
124	            # use legacy v2 sign
125	            signature = base64.b64encode(
126	                hmac.new(
127	                    utils.to_binary(self.secret_access_key),
128	                    utils.to_binary(canonical_str),
129	                    hashlib.sha1,
130	                ).digest()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
139	            sign_key = self._get_v4_signature_key(date_str, region_name)
140	            signature = base64.b64encode(
141	                hmac.new(
142	                    sign_key, utils.to_binary(canonical_str), hashlib.sha1
143	                ).digest()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:140
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
139	            sign_key = self._get_v4_signature_key(date_str, region_name)
140	            signature = base64.b64encode(
141	                hmac.new(
142	                    sign_key, utils.to_binary(canonical_str), hashlib.sha1
143	                ).digest()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
168	        auth_str = req.headers["Authorization"]
169	        signature = base64.b64encode(
170	            hmac.new(
171	                utils.to_binary(self.secret_access_key),
172	                utils.to_binary(auth_str),
173	                hashlib.sha1,
174	            ).digest()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:169
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
168	        auth_str = req.headers["Authorization"]
169	        signature = base64.b64encode(
170	            hmac.new(
171	                utils.to_binary(self.secret_access_key),
172	                utils.to_binary(auth_str),
173	                hashlib.sha1,
174	            ).digest()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
189	            self.end_headers()
190	            self.wfile.write(b"PyODPS Account Server")
191	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	        def _do_POST(self):
201	            ctype, pdict = cgi.parse_header(self.headers.get("content-type"))
202	            if ctype == "multipart/form-data":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	            elif ctype == "application/x-www-form-urlencoded":
205	                length = int(self.headers.get("content-length"))
206	                postvars = six.moves.urllib.parse.parse_qs(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
206	                postvars = six.moves.urllib.parse.parse_qs(
207	                    self.rfile.read(length), keep_blank_values=1
208	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	            if self.server._token is not None:
218	                auth = self.headers.get("Authorization")
219	                if not auth:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
249	            self.end_headers()
250	            self.wfile.write(utils.to_binary(auth_str))
251	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
295	
296	        thread = threading.Thread(target=starter)
297	        thread.daemon = True

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
352	            sign_content["region_name"] = region_name
353	        resp = self.session.request(
354	            "post",
355	            "http://%s:%s" % self.sign_endpoint,
356	            headers=headers,
357	            data=sign_content,
358	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
354	            "post",
355	            "http://%s:%s" % self.sign_endpoint,
356	            headers=headers,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
440	        self.reload()
441	        super(StsAccount, self).sign_request(req, endpoint, region_name=region_name)
442	        if self.sts_token:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
467	                self.sts_token = token_json["securityToken"]
468	                ts = self._resolve_expiration(token_json.get("expiration"))
469	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
510	            with open(token_file_name, "r") as token_file:
511	                return token_file.read().strip()
512	        else:  # pragma: no cover

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
527	        try:
528	            resolved_token_parts = base64.b64decode(token).decode().split(",")
529	            return int(resolved_token_parts[2])

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:528
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
527	        try:
528	            resolved_token_parts = base64.b64decode(token).decode().split(",")
529	            return int(resolved_token_parts[2])

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/accounts.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
562	        utils.call_with_retry(self._refresh_credential)
563	        return super(CredentialProviderAccount, self).sign_request(
564	            req, endpoint, region_name=region_name
565	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/apis/storage_api/storage_api.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
694	
695	        res = self.tunnel_rest.post(url, data=json_str, params=params, headers=headers)
696	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/apis/storage_api/storage_api.py:728
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
727	
728	        res = self.tunnel_rest.get(url, params=params, headers=headers)
729	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/apis/storage_api/storage_api.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
774	        def download():
775	            return self.tunnel_rest.get(
776	                url, stream=True, params=params, headers=headers
777	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/apis/storage_api/storage_api.py:807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
806	
807	        res = self.tunnel_rest.post(url, data=json_str, params=params, headers=headers)
808	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/apis/storage_api/storage_api.py:836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
835	
836	        res = self.tunnel_rest.get(url, params=params, headers=headers)
837	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/apis/storage_api/storage_api.py:876
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
875	        def upload(data):
876	            return self.tunnel_rest.post(url, data=data, params=params, headers=headers)
877	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/apis/storage_api/storage_api.py:908
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
907	
908	        res = self.tunnel_rest.post(url, data=json_str, params=params, headers=headers)
909	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
161	
162	    current_os = platform.system()
163	    tuple_xy = None

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
161	
162	    current_os = platform.system()
163	    tuple_xy = None

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:162
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
161	
162	    current_os = platform.system()
163	    tuple_xy = None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
450	    try:
451	        thread_name = threading.current_thread().name
452	    except AttributeError:  # pragma: no cover

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
452	    except AttributeError:  # pragma: no cover
453	        thread_name = threading.current_thread().getName()
454	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
595	    try:
596	        write(s)
597	        return write

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
611	    try:
612	        write(s)
613	        return write

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:620
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
619	    # If this doesn't work let the exception bubble up; I'm out of ideas
620	    write(s)
621	    return write

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
679	
680	        write(end)
681	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
688	                msg = _decode_preferred_encoding(msg)
689	            write(msg)
690	        write(end)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
689	            write(msg)
690	        write(end)
691	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
883	            if self._should_handle_resize:
884	                signal.signal(signal.SIGWINCH, self._handle_resize)
885	                self._signal_set = True

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:884
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
883	            if self._should_handle_resize:
884	                signal.signal(signal.SIGWINCH, self._handle_resize)
885	                self._signal_set = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
899	                self.update(self._total)
900	            self._file.write("\n")
901	            self._file.flush()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
902	            if self._signal_set:
903	                signal.signal(signal.SIGWINCH, signal.SIG_DFL)
904	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:903
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
902	            if self._signal_set:
903	                signal.signal(signal.SIGWINCH, signal.SIG_DFL)
904	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:961
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
960	            bar_fill = int(float(self._bar_length) * frac)
961	        write("\r|")
962	        color_print("=" * bar_fill, "blue", file=file, end="")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
964	            color_print(">", "green", file=file, end="")
965	            write("-" * (self._bar_length - bar_fill - 1))
966	        write("|")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:966
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
965	            write("-" * (self._bar_length - bar_fill - 1))
966	        write("|")
967	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
976	            prefix = " ETA "
977	        write(" {0:>4s}/{1:>4s}".format(human_file_size(value), self._human_total))
978	        write(" ({0:>6s}%)".format("{0:.2f}".format(frac * 100.0)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:978
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
977	        write(" {0:>4s}/{1:>4s}".format(human_file_size(value), self._human_total))
978	        write(" ({0:>6s}%)".format("{0:.2f}".format(frac * 100.0)))
979	        write(prefix)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:979
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
978	        write(" ({0:>6s}%)".format("{0:.2f}".format(frac * 100.0)))
979	        write(prefix)
980	        if t is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
980	        if t is not None:
981	            write(human_time(t))
982	        self._file.flush()

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:1055
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
1054	            else:
1055	                p = multiprocessing.Pool()
1056	                for i, result in enumerate(p.imap_unordered(function, items, steps)):

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/console.py:1055
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
1054	            else:
1055	                p = multiprocessing.Pool()
1056	                for i, result in enumerate(p.imap_unordered(function, items, steps)):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/core.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	DEFAULT_ENDPOINT = "http://service.odps.aliyun.com/api"
30	DEFAULT_REGION_NAME = "cn"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/core.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	DEFAULT_REGION_NAME = "cn"
31	LOGVIEW_HOST_DEFAULT = "http://logview.aliyun.com"
32	JOB_INSIGHT_HOST_DEFAULT = "https://maxcompute.console.aliyun.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/core.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	LOGVIEW_HOST_DEFAULT = "http://logview.aliyun.com"
32	JOB_INSIGHT_HOST_DEFAULT = "https://maxcompute.console.aliyun.com"
33	
34	_ALTER_TABLE_REGEX = re.compile(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/core.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
442	        if rewriter:
443	            return rewriter.rewrite()
444	        return expr_dag.root

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	with open(CLOUD_PICKLE_FILE) as f:
40	    CLOUD_PICKLE = f.read()
41	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
43	with open(IMPORT_FILE) as f:
44	    MEM_IMPORT = f.read()
45	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	with open(X_NAMED_TUPLE_FILE) as f:
52	    X_NAMED_TUPLE = f.read()
53	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
613	    func_args_str = to_str(
614	        base64.b64encode(cloudpickle.dumps(node._func_args, dump_code=options.df.dump_udf))
615	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:614
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
613	    func_args_str = to_str(
614	        base64.b64encode(cloudpickle.dumps(node._func_args, dump_code=options.df.dump_udf))
615	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
616	    func_kwargs_str = to_str(
617	        base64.b64encode(cloudpickle.dumps(node._func_kwargs, dump_code=options.df.dump_udf))
618	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:617
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
616	    func_kwargs_str = to_str(
617	        base64.b64encode(cloudpickle.dumps(node._func_kwargs, dump_code=options.df.dump_udf))
618	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
640	        'func_cls_name': func_cls_name,
641	        'func_str': to_str(base64.b64encode(cloudpickle.dumps(func, dump_code=options.df.dump_udf))),
642	        'func_args_str': func_args_str,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:641
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
640	        'func_cls_name': func_cls_name,
641	        'func_str': to_str(base64.b64encode(cloudpickle.dumps(func, dump_code=options.df.dump_udf))),
642	        'func_args_str': func_args_str,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
645	        'resources': to_str(
646	            base64.b64encode(cloudpickle.dumps([r[:3] for r in resources], dump_code=options.df.dump_udf))),
647	        'implementation': CLIENT_IMPL,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:646
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
645	        'resources': to_str(
646	            base64.b64encode(cloudpickle.dumps([r[:3] for r in resources], dump_code=options.df.dump_udf))),
647	        'implementation': CLIENT_IMPL,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
665	    func_args_str = to_str(
666	        base64.b64encode(cloudpickle.dumps(node._func_args, dump_code=options.df.dump_udf)))
667	    func_kwargs_str = to_str(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:666
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
665	    func_args_str = to_str(
666	        base64.b64encode(cloudpickle.dumps(node._func_args, dump_code=options.df.dump_udf)))
667	    func_kwargs_str = to_str(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
667	    func_kwargs_str = to_str(
668	        base64.b64encode(cloudpickle.dumps(node._func_kwargs, dump_code=options.df.dump_udf)))
669	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:668
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
667	    func_kwargs_str = to_str(
668	        base64.b64encode(cloudpickle.dumps(node._func_kwargs, dump_code=options.df.dump_udf)))
669	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
684	        'func_cls_name': func_cls_name,
685	        'func_str': to_str(base64.b64encode(cloudpickle.dumps(func, dump_code=options.df.dump_udf))),
686	        'func_args_str': func_args_str,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:685
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
684	        'func_cls_name': func_cls_name,
685	        'func_str': to_str(base64.b64encode(cloudpickle.dumps(func, dump_code=options.df.dump_udf))),
686	        'func_args_str': func_args_str,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
688	        'close_func_str': to_str(
689	            base64.b64encode(cloudpickle.dumps(getattr(node, '_close_func', None), dump_code=options.df.dump_udf))),
690	        'names_str': names_str,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:689
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
688	        'close_func_str': to_str(
689	            base64.b64encode(cloudpickle.dumps(getattr(node, '_close_func', None), dump_code=options.df.dump_udf))),
690	        'names_str': names_str,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
690	        'names_str': names_str,
691	        'resources': to_str(base64.b64encode(cloudpickle.dumps([r[:3] for r in resources]))),
692	        'implementation': CLIENT_IMPL,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:691
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
690	        'names_str': names_str,
691	        'resources': to_str(base64.b64encode(cloudpickle.dumps([r[:3] for r in resources]))),
692	        'implementation': CLIENT_IMPL,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
709	    func_args_str = to_str(
710	        base64.b64encode(cloudpickle.dumps(node._func_args, dump_code=options.df.dump_udf)))
711	    func_kwargs_str = to_str(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:710
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
709	    func_args_str = to_str(
710	        base64.b64encode(cloudpickle.dumps(node._func_args, dump_code=options.df.dump_udf)))
711	    func_kwargs_str = to_str(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
711	    func_kwargs_str = to_str(
712	        base64.b64encode(cloudpickle.dumps(node._func_kwargs, dump_code=options.df.dump_udf)))
713	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:712
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
711	    func_kwargs_str = to_str(
712	        base64.b64encode(cloudpickle.dumps(node._func_kwargs, dump_code=options.df.dump_udf)))
713	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
728	        'func_cls_name': func_cls_name,
729	        'func_str': to_str(base64.b64encode(cloudpickle.dumps(func, dump_code=options.df.dump_udf))),
730	        'func_args_str': func_args_str,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:729
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
728	        'func_cls_name': func_cls_name,
729	        'func_str': to_str(base64.b64encode(cloudpickle.dumps(func, dump_code=options.df.dump_udf))),
730	        'func_args_str': func_args_str,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
732	        'resources': to_str(
733	            base64.b64encode(cloudpickle.dumps([r[:3] for r in resources], dump_code=options.df.dump_udf))),
734	        'implementation': CLIENT_IMPL,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/codegen.py:733
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
732	        'resources': to_str(
733	            base64.b64encode(cloudpickle.dumps([r[:3] for r in resources], dump_code=options.df.dump_udf))),
734	        'implementation': CLIENT_IMPL,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/compiler.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
610	            buf = six.StringIO()
611	            buf.write('\n')
612	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/compiler.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
618	                if len(f) > 1:
619	                    buf.write(f[0].ljust(max_length))
620	                    buf.write(' AS ')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/compiler.py:620
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
619	                    buf.write(f[0].ljust(max_length))
620	                    buf.write(' AS ')
621	                    buf.write(f[1])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/compiler.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
620	                    buf.write(' AS ')
621	                    buf.write(f[1])
622	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/compiler.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
622	                else:
623	                    buf.write(f[0])
624	                buf.write(',\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/compiler.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
623	                    buf.write(f[0])
624	                buf.write(',\n')
625	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/context.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
144	            tarbinary = BytesIO()
145	            tar = tarfile.open(fileobj=tarbinary, mode='w:gz')
146	            if os.path.isfile(lib):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/context.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
146	            if os.path.isfile(lib):
147	                with open(lib, 'rb') as fo:
148	                    finfo = tarfile.TarInfo('pyodps_files/' + os.path.basename(lib))

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/context.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
156	                        rpath = os.path.relpath(fpath, base_dir).replace(os.path.sep, '/')
157	                        with open(fpath, 'rb') as fo:
158	                            finfo = tarfile.TarInfo(rpath)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/odpssql/tunnel.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
222	            logger.info(
223	                'Try fetching data from tunnel. If it takes a long time, please try running your code '
224	                'with distributed capabilities, see related section in '
225	                'https://www.alibabacloud.com/help/en/maxcompute/use-cases/use-a-pyodps-node-to-download'

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
177	        def _open_file(*args, **kwargs):
178	            handle = open(*args, **kwargs)
179	            self._file_objs.append(handle)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
198	                if lib_name.endswith('.zip') or lib_name.endswith('.egg') or lib_name.endswith('.whl'):
199	                    readers.append(zipfile.ZipFile(lib.open(mode='rb')))
200	                elif lib_name.endswith('.tar') or lib_name.endswith('.tar.gz') or lib_name.endswith('.tar.bz2'):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
204	                        mode = 'r:gz' if lib_name.endswith('.tar.gz') else 'r:bz2'
205	                    readers.append(tarfile.open(fileobj=six.BytesIO(lib.open(mode='rb').read()), mode=mode))
206	                elif lib_name.endswith('.py'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
204	                        mode = 'r:gz' if lib_name.endswith('.tar.gz') else 'r:bz2'
205	                    readers.append(tarfile.open(fileobj=six.BytesIO(lib.open(mode='rb').read()), mode=mode))
206	                elif lib_name.endswith('.py'):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
204	                        mode = 'r:gz' if lib_name.endswith('.tar.gz') else 'r:bz2'
205	                    readers.append(tarfile.open(fileobj=six.BytesIO(lib.open(mode='rb').read()), mode=mode))
206	                elif lib_name.endswith('.py'):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
207	                    tarbinary = six.BytesIO()
208	                    tar = tarfile.open(fileobj=tarbinary, mode='w:gz')
209	                    fbin = lib.open(mode='rb').read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	                    tar = tarfile.open(fileobj=tarbinary, mode='w:gz')
209	                    fbin = lib.open(mode='rb').read()
210	                    info = tarfile.TarInfo(name='pyodps_lib/' + lib_name)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
208	                    tar = tarfile.open(fileobj=tarbinary, mode='w:gz')
209	                    fbin = lib.open(mode='rb').read()
210	                    info = tarfile.TarInfo(name='pyodps_lib/' + lib_name)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
213	                    tar.close()
214	                    readers.append(tarfile.open(fileobj=six.BytesIO(tarbinary.getvalue()), mode='r:gz'))
215	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
224	        expr_dag = self._convert_table(expr_dag)
225	        self._rewrite(expr_dag)
226	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/backends/pd/engine.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
267	        expr_dag = self._convert_table(expr_dag)
268	        self._rewrite(expr_dag)
269	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/expr/collections.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
428	        raise ValueError(
429	            'Apply on rows to provide multiple values should provide all column names, '
430	            'for instance, df.apply(func, axis=1, names=["A", "B"], types=["float", "float"]). '
431	            'See https://pyodps.readthedocs.io/zh_CN/latest/df-sort-distinct-apply.html#dfudtfapp '

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/tools/libtools.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	        local = {}
52	        six.exec_(hll_file.read(), local)
53	        HyperLogLog = local['HyperLogLog']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/df/tools/libtools.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
87	        local = {}
88	        six.exec_(bloomfilter_file.read(), local)
89	        BloomFilter = local['BloomFilter']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/errors.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	        except ETParseError:
55	            request_id = resp.headers.get("x-odps-request-id", None)
56	            if len(resp.content) > 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/errors.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
58	                msg = obj["Message"]
59	                code = obj.get("Code")
60	                host_id = obj.get("HostId")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/errors.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	                code = obj.get("Code")
60	                host_id = obj.get("HostId")
61	                if request_id is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/errors.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	                if request_id is None:
62	                    request_id = obj.get("RequestId")
63	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/errors.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	                raise
65	        clz = globals().get(code, ODPSError)
66	        return clz(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/errors.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	
143	        clz = globals().get(code, ODPSError)
144	        return clz(msg, request_id=request_id, code=code, host_id=host_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/errors.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
153	        if msg_code in _CODE_MAPPING:
154	            cls = globals().get(_CODE_MAPPING[msg_code], ODPSError)
155	        elif len(msg_code) > 8 and msg_code[:8] in _SQA_CODE_MAPPING:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/errors.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	            # return the outer error type instead of the inner one.
158	            cls = globals().get(_SQA_CODE_MAPPING[msg_code[:8]], ODPSError)
159	            return cls(msg, code=msg_code)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/errors.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
366	        super(SchemaModified, self).__init__(*args, **kw)
367	        response_headers = kw.get("response_headers") or dict()
368	        self.latest_schema_version = response_headers.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/errors.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
367	        response_headers = kw.get("response_headers") or dict()
368	        self.latest_schema_version = response_headers.get(
369	            "odps-tunnel-latest-schema-version"
370	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
83	        [rec.set(i, val) for i, val in enumerate(cols)]
84	        writer.write(rec)
85	    writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
121	        [rec.set(i, val) for i, val in enumerate(cols)]
122	        writers[part_id].write(rec)
123	    [writer.close() for writer in writers]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
167	        [rec.set(i, val) for i, val in enumerate(cols)]
168	        writers[id1][id2].write(rec)
169	    [writer.close() for ws in writers for writer in ws]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
194	        [rec.set(i, val) for i, val in enumerate(cols)]
195	        writer.write(rec)
196	    writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
217	        rec.set(1, 0 if "setosa" in line_parts[-1] else 1)
218	        writer.write(rec)
219	    writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
238	        [rec.set(i, val) for i, val in enumerate(cols)]
239	        writer.write(rec)
240	    writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
265	            [rec.set(i, val) for i, val in enumerate(cols)]
266	            writer.write(rec)
267	    writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
289	            [rec.set(i, val) for i, val in enumerate(cols)]
290	            writer.write(rec)
291	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
297	                [rec.set(i, val) for i, val in enumerate(cols)]
298	                writer.write(rec)
299	    writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
335	        [rec.set(i, val) for i, val in enumerate(rd)]
336	        writer.write(rec)
337	    writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
368	        [rec.set(i, val) for i, val in enumerate(rd)]
369	        writer.write(rec)
370	    writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
400	        [rec.set(i, val) for i, val in enumerate(rd)]
401	        writer.write(rec)
402	    writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
544	        [rec.set(i, val) for i, val in enumerate(rd)]
545	        writer.write(rec)
546	    writer.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
579	
580	NEWSGROUP_URL = "http://repo.aliyun.com/shared_data/20news-bydate.tar.gz"
581	NEWSGROUP_DATA_NAME = "20news-bydate"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
596	def cache_newsgroup_tar(target_tar, target_dir, cache_dir):
597	    tarfile.open(target_tar, "r:gz").extractall(path=target_dir)
598	    os.unlink(target_tar)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
615	                file_id = os.path.basename(os.path.normpath(sfn))
616	                with open(sfn, "rb") as f:
617	                    objs.append((file_id, file_cat, f.read().decode(encoding)))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
616	                with open(sfn, "rb") as f:
617	                    objs.append((file_id, file_cat, f.read().decode(encoding)))
618	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
626	    compressed_content = codecs.encode(pickle.dumps(cache), "zlib_codec")
627	    with open(cache_path, "wb") as f:
628	        f.write(compressed_content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
627	    with open(cache_path, "wb") as f:
628	        f.write(compressed_content)
629	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
629	
630	    shutil.rmtree(target_dir)
631	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
645	
646	    with open(cache_file, "rb") as f:
647	        cache = pickle.loads(codecs.decode(f.read(), "zlib_codec"))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:647
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
646	    with open(cache_file, "rb") as f:
647	        cache = pickle.loads(codecs.decode(f.read(), "zlib_codec"))
648	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
662	        [rec.set(i, six.text_type(val)) for i, val in enumerate(line)]
663	        writer.write(rec)
664	    writer.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
671	
672	MNIST_PICKLED_URL = "http://repo.aliyun.com/shared_data/mnist.pkl.gz"
673	MNIST_FILE = "mnist.pkl.gz"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
689	
690	    with gzip.open(mnist_file, "rb") as fobj:
691	        mnist_unpickled = pickle.load(fobj)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/examples/tables.py:714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
713	        rec.set(1, six.text_type(label))
714	        writer.write(rec)
715	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/expressions/core.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	            inst_cls = cls._get_expr_class(content)
69	            obj = inst_cls(_parent=kw.get("_parent"))
70	            content = next(iter(content.values()))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/expressions/core.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	            default_str = "`%s`" % self.reference.name
164	            return ref_to_str.get(self.reference.name, default_str)
165	        else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/inter.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
154	        if os.path.exists(path):
155	            shutil.rmtree(path)
156	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/inter.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
255	    with open(os.path.join(room_dir, INFO_FILE_NAME), "wb") as f:
256	        f.write(to_binary(room))
257	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/inter.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
265	    if os.path.exists(room_dir):
266	        shutil.rmtree(room_dir)
267	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/inter.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
276	            with open(info_path) as f:
277	                results.append(f.read())
278	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
93	    """Write a log message to the log file.  See initlog() for docs."""
94	    logfp.write(fmt%args + "\n")
95	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
93	    """Write a log message to the log file.  See initlog() for docs."""
94	    logfp.write(fmt%args + "\n")
95	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
160	                raise ValueError('Maximum content length exceeded')
161	            qs = fp.read(clength).decode(encoding)
162	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
476	            self.file.seek(0)
477	            value = self.file.read()
478	            self.file.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
554	        """Internal: read data in query string format."""
555	        qs = self.fp.read(self.length)
556	        if not isinstance(qs, bytes):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
656	            while todo > 0:
657	                data = self.fp.read(min(todo, self.bufsize)) # bytes
658	                if not isinstance(data, bytes):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
664	                    break
665	                self.file.write(data)
666	                todo = todo - len(data)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
664	                    break
665	                self.file.write(data)
666	                todo = todo - len(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
684	                data = self.__file.getvalue()
685	                self.file.write(data)
686	                self.__file = None

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
684	                data = self.__file.getvalue()
685	                self.file.write(data)
686	                self.__file = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
688	            # keep bytes
689	            self.file.write(line)
690	        else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
688	            # keep bytes
689	            self.file.write(line)
690	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
691	            # decode to string
692	            self.file.write(line.decode(self.encoding, self.errors))
693	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
691	            # decode to string
692	            self.file.write(line.decode(self.encoding, self.errors))
693	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
701	                break
702	            self.__write(line)
703	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
701	                break
702	            self.__write(line)
703	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
751	                last_line_lfend = False
752	            self.__write(odelim + line)
753	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
751	                last_line_lfend = False
752	            self.__write(odelim + line)
753	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/cgi_compat.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
820	        def f():
821	            exec("testing print_exception() -- <I>italics?</I>")
822	        def g(f=f):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/futures/process.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
302	        if self._queue_management_thread is None:
303	            self._queue_management_thread = threading.Thread(
304	                    target=_queue_management_worker,
305	                    args=(weakref.ref(self, weakref_cb),
306	                          self._processes,
307	                          self._pending_work_items,
308	                          self._work_ids,
309	                          self._call_queue,
310	                          self._result_queue))
311	            self._queue_management_thread.daemon = True

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/futures/process.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
316	        for _ in range(len(self._processes), self._max_workers):
317	            p = multiprocessing.Process(
318	                    target=_process_worker,
319	                    args=(self._call_queue,
320	                          self._result_queue))
321	            p.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/futures/process.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
337	
338	            self._start_queue_management_thread()
339	            self._adjust_process_count()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/importer.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
56	        import shutil
57	        shutil.rmtree(CompressImporter._extract_path, ignore_errors=True)
58	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/importer.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
336	        if isinstance(fileobj, zipfile.ZipFile):
337	            source = fileobj.read(relpath.replace(os.sep, '/'))
338	        elif isinstance(fileobj, tarfile.TarFile):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/importer.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
338	        elif isinstance(fileobj, tarfile.TarFile):
339	            source = fileobj.extractfile(relpath.replace(os.sep, '/')).read()
340	        elif isinstance(fileobj, dict):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/importer.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
340	        elif isinstance(fileobj, dict):
341	            source = fileobj[relpath.replace(os.sep, '/')].read()
342	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/importer.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
342	        else:
343	            source = open(fileobj[relpath.replace(os.sep, '/')], 'rb').read()
344	        source = source.replace(b'\r\n', b'\n').replace(b'\r', b'\n')

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/importer.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
342	        else:
343	            source = open(fileobj[relpath.replace(os.sep, '/')], 'rb').read()
344	        source = source.replace(b'\r\n', b'\n').replace(b'\r', b'\n')

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/importer.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
390	                mod.__path__ = [os.path.dirname(mod.__file__)]
391	            exec(code, mod.__dict__)
392	        except:

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/monotonic.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
59	            #  <https://developer.apple.com/library/mac/qa/qa1398/>
60	            libc = ctypes.CDLL('/usr/lib/libc.dylib', use_errno=True)
61	

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/monotonic.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
135	            try:
136	                clock_gettime = ctypes.CDLL(ctypes.util.find_library('c'),
137	                                            use_errno=True).clock_gettime
138	            except Exception:

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/monotonic.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
138	            except Exception:
139	                clock_gettime = ctypes.CDLL(ctypes.util.find_library('rt'),
140	                                            use_errno=True).clock_gettime
141	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/six.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
734	            _locs_ = _globs_
735	        exec("""exec _code_ in _globs_, _locs_""")
736	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/tblib/__init__.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
224	            try:
225	                exec(
226	                    code,
227	                    dict(current.tb_frame.f_globals),
228	                    dict(current.tb_frame.f_locals),
229	                )  # noqa: S102

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/lib/tzlocal/unix.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	            with open(tzpath, 'rb') as tzfile:
108	                data = tzfile.read()
109	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/core.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
527	            arrow_rb = pa.RecordBatch.from_pandas(df)
528	            writer.write(arrow_rb)
529	            writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/core.py:680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
679	        arrow_writer.close()
680	        cupid_writer.write(sink.getvalue())
681	    block_writer.commit()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/dataframe/datasource.py:912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
911	        ) as reader:
912	            table = reader.read()
913	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/dataframe/datastore.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
424	            arrow_writer.close()
425	            cupid_writer.write(sink.getvalue())
426	        logger.debug("Write table block finished, block id: %s", op.block_id)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/dataframe/datastore.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
465	        arrow_rb = pa.RecordBatch.from_pandas(ctx[op.inputs[0].key])
466	        writer.write(arrow_rb)
467	        writer.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/app.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	        with open("pod_%s.json" % self.rc_name, "w") as pod_file:
99	            pod_file.write(json.dumps(result, indent=2, sort_keys=True))
100	        return result

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/app.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
206	            self.get_local_app_module("gscoordinator"),
207	            base64.b64encode(json.dumps(coordinator_args).encode()).decode(),
208	        ]

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/app.py:207
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
206	            self.get_local_app_module("gscoordinator"),
207	            base64.b64encode(json.dumps(coordinator_args).encode()).decode(),
208	        ]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/app.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
393	
394	        args_dict = json.loads(base64.b64decode(self.args.encoded_args).decode())
395	        args_dict["namespace"] = self._instance_id

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/app.py:394
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
393	
394	        args_dict = json.loads(base64.b64decode(self.args.encoded_args).decode())
395	        args_dict["namespace"] = self._instance_id

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/client.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
178	                    __name__.rsplit(".", 1)[0] + ".app",
179	                    base64.b64encode(json.dumps(cluster_args).encode()).decode(),
180	                )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/client.py:179
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
178	                    __name__.rsplit(".", 1)[0] + ".app",
179	                    base64.b64encode(json.dumps(cluster_args).encode()).decode(),
180	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/client.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
207	        try:
208	            resp = self._req_session.get(self._endpoint + "/api", timeout=timeout)
209	        except (requests.ConnectionError, requests.Timeout, errors.ODPSError):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/client.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	    def count_workers(self):
219	        resp = self._req_session.get(
220	            self._endpoint + "/api/worker?action=count", timeout=1
221	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/client.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
273	    def _post_pyodps_api(self, **data):
274	        r = self._req_session.post(
275	            self._endpoint.rstrip("/") + "/api/pyodps", data=data
276	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/core.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	        with open(self._channel_file[idx], "w") as env_file:
121	            env_file.write(json.dumps(envs_dict))
122	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/core.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
120	        with open(self._channel_file[idx], "w") as env_file:
121	            env_file.write(json.dumps(envs_dict))
122	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/core.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
151	
152	        shutil.rmtree(self._env_path)
153	        if self._cupid_context is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/core.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	            with open(self._channel_file[idx], "r") as env_file:
182	                envs = json.loads(env_file.read())
183	        except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/core.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
185	            with open(self._channel_file[idx], "r") as env_file:
186	                envs = json.loads(env_file.read())
187	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/core.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
217	        if os.environ.get("VM_ENGINE_TYPE") == "hyper":
218	            args.advertise = socket.gethostbyname(socket.gethostname())
219	        return args

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/core.py:218
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
217	        if os.environ.get("VM_ENGINE_TYPE") == "hyper":
218	            args.advertise = socket.gethostbyname(socket.gethostname())
219	        return args

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/gscoordinator.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
77	    argv = sys.argv[1]
78	    args_dict = json.loads(base64.b64decode(argv).decode())
79	    print("launch graphscope:", args_dict)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/gscoordinator.py:78
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
77	    argv = sys.argv[1]
78	    args_dict = json.loads(base64.b64decode(argv).decode())
79	    print("launch graphscope:", args_dict)

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/gscoordinator.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
83	    cupid_context = context()
84	    host_addr = socket.gethostbyname(socket.gethostname())
85	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/gscoordinator.py:84
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
83	    cupid_context = context()
84	    host_addr = socket.gethostbyname(socket.gethostname())
85	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/gscoordinator.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	
93	    endpoint = "http://{0}:{1}".format(host_addr, coordinator_gateway_port)
94	    kvstore = cupid_context.kv_store()

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/gscoordinator.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
103	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
104	        endpoint = socket.gethostname() + "-{}".format(coordinator_port)
105	    cupid_context.register_application(GS_COORDINATOR_NAME, endpoint)

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/gscoordinator.py:104
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
103	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
104	        endpoint = socket.gethostname() + "-{}".format(coordinator_port)
105	    cupid_context.register_application(GS_COORDINATOR_NAME, endpoint)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
43	            "--ip",
44	            "0.0.0.0",
45	            "--no-browser",
46	            "--allow-root",
47	            "--port",
48	            str(port),
49	            "--NotebookApp.token=",
50	            "--NotebookApp.password=",
51	            "--NotebookApp.disable_check_xsrf=True",
52	            "--ServerApp.token=",
53	            "--ServerApp.password=",
54	            "--ServerApp.disable_check_xsrf=True",
55	        ]
56	    )
57	    while True:
58	        if proc.poll() is not None:
59	            raise SystemError("Notebook not started.")
60	        try:
61	            resp = requests.get("http://localhost:{}".format(port))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	        try:
61	            resp = requests.get("http://localhost:{}".format(port))
62	            if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        try:
61	            resp = requests.get("http://localhost:{}".format(port))
62	            if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	    while True:
72	        json_val = to_str(kvstore.get(name))
73	        if json_val:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
81	    with open(path, "w") as f:
82	        f.write(endpoint)
83	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	        with open(path, "w") as f:
93	            f.write(token)
94	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
133	    with open(f_path, "w") as f:
134	        f.write(start_code)
135	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
157	    mars_endpoint = wait_mars_ready(cupid_context.kv_store(), CUPID_APP_NAME)
158	    host_addr = socket.gethostbyname(socket.gethostname())
159	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:158
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
157	    mars_endpoint = wait_mars_ready(cupid_context.kv_store(), CUPID_APP_NAME)
158	    host_addr = socket.gethostbyname(socket.gethostname())
159	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	
162	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
163	        notebook_port = DEFAULT_NOTEBOOK_PORT

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	
167	    endpoint = "http://{0}:{1}".format(host_addr, notebook_port)
168	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	    # modify in hyper mode
179	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
180	        endpoint = socket.gethostname() + "-{}".format(notebook_port)

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
179	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
180	        endpoint = socket.gethostname() + "-{}".format(notebook_port)
181	    cupid_context.register_application(NOTEBOOK_NAME, endpoint)

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/notebook.py:180
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
179	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
180	        endpoint = socket.gethostname() + "-{}".format(notebook_port)
181	    cupid_context.register_application(NOTEBOOK_NAME, endpoint)

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/web.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
57	
58	        host_addr = socket.gethostbyname(socket.gethostname())
59	        internal_endpoint = "http://{0}:{1}".format(host_addr, self.mars_web.port)

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/web.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
57	
58	        host_addr = socket.gethostbyname(socket.gethostname())
59	        internal_endpoint = "http://{0}:{1}".format(host_addr, self.mars_web.port)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/web.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	        host_addr = socket.gethostbyname(socket.gethostname())
59	        internal_endpoint = "http://{0}:{1}".format(host_addr, self.mars_web.port)
60	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/web.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
61	        if os.environ.get("VM_ENGINE_TYPE") == "hyper":
62	            app_endpoint = socket.gethostname() + "-{}".format(self.mars_web.port)
63	        else:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/web.py:62
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
61	        if os.environ.get("VM_ENGINE_TYPE") == "hyper":
62	            app_endpoint = socket.gethostname() + "-{}".format(self.mars_web.port)
63	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/deploy/web.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	
66	        app_register_thread = threading.Thread(
67	            target=self._app_register_thread,
68	            args=(internal_endpoint, app_endpoint),
69	            daemon=True,
70	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	        with self._volume_parted.open_reader(META_FILE_NAME) as meta_reader:
72	            content = to_str(meta_reader.read())
73	            meta = OrderedDict()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	            for size in meta.values():
90	                f.write(b"\0" * size)
91	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
89	            for size in meta.values():
90	                f.write(b"\0" * size)
91	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
106	                ).open() as reader:
107	                    content_part = reader.read()
108	                    m[start:end] = content_part

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
126	                )
127	            return self._reader.read(size=size)
128	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
130	                self._read_multi_volume_files()
131	            return self._reader.read(size)
132	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
142	        content_part = buffer.getvalue()
143	        self._writer.write(filename, content_part)
144	        self._meta[filename] = buffer.tell()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
142	        content_part = buffer.getvalue()
143	        self._writer.write(filename, content_part)
144	        self._meta[filename] = buffer.tell()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
156	            content = content[buffer_left_size:]
157	            self._write_buffer.write(content_part)
158	            content_left -= len(content_part)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
156	            content = content[buffer_left_size:]
157	            self._write_buffer.write(content_part)
158	            content_left -= len(content_part)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
173	                # write meta file if file length > 1
174	                self._writer.write(META_FILE_NAME, to_binary(meta_content))
175	            self._writer.__exit__(None, None, None)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/filesystem.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
173	                # write meta file if file length > 1
174	                self._writer.write(META_FILE_NAME, to_binary(meta_content))
175	            self._writer.__exit__(None, None, None)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/io/oss.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	    def read(self, amt=None):
51	        buf = self._reader.read(amt)
52	        self._pos += len(buf)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/oss.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	    with fs_open(path, "wb", **oss_opts) as out_file:
142	        out_file.write(shapes_string)
143	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/oss.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	    with fs_open(path, "rb", **oss_opts) as file:
147	        shape_string = to_str(file.read())
148	    return tuple(int(i) for i in shape_string.split(","))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/run_script.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	            with os.fdopen(fd, "wb") as f:
115	                f.write(op.code)
116	            logger.debug("Write code to temp file.")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/run_script.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
114	            with os.fdopen(fd, "wb") as f:
115	                f.write(op.code)
116	            logger.debug("Write code to temp file.")

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/run_script.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
136	            try:
137	                exec(op.code, local)
138	            finally:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/run_script.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
203	    if hasattr(script, "read"):
204	        code = script.read()
205	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/legacy/run_script.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
206	        with open(os.path.abspath(script), "rb") as f:
207	            code = f.read()
208	    if mode not in ["exec", "spawn"]:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
67	        sock_out_file = sock.makefile("wb")
68	        sock_out_file.write(struct.pack("<I", len(pickled)))
69	        sock_out_file.write(pickled)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        sock_out_file.write(struct.pack("<I", len(pickled)))
69	        sock_out_file.write(pickled)
70	    finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
71	        sock_out_file.flush()
72	        sock_out_file.close()
73	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
81	    try:
82	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
83	        read_config = pickle.loads(sock.recv(cmd_len))

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
82	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
83	        read_config = pickle.loads(sock.recv(cmd_len))
84	        min_rows = read_config.pop("min_rows", None)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
92	            while True:
93	                chunk = reader.read(TRANSFER_BLOCK_SIZE)
94	                if len(chunk) == 0:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	                try:
97	                    sock_out_file.write(chunk)
98	                except (BrokenPipeError, SubprocessStreamEOFError):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
116	            if ipc_writer is not None:  # pragma: no branch
117	                ipc_writer.close()
118	                ipc_writer = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
122	        if ipc_writer is not None:
123	            ipc_writer.close()
124	        sock_out_file.flush()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
124	        sock_out_file.flush()
125	        sock_out_file.close()
126	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
134	
135	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
136	        writer_config = pickle.loads(sock.recv(cmd_len))

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
135	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
136	        writer_config = pickle.loads(sock.recv(cmd_len))
137	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
150	                    break
151	            arrow_writer.close()
152	        logger.debug(

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
164	    try:
165	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
166	        # dict with odps_params, table_name, partition

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
166	        # dict with odps_params, table_name, partition
167	        task_config = pickle.loads(sock.recv(cmd_len))
168	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
204	    try:
205	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
206	        # dict with odps_params, table_name, partition, columns, worker_count, split_size, max_chunk_num

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
206	        # dict with odps_params, table_name, partition, columns, worker_count, split_size, max_chunk_num
207	        session_config = pickle.loads(sock.recv(cmd_len))
208	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
293	    try:
294	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
295	        # dict with odps_params, table_name

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
295	        # dict with odps_params, table_name
296	        session_config = pickle.loads(sock.recv(cmd_len))
297	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
332	    try:
333	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
334	        # dict with odps_params, table_name, cupid_handle, blocks, overwrite

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
334	        # dict with odps_params, table_name, cupid_handle, blocks, overwrite
335	        commit_config = pickle.loads(sock.recv(cmd_len))
336	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
374	    try:
375	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
376	        # dict with key

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
376	        # dict with key
377	        cmd_body = pickle.loads(sock.recv(cmd_len))
378	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
400	    try:
401	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
402	        # dict with key

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
402	        # dict with key
403	        cmd_body = pickle.loads(sock.recv(cmd_len))
404	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
426	    try:
427	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
428	        # dict with key

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
428	        # dict with key
429	        cmd_body = pickle.loads(sock.recv(cmd_len))
430	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
449	    try:
450	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
451	        # dict with odps_params, table_name, cupid_handle, blocks, overwrite

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
451	        # dict with odps_params, table_name, cupid_handle, blocks, overwrite
452	        _commit_config = pickle.loads(sock.recv(cmd_len))  # noqa: F841
453	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
464	    try:
465	        (cmd_len,) = struct.unpack("<I", sock.recv(4))
466	        # dict with odps_params, table_name, cupid_handle, blocks, overwrite

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
466	        # dict with odps_params, table_name, cupid_handle, blocks, overwrite
467	        cmd_body = pickle.loads(sock.recv(cmd_len))
468	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
499	        try:
500	            (req_type,) = struct.unpack("<I", sock.recv(4))
501	            if req_type in _request_handlers:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
503	            else:
504	                sock.close()
505	                break

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
514	        with open(channel_file, "r") as env_file:
515	            envs = json.loads(env_file.read())
516	    except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
518	        with open(channel_file, "r") as env_file:
519	            envs = json.loads(env_file.read())
520	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
535	
536	    pool = ThreadPoolExecutor(pool_size)
537	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:540
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
539	    logger.warning("Starting Cupid Service with socket %s", sock_file)
540	    sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
541	    sock.bind(sock_file)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
554	    def __del__(self):
555	        self.close()
556	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
558	        if self._sock is not None:
559	            self._sock.close()
560	            self._sock = None

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:567
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
566	                raise OSError("Socket file does not exist")
567	            self._sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
568	            self._sock.connect(self._sock_file)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
567	            self._sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
568	            self._sock.connect(self._sock_file)
569	        return self._sock

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
574	        sock_out_file = self.sock.makefile("wb")
575	        sock_out_file.write(struct.pack("<I", req_type))
576	        sock_out_file.write(struct.pack("<I", len(ser)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
575	        sock_out_file.write(struct.pack("<I", req_type))
576	        sock_out_file.write(struct.pack("<I", len(ser)))
577	        sock_out_file.write(ser)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
576	        sock_out_file.write(struct.pack("<I", len(ser)))
577	        sock_out_file.write(ser)
578	        sock_out_file.flush()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
580	    def _fetch_cupid_service_result(self):
581	        (ret_len,) = struct.unpack("<I", self.sock.recv(4))
582	        ret = pickle.loads(self.sock.recv(ret_len))

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
581	        (ret_len,) = struct.unpack("<I", self.sock.recv(4))
582	        ret = pickle.loads(self.sock.recv(ret_len))
583	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
611	            batches[:] = []
612	            sock_in_file.close()
613	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/cupid_service.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
640	            ]
641	        arrow_writer.close()
642	        sock_out_file.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/dataframe/datasource.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
744	                ) as reader:
745	                    table = reader.read()
746	                break

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/dataframe/datastore.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	        account = BearerTokenAccount(bearer_token)
269	        project = os.environ.get("ODPS_PROJECT_NAME", None)
270	        odps_params = op.odps_params.copy()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/dataframe/datastore.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
272	            odps_params["project"] = project
273	        endpoint = os.environ.get("ODPS_RUNTIME_ENDPOINT") or odps_params["endpoint"]
274	        o = ODPS(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/dataframe/datastore.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
305	
306	        project = os.environ.get("ODPS_PROJECT_NAME", None)
307	        odps_params = op.odps_params.copy()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/dataframe/datastore.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
309	            odps_params["project"] = project
310	        endpoint = os.environ.get("ODPS_RUNTIME_ENDPOINT") or odps_params["endpoint"]
311	        o = ODPS(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/dataframe/datastore.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
360	                arrow_rb = pa.RecordBatch.from_pandas(ctx[op.inputs[0].key])
361	                writer.write(arrow_rb)
362	                writer.close()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/dataframe/datastore.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
466	            odps_params = op.odps_params.copy()
467	            project = os.environ.get("ODPS_PROJECT_NAME", None)
468	            if project:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/app.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	        with open("pod_%s.json" % self.rc_name, "w") as pod_file:
100	            pod_file.write(json.dumps(result, indent=2, sort_keys=True))
101	        return result

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/app.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
197	            self.get_local_app_module("gscoordinator"),
198	            base64.b64encode(json.dumps(coordinator_args).encode()).decode(),
199	        ]

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/app.py:198
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
197	            self.get_local_app_module("gscoordinator"),
198	            base64.b64encode(json.dumps(coordinator_args).encode()).decode(),
199	        ]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/app.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
387	
388	        args_dict = json.loads(base64.b64decode(self.args.encoded_args).decode())
389	        args_dict["namespace"] = self._instance_id

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/app.py:388
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
387	
388	        args_dict = json.loads(base64.b64decode(self.args.encoded_args).decode())
389	        args_dict["namespace"] = self._instance_id

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/client.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
92	            account = self._req_session.account
93	            account.sign_request(request, self._endpoint)
94	        return request

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/client.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
190	                    __name__.rsplit(".", 1)[0] + ".app",
191	                    base64.b64encode(json.dumps(cluster_args).encode()).decode(),
192	                )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/client.py:191
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
190	                    __name__.rsplit(".", 1)[0] + ".app",
191	                    base64.b64encode(json.dumps(cluster_args).encode()).decode(),
192	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/client.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
219	        try:
220	            resp = self._req_session.get(self._endpoint + "/api", timeout=timeout)
221	        except (requests.ConnectionError, requests.Timeout, errors.ODPSError):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/client.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
230	    def count_workers(self):
231	        resp = self._req_session.get(
232	            self._endpoint + "/api/cluster/nodes?role=1", timeout=1
233	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/client.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
286	    def _post_pyodps_api(self, **data):
287	        r = self._req_session.post(
288	            self._endpoint.rstrip("/") + "/api/pyodps", data=data
289	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
113	            cur_pod_info = (
114	                await asyncio.to_thread(
115	                    self._client.read_namespaced_pod,
116	                    os.environ["MARS_K8S_POD_NAME"],
117	                    namespace=self._k8s_namespace,
118	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
133	            try:
134	                pod_kv_data = await asyncio.to_thread(
135	                    self.cupid_client.get_kv, pod_name
136	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
165	        query = (
166	            await asyncio.to_thread(
167	                self._client.list_namespaced_pod,
168	                namespace=self._k8s_namespace,
169	                label_selector=await self._get_label_selector(service_type),
170	                resource_version="0",
171	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
214	                try:
215	                    event = await asyncio.to_thread(next, streamer, StopIteration)
216	                    if event is StopIteration:

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
258	        if os.environ.get("VM_ENGINE_TYPE") == "hyper":
259	            os.environ["MARS_CONTAINER_IP"] = socket.gethostbyname(socket.gethostname())
260	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:259
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
258	        if os.environ.get("VM_ENGINE_TYPE") == "hyper":
259	            os.environ["MARS_CONTAINER_IP"] = socket.gethostbyname(socket.gethostname())
260	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
284	
285	        self._cupid_service_proc = multiprocessing.Process(
286	            target=run_cupid_service, args=(self._channel_file,)
287	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
296	        with open(self._channel_file, "w") as env_file:
297	            env_file.write(json.dumps(envs_dict))
298	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
296	        with open(self._channel_file, "w") as env_file:
297	            env_file.write(json.dumps(envs_dict))
298	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
302	    def stop_cupid_service(self):
303	        shutil.rmtree(self._env_path)
304	        if self._cupid_context is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
314	    async def register_application(self, app_name, internal_endpoint, app_endpoint):
315	        await asyncio.to_thread(
316	            self._register_application, app_name, internal_endpoint, app_endpoint
317	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/core.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
321	        content = json.dumps(dict(endpoint=self.args.endpoint))
322	        await asyncio.to_thread(
323	            cupid_client.put_kv, os.environ["MARS_K8S_POD_NAME"], content
324	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/gscoordinator.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
77	    argv = sys.argv[1]
78	    args_dict = json.loads(base64.b64decode(argv).decode())
79	    print("launch graphscope:", args_dict)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/gscoordinator.py:78
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
77	    argv = sys.argv[1]
78	    args_dict = json.loads(base64.b64decode(argv).decode())
79	    print("launch graphscope:", args_dict)

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/gscoordinator.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
83	    cupid_context = context()
84	    host_addr = socket.gethostbyname(socket.gethostname())
85	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/gscoordinator.py:84
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
83	    cupid_context = context()
84	    host_addr = socket.gethostbyname(socket.gethostname())
85	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/gscoordinator.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	
93	    endpoint = "http://{0}:{1}".format(host_addr, coordinator_gateway_port)
94	    kvstore = cupid_context.kv_store()

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/gscoordinator.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
103	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
104	        endpoint = socket.gethostname() + "-{}".format(coordinator_port)
105	    cupid_context.register_application(GS_COORDINATOR_NAME, endpoint)

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/gscoordinator.py:104
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
103	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
104	        endpoint = socket.gethostname() + "-{}".format(coordinator_port)
105	    cupid_context.register_application(GS_COORDINATOR_NAME, endpoint)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
43	            "--ip",
44	            "0.0.0.0",
45	            "--no-browser",
46	            "--allow-root",
47	            "--port",
48	            str(port),
49	            "--NotebookApp.token=",
50	            "--NotebookApp.password=",
51	            "--NotebookApp.disable_check_xsrf=True",
52	            "--ServerApp.token=",
53	            "--ServerApp.password=",
54	            "--ServerApp.disable_check_xsrf=True",
55	        ]
56	    )
57	    while True:
58	        if proc.poll() is not None:
59	            raise SystemError("Notebook not started.")
60	        try:
61	            resp = requests.get("http://localhost:{}".format(port))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	        try:
61	            resp = requests.get("http://localhost:{}".format(port))
62	            if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        try:
61	            resp = requests.get("http://localhost:{}".format(port))
62	            if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	    while True:
72	        json_val = to_str(kvstore.get(name))
73	        if json_val:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
81	    with open(path, "w") as f:
82	        f.write(endpoint)
83	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	        with open(path, "w") as f:
93	            f.write(token)
94	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
135	    with open(f_path, "w") as f:
136	        f.write(start_code)
137	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
161	    mars_endpoint = wait_mars_ready(cupid_context.kv_store(), CUPID_APP_NAME)
162	    host_addr = socket.gethostbyname(socket.gethostname())
163	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:162
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
161	    mars_endpoint = wait_mars_ready(cupid_context.kv_store(), CUPID_APP_NAME)
162	    host_addr = socket.gethostbyname(socket.gethostname())
163	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	
166	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
167	        notebook_port = DEFAULT_NOTEBOOK_PORT

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	
171	    endpoint = "http://{0}:{1}".format(host_addr, notebook_port)
172	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	    # modify in hyper mode
183	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
184	        endpoint = socket.gethostname() + "-{}".format(notebook_port)

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
183	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
184	        endpoint = socket.gethostname() + "-{}".format(notebook_port)
185	    cupid_context.register_application(NOTEBOOK_NAME, endpoint)

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/notebook.py:184
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
183	    if os.environ.get("VM_ENGINE_TYPE") == "hyper":
184	        endpoint = socket.gethostname() + "-{}".format(notebook_port)
185	    cupid_context.register_application(NOTEBOOK_NAME, endpoint)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/supervisor.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
85	                    )
86	                    await asyncio.to_thread(self._sync_stop_instance, cupid_client)
87	                else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/supervisor.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
88	                    # make sure elapsed time is persisted
89	                    await asyncio.to_thread(
90	                        cupid_client.put_kv,
91	                        CUPID_LAST_IDLE_TIME_KEY,
92	                        str(last_idle_time),
93	                    )

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/supervisor.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
148	
149	        host_addr = socket.gethostbyname(socket.gethostname())
150	        internal_endpoint = "http://{0}:{1}".format(host_addr, web_port)

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/supervisor.py:149
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
148	
149	        host_addr = socket.gethostbyname(socket.gethostname())
150	        internal_endpoint = "http://{0}:{1}".format(host_addr, web_port)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/supervisor.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	        host_addr = socket.gethostbyname(socket.gethostname())
150	        internal_endpoint = "http://{0}:{1}".format(host_addr, web_port)
151	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/supervisor.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
152	        if os.environ.get("VM_ENGINE_TYPE") == "hyper":
153	            app_endpoint = socket.gethostname() + "-{}".format(web_port)
154	        else:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/deploy/supervisor.py:153
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
152	        if os.environ.get("VM_ENGINE_TYPE") == "hyper":
153	            app_endpoint = socket.gethostname() + "-{}".format(web_port)
154	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	        with self._volume_parted.open_reader(META_FILE_NAME) as meta_reader:
68	            content = to_str(meta_reader.read())
69	            meta = OrderedDict()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	            for size in meta.values():
86	                f.write(b"\0" * size)
87	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
85	            for size in meta.values():
86	                f.write(b"\0" * size)
87	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	                ).open() as reader:
103	                    content_part = reader.read()
104	                    m[start:end] = content_part

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
122	                )
123	            return self._reader.read(size=size)
124	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
126	                self._read_multi_volume_files()
127	            return self._reader.read(size)
128	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	        content_part = buffer.getvalue()
139	        self._writer.write(filename, content_part)
140	        self._meta[filename] = buffer.tell()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
138	        content_part = buffer.getvalue()
139	        self._writer.write(filename, content_part)
140	        self._meta[filename] = buffer.tell()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
152	            content = content[buffer_left_size:]
153	            self._write_buffer.write(content_part)
154	            content_left -= len(content_part)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
152	            content = content[buffer_left_size:]
153	            self._write_buffer.write(content_part)
154	            content_left -= len(content_part)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
169	                # write meta file if file length > 1
170	                self._writer.write(META_FILE_NAME, to_binary(meta_content))
171	            self._writer.__exit__(None, None, None)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/filesystem.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
169	                # write meta file if file length > 1
170	                self._writer.write(META_FILE_NAME, to_binary(meta_content))
171	            self._writer.__exit__(None, None, None)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/run_script.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	    if hasattr(script, "read"):
87	        code = script.read()
88	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/mars_extension/oscar/run_script.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	        with open(os.path.abspath(script), "rb") as f:
90	            code = f.read()
91	    inputs = _extract_inputs(data)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	_RESULT_LIMIT_HELPER_MSG = (
49	    "See https://pyodps.readthedocs.io/zh_CN/latest/base-sql.html#read-sql-exec-result "
50	    "for more information about limits on instance results."
51	)
52	_STATUS_QUERY_TIMEOUT = 5 * 60  # timeout when getting status
53	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
231	                        try:
232	                            return utils.to_str(base64.b64decode(text))
233	                        except TypeError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:232
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
231	                        try:
232	                            return utils.to_str(base64.b64decode(text))
233	                        except TypeError:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
240	                        try:
241	                            return utils.to_binary(base64.b64decode(text))
242	                        except TypeError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:241
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
240	                        try:
241	                            return utils.to_binary(base64.b64decode(text))
242	                        except TypeError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
436	            actions.append("instancestatus")
437	        resp = self._client.get(self.resource(), actions=actions)
438	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
438	
439	        self.owner = resp.headers.get("x-odps-owner")
440	        self.start_time = utils.parse_rfc822(resp.headers.get("x-odps-start-time"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
439	        self.owner = resp.headers.get("x-odps-owner")
440	        self.start_time = utils.parse_rfc822(resp.headers.get("x-odps-start-time"))
441	        end_time_header = "x-odps-end-time"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
445	        ):
446	            self.end_time = utils.parse_rfc822(resp.headers.get(end_time_header))
447	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
480	        def _get_resp():
481	            return self._client.get(self.resource(), action="result", timeout=timeout)
482	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
522	        task_name = task_name or self._get_default_task_name()
523	        return self.get_task_results(timeout=timeout, retry=retry).get(task_name)
524	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
535	        params = {"taskname": task_name}
536	        resp = self._client.get(
537	            self.resource(), action="instancesummary", params=params
538	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
539	
540	        map_reduce = resp.json().get("Instance")
541	        if map_reduce:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
541	        if map_reduce:
542	            json_summary = map_reduce.get("JsonSummary")
543	            if json_summary:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
544	                summary = Instance.TaskSummary(json.loads(json_summary))
545	                summary.summary_text = map_reduce.get("Summary")
546	                summary.json_summary = json_summary

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
559	        def _get_resp():
560	            return self._client.get(self.resource(), action="taskstatus")
561	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
602	
603	            cpu_cost = task_cost.get("CPU")
604	            memory = task_cost.get("Memory")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
603	            cpu_cost = task_cost.get("CPU")
604	            memory = task_cost.get("Memory")
605	            input_size = task_cost.get("Input")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
604	            memory = task_cost.get("Memory")
605	            input_size = task_cost.get("Input")
606	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
614	            endpoint=self._client.endpoint,
615	            request_id=resp.headers.get("x-odps-request-id"),
616	            tag="ODPS",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
630	
631	        resp = self._client.get(self.resource(), actions=actions, params=params)
632	        resp_data = resp.content.decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
657	
658	        location = resp.headers.get("Location")
659	        if check_location and (location is None or len(location) == 0):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
676	        params = {"taskname": task_name}
677	        resp = self._client.get(self.resource(), actions=actions, params=params)
678	        return json.loads(resp.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
693	
694	        udf_num = sql_cost.get("UDF")
695	        complexity = sql_cost.get("Complexity")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
694	        udf_num = sql_cost.get("UDF")
695	        complexity = sql_cost.get("Complexity")
696	        input_size = sql_cost.get("Input")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
695	        complexity = sql_cost.get("Complexity")
696	        input_size = sql_cost.get("Input")
697	        return Instance.SQLCost(udf_num, complexity, input_size)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
902	
903	        resp = self._client.get(self.resource(), params=params)
904	        return Instance.Task.TaskProgress.parse(self._client, resp)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
919	            params = {"taskname": task_name}
920	            resp = self._client.get(
921	                self.resource(), action="instancedetail", params=params
922	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:951
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
950	
951	        resp = self._client.get(self.resource(), action="detail", params=params)
952	        res = resp.content.decode() if six.PY3 else resp.content

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
997	            params["size"] = str(size)
998	        resp = self._client.get(self.resource(), params=params)
999	        return resp.text

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:1084
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1083	            url = self.resource()
1084	            resp = self._client.get(url, action="source")
1085	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:1108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1107	        url = self.resource()
1108	        resp = self._client.get(url, action="cached", params=params)
1109	        return (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:1247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1246	        """
1247	        use_tunnel = kwargs.get("use_tunnel", kwargs.get("tunnel"))
1248	        auto_fallback_result = use_tunnel is None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:1247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1246	        """
1247	        use_tunnel = kwargs.get("use_tunnel", kwargs.get("tunnel"))
1248	        auto_fallback_result = use_tunnel is None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:1286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1285	                    raise
1286	                if not kwargs.get("limit"):
1287	                    warnings.warn(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:1297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1296	                    raise
1297	                if not kwargs.get("limit"):
1298	                    warnings.warn(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/instance.py:1315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1314	                    raise
1315	                if not kwargs.get("limit"):
1316	                    warnings.warn(

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/readers.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
55	
56	            p = _mp_context.Process(
57	                target=self._get_process_split_reader(
58	                    columns=columns, append_partitions=append_partitions
59	                ),
60	                args=(child_conn, session_id, start, split_count, i),
61	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
286	            file_obj.seek(0)
287	            content = file_obj.read()
288	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
329	            while True:
330	                buf = file_obj.read(chunk_size)
331	                if not buf:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
332	                    break
333	                res_file.write(buf)
334	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
421	
422	        self._check_read()
423	        return self._fp.read(size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
422	        self._check_read()
423	        return self._fp.read(size)
424	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
437	
438	        self._check_read()
439	        return self._fp.readline(size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
451	
452	        self._check_read()
453	        return self._fp.readlines(sizehint)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
467	        """
468	        self._check_write()
469	        return self._fp.write(content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
468	        self._check_write()
469	        return self._fp.write(content)
470	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
477	        """
478	        self._check_write()
479	        return self._fp.writelines(seq)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
510	        """
511	        self._check_write()
512	        return self._fp.truncate(size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
533	    def __iter__(self):
534	        self._check_read()
535	        return self._fp.__iter__()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resource.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
537	    def __next__(self):
538	        self._check_read()
539	        return next(self._fp)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resourcefile.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
149	    def read(self, size=-1):
150	        return self._fp.read(size)
151	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resourcefile.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
173	
174	        res = self._fp.write(content)
175	        self._sync_size()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resourcefile.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
303	        self._rebuild_buffer()
304	        self._buffer.write(self._convert(buf.read()))
305	        self._buffer.seek(0, os.SEEK_SET)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resourcefile.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
303	        self._rebuild_buffer()
304	        self._buffer.write(self._convert(buf.read()))
305	        self._buffer.seek(0, os.SEEK_SET)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resourcefile.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
317	                break
318	            res = self._buffer.read(size_to_read)
319	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resourcefile.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
319	
320	            buf.write(res)
321	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resourcefile.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
342	            # read and concatenate to existing line
343	            line_buf.write(res)
344	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/resourcefile.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
407	        last_pos = self._buffer.tell()
408	        self._buffer.write(content)
409	        content_size = self._buffer.tell() - last_pos

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/session/v1.py:798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
797	                with open(session_file_name, "r") as session_file:
798	                    session_info = json.loads(session_file.read())
799	                instance_obj = odps.get_instance(session_info.pop("id"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/session/v1.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
832	                    with open(session_file_name, "w") as session_file:
833	                        session_file.write(
834	                            json.dumps(odps._default_session._extract_json_info())
835	                        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
149	            data = utils.call_with_retry(_data_to_pandas)
150	            conn.send((idx, data, True))
151	        except:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
152	            try:
153	                conn.send((idx, sys.exc_info(), False))
154	            except:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
274	
275	        self._sock.close()
276	        self._sock = None

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:279
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
278	    def start(self):
279	        self._sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
280	        self._sock.bind(("127.0.0.1", 0))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
279	        self._sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
280	        self._sock.bind(("127.0.0.1", 0))
281	        self._serve_thread_obj = threading.Thread(target=self._serve_thread)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
280	        self._sock.bind(("127.0.0.1", 0))
281	        self._serve_thread_obj = threading.Thread(target=self._serve_thread)
282	        self._serve_thread_obj.daemon = True

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:286
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
285	    def stop(self):
286	        stop_sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
287	        stop_data = self._authkey + struct.pack("<B", _STOP_SERVER_CMD)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
288	        stop_sock.sendto(stop_data, self._sock.getsockname())
289	        stop_sock.close()
290	        self._serve_thread_obj.join()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
301	    def __del__(self):
302	        self.close()
303	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
305	        if self._sock is not None:
306	            self._sock.close()
307	            self._sock = None

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:311
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
310	        if self._sock is None:
311	            self._sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
312	        return self._sock

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
537	            writer = self._thread_to_buffered_writers.get(
538	                threading.current_thread().ident
539	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
557	            for writer in self._thread_to_buffered_writers.values():
558	                writer.close()
559	                written_blocks.extend(writer.get_blocks_written())

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
562	                if writer is not None:
563	                    writer.close()
564	            written_blocks = [

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
586	        if callable(self._on_close):
587	            self._on_close()
588	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
589	        if self._mp_client is not None:
590	            self._mp_client.close()
591	            self._mp_client = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
603	            return
604	        self.close()
605	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
649	            )
650	            thread_ident = threading.current_thread().ident
651	            self._thread_to_buffered_writers[thread_ident] = writer

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
663	        for record in self._to_records(*args):
664	            writer.write(record)
665	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
674	            )
675	            thread_ident = threading.current_thread().ident
676	            self._thread_to_buffered_writers[thread_ident] = writer

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
683	        for arg in args:
684	            writer.write(arg)
685	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
716	        compress = kw.pop("compress", None)
717	        self._write(*args, compress=compress, delete=False)
718	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
720	        compress = kw.pop("compress", None)
721	        self._write(*args, compress=compress, delete=True)
722	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
726	        else:
727	            self._upsert.close()
728	            if commit and self._commit:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
731	        if callable(self._on_close):
732	            self._on_close()
733	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
739	        if exc_val is not None:
740	            self.close(success=False, commit=False)
741	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
741	            return
742	        self.close()
743	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:809
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
808	        with table.open_reader(partition=partition, **kw) as reader:
809	            for record in reader.read(
810	                start, limit, step=step, compress=compress, columns=columns
811	            ):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:1300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1299	                    for data in data_list:
1300	                        writer.write(data)
1301	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/tableio.py:1303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1302	                    for block, data in zip(blocks, data_list):
1303	                        writer.write(block, data)
1304	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/volume_ext.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	            params["curr_schema"] = schema_name
57	        resp = self._client.get(
58	            self.parent.resource(), action="meta", params=params, headers=headers
59	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/models/volume_ext.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	        else:
81	            resp = requests.get(sign_url, *args, **kw)
82	        resp.volume_path = path

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/readers.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	                if count is None
192	                else (start or 0) + count * (iter_kw.get("step") or 1)
193	            )

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
77	    try:
78	        py_system = platform.system()
79	        py_release = platform.release()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
77	    try:
78	        py_system = platform.system()
79	        py_release = platform.release()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:78
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
77	    try:
78	        py_system = platform.system()
79	        py_release = platform.release()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	        self.namespace = namespace
147	        self._proxy = kwargs.get("proxy")
148	        self._app_account = kwargs.get("app_account")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	        self._proxy = kwargs.get("proxy")
148	        self._app_account = kwargs.get("app_account")
149	        self._tag = kwargs.get("tag")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
148	        self._app_account = kwargs.get("app_account")
149	        self._tag = kwargs.get("tag")
150	        if isinstance(self._proxy, six.string_types):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	    def request(self, url, method, stream=False, **kwargs):
201	        sign_region_name = kwargs.get("region_name") or self._region_name
202	        if (

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
212	            try:
213	                return self._request(url, method, stream=stream, **kwargs)
214	            except errors.InternalServerError as ex:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
264	        # Construct user agent without handling the letter case.
265	        headers = kwargs.get("headers", {})
266	        headers = {k: str(v) for k, v in six.iteritems(headers)}

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
294	        prepared_req.headers.pop("application-authentication", None)
295	        self._account.sign_request(
296	            prepared_req, self._endpoint, region_name=region_name
297	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
298	        if getattr(self, "_app_account", None) is not None:
299	            self._app_account.sign_request(
300	                prepared_req, self._endpoint, region_name=region_name
301	            )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
309	        try:
310	            res = self.session.send(
311	                prepared_req,
312	                stream=stream,
313	                timeout=timeout or (options.connect_timeout, options.read_timeout),
314	                verify=options.verify_ssl,
315	                proxies=self._proxy,
316	            )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
309	        try:
310	            res = self.session.send(
311	                prepared_req,
312	                stream=stream,
313	                timeout=timeout or (options.connect_timeout, options.read_timeout),
314	                verify=options.verify_ssl,
315	                proxies=self._proxy,
316	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
331	    def get(self, url, stream=False, **kwargs):
332	        return self.request(url, "get", stream=stream, **kwargs)
333	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
339	        )
340	        return self.request(url, "post", data=data, **kwargs)
341	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
343	        data = utils.to_binary(data) if isinstance(data, six.string_types) else data
344	        return self.request(url, "put", data=data, **kwargs)
345	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
346	    def head(self, url, **kwargs):
347	        return self.request(url, "head", **kwargs)
348	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/rest.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
349	    def delete(self, url, **kwargs):
350	        return self.request(url, "delete", **kwargs)
351	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	def _route_xml_path(root, *keys, **kw):
30	    create_if_not_exists = kw.get("create_if_not_exists", False)
31	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	def _route_json_path(root, *keys, **kw):
57	    create_if_not_exists = kw.get("create_if_not_exists", False)
58	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	        prev = root
64	        root = root.get(key)
65	        if root is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	
119	        self._required = kwargs.get("required", False)  # used when serialized
120	        self._blank_if_null = kwargs.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	        self._required = kwargs.get("required", False)  # used when serialized
120	        self._blank_if_null = kwargs.get(
121	            "blank_if_null", True if self._required else False
122	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	        )
123	        self._default = kwargs.get("default")
124	        if "type" in kwargs:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	        else:
129	            self._parse_callback = kwargs.get("parse_callback")
130	            self._serialize_callback = kwargs.get("serialize_callback")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	            self._parse_callback = kwargs.get("parse_callback")
130	            self._serialize_callback = kwargs.get("serialize_callback")
131	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	
132	        self.set_to_parent = kwargs.get("set_to_parent", False)
133	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
210	            fields.update(getattr(base, "__fields", dict()))
211	        slots.extend(kv.get("__slots__", []))
212	        fields.update(kv.get("__fields", dict()))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
211	        slots.extend(kv.get("__slots__", []))
212	        fields.update(kv.get("__fields", dict()))
213	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	            sorted(
237	                six.iteritems(fields), key=lambda s: slots_pos.get(s[0], float("inf"))
238	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
507	        if node is not None:
508	            val = node.get(self._attr)
509	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
514	            return self._parse_callback(val)
515	        return node.get(self._attr)
516	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
689	        super(XMLNodePropertiesField, self).__init__(*keys, **kwargs)
690	        self._key_tag = kwargs.get("key_tag")
691	        self._key_attr = kwargs.get("key_attr")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
690	        self._key_tag = kwargs.get("key_tag")
691	        self._key_attr = kwargs.get("key_attr")
692	        if not self._key_tag and not self._key_attr:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
693	            raise TypeError("Need to specify one of key_tag or key_attr")
694	        self._value_tag = kwargs.get("value_tag")
695	        if not self._key_attr and not self._value_tag:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
709	                if self._key_attr is not None:
710	                    key = node.attrib.get(self._key_attr)
711	                else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
845	
846	        self._check_before = kwargs.get("check_before")
847	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/serializers.py:897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
896	            if root is not None:
897	                root = root.get(self._path_keys[-1])
898	                if root is not None:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tempobj.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
285	            return
286	        os.chmod(self._file_name, USER_FILE_RIGHTS)
287	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tempobj.py:286
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
285	            return
286	        os.chmod(self._file_name, USER_FILE_RIGHTS)
287	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tempobj.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
351	        script_file = env.io.FileIO(script_name, "w")
352	        script_file.write(env.conv_bytes(script))
353	        script_file.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tempobj.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
351	        script_file = env.io.FileIO(script_name, "w")
352	        script_file.write(env.conv_bytes(script))
353	        script_file.close()

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tempobj.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
355	            if env.is_windows:
356	                env.os.chmod(script_name, env.file_right)
357	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tempobj.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
381	        task_lines = (
382	            os.popen('TASKLIST /FI "PID eq {0}" /NH'.format(pid))
383	            .read()

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tempobj.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
381	        task_lines = (
382	            os.popen('TASKLIST /FI "PID eq {0}" /NH'.format(pid))
383	            .read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tempobj.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
438	
439	    thread_obj = threading.Thread(target=clean_thread)
440	    thread_obj.start()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/errors.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	            else:
37	                request_id = resp.headers.get("x-odps-request-id")
38	            exc_type = globals().get(code, TunnelError)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/errors.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	                request_id = resp.headers.get("x-odps-request-id")
38	            exc_type = globals().get(code, TunnelError)
39	        except:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/errors.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	            code = obj["InvalidArgument"]
44	            exc_type = globals().get(code, TunnelError)
45	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/instancetunnel.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	        self._limit_enabled = (
95	            limit if limit is not None else kw.get("limit_enabled", False)
96	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/instancetunnel.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
157	            try:
158	                resp = self._client.post(
159	                    url,
160	                    {},
161	                    action="downloads",
162	                    params=params,
163	                    headers=headers,
164	                    timeout=self._timeout,
165	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/instancetunnel.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
193	            url = self._instance.resource()
194	            resp = self._client.get(url, params=params, headers=headers)
195	            if self._client.is_ok(resp):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/instancetunnel.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	        url = self._instance.resource()
237	        resp = self._client.get(url, stream=True, params=params, headers=headers)
238	        if not self._client.is_ok(resp):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/instancetunnel.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244	            # handle this.
245	            schema_json = resp.headers.get("odps-tunnel-schema")
246	            self.schema = TableSchema()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/instancetunnel.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	
249	        content_encoding = resp.headers.get("Content-Encoding")
250	        if content_encoding is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/instancetunnel.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
383	        if limit is None:
384	            limit = kw.get("limit_enabled", False)
385	        return InstanceDownloadSession(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/io/stream.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	        while True:
112	            data = self.get()
113	            if data is not None:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/io/stream.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
555	        if data:
556	            return self._decompressor.decompress(data)
557	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
242	        try:
243	            resp = self._client.post(
244	                url, {}, params=params, headers=headers, timeout=timeout
245	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	        url = self._table.table_resource()
276	        resp = self._client.get(url, params=params, headers=headers)
277	        self.check_tunnel_response(resp)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
304	        url = self._table.table_resource()
305	        resp = self._client.get(
306	            url, stream=True, actions=actions, params=params, headers=headers
307	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
309	
310	        content_encoding = resp.headers.get("Content-Encoding")
311	        if content_encoding is not None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
883	        url = self._get_resource()
884	        resp = self._client.post(url, {}, params=params, headers=headers)
885	        self.check_tunnel_response(resp)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
908	        url = self._get_resource()
909	        resp = self._client.get(url, params=params, headers=headers)
910	        self.check_tunnel_response(resp)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
927	        url = self._get_resource()
928	        resp = self._client.post(url, {}, params=params, headers=headers)
929	        self.check_tunnel_response(resp)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:1132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1131	                params["lifecycle"] = self._lifecycle
1132	            resp = self._client.post(url, {}, params=params, headers=headers)
1133	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1133	        else:
1134	            resp = self._client.get(url, params=params, headers=headers)
1135	        if self._client.is_ok(resp):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:1215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1214	        url = self._get_resource()
1215	        resp = self._client.post(url, params=params, headers=headers)
1216	        self.check_tunnel_response(resp)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:1233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1232	
1233	                resp = self._client.post(url, params=params, headers=headers)
1234	                self.check_tunnel_response(resp)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/tabletunnel.py:1561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1560	        url = tunnel_table.table_resource(force_schema=True) + "/preview"
1561	        resp = self.tunnel_rest.get(
1562	            url, stream=True, params=params, headers=headers, timeout=timeout
1563	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	        url = volume.resource(client=self.tunnel_rest)
160	        resp = self.tunnel_rest.get(url, headers=headers, stream=True)
161	        if not self.tunnel_rest.is_ok(resp):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
171	
172	        content_encoding = resp.headers.get("Content-Encoding")
173	        if content_encoding is not None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
228	
229	        chunk_upload = lambda data: self.tunnel_rest.post(
230	            url, data=data, params=params, headers=headers
231	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
344	        url = self.resource()
345	        resp = self._client.post(url, {}, params=params, headers=headers)
346	        if self._client.is_ok(resp):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
361	        url = self.resource() + "/" + str(self.id)
362	        resp = self._client.get(url, params=params, headers=headers)
363	        if self._client.is_ok(resp):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
386	        url = self.resource()
387	        resp = self._client.get(
388	            url + "/" + self.id, params=params, headers=headers, stream=True
389	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
393	
394	        content_encoding = resp.headers.get("Content-Encoding")
395	        if content_encoding is not None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
674	        url = self.resource()
675	        resp = self._client.post(url, {}, params=params, headers=headers)
676	        if self._client.is_ok(resp):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
686	        url = self.resource() + "/" + str(self.id)
687	        resp = self._client.get(url, params=params, headers=headers)
688	        if self._client.is_ok(resp):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
744	
745	        chunk_uploader = lambda data: self._client.post(
746	            url, data=data, params=params, headers=headers
747	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/tunnel/volumetunnel.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
893	                + self._path.lstrip("/"),
894	                "x-odps-volume-sessionid": result.headers.get(
895	                    "x-odps-volume-sessionid"
896	                ),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/udf/tools/utils.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	    config = ConfigParser.RawConfigParser()
48	    config.read(f)
49	    access_id = config.get("access_id")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	    # newl = newline string
156	    writer.write(indent + "<" + self.tagName)
157	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
162	    for a_name in a_names:
163	        writer.write(" %s=\"" % a_name)
164	        xml.dom.minidom._write_data(writer, attrs[a_name].value)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	        xml.dom.minidom._write_data(writer, attrs[a_name].value)
165	        writer.write("\"")
166	    if self.childNodes:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	        ):
171	            writer.write(">")
172	            self.childNodes[0].writexml(writer, "", "", "")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
172	            self.childNodes[0].writexml(writer, "", "", "")
173	            writer.write("</%s>%s" % (self.tagName, newl))
174	            return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
174	            return
175	        writer.write(">%s" % (newl))
176	        for node in self.childNodes:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
177	            node.writexml(writer, indent + addindent, addindent, newl)
178	        writer.write("%s</%s>%s" % (indent, self.tagName, newl))
179	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
179	    else:
180	        writer.write("/>%s" % (newl))
181	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
188	def hmac_sha1(secret, data):
189	    return b64encode(hmac.new(secret, data, sha1).digest())
190	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:189
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
188	def hmac_sha1(secret, data):
189	    return b64encode(hmac.new(secret, data, sha1).digest())
190	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
617	    with codecs.open(file_path, encoding="utf-8") as f:
618	        inp_file = f.read()
619	        f.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
643	        with codecs.open(file_path, encoding="utf-8") as f:
644	            content_dict[fn] = f.read()
645	            f.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
694	    bar = None
695	    if not mock and is_main_thread():
696	        bar = init_progress_bar(val=val, use_console=use_console)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:963
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
962	    if hasattr(threading, "main_thread"):
963	        return threading.current_thread() is threading.main_thread()
964	    return threading.current_thread().__class__.__name__ == "_MainThread"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:963
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
962	    if hasattr(threading, "main_thread"):
963	        return threading.current_thread() is threading.main_thread()
964	    return threading.current_thread().__class__.__name__ == "_MainThread"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps/utils.py:964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
963	        return threading.current_thread() is threading.main_thread()
964	    return threading.current_thread().__class__.__name__ == "_MainThread"
965	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
701	            ) as res_file:
702	                res_file.write(_to_unix(req_text))
703	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
707	            with open(os.path.join(script_path, _VCS_FILE_NAME), "wb") as res_file:
708	                res_file.write(_to_unix(vcs_text))
709	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
715	            ) as install_req_file:
716	                install_req_file.write(_to_unix(install_req_text))
717	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
723	            ) as exclude_file:
724	                exclude_file.write(_to_unix(exclude_text))
725	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
731	                    with open(before_script, "rb") as src_before_file:
732	                        before_script_file.write(_to_unix(src_before_file.read()))
733	                        before_script_file.write(b"\n\n")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
731	                    with open(before_script, "rb") as src_before_file:
732	                        before_script_file.write(_to_unix(src_before_file.read()))
733	                        before_script_file.write(b"\n\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
732	                        before_script_file.write(_to_unix(src_before_file.read()))
733	                        before_script_file.write(b"\n\n")
734	                if cmd_before_build:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
734	                if cmd_before_build:
735	                    before_script_file.write(_to_unix(cmd_before_build.encode()))
736	            if logger.getEffectiveLevel() <= logging.DEBUG:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
740	                    _log_indent(
741	                        "Content of before-script.sh:", before_script_file.read()
742	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
746	        ) as toml_file:
747	            toml_file.write(_to_unix(dynlibs_pyproject_toml.encode()))
748	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
752	            # make sure script work well under windows
753	            pack_file.write(_to_unix(build_script.encode()))
754	        yield tmp_path

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
758	                # permission error may occur when using shutil.rmtree in Windows.
759	                os.system("rd /s /q \"" + tmp_path + "\"")
760	            else:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
758	                # permission error may occur when using shutil.rmtree in Windows.
759	                os.system("rd /s /q \"" + tmp_path + "\"")
760	            else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:759
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
758	                # permission error may occur when using shutil.rmtree in Windows.
759	                os.system("rd /s /q \"" + tmp_path + "\"")
760	            else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:761
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
760	            else:
761	                shutil.rmtree(tmp_path)
762	            if os.path.exists(tmp_path):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
789	    sections = defaultdict(dict)
790	    for line in proc.stdout.read().decode().splitlines():
791	        var, value = line.split("=", 1)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:834
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
833	        with open(req_file_name, "r") as req_file:
834	            install_requires.extend(req_file.read().splitlines())
835	    parsed_args.install_requires = install_requires

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
853	        )
854	    pack_descriptions.extend(json.loads(proc.stdout.read()))
855	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
943	        err_msg = (
944	            "Failed to locate Git Bash. Please check your installation of Git for Windows "
945	            "which can be obtained at https://gitforwindows.org/."
946	        )
947	        if int(platform.win32_ver()[1].rsplit(".")[-1]) > 19041:
948	            err_msg += " You may also try packing under WSL or with Docker."

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:1003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1002	
1003	    wait_thread = threading.Thread(target=wait_start_thread_func)
1004	    wait_thread.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/odps_scripts/pyodps_pack.py:1225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1224	                    _print_fail(
1225	                        "Image manylinux1 might crash silently under some Docker environments. "
1226	                        "You may try under a native Linux environment. Details can be seen at "
1227	                        "https://mail.python.org/pipermail/wheel-builders/2016-December/000239.html."

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
60	        locs = locs or globs
61	        exec(compile(open(fname).read(), fname, "exec"), globs, locs)
62	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	        locs = locs or globs
61	        exec(compile(open(fname).read(), fname, "exec"), globs, locs)
62	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
101	            destinations.extend(
102	                recursive_overwrite(os.path.join(src, f), os.path.join(dest, f))
103	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
165	with open("requirements.txt") as f:
166	    requirements.extend(f.read().splitlines())
167	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
186	    with open("README.rst") as f:
187	        long_description = f.read()
188	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
197	    maintainer_email="wenjun.swj@alibaba-inc.com",
198	    url="http://github.com/aliyun/aliyun-odps-python-sdk",
199	    license="Apache License 2.0",

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
321	            if os.path.exists(dest_dir):
322	                shutil.rmtree(dest_dir)
323	            if not os.path.exists(dest_dir):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
324	                os.makedirs(dest_dir)
325	            recursive_overwrite(src_dir, dest_dir)
326	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
353	            print("executing " + cmd)
354	            ret = os.system(cmd)
355	            ret >>= 8

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
353	            print("executing " + cmd)
354	            ret = os.system(cmd)
355	            ret >>= 8

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:354
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
353	            print("executing " + cmd)
354	            ret = os.system(cmd)
355	            ret >>= 8

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
359	            print("executing grunt")
360	            ret = os.system("npm run grunt")
361	            ret >>= 8

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
359	            print("executing grunt")
360	            ret = os.system("npm run grunt")
361	            ret >>= 8

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:360
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
359	            print("executing grunt")
360	            ret = os.system("npm run grunt")
361	            ret >>= 8

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyodps-0.12.3b2/pyodps-0.12.3b2/setup.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
378	            print("removing '%s'" % full_path)
379	            shutil.rmtree(full_path)
380	        for f in files:

--------------------------------------------------

Code scanned:
	Total lines of code: 81621
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 86.0
		High: 533.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 557.0
		High: 62.0
Files skipped (0):
