Run started:2025-04-12 11:21:25.486993

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	    with open(os.path.join(os.path.dirname(__file__), "README"), encoding="utf-8") as f:
20	        return f.read()
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/setup.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	    "and manage HPC clusters in the AWS cloud.",
66	    url="https://github.com/aws/aws-parallelcluster",
67	    license="Apache License 2.0",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/setup.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	    project_urls={
97	        "Changelog": "https://github.com/aws/aws-parallelcluster/blob/develop/CHANGELOG.md",
98	        "Issue Tracker": "https://github.com/aws/aws-parallelcluster/issues",
99	        "Documentation": "https://docs.aws.amazon.com/parallelcluster/",
100	    },
101	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/setup.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	        "Changelog": "https://github.com/aws/aws-parallelcluster/blob/develop/CHANGELOG.md",
98	        "Issue Tracker": "https://github.com/aws/aws-parallelcluster/issues",
99	        "Documentation": "https://docs.aws.amazon.com/parallelcluster/",
100	    },
101	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/setup.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	        "Issue Tracker": "https://github.com/aws/aws-parallelcluster/issues",
99	        "Documentation": "https://docs.aws.amazon.com/parallelcluster/",
100	    },
101	)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
119	    if event.get("isBase64Encoded", False):
120	        body = base64.b64decode(body)
121	    if isinstance(body, str):

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py:120
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
119	    if event.get("isBase64Encoded", False):
120	        body = base64.b64decode(body)
121	    if isinstance(body, str):

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
160	        else:
161	            returndict["body"] = base64.b64encode(response.data).decode("utf-8")
162	            returndict["isBase64Encoded"] = True

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py:161
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
160	        else:
161	            returndict["body"] = base64.b64encode(response.data).decode("utf-8")
162	            returndict["isBase64Encoded"] = True

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
124	        if dryrun:
125	            ignored_validation_failures = cluster.validate_create_request(
126	                get_validator_suppressors(suppress_validators), FailureLevel[validation_failure_level]
127	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
380	        if dryrun:
381	            _, changes, ignored_validation_failures = cluster.validate_update_request(
382	                target_source_config=cluster_config,
383	                force=force_update,
384	                validator_suppressors=get_validator_suppressors(suppress_validators),
385	                validation_failure_level=FailureLevel[validation_failure_level],
386	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
120	        if dryrun:
121	            imagebuilder.validate_create_request(
122	                validator_suppressors=get_validator_suppressors(suppress_validators),
123	                validation_failure_level=FailureLevel[validation_failure_level],
124	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/api/util.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	        message = (
173	            "Unable to find node executable. Node.js is required by the AWS CDK library used by ParallelCluster, "
174	            "see installation instructions here: https://docs.aws.amazon.com/parallelcluster/latest/ug/install-v3.html"
175	        )
176	        LOGGER.critical(message)
177	        raise Exception(message)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/api/util.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
227	        message = (
228	            f"AWS CDK library used by ParallelCluster requires Node.js version >= {NODEJS_MIN_VERSION},"
229	            " see installation instructions here: https://docs.aws.amazon.com/parallelcluster/latest/ug/install-v3.html"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/api/util.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	        message = (
239	            f"AWS CDK library used by ParallelCluster requires Node.js to not be in the range"
240	            f" {NODEJS_INCOMPATIBLE_VERSION_RANGE}, but installed Node.js version {node_version_string}"
241	            f" is within this range, see https://docs.aws.amazon.com/cdk/v2/guide/getting_started.html"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	        print(
63	            "No KeyPair found in region {0}, please create one following the guide: "
64	            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html".format(get_region())

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
326	        with open(config_file_path, "a", encoding="utf-8"):
327	            os.chmod(config_file_path, stat.S_IRUSR | stat.S_IWUSR)
328	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py:327
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
326	        with open(config_file_path, "a", encoding="utf-8"):
327	            os.chmod(config_file_path, stat.S_IRUSR | stat.S_IWUSR)
328	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
363	                prompt(
364	                    "The creation of a public and private subnet combination will result in\n"
365	                    "charges for NAT gateway creation that are not covered under the free tier.\n"
366	                    "Please refer to https://aws.amazon.com/vpc/pricing/ for more details.\n"
367	                    "Automate Subnet creation? (y/n)",
368	                    lambda x: x in ("y", "n"),
369	                    default_value="y",
370	                )
371	                == "y"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
450	    print(
451	        "The EC2 instance selected supports enhanced networking capabilities using Elastic Fabric Adapter (EFA). "
452	        "EFA enables you to run applications requiring high levels of inter-node communications at scale on AWS at no "
453	        "additional charge (https://docs.aws.amazon.com/parallelcluster/latest/ug/efa-v3.html)."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
146	
147	    return "https://{IP}:{PORT}?authToken={TOKEN}#{SESSION_ID}".format(
148	        IP=node_ip,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
68	        with open(path, encoding="utf-8") as file:
69	            file_data = file.read()
70	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
533	    "ebs_volume_update": "Follow the instructions at {0}#{1} to modify your volume from AWS Console.".format(
534	        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/requesting-ebs-volume-modifications.html",
535	        "modify-ebs-volume",
536	    ),
537	    "pcluster_stop": lambda change, patch: "Stop the compute fleet with the pcluster update-compute-fleet command",
538	    "pcluster_stop_conditional": actions_needed_queue_update_strategy,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/constants.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	PCLUSTER_NAME_REGEX = r"^([a-zA-Z][a-zA-Z0-9-]{0,%d})$"
19	PCLUSTER_ISSUES_LINK = "https://github.com/aws/aws-parallelcluster/issues"
20	PCLUSTER_AMI_ID_REGEX = r"^ami-[0-9a-z]{8}$|^ami-[0-9a-z]{17}$"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/common.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
206	                raise LogsExporterError(
207	                    f"CloudWatch Logs needs GetBucketAcl and PutObject permission for the s3 bucket {self.bucket}. "
208	                    "See https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/S3ExportTasks.html#S3Permissions "

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/common.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
242	            LOGGER.debug("Extracting object at %s to %s", compressed_path, decompressed_path)
243	            with gzip.open(compressed_path) as gfile, open(decompressed_path, "wb") as outfile:
244	                outfile.write(gfile.read())

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/common.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
242	            LOGGER.debug("Extracting object at %s to %s", compressed_path, decompressed_path)
243	            with gzip.open(compressed_path) as gfile, open(decompressed_path, "wb") as outfile:
244	                outfile.write(gfile.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/common.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
243	            with gzip.open(compressed_path) as gfile, open(decompressed_path, "wb") as outfile:
244	                outfile.write(gfile.read())
245	            os.remove(compressed_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/common.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
243	            with gzip.open(compressed_path) as gfile, open(decompressed_path, "wb") as outfile:
244	                outfile.write(gfile.read())
245	            os.remove(compressed_path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/common.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
262	
263	    with open(output_file, "w", encoding="utf-8") as cfn_events_file:
264	        cfn_events_file.write(json.dumps(stack_events, cls=JSONEncoder, indent=2))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/common.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
263	    with open(output_file, "w", encoding="utf-8") as cfn_events_file:
264	        cfn_events_file.write(json.dumps(stack_events, cls=JSONEncoder, indent=2))
265	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/common.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
271	    LOGGER.debug("Creating archive of logs and saving it to %s", output_file)
272	    with tarfile.open(output_file, "w:gz") as tar:
273	        tar.add(directory, arcname=base_name)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/common.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
278	    archive_filename = os.path.basename(archive_path)
279	    with open(archive_path, "rb") as archive_file:
280	        archive_data = archive_file.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/common.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
279	    with open(archive_path, "rb") as archive_file:
280	        archive_data = archive_file.read()
281	    bucket_path = f"{bucket_prefix}/{archive_filename}" if bucket_prefix else archive_filename

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/s3_bucket.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
290	            )
291	            file_content = response["Body"].read().decode("utf-8")
292	            try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/s3_bucket.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
397	
398	        file_content = result["Body"].read().decode("utf-8")
399	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/models/s3_bucket.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
409	        """Get file http url from S3 bucket."""
410	        url = "https://{bucket_name}.s3.{region}.{aws_domain}/{config_key}".format(
411	            bucket_name=self.name,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/crhelper/utils.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
33	            connection = HTTPSConnection(host)  # nosec B309 nosemgrep
34	            connection.request(method="PUT", url=url, body=json_response_body, headers=headers)
35	            response = connection.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/crhelper/utils.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
34	            connection.request(method="PUT", url=url, body=json_response_body, headers=headers)
35	            response = connection.getresponse()
36	            logger.info("CloudFormation returned status code: %s", response.reason)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/send_build_notification.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
45	            connection = HTTPSConnection(host)  # nosec B309 nosemgrep
46	            connection.request(
47	                method="PUT", url=url, body=data, headers={"Content-Type": "", "content-length": str(len(data))}
48	            )

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/send_build_notification.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
48	            )
49	            response = connection.getresponse()
50	            print(f"CloudFormation returned status code: {response.reason}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
458	        self._add_text_widget(
459	            "General [Troubleshooting Resources]"
460	            "(https://docs.aws.amazon.com/parallelcluster/latest/ug/troubleshooting.html)"
461	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/utils.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
138	        zinfo.external_attr = 0o644 << 16
139	        zip_file.writestr(zinfo, input_file.read())
140	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/utils.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
287	        )
288	        sys.stdout.write("\r%s" % resource_status)
289	        sys.stdout.flush()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/utils.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
545	
546	    _thread_pool_executor: ThreadPoolExecutor = ThreadPoolExecutor()
547	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/utils.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
570	        try:
571	            url = "https://{region}-aws-parallelcluster.s3.{region}.{aws_domain}/supported-regions".format(
572	                region=region,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/utils.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
579	            with open(pkg_resources.resource_filename(__name__, "/resources/supported-regions"), encoding="utf-8") as f:
580	                retrieve_supported_regions.cache = f.read().split("\n")
581	    return retrieve_supported_regions.cache

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	                (
163	                    f"ParallelCluster has no official AMI for {os}. "
164	                    "Please build your own AMI using pcluster build-image command, "
165	                    "as explained in the documentation: "
166	                    "https://docs.aws.amazon.com/parallelcluster/latest/ug/building-custom-ami-v3.html"
167	                ),
168	                FailureLevel.ERROR,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
184	                (
185	                    "The custom AMI may not have been created by pcluster. "
186	                    "You can ignore this warning if the AMI is shared or copied from another pcluster AMI. "
187	                    "If the AMI is indeed not created by pcluster, cluster creation will fail. "
188	                    "If the cluster creation fails, please go to "
189	                    "https://docs.aws.amazon.com/parallelcluster/latest/ug/troubleshooting.html"
190	                    "#troubleshooting-stack-creation-failures for troubleshooting."
191	                ),
192	                FailureLevel.WARNING,
193	            )
194	        elif tags_dict[PCLUSTER_VERSION_TAG] != current_version:
195	            self._add_failure(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	            self._add_failure(
362	                f"The EC2 instance selected ({instance_type}) supports enhanced networking capabilities using "
363	                "Elastic Fabric Adapter (EFA). EFA enables you to run applications requiring high levels of "
364	                "inter-node communications at scale on AWS at no additional charge. You can update the cluster's "
365	                "configuration to enable EFA (https://docs.aws.amazon.com/parallelcluster/latest/ug/efa-v3.html)",
366	                FailureLevel.WARNING,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
411	                self._add_failure(
412	                    "An EFA requires a security group that allows all inbound and outbound traffic "
413	                    "to and from the security group itself. See "
414	                    "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/efa-start.html#efa-start-security",
415	                    FailureLevel.ERROR,
416	                )
417	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	                    self._add_failure(
155	                        "The specified volume size is larger than snapshot size. In order to use the full capacity "
156	                        "of the volume, you'll need to manually resize the partition according to this doc: "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
348	                    (
349	                        "CapacityReservationId parameter cannot be used with Instances parameter."
350	                        "CapacityReservationId can only be used with the InstanceType parameter "
351	                        "(https://docs.aws.amazon.com/parallelcluster/latest/ug/Scheduling-v3.html#yaml-"
352	                        "Scheduling-SlurmQueues-ComputeResources-InstanceType)."
353	                    ),
354	                    FailureLevel.ERROR,
355	                )
356	            else:
357	                instance_type = instance_types[0]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
467	                self._add_failure(
468	                    f"Capacity reservation resource group ({capacity_reservation_resource_group_arn}) must be a "
469	                    "Service Linked Group created from the AWS CLI.  See "
470	                    f"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/create-cr-group.html for more details.",
471	                    FailureLevel.ERROR,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/instances_validators.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	                    (
167	                        "The EC2 instance type(s) selected ({0}) for the Compute Resource {1} support enhanced "
168	                        "networking capabilities using Elastic Fabric Adapter (EFA). EFA enables you to run "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/instances_validators.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	            self._add_failure(
213	                f"Enabling placement groups for queue: {queue_name} may result in Insufficient Capacity Errors due to "
214	                f"the use of multiple instance types for Compute Resource: {compute_resource_name} ("
215	                f"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/placement-groups.html#placement-groups-cluster).",
216	                FailureLevel.WARNING,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
65	                # Try decoding key value from Base64
66	                decoded_secret = base64.b64decode(secret_value, validate=True)
67	                # Check if the size of the decoding key is within the accepted range

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
65	                # Try decoding key value from Base64
66	                decoded_secret = base64.b64decode(secret_value, validate=True)
67	                # Check if the size of the decoding key is within the accepted range

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
114	                if self.input_as_string
115	                else self.config_parser.read(self.config_file)
116	            )

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
413	            with open(self.output_file, "a", encoding="utf-8"):
414	                os.chmod(self.output_file, stat.S_IRUSR | stat.S_IWUSR)
415	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py:414
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
413	            with open(self.output_file, "a", encoding="utf-8"):
414	                os.chmod(self.output_file, stat.S_IRUSR | stat.S_IWUSR)
415	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
417	            with open(self.output_file, "w", encoding="utf-8") as config_file:
418	                config_file.write(self.comments)
419	                yaml.dump(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
427	        else:
428	            sys.stdout.write(self.comments)
429	            yaml.dump(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_parallelcluster-3.13.0/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py:794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
793	            _error(
794	                "The provided scheduler is no longer supported in AWS ParallelCluster version 3, please check "
795	                "https://docs.aws.amazon.com/parallelcluster/latest/ug/schedulers-v3.html for supported schedulers."
796	            )

--------------------------------------------------

Code scanned:
	Total lines of code: 33623
	Total lines skipped (#nosec): 26

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 32.0
		High: 32.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 59.0
		High: 5.0
Files skipped (0):
