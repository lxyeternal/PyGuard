Run started:2025-04-12 13:43:47.588747

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	    pprint("Injecting crds if needed")
33	    os.popen("kubectl apply -f /crd.yml").read()
34	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
32	    pprint("Injecting crds if needed")
33	    os.popen("kubectl apply -f /crd.yml").read()
34	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
38	    pprint("Starting configmap watches in the background")
39	    threading.Thread(target=watch_configmaps).start()
40	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
144	    result = config.create_kube(cluster, kubetype, overrides=overrides)
145	    kubeconfig = open(f"{clusterdir}/auth/kubeconfig").read()
146	    kubeconfig = base64.b64encode(kubeconfig.encode()).decode("UTF-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
145	    kubeconfig = open(f"{clusterdir}/auth/kubeconfig").read()
146	    kubeconfig = base64.b64encode(kubeconfig.encode()).decode("UTF-8")
147	    result = {'kubeconfig': kubeconfig}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:146
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
145	    kubeconfig = open(f"{clusterdir}/auth/kubeconfig").read()
146	    kubeconfig = base64.b64encode(kubeconfig.encode()).decode("UTF-8")
147	    result = {'kubeconfig': kubeconfig}

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
152	                auth_pass = installparam['auth_pass']
153	                result['auth_pass'] = base64.b64encode(auth_pass.encode()).decode("UTF-8")
154	            if 'virtual_router_id' in installparam:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:153
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
152	                auth_pass = installparam['auth_pass']
153	                result['auth_pass'] = base64.b64encode(auth_pass.encode()).decode("UTF-8")
154	            if 'virtual_router_id' in installparam:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
213	    currentcmd += " | grep ' Ready'"
214	    currentnodes = os.popen(currentcmd).readlines()
215	    if len(currentnodes) != workers:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
218	    pendingcmd = "kubectl get pods -A --field-selector=status.phase=Pending -o yaml"
219	    pending_pods = yaml.safe_load(os.popen(pendingcmd).read())['items']
220	    if len(pending_pods) > threshold:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
218	    pendingcmd = "kubectl get pods -A --field-selector=status.phase=Pending -o yaml"
219	    pending_pods = yaml.safe_load(os.popen(pendingcmd).read())['items']
220	    if len(pending_pods) > threshold:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
228	    currentcmd = "kubectl get pod -A -o yaml"
229	    allpods = yaml.safe_load(os.popen(currentcmd).read())['items']
230	    for pod in allpods:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/controller/handlers.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
228	    currentcmd = "kubectl get pod -A -o yaml"
229	    allpods = yaml.safe_load(os.popen(currentcmd).read())['items']
230	    for pod in allpods:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/create_playbook.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	    with open(f'{playbookdir}/playbook.j2', 'w') as f:
115	        f.write(playbook_template)
116	    env = Environment(loader=FileSystemLoader(playbookdir), extensions=['jinja2.ext.do'],

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/create_playbook.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
114	    with open(f'{playbookdir}/playbook.j2', 'w') as f:
115	        f.write(playbook_template)
116	    env = Environment(loader=FileSystemLoader(playbookdir), extensions=['jinja2.ext.do'],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/create_playbook.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
137	    config_data = {}
138	    config_data['config_host'] = baseconfig.ini[baseconfig.client].get('host', '127.0.0.1')
139	    config_data['config_type'] = config_data.get('config_type', 'kvm')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/create_playbook.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
140	    default_user = getuser() if config_data['config_type'] == 'kvm'\
141	        and config_data['config_host'] in ['localhost', '127.0.0.1'] else 'root'
142	    config_data['config_user'] = config_data.get('config_user', default_user)

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/create_playbook.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
139	    config_data['config_type'] = config_data.get('config_type', 'kvm')
140	    default_user = getuser() if config_data['config_type'] == 'kvm'\
141	        and config_data['config_host'] in ['localhost', '127.0.0.1'] else 'root'

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/create_playbook.py:140
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
139	    config_data['config_type'] = config_data.get('config_type', 'kvm')
140	    default_user = getuser() if config_data['config_type'] == 'kvm'\
141	        and config_data['config_host'] in ['localhost', '127.0.0.1'] else 'root'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/openstack.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
4	network = "mynet"
5	api_ip = "12.0.0.251"
6	ingress_ip = "12.0.0.252"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/extras/openstack.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
5	api_ip = "12.0.0.251"
6	ingress_ip = "12.0.0.252"
7	cidr = "12.0.0.0/24"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	def libvirt_macosx():
33	    return which('brew') is not None and 'libvirt started' in os.popen('brew services list').read()
34	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
32	def libvirt_macosx():
33	    return which('brew') is not None and 'libvirt started' in os.popen('brew services list').read()
34	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	        if os.path.exists(currentplanfile):
209	            self.currentplan = open(currentplanfile).read().strip()
210	        else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
331	            sys.exit(1)
332	        self.host = options.get('host', '127.0.0.1')
333	        if self.host.startswith('http'):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
348	        self.tunneluser = options.get('tunneluser')
349	        if self.tunnelhost is None and self.type == 'kvm' and self.host != '127.0.0.1':
350	            self.tunnelhost = self.host.replace('[', '').replace(']', '')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
997	            with open(default_parameter_file, 'r') as f:
998	                print(f.read().strip())
999	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1022	            with open(default_parameter_file, 'r') as f:
1023	                print(f.read().strip())
1024	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1047	            manifestscmd = "oc get subscriptions.operators.coreos.com -A -o name"
1048	            manifestsdata = os.popen(manifestscmd).read().split('\n')
1049	        else:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1047	            manifestscmd = "oc get subscriptions.operators.coreos.com -A -o name"
1048	            manifestsdata = os.popen(manifestscmd).read().split('\n')
1049	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1052	            manifestscmd = "oc get packagemanifest -n openshift-marketplace -o name"
1053	            manifestsdata = os.popen(manifestscmd).read().split('\n')
1054	        results.extend([entry.replace(header, '') for entry in manifestsdata if entry != ''])

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1052	            manifestscmd = "oc get packagemanifest -n openshift-marketplace -o name"
1053	            manifestsdata = os.popen(manifestscmd).read().split('\n')
1054	        results.extend([entry.replace(header, '') for entry in manifestsdata if entry != ''])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1098
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1097	        with open(f"{directory}/README.md", "w") as f:
1098	            f.write("This is a sample plan for you to understand how to create yours. It showcases:\n\n")
1099	            f.write("- how the plan looks like\n- can optionally use jinja\n- defines default parameters")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1098
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1097	        with open(f"{directory}/README.md", "w") as f:
1098	            f.write("This is a sample plan for you to understand how to create yours. It showcases:\n\n")
1099	            f.write("- how the plan looks like\n- can optionally use jinja\n- defines default parameters")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1098	            f.write("This is a sample plan for you to understand how to create yours. It showcases:\n\n")
1099	            f.write("- how the plan looks like\n- can optionally use jinja\n- defines default parameters")
1100	            f.write("\n- can overrides those parameters at run time")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1098	            f.write("This is a sample plan for you to understand how to create yours. It showcases:\n\n")
1099	            f.write("- how the plan looks like\n- can optionally use jinja\n- defines default parameters")
1100	            f.write("\n- can overrides those parameters at run time")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1099	            f.write("- how the plan looks like\n- can optionally use jinja\n- defines default parameters")
1100	            f.write("\n- can overrides those parameters at run time")
1101	            f.write("\n- can include hardware spec, inject files in different ways or scripts\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1099	            f.write("- how the plan looks like\n- can optionally use jinja\n- defines default parameters")
1100	            f.write("\n- can overrides those parameters at run time")
1101	            f.write("\n- can include hardware spec, inject files in different ways or scripts\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1100	            f.write("\n- can overrides those parameters at run time")
1101	            f.write("\n- can include hardware spec, inject files in different ways or scripts\n")
1102	        with open(f"{directory}/kcli_default.yml", "w") as f:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1100	            f.write("\n- can overrides those parameters at run time")
1101	            f.write("\n- can include hardware spec, inject files in different ways or scripts\n")
1102	        with open(f"{directory}/kcli_default.yml", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1102	        with open(f"{directory}/kcli_default.yml", "w") as f:
1103	            f.write("# Default parameter values for your plan\n# This is a YAML-formatted file\n")
1104	            try:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1102	        with open(f"{directory}/kcli_default.yml", "w") as f:
1103	            f.write("# Default parameter values for your plan\n# This is a YAML-formatted file\n")
1104	            try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1108	        with open(f"{directory}/kcli_parameters.yml.sample", "w") as f:
1109	            f.write("# Optional runtime parameter values for your plan\n# This is a YAML-formatted file\n")
1110	            try:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1108	        with open(f"{directory}/kcli_parameters.yml.sample", "w") as f:
1109	            f.write("# Optional runtime parameter values for your plan\n# This is a YAML-formatted file\n")
1110	            try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1135	        with open(f"{directory}/kcli_plan.yml", "w") as f:
1136	            f.write(plantemplatedata)
1137	        if not skipscripts:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1135	        with open(f"{directory}/kcli_plan.yml", "w") as f:
1136	            f.write(plantemplatedata)
1137	        if not skipscripts:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1139	            with open(f"{directory}/scripts/script01.sh", "w") as f:
1140	                f.write(script01data)
1141	            script02data = '#!/bin/bash\necho i am vm {{ name }} >/tmp/plan.txt'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1139	            with open(f"{directory}/scripts/script01.sh", "w") as f:
1140	                f.write(script01data)
1141	            script02data = '#!/bin/bash\necho i am vm {{ name }} >/tmp/plan.txt'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1142	            with open(f"{directory}/scripts/script02.sh", "w") as f:
1143	                f.write(script02data)
1144	        if not skipfiles:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1142	            with open(f"{directory}/scripts/script02.sh", "w") as f:
1143	                f.write(script02data)
1144	        if not skipfiles:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1146	            with open(f"{directory}/files/myfile01", "w") as f:
1147	                f.write(myfile01data)
1148	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1146	            with open(f"{directory}/files/myfile01", "w") as f:
1147	                f.write(myfile01data)
1148	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1241	            if not render:
1242	                content = open(origin, 'r').read()
1243	            rendered = content or self.process_inputfile(workflow, origin, overrides=overrides)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1251	                pprint(f"Copying rendered file {filename} to {destfile}")
1252	                f.write(rendered)
1253	                os.chmod(destfile, stat.S_IMODE(os.stat(origin).st_mode))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1251	                pprint(f"Copying rendered file {filename} to {destfile}")
1252	                f.write(rendered)
1253	                os.chmod(destfile, stat.S_IMODE(os.stat(origin).st_mode))

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1252	                f.write(rendered)
1253	                os.chmod(destfile, stat.S_IMODE(os.stat(origin).st_mode))
1254	            treatedfiles.append(origin)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1253
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1252	                f.write(rendered)
1253	                os.chmod(destfile, stat.S_IMODE(os.stat(origin).st_mode))
1254	            treatedfiles.append(origin)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1262	            with open(destfile, 'w') as f:
1263	                f.write(rendered)
1264	                os.chmod(destfile, stat.S_IMODE(os.stat(entry).st_mode))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1262	            with open(destfile, 'w') as f:
1263	                f.write(rendered)
1264	                os.chmod(destfile, stat.S_IMODE(os.stat(entry).st_mode))

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1263	                f.write(rendered)
1264	                os.chmod(destfile, stat.S_IMODE(os.stat(entry).st_mode))
1265	        finalscripts = []

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1264
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1263	                f.write(rendered)
1264	                os.chmod(destfile, stat.S_IMODE(os.stat(entry).st_mode))
1265	        finalscripts = []

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1290	            with open(destfile, 'w') as f:
1291	                f.write(rendered)
1292	            finalscripts.append(scriptname)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1290	            with open(destfile, 'w') as f:
1291	                f.write(rendered)
1292	            finalscripts.append(scriptname)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1296	            with open(destfile, 'w') as f:
1297	                f.write(cmdscontent)
1298	            finalscripts.append('cmds.sh')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1296	            with open(destfile, 'w') as f:
1297	                f.write(cmdscontent)
1298	            finalscripts.append('cmds.sh')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1306	                         tunneluser=tunneluser, vmport=vmport)
1307	            os.system(scpcmd)
1308	            cmd = [f"cd {remotedir}"]

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1307
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1306	                         tunneluser=tunneluser, vmport=vmport)
1307	            os.system(scpcmd)
1308	            cmd = [f"cd {remotedir}"]

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1315	                             tunnelport=tunnelport, tunneluser=tunneluser, vmport=vmport, insecure=True)
1316	            os.system(sshcommand)
1317	        else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1316
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1315	                             tunnelport=tunnelport, tunneluser=tunneluser, vmport=vmport, insecure=True)
1316	            os.system(sshcommand)
1317	        else:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1319	            for script in finalscripts:
1320	                os.chmod(script, 0o700)
1321	                pprint(f"Running script {script} locally")

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1320
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1319	            for script in finalscripts:
1320	                os.chmod(script, 0o700)
1321	                pprint(f"Running script {script} locally")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1385	        with TemporaryDirectory() as tmpdir:
1386	            if self.type == 'kvm' and self.ini[self.client].get('host', 'localhost') in ['localhost', '127.0.0.1']:
1387	                oriconf = f"{tmpdir}/.kcli"

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
1390	                os.mkdir(orissh)
1391	                kvm_overrides = {'network': network, 'user': getuser(), 'client': self.client}
1392	                kcliconf = self.process_inputfile('xxx', f"{plandir}/local_kcli_conf.j2", overrides=kvm_overrides)

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1391
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
1390	                os.mkdir(orissh)
1391	                kvm_overrides = {'network': network, 'user': getuser(), 'client': self.client}
1392	                kcliconf = self.process_inputfile('xxx', f"{plandir}/local_kcli_conf.j2", overrides=kvm_overrides)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1393	                with open(f"{oriconf}/config.yml", 'w') as _f:
1394	                    _f.write(kcliconf)
1395	                if secure:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1393	                with open(f"{oriconf}/config.yml", 'w') as _f:
1394	                    _f.write(kcliconf)
1395	                if secure:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1400	                    with open(authorized_keys_file, file_mode) as f:
1401	                        publickey = open(f"{orissh}/id_rsa.pub").read().strip()
1402	                        f.write(f"\n{publickey}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1401	                        publickey = open(f"{orissh}/id_rsa.pub").read().strip()
1402	                        f.write(f"\n{publickey}")
1403	                else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1401	                        publickey = open(f"{orissh}/id_rsa.pub").read().strip()
1402	                        f.write(f"\n{publickey}")
1403	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1422	                with open(f"{oriconf}/config.yml", 'w') as _f:
1423	                    _f.write(kcliconf)
1424	            if dest is not None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1422	                with open(f"{oriconf}/config.yml", 'w') as _f:
1423	                    _f.write(kcliconf)
1424	            if dest is not None:

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
1447	            warning("ssl support requires installing manually pyopenssl and cherrypy")
1448	        root = os.getuid() == 0
1449	        if root:

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1448
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1447	            warning("ssl support requires installing manually pyopenssl and cherrypy")
1448	        root = os.getuid() == 0
1449	        if root:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1467	        with open(service_file, "w") as f:
1468	            f.write(sushydata)
1469	        user_space = "--user" if not root else ""

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1467	        with open(service_file, "w") as f:
1468	            f.write(sushydata)
1469	        user_space = "--user" if not root else ""

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1480	            with open(service_file, "w") as f:
1481	                f.write(isoremoverdata)
1482	            cmd = f"systemctl {user_space} restart" if update else f"systemctl {user_space} enable --now"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1480	            with open(service_file, "w") as f:
1481	                f.write(isoremoverdata)
1482	            cmd = f"systemctl {user_space} restart" if update else f"systemctl {user_space} enable --now"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1492	        with open("/usr/lib/systemd/system/kweb.service", "w") as f:
1493	            f.write(webdata)
1494	        cmd = "systemctl restart kweb" if update else "systemctl enable --now kweb"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1492	        with open("/usr/lib/systemd/system/kweb.service", "w") as f:
1493	            f.write(webdata)
1494	        cmd = "systemctl restart kweb" if update else "systemctl enable --now kweb"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1591	            try:
1592	                version = os.popen(f'KUBECONFIG={kubeconfig} oc get clusterversion --no-headers').read().strip()
1593	            except:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1591	            try:
1592	                version = os.popen(f'KUBECONFIG={kubeconfig} oc get clusterversion --no-headers').read().strip()
1593	            except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1598	            try:
1599	                version = yaml.safe_load(os.popen(server_command).read())['serverVersion']['gitVersion']
1600	            except:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1598	            try:
1599	                version = yaml.safe_load(os.popen(server_command).read())['serverVersion']['gitVersion']
1600	            except:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/baseconfig.py:1603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1602	        try:
1603	            for entry in os.popen(nodes_command).readlines():
1604	                node = [column.strip() for column in entry.split()[0:6]]

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
877	        def decorator(callback):
878	            if isinstance(callback, str): callback = load(callback)
879	            for rule in makelist(path) or yieldroutes(callback):

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:927
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
926	        def decorator(callback):
927	            if isinstance(callback, str): callback = load(callback)
928	            self.error_handler[int(code)] = callback

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
967	            stacktrace = format_exc()
968	            environ['wsgi.errors'].write(stacktrace)
969	            environ['wsgi.errors'].flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
967	            stacktrace = format_exc()
968	            environ['wsgi.errors'].write(stacktrace)
969	            environ['wsgi.errors'].flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1072	                       % (html_escape(repr(E)), html_escape(format_exc()))
1073	            environ['wsgi.errors'].write(err)
1074	            environ['wsgi.errors'].flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1072	                       % (html_escape(repr(E)), html_escape(format_exc()))
1073	            environ['wsgi.errors'].write(err)
1074	            environ['wsgi.errors'].flush()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1176	                hash = hmac.new(tob(secret), msg, digestmod=digestmod).digest()
1177	                if _lscmp(sig, base64.b64encode(hash)):
1178	                    dst = pickle.loads(base64.b64decode(msg))

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1177
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1176	                hash = hmac.new(tob(secret), msg, digestmod=digestmod).digest()
1177	                if _lscmp(sig, base64.b64encode(hash)):
1178	                    dst = pickle.loads(base64.b64decode(msg))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1177	                if _lscmp(sig, base64.b64encode(hash)):
1178	                    dst = pickle.loads(base64.b64decode(msg))
1179	                    if dst and dst[0] == key:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1178
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1177	                if _lscmp(sig, base64.b64encode(hash)):
1178	                    dst = pickle.loads(base64.b64decode(msg))
1179	                    if dst and dst[0] == key:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1252	        while maxread:
1253	            part = read(min(maxread, bufsize))
1254	            if not part: break

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1262	        while True:
1263	            header = read(1)
1264	            while header[-2:] != rn:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1264	            while header[-2:] != rn:
1265	                c = read(1)
1266	                header += c

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1277	                if not buff:
1278	                    buff = read(min(maxread, bufsize))
1279	                part, buff = buff[:maxread], buff[maxread:]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1282	                maxread -= len(part)
1283	            if read(2) != rn:
1284	                raise err

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1295	        for part in body_iter(read_func, self.MEMFILE_MAX):
1296	            body.write(part)
1297	            body_size += len(part)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1295	        for part in body_iter(read_func, self.MEMFILE_MAX):
1296	            body.write(part)
1297	            body_size += len(part)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1299	                body, tmp = NamedTemporaryFile(mode='w+b'), body
1300	                body.write(tmp.getvalue())
1301	                del tmp

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1299	                body, tmp = NamedTemporaryFile(mode='w+b'), body
1300	                body.write(tmp.getvalue())
1301	                del tmp

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1311	            raise HTTPError(413, 'Request entity too large')
1312	        data = self.body.read(maxread + 1)
1313	        if len(data) > maxread:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1364	            else:
1365	                post[part.name] = FileUpload(part.file, part.name,
1366	                                            part.filename, part.headerlist)
1367	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1389	            # HTTP 1.1 requires a Host-header. This is for HTTP/1.0 clients.
1390	            host = env.get('SERVER_NAME', '127.0.0.1')
1391	            port = env.get('SERVER_PORT')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1812	                            "JSON strings are fine, too.")
1813	            encoded = base64.b64encode(pickle.dumps([name, value], -1))
1814	            sig = base64.b64encode(hmac.new(tob(secret), encoded,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1813
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1812	                            "JSON strings are fine, too.")
1813	            encoded = base64.b64encode(pickle.dumps([name, value], -1))
1814	            sig = base64.b64encode(hmac.new(tob(secret), encoded,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1813	            encoded = base64.b64encode(pickle.dumps([name, value], -1))
1814	            sig = base64.b64encode(hmac.new(tob(secret), encoded,
1815	                                            digestmod=digestmod).digest())
1816	            value = touni(b'!' + sig + b'?' + encoded)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:1814
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1813	            encoded = base64.b64encode(pickle.dumps([name, value], -1))
1814	            sig = base64.b64encode(hmac.new(tob(secret), encoded,
1815	                                            digestmod=digestmod).digest())
1816	            value = touni(b'!' + sig + b'?' + encoded)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
2278	        """
2279	        config_obj = load(name)
2280	        obj = {key: getattr(config_obj, key)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2307	        conf = configparser.ConfigParser(**options)
2308	        conf.read(filename)
2309	        for section in conf.sections():

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2518	        buff, read = self.buffer_size, self.read
2519	        part = read(buff)
2520	        while part:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2521	            yield part
2522	            part = read(buff)
2523	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2666	        while 1:
2667	            buf = read(chunk_size)
2668	            if not buf: break

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2668	            if not buf: break
2669	            write(buf)
2670	        self.file.seek(offset)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2668	            if not buf: break
2669	            write(buf)
2670	        self.file.seek(offset)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2716	    while limit > 0:
2717	        part = fp.read(min(limit, bufsize))
2718	        if not part:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2876
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
2875	        if method.lower() == 'basic':
2876	            user, pwd = touni(base64.b64decode(tob(data))).split(':', 1)
2877	            return user, pwd

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2876
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
2875	        if method.lower() == 'basic':
2876	            user, pwd = touni(base64.b64decode(tob(data))).split(':', 1)
2877	            return user, pwd

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2961
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
2960	    digestmod = digestmod or hashlib.sha256
2961	    msg = base64.b64encode(pickle.dumps(data, -1))
2962	    sig = base64.b64encode(hmac.new(tob(key), msg, digestmod=digestmod).digest())

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2961
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
2960	    digestmod = digestmod or hashlib.sha256
2961	    msg = base64.b64encode(pickle.dumps(data, -1))
2962	    sig = base64.b64encode(hmac.new(tob(key), msg, digestmod=digestmod).digest())

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
2961	    msg = base64.b64encode(pickle.dumps(data, -1))
2962	    sig = base64.b64encode(hmac.new(tob(key), msg, digestmod=digestmod).digest())
2963	    return b'!' + sig + b'?' + msg

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2962
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
2961	    msg = base64.b64encode(pickle.dumps(data, -1))
2962	    sig = base64.b64encode(hmac.new(tob(key), msg, digestmod=digestmod).digest())
2963	    return b'!' + sig + b'?' + msg

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2975
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
2974	        hashed = hmac.new(tob(key), msg, digestmod=digestmod).digest()
2975	        if _lscmp(sig[1:], base64.b64encode(hashed)):
2976	            return pickle.loads(base64.b64decode(msg))

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2975
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
2974	        hashed = hmac.new(tob(key), msg, digestmod=digestmod).digest()
2975	        if _lscmp(sig[1:], base64.b64encode(hashed)):
2976	            return pickle.loads(base64.b64decode(msg))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
2975	        if _lscmp(sig[1:], base64.b64encode(hashed)):
2976	            return pickle.loads(base64.b64decode(msg))
2977	    return None

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:2976
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
2975	        if _lscmp(sig[1:], base64.b64encode(hashed)):
2976	            return pickle.loads(base64.b64decode(msg))
2977	    return None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3152	        while True:
3153	            chunk = read(maxbuf if maxread < 0 else min(maxbuf, maxread))
3154	            maxread -= len(chunk)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3279	        self.size += len(line) + len(self._buf)
3280	        self.file.write(self._buf + line)
3281	        self._buf = nl

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3279	        self.size += len(line) + len(self._buf)
3280	        self.file.write(self._buf + line)
3281	        self._buf = nl

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3292	            while copied < maxcopy:
3293	                chunk = read(min(chunksize, maxcopy - copied))
3294	                write(chunk)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3293	                chunk = read(min(chunksize, maxcopy - copied))
3294	                write(chunk)
3295	                copied += len(chunk)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3293	                chunk = read(min(chunksize, maxcopy - copied))
3294	                write(chunk)
3295	                copied += len(chunk)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3338	        try:
3339	            return self.file.read()
3340	        finally:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3358	
3359	    def __init__(self, host='127.0.0.1', port=8080, **options):
3360	        self.options = options

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3371	        elif ':' in self.host:
3372	            return "http://[%s]:%d/" % (self.host, self.port)
3373	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3373	        else:
3374	            return "http://%s:%d/" % (self.host, self.port)
3375	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3412	                if not self.quiet:
3413	                    return WSGIRequestHandler.log_request(*args, **kw)
3414	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3429	        except KeyboardInterrupt:
3430	            self.srv.server_close()  # Prevent ResourceWarning: unclosed socket
3431	            raise

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
3536	        container = tornado.wsgi.WSGIContainer(handler)
3537	        server = tornado.httpserver.HTTPServer(container)
3538	        server.listen(port=self.port, address=self.host)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3600	            import signal
3601	            signal.signal(signal.SIGINT, lambda s, f: server.stop())
3602	        server.serve_forever()

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3601
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
3600	            import signal
3601	            signal.signal(signal.SIGINT, lambda s, f: server.stop())
3602	        server.serve_forever()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3688	            import signal
3689	            signal.signal(signal.SIGINT, lambda s, f: self.loop.stop())
3690	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3689
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
3688	            import signal
3689	            signal.signal(signal.SIGINT, lambda s, f: self.loop.stop())
3690	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
3770	    try:
3771	        rv = load(target)  # Import the target module
3772	        return rv if callable(rv) else tmp

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3782	        server='wsgiref',
3783	        host='127.0.0.1',
3784	        port=8080,
3785	        interval=1,
3786	        reloader=False,
3787	        quiet=False,
3788	        plugins=None,
3789	        debug=None,
3790	        config=None, **kargs):
3791	    """ Start a server instance. This method blocks until the server terminates.
3792	
3793	        :param app: WSGI application or target string supported by

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3820	        try:
3821	            os.close(fd)  # We never write to this file
3822	            while os.path.exists(lockfile):

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3847
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
3846	            if isinstance(plugin, str):
3847	                plugin = load(plugin)
3848	            app.install(plugin)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
3855	        if isinstance(server, str):
3856	            server = load(server)
3857	        if isinstance(server, type):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3870	            lockfile = os.environ.get('BOTTLE_LOCKFILE')
3871	            bgcheck = FileCheckerThread(lockfile, interval)
3872	            with bgcheck:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
3870	            lockfile = os.environ.get('BOTTLE_LOCKFILE')
3871	            bgcheck = FileCheckerThread(lockfile, interval)
3872	            with bgcheck:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3961	        self.name = name
3962	        self.source = source.read() if hasattr(source, 'read') else source
3963	        self.filename = source.filename if hasattr(source, 'filename') else None

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:3962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
3961	        self.name = name
3962	        self.source = source.read() if hasattr(source, 'read') else source
3963	        self.filename = source.filename if hasattr(source, 'filename') else None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:4091
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4090	        with open(fname, "rb") as f:
4091	            return (f.read().decode(self.encoding), fname, lambda: False)
4092	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:4091
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
4090	        with open(fname, "rb") as f:
4091	            return (f.read().decode(self.encoding), fname, lambda: False)
4092	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:4116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4115	            with open(self.filename, 'rb') as f:
4116	                source = f.read()
4117	        try:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:4116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
4115	            with open(self.filename, 'rb') as f:
4116	                source = f.read()
4117	        try:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:4151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
4150	        })
4151	        exec(self.co, env)
4152	        if env.get('_rebase'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:4542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4541	                with open(cfile, 'rb') as fp:
4542	                    config.load_dict(json_loads(fp.read()))
4543	            else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/bottle.py:4542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
4541	                with open(cfile, 'rb') as fp:
4542	                    config.load_dict(json_loads(fp.read()))
4543	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
135	        try:
136	            response = json.loads(urlopen("https://api.github.com/repos/karmab/kcli/commits/main", timeout=5).read())
137	            upstream_version = response['sha'][:7]

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
135	        try:
136	            response = json.loads(urlopen("https://api.github.com/repos/karmab/kcli/commits/main", timeout=5).read())
137	            upstream_version = response['sha'][:7]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
135	        try:
136	            response = json.loads(urlopen("https://api.github.com/repos/karmab/kcli/commits/main", timeout=5).read())
137	            upstream_version = response['sha'][:7]

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
387	                                 tunneluser=config.tunneluser, insecure=True, cmd=cmd, vmport=vmport)
388	                    os.system(sshcmd)
389	                else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:388
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
387	                                 tunneluser=config.tunneluser, insecure=True, cmd=cmd, vmport=vmport)
388	                    os.system(sshcmd)
389	                else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
401	                            pprint(f"Deleting directory {clusterdir}")
402	                            rmtree(clusterdir)
403	                        else:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
405	                            nodescmd = f'{binary} get node -o name'
406	                            nodes = [n.strip().replace('node/', '') for n in os.popen(nodescmd).readlines()]
407	                            for node in nodes:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
549	        with open(f'kubeconfig.{kube}', 'w') as f:
550	            f.write(kubeconfig)
551	    else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
549	        with open(f'kubeconfig.{kube}', 'w') as f:
550	            f.write(kubeconfig)
551	    else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2462	    client_data['config_type'] = client_data.get('config_type', 'kvm')
2463	    client_data['config_host'] = client_data.get('config_host', '127.0.0.1')
2464	    default_user = getuser() if client_data['config_type'] == 'kvm'\

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2464	    default_user = getuser() if client_data['config_type'] == 'kvm'\
2465	        and client_data['config_host'] in ['localhost', '127.0.0.1'] else 'root'
2466	    client_data['config_user'] = client_data.get('config_user', default_user)

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
2463	    client_data['config_host'] = client_data.get('config_host', '127.0.0.1')
2464	    default_user = getuser() if client_data['config_type'] == 'kvm'\
2465	        and client_data['config_host'] in ['localhost', '127.0.0.1'] else 'root'

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2464
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
2463	    client_data['config_host'] = client_data.get('config_host', '127.0.0.1')
2464	    default_user = getuser() if client_data['config_type'] == 'kvm'\
2465	        and client_data['config_host'] in ['localhost', '127.0.0.1'] else 'root'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2525	                with open(f"{hostnamedir}/runcmd", 'w') as f:
2526	                    f.write('\n'.join(runcmd))
2527	                for _file in write_files:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2525	                with open(f"{hostnamedir}/runcmd", 'w') as f:
2526	                    f.write('\n'.join(runcmd))
2527	                for _file in write_files:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2536	                        with open(f"{hostnamedir}/{os.path.dirname(path)}/{os.path.basename(path)}", 'w') as f:
2537	                            f.write(content)
2538	                    else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2536	                        with open(f"{hostnamedir}/{os.path.dirname(path)}/{os.path.basename(path)}", 'w') as f:
2537	                            f.write(content)
2538	                    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2539	                        with open(f"{hostnamedir}/{path}", 'w') as f:
2540	                            f.write(content)
2541	        if outputdir is not None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2539	                        with open(f"{hostnamedir}/{path}", 'w') as f:
2540	                            f.write(content)
2541	        if outputdir is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2543	            with open(f"{outputdir}/kcli_plan.yml", 'w') as f:
2544	                f.write(renderplan)
2545	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2543	            with open(f"{outputdir}/kcli_plan.yml", 'w') as f:
2544	                f.write(renderplan)
2545	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2648	        if which('ssh') is not None:
2649	            code = os.WEXITSTATUS(os.system(sshcommand))
2650	            sys.exit(code)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2649
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
2648	        if which('ssh') is not None:
2649	            code = os.WEXITSTATUS(os.system(sshcommand))
2650	            sys.exit(code)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2702	            vmport = ip
2703	            ip = '127.0.0.1'
2704	        scpcommand = common.scp(name, ip=ip, user=user, source=source, destination=destination, recursive=recursive,

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2709	        if which('scp') is not None:
2710	            os.system(scpcommand)
2711	        else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cli.py:2710
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
2709	        if which('scp') is not None:
2710	            os.system(scpcommand)
2711	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/aks/__init__.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
27	    with open(f"{clusterdir}/auth/kubeconfig", 'wb') as f:
28	        f.write(kubeconfig)
29	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/aks/__init__.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	    if not pub_key.startswith('ssh-') and os.path.exists(pub_key):
87	        pub_key = open(pub_key).read().strip()
88	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/eks/__init__.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	    with open(f"{clusterdir}/auth/kubeconfig", 'w') as f:
81	        f.write(config_text)
82	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/gke/__init__.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	def _wait_for_operation(client, location):
10	    location = location.replace('https://container.googleapis.com/v1/', '')
11	    done = False

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/gke/__init__.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
43	    with open(f"{clusterdir}/auth/kubeconfig", 'w') as f:
44	        f.write(rendered)
45	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	    request = Request(f"https://{p.netloc}/redfish/v1", headers=headers)
77	    oem = json.loads(urlopen(request).read())['Oem']
78	    model = "dell" if 'Dell' in oem else "hp" if 'Hpe' in oem else 'supermicro' if 'Supermicro' in oem else 'N/A'

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
76	    request = Request(f"https://{p.netloc}/redfish/v1", headers=headers)
77	    oem = json.loads(urlopen(request).read())['Oem']
78	    model = "dell" if 'Dell' in oem else "hp" if 'Hpe' in oem else 'supermicro' if 'Supermicro' in oem else 'N/A'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	            bmc_data = config.process_inputfile(cluster, f"{plandir}/bmc.yml.j2", overrides=bmc_overrides)
121	            f.write(bmc_data)
122	            if 'addresses' in host:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
120	            bmc_data = config.process_inputfile(cluster, f"{plandir}/bmc.yml.j2", overrides=bmc_overrides)
121	            f.write(bmc_data)
122	            if 'addresses' in host:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
135	        with open(f"{clusterdir}/nmstateconfig.yml", 'w') as f:
136	            f.write(nmstatedata)
137	        nmcmd = f"oc create -f {clusterdir}/nmstateconfig.yml"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
135	        with open(f"{clusterdir}/nmstateconfig.yml", 'w') as f:
136	            f.write(nmstatedata)
137	        nmcmd = f"oc create -f {clusterdir}/nmstateconfig.yml"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	    with open('iso.ign', 'w') as f:
149	        f.write(iso_data)
150	    iso_pool = data.get('pool') or config.pool

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
148	    with open('iso.ign', 'w') as f:
149	        f.write(iso_data)
150	    iso_pool = data.get('pool') or config.pool

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
159	        svcip_cmd = 'oc get node -o yaml'
160	        svcip = safe_load(os.popen(svcip_cmd).read())['items'][0]['status']['addresses'][0]['address']
161	        svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
159	        svcip_cmd = 'oc get node -o yaml'
160	        svcip = safe_load(os.popen(svcip_cmd).read())['items'][0]['status']['addresses'][0]['address']
161	        svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	        svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'
162	        svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
163	        podname = os.popen('oc -n default get pod -l app=httpd-kcli -o name').read().split('/')[1].strip()

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
161	        svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'
162	        svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
163	        podname = os.popen('oc -n default get pod -l app=httpd-kcli -o name').read().split('/')[1].strip()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
162	        svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
163	        podname = os.popen('oc -n default get pod -l app=httpd-kcli -o name').read().split('/')[1].strip()
164	        try:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
162	        svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
163	        podname = os.popen('oc -n default get pod -l app=httpd-kcli -o name').read().split('/')[1].strip()
164	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
185	    with open(f"{clusterdir}/nodepools.yaml", 'w') as f:
186	        f.write(nodepoolfile)
187	    cmcmd = f"oc create -f {clusterdir}/nodepools.yaml"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
185	    with open(f"{clusterdir}/nodepools.yaml", 'w') as f:
186	        f.write(nodepoolfile)
187	    cmcmd = f"oc create -f {clusterdir}/nodepools.yaml"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
199	        with open(f"{clusterdir}/ignition_{nodepool}.sh", 'w') as f:
200	            f.write(ignitionscript)
201	        ignition_worker = f"{clusterdir}/nodepool_{nodepool}.ign"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
199	        with open(f"{clusterdir}/ignition_{nodepool}.sh", 'w') as f:
200	            f.write(ignitionscript)
201	        ignition_worker = f"{clusterdir}/nodepool_{nodepool}.ign"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
230	        namespace = data['namespace']
231	        assisted = cluster in os.popen(f'oc get -n {namespace}-{cluster} infraenv {cluster}').read().strip()
232	        if not assisted:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
230	        namespace = data['namespace']
231	        assisted = cluster in os.popen(f'oc get -n {namespace}-{cluster} infraenv {cluster}').read().strip()
232	        if not assisted:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
243	            with open(f"{clusterdir}/ignition.sh", 'w') as f:
244	                f.write(ignitionscript)
245	            call(f'bash {clusterdir}/ignition.sh', shell=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
243	            with open(f"{clusterdir}/ignition.sh", 'w') as f:
244	                f.write(ignitionscript)
245	            call(f'bash {clusterdir}/ignition.sh', shell=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
261	        nodepool_cmd = "oc get nodepool -n %s %s -o jsonpath='{.spec.release.image}'" % (namespace, cluster)
262	        nodepool_image = os.popen(nodepool_cmd).read()
263	        process_nodepools(config, plandir, namespace, cluster, platform, nodepools, nodepool_image, overrides)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
261	        nodepool_cmd = "oc get nodepool -n %s %s -o jsonpath='{.spec.release.image}'" % (namespace, cluster)
262	        nodepool_image = os.popen(nodepool_cmd).read()
263	        process_nodepools(config, plandir, namespace, cluster, platform, nodepools, nodepool_image, overrides)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
264	    nodepool = overrides.get('nodepool') or cluster
265	    if os.popen(f"oc get nodepool -n {namespace} {nodepool} -o name").read() == "":
266	        msg = f"Issue with nodepool {nodepool}..."

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
264	    nodepool = overrides.get('nodepool') or cluster
265	    if os.popen(f"oc get nodepool -n {namespace} {nodepool} -o name").read() == "":
266	        msg = f"Issue with nodepool {nodepool}..."

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
313	            replicas_cmd = "oc get nodepool -n %s %s -o jsonpath='{.spec.replicas}'" % (namespace, nodepool)
314	            replicas = int(os.popen(replicas_cmd).read()) + len(baremetal_hosts)
315	            pprint(f"Setting replicas to {replicas} in nodepool {nodepool}")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
313	            replicas_cmd = "oc get nodepool -n %s %s -o jsonpath='{.spec.replicas}'" % (namespace, nodepool)
314	            replicas = int(os.popen(replicas_cmd).read()) + len(baremetal_hosts)
315	            pprint(f"Setting replicas to {replicas} in nodepool {nodepool}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
323	                svcip_cmd = 'oc get node -o yaml'
324	                svcip = safe_load(os.popen(svcip_cmd).read())['items'][0]['status']['addresses'][0]['address']
325	                svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
323	                svcip_cmd = 'oc get node -o yaml'
324	                svcip = safe_load(os.popen(svcip_cmd).read())['items'][0]['status']['addresses'][0]['address']
325	                svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
325	                svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'
326	                svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
327	                iso_url = f'http://{svcip}:{svcport}/{cluster}-worker.iso'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
325	                svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'
326	                svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
327	                iso_url = f'http://{svcip}:{svcport}/{cluster}-worker.iso'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
409	    default_sc = False
410	    for sc in safe_load(os.popen('oc get sc -o yaml').read()).get('items', []):
411	        if 'annotations' in sc['metadata']\

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
409	    default_sc = False
410	    for sc in safe_load(os.popen('oc get sc -o yaml').read()).get('items', []):
411	        if 'annotations' in sc['metadata']\

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
418	    kubevirt_crd_cmd = 'oc get crd hyperconvergeds.hco.kubevirt.io -o yaml 2>/dev/null'
419	    if kubevirt and safe_load(os.popen(kubevirt_crd_cmd).read()) is None:
420	        warning("Kubevirt not fully installed. Installing it for you")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
418	    kubevirt_crd_cmd = 'oc get crd hyperconvergeds.hco.kubevirt.io -o yaml 2>/dev/null'
419	    if kubevirt and safe_load(os.popen(kubevirt_crd_cmd).read()) is None:
420	        warning("Kubevirt not fully installed. Installing it for you")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
430	    assisted_crd_cmd = 'oc -n multicluster-engine get pod -l app=assisted-service -o name 2>/dev/null'
431	    need_hypershift = safe_load(os.popen(hosted_crd_cmd).read()) is None
432	    need_assisted = assisted and safe_load(os.popen(assisted_crd_cmd).read()) is None

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
430	    assisted_crd_cmd = 'oc -n multicluster-engine get pod -l app=assisted-service -o name 2>/dev/null'
431	    need_hypershift = safe_load(os.popen(hosted_crd_cmd).read()) is None
432	    need_assisted = assisted and safe_load(os.popen(assisted_crd_cmd).read()) is None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
431	    need_hypershift = safe_load(os.popen(hosted_crd_cmd).read()) is None
432	    need_assisted = assisted and safe_load(os.popen(assisted_crd_cmd).read()) is None
433	    need_mce = (need_hypershift and not upstream) or need_assisted

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
431	    need_hypershift = safe_load(os.popen(hosted_crd_cmd).read()) is None
432	    need_assisted = assisted and safe_load(os.popen(assisted_crd_cmd).read()) is None
433	    need_mce = (need_hypershift and not upstream) or need_assisted

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
447	        sleep(240)
448	        if assisted and safe_load(os.popen(assisted_crd_cmd).read()) is None:
449	            return {'result': 'failure', 'reason': "Couldnt install assisted via mce properly"}

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
447	        sleep(240)
448	        if assisted and safe_load(os.popen(assisted_crd_cmd).read()) is None:
449	            return {'result': 'failure', 'reason': "Couldnt install assisted via mce properly"}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
461	            sleep(120)
462	    if safe_load(os.popen(hosted_crd_cmd).read()) is None:
463	        return {'result': 'failure', 'reason': "Couldnt install hypershift properly"}

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
461	            sleep(120)
462	    if safe_load(os.popen(hosted_crd_cmd).read()) is None:
463	        return {'result': 'failure', 'reason': "Couldnt install hypershift properly"}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
464	    registry = 'quay.io'
465	    management_image = os.popen("oc get clusterversion version -o jsonpath='{.status.desired.image}'").read()
466	    prefixes = ['quay.io', 'registry.ci']

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
464	    registry = 'quay.io'
465	    management_image = os.popen("oc get clusterversion version -o jsonpath='{.status.desired.image}'").read()
466	    prefixes = ['quay.io', 'registry.ci']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
470	        data['registry'] = disconnected_url
471	        if disconnected_url not in open(pull_secret).read():
472	            msg = f"entry for {disconnected_url} missing in pull secret"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
476	        hypershift_info += "grep hypershift | awk '{print $2}' | cut -d@ -f2"
477	        hypershift_tag = os.popen(hypershift_info).read().strip()
478	        mco_info = f"oc adm release info --insecure --pullspecs -a {pull_secret} | "

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
476	        hypershift_info += "grep hypershift | awk '{print $2}' | cut -d@ -f2"
477	        hypershift_tag = os.popen(hypershift_info).read().strip()
478	        mco_info = f"oc adm release info --insecure --pullspecs -a {pull_secret} | "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
479	        mco_info += "grep machine-config-operator | awk '{print $2'} | cut -d@ -f2"
480	        mco_tag = os.popen(mco_info).read().strip()
481	        disconnected_data = {'disconnected_url': disconnected_url, 'hypershift_tag': hypershift_tag, 'mco_tag': mco_tag}

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
479	        mco_info += "grep machine-config-operator | awk '{print $2'} | cut -d@ -f2"
480	        mco_tag = os.popen(mco_info).read().strip()
481	        disconnected_data = {'disconnected_url': disconnected_url, 'hypershift_tag': hypershift_tag, 'mco_tag': mco_tag}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
483	        with open(f"{clusterdir}/disconnected.sh", 'w') as f:
484	            f.write(disconnectedfile)
485	        call(f'bash {clusterdir}/disconnected.sh', shell=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
483	        with open(f"{clusterdir}/disconnected.sh", 'w') as f:
484	            f.write(disconnectedfile)
485	        call(f'bash {clusterdir}/disconnected.sh', shell=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
487	        cacmd = "oc -n openshift-config get cm user-ca-bundle -o jsonpath='{.data.ca-bundle\\.crt}'"
488	        data['ca'] = os.popen(cacmd).read().strip()
489	        data['operator_disconnected_image'] = f'{disconnected_url}/openshift/release@{hypershift_tag}'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
487	        cacmd = "oc -n openshift-config get cm user-ca-bundle -o jsonpath='{.data.ca-bundle\\.crt}'"
488	        data['ca'] = os.popen(cacmd).read().strip()
489	        data['operator_disconnected_image'] = f'{disconnected_url}/openshift/release@{hypershift_tag}'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
491	    data['basedir'] = '/workdir' if container_mode() else '.'
492	    supported_data = safe_load(os.popen("oc get cm/supported-versions -o yaml -n hypershift").read())
493	    if use_management_version:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
491	    data['basedir'] = '/workdir' if container_mode() else '.'
492	    supported_data = safe_load(os.popen("oc get cm/supported-versions -o yaml -n hypershift").read())
493	    if use_management_version:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
493	    if use_management_version:
494	        tag = os.popen("oc get clusterversion version -o jsonpath='{.status.desired.version}'").read()
495	        pprint(f"Using tag {tag}")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
493	    if use_management_version:
494	        tag = os.popen("oc get clusterversion version -o jsonpath='{.status.desired.version}'").read()
495	        pprint(f"Using tag {tag}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
508	    management_cmd = "oc get ingresscontroller -n openshift-ingress-operator default -o jsonpath='{.status.domain}'"
509	    management_ingress_domain = os.popen(management_cmd).read()
510	    data['management_ingress_domain'] = management_ingress_domain

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
508	    management_cmd = "oc get ingresscontroller -n openshift-ingress-operator default -o jsonpath='{.status.domain}'"
509	    management_ingress_domain = os.popen(management_cmd).read()
510	    data['management_ingress_domain'] = management_ingress_domain

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
522	        management_ips_cmd = "oc get nodes --no-headers -o jsonpath=\"{.items[*]['status.addresses'][0]['address']}\""
523	        management_ips = os.popen(management_ips_cmd).read().split(' ')
524	        if len(management_ips) == 1:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
522	        management_ips_cmd = "oc get nodes --no-headers -o jsonpath=\"{.items[*]['status.addresses'][0]['address']}\""
523	        management_ips = os.popen(management_ips_cmd).read().split(' ')
524	        if len(management_ips) == 1:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
526	        else:
527	            management_api_url = os.popen("oc whoami --show-server").read()
528	            management_api_domain = urlparse(management_api_url).hostname

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
526	        else:
527	            management_api_url = os.popen("oc whoami --show-server").read()
528	            management_api_domain = urlparse(management_api_url).hostname

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
532	    pub_key = data.get('pub_key')
533	    data['pull_secret'] = re.sub(r"\s", "", open(pull_secret).read())
534	    pub_key = data.get('pub_key') or get_ssh_pub_key()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
546	    elif os.path.exists(pub_key):
547	        data['pub_key'] = open(pub_key).read().strip()
548	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
603	    call(cmcmd, shell=True)
604	    icsps = safe_load(os.popen('oc get imagecontentsourcepolicies -o yaml').read())['items']
605	    if not fake_disconnected and icsps:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
603	    call(cmcmd, shell=True)
604	    icsps = safe_load(os.popen('oc get imagecontentsourcepolicies -o yaml').read())['items']
605	    if not fake_disconnected and icsps:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
624	        keepalived_yml_data = config.process_inputfile(cluster, f"{plandir}/staticpods/keepalived.yml", overrides=data)
625	        keepalived_yml_data = b64encode(keepalived_yml_data.encode()).decode("UTF-8")
626	        keepalived_conf_data = config.process_inputfile(cluster, f"{plandir}/keepalived.conf", overrides=data)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:625
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
624	        keepalived_yml_data = config.process_inputfile(cluster, f"{plandir}/staticpods/keepalived.yml", overrides=data)
625	        keepalived_yml_data = b64encode(keepalived_yml_data.encode()).decode("UTF-8")
626	        keepalived_conf_data = config.process_inputfile(cluster, f"{plandir}/keepalived.conf", overrides=data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
626	        keepalived_conf_data = config.process_inputfile(cluster, f"{plandir}/keepalived.conf", overrides=data)
627	        keepalived_conf_data = b64encode(keepalived_conf_data.encode()).decode("UTF-8")
628	        assisted_data = {'keepalived_yml_data': keepalived_yml_data, 'keepalived_conf_data': keepalived_conf_data}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:627
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
626	        keepalived_conf_data = config.process_inputfile(cluster, f"{plandir}/keepalived.conf", overrides=data)
627	        keepalived_conf_data = b64encode(keepalived_conf_data.encode()).decode("UTF-8")
628	        assisted_data = {'keepalived_yml_data': keepalived_yml_data, 'keepalived_conf_data': keepalived_conf_data}

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
630	            coredns_yml_data = config.process_inputfile(cluster, f"{plandir}/staticpods/coredns.yml", overrides=data)
631	            coredns_yml_data = b64encode(coredns_yml_data.encode()).decode("UTF-8")
632	            assisted_data['coredns_yml_data'] = coredns_yml_data

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:631
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
630	            coredns_yml_data = config.process_inputfile(cluster, f"{plandir}/staticpods/coredns.yml", overrides=data)
631	            coredns_yml_data = b64encode(coredns_yml_data.encode()).decode("UTF-8")
632	            assisted_data['coredns_yml_data'] = coredns_yml_data

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
633	            coredns_conf_data = config.process_inputfile(cluster, f"{plandir}/Corefile", overrides=data)
634	            coredns_conf_data = b64encode(coredns_conf_data.encode()).decode("UTF-8")
635	            assisted_data['coredns_conf_data'] = coredns_conf_data

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:634
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
633	            coredns_conf_data = config.process_inputfile(cluster, f"{plandir}/Corefile", overrides=data)
634	            coredns_conf_data = b64encode(coredns_conf_data.encode()).decode("UTF-8")
635	            assisted_data['coredns_conf_data'] = coredns_conf_data

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
636	            force_dns_data = config.process_inputfile(cluster, f"{plandir}/99-forcedns", overrides=data)
637	            force_dns_data = b64encode(force_dns_data.encode()).decode("UTF-8")
638	            assisted_data['force_dns_data'] = force_dns_data

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:637
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
636	            force_dns_data = config.process_inputfile(cluster, f"{plandir}/99-forcedns", overrides=data)
637	            force_dns_data = b64encode(force_dns_data.encode()).decode("UTF-8")
638	            assisted_data['force_dns_data'] = force_dns_data

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
665	        with open(f"{asyncdir}/99-notifications.yaml", 'w') as f:
666	            f.write(notifyfile)
667	        async_files.append({'path': '/etc/kubernetes/99-notifications.yaml',

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
665	        with open(f"{asyncdir}/99-notifications.yaml", 'w') as f:
666	            f.write(notifyfile)
667	        async_files.append({'path': '/etc/kubernetes/99-notifications.yaml',

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
688	            with open(f"{asyncdir}/99-apps.yaml", 'w') as f:
689	                f.write(appsfile)
690	            async_files.append({'path': '/etc/kubernetes/99-apps.yaml',

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
688	            with open(f"{asyncdir}/99-apps.yaml", 'w') as f:
689	                f.write(appsfile)
690	            async_files.append({'path': '/etc/kubernetes/99-apps.yaml',

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
712	                    with open(f"{asyncdir}/99-apps-cr.yaml", 'w') as f:
713	                        f.write(rendered)
714	                    async_files.append({'path': '/etc/kubernetes/99-app-cr.yaml',

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
712	                    with open(f"{asyncdir}/99-apps-cr.yaml", 'w') as f:
713	                        f.write(rendered)
714	                    async_files.append({'path': '/etc/kubernetes/99-app-cr.yaml',

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
725	            with open(f"{asyncdir}/autoscale.yaml", 'w') as f:
726	                f.write(autoscale_data)
727	            async_files.append({'path': '/etc/kubernetes/autoscale.yaml', 'origin': f"{asyncdir}/autoscale.yaml"})

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
725	            with open(f"{asyncdir}/autoscale.yaml", 'w') as f:
726	                f.write(autoscale_data)
727	            async_files.append({'path': '/etc/kubernetes/autoscale.yaml', 'origin': f"{asyncdir}/autoscale.yaml"})

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
731	        with open(f"{clusterdir}/assisted_infra.yml", 'w') as f:
732	            f.write(assistedfile)
733	        cmcmd = f"oc create -f {clusterdir}/assisted_infra.yml"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
731	        with open(f"{clusterdir}/assisted_infra.yml", 'w') as f:
732	            f.write(assistedfile)
733	        cmcmd = f"oc create -f {clusterdir}/assisted_infra.yml"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
745	    with open(f"{clusterdir}/hostedcluster.yaml", 'w') as f:
746	        f.write(hostedclusterfile)
747	    cmcmd = f"oc create -f {clusterdir}/hostedcluster.yaml"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
745	    with open(f"{clusterdir}/hostedcluster.yaml", 'w') as f:
746	        f.write(hostedclusterfile)
747	    cmcmd = f"oc create -f {clusterdir}/hostedcluster.yaml"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
774	        pprint(f"Using installer version {INSTALLER_VERSION}")
775	        nodepool_image = os.popen("openshift-install version | grep 'release image' | cut -f3 -d' '").read().strip()
776	    if assisted:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
774	        pprint(f"Using installer version {INSTALLER_VERSION}")
775	        nodepool_image = os.popen("openshift-install version | grep 'release image' | cut -f3 -d' '").read().strip()
776	    if assisted:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
863	    with open(autoapproverpath, 'w') as f:
864	        f.write(autoapprover)
865	    call(f"oc apply -f {autoapproverpath}", shell=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
863	    with open(autoapproverpath, 'w') as f:
864	        f.write(autoapprover)
865	    call(f"oc apply -f {autoapproverpath}", shell=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:876
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
875	            with open(f"{clusterdir}/nodepool_{cluster}.ign", 'w') as f:
876	                f.write(json.dumps(new_ignition))
877	        elif baremetal_iso or baremetal_hosts:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:876
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
875	            with open(f"{clusterdir}/nodepool_{cluster}.ign", 'w') as f:
876	                f.write(json.dumps(new_ignition))
877	        elif baremetal_iso or baremetal_hosts:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
886	    kubeconfigpath = f'{clusterdir}/auth/kubeconfig'
887	    kubeconfig = os.popen(f"oc extract -n {namespace} secret/{cluster}-admin-kubeconfig --to=-").read()
888	    with open(kubeconfigpath, 'w') as f:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
886	    kubeconfigpath = f'{clusterdir}/auth/kubeconfig'
887	    kubeconfig = os.popen(f"oc extract -n {namespace} secret/{cluster}-admin-kubeconfig --to=-").read()
888	    with open(kubeconfigpath, 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
888	    with open(kubeconfigpath, 'w') as f:
889	        f.write(kubeconfig)
890	    pprint("Waiting for kubeadmin-password to be available")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
888	    with open(kubeconfigpath, 'w') as f:
889	        f.write(kubeconfig)
890	    pprint("Waiting for kubeadmin-password to be available")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
893	    kubeadminpath = f'{clusterdir}/auth/kubeadmin-password'
894	    kubeadmin = os.popen(f"oc extract -n {namespace} secret/{cluster}-kubeadmin-password --to=-").read()
895	    with open(kubeadminpath, 'w') as f:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
893	    kubeadminpath = f'{clusterdir}/auth/kubeadmin-password'
894	    kubeadmin = os.popen(f"oc extract -n {namespace} secret/{cluster}-kubeadmin-password --to=-").read()
895	    with open(kubeadminpath, 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
895	    with open(kubeadminpath, 'w') as f:
896	        f.write(kubeadmin)
897	    if network_type == 'Calico':

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
895	    with open(kubeadminpath, 'w') as f:
896	        f.write(kubeadmin)
897	    if network_type == 'Calico':

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
903	            with open(f"{tmpdir}/calico.sh", 'w') as f:
904	                f.write(calico_script)
905	            call(f'bash {tmpdir}/calico.sh', shell=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
903	            with open(f"{tmpdir}/calico.sh", 'w') as f:
904	                f.write(calico_script)
905	            call(f'bash {tmpdir}/calico.sh', shell=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
911	        with open(f"{clusterdir}/cilium.sh", 'w') as f:
912	            f.write(cilium_script)
913	        call(f'bash {clusterdir}/cilium.sh', shell=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
911	        with open(f"{clusterdir}/cilium.sh", 'w') as f:
912	            f.write(cilium_script)
913	        call(f'bash {clusterdir}/cilium.sh', shell=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:957
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
956	        with open(f"{clusterdir}/assisted_ingress_service.yml", 'w') as f:
957	            f.write(ingress_file)
958	        call(f'oc create -f {clusterdir}/assisted_ingress_service.yml', shell=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:957
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
956	        with open(f"{clusterdir}/assisted_ingress_service.yml", 'w') as f:
957	            f.write(ingress_file)
958	        call(f'oc create -f {clusterdir}/assisted_ingress_service.yml', shell=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
967	                                                      overrides=autoscale_overrides)
968	            temp.write(autoscale_data)
969	            temp.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/hypershift/__init__.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
967	                                                      overrides=autoscale_overrides)
968	            temp.write(autoscale_data)
969	            temp.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/k3s/__init__.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	            timeout += 5
34	    for node in safe_load(os.popen("kubectl get node -o yaml").read())['items']:
35	        name = node['metadata']['name']

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/k3s/__init__.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
33	            timeout += 5
34	    for node in safe_load(os.popen("kubectl get node -o yaml").read())['items']:
35	        name = node['metadata']['name']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/k3s/__init__.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
296	                                                      overrides=autoscale_overrides)
297	            temp.write(autoscale_data)
298	            autoscalecmd = f"kubectl create -f {temp.name}"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/k3s/__init__.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
296	                                                      overrides=autoscale_overrides)
297	            temp.write(autoscale_data)
298	            autoscalecmd = f"kubectl create -f {temp.name}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	def get_release(version):
23	    releases = json.loads(urlopen('https://api.github.com/repos/kubernetes/kubernetes/releases').read().decode())
24	    for release in releases:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
22	def get_release(version):
23	    releases = json.loads(urlopen('https://api.github.com/repos/kubernetes/kubernetes/releases').read().decode())
24	    for release in releases:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	def get_release(version):
23	    releases = json.loads(urlopen('https://api.github.com/repos/kubernetes/kubernetes/releases').read().decode())
24	    for release in releases:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
49	                            insecure=True, cmd=domaincmd, vmport=first_vmport)
50	            data['domain'] = os.popen(domaincmd).read().strip().split('=')[1]
51	        os.mkdir(clusterdir)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
49	                            insecure=True, cmd=domaincmd, vmport=first_vmport)
50	            data['domain'] = os.popen(domaincmd).read().strip().split('=')[1]
51	        os.mkdir(clusterdir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
55	                       insecure=True, cmd=tokencmd, vmport=first_vmport)
56	        data['token'] = os.popen(tokencmd).read().strip().split('=')[1]
57	        certkeycmd = "grep CERTKEY= /root/bootstrap.sh"

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
55	                       insecure=True, cmd=tokencmd, vmport=first_vmport)
56	        data['token'] = os.popen(tokencmd).read().strip().split('=')[1]
57	        certkeycmd = "grep CERTKEY= /root/bootstrap.sh"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	                         insecure=True, cmd=certkeycmd, vmport=first_vmport)
61	        data['cert_key'] = os.popen(certkeycmd).read().strip().split('=')[1]
62	    if 'api_ip' not in data:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
60	                         insecure=True, cmd=certkeycmd, vmport=first_vmport)
61	        data['cert_key'] = os.popen(certkeycmd).read().strip().split('=')[1]
62	    if 'api_ip' not in data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
191	                return {'result': 'failure', 'reason': msg}
192	    kube_version = version or urlopen('https://dl.k8s.io/release/stable.txt').read().decode()
193	    if not kube_version.startswith('v'):

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
191	                return {'result': 'failure', 'reason': msg}
192	    kube_version = version or urlopen('https://dl.k8s.io/release/stable.txt').read().decode()
193	    if not kube_version.startswith('v'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
191	                return {'result': 'failure', 'reason': msg}
192	    kube_version = version or urlopen('https://dl.k8s.io/release/stable.txt').read().decode()
193	    if not kube_version.startswith('v'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
196	    kube_version = '.'.join(kube_version.split('.')[:2])
197	    kube_url = f"https://pkgs.k8s.io/core:/stable:/{kube_version}/rpm/repodata/repomd.xml"
198	    try:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
198	    try:
199	        urlopen(kube_url)
200	    except:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
206	            engine_version = f'v{engine_version}'
207	        engine_url = f"https://pkgs.k8s.io/addons:/cri-o:/stable:/{engine_version}/rpm/repodata/repomd.xml"
208	        try:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
208	        try:
209	            urlopen(engine_url)
210	        except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
241	                     insecure=True, cmd=urlcmd, vmport=disconnected_vmport)
242	        disconnected_url = os.popen(urlcmd).read().strip()
243	        data['disconnected_url'] = disconnected_url

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
241	                     insecure=True, cmd=urlcmd, vmport=disconnected_vmport)
242	        disconnected_url = os.popen(urlcmd).read().strip()
243	        data['disconnected_url'] = disconnected_url

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
343	                                                      overrides=autoscale_overrides)
344	            temp.write(autoscale_data)
345	            autoscalecmd = f"kubectl create -f {temp.name}"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubeadm/__init__.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
343	                                                      overrides=autoscale_overrides)
344	            temp.write(autoscale_data)
345	            autoscalecmd = f"kubectl create -f {temp.name}"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubernetes/__init__.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
12	class Kubernetes():
13	    def __init__(self, kubeconfig_file, host='127.0.0.1', context=None,
14	                 namespace='default', readwritemany=False, debug=False, insecure=False):
15	        self.namespace = namespace or 'default'

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubernetes/__init__.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
164	        kubectl = self.kubectl
165	        os.system(f"{kubectl} exec -it {name} /bin/sh")
166	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/kubernetes/__init__.py:165
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
164	        kubectl = self.kubectl
165	        os.system(f"{kubectl} exec -it {name} /bin/sh")
166	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/microshift/__init__.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
54	        check += " open-cluster-management-image-pull-credentials"
55	        if os.popen(check).read() == '':
56	            msg = "Missing open-cluster-management-image-pull-credentials secret on acm cluster"

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/microshift/__init__.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
54	        check += " open-cluster-management-image-pull-credentials"
55	        if os.popen(check).read() == '':
56	            msg = "Missing open-cluster-management-image-pull-credentials secret on acm cluster"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/microshift/__init__.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
81	    destination = f"{clusterdir}/auth/kubeconfig"
82	    os.system(f"sed -i -e 's/127.0.0.1/{ip}/' {destination}")
83	    success(f"Kubernetes cluster {cluster} deployed!!!")

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/microshift/__init__.py:82
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
81	    destination = f"{clusterdir}/auth/kubeconfig"
82	    os.system(f"sed -i -e 's/127.0.0.1/{ip}/' {destination}")
83	    success(f"Kubernetes cluster {cluster} deployed!!!")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
58	aws_secret_access_key={access_key_secret}""".format(access_key_id=access_key_id, access_key_secret=access_key_secret)
59	        f.write(data)
60	        if session_token is not None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
58	aws_secret_access_key={access_key_secret}""".format(access_key_id=access_key_id, access_key_secret=access_key_secret)
59	        f.write(data)
60	        if session_token is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
60	        if session_token is not None:
61	            f.write(f"aws_session_token={session_token}")
62	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
60	        if session_token is not None:
61	            f.write(f"aws_session_token={session_token}")
62	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
81	    auths = data['auths']
82	    if registry not in auths or b64decode(auths[registry]['auth']).decode("utf-8").split(':') != [user, password]:
83	        pprint(f"Updating your pull secret with entry for {registry}")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:82
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
81	    auths = data['auths']
82	    if registry not in auths or b64decode(auths[registry]['auth']).decode("utf-8").split(':') != [user, password]:
83	        pprint(f"Updating your pull secret with entry for {registry}")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
84	        key = f"{user}:{password}"
85	        key = str(b64encode(key.encode('utf-8')), 'utf-8')
86	        data['auths'][registry] = {'auth': key, 'email': 'jhendrix@karmalabs.corp'}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:85
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
84	        key = f"{user}:{password}"
85	        key = str(b64encode(key.encode('utf-8')), 'utf-8')
86	        data['auths'][registry] = {'auth': key, 'email': 'jhendrix@karmalabs.corp'}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
100	        cacmd += "awk '/-----BEGIN CERTIFICATE-----/,/-----END CERTIFICATE-----/'"
101	        data['ca'] = os.popen(cacmd).read()
102	    with open(f'{clusterdir}/ca.crt', 'w') as f:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
100	        cacmd += "awk '/-----BEGIN CERTIFICATE-----/,/-----END CERTIFICATE-----/'"
101	        data['ca'] = os.popen(cacmd).read()
102	    with open(f'{clusterdir}/ca.crt', 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
102	    with open(f'{clusterdir}/ca.crt', 'w') as f:
103	        f.write(data['ca'])
104	    call(f'sudo cp {clusterdir}/ca.crt /etc/pki/ca-trust/source/anchors ; sudo update-ca-trust extract',

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
102	    with open(f'{clusterdir}/ca.crt', 'w') as f:
103	        f.write(data['ca'])
104	    call(f'sudo cp {clusterdir}/ca.crt /etc/pki/ca-trust/source/anchors ; sudo update-ca-trust extract',

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	    with open(f"{clusterdir}/mirror-config.yaml", 'w') as f:
117	        f.write(mirrorconf)
118	    dockerdir = os.path.expanduser('~/.docker')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
116	    with open(f"{clusterdir}/mirror-config.yaml", 'w') as f:
117	        f.write(mirrorconf)
118	    dockerdir = os.path.expanduser('~/.docker')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
140	    with open(f"{clusterdir}/ctlplane.ign", 'w') as f:
141	        f.write(ctlplane_ignition)
142	    del ignition_overrides['role']

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
140	    with open(f"{clusterdir}/ctlplane.ign", 'w') as f:
141	        f.write(ctlplane_ignition)
142	    del ignition_overrides['role']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
144	    with open(f"{clusterdir}/worker.ign", 'w') as f:
145	        f.write(worker_ignition)
146	    if bucket_url is not None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
144	    with open(f"{clusterdir}/worker.ign", 'w') as f:
145	        f.write(worker_ignition)
146	    if bucket_url is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
149	        with open(f"{clusterdir}/bootstrap.ign", 'w') as f:
150	            f.write(bootstrap_ignition)
151	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
149	        with open(f"{clusterdir}/bootstrap.ign", 'w') as f:
150	            f.write(bootstrap_ignition)
151	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
208	def get_installer_version():
209	    installer_version = os.popen('openshift-install version').readlines()[0].split(" ")[1].strip()
210	    if installer_version.startswith('v'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
229	        if version == "nightly" and str(tag).count('.') == 1:
230	            nightly_url = f"https://amd64.ocp.releases.ci.openshift.org/api/v1/releasestream/{tag}.0-0.nightly/latest"
231	            tag = json.loads(urlopen(nightly_url).read())['name']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
230	            nightly_url = f"https://amd64.ocp.releases.ci.openshift.org/api/v1/releasestream/{tag}.0-0.nightly/latest"
231	            tag = json.loads(urlopen(nightly_url).read())['name']
232	        cmd = f"oc adm release info registry.ci.openshift.org/ocp/release:{tag} -a {pull_secret}"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
230	            nightly_url = f"https://amd64.ocp.releases.ci.openshift.org/api/v1/releasestream/{tag}.0-0.nightly/latest"
231	            tag = json.loads(urlopen(nightly_url).read())['name']
232	        cmd = f"oc adm release info registry.ci.openshift.org/ocp/release:{tag} -a {pull_secret}"

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
232	        cmd = f"oc adm release info registry.ci.openshift.org/ocp/release:{tag} -a {pull_secret}"
233	        for line in os.popen(cmd).readlines():
234	            if 'Pull From: ' in str(line):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	        target = tag if len(str(tag).split('.')) > 2 else f'{baselink}-{tag}'
242	        url = f"https://mirror.openshift.com/pub/openshift-v4/clients/{ocp_repo}/{target}/release.txt"
243	    elif version == 'latest':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
243	    elif version == 'latest':
244	        url = f"https://mirror.openshift.com/pub/openshift-v4/clients/ocp/{version}-{tag}/release.txt"
245	    else:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
248	    try:
249	        lines = urlopen(url).readlines()
250	        for line in lines:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
262	    try:
263	        existing = os.popen(f'{path}/openshift-install version').readlines()[2].split(" ")[2].strip()
264	    except:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
283	def get_release_image():
284	    release_image = os.popen('openshift-install version').readlines()[2].split(" ")[2].strip()
285	    return release_image

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
311	    INSTALLSYSTEM = 'mac' if os.path.exists('/Users') or macosx else 'linux'
312	    url = f"https://mirror.openshift.com/pub/openshift-v4/{arch}/clients/{repo}"
313	    pprint(f'Downloading openshift-install from {url}')

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
314	    try:
315	        r = urlopen(f"{url}/release.txt").readlines()
316	    except:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
326	        return 1
327	    cmd = f"curl -Ls https://mirror.openshift.com/pub/openshift-v4/{arch}/clients/{repo}/"
328	    cmd += f"openshift-install-{INSTALLSYSTEM}-{version}.tar.gz "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
340	        if version == 'candidate':
341	            url = "https://amd64.origin.releases.ci.openshift.org/api/v1/releasestream/4-scos-next/latest"
342	        elif version in ['ci', 'nightly']:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
342	        elif version in ['ci', 'nightly']:
343	            url = f"https://amd64.origin.releases.ci.openshift.org/api/v1/releasestream/{tag}.0-0.okd-scos/latest"
344	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
344	        else:
345	            url = "https://amd64.origin.releases.ci.openshift.org/api/v1/releasestream/4-scos-stable/latest"
346	        tag = json.loads(urlopen(url).read())['pullSpec']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
345	            url = "https://amd64.origin.releases.ci.openshift.org/api/v1/releasestream/4-scos-stable/latest"
346	        tag = json.loads(urlopen(url).read())['pullSpec']
347	    cmd = f"oc adm release extract --command=openshift-install --to . {tag}"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
345	            url = "https://amd64.origin.releases.ci.openshift.org/api/v1/releasestream/4-scos-stable/latest"
346	        tag = json.loads(urlopen(url).read())['pullSpec']
347	    cmd = f"oc adm release extract --command=openshift-install --to . {tag}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
360	        return 1
361	    if 'registry.ci.openshift.org' not in open(pull_secret).read():
362	        error("Entry for registry.ci.openshift.org missing in pull secret")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
365	        _type = 'nightly' if nightly else 'ci'
366	        ci_url = f"https://amd64.ocp.releases.ci.openshift.org/api/v1/releasestream/{tag}.0-0.{_type}/latest"
367	        tag = json.loads(urlopen(ci_url).read())['pullSpec']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
366	        ci_url = f"https://amd64.ocp.releases.ci.openshift.org/api/v1/releasestream/{tag}.0-0.{_type}/latest"
367	        tag = json.loads(urlopen(ci_url).read())['pullSpec']
368	    if tag is None:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
366	        ci_url = f"https://amd64.ocp.releases.ci.openshift.org/api/v1/releasestream/{tag}.0-0.{_type}/latest"
367	        tag = json.loads(urlopen(ci_url).read())['pullSpec']
368	    if tag is None:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
369	        tags = []
370	        r = urlopen("https://openshift-release.ci.openshift.org/graph?format=dot").readlines()
371	        for line in r:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
369	        tags = []
370	        r = urlopen("https://openshift-release.ci.openshift.org/graph?format=dot").readlines()
371	        for line in r:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
432	            with open(ignitionfile, 'w') as dest:
433	                req = Request(f"http://api.{cluster}.{domain}:22624/config/{role}")
434	                req.add_header("Accept", "application/vnd.coreos.ignition+json; version=3.1.0")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
434	                req.add_header("Accept", "application/vnd.coreos.ignition+json; version=3.1.0")
435	                data = urlopen(req).read()
436	                dest.write(data.decode("utf-8"))

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
434	                req.add_header("Accept", "application/vnd.coreos.ignition+json; version=3.1.0")
435	                data = urlopen(req).read()
436	                dest.write(data.decode("utf-8"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
435	                data = urlopen(req).read()
436	                dest.write(data.decode("utf-8"))
437	        except:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
435	                data = urlopen(req).read()
436	                dest.write(data.decode("utf-8"))
437	        except:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
451	    with open(ignitionfile, 'w') as f:
452	        f.write(iso_data)
453	    config.create_openshift_iso(cluster, overrides=baremetal_iso_overrides, ignitionfile=ignitionfile, installer=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
451	    with open(ignitionfile, 'w') as f:
452	        f.write(iso_data)
453	    config.create_openshift_iso(cluster, overrides=baremetal_iso_overrides, ignitionfile=ignitionfile, installer=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
461	        while True:
462	            if os.popen('oc -n default get pod -l app=httpd-kcli -o name').read() != "":
463	                break

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
461	        while True:
462	            if os.popen('oc -n default get pod -l app=httpd-kcli -o name').read() != "":
463	                break

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
471	        svcip_cmd = 'oc get node -o yaml'
472	        svcip = safe_load(os.popen(svcip_cmd).read())['items'][0]['status']['addresses'][0]['address']
473	        svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
471	        svcip_cmd = 'oc get node -o yaml'
472	        svcip = safe_load(os.popen(svcip_cmd).read())['items'][0]['status']['addresses'][0]['address']
473	        svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
473	        svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'
474	        svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
475	        podname = os.popen('oc -n default get pod -l app=httpd-kcli -o name').read().split('/')[1].strip()

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
473	        svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'
474	        svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
475	        podname = os.popen('oc -n default get pod -l app=httpd-kcli -o name').read().split('/')[1].strip()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
474	        svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
475	        podname = os.popen('oc -n default get pod -l app=httpd-kcli -o name').read().split('/')[1].strip()
476	        try:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
474	        svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
475	        podname = os.popen('oc -n default get pod -l app=httpd-kcli -o name').read().split('/')[1].strip()
476	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
498	            call(f"sudo chown apache:apache {baremetal_web_dir}/{cluster}-*.iso", shell=True)
499	            if which('getenforce') is not None and os.popen('getenforce').read().strip() == 'Enforcing':
500	                call(f"sudo restorecon -Frvv {baremetal_web_dir}/{cluster}-*.iso", shell=True)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
498	            call(f"sudo chown apache:apache {baremetal_web_dir}/{cluster}-*.iso", shell=True)
499	            if which('getenforce') is not None and os.popen('getenforce').read().strip() == 'Enforcing':
500	                call(f"sudo restorecon -Frvv {baremetal_web_dir}/{cluster}-*.iso", shell=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
503	    nic_name = data.get('baremetal_web_nic', 'default')
504	    nic = os.popen(f'ip r | grep {nic_name} | cut -d" " -f5 | head -1').read().strip()
505	    ip_cmd = f"ip -o addr show {nic} | awk '{{print $4}}' | cut -d '/' -f 1 | head -1"

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
503	    nic_name = data.get('baremetal_web_nic', 'default')
504	    nic = os.popen(f'ip r | grep {nic_name} | cut -d" " -f5 | head -1').read().strip()
505	    ip_cmd = f"ip -o addr show {nic} | awk '{{print $4}}' | cut -d '/' -f 1 | head -1"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
505	    ip_cmd = f"ip -o addr show {nic} | awk '{{print $4}}' | cut -d '/' -f 1 | head -1"
506	    host_ip = os.popen(ip_cmd).read().strip()
507	    if baremetal_web_port != 80:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
505	    ip_cmd = f"ip -o addr show {nic} | awk '{{print $4}}' | cut -d '/' -f 1 | head -1"
506	    host_ip = os.popen(ip_cmd).read().strip()
507	    if baremetal_web_port != 80:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
556	                entry = f"{mac};{name};{ip};{netmask};{gateway};{nameserver}\n"
557	                f.write(entry)
558	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
556	                entry = f"{mac};{name};{ip};{netmask};{gateway};{nameserver}\n"
557	                f.write(entry)
558	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
610	            svcip_cmd = 'oc get node -o yaml'
611	            svcip = safe_load(os.popen(svcip_cmd).read())['items'][0]['status']['addresses'][0]['address']
612	            svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
610	            svcip_cmd = 'oc get node -o yaml'
611	            svcip = safe_load(os.popen(svcip_cmd).read())['items'][0]['status']['addresses'][0]['address']
612	            svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
612	            svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'
613	            svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
614	            iso_url = f'http://{svcip}:{svcport}/{cluster}-worker.iso'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
612	            svcport_cmd = 'oc get svc -n default httpd-kcli-svc -o yaml'
613	            svcport = safe_load(os.popen(svcport_cmd).read())['spec']['ports'][0]['nodePort']
614	            iso_url = f'http://{svcip}:{svcport}/{cluster}-worker.iso'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
888	        return {'result': 'failure', 'reason': f"Missing pull secret file {pull_secret}"}
889	    if prega and 'quay.io/prega' not in open(os.path.expanduser(pull_secret)).read():
890	        return {'result': 'failure', 'reason': "entry for quay.io/prega missing in pull secret"}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:891
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
890	        return {'result': 'failure', 'reason': "entry for quay.io/prega missing in pull secret"}
891	    if virtualization_nightly and 'quay.io/openshift-cnv' not in open(os.path.expanduser(pull_secret)).read():
892	        return {'result': 'failure', 'reason': "entry for quay.io/openshift-cnv missing in pull secret"}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:908
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
907	    elif os.path.exists(pub_key):
908	        data['pub_key'] = open(pub_key).read().strip()
909	    else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
916	            pprint(f"Removing existing directory {clusterdir}")
917	            rmtree(clusterdir)
918	    if version == 'ci':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
967	            cacmd += "openssl x509 -outform PEM"
968	            data['ca'] = os.popen(cacmd).read()
969	    if sno:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
967	            cacmd += "openssl x509 -outform PEM"
968	            data['ca'] = os.popen(cacmd).read()
969	    if sno:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1040	        pprint(f"Deploying disconnected vm {disconnected_vm}")
1041	        data['pull_secret'] = re.sub(r"\s", "", open(pull_secret).read())
1042	        disconnected_plan = f"{plan}-reuse" if disconnected_reuse else plan

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1063	                    insecure=True, cmd=cacmd, vmport=disconnected_vmport)
1064	        disconnected_ca = os.popen(cacmd).read().strip()
1065	        if data['ca'] is not None:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1063	                    insecure=True, cmd=cacmd, vmport=disconnected_vmport)
1064	        disconnected_ca = os.popen(cacmd).read().strip()
1065	        if data['ca'] is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1072	                     insecure=True, cmd=urlcmd, vmport=disconnected_vmport)
1073	        disconnected_url = os.popen(urlcmd).read().strip()
1074	        overrides['disconnected_url'] = disconnected_url

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1072	                     insecure=True, cmd=urlcmd, vmport=disconnected_vmport)
1073	        disconnected_url = os.popen(urlcmd).read().strip()
1074	        overrides['disconnected_url'] = disconnected_url

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1079	                         insecure=True, cmd=versioncmd, vmport=disconnected_vmport)
1080	        disconnected_version = os.popen(versioncmd).read().strip()
1081	        for source in ["'cs-*.yaml'", "'i*oc-mirror.yaml'"]:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1079	                         insecure=True, cmd=versioncmd, vmport=disconnected_vmport)
1080	        disconnected_version = os.popen(versioncmd).read().strip()
1081	        for source in ["'cs-*.yaml'", "'i*oc-mirror.yaml'"]:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1085
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1084	                         tunneluser=config.tunneluser, download=True, insecure=True, vmport=disconnected_vmport)
1085	            os.system(scpcmd)
1086	        patch_oc_mirror(clusterdir)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1085
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1084	                         tunneluser=config.tunneluser, download=True, insecure=True, vmport=disconnected_vmport)
1085	            os.system(scpcmd)
1086	        patch_oc_mirror(clusterdir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1089
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1088	    data['pull_secret_path'] = pull_secret
1089	    data['pull_secret'] = re.sub(r"\s", "", open(pull_secret).read())
1090	    if disconnected_url is not None:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1095
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1094	        key = f"{disconnected_user}:{disconnected_password}"
1095	        key = str(b64encode(key.encode('utf-8')), 'utf-8')
1096	        auths = json.loads(data['pull_secret'])['auths']

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1095
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1094	        key = f"{disconnected_user}:{disconnected_password}"
1095	        key = str(b64encode(key.encode('utf-8')), 'utf-8')
1096	        auths = json.loads(data['pull_secret'])['auths']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1112	    with open(f"{clusterdir}/install-config.yaml", 'w') as f:
1113	        f.write(installconfig)
1114	    with open(f"{clusterdir}/install-config.yaml.bck", 'w') as f:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1112	    with open(f"{clusterdir}/install-config.yaml", 'w') as f:
1113	        f.write(installconfig)
1114	    with open(f"{clusterdir}/install-config.yaml.bck", 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1114	    with open(f"{clusterdir}/install-config.yaml.bck", 'w') as f:
1115	        f.write(installconfig)
1116	    run = call(f'openshift-install --dir={clusterdir} --log-level={log_level} create manifests', shell=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1114	    with open(f"{clusterdir}/install-config.yaml.bck", 'w') as f:
1115	        f.write(installconfig)
1116	    run = call(f'openshift-install --dir={clusterdir} --log-level={log_level} create manifests', shell=True)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1122	        prefix = safe_load(open(f'{clusterdir}/openshift/99_cloud-creds-secret.yaml'))['data']['azure_resource_prefix']
1123	        new_prefix = b64encode(bytes(cluster, 'utf-8')).decode('utf-8')
1124	        sedcmd = f'sed -i "s@{prefix}@{new_prefix}@" {clusterdir}/openshift/99_cloud-creds-secret.yaml'

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1123
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1122	        prefix = safe_load(open(f'{clusterdir}/openshift/99_cloud-creds-secret.yaml'))['data']['azure_resource_prefix']
1123	        new_prefix = b64encode(bytes(cluster, 'utf-8')).decode('utf-8')
1124	        sedcmd = f'sed -i "s@{prefix}@{new_prefix}@" {clusterdir}/openshift/99_cloud-creds-secret.yaml'

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1125	        call(sedcmd, shell=True)
1126	        old_prefix = b64decode(bytes(prefix, 'utf-8')).decode('utf-8')
1127	        sedcmd = f'sed -i "s@{old_prefix}@{cluster}@" {clusterdir}/openshift/* {clusterdir}/manifests/*'

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1126
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1125	        call(sedcmd, shell=True)
1126	        old_prefix = b64decode(bytes(prefix, 'utf-8')).decode('utf-8')
1127	        sedcmd = f'sed -i "s@{old_prefix}@{cluster}@" {clusterdir}/openshift/* {clusterdir}/manifests/*'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1141	            with open(f"{clusterdir}/manifests/99-chrony-{role}.yaml", 'w') as f:
1142	                f.write(ntp)
1143	    baremetal_cidr = data['baremetal_cidr']

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1141	            with open(f"{clusterdir}/manifests/99-chrony-{role}.yaml", 'w') as f:
1142	                f.write(ntp)
1143	    baremetal_cidr = data['baremetal_cidr']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1149	            with open(f"{clusterdir}/manifests/99-chrony-{role}.yaml", 'w') as f:
1150	                f.write(hint)
1151	    manifestsdir = data.get('manifests')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1149	            with open(f"{clusterdir}/manifests/99-chrony-{role}.yaml", 'w') as f:
1150	                f.write(hint)
1151	    manifestsdir = data.get('manifests')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1164	            with open(f'{clusterdir}/openshift/{f}', 'w') as f:
1165	                f.write(content)
1166	    for manifest in glob(f"{clusterdir}/*.yaml"):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1164	            with open(f'{clusterdir}/openshift/{f}', 'w') as f:
1165	                f.write(content)
1166	    for manifest in glob(f"{clusterdir}/*.yaml"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1180	            with open(f"{tmpdir}/calico.sh", 'w') as f:
1181	                f.write(calico_script)
1182	            call(f'bash {tmpdir}/calico.sh', shell=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1180	            with open(f"{tmpdir}/calico.sh", 'w') as f:
1181	                f.write(calico_script)
1182	            call(f'bash {tmpdir}/calico.sh', shell=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1188	        with open(f"{clusterdir}/cilium.sh", 'w') as f:
1189	            f.write(cilium_script)
1190	        call(f'bash {clusterdir}/cilium.sh', shell=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1188	        with open(f"{clusterdir}/cilium.sh", 'w') as f:
1189	            f.write(cilium_script)
1190	        call(f'bash {clusterdir}/cilium.sh', shell=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1200	        with open(f"{clusterdir}/openshift/99-ovn.yaml", 'w') as f:
1201	            f.write(ovn_data)
1202	    if workers == 0 or not mdns or kubevirt_api_service:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1200	        with open(f"{clusterdir}/openshift/99-ovn.yaml", 'w') as f:
1201	            f.write(ovn_data)
1202	    if workers == 0 or not mdns or kubevirt_api_service:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1207	        with open(f"{clusterdir}/manifests/cluster-ingress-02-config.yml", 'w') as f:
1208	            f.write(ingress_sslip_data)
1209	    cron_overrides = {'registry': disconnected_url or 'quay.io'}

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1207	        with open(f"{clusterdir}/manifests/cluster-ingress-02-config.yml", 'w') as f:
1208	            f.write(ingress_sslip_data)
1209	    cron_overrides = {'registry': disconnected_url or 'quay.io'}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1212	    with open(f"{clusterdir}/autoapprovercron.yml", 'w') as f:
1213	        f.write(autoapproverdata)
1214	    for f in glob(f"{plandir}/customisation/*.yaml"):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1212	    with open(f"{clusterdir}/autoapprovercron.yml", 'w') as f:
1213	        f.write(autoapproverdata)
1214	    for f in glob(f"{plandir}/customisation/*.yaml"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1227	            with open(f"{clusterdir}/openshift/99-ingress-controller.yaml", 'w') as _f:
1228	                _f.write(ingressconfig)
1229	            continue

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1227	            with open(f"{clusterdir}/openshift/99-ingress-controller.yaml", 'w') as _f:
1228	                _f.write(ingressconfig)
1229	            continue

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1236	                with open(f"{clusterdir}/openshift/99-iptables.yaml", 'w') as _f:
1237	                    _f.write(iptablesdata)
1238	            continue

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1236	                with open(f"{clusterdir}/openshift/99-iptables.yaml", 'w') as _f:
1237	                    _f.write(iptablesdata)
1238	            continue

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1241	            with open(f"{clusterdir}/openshift/99-autoapprovercron-cronjob.yaml", 'w') as _f:
1242	                _f.write(crondata)
1243	            continue

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1241	            with open(f"{clusterdir}/openshift/99-autoapprovercron-cronjob.yaml", 'w') as _f:
1242	                _f.write(crondata)
1243	            continue

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1247	            with open(f"{clusterdir}/openshift/99-monitoring.yaml", 'w') as _f:
1248	                _f.write(monitoringfile)
1249	            continue

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1247	            with open(f"{clusterdir}/openshift/99-monitoring.yaml", 'w') as _f:
1248	                _f.write(monitoringfile)
1249	            continue

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1258	        with open(f"{clusterdir}/openshift/99-prega-catalog.yaml", 'w') as _f:
1259	            _f.write(pregafile)
1260	    registry = disconnected_url or 'quay.io'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1258	        with open(f"{clusterdir}/openshift/99-prega-catalog.yaml", 'w') as _f:
1259	            _f.write(pregafile)
1260	    registry = disconnected_url or 'quay.io'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1267	        with open(f"{clusterdir}/openshift/99-bootstrap-deletion.yaml", 'w') as _f:
1268	            _f.write(deletionfile)
1269	        if not autoscale:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1267	        with open(f"{clusterdir}/openshift/99-bootstrap-deletion.yaml", 'w') as _f:
1268	            _f.write(deletionfile)
1269	        if not autoscale:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1272	            with open(f"{clusterdir}/openshift/99-bootstrap-deletion-2.yaml", 'w') as _f:
1273	                _f.write(deletionfile2)
1274	    if notify and (async_install or (sno and not sno_wait)):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1272	            with open(f"{clusterdir}/openshift/99-bootstrap-deletion-2.yaml", 'w') as _f:
1273	                _f.write(deletionfile2)
1274	    if notify and (async_install or (sno and not sno_wait)):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1290	        with open(f"{clusterdir}/openshift/99-notifications.yaml", 'w') as _f:
1291	            _f.write(notifyfile)
1292	    if apps and (async_install or (sno and not sno_wait)):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1290	        with open(f"{clusterdir}/openshift/99-notifications.yaml", 'w') as _f:
1291	            _f.write(notifyfile)
1292	    if apps and (async_install or (sno and not sno_wait)):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1297	        with open(f"{clusterdir}/openshift/99-apps.yaml", 'w') as _f:
1298	            _f.write(appsfile)
1299	    if ctlplane_localhost_fix:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1297	        with open(f"{clusterdir}/openshift/99-apps.yaml", 'w') as _f:
1298	            _f.write(appsfile)
1299	    if ctlplane_localhost_fix:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1302	        with open(f"{clusterdir}/openshift/20-localhost-fix-ctlplane.yaml", 'w') as _f:
1303	            _f.write(localctlplane)
1304	    if worker_localhost_fix:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1302	        with open(f"{clusterdir}/openshift/20-localhost-fix-ctlplane.yaml", 'w') as _f:
1303	            _f.write(localctlplane)
1304	    if worker_localhost_fix:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1307	        with open(f"{clusterdir}/openshift/99-localhost-fix-worker.yaml", 'w') as _f:
1308	            _f.write(localworker)
1309	    if metal3:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1307	        with open(f"{clusterdir}/openshift/99-localhost-fix-worker.yaml", 'w') as _f:
1308	            _f.write(localworker)
1309	    if metal3:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1315	            with open(f"{clusterdir}/openshift/99-autologin-{role}.yaml", 'w') as _f:
1316	                _f.write(autologinfile)
1317	    if dedicated_etcd:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1315	            with open(f"{clusterdir}/openshift/99-autologin-{role}.yaml", 'w') as _f:
1316	                _f.write(autologinfile)
1317	    if dedicated_etcd:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1330	        with open(f"{clusterdir}/openshift/98-etcd.yaml", 'w') as _f:
1331	            _f.write(etcdfile)
1332	    if provider == 'kubevirt':

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1330	        with open(f"{clusterdir}/openshift/98-etcd.yaml", 'w') as _f:
1331	            _f.write(etcdfile)
1332	    if provider == 'kubevirt':

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1335	        with open(f"{clusterdir}/openshift/99-kubevirt-fix-ctlplane.yaml", 'w') as _f:
1336	            _f.write(kubevirtctlplane)
1337	        kubevirtworker = config.process_inputfile(cluster, f"{plandir}/99-kubevirt-fix.yaml",

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1335	        with open(f"{clusterdir}/openshift/99-kubevirt-fix-ctlplane.yaml", 'w') as _f:
1336	            _f.write(kubevirtctlplane)
1337	        kubevirtworker = config.process_inputfile(cluster, f"{plandir}/99-kubevirt-fix.yaml",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1339	        with open(f"{clusterdir}/openshift/99-kubevirt-fix-worker.yaml", 'w') as _f:
1340	            _f.write(kubevirtworker)
1341	    if sno:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1339	        with open(f"{clusterdir}/openshift/99-kubevirt-fix-worker.yaml", 'w') as _f:
1340	            _f.write(kubevirtworker)
1341	    if sno:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1385	            with open(f"{clusterdir}/openshift/99-sno.yaml", 'w') as f:
1386	                f.write(rendered)
1387	        if sno_ctlplanes:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1385	            with open(f"{clusterdir}/openshift/99-sno.yaml", 'w') as f:
1386	                f.write(rendered)
1387	        if sno_ctlplanes:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1392	            with open(f"{clusterdir}/openshift/99-ingress-controller.yaml", 'w') as _f:
1393	                _f.write(ingress)
1394	        pprint("Generating bootstrap-in-place ignition")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1392	            with open(f"{clusterdir}/openshift/99-ingress-controller.yaml", 'w') as _f:
1393	                _f.write(ingress)
1394	        pprint("Generating bootstrap-in-place ignition")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1428	            pprint("Writing iso.ign to current dir")
1429	            f.write(result['userdata'])
1430	        live_url = os.environ.get('LIVEISO_URL') or overrides.get('liveiso_url')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1428	            pprint("Writing iso.ign to current dir")
1429	            f.write(result['userdata'])
1430	        live_url = os.environ.get('LIVEISO_URL') or overrides.get('liveiso_url')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1511	            c = f"{clusterdir}/auth/kubeconfig"
1512	            kubepassword = open(f"{clusterdir}/auth/kubeadmin-password").read()
1513	            console = f"https://console-openshift-console.apps.{cluster}.{domain}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1512	            kubepassword = open(f"{clusterdir}/auth/kubeadmin-password").read()
1513	            console = f"https://console-openshift-console.apps.{cluster}.{domain}"
1514	            info2(f"To access the cluster as the system:admin user when running 'oc', run export KUBECONFIG={c}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1533	        with open(f"{clusterdir}/openshift/99-autoscale.yaml", 'w') as f:
1534	            f.write(autoscale_data)
1535	    run = call(f'openshift-install --dir={clusterdir} --log-level={log_level} create ignition-configs', shell=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1533	        with open(f"{clusterdir}/openshift/99-autoscale.yaml", 'w') as f:
1534	            f.write(autoscale_data)
1535	    run = call(f'openshift-install --dir={clusterdir} --log-level={log_level} create ignition-configs', shell=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1644	            hostip_cmd = f'KUBECONFIG={kubeconfig} oc get node {nodehost} -o yaml'
1645	            hostip = safe_load(os.popen(hostip_cmd).read())['status']['addresses'][0]['address']
1646	            update_openshift_etc_hosts(cluster, domain, hostip)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1644	            hostip_cmd = f'KUBECONFIG={kubeconfig} oc get node {nodehost} -o yaml'
1645	            hostip = safe_load(os.popen(hostip_cmd).read())['status']['addresses'][0]['address']
1646	            update_openshift_etc_hosts(cluster, domain, hostip)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1687	        kubeconf = f"{clusterdir}/auth/kubeconfig"
1688	        kubepassword = open(f"{clusterdir}/auth/kubeadmin-password").read()
1689	        if async_install:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1692	        info2(f"To access the cluster as the system:admin user when running 'oc', run export KUBECONFIG={kubeconf}")
1693	        info2(f"Access the Openshift web-console here: https://console-openshift-console.apps.{cluster}.{domain}")
1694	        info2(f"Login to the console with user: kubeadmin, password: {kubepassword}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1739	            with open(f"{tmpdir}/patch_ipv6.json", 'w') as f:
1740	                f.write(patch_ipv6)
1741	            call(f"oc patch network.config.openshift.io cluster --type=json --patch-file {tmpdir}/patch_ipv6.json",

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/openshift/__init__.py:1740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1739	            with open(f"{tmpdir}/patch_ipv6.json", 'w') as f:
1740	                f.write(patch_ipv6)
1741	            call(f"oc patch network.config.openshift.io cluster --type=json --patch-file {tmpdir}/patch_ipv6.json",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/rke2/__init__.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	                            insecure=True, cmd=domaincmd, vmport=first_vmport)
38	            data['domain'] = os.popen(domaincmd).read().strip().split('=')[1]
39	        os.mkdir(clusterdir)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/rke2/__init__.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
37	                            insecure=True, cmd=domaincmd, vmport=first_vmport)
38	            data['domain'] = os.popen(domaincmd).read().strip().split('=')[1]
39	        os.mkdir(clusterdir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/rke2/__init__.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
43	                       insecure=True, cmd=tokencmd, vmport=first_vmport)
44	        data['token'] = os.popen(tokencmd).read().strip().split('=')[1]
45	    if 'api_ip' not in data:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/rke2/__init__.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
43	                       insecure=True, cmd=tokencmd, vmport=first_vmport)
44	        data['token'] = os.popen(tokencmd).read().strip().split('=')[1]
45	    if 'api_ip' not in data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/rke2/__init__.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
245	                                                      overrides=autoscale_overrides)
246	            temp.write(autoscale_data)
247	            autoscalecmd = f"kubectl create -f {temp.name}"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/rke2/__init__.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
245	                                                      overrides=autoscale_overrides)
246	            temp.write(autoscale_data)
247	            autoscalecmd = f"kubectl create -f {temp.name}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/cluster/rke2/__init__.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	    if autolabel:
254	        autolabelcmd = 'kubectl apply -f https://raw.githubusercontent.com/karmab/autolabeller/main/autorules.yml'
255	        call(autolabelcmd, shell=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    try:
53	        if url.startswith('https://github.com'):
54	            url = github_raw(url)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
54	            url = github_raw(url)
55	        urlopen(url)
56	        return True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	    relativepath = '/'.join(relativepath)
72	    url = f'https://raw.githubusercontent.com/{user}/{repo}/{branch}/{relativepath}'
73	    return url

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	def fetch(url, path):
77	    if url.startswith('https://github.com'):
78	        url = github_raw(url)

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
84	    try:
85	        urlretrieve(url, f"{path}/{shortname}")
86	    except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
283	        pprint(f"using cloudinit from existing {existing} for {name}")
284	        userdata = open(existing).read()
285	    else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
283	        pprint(f"using cloudinit from existing {existing} for {name}")
284	        userdata = open(existing).read()
285	    else:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
317	        elif which('ssh-add') is not None:
318	            agent_keys = os.popen('ssh-add -L 2>/dev/null | grep ssh | head -1').readlines()
319	            if agent_keys:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
330	                    keypath = os.path.expanduser(key)
331	                    newkey = open(keypath, 'r').read().rstrip()
332	                else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
330	                    keypath = os.path.expanduser(key)
331	                    newkey = open(keypath, 'r').read().rstrip()
332	                else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
340	        elif publickeyfile is not None:
341	            publickey = open(publickeyfile, 'r').read().rstrip()
342	            if publickey not in keys:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
340	        elif publickeyfile is not None:
341	            publickey = open(publickeyfile, 'r').read().rstrip()
342	            if publickey not in keys:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
345	        if publictempkeyfile is not None:
346	            tempkey = open(publictempkeyfile, 'r').read()
347	            if tempkey not in keys:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
345	        if publictempkeyfile is not None:
346	            tempkey = open(publictempkeyfile, 'r').read()
347	            if tempkey not in keys:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
470	                    binary = True
471	                    content = base64.b64encode(open(origin, "rb").read())
472	            else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:471
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
470	                    binary = True
471	                    content = base64.b64encode(open(origin, "rb").read())
472	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
470	                    binary = True
471	                    content = base64.b64encode(open(origin, "rb").read())
472	            else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
470	                    binary = True
471	                    content = base64.b64encode(open(origin, "rb").read())
472	            else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
477	                    binary = True
478	                    content = base64.b64encode(open(origin, "rb").read())
479	        if remediate:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:478
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
477	                    binary = True
478	                    content = base64.b64encode(open(origin, "rb").read())
479	        if remediate:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
477	                    binary = True
478	                    content = base64.b64encode(open(origin, "rb").read())
479	        if remediate:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
477	                    binary = True
478	                    content = base64.b64encode(open(origin, "rb").read())
479	        if remediate:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
572	        else:
573	            content = base64.b64encode(content.encode()).decode("UTF-8")
574	            filesdata.append({'path': path, 'mode': permissions, 'overwrite': True,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:573
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
572	        else:
573	            content = base64.b64encode(content.encode()).decode("UTF-8")
574	            filesdata.append({'path': path, 'mode': permissions, 'overwrite': True,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
610	            content = f"#!/bin/sh\n{content}"
611	        content = base64.b64encode(content.encode()).decode("UTF-8")
612	        data = {'path': path, 'mode': int(permissions, 8),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:611
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
610	            content = f"#!/bin/sh\n{content}"
611	        content = base64.b64encode(content.encode()).decode("UTF-8")
612	        data = {'path': path, 'mode': int(permissions, 8),

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:630
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
629	def get_free_port():
630	    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
631	    s.bind(('localhost', 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
632	    addr, port = s.getsockname()
633	    s.close()
634	    return port

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
720	        with open(vmfile, 'w') as f:
721	            f.write(f"{client} {name}")
722	        return

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
720	        with open(vmfile, 'w') as f:
721	            f.write(f"{client} {name}")
722	        return

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
723	    with open(vmfile, 'r') as original:
724	        data = original.read()
725	    with open(vmfile, 'w') as modified:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
723	    with open(vmfile, 'r') as original:
724	        data = original.read()
725	    with open(vmfile, 'w') as modified:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
725	    with open(vmfile, 'w') as modified:
726	        modified.write(f"{client} {name}\n{data}")
727	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
725	    with open(vmfile, 'w') as modified:
726	        modified.write(f"{client} {name}\n{data}")
727	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
736	        deletecmd += f" '/{client} {name}/d' {configdir}/vm"
737	        os.system(deletecmd)
738	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:737
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
736	        deletecmd += f" '/{client} {name}/d' {configdir}/vm"
737	        os.system(deletecmd)
738	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:938
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
937	            sshcommand = f'{sshcommand} "{cmd}"'
938	        if tunnelhost is not None and tunnelhost not in ['localhost', '127.0.0.1'] and tunnel and\
939	                tunneluser is not None:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
973	        arguments = ''
974	        if tunnelhost is not None and tunnelhost not in ['localhost', '127.0.0.1'] and\
975	                tunnel and tunneluser is not None:

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
1003	    if 'gke' in image.lower():
1004	        user = getuser()
1005	    elif 'rhel' in image.lower() and not image.startswith('RHEL-'):

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1004
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
1003	    if 'gke' in image.lower():
1004	        user = getuser()
1005	    elif 'rhel' in image.lower() and not image.startswith('RHEL-'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1067	                    keypath = os.path.expanduser(key)
1068	                    newkey = open(keypath, 'r').read().rstrip()
1069	                if not newkey.startswith('ssh-'):

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1067	                    keypath = os.path.expanduser(key)
1068	                    newkey = open(keypath, 'r').read().rstrip()
1069	                if not newkey.startswith('ssh-'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1077	                with open(publickeyfile, 'r') as ssh:
1078	                    publickeys.append(ssh.read().strip())
1079	        if not publickeys and which('ssh-add') is not None:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1077	                with open(publickeyfile, 'r') as ssh:
1078	                    publickeys.append(ssh.read().strip())
1079	        if not publickeys and which('ssh-add') is not None:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1079	        if not publickeys and which('ssh-add') is not None:
1080	            agent_keys = os.popen('ssh-add -L 2>/dev/null | head -1').readlines()
1081	            if agent_keys:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1251	    _format = 'ova' if _type == 'vsphere' else 'qcow2.xz'
1252	    with urlopen(url) as u:
1253	        data = json.loads(u.read().decode())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1252	    with urlopen(url) as u:
1253	        data = json.loads(u.read().decode())
1254	        if _type == 'aws':

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1252	    with urlopen(url) as u:
1253	        data = json.loads(u.read().decode())
1254	        if _type == 'aws':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1279	    key = keys.get(_type) or 'openstack'
1280	    INSTALLER_COREOS = os.popen('openshift-install coreos print-stream-json 2>/dev/null').read()
1281	    data = json.loads(INSTALLER_COREOS)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1279	    key = keys.get(_type) or 'openstack'
1280	    INSTALLER_COREOS = os.popen('openshift-install coreos print-stream-json 2>/dev/null').read()
1281	    data = json.loads(INSTALLER_COREOS)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1279	    key = keys.get(_type) or 'openstack'
1280	    INSTALLER_COREOS = os.popen('openshift-install coreos print-stream-json 2>/dev/null').read()
1281	    data = json.loads(INSTALLER_COREOS)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1297	        sys.exit(0)
1298	    INSTALLER_COREOS = os.popen('openshift-install coreos print-stream-json 2>/dev/null').read()
1299	    data = json.loads(INSTALLER_COREOS)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1297	        sys.exit(0)
1298	    INSTALLER_COREOS = os.popen('openshift-install coreos print-stream-json 2>/dev/null').read()
1299	    data = json.loads(INSTALLER_COREOS)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1297	        sys.exit(0)
1298	    INSTALLER_COREOS = os.popen('openshift-install coreos print-stream-json 2>/dev/null').read()
1299	    data = json.loads(INSTALLER_COREOS)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1303	def get_installer_iso_sha():
1304	    INSTALLER_COREOS = os.popen('openshift-install coreos print-stream-json 2>/dev/null').read()
1305	    data = json.loads(INSTALLER_COREOS)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1303	def get_installer_iso_sha():
1304	    INSTALLER_COREOS = os.popen('openshift-install coreos print-stream-json 2>/dev/null').read()
1305	    data = json.loads(INSTALLER_COREOS)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1303	def get_installer_iso_sha():
1304	    INSTALLER_COREOS = os.popen('openshift-install coreos print-stream-json 2>/dev/null').read()
1305	    data = json.loads(INSTALLER_COREOS)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1310	    buildurl = f'{url}/builds.json'
1311	    with urlopen(buildurl) as b:
1312	        data = json.loads(b.read().decode())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1311	    with urlopen(buildurl) as b:
1312	        data = json.loads(b.read().decode())
1313	        for build in data['builds']:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1311	    with urlopen(buildurl) as b:
1312	        data = json.loads(b.read().decode())
1313	        for build in data['builds']:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1321	def get_latest_fedora(arch='x86_64'):
1322	    request = Request('https://fedoraproject.org/cloud/download/_payload.json', headers={'Accept': 'application/json'})
1323	    for entry in json.loads(urlopen(request).read()):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1322	    request = Request('https://fedoraproject.org/cloud/download/_payload.json', headers={'Accept': 'application/json'})
1323	    for entry in json.loads(urlopen(request).read()):
1324	        if isinstance(entry, str) and entry.startswith('Cloud') and arch in entry and 'qcow2' in entry:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1322	    request = Request('https://fedoraproject.org/cloud/download/_payload.json', headers={'Accept': 'application/json'})
1323	    for entry in json.loads(urlopen(request).read()):
1324	        if isinstance(entry, str) and entry.startswith('Cloud') and arch in entry and 'qcow2' in entry:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1322	    request = Request('https://fedoraproject.org/cloud/download/_payload.json', headers={'Accept': 'application/json'})
1323	    for entry in json.loads(urlopen(request).read()):
1324	        if isinstance(entry, str) and entry.startswith('Cloud') and arch in entry and 'qcow2' in entry:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1326	            major = short.replace('Fedora-Cloud-Base-', '').split('-')[0]
1327	            return f"https://download.fedoraproject.org/pub/fedora/linux/releases/{major}/Cloud/{arch}/images/{short}"
1328	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1365	        if data['_type'] in ['kvm', 'ovirt']:
1366	            name = data['host'] if 'host' not in ['localhost', '127.0.0.1'] else 'local'
1367	    else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1441	        downloadcmd += f"; chmod u+x {binary}"
1442	        os.system(downloadcmd)
1443	    return binary

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1442
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1441	        downloadcmd += f"; chmod u+x {binary}"
1442	        os.system(downloadcmd)
1443	    return binary

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1553	            req.add_header(key, value)
1554	    response = urlopen(req, timeout=5, context=context)
1555	    data = response.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1554	    response = urlopen(req, timeout=5, context=context)
1555	    data = response.read()
1556	    return data.decode('utf-8')

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1554	    response = urlopen(req, timeout=5, context=context)
1555	    data = response.read()
1556	    return data.decode('utf-8')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1632	    pprint("Downloading kubectl in current directory")
1633	    el8 = os.path.exists('/etc/redhat-release') and 'release 8' in open('/etc/redhat-release').read()
1634	    if el8:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1632	    pprint("Downloading kubectl in current directory")
1633	    el8 = os.path.exists('/etc/redhat-release') and 'release 8' in open('/etc/redhat-release').read()
1634	    if el8:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1637	    elif version == 'latest':
1638	        r = urlopen("https://storage.googleapis.com/kubernetes-release/release/stable.txt")
1639	        version = str(r.read(), 'utf-8').strip()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1637	    elif version == 'latest':
1638	        r = urlopen("https://storage.googleapis.com/kubernetes-release/release/stable.txt")
1639	        version = str(r.read(), 'utf-8').strip()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1638	        r = urlopen("https://storage.googleapis.com/kubernetes-release/release/stable.txt")
1639	        version = str(r.read(), 'utf-8').strip()
1640	    else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1638	        r = urlopen("https://storage.googleapis.com/kubernetes-release/release/stable.txt")
1639	        version = str(r.read(), 'utf-8').strip()
1640	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1642	            version = f'v{version}'
1643	        url = "https://api.github.com/repos/kubernetes/kubernetes/releases?per_page=1000"
1644	        data = json.loads(urlopen(url, timeout=5).read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1643	        url = "https://api.github.com/repos/kubernetes/kubernetes/releases?per_page=1000"
1644	        data = json.loads(urlopen(url, timeout=5).read())
1645	        valid_versions = [line['tag_name'] for line in data]

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1643	        url = "https://api.github.com/repos/kubernetes/kubernetes/releases?per_page=1000"
1644	        data = json.loads(urlopen(url, timeout=5).read())
1645	        valid_versions = [line['tag_name'] for line in data]

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1643	        url = "https://api.github.com/repos/kubernetes/kubernetes/releases?per_page=1000"
1644	        data = json.loads(urlopen(url, timeout=5).read())
1645	        valid_versions = [line['tag_name'] for line in data]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1656	            return 1
1657	    kubecmd = "curl -LO https://storage.googleapis.com/kubernetes-release/release/%s/bin/%s/amd64/kubectl" % (version,
1658	                                                                                                              SYSTEM)
1659	    kubecmd += "; chmod 700 kubectl"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1669	    occmd = "curl -Ls "
1670	    el8 = os.path.exists('/etc/redhat-release') and 'release 8' in open('/etc/redhat-release').read()
1671	    if el8:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1669	    occmd = "curl -Ls "
1670	    el8 = os.path.exists('/etc/redhat-release') and 'release 8' in open('/etc/redhat-release').read()
1671	    if el8:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1675	        tag = f'latest-{tag}'
1676	    occmd += f"https://mirror.openshift.com/pub/openshift-v4/{arch}/clients/ocp/{tag}/openshift-client-{SYSTEM}.tar.gz"
1677	    occmd += "| tar zxf - oc"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1683	        if macosx:
1684	            occmd += f"https://mirror.openshift.com/pub/openshift-v4/x86_64/clients/ocp/{tag}/"
1685	            occmd += f"openshift-client-{SYSTEM}.tar.gz"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1701	        tag = f'latest-{tag}'
1702	    mirrorcmd += f"https://mirror.openshift.com/pub/openshift-v4/{arch}/clients/ocp/{tag}/oc-mirror.tar.gz"
1703	    mirrorcmd += "| tar zxf - oc-mirror"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1718	        version = f"v{version}"
1719	    helmcmd = f"curl -Ls https://get.helm.sh/helm-{version}-{SYSTEM}-amd64.tar.gz |"
1720	    helmcmd += f"tar zxf - --strip-components 1 {SYSTEM}-amd64/helm;"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1747	            with open(destfile, 'w') as f:
1748	                f.write(rendered)
1749	        if outputdir is None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1747	            with open(destfile, 'w') as f:
1748	                f.write(rendered)
1749	        if outputdir is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1781	            with open(f"{tmpdir}/{app_file}", 'w') as f:
1782	                f.write(rendered)
1783	        os.chdir(tmpdir)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1781	            with open(f"{tmpdir}/{app_file}", 'w') as f:
1782	                f.write(rendered)
1783	        os.chdir(tmpdir)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1819
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1818	            with open(destfile, 'w') as g:
1819	                g.write(rendered)
1820	        destfile = f"{outputdir or tmpdir}/install.yml"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1819
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1818	            with open(destfile, 'w') as g:
1819	                g.write(rendered)
1820	        destfile = f"{outputdir or tmpdir}/install.yml"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1823
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1822	            rendered = config.process_inputfile(cluster, f"{appdir}/install.yml.j2", overrides=appdata)
1823	            g.write(rendered)
1824	        destfile = f"{outputdir or tmpdir}/install.sh"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1823
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1822	            rendered = config.process_inputfile(cluster, f"{appdir}/install.yml.j2", overrides=appdata)
1823	            g.write(rendered)
1824	        destfile = f"{outputdir or tmpdir}/install.sh"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1825	        with open(destfile, 'w') as f:
1826	            f.write("oc create -f install.yml\n")
1827	            if os.path.exists(f"{appdir}/{appname}/pre.sh"):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1825	        with open(destfile, 'w') as f:
1826	            f.write("oc create -f install.yml\n")
1827	            if os.path.exists(f"{appdir}/{appname}/pre.sh"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1827	            if os.path.exists(f"{appdir}/{appname}/pre.sh"):
1828	                f.write("bash pre.sh\n")
1829	            if install_cr and os.path.exists(f"{appdir}/{appname}/cr.yml"):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1827	            if os.path.exists(f"{appdir}/{appname}/pre.sh"):
1828	                f.write("bash pre.sh\n")
1829	            if install_cr and os.path.exists(f"{appdir}/{appname}/cr.yml"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1832	                rendered = config.process_inputfile(cluster, f"{appdir}/cr.sh", overrides=cr_overrides)
1833	                f.write(rendered)
1834	            if os.path.exists(f"{appdir}/{appname}/post.sh"):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1832	                rendered = config.process_inputfile(cluster, f"{appdir}/cr.sh", overrides=cr_overrides)
1833	                f.write(rendered)
1834	            if os.path.exists(f"{appdir}/{appname}/post.sh"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1834	            if os.path.exists(f"{appdir}/{appname}/post.sh"):
1835	                f.write("\nbash post.sh\n")
1836	        if outputdir is None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1834	            if os.path.exists(f"{appdir}/{appname}/post.sh"):
1835	                f.write("\nbash post.sh\n")
1836	        if outputdir is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1869	            with open(destfile, 'w') as g:
1870	                g.write(rendered)
1871	        destfile = f"{tmpdir}/install.yml"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1869	            with open(destfile, 'w') as g:
1870	                g.write(rendered)
1871	        destfile = f"{tmpdir}/install.yml"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1874
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1873	            rendered = config.process_inputfile(cluster, f"{appdir}/install.yml.j2", overrides=appdata)
1874	            g.write(rendered)
1875	        destfile = f"{tmpdir}/uninstall.sh"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1874
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1873	            rendered = config.process_inputfile(cluster, f"{appdir}/install.yml.j2", overrides=appdata)
1874	            g.write(rendered)
1875	        destfile = f"{tmpdir}/uninstall.sh"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1877	            if os.path.exists(f"{tmpdir}/cr.yml"):
1878	                f.write("oc delete -f cr.yml\n")
1879	            f.write("oc delete -f install.yml")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1877	            if os.path.exists(f"{tmpdir}/cr.yml"):
1878	                f.write("oc delete -f cr.yml\n")
1879	            f.write("oc delete -f install.yml")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1879
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1878	                f.write("oc delete -f cr.yml\n")
1879	            f.write("oc delete -f install.yml")
1880	        os.chdir(tmpdir)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1879
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1878	                f.write("oc delete -f cr.yml\n")
1879	            f.write("oc delete -f install.yml")
1880	        os.chdir(tmpdir)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1887	    with open(f"{tmpdir}/user-data", 'w') as x:
1888	        x.write(userdata)
1889	    with open(f"{tmpdir}/meta-data", 'w') as y:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1887	    with open(f"{tmpdir}/user-data", 'w') as x:
1888	        x.write(userdata)
1889	    with open(f"{tmpdir}/meta-data", 'w') as y:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1889	    with open(f"{tmpdir}/meta-data", 'w') as y:
1890	        y.write(metadata)
1891	    if which('mkisofs') is None and which('genisoimage') is None and which('xorrisofs') is None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1889	    with open(f"{tmpdir}/meta-data", 'w') as y:
1890	        y.write(metadata)
1891	    if which('mkisofs') is None and which('genisoimage') is None and which('xorrisofs') is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1908
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1907	        if os.path.getsize(f"{tmpdir}/meta-data") == 0:
1908	            open(f"{tmpdir}/meta-data", 'w').write('{}')
1909	        move(f"{tmpdir}/meta-data", f"{tmpdir}/root/openstack/latest/meta_data.json")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1908
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1907	        if os.path.getsize(f"{tmpdir}/meta-data") == 0:
1908	            open(f"{tmpdir}/meta-data", 'w').write('{}')
1909	        move(f"{tmpdir}/meta-data", f"{tmpdir}/root/openstack/latest/meta_data.json")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1914	        with open(f"{tmpdir}/network-config", 'w') as z:
1915	            z.write(netdata)
1916	        if openstack:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1914	        with open(f"{tmpdir}/network-config", 'w') as z:
1915	            z.write(netdata)
1916	        if openstack:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1920	    isocmd += f" >/dev/null 2>{tmpdir}/error.log"
1921	    return os.system(isocmd)
1922	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1921
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1920	    isocmd += f" >/dev/null 2>{tmpdir}/error.log"
1921	    return os.system(isocmd)
1922	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1936	        path = f'{version}/latest' if version != 'latest' else 'latest'
1937	        liveiso = f"https://mirror.openshift.com/pub/openshift-v4/{arch}/dependencies/rhcos/{path}/{baseiso}"
1938	    kubevirt = 'kubevirt' in str(type(k))

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1961
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1960	        isocmd = create_embed_ignition_cmd(name, '/tmp', baseiso, extra_args=extra_args)
1961	        os.system(isocmd)
1962	        result = k.add_image(f'/tmp/{name}', pool, name=name)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1961
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1960	        isocmd = create_embed_ignition_cmd(name, '/tmp', baseiso, extra_args=extra_args)
1961	        os.system(isocmd)
1962	        result = k.add_image(f'/tmp/{name}', pool, name=name)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1973
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1972	    os.environ["PATH"] += f":{os.getcwd()}"
1973	    if installer and (k.conn == 'fake' or k.host in ['localhost', '127.0.0.1']):
1974	        if not correct_sha(f"{poolpath}/{baseiso}", get_installer_iso_sha()):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1979	    if k.conn == 'fake':
1980	        os.system(isocmd)
1981	    elif k.host in ['localhost', '127.0.0.1']:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1980
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1979	    if k.conn == 'fake':
1980	        os.system(isocmd)
1981	    elif k.host in ['localhost', '127.0.0.1']:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1980	        os.system(isocmd)
1981	    elif k.host in ['localhost', '127.0.0.1']:
1982	        if which('podman') is None:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1985	        copy2('iso.ign', poolpath)
1986	        os.system(isocmd)
1987	    elif k.protocol == 'ssh':

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1986
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1985	        copy2('iso.ign', poolpath)
1986	        os.system(isocmd)
1987	    elif k.protocol == 'ssh':

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1990
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1989	        createbindircmd = f'ssh {k.identitycommand} -p {k.port} {k.user}@{k.host} "mkdir bin >/dev/null 2>&1"'
1990	        os.system(createbindircmd)
1991	        scpbincmd = f'scp {k.identitycommand} -qP {k.port} coreos-installer {k.user}@{k.host}:bin'

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1990
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1989	        createbindircmd = f'ssh {k.identitycommand} -p {k.port} {k.user}@{k.host} "mkdir bin >/dev/null 2>&1"'
1990	        os.system(createbindircmd)
1991	        scpbincmd = f'scp {k.identitycommand} -qP {k.port} coreos-installer {k.user}@{k.host}:bin'

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1992
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1991	        scpbincmd = f'scp {k.identitycommand} -qP {k.port} coreos-installer {k.user}@{k.host}:bin'
1992	        os.system(scpbincmd)
1993	        scpcmd = f'scp {k.identitycommand} -qP {k.port} iso.ign {k.user}@{k.host}:{poolpath}'

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1992
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1991	        scpbincmd = f'scp {k.identitycommand} -qP {k.port} coreos-installer {k.user}@{k.host}:bin'
1992	        os.system(scpbincmd)
1993	        scpcmd = f'scp {k.identitycommand} -qP {k.port} iso.ign {k.user}@{k.host}:{poolpath}'

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1994
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1993	        scpcmd = f'scp {k.identitycommand} -qP {k.port} iso.ign {k.user}@{k.host}:{poolpath}'
1994	        os.system(scpcmd)
1995	        isocmd = f'ssh {k.identitycommand} -p {k.port} {k.user}@{k.host} "PATH=/root/bin {isocmd}"'

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1994
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1993	        scpcmd = f'scp {k.identitycommand} -qP {k.port} iso.ign {k.user}@{k.host}:{poolpath}'
1994	        os.system(scpcmd)
1995	        isocmd = f'ssh {k.identitycommand} -p {k.port} {k.user}@{k.host} "PATH=/root/bin {isocmd}"'

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1995	        isocmd = f'ssh {k.identitycommand} -p {k.port} {k.user}@{k.host} "PATH=/root/bin {isocmd}"'
1996	        os.system(isocmd)
1997	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:1996
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1995	        isocmd = f'ssh {k.identitycommand} -p {k.port} {k.user}@{k.host} "PATH=/root/bin {isocmd}"'
1996	        os.system(isocmd)
1997	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2006	        try:
2007	            data = json.loads(os.popen(manifestscmd).read())
2008	        except:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2006	        try:
2007	            data = json.loads(os.popen(manifestscmd).read())
2008	        except:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2006	        try:
2007	            data = json.loads(os.popen(manifestscmd).read())
2008	        except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2011	        manifestscmd = f"oc get packagemanifest -n openshift-marketplace {package} -o yaml 2>/dev/null"
2012	        data = yaml.safe_load(os.popen(manifestscmd).read())
2013	    if data is None:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2011	        manifestscmd = f"oc get packagemanifest -n openshift-marketplace {package} -o yaml 2>/dev/null"
2012	        data = yaml.safe_load(os.popen(manifestscmd).read())
2013	    if data is None:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2011	        manifestscmd = f"oc get packagemanifest -n openshift-marketplace {package} -o yaml 2>/dev/null"
2012	        data = yaml.safe_load(os.popen(manifestscmd).read())
2013	    if data is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2093	    if os.path.exists(git_file) and os.stat(git_file).st_size > 0:
2094	        data = open(git_file).read().rstrip().split(' ')
2095	        if len(data) == 2:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2093	    if os.path.exists(git_file) and os.stat(git_file).st_size > 0:
2094	        data = open(git_file).read().rstrip().split(' ')
2095	        if len(data) == 2:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2103	    with TemporaryDirectory() as tmpdir:
2104	        cmd = f"git clone -q https://github.com/karmab/kcli {tmpdir}"
2105	        call(cmd, shell=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2106	        os.chdir(tmpdir)
2107	        timestamp1 = os.popen(f"git show -s --format=%ct {commit1}").read().strip()
2108	        date1 = datetime.fromtimestamp(int(timestamp1))

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2106	        os.chdir(tmpdir)
2107	        timestamp1 = os.popen(f"git show -s --format=%ct {commit1}").read().strip()
2108	        date1 = datetime.fromtimestamp(int(timestamp1))

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2106	        os.chdir(tmpdir)
2107	        timestamp1 = os.popen(f"git show -s --format=%ct {commit1}").read().strip()
2108	        date1 = datetime.fromtimestamp(int(timestamp1))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2108	        date1 = datetime.fromtimestamp(int(timestamp1))
2109	        timestamp2 = os.popen(f"git show -s --format=%ct {commit2}").read().strip()
2110	        date2 = datetime.fromtimestamp(int(timestamp2))

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2108	        date1 = datetime.fromtimestamp(int(timestamp1))
2109	        timestamp2 = os.popen(f"git show -s --format=%ct {commit2}").read().strip()
2110	        date2 = datetime.fromtimestamp(int(timestamp2))

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2108	        date1 = datetime.fromtimestamp(int(timestamp1))
2109	        timestamp2 = os.popen(f"git show -s --format=%ct {commit2}").read().strip()
2110	        date2 = datetime.fromtimestamp(int(timestamp2))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2117	    with open(_file, "rb") as f:
2118	        for byte_block in iter(lambda: f.read(4096), b""):
2119	            sha256_hash.update(byte_block)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2117	    with open(_file, "rb") as f:
2118	        for byte_block in iter(lambda: f.read(4096), b""):
2119	            sha256_hash.update(byte_block)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2127	    arch = filename.split('.')[3]
2128	    url = "https://releases-art-rhcos.svc.ci.openshift.org/art/storage/releases/"
2129	    url += f"{openshift_version}/{minor_version}/{arch}/{filename}.gz"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2282	    with TemporaryDirectory() as tmpdir:
2283	        cmd = f"git clone -q https://github.com/karmab/kcli {tmpdir}"
2284	        call(cmd, shell=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2289	            call(cmd, shell=True)
2290	            return open(f"{tmpdir}/results.txt").read()
2291	        else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2289	            call(cmd, shell=True)
2290	            return open(f"{tmpdir}/results.txt").read()
2291	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2314	    with open(f"{clusterdir}/storage.sh", 'w') as f:
2315	        f.write(storage_data)
2316	    if apply:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2314	    with open(f"{clusterdir}/storage.sh", 'w') as f:
2315	        f.write(storage_data)
2316	    if apply:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2533	    while True:
2534	        if len(os.popen("kubectl get node -o name").readlines()) == number:
2535	            return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2584	    cloud_command = f'{kubectl} cluster-info'
2585	    if os.popen(openshift_command).read().strip() != '':
2586	        kubetype = 'openshift'

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2584	    cloud_command = f'{kubectl} cluster-info'
2585	    if os.popen(openshift_command).read().strip() != '':
2586	        kubetype = 'openshift'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2584	    cloud_command = f'{kubectl} cluster-info'
2585	    if os.popen(openshift_command).read().strip() != '':
2586	        kubetype = 'openshift'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2586	        kubetype = 'openshift'
2587	    elif 'eks.amazonaws.com' in os.popen(cloud_command).read().strip():
2588	        kubetype = 'eks'

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2586	        kubetype = 'openshift'
2587	    elif 'eks.amazonaws.com' in os.popen(cloud_command).read().strip():
2588	        kubetype = 'eks'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/common/__init__.py:2587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2586	        kubetype = 'openshift'
2587	    elif 'eks.amazonaws.com' in os.popen(cloud_command).read().strip():
2588	        kubetype = 'eks'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
473	        config_data['config_type'] = config_data.get('config_type', 'kvm')
474	        config_data['config_host'] = config_data.get('config_host', '127.0.0.1')
475	        default_user = getuser() if config_data['config_type'] == 'kvm'\

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
475	        default_user = getuser() if config_data['config_type'] == 'kvm'\
476	            and self.host in ['localhost', '127.0.0.1'] else 'root'
477	        config_data['config_user'] = config_data.get('config_user', default_user)

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
474	        config_data['config_host'] = config_data.get('config_host', '127.0.0.1')
475	        default_user = getuser() if config_data['config_type'] == 'kvm'\
476	            and self.host in ['localhost', '127.0.0.1'] else 'root'

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:475
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
474	        config_data['config_host'] = config_data.get('config_host', '127.0.0.1')
475	        default_user = getuser() if config_data['config_type'] == 'kvm'\
476	            and self.host in ['localhost', '127.0.0.1'] else 'root'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
716	            rhncommands = []
717	            if rhnserver != "https://subscription.rhsm.redhat.com" and not valid_ip(rhnserver):
718	                fqdn = os.path.basename(rhnserver)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
786	            if privatekeyfile is not None and publickeyfile is not None:
787	                privatekey = open(privatekeyfile).read().strip()
788	                publickey = open(publickeyfile).read().strip()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
787	                privatekey = open(privatekeyfile).read().strip()
788	                publickey = open(publickeyfile).read().strip()
789	                warning(f"Injecting private key in {name}")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
792	                files.append({'path': f'/home/{get_user(image)}/.ssh/id_rsa', 'content': privatekey})
793	                if self.host in ['127.0.0.1', 'localhost']:
794	                    authorized_keys_file = os.path.expanduser('~/.ssh/authorized_keys')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
803	                            with open(authorized_keys_file, 'a') as f:
804	                                f.write(f"\n{publickey}")
805	                    else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
803	                            with open(authorized_keys_file, 'a') as f:
804	                                f.write(f"\n{publickey}")
805	                    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:808
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
807	                        with open(authorized_keys_file, 'w') as f:
808	                            f.write(publickey)
809	                            os.chmod(authorized_keys_file, 0o600)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:808
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
807	                        with open(authorized_keys_file, 'w') as f:
808	                            f.write(publickey)
809	                            os.chmod(authorized_keys_file, 0o600)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:809
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
808	                            f.write(publickey)
809	                            os.chmod(authorized_keys_file, 0o600)
810	        if cmds and 'reboot' in cmds:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:809
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
808	                            f.write(publickey)
809	                            os.chmod(authorized_keys_file, 0o600)
810	        if cmds and 'reboot' in cmds:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:988
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
987	                    pprint(f"Running: {ansiblecommand}")
988	                    os.system(ansiblecommand)
989	        unplugcd = overrides.get('unplugcd', False)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:988
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
987	                    pprint(f"Running: {ansiblecommand}")
988	                    os.system(ansiblecommand)
989	        unplugcd = overrides.get('unplugcd', False)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:1423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1422	                                         tunneluser=self.tunneluser, insecure=True, cmd=cmd, vmport=vmport)
1423	                            os.system(sshcmd)
1424	                    c.delete(name, snapshots=True)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:1423
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1422	                                         tunneluser=self.tunneluser, insecure=True, cmd=cmd, vmport=vmport)
1423	                            os.system(sshcmd)
1424	                    c.delete(name, snapshots=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:1642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1641	            with open(inputfile, "w") as f:
1642	                f.write(inputstring)
1643	        if inputfile is None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:1642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1641	            with open(inputfile, "w") as f:
1642	                f.write(inputstring)
1643	        if inputfile is None:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:1659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1658	                os.chdir('..')
1659	                rmtree(path)
1660	            return {'result': 'success'}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:1695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1694	                    with open(f"{tmpdir}/pre.sh", 'w') as f:
1695	                        f.write(pre_script)
1696	                    pre_run = run(f'bash {tmpdir}/pre.sh', shell=True, stdout=PIPE, stderr=STDOUT,

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:1695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1694	                    with open(f"{tmpdir}/pre.sh", 'w') as f:
1695	                        f.write(pre_script)
1696	                    pre_run = run(f'bash {tmpdir}/pre.sh', shell=True, stdout=PIPE, stderr=STDOUT,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:1866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1865	                    new_args = (plan, kubetype, kube_overrides)
1866	                    t = threading.Thread(target=self.threaded_create_kube, args=new_args)
1867	                    threads.append(t)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2063	                    if not os.path.exists(f"{plan}.key") or not os.path.exists(f"{plan}.key.pub"):
2064	                        os.system(f"ssh-keygen -qt rsa -N '' -f {plan}.key")
2065	                    publickey = open(f"{plan}.key.pub").read().strip()

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2064
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
2063	                    if not os.path.exists(f"{plan}.key") or not os.path.exists(f"{plan}.key.pub"):
2064	                        os.system(f"ssh-keygen -qt rsa -N '' -f {plan}.key")
2065	                    publickey = open(f"{plan}.key.pub").read().strip()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2065
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2064	                        os.system(f"ssh-keygen -qt rsa -N '' -f {plan}.key")
2065	                    publickey = open(f"{plan}.key.pub").read().strip()
2066	                    privatekey = open(f"{plan}.key").read().strip()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2065	                    publickey = open(f"{plan}.key.pub").read().strip()
2066	                    privatekey = open(f"{plan}.key").read().strip()
2067	                    if 'keys' not in profile:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2091
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2090	                                onfly, onlyassets, newvms, failedvms, asyncwaitvms, newassets)
2091	                    t = threading.Thread(target=self.threaded_create_vm, args=new_args)
2092	                    threads.append(t)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2234	                pprint(f"Running: {ansiblecommand}")
2235	                os.system(ansiblecommand)
2236	        if lbs and not onlyassets:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2235
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
2234	                pprint(f"Running: {ansiblecommand}")
2235	                os.system(ansiblecommand)
2236	        if lbs and not onlyassets:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2297	        if toclean:
2298	            rmtree(path)
2299	        if inputstring is not None and os.path.exists(f"temp_plan_{plan}.yml"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2398	                    newini += line
2399	            open(inifile, 'w').write(newini)
2400	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2398	                    newini += line
2399	            open(inifile, 'w').write(newini)
2400	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2510	                                             identityfile=identityfile, password=False)
2511	                        if os.popen(testcmd).read().strip() != user:
2512	                            warning("Gathered ip not functional yet...")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2510	                                             identityfile=identityfile, password=False)
2511	                        if os.popen(testcmd).read().strip() != user:
2512	                            warning("Gathered ip not functional yet...")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2526	                                insecure=config.insecure, cmd=cmd, identityfile=identityfile, password=False)
2527	            output = os.popen(sshcmd).read()
2528	            if waitcommand is not None:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2526	                                insecure=config.insecure, cmd=cmd, identityfile=identityfile, password=False)
2527	            output = os.popen(sshcmd).read()
2528	            if waitcommand is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2563	                            identityfile=identityfile, password=False)
2564	        os.popen(sshcmd).read()
2565	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2563	                            identityfile=identityfile, password=False)
2564	        os.popen(sshcmd).read()
2565	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2834	            pprint(f"Deleting directory {clusterdir}")
2835	            rmtree(clusterdir)
2836	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2948
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
2947	            nodescmd = f'{kubectl} get node -o name'
2948	            nodes = [n.strip().replace('node/', '') for n in os.popen(nodescmd).readlines()]
2949	            for vm in self.k.list():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:2981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2980	                if minor_version.isdigit() and int(minor_version) < 6:
2981	                    metal_url = f"https://mirror.openshift.com/pub/openshift-v4/dependencies/rhcos/{iso_version}/latest"
2982	                    metal_url += "/rhcos-metal.x86_64.raw.gz"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3003	                sys.exit(1)
3004	            finaldata = open(ignitionfile).read()
3005	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3008	                warning(f"Using existing {ignitionfile}")
3009	                finaldata = open(ignitionfile).read()
3010	            else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3036
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
3035	                if hosts_content is not None:
3036	                    hosts_content = base64.b64encode(hosts_content.encode()).decode("UTF-8")
3037	                full_ip = api_ip

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3036
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
3035	                if hosts_content is not None:
3036	                    hosts_content = base64.b64encode(hosts_content.encode()).decode("UTF-8")
3037	                full_ip = api_ip

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3044	            if direct:
3045	                f.write(finaldata)
3046	            else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3044	            if direct:
3045	                f.write(finaldata)
3046	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3071
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3070	                else:
3071	                    f.write(result['userdata'])
3072	        if iso:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3071
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3070	                else:
3071	                    f.write(result['userdata'])
3072	        if iso:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3099	                     tunnelport=self.tunnelport, tunneluser=self.tunneluser, insecure=True, cmd=cmd, vmport=vmport)
3100	        os.system(sshcmd)
3101	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3100
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3099	                     tunnelport=self.tunnelport, tunneluser=self.tunneluser, insecure=True, cmd=cmd, vmport=vmport)
3100	        os.system(sshcmd)
3101	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3123	                sys.exit(1)
3124	            data['pull_secret'] = re.sub(r"\s", "", open(pull_secret).read())
3125	        registry_plan = f"{plan}-reuse" if registry_reuse else plan

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3140	                     tunnelport=self.tunnelport, tunneluser=self.tunneluser, insecure=True, cmd=cmd, vmport=vmport)
3141	        os.system(sshcmd)
3142	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3141
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3140	                     tunnelport=self.tunnelport, tunneluser=self.tunneluser, insecure=True, cmd=cmd, vmport=vmport)
3141	        os.system(sshcmd)
3142	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3158	                                tunneluser=self.tunneluser, download=True, insecure=True, identityfile=identityfile)
3159	            os.system(scpcmd)
3160	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3159
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3158	                                tunneluser=self.tunneluser, download=True, insecure=True, identityfile=identityfile)
3159	            os.system(scpcmd)
3160	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3177	                                                                                                  title)
3178	                    pbcmd += 'https://api.pushbullet.com/v2/pushes'
3179	                    cmds.append(pbcmd)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3186	                    slackcmd = f"info=`{notifycmd} 2>&1 | sed 's/\\x2/ /g'`;"
3187	                    slackcmd += """curl -X POST -H 'Authorization: Bearer %s'
3188	 -H 'Content-type: application/json; charset=utf-8'
3189	 --data '{"channel":"%s","text":"%s","attachments": [{"text":"'"$info"'","fallback":"nothing",
3190	"color":"#3AA3E3","attachment_type":"default"}]}' https://slack.com/api/chat.postMessage""" % (slacktoken,
3191	                                                                                               slackchannel, title)
3192	                    slackcmd = slackcmd.replace('\n', '')

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
3343	                                     cmd=pathdircmd, vmport=vmport)
3344	                    pathdirfiles = os.popen(pathdircmd).readlines()
3345	                    if len(pathdirfiles) == 1 and 'No such file or directory' in pathdirfiles[0]:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
3349	                                           cmd=createdircmd, vmport=vmport)
3350	                        os.popen(createdircmd)
3351	                        pathdirfiles = []

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3358	                    with open(source, 'w') as f:
3359	                        f.write(entry['content'])
3360	                    scpcmd = scp(name, ip=ip, user='root', source=source, destination=destination, tunnel=self.tunnel,

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3358	                    with open(source, 'w') as f:
3359	                        f.write(entry['content'])
3360	                    scpcmd = scp(name, ip=ip, user='root', source=source, destination=destination, tunnel=self.tunnel,

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3362	                                 download=False, insecure=True, vmport=vmport)
3363	                    os.system(scpcmd)
3364	                    updated_files.append(destination)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3363
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3362	                                 download=False, insecure=True, vmport=vmport)
3363	                    os.system(scpcmd)
3364	                    updated_files.append(destination)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
3387	        currentcmd += " | grep ' Ready'"
3388	        workers = len(os.popen(currentcmd).readlines())
3389	        pendingcmd = "kubectl get pods -A --field-selector=status.phase=Pending -o yaml"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3389	        pendingcmd = "kubectl get pods -A --field-selector=status.phase=Pending -o yaml"
3390	        pending_pods = yaml.safe_load(os.popen(pendingcmd).read())['items']
3391	        if len(pending_pods) > threshold:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
3389	        pendingcmd = "kubectl get pods -A --field-selector=status.phase=Pending -o yaml"
3390	        pending_pods = yaml.safe_load(os.popen(pendingcmd).read())['items']
3391	        if len(pending_pods) > threshold:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3399	        currentcmd = "kubectl get pod -A -o yaml"
3400	        allpods = yaml.safe_load(os.popen(currentcmd).read())['items']
3401	        for pod in allpods:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
3399	        currentcmd = "kubectl get pod -A -o yaml"
3400	        allpods = yaml.safe_load(os.popen(currentcmd).read())['items']
3401	        for pod in allpods:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
3432	            currentcmd += " | grep ' Ready'"
3433	            currentnodes = os.popen(currentcmd).readlines()
3434	            if len(currentnodes) != workers:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3450	        port = get_free_port()
3451	        t = threading.Thread(target=self.threaded_web_console, args=(port, name,))
3452	        t.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/config.py:3453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3452	        t.start()
3453	        webbrowser.open(f"http://127.0.0.1:{port}", new=2, autoraise=True)
3454	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
7	class Kcontainer():
8	    def __init__(self, host='127.0.0.1', user='root', port=22, engine='podman', debug=False, insecure=False):
9	        self.host = host

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
15	        self.insecure = insecure
16	        if self.host == '127.0.0.1' and which(engine) is None:
17	            reason = f"executable {engine} not found in path"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
18	            return {'result': 'failure', 'reason': reason}
19	        if self.host == '127.0.0.1' and os.path.exists("/i_am_a_container"):
20	            self.containermode = True

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
138	                runcommand += ' sh -c \\"%s\\"' % ';'.join(cmds)
139	            if self.host != '127.0.0.1':
140	                runcommand = f'ssh -p {self.port} {self.user}@{self.host} "{runcommand}"'

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
142	                print(runcommand)
143	            os.system(runcommand)
144	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:143
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
142	                print(runcommand)
143	            os.system(runcommand)
144	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
154	            rmcommand = f"{engine} rm -f {name}"
155	            if self.host != '127.0.0.1':
156	                rmcommand = f"ssh -p {self.port} {self.user}@{self.host} {rmcommand}"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
156	                rmcommand = f"ssh -p {self.port} {self.user}@{self.host} {rmcommand}"
157	            os.system(rmcommand)
158	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:157
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
156	                rmcommand = f"ssh -p {self.port} {self.user}@{self.host} {rmcommand}"
157	            os.system(rmcommand)
158	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
168	            startcommand = f"{engine} start {name}"
169	            if self.host != '127.0.0.1':
170	                startcommand = f"ssh -p {self.port} {self.user}@{self.host} {startcommand}"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
170	                startcommand = f"ssh -p {self.port} {self.user}@{self.host} {startcommand}"
171	            os.system(startcommand)
172	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:171
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
170	                startcommand = f"ssh -p {self.port} {self.user}@{self.host} {startcommand}"
171	            os.system(startcommand)
172	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
182	            stopcommand = f"{engine} stop {name}"
183	            if self.host != '127.0.0.1':
184	                stopcommand = f"ssh -p {self.port} {self.user}@{self.host} {stopcommand}"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
184	                stopcommand = f"ssh -p {self.port} {self.user}@{self.host} {stopcommand}"
185	            os.system(stopcommand)
186	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:185
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
184	                stopcommand = f"ssh -p {self.port} {self.user}@{self.host} {stopcommand}"
185	            os.system(stopcommand)
186	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
191	            attachcommand = f"{engine} attach {name}"
192	            os.system(attachcommand)
193	        else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:192
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
191	            attachcommand = f"{engine} attach {name}"
192	            os.system(attachcommand)
193	        else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
194	            attachcommand = f"{engine} attach {name}"
195	            if self.host != '127.0.0.1':
196	                attachcommand = f"ssh -t -p {self.port} {self.user}@{self.host} {attachcommand}"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
196	                attachcommand = f"ssh -t -p {self.port} {self.user}@{self.host} {attachcommand}"
197	            os.system(attachcommand)
198	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:197
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
196	                attachcommand = f"ssh -t -p {self.port} {self.user}@{self.host} {attachcommand}"
197	            os.system(attachcommand)
198	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
243	                print(lscommand)
244	            if self.host != '127.0.0.1':
245	                lscommand = f"ssh -p {self.port} {self.user}@{self.host} {lscommand}"

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
245	                lscommand = f"ssh -p {self.port} {self.user}@{self.host} {lscommand}"
246	            results = os.popen(lscommand).readlines()
247	            for container in results:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
274	            existcommand = "%s ps -a --format '{{.Names}}'" % engine
275	            if self.host != '127.0.0.1':
276	                existcommand = f"ssh -p {self.port} {self.user}@{self.host} {existcommand}"

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
276	                existcommand = f"ssh -p {self.port} {self.user}@{self.host} {existcommand}"
277	            results = os.popen(existcommand).readlines()
278	            for container in results:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
292	            lsicommand = "%s images --format '{{.Repository}}:{{.Tag}}'" % engine
293	            if self.host != '127.0.0.1':
294	                lsicommand = f"ssh -p {self.port} {self.user}@{self.host} {lsicommand}"

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/container/__init__.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
294	                lsicommand = f"ssh -p {self.port} {self.user}@{self.host} {lsicommand}"
295	            images = [image.strip() for image in os.popen(lsicommand).readlines()]
296	        return sorted(images)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/containerconfig.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
21	        if client == 'local':
22	            currentconfig = {'host': '127.0.0.1'}
23	        elif client == 'kubernetes':

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/containerconfig.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
36	        k8s = currentconfig.get('k8s', default_k8s)
37	        host = currentconfig.get('host', '127.0.0.1')
38	        if proxmox:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	OPENSHIFT_TAG = '4.18'
36	ALMA = 'https://repo.ifca.es/almalinux'
37	BSD = 'https://object-storage.public.mtl1.vexxhost.net/swift/v1/1dbafeefbd4f4c80864414a441e72dd2'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	ALMA = 'https://repo.ifca.es/almalinux'
37	BSD = 'https://object-storage.public.mtl1.vexxhost.net/swift/v1/1dbafeefbd4f4c80864414a441e72dd2'
38	BSD += '/bsd-cloud-image.org/images/dragonflybsd'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	BSD += '/bsd-cloud-image.org/images/dragonflybsd'
39	CENTOS = 'https://cloud.centos.org/centos'
40	DEBIAN = 'https://cdimage.debian.org/cdimage'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	CENTOS = 'https://cloud.centos.org/centos'
40	DEBIAN = 'https://cdimage.debian.org/cdimage'
41	EULER = 'https://mirror.accum.se/mirror/openeuler.org/openEuler'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	DEBIAN = 'https://cdimage.debian.org/cdimage'
41	EULER = 'https://mirror.accum.se/mirror/openeuler.org/openEuler'
42	FEDORA = 'http://mirror.uv.es/mirror/fedora/linux/releases'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	EULER = 'https://mirror.accum.se/mirror/openeuler.org/openEuler'
42	FEDORA = 'http://mirror.uv.es/mirror/fedora/linux/releases'
43	GENTOO = 'https://gentoo.osuosl.org/experimental/amd64/openstack'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	FEDORA = 'http://mirror.uv.es/mirror/fedora/linux/releases'
43	GENTOO = 'https://gentoo.osuosl.org/experimental/amd64/openstack'
44	RHCOS = 'https://mirror.openshift.com/pub/openshift-v4/dependencies/rhcos'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	GENTOO = 'https://gentoo.osuosl.org/experimental/amd64/openstack'
44	RHCOS = 'https://mirror.openshift.com/pub/openshift-v4/dependencies/rhcos'
45	ROCKY = 'https://dl.rockylinux.org/pub/rocky/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	RHCOS = 'https://mirror.openshift.com/pub/openshift-v4/dependencies/rhcos'
45	ROCKY = 'https://dl.rockylinux.org/pub/rocky/'
46	SUSE = 'https://download.opensuse.org'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	ROCKY = 'https://dl.rockylinux.org/pub/rocky/'
46	SUSE = 'https://download.opensuse.org'
47	UBUNTU = 'https://cloud-images.ubuntu.com/releases'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	SUSE = 'https://download.opensuse.org'
47	UBUNTU = 'https://cloud-images.ubuntu.com/releases'
48	IMAGES = {'almalinux8': f'{ALMA}/8/cloud/x86_64/images/AlmaLinux-8-GenericCloud-latest.x86_64.qcow2',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	          'almalinux9': f'{ALMA}/9/cloud/x86_64/images/AlmaLinux-9-GenericCloud-latest.x86_64.qcow2',
50	          'arch': 'https://linuximages.de/openstack/arch/arch-openstack-LATEST-image-bootstrap.qcow2',
51	          'centos7': f'{CENTOS}/7/images/CentOS-7-x86_64-GenericCloud.qcow2',
52	          'centos8stream': f'{CENTOS}/8-stream/x86_64/images/CentOS-Stream-GenericCloud-8-latest.x86_64.qcow2',
53	          'centos9stream': f'{CENTOS}/9-stream/x86_64/images/CentOS-Stream-GenericCloud-9-latest.x86_64.qcow2',
54	          'centos10stream': f'{CENTOS}/10-stream/x86_64/images/CentOS-Stream-GenericCloud-10-latest.x86_64.qcow2',
55	          'cirros': 'http://download.cirros-cloud.net/0.5.2/cirros-0.5.2-x86_64-disk.img',
56	          'debian10': f'{DEBIAN}/openstack/current-10/debian-10-openstack-amd64.qcow2',
57	          'debian11': f'{DEBIAN}/cloud/bullseye/latest/debian-11-generic-amd64.qcow2',
58	          'debian12': f'{DEBIAN}/cloud/bookworm/latest/debian-12-generic-amd64.qcow2',
59	          'fcos': 'https://builds.coreos.fedoraproject.org/streams/stable.json',
60	          'fedora37': f'{FEDORA}/37/Cloud/x86_64/images/Fedora-Cloud-Base-37-1.7.x86_64.qcow2',
61	          'fedora38': f'{FEDORA}/38/Cloud/x86_64/images/Fedora-Cloud-Base-38-1.6.x86_64.qcow2',
62	          'fedora39': f'{FEDORA}/39/Cloud/x86_64/images/Fedora-Cloud-Base-39-1.5.x86_64.qcow2',
63	          'fedora40': f'{FEDORA}/40/Cloud/x86_64/images/Fedora-Cloud-Base-Generic.x86_64-40-1.14.qcow2',
64	          'fedora41': f'{FEDORA}/41/Cloud/x86_64/images/Fedora-Cloud-Base-Generic-41-1.4.x86_64.qcow2',
65	          'fedoralatest': 'https://alt.fedoraproject.org/cloud',
66	          'freebsd122': f'{BSD}/freebsd/12.2/freebsd-12.2.qcow2',
67	          'freebsd130': f'{BSD}/freebsd/13.0/freebsd-13.0-zfs.qcow2',
68	          'netbsd82': f'{BSD}/netbsd/8.2/netbsd-8.2.qcow2',
69	          'netbsd92': f'{BSD}/netbsd/9.2/2021-12-11/netbsd-9.2.qcow2',
70	          'openbsd71': f'{BSD}/openbsd/7.1/2022-06-27/ufs/openbsd-7.1-2022-06-27.qcow2',
71	          'openbsd72': f'{BSD}/openbsd/7.2/2022-11-06/ufs/openbsd-7.2-2022-11-06.qcow2',
72	          'dragonflybsd601': f'{BSD}/dragonflybsd/6.0.1/2021-12-11/dragonflybsd-6.0.1-hammer2.qcow2',
73	          'dragonflybsd622': f'{BSD}/dragonflybsd/6.2.2/2022-09-06/hammer2/dragonflybsd-6.2.2-hammer2-2022-09-06.qcow2',
74	          'gentoo': f'{GENTOO}/gentoo-openstack-amd64-default-latest.qcow2',
75	          'openeuler2403': f'{EULER}-24.03-LTS/virtual_machine_img/x86_64/openEuler-24.03-LTS-x86_64.qcow2.xz',
76	          'openeuler2409': f'{EULER}-24.09/virtual_machine_img/x86_64/openEuler-24.09-x86_64.qcow2.xz',
77	          'opensuse155': f'{SUSE}/repositories/Cloud:/Images:/Leap_15.5/images/openSUSE-Leap-15.5.x86_64-NoCloud.qcow2',
78	          'opensuse156': f'{SUSE}/repositories/Cloud:/Images:/Leap_15.6/images/openSUSE-Leap-15.6.x86_64-NoCloud.qcow2',
79	          'rhcos410': f'{RHCOS}/4.10',
80	          'rhcos411': f'{RHCOS}/4.11',
81	          'rhcos412': f'{RHCOS}/4.12',
82	          'rhcos413': f'{RHCOS}/4.13',
83	          'rhcos414': f'{RHCOS}/4.14',
84	          'rhcos415': f'{RHCOS}/4.15',
85	          'rhcos416': f'{RHCOS}/4.16',
86	          'rhcos417': f'{RHCOS}/4.17',
87	          'rhcos418': f'{RHCOS}/4.18',
88	          'rhcoslatest': f'{RHCOS}/{OPENSHIFT_TAG}',
89	          'rhel7': 'https://access.redhat.com/downloads/content/69/ver=/rhel---7',
90	          'rhel8': 'https://access.redhat.com/downloads/content/479/ver=/rhel---8',
91	          'rhel9': 'https://access.redhat.com/downloads/content/479/ver=/rhel---9',
92	          'ubuntu1804': f'{UBUNTU}/18.04/release/ubuntu-18.04-server-cloudimg-amd64.img',
93	          'ubuntu2004': f'{UBUNTU}/20.04/release/ubuntu-20.04-server-cloudimg-amd64.img',
94	          'ubuntu2204': f'{UBUNTU}/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img',
95	          'ubuntu2304': f'{UBUNTU}/23.04/release/ubuntu-23.04-server-cloudimg-amd64.img',
96	          'ubuntu2310': f'{UBUNTU}/23.10/release/ubuntu-23.10-server-cloudimg-amd64.img',
97	          'ubuntu2404': f'{UBUNTU}/24.04/release/ubuntu-24.04-server-cloudimg-amd64.img',
98	          'ubuntu2410': f'{UBUNTU}/24.10/release/ubuntu-24.10-server-cloudimg-amd64.img',
99	          'rockylinux8': f'{ROCKY}/8/images/x86_64/Rocky-8-GenericCloud.latest.x86_64.qcow2',
100	          'rockylinux9': f'{ROCKY}/9/images/x86_64/Rocky-9-GenericCloud.latest.x86_64.qcow2'}
101	
102	IMAGESCOMMANDS = {'debian8': 'echo datasource_list: [NoCloud, ConfigDrive, Openstack, Ec2] > /etc/cloud/cloud.cfg.d/'
103	                  '90_dpkg.cfg'}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	          'centos10stream': f'{CENTOS}/10-stream/x86_64/images/CentOS-Stream-GenericCloud-10-latest.x86_64.qcow2',
55	          'cirros': 'http://download.cirros-cloud.net/0.5.2/cirros-0.5.2-x86_64-disk.img',
56	          'debian10': f'{DEBIAN}/openstack/current-10/debian-10-openstack-amd64.qcow2',
57	          'debian11': f'{DEBIAN}/cloud/bullseye/latest/debian-11-generic-amd64.qcow2',
58	          'debian12': f'{DEBIAN}/cloud/bookworm/latest/debian-12-generic-amd64.qcow2',
59	          'fcos': 'https://builds.coreos.fedoraproject.org/streams/stable.json',
60	          'fedora37': f'{FEDORA}/37/Cloud/x86_64/images/Fedora-Cloud-Base-37-1.7.x86_64.qcow2',
61	          'fedora38': f'{FEDORA}/38/Cloud/x86_64/images/Fedora-Cloud-Base-38-1.6.x86_64.qcow2',
62	          'fedora39': f'{FEDORA}/39/Cloud/x86_64/images/Fedora-Cloud-Base-39-1.5.x86_64.qcow2',
63	          'fedora40': f'{FEDORA}/40/Cloud/x86_64/images/Fedora-Cloud-Base-Generic.x86_64-40-1.14.qcow2',
64	          'fedora41': f'{FEDORA}/41/Cloud/x86_64/images/Fedora-Cloud-Base-Generic-41-1.4.x86_64.qcow2',
65	          'fedoralatest': 'https://alt.fedoraproject.org/cloud',
66	          'freebsd122': f'{BSD}/freebsd/12.2/freebsd-12.2.qcow2',
67	          'freebsd130': f'{BSD}/freebsd/13.0/freebsd-13.0-zfs.qcow2',
68	          'netbsd82': f'{BSD}/netbsd/8.2/netbsd-8.2.qcow2',
69	          'netbsd92': f'{BSD}/netbsd/9.2/2021-12-11/netbsd-9.2.qcow2',
70	          'openbsd71': f'{BSD}/openbsd/7.1/2022-06-27/ufs/openbsd-7.1-2022-06-27.qcow2',
71	          'openbsd72': f'{BSD}/openbsd/7.2/2022-11-06/ufs/openbsd-7.2-2022-11-06.qcow2',
72	          'dragonflybsd601': f'{BSD}/dragonflybsd/6.0.1/2021-12-11/dragonflybsd-6.0.1-hammer2.qcow2',
73	          'dragonflybsd622': f'{BSD}/dragonflybsd/6.2.2/2022-09-06/hammer2/dragonflybsd-6.2.2-hammer2-2022-09-06.qcow2',
74	          'gentoo': f'{GENTOO}/gentoo-openstack-amd64-default-latest.qcow2',
75	          'openeuler2403': f'{EULER}-24.03-LTS/virtual_machine_img/x86_64/openEuler-24.03-LTS-x86_64.qcow2.xz',
76	          'openeuler2409': f'{EULER}-24.09/virtual_machine_img/x86_64/openEuler-24.09-x86_64.qcow2.xz',
77	          'opensuse155': f'{SUSE}/repositories/Cloud:/Images:/Leap_15.5/images/openSUSE-Leap-15.5.x86_64-NoCloud.qcow2',
78	          'opensuse156': f'{SUSE}/repositories/Cloud:/Images:/Leap_15.6/images/openSUSE-Leap-15.6.x86_64-NoCloud.qcow2',
79	          'rhcos410': f'{RHCOS}/4.10',
80	          'rhcos411': f'{RHCOS}/4.11',
81	          'rhcos412': f'{RHCOS}/4.12',
82	          'rhcos413': f'{RHCOS}/4.13',
83	          'rhcos414': f'{RHCOS}/4.14',
84	          'rhcos415': f'{RHCOS}/4.15',
85	          'rhcos416': f'{RHCOS}/4.16',
86	          'rhcos417': f'{RHCOS}/4.17',
87	          'rhcos418': f'{RHCOS}/4.18',
88	          'rhcoslatest': f'{RHCOS}/{OPENSHIFT_TAG}',
89	          'rhel7': 'https://access.redhat.com/downloads/content/69/ver=/rhel---7',
90	          'rhel8': 'https://access.redhat.com/downloads/content/479/ver=/rhel---8',
91	          'rhel9': 'https://access.redhat.com/downloads/content/479/ver=/rhel---9',
92	          'ubuntu1804': f'{UBUNTU}/18.04/release/ubuntu-18.04-server-cloudimg-amd64.img',
93	          'ubuntu2004': f'{UBUNTU}/20.04/release/ubuntu-20.04-server-cloudimg-amd64.img',
94	          'ubuntu2204': f'{UBUNTU}/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img',
95	          'ubuntu2304': f'{UBUNTU}/23.04/release/ubuntu-23.04-server-cloudimg-amd64.img',
96	          'ubuntu2310': f'{UBUNTU}/23.10/release/ubuntu-23.10-server-cloudimg-amd64.img',
97	          'ubuntu2404': f'{UBUNTU}/24.04/release/ubuntu-24.04-server-cloudimg-amd64.img',
98	          'ubuntu2410': f'{UBUNTU}/24.10/release/ubuntu-24.10-server-cloudimg-amd64.img',
99	          'rockylinux8': f'{ROCKY}/8/images/x86_64/Rocky-8-GenericCloud.latest.x86_64.qcow2',
100	          'rockylinux9': f'{ROCKY}/9/images/x86_64/Rocky-9-GenericCloud.latest.x86_64.qcow2'}
101	
102	IMAGESCOMMANDS = {'debian8': 'echo datasource_list: [NoCloud, ConfigDrive, Openstack, Ec2] > /etc/cloud/cloud.cfg.d/'
103	                  '90_dpkg.cfg'}
104	INSECURE = True
105	KEYS = []
106	CMDS = []
107	SCRIPTS = []
108	FILES = []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	          'debian12': f'{DEBIAN}/cloud/bookworm/latest/debian-12-generic-amd64.qcow2',
59	          'fcos': 'https://builds.coreos.fedoraproject.org/streams/stable.json',
60	          'fedora37': f'{FEDORA}/37/Cloud/x86_64/images/Fedora-Cloud-Base-37-1.7.x86_64.qcow2',
61	          'fedora38': f'{FEDORA}/38/Cloud/x86_64/images/Fedora-Cloud-Base-38-1.6.x86_64.qcow2',
62	          'fedora39': f'{FEDORA}/39/Cloud/x86_64/images/Fedora-Cloud-Base-39-1.5.x86_64.qcow2',
63	          'fedora40': f'{FEDORA}/40/Cloud/x86_64/images/Fedora-Cloud-Base-Generic.x86_64-40-1.14.qcow2',
64	          'fedora41': f'{FEDORA}/41/Cloud/x86_64/images/Fedora-Cloud-Base-Generic-41-1.4.x86_64.qcow2',
65	          'fedoralatest': 'https://alt.fedoraproject.org/cloud',
66	          'freebsd122': f'{BSD}/freebsd/12.2/freebsd-12.2.qcow2',
67	          'freebsd130': f'{BSD}/freebsd/13.0/freebsd-13.0-zfs.qcow2',
68	          'netbsd82': f'{BSD}/netbsd/8.2/netbsd-8.2.qcow2',
69	          'netbsd92': f'{BSD}/netbsd/9.2/2021-12-11/netbsd-9.2.qcow2',
70	          'openbsd71': f'{BSD}/openbsd/7.1/2022-06-27/ufs/openbsd-7.1-2022-06-27.qcow2',
71	          'openbsd72': f'{BSD}/openbsd/7.2/2022-11-06/ufs/openbsd-7.2-2022-11-06.qcow2',
72	          'dragonflybsd601': f'{BSD}/dragonflybsd/6.0.1/2021-12-11/dragonflybsd-6.0.1-hammer2.qcow2',
73	          'dragonflybsd622': f'{BSD}/dragonflybsd/6.2.2/2022-09-06/hammer2/dragonflybsd-6.2.2-hammer2-2022-09-06.qcow2',
74	          'gentoo': f'{GENTOO}/gentoo-openstack-amd64-default-latest.qcow2',
75	          'openeuler2403': f'{EULER}-24.03-LTS/virtual_machine_img/x86_64/openEuler-24.03-LTS-x86_64.qcow2.xz',
76	          'openeuler2409': f'{EULER}-24.09/virtual_machine_img/x86_64/openEuler-24.09-x86_64.qcow2.xz',
77	          'opensuse155': f'{SUSE}/repositories/Cloud:/Images:/Leap_15.5/images/openSUSE-Leap-15.5.x86_64-NoCloud.qcow2',
78	          'opensuse156': f'{SUSE}/repositories/Cloud:/Images:/Leap_15.6/images/openSUSE-Leap-15.6.x86_64-NoCloud.qcow2',
79	          'rhcos410': f'{RHCOS}/4.10',
80	          'rhcos411': f'{RHCOS}/4.11',
81	          'rhcos412': f'{RHCOS}/4.12',
82	          'rhcos413': f'{RHCOS}/4.13',
83	          'rhcos414': f'{RHCOS}/4.14',
84	          'rhcos415': f'{RHCOS}/4.15',
85	          'rhcos416': f'{RHCOS}/4.16',
86	          'rhcos417': f'{RHCOS}/4.17',
87	          'rhcos418': f'{RHCOS}/4.18',
88	          'rhcoslatest': f'{RHCOS}/{OPENSHIFT_TAG}',
89	          'rhel7': 'https://access.redhat.com/downloads/content/69/ver=/rhel---7',
90	          'rhel8': 'https://access.redhat.com/downloads/content/479/ver=/rhel---8',
91	          'rhel9': 'https://access.redhat.com/downloads/content/479/ver=/rhel---9',
92	          'ubuntu1804': f'{UBUNTU}/18.04/release/ubuntu-18.04-server-cloudimg-amd64.img',
93	          'ubuntu2004': f'{UBUNTU}/20.04/release/ubuntu-20.04-server-cloudimg-amd64.img',
94	          'ubuntu2204': f'{UBUNTU}/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img',
95	          'ubuntu2304': f'{UBUNTU}/23.04/release/ubuntu-23.04-server-cloudimg-amd64.img',
96	          'ubuntu2310': f'{UBUNTU}/23.10/release/ubuntu-23.10-server-cloudimg-amd64.img',
97	          'ubuntu2404': f'{UBUNTU}/24.04/release/ubuntu-24.04-server-cloudimg-amd64.img',
98	          'ubuntu2410': f'{UBUNTU}/24.10/release/ubuntu-24.10-server-cloudimg-amd64.img',
99	          'rockylinux8': f'{ROCKY}/8/images/x86_64/Rocky-8-GenericCloud.latest.x86_64.qcow2',
100	          'rockylinux9': f'{ROCKY}/9/images/x86_64/Rocky-9-GenericCloud.latest.x86_64.qcow2'}
101	
102	IMAGESCOMMANDS = {'debian8': 'echo datasource_list: [NoCloud, ConfigDrive, Openstack, Ec2] > /etc/cloud/cloud.cfg.d/'
103	                  '90_dpkg.cfg'}
104	INSECURE = True
105	KEYS = []
106	CMDS = []
107	SCRIPTS = []
108	FILES = []
109	DNS = None
110	DOMAIN = None
111	ISO = None
112	GATEWAY = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	          'fedora41': f'{FEDORA}/41/Cloud/x86_64/images/Fedora-Cloud-Base-Generic-41-1.4.x86_64.qcow2',
65	          'fedoralatest': 'https://alt.fedoraproject.org/cloud',
66	          'freebsd122': f'{BSD}/freebsd/12.2/freebsd-12.2.qcow2',
67	          'freebsd130': f'{BSD}/freebsd/13.0/freebsd-13.0-zfs.qcow2',
68	          'netbsd82': f'{BSD}/netbsd/8.2/netbsd-8.2.qcow2',
69	          'netbsd92': f'{BSD}/netbsd/9.2/2021-12-11/netbsd-9.2.qcow2',
70	          'openbsd71': f'{BSD}/openbsd/7.1/2022-06-27/ufs/openbsd-7.1-2022-06-27.qcow2',
71	          'openbsd72': f'{BSD}/openbsd/7.2/2022-11-06/ufs/openbsd-7.2-2022-11-06.qcow2',
72	          'dragonflybsd601': f'{BSD}/dragonflybsd/6.0.1/2021-12-11/dragonflybsd-6.0.1-hammer2.qcow2',
73	          'dragonflybsd622': f'{BSD}/dragonflybsd/6.2.2/2022-09-06/hammer2/dragonflybsd-6.2.2-hammer2-2022-09-06.qcow2',
74	          'gentoo': f'{GENTOO}/gentoo-openstack-amd64-default-latest.qcow2',
75	          'openeuler2403': f'{EULER}-24.03-LTS/virtual_machine_img/x86_64/openEuler-24.03-LTS-x86_64.qcow2.xz',
76	          'openeuler2409': f'{EULER}-24.09/virtual_machine_img/x86_64/openEuler-24.09-x86_64.qcow2.xz',
77	          'opensuse155': f'{SUSE}/repositories/Cloud:/Images:/Leap_15.5/images/openSUSE-Leap-15.5.x86_64-NoCloud.qcow2',
78	          'opensuse156': f'{SUSE}/repositories/Cloud:/Images:/Leap_15.6/images/openSUSE-Leap-15.6.x86_64-NoCloud.qcow2',
79	          'rhcos410': f'{RHCOS}/4.10',
80	          'rhcos411': f'{RHCOS}/4.11',
81	          'rhcos412': f'{RHCOS}/4.12',
82	          'rhcos413': f'{RHCOS}/4.13',
83	          'rhcos414': f'{RHCOS}/4.14',
84	          'rhcos415': f'{RHCOS}/4.15',
85	          'rhcos416': f'{RHCOS}/4.16',
86	          'rhcos417': f'{RHCOS}/4.17',
87	          'rhcos418': f'{RHCOS}/4.18',
88	          'rhcoslatest': f'{RHCOS}/{OPENSHIFT_TAG}',
89	          'rhel7': 'https://access.redhat.com/downloads/content/69/ver=/rhel---7',
90	          'rhel8': 'https://access.redhat.com/downloads/content/479/ver=/rhel---8',
91	          'rhel9': 'https://access.redhat.com/downloads/content/479/ver=/rhel---9',
92	          'ubuntu1804': f'{UBUNTU}/18.04/release/ubuntu-18.04-server-cloudimg-amd64.img',
93	          'ubuntu2004': f'{UBUNTU}/20.04/release/ubuntu-20.04-server-cloudimg-amd64.img',
94	          'ubuntu2204': f'{UBUNTU}/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img',
95	          'ubuntu2304': f'{UBUNTU}/23.04/release/ubuntu-23.04-server-cloudimg-amd64.img',
96	          'ubuntu2310': f'{UBUNTU}/23.10/release/ubuntu-23.10-server-cloudimg-amd64.img',
97	          'ubuntu2404': f'{UBUNTU}/24.04/release/ubuntu-24.04-server-cloudimg-amd64.img',
98	          'ubuntu2410': f'{UBUNTU}/24.10/release/ubuntu-24.10-server-cloudimg-amd64.img',
99	          'rockylinux8': f'{ROCKY}/8/images/x86_64/Rocky-8-GenericCloud.latest.x86_64.qcow2',
100	          'rockylinux9': f'{ROCKY}/9/images/x86_64/Rocky-9-GenericCloud.latest.x86_64.qcow2'}
101	
102	IMAGESCOMMANDS = {'debian8': 'echo datasource_list: [NoCloud, ConfigDrive, Openstack, Ec2] > /etc/cloud/cloud.cfg.d/'
103	                  '90_dpkg.cfg'}
104	INSECURE = True
105	KEYS = []
106	CMDS = []
107	SCRIPTS = []
108	FILES = []
109	DNS = None
110	DOMAIN = None
111	ISO = None
112	GATEWAY = None
113	NETMASKS = []
114	SHAREDKEY = False
115	ENABLEROOT = True
116	PLANVIEW = False
117	PRIVATEKEY = False
118	TEMPKEY = False

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	          'rhcoslatest': f'{RHCOS}/{OPENSHIFT_TAG}',
89	          'rhel7': 'https://access.redhat.com/downloads/content/69/ver=/rhel---7',
90	          'rhel8': 'https://access.redhat.com/downloads/content/479/ver=/rhel---8',
91	          'rhel9': 'https://access.redhat.com/downloads/content/479/ver=/rhel---9',
92	          'ubuntu1804': f'{UBUNTU}/18.04/release/ubuntu-18.04-server-cloudimg-amd64.img',
93	          'ubuntu2004': f'{UBUNTU}/20.04/release/ubuntu-20.04-server-cloudimg-amd64.img',
94	          'ubuntu2204': f'{UBUNTU}/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img',
95	          'ubuntu2304': f'{UBUNTU}/23.04/release/ubuntu-23.04-server-cloudimg-amd64.img',
96	          'ubuntu2310': f'{UBUNTU}/23.10/release/ubuntu-23.10-server-cloudimg-amd64.img',
97	          'ubuntu2404': f'{UBUNTU}/24.04/release/ubuntu-24.04-server-cloudimg-amd64.img',
98	          'ubuntu2410': f'{UBUNTU}/24.10/release/ubuntu-24.10-server-cloudimg-amd64.img',
99	          'rockylinux8': f'{ROCKY}/8/images/x86_64/Rocky-8-GenericCloud.latest.x86_64.qcow2',
100	          'rockylinux9': f'{ROCKY}/9/images/x86_64/Rocky-9-GenericCloud.latest.x86_64.qcow2'}
101	
102	IMAGESCOMMANDS = {'debian8': 'echo datasource_list: [NoCloud, ConfigDrive, Openstack, Ec2] > /etc/cloud/cloud.cfg.d/'
103	                  '90_dpkg.cfg'}
104	INSECURE = True
105	KEYS = []
106	CMDS = []
107	SCRIPTS = []
108	FILES = []
109	DNS = None
110	DOMAIN = None
111	ISO = None
112	GATEWAY = None
113	NETMASKS = []
114	SHAREDKEY = False
115	ENABLEROOT = True
116	PLANVIEW = False
117	PRIVATEKEY = False
118	TEMPKEY = False
119	TAGS = []
120	NETWORKWAIT = 0
121	RHNREGISTER = True
122	RHNUNREGISTER = False
123	RHNSERVER = 'https://subscription.rhsm.redhat.com'
124	RHNUSER = None
125	RHNPASSWORD = None
126	RHNAK = None
127	RHNORG = None
128	RHNPOOL = None
129	FLAVOR = None
130	KEEP_NETWORKS = False
131	DNSCLIENT = None
132	STORE_METADATA = False
133	NOTIFY = False
134	PUSHBULLETTOKEN = None
135	SLACKTOKEN = None
136	MAILSERVER = None
137	MAILFROM = None
138	MAILTO = []
139	NOTIFYCMD = None
140	NOTIFYSCRIPT = None
141	SLACKCHANNEL = None
142	NOTIFYMETHODS = ['pushbullet']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	          'rhel7': 'https://access.redhat.com/downloads/content/69/ver=/rhel---7',
90	          'rhel8': 'https://access.redhat.com/downloads/content/479/ver=/rhel---8',
91	          'rhel9': 'https://access.redhat.com/downloads/content/479/ver=/rhel---9',
92	          'ubuntu1804': f'{UBUNTU}/18.04/release/ubuntu-18.04-server-cloudimg-amd64.img',
93	          'ubuntu2004': f'{UBUNTU}/20.04/release/ubuntu-20.04-server-cloudimg-amd64.img',
94	          'ubuntu2204': f'{UBUNTU}/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img',
95	          'ubuntu2304': f'{UBUNTU}/23.04/release/ubuntu-23.04-server-cloudimg-amd64.img',
96	          'ubuntu2310': f'{UBUNTU}/23.10/release/ubuntu-23.10-server-cloudimg-amd64.img',
97	          'ubuntu2404': f'{UBUNTU}/24.04/release/ubuntu-24.04-server-cloudimg-amd64.img',
98	          'ubuntu2410': f'{UBUNTU}/24.10/release/ubuntu-24.10-server-cloudimg-amd64.img',
99	          'rockylinux8': f'{ROCKY}/8/images/x86_64/Rocky-8-GenericCloud.latest.x86_64.qcow2',
100	          'rockylinux9': f'{ROCKY}/9/images/x86_64/Rocky-9-GenericCloud.latest.x86_64.qcow2'}
101	
102	IMAGESCOMMANDS = {'debian8': 'echo datasource_list: [NoCloud, ConfigDrive, Openstack, Ec2] > /etc/cloud/cloud.cfg.d/'
103	                  '90_dpkg.cfg'}
104	INSECURE = True
105	KEYS = []
106	CMDS = []
107	SCRIPTS = []
108	FILES = []
109	DNS = None
110	DOMAIN = None
111	ISO = None
112	GATEWAY = None
113	NETMASKS = []
114	SHAREDKEY = False
115	ENABLEROOT = True
116	PLANVIEW = False
117	PRIVATEKEY = False
118	TEMPKEY = False
119	TAGS = []
120	NETWORKWAIT = 0
121	RHNREGISTER = True
122	RHNUNREGISTER = False
123	RHNSERVER = 'https://subscription.rhsm.redhat.com'
124	RHNUSER = None
125	RHNPASSWORD = None
126	RHNAK = None
127	RHNORG = None
128	RHNPOOL = None
129	FLAVOR = None
130	KEEP_NETWORKS = False
131	DNSCLIENT = None
132	STORE_METADATA = False
133	NOTIFY = False
134	PUSHBULLETTOKEN = None
135	SLACKTOKEN = None
136	MAILSERVER = None
137	MAILFROM = None
138	MAILTO = []
139	NOTIFYCMD = None
140	NOTIFYSCRIPT = None
141	SLACKCHANNEL = None
142	NOTIFYMETHODS = ['pushbullet']
143	SHAREDFOLDERS = []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	          'rhel8': 'https://access.redhat.com/downloads/content/479/ver=/rhel---8',
91	          'rhel9': 'https://access.redhat.com/downloads/content/479/ver=/rhel---9',
92	          'ubuntu1804': f'{UBUNTU}/18.04/release/ubuntu-18.04-server-cloudimg-amd64.img',
93	          'ubuntu2004': f'{UBUNTU}/20.04/release/ubuntu-20.04-server-cloudimg-amd64.img',
94	          'ubuntu2204': f'{UBUNTU}/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img',
95	          'ubuntu2304': f'{UBUNTU}/23.04/release/ubuntu-23.04-server-cloudimg-amd64.img',
96	          'ubuntu2310': f'{UBUNTU}/23.10/release/ubuntu-23.10-server-cloudimg-amd64.img',
97	          'ubuntu2404': f'{UBUNTU}/24.04/release/ubuntu-24.04-server-cloudimg-amd64.img',
98	          'ubuntu2410': f'{UBUNTU}/24.10/release/ubuntu-24.10-server-cloudimg-amd64.img',
99	          'rockylinux8': f'{ROCKY}/8/images/x86_64/Rocky-8-GenericCloud.latest.x86_64.qcow2',
100	          'rockylinux9': f'{ROCKY}/9/images/x86_64/Rocky-9-GenericCloud.latest.x86_64.qcow2'}
101	
102	IMAGESCOMMANDS = {'debian8': 'echo datasource_list: [NoCloud, ConfigDrive, Openstack, Ec2] > /etc/cloud/cloud.cfg.d/'
103	                  '90_dpkg.cfg'}
104	INSECURE = True
105	KEYS = []
106	CMDS = []
107	SCRIPTS = []
108	FILES = []
109	DNS = None
110	DOMAIN = None
111	ISO = None
112	GATEWAY = None
113	NETMASKS = []
114	SHAREDKEY = False
115	ENABLEROOT = True
116	PLANVIEW = False
117	PRIVATEKEY = False
118	TEMPKEY = False
119	TAGS = []
120	NETWORKWAIT = 0
121	RHNREGISTER = True
122	RHNUNREGISTER = False
123	RHNSERVER = 'https://subscription.rhsm.redhat.com'
124	RHNUSER = None
125	RHNPASSWORD = None
126	RHNAK = None
127	RHNORG = None
128	RHNPOOL = None
129	FLAVOR = None
130	KEEP_NETWORKS = False
131	DNSCLIENT = None
132	STORE_METADATA = False
133	NOTIFY = False
134	PUSHBULLETTOKEN = None
135	SLACKTOKEN = None
136	MAILSERVER = None
137	MAILFROM = None
138	MAILTO = []
139	NOTIFYCMD = None
140	NOTIFYSCRIPT = None
141	SLACKCHANNEL = None
142	NOTIFYMETHODS = ['pushbullet']
143	SHAREDFOLDERS = []
144	CMDLINE = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/defaults.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	RHNUNREGISTER = False
123	RHNSERVER = 'https://subscription.rhsm.redhat.com'
124	RHNUSER = None

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/ekstoken.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
34	                                      HttpMethod="GET")
35	    encoded = base64.urlsafe_b64encode(data.encode("utf-8"))
36	    token = f'k8s-aws-v1.{encoded.decode("utf-8").rstrip("=")}'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/examples.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	
25	hostcreate = """# Add a KVM host
26	$ kcli create host kvm -H 192.168.1.6 twix
27	
28	# Add an aws host
29	$ kcli create host aws --access_key_id xxx  --access_key_secret xxx  -k KEYPAIR mypair -r eu-west-3 myaws
30	
31	# Add a gcp host
32	$ kcli create host gcp --credentials ~/.kcli/xx.json --project myproject-209909 --zone us-central1-b mygcp
33	
34	# Add an ovirt host
35	$ kcli create host ovirt -c mycluster -d mydatacenter -H 192.168.1.2 -u admin@internal -p pass -o org1 --pool x myovirt
36	
37	# Add a vsphere host
38	$ kcli create host vsphere -c mycluster -d mydatacenter -H 192.168.1.3 -u admin@xxx.es -p pass mysphere
39	
40	# Add an openstack host
41	$ kcli create host openstack --auth-url http://10.19.114.91:5000/v3 -u admin -p pass --project myproject myosp
42	
43	# Add a KubeVirt host using existing k8s credentials
44	$ kcli create host kubevirt mykubevirt
45	
46	# Add an ibm host
47	$ kcli create host ibm --iam_api_key xyz --vpc myvpc --zone eu-de -r eu-de-2 myibm
48	
49	# Add a proxmox host
50	$ kcil create host proxmox -H 192.168.1.4 --insecure -u root@pam -p pass --pool local-lvm myproxmox
51	
52	# Add a host group
53	$ kcli create host group --members [hypervisor1,hypervisor2] --algorithm random mygroup
54	"""
55	
56	providercreate = """# Install aws provider dependencies

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/examples.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	
84	plancreate = """# Create a plan named ocp311 from a file
85	$ kcli create plan -f multi.yml ocp311
86	
87	# Do the same but customize some parameters
88	$ kcli create plan -f multi.yml -P ctlplanes=1 -P nodes=2 -P crio=true
89	
90	# Create a plan from a remote url, customizing some parameters
91	$ kcli create plan -u https://github.com/karmab/kcli-plans/blob/main/kubernetes/kubernetes.yml -P ctlplanes=3
92	
93	# Skip pre check
94	$ kcli create plan -f multi.yml -P pre=false
95	
96	# Run plan treating vm with installer in its name as a workflow
97	$ kcli create plan -P installer_workflow=true
98	"""
99	
100	planinfo = """# Get info from a local plan file

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/examples.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	
100	planinfo = """# Get info from a local plan file
101	$ kcli info plan -f multi.yml
102	
103	# Get info of a plan with a remote url
104	$ kcli info plan -u https://github.com/karmab/kcli-plans/blob/main/kubernetes/kubernetes.yml
105	
106	# Get info for a specific running plan
107	$ kcli info plan myplan
108	
109	# Filter information for a specific plan
110	$ kcli info plan myplan -P field=status
111	
112	# Filter information for a specific plan and a specific vm
113	$ kcli info plan myplan -P field=status -P name=myvm01
114	
115	# Get all vms of a specific plan which are down
116	$ kcli info plan myplan -P field=status -P value=down
117	"""
118	
119	start = """# Start vms named vm1 and vm2

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/examples.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
413	
414	imagedownload = """# Download centos9stream image
415	$ kcli download image centos9stream
416	
417	# Download in specific pool
418	$ kcli download image centos9stream -P pool=mypool
419	
420	# Download specific arch
421	$ kcli download image centos9stream -P arch=aarch64
422	
423	# Execute commands after download
424	$ kcli download image centos9stream -P cmds=['echo welcome here > /etc/motd']
425	
426	# Download with specific name
427	$ kcli download image centos9stream -P name=centos9
428	
429	# Force the size (KubeVirt specific)
430	$ kcli download image rhcoslatest -P size=40
431	
432	# Download qemu variant for rhcos (KVM specific)
433	$ kcli download image rhcoslatest -P qemu=true
434	
435	# Download rhcos associated to current openshift-installer
436	$ kcli download image rhcoslatest -P installer=true
437	
438	# Download image from specific url
439	$ kcli download image -P url=http://super.qcow2 super
440	
441	# Alternative way
442	$ kcli download iso -u http://super.qcow2 super
443	"""
444	
445	isodownload = """# Download debian iso

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/examples.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
444	
445	isodownload = """# Download debian iso
446	$ kcli download iso -P url=https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/debian-12.6.0-amd64-netinst.iso
447	
448	# Alternative way
449	$ kcli download iso -u https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/debian-12.6.0-amd64-netinst.iso
450	
451	# Download iso to specific pool
452	$ kcli download iso -P url=http://super.iso -P pool=mypool
453	"""
454	
455	workflowcreate = """# Run workflow from a single script

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/examples.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
585	
586	starthost = """# Start a baremetal host
587	$ kcli start baremetal-host -P user=admin -P password=admin 10.10.10.10
588	
589	# Start a baremetal host with dedicated flags for credentials
590	$ kcli start baremetal-host -u admin -p admin 10.10.10.10
591	
592	# Start a baremetal host with a specific iso
593	$ kcli start baremetal-host -u admin -p admin -P iso_url=http://192.168.122.1/my.iso 10.10.10.10
594	"""
595	
596	stophost = """# Stop a baremetal host

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/expose/__init__.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
267	            if self.cluster and os.path.exists(kubeconfig):
268	                return open(kubeconfig).read()
269	            else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/expose/__init__.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
292	    def run(self):
293	        self.app.run(host='0.0.0.0', port=self.port)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/gketoken.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
18	    config = Kconfig(client)
19	    os.environ['GOOGLE_APPLICATION_CREDENTIALS'] = os.path.expanduser(config.options.get('credentials'))
20	    credentials, your_project_id = google.auth.default(scopes=["https://www.googleapis.com/auth/cloud-platform"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/gketoken.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    os.environ['GOOGLE_APPLICATION_CREDENTIALS'] = os.path.expanduser(config.options.get('credentials'))
20	    credentials, your_project_id = google.auth.default(scopes=["https://www.googleapis.com/auth/cloud-platform"])
21	    auth_req = google.auth.transport.requests.Request()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
31	        return None
32	    return str(b64encode(str(value).encode('utf-8')), 'utf-8')
33	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
31	        return None
32	    return str(b64encode(str(value).encode('utf-8')), 'utf-8')
33	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	        tag_name = 'name' if tag_mode else 'tag_name'
75	        data = json.loads(urlopen(f"https://api.github.com/repos/{repo}/{obj}", timeout=5).read())
76	        if 'message' in data and data['message'] == 'Not Found':

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
74	        tag_name = 'name' if tag_mode else 'tag_name'
75	        data = json.loads(urlopen(f"https://api.github.com/repos/{repo}/{obj}", timeout=5).read())
76	        if 'message' in data and data['message'] == 'Not Found':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	        tag_name = 'name' if tag_mode else 'tag_name'
75	        data = json.loads(urlopen(f"https://api.github.com/repos/{repo}/{obj}", timeout=5).read())
76	        if 'message' in data and data['message'] == 'Not Found':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
132	    c = "ip a s %s 2>/dev/null | grep -E 'inet6?[[:space:]][^fe]' |head -1| awk '{print $2}' | cut -d '/' -f 1" % net
133	    result = os.popen(c).read().strip()
134	    if result == '' and net == 'default':

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
132	    c = "ip a s %s 2>/dev/null | grep -E 'inet6?[[:space:]][^fe]' |head -1| awk '{print $2}' | cut -d '/' -f 1" % net
133	    result = os.popen(c).read().strip()
134	    if result == '' and net == 'default':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
135	        c = "ip a s virbr0 2>/dev/null | grep -E 'inet6?[[:space:]][^fe]' |head -1| awk '{print $2}' | cut -d '/' -f 1"
136	        result = os.popen(c).read().strip()
137	    if wrap and ':' in result:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
135	        c = "ip a s virbr0 2>/dev/null | grep -E 'inet6?[[:space:]][^fe]' |head -1| awk '{print $2}' | cut -d '/' -f 1"
136	        result = os.popen(c).read().strip()
137	    if wrap and ':' in result:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
157	        c = f"kcli {client_header} info vm -vf {key} {name}"
158	        result = os.popen(c).read().strip()
159	    else:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
157	        c = f"kcli {client_header} info vm -vf {key} {name}"
158	        result = os.popen(c).read().strip()
159	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
160	        c = f"kcli {client_header} info vm -o yaml {name}"
161	        result = yaml.load(os.popen(c).read())
162	    if result == '' and wait:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/jinjafilters/jinjafilters.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
160	        c = f"kcli {client_header} info vm -o yaml {name}"
161	        result = yaml.load(os.popen(c).read())
162	    if result == '' and wait:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	        request = Request(chassis_url, headers=headers)
52	        chassis = json.loads(urlopen(request, context=context).read())['Members'][0]['@odata.id']
53	    except Exception as e:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
51	        request = Request(chassis_url, headers=headers)
52	        chassis = json.loads(urlopen(request, context=context).read())['Members'][0]['@odata.id']
53	    except Exception as e:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
51	        request = Request(chassis_url, headers=headers)
52	        chassis = json.loads(urlopen(request, context=context).read())['Members'][0]['@odata.id']
53	    except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
58	    request = Request(request_url, headers=headers)
59	    manufacturer = json.loads(urlopen(request, context=context).read()).get('Manufacturer', '').lower()
60	    if 'dell' in manufacturer:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
58	    request = Request(request_url, headers=headers)
59	    manufacturer = json.loads(urlopen(request, context=context).read()).get('Manufacturer', '').lower()
60	    if 'dell' in manufacturer:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
58	    request = Request(request_url, headers=headers)
59	    manufacturer = json.loads(urlopen(request, context=context).read()).get('Manufacturer', '').lower()
60	    if 'dell' in manufacturer:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
80	        self.headers = {'Content-Type': 'application/json', 'Accept': 'application/json'}
81	        credentials = base64.b64encode(bytes(f'{user}:{password}', 'ascii')).decode('utf-8')
82	        self.headers["Authorization"] = f"Basic {credentials}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:81
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
80	        self.headers = {'Content-Type': 'application/json', 'Accept': 'application/json'}
81	        credentials = base64.b64encode(bytes(f'{user}:{password}', 'ascii')).decode('utf-8')
82	        self.headers["Authorization"] = f"Basic {credentials}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
98	        request = Request(self.url, headers=self.headers)
99	        response = json.loads(urlopen(request, context=self.context).read())
100	        ret_data = f"{self.baseurl}{response['Links']['ManagedBy'][0]['@odata.id']}"

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
98	        request = Request(self.url, headers=self.headers)
99	        response = json.loads(urlopen(request, context=self.context).read())
100	        ret_data = f"{self.baseurl}{response['Links']['ManagedBy'][0]['@odata.id']}"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
98	        request = Request(self.url, headers=self.headers)
99	        response = json.loads(urlopen(request, context=self.context).read())
100	        ret_data = f"{self.baseurl}{response['Links']['ManagedBy'][0]['@odata.id']}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	        request = Request(f'{manager_url}', headers=self.headers)
108	        results = json.loads(urlopen(request, context=self.context).read())
109	        if 'VirtualMedia' in results:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
107	        request = Request(f'{manager_url}', headers=self.headers)
108	        results = json.loads(urlopen(request, context=self.context).read())
109	        if 'VirtualMedia' in results:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
107	        request = Request(f'{manager_url}', headers=self.headers)
108	        results = json.loads(urlopen(request, context=self.context).read())
109	        if 'VirtualMedia' in results:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
113	        request = Request(f'{self.baseurl}{virtual_media_url}', headers=self.headers)
114	        results = json.loads(urlopen(request, context=self.context).read())
115	        if 'Oem' in results:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
113	        request = Request(f'{self.baseurl}{virtual_media_url}', headers=self.headers)
114	        results = json.loads(urlopen(request, context=self.context).read())
115	        if 'Oem' in results:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
113	        request = Request(f'{self.baseurl}{virtual_media_url}', headers=self.headers)
114	        results = json.loads(urlopen(request, context=self.context).read())
115	        if 'Oem' in results:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
135	        request = Request(iso_url, headers=self.headers)
136	        response = json.loads(urlopen(request, context=self.context).read())
137	        # Image can be set to '' or to None to indicate no image is configured

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
135	        request = Request(iso_url, headers=self.headers)
136	        response = json.loads(urlopen(request, context=self.context).read())
137	        # Image can be set to '' or to None to indicate no image is configured

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
135	        request = Request(iso_url, headers=self.headers)
136	        response = json.loads(urlopen(request, context=self.context).read())
137	        # Image can be set to '' or to None to indicate no image is configured

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
149	        else:
150	            actions = json.loads(urlopen(request, context=self.context).read())['Actions']
151	            target = '#IsoConfig.UnMount' if self.model == 'supermicro' and self.legacy else '#VirtualMedia.EjectMedia'

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
149	        else:
150	            actions = json.loads(urlopen(request, context=self.context).read())['Actions']
151	            target = '#IsoConfig.UnMount' if self.model == 'supermicro' and self.legacy else '#VirtualMedia.EjectMedia'

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
149	        else:
150	            actions = json.loads(urlopen(request, context=self.context).read())['Actions']
151	            target = '#IsoConfig.UnMount' if self.model == 'supermicro' and self.legacy else '#VirtualMedia.EjectMedia'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
162	        else:
163	            actions = json.loads(urlopen(request, context=self.context).read())['Actions']
164	            target = '#IsoConfig.Mount' if self.model == 'supermicro' and self.legacy else '#VirtualMedia.InsertMedia'

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
162	        else:
163	            actions = json.loads(urlopen(request, context=self.context).read())['Actions']
164	            target = '#IsoConfig.Mount' if self.model == 'supermicro' and self.legacy else '#VirtualMedia.InsertMedia'

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
162	        else:
163	            actions = json.loads(urlopen(request, context=self.context).read())['Actions']
164	            target = '#IsoConfig.Mount' if self.model == 'supermicro' and self.legacy else '#VirtualMedia.InsertMedia'

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
185	                pprint(f"Sending POST to {eject_url} with empty data")
186	        return urlopen(request, context=self.context)
187	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
198	            request = Request(cd_url, data=data, headers=self.headers, method='PATCH')
199	            urlopen(request, context=self.context)
200	            headers['Content-Length'] = 0

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
211	                pprint(f"Sending POST to {insert_url} with data {data}")
212	        return urlopen(request, context=self.context)
213	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
215	        request = Request(self.url, headers=self.headers)
216	        response = json.loads(urlopen(request, context=self.context).read())
217	        currentboot = response['Boot']

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
215	        request = Request(self.url, headers=self.headers)
216	        response = json.loads(urlopen(request, context=self.context).read())
217	        currentboot = response['Boot']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
215	        request = Request(self.url, headers=self.headers)
216	        response = json.loads(urlopen(request, context=self.context).read())
217	        currentboot = response['Boot']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
229	        request = Request(self.url, data=data, headers=self.headers, method='PATCH')
230	        return urlopen(request, context=self.context)
231	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	        request = Request(self.url, headers=self.headers)
234	        response = json.loads(urlopen(request, context=self.context).read())
235	        reset_type = 'On' if response['PowerState'] == 'Off' else 'ForceRestart'

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
233	        request = Request(self.url, headers=self.headers)
234	        response = json.loads(urlopen(request, context=self.context).read())
235	        reset_type = 'On' if response['PowerState'] == 'Off' else 'ForceRestart'

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
233	        request = Request(self.url, headers=self.headers)
234	        response = json.loads(urlopen(request, context=self.context).read())
235	        reset_type = 'On' if response['PowerState'] == 'Off' else 'ForceRestart'

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
241	        request = Request(reset_url, data=data, headers=self.headers)
242	        return urlopen(request, context=self.context)
243	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
254	        request = Request(reset_url, data=data, headers=self.headers)
255	        return urlopen(request, context=self.context)
256	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
263	        request = Request(reset_url, data=data, headers=self.headers)
264	        return urlopen(request, context=self.context)
265	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
267	        request = Request(self.url, headers=self.headers)
268	        response = json.loads(urlopen(request, context=self.context).read())
269	        return response['PowerState']

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
267	        request = Request(self.url, headers=self.headers)
268	        response = json.loads(urlopen(request, context=self.context).read())
269	        return response['PowerState']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
267	        request = Request(self.url, headers=self.headers)
268	        response = json.loads(urlopen(request, context=self.context).read())
269	        return response['PowerState']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
272	        request = Request(self.url, headers=self.headers)
273	        return json.loads(urlopen(request, context=self.context).read())
274	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
272	        request = Request(self.url, headers=self.headers)
273	        return json.loads(urlopen(request, context=self.context).read())
274	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
272	        request = Request(self.url, headers=self.headers)
273	        return json.loads(urlopen(request, context=self.context).read())
274	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
282	        request = Request(reset_url, headers=self.headers, method='POST', data=data)
283	        return urlopen(request, context=self.context)
284	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
317	        request = Request(secureboot_url, headers=self.headers)
318	        response = json.loads(urlopen(request, context=self.context).read())
319	        enabled = response['SecureBootEnable']

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
317	        request = Request(secureboot_url, headers=self.headers)
318	        response = json.loads(urlopen(request, context=self.context).read())
319	        enabled = response['SecureBootEnable']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
317	        request = Request(secureboot_url, headers=self.headers)
318	        response = json.loads(urlopen(request, context=self.context).read())
319	        enabled = response['SecureBootEnable']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
327	        request = Request(secureboot_url, headers=self.headers, method='PATCH', data=data)
328	        return urlopen(request, context=self.context)
329	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
332	        request = Request(secureboot_url, headers=self.headers)
333	        response = json.loads(urlopen(request, context=self.context).read())
334	        enabled = response['SecureBootEnable']

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
332	        request = Request(secureboot_url, headers=self.headers)
333	        response = json.loads(urlopen(request, context=self.context).read())
334	        enabled = response['SecureBootEnable']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
332	        request = Request(secureboot_url, headers=self.headers)
333	        response = json.loads(urlopen(request, context=self.context).read())
334	        enabled = response['SecureBootEnable']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kfish/__init__.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
342	        request = Request(secureboot_url, headers=self.headers, method='PATCH', data=data)
343	        return urlopen(request, context=self.context)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/ksushy/__init__.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
35	        cert = NamedTemporaryFile(delete=False)
36	        cert.write(FAKECERT.encode())
37	        cert.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/ksushy/__init__.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
35	        cert = NamedTemporaryFile(delete=False)
36	        cert.write(FAKECERT.encode())
37	        cert.close()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/ksushy/__init__.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
330	        self.ipv6 = 'KSUSHY_IPV6' in os.environ
331	        self.host = '::' if self.ipv6 else '0.0.0.0'
332	        self.bootonce = 'KSUSHY_BOOTONCE' in os.environ

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/ksushy/isoremover.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	    virEventRegisterDefaultImpl()
31	    eventLoopThread = Thread(target=virEventLoopNativeRun, name="libvirtEventLoop")
32	    eventLoopThread.setDaemon(True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
16	        cmd += f" -n {namespace}"
17	    return yaml.safe_load(os.popen(cmd).read())
18	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
16	        cmd += f" -n {namespace}"
17	    return yaml.safe_load(os.popen(cmd).read())
18	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
16	        cmd += f" -n {namespace}"
17	    return yaml.safe_load(os.popen(cmd).read())
18	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	def _delete_resource(kubectl, resource, name, namespace, debug=False):
21	    return os.popen(f'{kubectl} delete -n {namespace} {resource} {name} 2>/dev/null').read()
22	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
20	def _delete_resource(kubectl, resource, name, namespace, debug=False):
21	    return os.popen(f'{kubectl} delete -n {namespace} {resource} {name} 2>/dev/null').read()
22	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
20	def _delete_resource(kubectl, resource, name, namespace, debug=False):
21	    return os.popen(f'{kubectl} delete -n {namespace} {resource} {name} 2>/dev/null').read()
22	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
25	    namespace = f" -n {namespace}" if namespace is not None else ''
26	    return yaml.safe_load(os.popen(f'{kubectl} get {resource} {namespace} -o yaml {name} 2>/dev/null').read())
27	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
25	    namespace = f" -n {namespace}" if namespace is not None else ''
26	    return yaml.safe_load(os.popen(f'{kubectl} get {resource} {namespace} -o yaml {name} 2>/dev/null').read())
27	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
25	    namespace = f" -n {namespace}" if namespace is not None else ''
26	    return yaml.safe_load(os.popen(f'{kubectl} get {resource} {namespace} -o yaml {name} 2>/dev/null').read())
27	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
31	    cmd = f"{kubectl} get {resource} {namespace} -o yaml 2>/dev/null"
32	    return yaml.safe_load(os.popen(cmd).read())['items']
33	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
31	    cmd = f"{kubectl} get {resource} {namespace} -o yaml 2>/dev/null"
32	    return yaml.safe_load(os.popen(cmd).read())['items']
33	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
31	    cmd = f"{kubectl} get {resource} {namespace} -o yaml 2>/dev/null"
32	    return yaml.safe_load(os.popen(cmd).read())['items']
33	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	        print(f"REPLACE with {data}")
40	    return os.popen(f"echo '{json.dumps(data)}' | {kubectl} replace -n {namespace} -f -").read()
41	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
39	        print(f"REPLACE with {data}")
40	    return os.popen(f"echo '{json.dumps(data)}' | {kubectl} replace -n {namespace} -f -").read()
41	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
39	        print(f"REPLACE with {data}")
40	    return os.popen(f"echo '{json.dumps(data)}' | {kubectl} replace -n {namespace} -f -").read()
41	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	        print(f"PATCH {resource} {name} with {data}")
48	    return os.popen(f"{kubectl} patch -n {namespace} {resource} {name} -p '{json.dumps(data)}'").read()
49	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
47	        print(f"PATCH {resource} {name} with {data}")
48	    return os.popen(f"{kubectl} patch -n {namespace} {resource} {name} -p '{json.dumps(data)}'").read()
49	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
47	        print(f"PATCH {resource} {name} with {data}")
48	    return os.popen(f"{kubectl} patch -n {namespace} {resource} {name} -p '{json.dumps(data)}'").read()
49	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
54	    cmd = '%s config view --minify --output jsonpath="{.clusters[*].cluster.server}"' % kubectl
55	    baseurl = os.popen(cmd).read()
56	    url = f'{baseurl}/{subresource}'

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
54	    cmd = '%s config view --minify --output jsonpath="{.clusters[*].cluster.server}"' % kubectl
55	    baseurl = os.popen(cmd).read()
56	    url = f'{baseurl}/{subresource}'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
54	    cmd = '%s config view --minify --output jsonpath="{.clusters[*].cluster.server}"' % kubectl
55	    baseurl = os.popen(cmd).read()
56	    url = f'{baseurl}/{subresource}'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	    cmd = "%s config view -o jsonpath='{.clusters[0]}' --raw" % kubectl
58	    ca_cert_data = json.loads(os.popen(cmd).read())['cluster']['certificate-authority-data']
59	    ca_cert_file = NamedTemporaryFile(delete=False)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
57	    cmd = "%s config view -o jsonpath='{.clusters[0]}' --raw" % kubectl
58	    ca_cert_data = json.loads(os.popen(cmd).read())['cluster']['certificate-authority-data']
59	    ca_cert_file = NamedTemporaryFile(delete=False)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
57	    cmd = "%s config view -o jsonpath='{.clusters[0]}' --raw" % kubectl
58	    ca_cert_data = json.loads(os.popen(cmd).read())['cluster']['certificate-authority-data']
59	    ca_cert_file = NamedTemporaryFile(delete=False)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	    ca_cert_file = NamedTemporaryFile(delete=False)
60	    ca_cert_file.write(b64decode(ca_cert_data))
61	    ca_cert_file.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
59	    ca_cert_file = NamedTemporaryFile(delete=False)
60	    ca_cert_file.write(b64decode(ca_cert_data))
61	    ca_cert_file.close()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
59	    ca_cert_file = NamedTemporaryFile(delete=False)
60	    ca_cert_file.write(b64decode(ca_cert_data))
61	    ca_cert_file.close()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:60
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
59	    ca_cert_file = NamedTemporaryFile(delete=False)
60	    ca_cert_file.write(b64decode(ca_cert_data))
61	    ca_cert_file.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
63	    cmd = "%s config view -o jsonpath='{.users[0]}' --raw" % kubectl
64	    kubeconfig_data = json.loads(os.popen(cmd).read())
65	    kubeconfig_user = kubeconfig_data['user']

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
63	    cmd = "%s config view -o jsonpath='{.users[0]}' --raw" % kubectl
64	    kubeconfig_data = json.loads(os.popen(cmd).read())
65	    kubeconfig_user = kubeconfig_data['user']

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
63	    cmd = "%s config view -o jsonpath='{.users[0]}' --raw" % kubectl
64	    kubeconfig_data = json.loads(os.popen(cmd).read())
65	    kubeconfig_user = kubeconfig_data['user']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        client_cert_file = NamedTemporaryFile(delete=False)
69	        client_cert_file.write(b64decode(client_cert_data))
70	        client_cert_file.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
68	        client_cert_file = NamedTemporaryFile(delete=False)
69	        client_cert_file.write(b64decode(client_cert_data))
70	        client_cert_file.close()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
68	        client_cert_file = NamedTemporaryFile(delete=False)
69	        client_cert_file.write(b64decode(client_cert_data))
70	        client_cert_file.close()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
68	        client_cert_file = NamedTemporaryFile(delete=False)
69	        client_cert_file.write(b64decode(client_cert_data))
70	        client_cert_file.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	        client_key_file = NamedTemporaryFile(delete=False)
73	        client_key_file.write(b64decode(client_key_data))
74	        client_key_file.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
72	        client_key_file = NamedTemporaryFile(delete=False)
73	        client_key_file.write(b64decode(client_key_data))
74	        client_key_file.close()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
72	        client_key_file = NamedTemporaryFile(delete=False)
73	        client_key_file.write(b64decode(client_key_data))
74	        client_key_file.close()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:73
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
72	        client_key_file = NamedTemporaryFile(delete=False)
73	        client_key_file.write(b64decode(client_key_data))
74	        client_key_file.close()

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
79	    request = Request(url, headers=headers, method='PUT', data=data)
80	    urlopen(request, context=context)
81	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	    with NamedTemporaryFile(mode='w+') as tmp:
85	        tmp.write(data)
86	        tmp.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
84	    with NamedTemporaryFile(mode='w+') as tmp:
85	        tmp.write(data)
86	        tmp.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
87	        cmd = f"{kubectl} -n {namespace} create secret generic --from-file={field}={tmp.name} -o yaml {name}"
88	        return yaml.safe_load(os.popen(cmd).read())

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
87	        cmd = f"{kubectl} -n {namespace} create secret generic --from-file={field}={tmp.name} -o yaml {name}"
88	        return yaml.safe_load(os.popen(cmd).read())

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/kubecommon/__init__.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
87	        cmd = f"{kubectl} -n {namespace} create secret generic --from-file={field}={tmp.name} -o yaml {name}"
88	        return yaml.safe_load(os.popen(cmd).read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/miniconsole/__init__.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	                            with open(cert, 'w') as f:
48	                                f.write(FAKECERT)
49	                        websocketcommand = f"websockify {websocketport} -vD --idle-timeout=30"

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/miniconsole/__init__.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
52	                        websocketcommand = "websockify {websocketport} -vD --idle-timeout=30 {host}:{port}"
53	                os.popen(websocketcommand)
54	                sleep(5)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/miniconsole/__init__.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
65	    def run(self):
66	        data = {'host': '0.0.0.0', 'port': self.port}
67	        self.app.run(**data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
164	                return {'result': 'failure', 'reason': 'No public key found'}
165	            publickeyfile = open(publickeyfile).read()
166	            conn.import_key_pair(KeyName=keypair, PublicKeyMaterial=publickeyfile)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
366	                        with open(f"{tmpdir}/cloudinit", 'w') as f:
367	                            f.write(userdata)
368	                        self.upload_to_bucket(name, f'{tmpdir}/cloudinit', public=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
366	                        with open(f"{tmpdir}/cloudinit", 'w') as f:
367	                            f.write(userdata)
368	                        self.upload_to_bucket(name, f'{tmpdir}/cloudinit', public=True)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
377	                (overrides.get('spot_workers', False) and 'worker' in name)):
378	            userdata_encode = (b64encode(userdata.encode())).decode("utf-8")
379	            LaunchSpecification = {'SecurityGroups': SecurityGroupIds,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:378
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
377	                (overrides.get('spot_workers', False) and 'worker' in name)):
378	            userdata_encode = (b64encode(userdata.encode())).decode("utf-8")
379	            LaunchSpecification = {'SecurityGroups': SecurityGroupIds,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
532	        user = 'ec2-user'
533	        url = f"https://eu-west-3.console.aws.amazon.com/ec2/v2/connect/{user}/{instanceid}"
534	        if web:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
558	            publickeyfile = get_ssh_pub_key()
559	            publickeyfile = open(publickeyfile).read()
560	            self.iconnect.send_serial_console_ssh_public_key(InstanceId=instanceid, SerialPort=0,

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
562	            sshcommand = f'ssh {instanceid}.port0@serial-console.ec2-instance-connect.{self.region}.aws'
563	            code = os.WEXITSTATUS(os.system(sshcommand))
564	            sys.exit(code)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:563
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
562	            sshcommand = f'ssh {instanceid}.port0@serial-console.ec2-instance-connect.{self.region}.aws'
563	            code = os.WEXITSTATUS(os.system(sshcommand))
564	            sys.exit(code)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:1921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1920	                           region_name=self.region)
1921	        rolepolicy_document = open(f'{plandir}/assume_policy.json').read()
1922	        tags = [{'Key': 'Name', 'Value': name}]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:1924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1923	        iam.create_role(RoleName=name, AssumeRolePolicyDocument=rolepolicy_document, Tags=tags)
1924	        document = open(f'{plandir}/{role}_policy.json').read()
1925	        iam.put_role_policy(RoleName=name, PolicyName=name, PolicyDocument=document)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/aws/__init__.py:1962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1961	        document = 'trust_policy' if ctlplane else 'assume_policy'
1962	        rolepolicy_document = open(f'{plandir}/{document}.json').read()
1963	        tags = [{'Key': 'Name', 'Value': name}]

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/azure/__init__.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
354	                                            vmuser=vmuser)[0]
355	            custom_data = b64encode(userdata.encode('utf-8')).decode('latin-1')
356	            data['os_profile']['custom_data'] = custom_data

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/azure/__init__.py:355
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
354	                                            vmuser=vmuser)[0]
355	            custom_data = b64encode(userdata.encode('utf-8')).decode('latin-1')
356	            data['os_profile']['custom_data'] = custom_data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/azure/__init__.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
459	            user = f"{self.mail}.onmicrosoft.com"
460	        url = f"https://portal.azure.com/?quickstart=true#@{user}/"
461	        url += f"resource/subscriptions/{self.subscription_id}/resourceGroups/kcli/providers/"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/azure/__init__.py:1000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
999	            blob_name = os.path.basename(path)
1000	            download_file.write(container_client.download_blob(blob_name).readall())
1001	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/fake/__init__.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
12	    def add_image(self, url, pool, cmds=[], name=None, size=None, convert=False):
13	        os.system("curl -Lk %s > %s" % (url, os.path.basename(url)))
14	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/fake/__init__.py:13
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
12	    def add_image(self, url, pool, cmds=[], name=None, size=None, convert=False):
13	        os.system("curl -Lk %s > %s" % (url, os.path.basename(url)))
14	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	def build_request(http, *args, **kwargs):
24	    credentials = default(scopes=['https://www.googleapis.com/auth/cloud-platform'])[0]
25	    new_http = AuthorizedHttp(credentials, http=Http())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    def __init__(self, project, region='europe-west1', zone=None, debug=False):
35	        credentials = default(scopes=['https://www.googleapis.com/auth/cloud-platform'])[0]
36	        authorized_http = AuthorizedHttp(credentials, http=Http())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
267	                if image.startswith('rhcos'):
268	                    src = f"https://www.googleapis.com/compute/v1/projects/rhcos-cloud/global/images/{image}"
269	                else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
307	        body['serviceAccounts'] = [{'email': 'default',
308	                                    'scopes': ['https://www.googleapis.com/auth/devstorage.read_write',
309	                                               'https://www.googleapis.com/auth/logging.write']}]
310	        body['labels'] = {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
308	                                    'scopes': ['https://www.googleapis.com/auth/devstorage.read_write',
309	                                               'https://www.googleapis.com/auth/logging.write']}]
310	        body['labels'] = {}
311	        body['metadata'] = {'items': []}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
317	            if publickeyfile is not None:
318	                publickeyfile = open(publickeyfile).read().strip()
319	                keys = [publickeyfile]

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
322	            if user == 'root':
323	                user = getuser()
324	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:323
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
322	            if user == 'root':
323	                user = getuser()
324	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
407	                    email = f'{sa}@{self.project}.iam.gserviceaccount.com' if '@' not in sa else sa
408	                    serviceaccounts.append({'email': email, 'scopes': ['https://www.googleapis.com/auth/compute']})
409	                elif isinstance(sa, dict) and 'email' in sa:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
410	                    if 'scope' not in sa:
411	                        sa['scopes'] = ['https://www.googleapis.com/auth/compute']
412	                    serviceaccounts.append(sa)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
416	                serviceaccounts.append({'email': 'default',
417	                                        'scopes': ['https://www.googleapis.com/auth/cloud-platform']})
418	            if serviceaccounts:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
569	        url = f"{project}/zones/{zone}/instances/{name}?authuser=1&hl=en_US&projectNumber={projectnumber}"
570	        url = f"https://ssh.cloud.google.com/projects/{url}"
571	        if web:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
597	            print(sshcommand)
598	        os.system(sshcommand)
599	        return

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:598
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
597	            print(sshcommand)
598	        os.system(sshcommand)
599	        return

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
829	        else:
830	            url = f"https://www.googleapis.com/compute/v1/projects/{project}/zones/{zone}/machineTypes/{flavor}"
831	            body = {"machineType": url}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:852
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
851	                return {'result': 'success'}
852	            url = f"https://www.googleapis.com/compute/v1/projects/{project}/zones/{zone}/machineTypes"
853	            newmachinetype = f"{url}/custom-{currentcpus}-{memory}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:877
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
876	                return {'result': 'success'}
877	            url = f"https://www.googleapis.com/compute/v1/projects/{project}/zones/{zone}/machineTypes"
878	            newmachinetype = f"{url}/custom-{numcpus}-{currentmemory}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:1150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1149	        networkpath = operation["targetLink"]
1150	        regionpath = f"https://www.googleapis.com/compute/v1/projects/{project}/regions/{region}"
1151	        subnet_body.update({'network': networkpath, "region": regionpath})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:1532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1531	        instances = []
1532	        vmpath = f"https://www.googleapis.com/compute/v1/projects/{project}/zones/{zone}/instances"
1533	        use_xproject = False

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:1780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1779	            acl = bucket.acl
1780	            acl.all().grant_read()
1781	            acl.save()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:1840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1839	            acl = storage.acl.ObjectACL(blob)
1840	            acl.all().grant_read()
1841	            acl.save()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:1857
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1856	    def public_bucketfile_url(self, bucket, path):
1857	        return f"https://storage.googleapis.com/{bucket}/{path}"
1858	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:1988
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1987	        networkpath = self.conn.networks().get(project=project, network=network_name).execute()['selfLink']
1988	        regionpath = f"https://www.googleapis.com/compute/v1/projects/{project}/regions/{region}"
1989	        cidr_type = "ipv6_cidr_range" if cidr_version == '6' else "ipCidrRange"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/gcp/__init__.py:2119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2118	        zone = self.zone
2119	        vmpath = f"https://www.googleapis.com/compute/v1/projects/{project}/zones/{zone}/instances"
2120	        instances_body = {"instances": [{"instance": f"{vmpath}/{vm}"}]}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/hcloud/__init__.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	            if publickeyfile is not None:
58	                publickeyfile = open(publickeyfile).read().strip()
59	                keys = [publickeyfile]

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/hcloud/__init__.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
64	            if user == 'root':
65	                user = getuser()
66	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/hcloud/__init__.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
64	            if user == 'root':
65	                user = getuser()
66	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/hcloud/__init__.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
67	            for key in keys:
68	                decoded_key = base64.b64decode(key.strip().split()[1].encode('ascii'))
69	                hashed_key = hashlib.md5(decoded_key).hexdigest()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/hcloud/__init__.py:68
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
67	            for key in keys:
68	                decoded_key = base64.b64decode(key.strip().split()[1].encode('ascii'))
69	                hashed_key = hashlib.md5(decoded_key).hexdigest()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/hcloud/__init__.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
448	    def add_image(self, url, pool, cmd=None, name=None, size=None, convert=False):
449	        os.system("curl -Lk %s > %s" % (url, os.path.basename(url)))
450	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/hcloud/__init__.py:449
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
448	    def add_image(self, url, pool, cmd=None, name=None, size=None, convert=False):
449	        os.system("curl -Lk %s > %s" % (url, os.path.basename(url)))
450	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	def get_s3_endpoint(region):
29	    return f'https://s3.{region}.cloud-object-storage.appdomain.cloud'
30	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    data = data.encode()
39	    req = Request("https://iam.cloud.ibm.com/identity/token", headers=headers, method='POST', data=data)
40	    token = json.loads(urlopen(req).read().decode())['access_token']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	    req = Request("https://iam.cloud.ibm.com/identity/token", headers=headers, method='POST', data=data)
40	    token = json.loads(urlopen(req).read().decode())['access_token']
41	    headers = {'Authorization': f'Bearer {token}'}

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
39	    req = Request("https://iam.cloud.ibm.com/identity/token", headers=headers, method='POST', data=data)
40	    token = json.loads(urlopen(req).read().decode())['access_token']
41	    headers = {'Authorization': f'Bearer {token}'}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    headers = {'Authorization': f'Bearer {token}'}
42	    req = Request("https://resource-controller.cloud.ibm.com/v2/resource_instances", headers=headers)
43	    for entry in json.loads(urlopen(req).read())['resources']:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	    req = Request("https://resource-controller.cloud.ibm.com/v2/resource_instances", headers=headers)
43	    for entry in json.loads(urlopen(req).read())['resources']:
44	        if entry['name'] == name:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
42	    req = Request("https://resource-controller.cloud.ibm.com/v2/resource_instances", headers=headers)
43	    for entry in json.loads(urlopen(req).read())['resources']:
44	        if entry['name'] == name:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	                ibm_service_instance_id=cos_resource_instance_id,
67	                ibm_auth_endpoint="https://iam.bluemix.net/oidc/token",
68	                config=Config(signature_version="oauth"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        self.global_tagging_service = GlobalTaggingV1(authenticator=self.authenticator)
73	        self.global_tagging_service.set_service_url('https://tags.global-search-tagging.cloud.ibm.com')
74	        if cis_resource_instance_id is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	            self.dns = ZonesV1(authenticator=self.authenticator, crn=cis_resource_instance_id)
77	            self.dns.set_service_url('https://api.cis.cloud.ibm.com')
78	            self.cis_resource_instance_id = cis_resource_instance_id

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        self.resources = ResourceControllerV2(authenticator=self.authenticator)
80	        self.resources.set_service_url('https://resource-controller.cloud.ibm.com')
81	        self.iam_api_key = iam_api_key

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
141	                _type = identityfile.split('_')[-1]
142	                public_key = open(publickeyfile).read()
143	                new_key = self.conn.create_key(public_key, name='kvirt', resource_group=resource_group, type=_type)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
375	        try:
376	            url = f"https://cloud.ibm.com/vpc-ext/compute/vs/{self.region}~{vm['id']}/vnc"
377	        except ApiException as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
399	        try:
400	            url = f"https://cloud.ibm.com/vpc-ext/compute/vs/{self.region}~{vm['id']}/serial"
401	        except ApiException as e:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
784	                downloadcmd = f"curl -Lko /tmp/{shortimage} -f '{url}'"
785	                code = os.system(downloadcmd)
786	                if code != 0:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
784	                downloadcmd = f"curl -Lko /tmp/{shortimage} -f '{url}'"
785	                code = os.system(downloadcmd)
786	                if code != 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:785
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
784	                downloadcmd = f"curl -Lko /tmp/{shortimage} -f '{url}'"
785	                code = os.system(downloadcmd)
786	                if code != 0:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
790	                    uncompresscmd = f"gunzip /tmp/{shortimage}"
791	                    os.system(uncompresscmd)
792	                else:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
790	                    uncompresscmd = f"gunzip /tmp/{shortimage}"
791	                    os.system(uncompresscmd)
792	                else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:791
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
790	                    uncompresscmd = f"gunzip /tmp/{shortimage}"
791	                    os.system(uncompresscmd)
792	                else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ibm/__init__.py:1226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1225	    def public_bucketfile_url(self, bucket, path):
1226	        return f"https://s3.direct.{self.region}.cloud-object-storage.appdomain.cloud/{bucket}/{path}"
1227	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	CONTAINERDISKS = [f'{container}:latest' for container in CONTAINERDISKS]
39	KUBECTL_LINUX = "https://storage.googleapis.com/kubernetes-release/release/v1.16.1/bin/linux/amd64/kubectl"
40	KUBECTL_MACOSX = KUBECTL_LINUX.replace('linux', 'darwin')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
562	            port = 3389 if windows else 22
563	            if os.popen(f'{kubectl} get svc -n {namespace} {name}-{svc} >/dev/null 2>&1').read() == '':
564	                selector = {'kubevirt.io/provider': 'kcli', 'kubevirt.io/domain': name}

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
562	            port = 3389 if windows else 22
563	            if os.popen(f'{kubectl} get svc -n {namespace} {name}-{svc} >/dev/null 2>&1').read() == '':
564	                selector = {'kubevirt.io/provider': 'kcli', 'kubevirt.io/domain': name}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
616	        cmd = '%s config view --minify --output jsonpath="{.clusters[*].cluster.server}"' % kubectl
617	        data['connection'] = os.popen(cmd).read()
618	        data['namespace'] = self.namespace

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
616	        cmd = '%s config view --minify --output jsonpath="{.clusters[*].cluster.server}"' % kubectl
617	        data['connection'] = os.popen(cmd).read()
618	        data['namespace'] = self.namespace

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
623	        namespace = self.namespace
624	        if os.popen(f'{kubectl} get vm -n {namespace} {name}').read() == '':
625	            return None

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
623	        namespace = self.namespace
624	        if os.popen(f'{kubectl} get vm -n {namespace} {name}').read() == '':
625	            return None

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
666	        nccmd += " &"
667	        os.system(nccmd)
668	        forwardcmd = f'KUBECONFIG={self.kubeconfig_file} ' if self.kubeconfig_file is not None else ''

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:667
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
666	        nccmd += " &"
667	        os.system(nccmd)
668	        forwardcmd = f'KUBECONFIG={self.kubeconfig_file} ' if self.kubeconfig_file is not None else ''

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
669	        forwardcmd += f"{kubectl} port-forward {podname} {localport}:{localport} &"
670	        os.system(forwardcmd)
671	        time.sleep(5)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:670
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
669	        forwardcmd += f"{kubectl} port-forward {podname} {localport}:{localport} &"
670	        os.system(forwardcmd)
671	        time.sleep(5)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
685	        else:
686	            os.system(consolecommand)
687	        return

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:686
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
685	        else:
686	            os.system(consolecommand)
687	        return

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
707	            return nccmd
708	        os.system(nccmd)
709	        return

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:708
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
707	            return nccmd
708	        os.system(nccmd)
709	        return

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:1324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1323	                if os.path.exists(_fil):
1324	                    data[_fil_name] = open(_fil).read()
1325	                else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:1361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1360	        podname = f'{now}-{pvc}-patch'
1361	        os.popen(f"{kubectl} -n {namespace} create cm --from-file=iso.ign {podname}").read()
1362	        container = {'image': coreos_installer_image, 'name': 'patch', 'command': ['/bin/sh', '-c']}

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:1361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1360	        podname = f'{now}-{pvc}-patch'
1361	        os.popen(f"{kubectl} -n {namespace} create cm --from-file=iso.ign {podname}").read()
1362	        container = {'image': coreos_installer_image, 'name': 'patch', 'command': ['/bin/sh', '-c']}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:1379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1378	            _delete_resource(kubectl, 'pod', podname, namespace, debug=self.debug)
1379	        os.popen(f"{kubectl} -n {namespace} delete cm {podname}").read()
1380	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kubevirt/__init__.py:1379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1378	            _delete_resource(kubectl, 'pod', podname, namespace, debug=self.debug)
1379	        os.popen(f"{kubectl} -n {namespace} delete cm {podname}").read()
1380	        return {'result': 'success'}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
87	class Kvirt(object):
88	    def __init__(self, host='127.0.0.1', port=None, user='root', protocol='ssh', url=None, debug=False, insecure=False,
89	                 session=False, legacy=False):
90	        if url is None:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
91	            connectiontype = 'system' if not session else 'session'
92	            if host == '127.0.0.1' or host == 'localhost':
93	                url = f"qemu:///{connectiontype}"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
456	                except:
457	                    if self.host in ['localhost', '127.0.0.1'] and os.path.exists(diskimage):
458	                        warning("Using image path although it's not in a pool")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
548	            if os.path.isabs(iso):
549	                if self.protocol == 'ssh' and self.host not in ['localhost', '127.0.0.1']:
550	                    isocheckcmd = 'ssh %s -p %s %s@%s "ls %s >/dev/null 2>&1"' % (self.identitycommand, self.port,

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
551	                                                                                  self.user, self.host, iso)
552	                    code = os.system(isocheckcmd)
553	                    if code != 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:552
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
551	                                                                                  self.user, self.host, iso)
552	                    code = os.system(isocheckcmd)
553	                    if code != 0:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:839
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
838	                openstack = not ignition
839	                localhosts = ['localhost', '127.0.0.1']
840	                ignitiondir = default_poolpath

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:851
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
850	                    with open(f'{ignitiondir}/{name}.ign', 'w') as ignitionfile:
851	                        ignitionfile.write(ignitiondata)
852	                        identityfile = None

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:851
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
850	                    with open(f'{ignitiondir}/{name}.ign', 'w') as ignitionfile:
851	                        ignitionfile.write(ignitiondata)
852	                        identityfile = None

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
855	                    setfacluser = self.user
856	                    if self.host in ['localhost', '127.0.0.1']:
857	                        if not os.path.exists("/i_am_a_container"):

--------------------------------------------------
>> Issue: [B303:blacklist] pwd.getpwuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:858
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b303-pwd-getpwuid
857	                        if not os.path.exists("/i_am_a_container"):
858	                            setfacluser = getpwuid(os.getuid()).pw_name
859	                    else:

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
857	                        if not os.path.exists("/i_am_a_container"):
858	                            setfacluser = getpwuid(os.getuid()).pw_name
859	                    else:

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:858
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
857	                        if not os.path.exists("/i_am_a_container"):
858	                            setfacluser = getpwuid(os.getuid()).pw_name
859	                    else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:875
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
874	                                                                         default_poolpath)
875	                    code = os.system(ignitioncmd1)
876	                    if code != 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:875
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
874	                                                                         default_poolpath)
875	                    code = os.system(ignitioncmd1)
876	                    if code != 0:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
911	                            with open(f'{tmpdir}/combustion_script', 'w') as combustionfile:
912	                                combustionfile.write(cmdsdata)
913	                    result = common.make_iso(name, tmpdir, userdata, metadata, netdata, openstack=openstack,

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
911	                            with open(f'{tmpdir}/combustion_script', 'w') as combustionfile:
912	                                combustionfile.write(cmdsdata)
913	                    result = common.make_iso(name, tmpdir, userdata, metadata, netdata, openstack=openstack,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
916	                        error("Hit issue when creating user data iso")
917	                        msg = open(f'{tmpdir}/error.log').read()
918	                        return {'result': 'failure', 'reason': msg}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
919	                    self._uploadimage(name, pool=default_storagepool, origin=tmpdir)
920	        listen = '0.0.0.0' if self.host not in ['localhost', '127.0.0.1'] else '127.0.0.1'
921	        if not vnc:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
919	                    self._uploadimage(name, pool=default_storagepool, origin=tmpdir)
920	        listen = '0.0.0.0' if self.host not in ['localhost', '127.0.0.1'] else '127.0.0.1'
921	        if not vnc:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
919	                    self._uploadimage(name, pool=default_storagepool, origin=tmpdir)
920	        listen = '0.0.0.0' if self.host not in ['localhost', '127.0.0.1'] else '127.0.0.1'
921	        if not vnc:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1072	            cpuxml = ""
1073	        if self.host in ['localhost', '127.0.0.1']:
1074	            serialxml = """<serial type='pty'>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1098	        if ignition or usermode or macosx or tpm or qemuextra is not None or nvmedisks or ssddisks:
1099	            namespace = "xmlns:qemu='http://libvirt.org/schemas/domain/qemu/1.0'"
1100	            ignitionxml = ""

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1170	                foldercmd = f"sudo mkdir {folder} ; sudo chmod 777 {folder}"
1171	                if not os.path.exists(folder) and self.host in ['localhost', '127.0.0.1']:
1172	                    oldmask = os.umask(000)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1177	                                                                             self.user, self.host, folder, foldercmd)
1178	                    code = os.system(foldercmd)
1179	        memoryhotplugxml = "<maxMemory slots='16' unit='MiB'>1524288</maxMemory>" if memoryhotplug else ""

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1178
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1177	                                                                             self.user, self.host, folder, foldercmd)
1178	                    code = os.system(foldercmd)
1179	        memoryhotplugxml = "<maxMemory slots='16' unit='MiB'>1524288</maxMemory>" if memoryhotplug else ""

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1381	            if os.path.exists("/i_am_a_container") and which(virtcmd) is None:
1382	                os.system('apt-get install -y libguestfs-tools')
1383	                os.system(cmd.replace('sudo ', ''))

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1382
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1381	            if os.path.exists("/i_am_a_container") and which(virtcmd) is None:
1382	                os.system('apt-get install -y libguestfs-tools')
1383	                os.system(cmd.replace('sudo ', ''))

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1382	                os.system('apt-get install -y libguestfs-tools')
1383	                os.system(cmd.replace('sudo ', ''))
1384	            elif self.host == 'localhost' or self.host == '127.0.0.1':

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1383
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1382	                os.system('apt-get install -y libguestfs-tools')
1383	                os.system(cmd.replace('sudo ', ''))
1384	            elif self.host == 'localhost' or self.host == '127.0.0.1':

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1383	                os.system(cmd.replace('sudo ', ''))
1384	            elif self.host == 'localhost' or self.host == '127.0.0.1':
1385	                if which(virtcmd) is not None:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1385	                if which(virtcmd) is not None:
1386	                    os.system(cmd)
1387	                else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1386
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1385	                if which(virtcmd) is not None:
1386	                    os.system(cmd)
1387	                else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1391	                cmd = f'ssh {self.identitycommand} -p {self.port} {self.user}@{self.host} "{cmd}"'
1392	                os.system(cmd)
1393	        xml = vm.XMLDesc(0)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1392
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1391	                cmd = f'ssh {self.identitycommand} -p {self.port} {self.user}@{self.host} "{cmd}"'
1392	                os.system(cmd)
1393	        xml = vm.XMLDesc(0)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1756	                attributes = element.attrib
1757	                if attributes['listen'] == '127.0.0.1' and not os.path.exists("i_am_a_container")\
1758	                   and self.host not in ['127.0.0.1', 'localhost']:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1757	                if attributes['listen'] == '127.0.0.1' and not os.path.exists("i_am_a_container")\
1758	                   and self.host not in ['127.0.0.1', 'localhost']:
1759	                    tunnel = True

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1759	                    tunnel = True
1760	                    host = '127.0.0.1'
1761	                protocol = attributes['type']

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1771	                        % (self.identitycommand, self.port, localport, port, self.user, self.host)
1772	                    host = '127.0.0.1'
1773	                if passwd is not None:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1778	                    if tunnel:
1779	                        os.popen(consolecommand)
1780	                    return url

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1793	                else:
1794	                    os.popen(consolecommand)
1795	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1815	            if serialport is not None:
1816	                if self.host in ['localhost', '127.0.0.1']:
1817	                    serialcommand = f"nc 127.0.0.1 {serialport}"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1831	                else:
1832	                    os.system(serialcommand)
1833	            elif self.host in ['localhost', '127.0.0.1']:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1832
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1831	                else:
1832	                    os.system(serialcommand)
1833	            elif self.host in ['localhost', '127.0.0.1']:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1832	                    os.system(serialcommand)
1833	            elif self.host in ['localhost', '127.0.0.1']:
1834	                cmd = f'virsh -c {self.url} console {name}'

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1839
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1838	                else:
1839	                    os.system(cmd)
1840	            else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:1839
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1838	                else:
1839	                    os.system(cmd)
1840	            else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:2266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2265	        if ip is not None:
2266	            os.system(f"ssh-keygen -q -R {ip} >/dev/null 2>&1")
2267	            # delete hosts entry

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:2266
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
2265	        if ip is not None:
2266	            os.system(f"ssh-keygen -q -R {ip} >/dev/null 2>&1")
2267	            # delete hosts entry

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:2277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2276	                call(f"sudo sed -i '/{hostentry}/d' /etc/hosts", shell=True)
2277	                if bridged and self.host in ['localhost', '127.0.0.1']:
2278	                    try:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:2284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2283	            ignitionpath = f'/var/lib/libvirt/images/{name}.ign'
2284	            if self.protocol == 'ssh' and self.host not in ['localhost', '127.0.0.1']:
2285	                ignitiondeletecmd = f"ls {ignitionpath} >/dev/null 2>&1 && rm -f {ignitionpath}"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:2410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2409	            interface.remove(mac)
2410	        if self.host not in ['127.0.0.1', 'localhost']:
2411	            for serial in list(tree.iter('serial')):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:2616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2615	    def handler(self, stream, data, file_):
2616	        return file_.read(data)
2617	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:2780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2779	        if iso is not None:
2780	            if self.host in ['localhost', '127.0.0.1'] and os.path.exists(iso):
2781	                iso = os.path.abspath(iso)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3197	        if pooltype == 'dir':
3198	            if self.host == 'localhost' or self.host == '127.0.0.1':
3199	                if not os.path.exists(poolpath):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3215	
3216	                return1 = os.system(cmd1)
3217	                if return1 > 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3216
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3215	
3216	                return1 = os.system(cmd1)
3217	                if return1 > 0:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3220	                    return {'result': 'failure', 'reason': reason}
3221	                return2 = os.system(cmd2)
3222	                if return2 > 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3221
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3220	                    return {'result': 'failure', 'reason': reason}
3221	                return2 = os.system(cmd2)
3222	                if return2 > 0:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3226	                if self.user != 'root':
3227	                    return3 = os.system(cmd3)
3228	                    if return3 > 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3227
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3226	                if self.user != 'root':
3227	                    return3 = os.system(cmd3)
3228	                    if return3 > 0:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3334	            return {'result': 'success', 'found': True}
3335	        if self.host == 'localhost' or self.host == '127.0.0.1':
3336	            downloadcmd = f"curl -C - -Lko {downloadpath}/{full_name} -f '{url}'"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3345	            setfacluser = self.user
3346	            if self.host in ['localhost', '127.0.0.1']:
3347	                if not os.path.exists("/i_am_a_container"):

--------------------------------------------------
>> Issue: [B303:blacklist] pwd.getpwuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3348
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b303-pwd-getpwuid
3347	                if not os.path.exists("/i_am_a_container"):
3348	                    setfacluser = getpwuid(os.getuid()).pw_name
3349	                else:

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
3347	                if not os.path.exists("/i_am_a_container"):
3348	                    setfacluser = getpwuid(os.getuid()).pw_name
3349	                else:

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3348
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
3347	                if not os.path.exists("/i_am_a_container"):
3348	                    setfacluser = getpwuid(os.getuid()).pw_name
3349	                else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3358	            executable = executable[extension]
3359	            if self.host == 'localhost' or self.host == '127.0.0.1':
3360	                if which(executable) is not None:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3361	                    uncompresscmd = f"{executable} {flag} {poolpath}/{full_name}"
3362	                    os.system(uncompresscmd)
3363	                else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3362
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3361	                    uncompresscmd = f"{executable} {flag} {poolpath}/{full_name}"
3362	                    os.system(uncompresscmd)
3363	                else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3368	                                                                      self.host, executable, flag, poolpath, full_name)
3369	                os.system(uncompresscmd)
3370	        if cmds:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3369
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3368	                                                                      self.host, executable, flag, poolpath, full_name)
3369	                os.system(uncompresscmd)
3370	        if cmds:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3370	        if cmds:
3371	            if self.host == 'localhost' or self.host == '127.0.0.1':
3372	                if which('virt-customize') is not None:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3374	                        cmd = f"virt-customize -a {poolpath}/{name} --run-command '{cmd}'"
3375	                        os.system(cmd)
3376	            elif self.protocol == 'ssh':

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3375
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3374	                        cmd = f"virt-customize -a {poolpath}/{name} --run-command '{cmd}'"
3375	                        os.system(cmd)
3376	            elif self.protocol == 'ssh':

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3381	                                                                                                 name, cmd)
3382	                    os.system(cmd)
3383	        if convert:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3382
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3381	                                                                                                 name, cmd)
3382	                    os.system(cmd)
3383	        if convert:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3385	            cmd = f"qemu-img convert -O qcow2 {poolpath}/{name}.raw {poolpath}/{name}"
3386	            if self.host == 'localhost' or self.host == '127.0.0.1':
3387	                os.system(cmd)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3386	            if self.host == 'localhost' or self.host == '127.0.0.1':
3387	                os.system(cmd)
3388	            elif self.protocol == 'ssh':

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3387
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3386	            if self.host == 'localhost' or self.host == '127.0.0.1':
3387	                os.system(cmd)
3388	            elif self.protocol == 'ssh':

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3389	                cmd = 'ssh %s -p %s %s@%s "%s"' % (self.identitycommand, self.port, self.user, self.host, cmd)
3390	                os.system(cmd)
3391	        if pooltype in ['logical', 'zfs']:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3390
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3389	                cmd = 'ssh %s -p %s %s@%s "%s"' % (self.identitycommand, self.port, self.user, self.host, cmd)
3390	                os.system(cmd)
3391	        if pooltype in ['logical', 'zfs']:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3426	            bridgescmd = f"ovs-vsctl list-br | grep name || ovs-vsctl add-br {name}"
3427	            if self.protocol == 'ssh' and self.host not in ['localhost', '127.0.0.1']:
3428	                bridgescmd = 'ssh %s -p %s %s@%s "%s"' % (self.identitycommand, self.port, self.user, self.host,

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3429	                                                          bridgescmd)
3430	            os.system(bridgescmd)
3431	            portgroupxml = "<portgroup name='default' default='yes'/>"

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3430
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3429	                                                          bridgescmd)
3430	            os.system(bridgescmd)
3431	            portgroupxml = "<portgroup name='default' default='yes'/>"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3552	        if dhcpoptions:
3553	            namespace = "xmlns:dnsmasq='http://libvirt.org/schemas/network/dnsmasq/1.0'"
3554	            dnsmasqxml = "<dnsmasq:options>"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3823
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3822	                                                         thincommand)
3823	        results = os.popen(thincommand).read().strip()
3824	        if results == '':

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3823
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
3822	                                                         thincommand)
3823	        results = os.popen(thincommand).read().strip()
3824	        if results == '':

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3831	            command = "ssh %s -p %s %s@%s \"%s\"" % (self.identitycommand, self.port, self.user, self.host, command)
3832	        os.system(command)
3833	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3832
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3831	            command = "ssh %s -p %s %s@%s \"%s\"" % (self.identitycommand, self.port, self.user, self.host, command)
3832	        os.system(command)
3833	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3839
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3838	                                                         sizecommand)
3839	        size = os.popen(sizecommand).read().strip()
3840	        virtualsize = json.loads(size)['virtual-size']

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3839
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
3838	                                                         sizecommand)
3839	        size = os.popen(sizecommand).read().strip()
3840	        virtualsize = json.loads(size)['virtual-size']

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3855	            command = f"ssh {self.identitycommand} -p {self.port} {self.user}@{self.host} \"{command}\""
3856	        os.system(command)
3857	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3856
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3855	            command = f"ssh {self.identitycommand} -p {self.port} {self.user}@{self.host} \"{command}\""
3856	        os.system(command)
3857	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3864	            command = f"ssh {self.identitycommand} -p {self.port} {self.user}@{self.host} \"{command}\""
3865	        os.system(command)
3866	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3865
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3864	            command = f"ssh {self.identitycommand} -p {self.port} {self.user}@{self.host} \"{command}\""
3865	        os.system(command)
3866	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3870	            command = f"ssh {self.identitycommand} -p {self.port} {self.user}@{self.host} \"{command}\""
3871	        os.system(command)
3872	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3871
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
3870	            command = f"ssh {self.identitycommand} -p {self.port} {self.user}@{self.host} \"{command}\""
3871	        os.system(command)
3872	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
3920	        hostscmd = f"sh -c 'echo {hosts} >>{hostsfile}'"
3921	        if getuser() != 'root':
3922	            hostscmd = f"sudo {hostscmd}"

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/kvm/__init__.py:3921
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
3920	        hostscmd = f"sh -c 'echo {hosts} >>{hostsfile}'"
3921	        if getuser() != 'root':
3922	            hostscmd = f"sudo {hostscmd}"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
23	    """
24	    def __init__(self, host='127.0.0.1', version='3', port=None, user='root', password=None, debug=False, project=None,
25	                 domain='Default', auth_url=None, ca_file=None, external_network=None, region_name=None,
26	                 glance_disk=False, auth_type='password', auth_token=None, application_credential_id=None,
27	                 application_credential_secret=None):
28	        self.debug = debug

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
189	            else:
190	                publickeyfile = open(publickeyfile).read()
191	                nova.keypairs.create(key_name, publickeyfile)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
832	            downloadcmd = f"curl -Lo /tmp/{shortimage} -f '{url}'"
833	            code = os.system(downloadcmd)
834	            if code != 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:833
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
832	            downloadcmd = f"curl -Lo /tmp/{shortimage} -f '{url}'"
833	            code = os.system(downloadcmd)
834	            if code != 0:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:845
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
844	                uncompresscmd = f"{executable} {flag} {image_path}"
845	                os.system(uncompresscmd)
846	            else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:845
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
844	                uncompresscmd = f"{executable} {flag} {image_path}"
845	                os.system(uncompresscmd)
846	            else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
857	                        cmd += f" {image_path}"
858	                    os.system(cmd)
859	                elif which('virt-customize') is not None:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:858
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
857	                        cmd += f" {image_path}"
858	                    os.system(cmd)
859	                elif which('virt-customize') is not None:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:861
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
860	                    cmd = f"virt-customize -a {image_path} --run-command '{cmd}'"
861	                    os.system(cmd)
862	        glanceimage = self.glance.images.create(name=shortimage, disk_format=disk_format, container_format='bare')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:861
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
860	                    cmd = f"virt-customize -a {image_path} --run-command '{cmd}'"
861	                    os.system(cmd)
862	        glanceimage = self.glance.images.create(name=shortimage, disk_format=disk_format, container_format='bare')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/openstack/__init__.py:1159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1158	        with open(path, 'wb') as f:
1159	            f.write(obj_contents)
1160	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
39	class KOvirt(object):
40	    def __init__(self, host='127.0.0.1', port=22, user='admin@internal',
41	                 password=None, insecure=True, ca_file=None, org=None, debug=False,
42	                 cluster='Default', datacenter='Default', ssh_user='root', filtervms=False, filteruser=False,
43	                 filtertag=None):
44	        try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
288	            if image is not None and image.lower().startswith('debian'):
289	                gcmds.append('echo "deb http://download.opensuse.org/repositories/home:/evilissimo:/deb/Debian_7.0/ ./"'
290	                             ' >> /etc/apt/sources.list')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
290	                             ' >> /etc/apt/sources.list')
291	                gcmds.append('gpg -v -a --keyserver http://download.opensuse.org/repositories/home:/evilissimo:/deb/'
292	                             'Debian_7.0/Release.key --recv-keys D5C7F7C373A1A299')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
299	            if image is not None and [x for x in UBUNTUS if x in image.lower()]:
300	                gcmds.append('echo deb http://download.opensuse.org/repositories/home:/evilissimo:/ubuntu:/16.04/'
301	                             'xUbuntu_16.04/ /')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
301	                             'xUbuntu_16.04/ /')
302	                gcmds.append('wget http://download.opensuse.org/repositories/home:/evilissimo:/ubuntu:/16.04/'
303	                             'xUbuntu_16.04//Release.key')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
325	            if publickeyfile is not None:
326	                publickeyfile = open(publickeyfile).read().rstrip()
327	                if not keys:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
325	            if publickeyfile is not None:
326	                publickeyfile = open(publickeyfile).read().rstrip()
327	                if not keys:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
465	            if str(c.protocol) == 'spice':
466	                ocacontent = open(self.ca_file).read().replace('\n', '\\n')
467	                try:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
465	            if str(c.protocol) == 'spice':
466	                ocacontent = open(self.ca_file).read().replace('\n', '\\n')
467	                try:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
478	                           self.host)
479	                    os.system(command)
480	                address = '127.0.0.1' if tunnel else c.address

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:479
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
478	                           self.host)
479	                    os.system(command)
480	                address = '127.0.0.1' if tunnel else c.address

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
479	                    os.system(command)
480	                address = '127.0.0.1' if tunnel else c.address
481	                port = localport1 if tunnel else c.port

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
512	                        % (self.port, localport1, c.address, c.port, self.ssh_user, self.host)
513	                    os.system(command)
514	                address = '127.0.0.1' if tunnel else c.address

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:513
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
512	                        % (self.port, localport1, c.address, c.port, self.ssh_user, self.host)
513	                    os.system(command)
514	                address = '127.0.0.1' if tunnel else c.address

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
513	                    os.system(command)
514	                address = '127.0.0.1' if tunnel else c.address
515	                port = localport1 if tunnel else c.port

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
530	        with open("/tmp/console.vv", "w") as f:
531	            f.write(connectiondetails)
532	        if self.debug or os.path.exists("/i_am_a_container"):

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
536	            pprint(f"Use password {ticket.value}")
537	            os.popen(f"open vnc://{address}:{port}")
538	        else:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
538	        else:
539	            os.popen("remote-viewer /tmp/console.vv &")
540	        return

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
558	            return
559	        publickeyfile = open(publickeyfile).read().rstrip()
560	        try:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
558	            return
559	        publickeyfile = open(publickeyfile).read().rstrip()
560	        try:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
624	                for ip in device.ips:
625	                    if str(ip.version) == 'v4' and ip.address not in ['172.17.0.1', '127.0.0.1']:
626	                        ips.append(ip.address)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
624	                for ip in device.ips:
625	                    if str(ip.version) == 'v4' and ip.address not in ['172.17.0.1', '127.0.0.1']:
626	                        ips.append(ip.address)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
684	                for i in device.ips:
685	                    if str(i.version) == 'v4' and i.address not in ['172.17.0.1', '127.0.0.1']:
686	                        ips.append(i.address)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
684	                for i in device.ips:
685	                    if str(i.version) == 'v4' and i.address not in ['172.17.0.1', '127.0.0.1']:
686	                        ips.append(i.address)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:1035
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1034	                downloadcmd = f"curl -Lo /tmp/{shortimage} -f '{url}'"
1035	                code = os.system(downloadcmd)
1036	                if code != 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:1035
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1034	                downloadcmd = f"curl -Lo /tmp/{shortimage} -f '{url}'"
1035	                code = os.system(downloadcmd)
1036	                if code != 0:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:1052
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1051	                        uncompresscmd = f"{executable} {flag} {image_path}"
1052	                        os.system(uncompresscmd)
1053	                        shortimage = shortimage.replace(f".{extension}", '')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:1052
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1051	                        uncompresscmd = f"{executable} {flag} {image_path}"
1052	                        os.system(uncompresscmd)
1053	                        shortimage = shortimage.replace(f".{extension}", '')

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:1091
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1090	            proxy_connection = HTTPSConnection(destination_url.hostname, destination_url.port, context=context)
1091	            proxy_connection.putrequest("PUT", destination_url.path)
1092	            proxy_connection.putheader('Content-Length', image_size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1099	                    to_read = min(image_size - pos, BUF_SIZE)
1100	                    chunk = disk.read(to_read)
1101	                    if not chunk:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1099	                    to_read = min(image_size - pos, BUF_SIZE)
1100	                    chunk = disk.read(to_read)
1101	                    if not chunk:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:1104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1103	                        raise RuntimeError(f"Unexpected end of file at pos={pos}")
1104	                    proxy_connection.send(chunk)
1105	                    pos += len(chunk)

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/ovirt/__init__.py:1110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
1109	                        last_progress = now
1110	            response = proxy_connection.getresponse()
1111	            if response.status != 200:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/packet/__init__.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
143	            with open(f'{ignitiondir}/{name}.ign', 'w') as ignitionfile:
144	                ignitionfile.write(ignitiondata)
145	            if self.tunnelhost is not None:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/packet/__init__.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
148	                                                                     self.tunnelhost, self.tunneldir, name)
149	                os.system(scpcmd)
150	        if flavor is None:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/packet/__init__.py:149
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
148	                                                                     self.tunnelhost, self.tunneldir, name)
149	                os.system(scpcmd)
150	        if flavor is None:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/packet/__init__.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
334	            print(sshcommand)
335	        os.system(sshcommand)
336	        return

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/packet/__init__.py:335
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
334	            print(sshcommand)
335	        os.system(sshcommand)
336	        return

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/packet/__init__.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
588	        headers = {'X-Auth-Token': self.auth_token, 'Content-Type': 'application/json'}
589	        url = f"https://api.packet.net/projects/{self.project}/virtual-networks"
590	        data = json.dumps(data).encode('utf-8')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/packet/__init__.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
591	        request = Request(url, headers=headers, method='POST', data=data)
592	        return json.loads(urlopen(request).read())
593	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/packet/__init__.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
591	        request = Request(url, headers=headers, method='POST', data=data)
592	        return json.loads(urlopen(request).read())
593	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/proxmox/__init__.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
55	        self,
56	        host="127.0.0.1",
57	        port=None,
58	        user="root@pam",
59	        password=None,
60	        token_name=None,
61	        token_secret=None,
62	        filtertag=None,
63	        node=None,
64	        verify_ssl=True,
65	        imagepool=None,
66	        debug=False,
67	    ):
68	        self.conn = proxmoxer.ProxmoxAPI(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/proxmox/__init__.py:712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
711	                    ip = nic["ip-address"]
712	                    if not nic["ip-address"].startswith(tuple(['127.0.0.1', '::1', 'fe80::', '169.254.169', 'fd69']))\
713	                       and not sdn_ip(ip, kubetype, cluster_network):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/proxmox/__init__.py:1045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1044	            with open(temp_file_path, "w") as f:
1045	                f.write(data)
1046	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/proxmox/__init__.py:1045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1044	            with open(temp_file_path, "w") as f:
1045	                f.write(data)
1046	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/sampleprovider.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
17	class Kbase(object):
18	    def __init__(self, host='127.0.0.1', port=None, user='root', debug=False):
19	        self.conn = 'base'

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
251	                        ignitionopt.key = 'guestinfo.ignition.config.data'
252	                        ignitionopt.value = base64.b64encode(ignitiondata.encode()).decode()
253	                        encodingopt = vim.option.OptionValue()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:252
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
251	                        ignitionopt.key = 'guestinfo.ignition.config.data'
252	                        ignitionopt.value = base64.b64encode(ignitiondata.encode()).decode()
253	                        encodingopt = vim.option.OptionValue()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
295	                        if cmdsdata != '':
296	                            with open(f'{tmpdir}/combustion_script', 'w') as combustionfile:
297	                                combustionfile.write(cmdsdata)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
296	                            with open(f'{tmpdir}/combustion_script', 'w') as combustionfile:
297	                                combustionfile.write(cmdsdata)
298	                    common.make_iso(name, tmpdir, userdata, meta, netdata, openstack=False, combustion=combustion)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
296	                            with open(f'{tmpdir}/combustion_script', 'w') as combustionfile:
297	                                combustionfile.write(cmdsdata)
298	                    common.make_iso(name, tmpdir, userdata, meta, netdata, openstack=False, combustion=combustion)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
740	                consolecommand += f"{tunnelport} -L {localport}:{host}:{vncport} {tunneluser}@{tunnelhost} sleep 10;"
741	                host = '127.0.0.1'
742	                vncport = localport

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
755	            if not os.path.exists("/i_am_a_container"):
756	                os.popen(consolecommand)
757	        elif self.esx:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
755	            if not os.path.exists("/i_am_a_container"):
756	                os.popen(consolecommand)
757	        elif self.esx:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
770	                    pprint(f"Opening url {vmurl}")
771	                    webbrowser.open(vmurl, new=2, autoraise=True)
772	        else:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
796	                pprint(f"Opening url {vmurl}")
797	                webbrowser.open(vmurl, new=2, autoraise=True)
798	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1141	        headers = {'Content-Type': 'application/octet-stream', 'Cookie': f"{cookie_name}={cookie_text}"}
1142	        with open(origin, "rb") as f:
1143	            context = ssl._create_unverified_context()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1145	                req = urllib.request.Request(url, data=f, headers=headers, method='PUT')
1146	                urllib.request.urlopen(req, context=context)
1147	            except:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1145	                req = urllib.request.Request(url, data=f, headers=headers, method='PUT')
1146	                urllib.request.urlopen(req, context=context)
1147	            except:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1150	                try:
1151	                    urllib.request.urlopen(req, context=context)
1152	                except Exception as e:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1150	                try:
1151	                    urllib.request.urlopen(req, context=context)
1152	                except Exception as e:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1379	            downloadcmd = f"curl -kLo /tmp/{shortimage} -f '{url}'"
1380	            code = os.system(downloadcmd)
1381	            if code != 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1380
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1379	            downloadcmd = f"curl -kLo /tmp/{shortimage} -f '{url}'"
1380	            code = os.system(downloadcmd)
1381	            if code != 0:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1418	        elif url.endswith('ova'):
1419	            with tarfile.open(f"{basedir}/{shortimage}") as tar:
1420	                for _fil in [x.name for x in tar.getmembers()]:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1437	                uncompresscmd = f"{executable} {flag} {basedir}/{shortimage}"
1438	                os.system(uncompresscmd)
1439	                shortimage = shortimage.replace(f'.{extension}', '')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1438
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1437	                uncompresscmd = f"{executable} {flag} {basedir}/{shortimage}"
1438	                os.system(uncompresscmd)
1439	                shortimage = shortimage.replace(f'.{extension}', '')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1448	                    cmd = f"virt-customize -a {basedir}/{shortimage} --run-command '{cmd}'"
1449	                    os.system(cmd)
1450	            if not os.path.exists(vmdk_path):

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1449
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
1448	                    cmd = f"virt-customize -a {basedir}/{shortimage} --run-command '{cmd}'"
1449	                    os.system(cmd)
1450	            if not os.path.exists(vmdk_path):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1452	                cmd = f"qemu-img convert -O vmdk -o subformat=streamOptimized {basedir}/{shortimage} {vmdk_path}"
1453	                os.popen(cmd).read()
1454	            ovf_path = vmdk_path.replace('.vmdk', '.ovf')

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1452	                cmd = f"qemu-img convert -O vmdk -o subformat=streamOptimized {basedir}/{shortimage} {vmdk_path}"
1453	                os.popen(cmd).read()
1454	            ovf_path = vmdk_path.replace('.vmdk', '.ovf')

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1452	                cmd = f"qemu-img convert -O vmdk -o subformat=streamOptimized {basedir}/{shortimage} {vmdk_path}"
1453	                os.popen(cmd).read()
1454	            ovf_path = vmdk_path.replace('.vmdk', '.ovf')

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1452	                cmd = f"qemu-img convert -O vmdk -o subformat=streamOptimized {basedir}/{shortimage} {vmdk_path}"
1453	                os.popen(cmd).read()
1454	            ovf_path = vmdk_path.replace('.vmdk', '.ovf')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1455	            commondir = os.path.dirname(common.pprint.__code__.co_filename)
1456	            vmdk_info = json.loads(os.popen(f"qemu-img info {vmdk_path} --output json").read())
1457	            virtual_size = vmdk_info['virtual-size']

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1455	            commondir = os.path.dirname(common.pprint.__code__.co_filename)
1456	            vmdk_info = json.loads(os.popen(f"qemu-img info {vmdk_path} --output json").read())
1457	            virtual_size = vmdk_info['virtual-size']

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1455	            commondir = os.path.dirname(common.pprint.__code__.co_filename)
1456	            vmdk_info = json.loads(os.popen(f"qemu-img info {vmdk_path} --output json").read())
1457	            virtual_size = vmdk_info['virtual-size']

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1455	            commondir = os.path.dirname(common.pprint.__code__.co_filename)
1456	            vmdk_info = json.loads(os.popen(f"qemu-img info {vmdk_path} --output json").read())
1457	            virtual_size = vmdk_info['virtual-size']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1458	            actual_size = vmdk_info['actual-size']
1459	            ovfcontent = open(f"{commondir}/vm.ovf.j2").read().format(name=shortimage, virtual_size=virtual_size,
1460	                                                                      actual_size=actual_size, vmdk_file=vmdk_file,

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1458	            actual_size = vmdk_info['actual-size']
1459	            ovfcontent = open(f"{commondir}/vm.ovf.j2").read().format(name=shortimage, virtual_size=virtual_size,
1460	                                                                      actual_size=actual_size, vmdk_file=vmdk_file,

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1458	            actual_size = vmdk_info['actual-size']
1459	            ovfcontent = open(f"{commondir}/vm.ovf.j2").read().format(name=shortimage, virtual_size=virtual_size,
1460	                                                                      actual_size=actual_size, vmdk_file=vmdk_file,

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1461	                                                                      import_network=self.import_network)
1462	            with open(ovf_path, 'w') as f:
1463	                f.write(ovfcontent)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1462	            with open(ovf_path, 'w') as f:
1463	                f.write(ovfcontent)
1464	        ovfd = open(ovf_path).read()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1462	            with open(ovf_path, 'w') as f:
1463	                f.write(ovfcontent)
1464	        ovfd = open(ovf_path).read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1463	                f.write(ovfcontent)
1464	        ovfd = open(ovf_path).read()
1465	        ovfd = re.sub('<Name>.*</Name>', f'<Name>{name}</Name>', ovfd)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1463	                f.write(ovfcontent)
1464	        ovfd = open(ovf_path).read()
1465	        ovfd = re.sub('<Name>.*</Name>', f'<Name>{name}</Name>', ovfd)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1463	                f.write(ovfcontent)
1464	        ovfd = open(ovf_path).read()
1465	        ovfd = re.sub('<Name>.*</Name>', f'<Name>{name}</Name>', ovfd)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1491	                pprint(f"Uploading {vmdk_path} to {url}")
1492	                keepalive_thread = Thread(target=keep_lease_alive, args=(lease,))
1493	                keepalive_thread.start()

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/__init__.py:1492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1491	                pprint(f"Uploading {vmdk_path} to {url}")
1492	                keepalive_thread = Thread(target=keep_lease_alive, args=(lease,))
1493	                keepalive_thread.start()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/tagging.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
12	        auth_url = f'https://{vcip}/rest/com/vmware/cis/session'
13	        b64_auth = b64encode(f"{user}:{password}".encode()).decode()
14	        headers = {'Authorization': f"Basic {b64_auth}"}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/tagging.py:13
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
12	        auth_url = f'https://{vcip}/rest/com/vmware/cis/session'
13	        b64_auth = b64encode(f"{user}:{password}".encode()).decode()
14	        headers = {'Authorization': f"Basic {b64_auth}"}

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/tagging.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
15	        request = Request(auth_url, headers=headers, method='POST')
16	        resp = urlopen(request)
17	        status_code = resp.getcode()

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/tagging.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
21	            return
22	        self.sid = json.loads(resp.read())['value']
23	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/tagging.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
25	        request = Request(url, headers={'vmware-api-session-id': self.sid}, method='DELETE')
26	        resp = urlopen(request)
27	        if resp.getcode() not in [200, 201]:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/tagging.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
31	        request = Request(url, headers={'vmware-api-session-id': self.sid})
32	        resp = urlopen(request)
33	        if resp.getcode() not in [200, 201]:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/tagging.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
36	        else:
37	            return json.loads(resp.read())
38	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/tagging.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
42	                                                   'content-type': 'application/json'})
43	        resp = urlopen(request)
44	        if resp.getcode() not in [200, 201]:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/vsphere/tagging.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
46	        else:
47	            return json.loads(resp.read())
48	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
14	class Kwebclient(object):
15	    def __init__(self, host='127.0.0.1', port=8000, debug=False, localkube=True):
16	        self.debug = debug

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	        request = Request(url, headers=self.headers)
31	        result = json.loads(urlopen(request, context=self.context).read())
32	        return bool(result)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
30	        request = Request(url, headers=self.headers)
31	        result = json.loads(urlopen(request, context=self.context).read())
32	        return bool(result)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
30	        request = Request(url, headers=self.headers)
31	        result = json.loads(urlopen(request, context=self.context).read())
32	        return bool(result)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	        request = Request(vms_url, data=data, headers=self.headers)
61	        response = json.loads(urlopen(request, context=self.context).read())
62	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
60	        request = Request(vms_url, data=data, headers=self.headers)
61	        response = json.loads(urlopen(request, context=self.context).read())
62	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
60	        request = Request(vms_url, data=data, headers=self.headers)
61	        response = json.loads(urlopen(request, context=self.context).read())
62	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	        request = Request(start_url, data=data, headers=self.headers)
68	        response = json.loads(urlopen(request, context=self.context).read())
69	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
67	        request = Request(start_url, data=data, headers=self.headers)
68	        response = json.loads(urlopen(request, context=self.context).read())
69	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
67	        request = Request(start_url, data=data, headers=self.headers)
68	        response = json.loads(urlopen(request, context=self.context).read())
69	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	        request = Request(stop_url, data=data, headers=self.headers)
75	        response = json.loads(urlopen(request, context=self.context).read())
76	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
74	        request = Request(stop_url, data=data, headers=self.headers)
75	        response = json.loads(urlopen(request, context=self.context).read())
76	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
74	        request = Request(stop_url, data=data, headers=self.headers)
75	        response = json.loads(urlopen(request, context=self.context).read())
76	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	        request = Request(snapshot_url, data=data, headers=self.headers)
83	        response = json.loads(urlopen(request, context=self.context).read())
84	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
82	        request = Request(snapshot_url, data=data, headers=self.headers)
83	        response = json.loads(urlopen(request, context=self.context).read())
84	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
82	        request = Request(snapshot_url, data=data, headers=self.headers)
83	        response = json.loads(urlopen(request, context=self.context).read())
84	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
90	        request = Request(snapshot_url, data=data, headers=self.headers, method='DELETE')
91	        response = json.loads(urlopen(request, context=self.context).read())
92	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
90	        request = Request(snapshot_url, data=data, headers=self.headers, method='DELETE')
91	        response = json.loads(urlopen(request, context=self.context).read())
92	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
90	        request = Request(snapshot_url, data=data, headers=self.headers, method='DELETE')
91	        response = json.loads(urlopen(request, context=self.context).read())
92	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
98	        request = Request(url, headers=self.headers)
99	        return json.loads(urlopen(request, context=self.context).read())['snapshots']
100	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
98	        request = Request(url, headers=self.headers)
99	        return json.loads(urlopen(request, context=self.context).read())['snapshots']
100	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
98	        request = Request(url, headers=self.headers)
99	        return json.loads(urlopen(request, context=self.context).read())['snapshots']
100	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
105	        request = Request(revert_url, data=data, headers=self.headers)
106	        response = json.loads(urlopen(request, context=self.context).read())
107	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
105	        request = Request(revert_url, data=data, headers=self.headers)
106	        response = json.loads(urlopen(request, context=self.context).read())
107	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
105	        request = Request(revert_url, data=data, headers=self.headers)
106	        response = json.loads(urlopen(request, context=self.context).read())
107	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
114	        request = Request(info_url, headers=self.headers)
115	        result = json.loads(urlopen(request, context=self.context).read())
116	        return result

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
114	        request = Request(info_url, headers=self.headers)
115	        result = json.loads(urlopen(request, context=self.context).read())
116	        return result

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
114	        request = Request(info_url, headers=self.headers)
115	        result = json.loads(urlopen(request, context=self.context).read())
116	        return result

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
120	        request = Request(url, headers=self.headers)
121	        result = json.loads(urlopen(request, context=self.context).read())
122	        return result.get('status')

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
120	        request = Request(url, headers=self.headers)
121	        result = json.loads(urlopen(request, context=self.context).read())
122	        return result.get('status')

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
120	        request = Request(url, headers=self.headers)
121	        result = json.loads(urlopen(request, context=self.context).read())
122	        return result.get('status')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
126	        request = Request(url, headers=self.headers)
127	        response = json.loads(urlopen(request, context=self.context).read())
128	        vms = response['vms']

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
126	        request = Request(url, headers=self.headers)
127	        response = json.loads(urlopen(request, context=self.context).read())
128	        vms = response['vms']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
126	        request = Request(url, headers=self.headers)
127	        response = json.loads(urlopen(request, context=self.context).read())
128	        vms = response['vms']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
141	        request = Request(url, headers=self.headers)
142	        result = json.loads(urlopen(request, context=self.context).read())
143	        if not result:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
141	        request = Request(url, headers=self.headers)
142	        result = json.loads(urlopen(request, context=self.context).read())
143	        if not result:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
141	        request = Request(url, headers=self.headers)
142	        result = json.loads(urlopen(request, context=self.context).read())
143	        if not result:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
149	        request = Request(url, headers=self.headers)
150	        result = json.loads(urlopen(request, context=self.context).read())
151	        return result.get('ip')

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
149	        request = Request(url, headers=self.headers)
150	        result = json.loads(urlopen(request, context=self.context).read())
151	        return result.get('ip')

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
149	        request = Request(url, headers=self.headers)
150	        result = json.loads(urlopen(request, context=self.context).read())
151	        return result.get('ip')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
156	        request = Request(url, headers=self.headers)
157	        response = json.loads(urlopen(request, context=self.context).read())
158	        return response[_type]

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
156	        request = Request(url, headers=self.headers)
157	        response = json.loads(urlopen(request, context=self.context).read())
158	        return response[_type]

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
156	        request = Request(url, headers=self.headers)
157	        response = json.loads(urlopen(request, context=self.context).read())
158	        return response[_type]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
163	        request = Request(vm_url, data=data, headers=self.headers, method='DELETE')
164	        response = json.loads(urlopen(request, context=self.context).read())
165	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
163	        request = Request(vm_url, data=data, headers=self.headers, method='DELETE')
164	        response = json.loads(urlopen(request, context=self.context).read())
165	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
163	        request = Request(vm_url, data=data, headers=self.headers, method='DELETE')
164	        response = json.loads(urlopen(request, context=self.context).read())
165	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
169	        request = Request(url, headers=self.headers)
170	        result = json.loads(urlopen(request, context=self.context).read())
171	        return result.get('dnsclient'), result.get('domain')

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
169	        request = Request(url, headers=self.headers)
170	        result = json.loads(urlopen(request, context=self.context).read())
171	        return result.get('dnsclient'), result.get('domain')

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
169	        request = Request(url, headers=self.headers)
170	        result = json.loads(urlopen(request, context=self.context).read())
171	        return result.get('dnsclient'), result.get('domain')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
180	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
181	        response = json.loads(urlopen(request, context=self.context).read())
182	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
180	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
181	        response = json.loads(urlopen(request, context=self.context).read())
182	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
180	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
181	        response = json.loads(urlopen(request, context=self.context).read())
182	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
188	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
189	        response = json.loads(urlopen(request, context=self.context).read())
190	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
188	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
189	        response = json.loads(urlopen(request, context=self.context).read())
190	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
188	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
189	        response = json.loads(urlopen(request, context=self.context).read())
190	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
196	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
197	        response = json.loads(urlopen(request, context=self.context).read())
198	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
196	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
197	        response = json.loads(urlopen(request, context=self.context).read())
198	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
196	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
197	        response = json.loads(urlopen(request, context=self.context).read())
198	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
204	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
205	        response = json.loads(urlopen(request, context=self.context).read())
206	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
204	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
205	        response = json.loads(urlopen(request, context=self.context).read())
206	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
204	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
205	        response = json.loads(urlopen(request, context=self.context).read())
206	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
215	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
216	        response = json.loads(urlopen(request, context=self.context).read())
217	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
215	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
216	        response = json.loads(urlopen(request, context=self.context).read())
217	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
215	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
216	        response = json.loads(urlopen(request, context=self.context).read())
217	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
223	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
224	        response = json.loads(urlopen(request, context=self.context).read())
225	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
223	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
224	        response = json.loads(urlopen(request, context=self.context).read())
225	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
223	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
224	        response = json.loads(urlopen(request, context=self.context).read())
225	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
241	        request = Request(disk_url, data=data, headers=self.headers)
242	        response = json.loads(urlopen(request, context=self.context).read())
243	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
241	        request = Request(disk_url, data=data, headers=self.headers)
242	        response = json.loads(urlopen(request, context=self.context).read())
243	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
241	        request = Request(disk_url, data=data, headers=self.headers)
242	        response = json.loads(urlopen(request, context=self.context).read())
243	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
249	        request = Request(disk_url, data=data, headers=self.headers, method='DELETE')
250	        response = json.loads(urlopen(request, context=self.context).read())
251	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
249	        request = Request(disk_url, data=data, headers=self.headers, method='DELETE')
250	        response = json.loads(urlopen(request, context=self.context).read())
251	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
249	        request = Request(disk_url, data=data, headers=self.headers, method='DELETE')
250	        response = json.loads(urlopen(request, context=self.context).read())
251	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
264	        request = Request(nic_url, data=data, headers=self.headers)
265	        response = json.loads(urlopen(request, context=self.context).read())
266	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
264	        request = Request(nic_url, data=data, headers=self.headers)
265	        response = json.loads(urlopen(request, context=self.context).read())
266	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
264	        request = Request(nic_url, data=data, headers=self.headers)
265	        response = json.loads(urlopen(request, context=self.context).read())
266	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
272	        request = Request(nic_url, data=data, headers=self.headers, method='DELETE')
273	        response = json.loads(urlopen(request, context=self.context).read())
274	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
272	        request = Request(nic_url, data=data, headers=self.headers, method='DELETE')
273	        response = json.loads(urlopen(request, context=self.context).read())
274	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
272	        request = Request(nic_url, data=data, headers=self.headers, method='DELETE')
273	        response = json.loads(urlopen(request, context=self.context).read())
274	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
280	        request = Request(pool_url, data=data, headers=self.headers)
281	        response = json.loads(urlopen(request, context=self.context).read())
282	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
280	        request = Request(pool_url, data=data, headers=self.headers)
281	        response = json.loads(urlopen(request, context=self.context).read())
282	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
280	        request = Request(pool_url, data=data, headers=self.headers)
281	        response = json.loads(urlopen(request, context=self.context).read())
282	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
288	        request = Request(image_url, data=data, headers=self.headers, method='DELETE')
289	        response = json.loads(urlopen(request, context=self.context).read())
290	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
288	        request = Request(image_url, data=data, headers=self.headers, method='DELETE')
289	        response = json.loads(urlopen(request, context=self.context).read())
290	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
288	        request = Request(image_url, data=data, headers=self.headers, method='DELETE')
289	        response = json.loads(urlopen(request, context=self.context).read())
290	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
302	        request = Request(image_url, data=data, headers=self.headers)
303	        response = json.loads(urlopen(request, context=self.context).read())
304	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
302	        request = Request(image_url, data=data, headers=self.headers)
303	        response = json.loads(urlopen(request, context=self.context).read())
304	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
302	        request = Request(image_url, data=data, headers=self.headers)
303	        response = json.loads(urlopen(request, context=self.context).read())
304	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
314	        request = Request(networks_url, data=data, headers=self.headers)
315	        response = json.loads(urlopen(request, context=self.context).read())
316	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
314	        request = Request(networks_url, data=data, headers=self.headers)
315	        response = json.loads(urlopen(request, context=self.context).read())
316	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
314	        request = Request(networks_url, data=data, headers=self.headers)
315	        response = json.loads(urlopen(request, context=self.context).read())
316	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
327	        request = Request(network_url, data=data, headers=self.headers, method='DELETE')
328	        response = json.loads(urlopen(request, context=self.context).read())
329	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
327	        request = Request(network_url, data=data, headers=self.headers, method='DELETE')
328	        response = json.loads(urlopen(request, context=self.context).read())
329	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
327	        request = Request(network_url, data=data, headers=self.headers, method='DELETE')
328	        response = json.loads(urlopen(request, context=self.context).read())
329	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
333	        request = Request(url, headers=self.headers)
334	        response = json.loads(urlopen(request, context=self.context).read())
335	        return [pool[0] for pool in response['pools']]

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
333	        request = Request(url, headers=self.headers)
334	        response = json.loads(urlopen(request, context=self.context).read())
335	        return [pool[0] for pool in response['pools']]

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
333	        request = Request(url, headers=self.headers)
334	        response = json.loads(urlopen(request, context=self.context).read())
335	        return [pool[0] for pool in response['pools']]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
339	        request = Request(url, headers=self.headers)
340	        response = json.loads(urlopen(request, context=self.context).read())
341	        networks = response['networks']

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
339	        request = Request(url, headers=self.headers)
340	        response = json.loads(urlopen(request, context=self.context).read())
341	        networks = response['networks']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
339	        request = Request(url, headers=self.headers)
340	        response = json.loads(urlopen(request, context=self.context).read())
341	        networks = response['networks']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
357	        request = Request(pool_url, data=data, headers=self.headers, method='DELETE')
358	        response = json.loads(urlopen(request, context=self.context).read())
359	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
357	        request = Request(pool_url, data=data, headers=self.headers, method='DELETE')
358	        response = json.loads(urlopen(request, context=self.context).read())
359	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
357	        request = Request(pool_url, data=data, headers=self.headers, method='DELETE')
358	        response = json.loads(urlopen(request, context=self.context).read())
359	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
364	        request = Request(url, headers=self.headers)
365	        response = json.loads(urlopen(request, context=self.context).read())
366	        for vm in response['vms']:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
364	        request = Request(url, headers=self.headers)
365	        response = json.loads(urlopen(request, context=self.context).read())
366	        for vm in response['vms']:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
364	        request = Request(url, headers=self.headers)
365	        response = json.loads(urlopen(request, context=self.context).read())
366	        for vm in response['vms']:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
377	        request = Request(url, headers=self.headers)
378	        vm = json.loads(urlopen(request, context=self.context).read())
379	        for net in vm.get('nets', []):

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
377	        request = Request(url, headers=self.headers)
378	        vm = json.loads(urlopen(request, context=self.context).read())
379	        for net in vm.get('nets', []):

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
377	        request = Request(url, headers=self.headers)
378	        vm = json.loads(urlopen(request, context=self.context).read())
379	        for net in vm.get('nets', []):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
385	        request = Request(url, headers=self.headers)
386	        response = json.loads(urlopen(request, context=self.context).read())
387	        for p in response['pools']:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
385	        request = Request(url, headers=self.headers)
386	        response = json.loads(urlopen(request, context=self.context).read())
387	        for p in response['pools']:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
385	        request = Request(url, headers=self.headers)
386	        response = json.loads(urlopen(request, context=self.context).read())
387	        for p in response['pools']:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
427	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
428	        response = json.loads(urlopen(request, context=self.context).read())
429	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
427	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
428	        response = json.loads(urlopen(request, context=self.context).read())
429	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
427	        request = Request(vm_url, data=data, headers=self.headers, method='UPDATE')
428	        response = json.loads(urlopen(request, context=self.context).read())
429	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
445	        request = Request(network_url, data=data, headers=self.headers, method='UPDATE')
446	        response = json.loads(urlopen(request, context=self.context).read())
447	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
445	        request = Request(network_url, data=data, headers=self.headers, method='UPDATE')
446	        response = json.loads(urlopen(request, context=self.context).read())
447	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
445	        request = Request(network_url, data=data, headers=self.headers, method='UPDATE')
446	        response = json.loads(urlopen(request, context=self.context).read())
447	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
470	        request = Request(kubes_url, data=data, headers=self.headers)
471	        response = json.loads(urlopen(request, context=self.context).read())
472	        if response['result'] != 'success':

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
470	        request = Request(kubes_url, data=data, headers=self.headers)
471	        response = json.loads(urlopen(request, context=self.context).read())
472	        if response['result'] != 'success':

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
470	        request = Request(kubes_url, data=data, headers=self.headers)
471	        response = json.loads(urlopen(request, context=self.context).read())
472	        if response['result'] != 'success':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
481	        request = Request(kubes_url, data=data, headers=self.headers, method='DELETE')
482	        response = json.loads(urlopen(request, context=self.context).read())
483	        if response['result'] == 'success':

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
481	        request = Request(kubes_url, data=data, headers=self.headers, method='DELETE')
482	        response = json.loads(urlopen(request, context=self.context).read())
483	        if response['result'] == 'success':

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
481	        request = Request(kubes_url, data=data, headers=self.headers, method='DELETE')
482	        response = json.loads(urlopen(request, context=self.context).read())
483	        if response['result'] == 'success':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
491	        request = Request(kubes_url, headers=self.headers)
492	        response = json.loads(urlopen(request, context=self.context).read())
493	        return response['kubes']

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
491	        request = Request(kubes_url, headers=self.headers)
492	        response = json.loads(urlopen(request, context=self.context).read())
493	        return response['kubes']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
491	        request = Request(kubes_url, headers=self.headers)
492	        response = json.loads(urlopen(request, context=self.context).read())
493	        return response['kubes']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
498	        try:
499	            return urlopen(request, context=self.context).read()
500	        except HTTPError:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
498	        try:
499	            return urlopen(request, context=self.context).read()
500	        except HTTPError:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
498	        try:
499	            return urlopen(request, context=self.context).read()
500	        except HTTPError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
505	        request = Request(kube_url, headers=self.headers)
506	        response = json.loads(urlopen(request, context=self.context).read())
507	        return response

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
505	        request = Request(kube_url, headers=self.headers)
506	        response = json.loads(urlopen(request, context=self.context).read())
507	        return response

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/providers/web/__init__.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
505	        request = Request(kube_url, headers=self.headers)
506	        response = json.loads(urlopen(request, context=self.context).read())
507	        return response

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/web/__init__.py:880
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
879	            if _type == 'generic':
880	                thread = Thread(target=config.create_kube_generic, kwargs={'cluster': cluster, 'overrides': parameters})
881	            elif _type == 'openshift':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/web/__init__.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
881	            elif _type == 'openshift':
882	                thread = Thread(target=config.create_kube_openshift, kwargs={'cluster': cluster,
883	                                                                             'overrides': parameters})
884	            elif _type == 'k3s':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/web/__init__.py:885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
884	            elif _type == 'k3s':
885	                thread = Thread(target=config.create_kube_k3s, kwargs={'cluster': cluster, 'overrides': parameters})
886	            elif _type == 'microshift':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/web/__init__.py:887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
886	            elif _type == 'microshift':
887	                thread = Thread(target=config.create_kube_microshift, kwargs={'cluster': cluster,
888	                                                                              'overrides': parameters})
889	            elif _type == 'hypershift':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/web/__init__.py:890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
889	            elif _type == 'hypershift':
890	                thread = Thread(target=config.create_kube_hypershift, kwargs={'cluster': cluster,
891	                                                                              'overrides': parameters})
892	            thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/web/__init__.py:993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
992	            if os.path.exists(kubeconfig):
993	                return open(kubeconfig).read()
994	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/web/__init__.py:1242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1241	                            with open(cert, 'w') as f:
1242	                                f.write(FAKECERT)
1243	                        websocketcommand = f"websockify {websocketport} -vD --idle-timeout=30"

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/web/__init__.py:1247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
1246	                        websocketcommand = "websockify {websocketport} -vD --idle-timeout=30 {host}:{port}"
1247	                os.popen(websocketcommand)
1248	                sleep(5)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/kvirt/web/__init__.py:1261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1260	        self.ipv6 = 'KWEB_IPV6' in os.environ
1261	        self.host = '::' if self.ipv6 else '0.0.0.0'
1262	        self.pull_secret = os.environ.get('PULL_SECRET')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
25	if os.path.exists('README.rst'):
26	    long_description = open('README.rst').read()
27	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kcli-99.0.202504101850/kcli-99.0.202504101850/setup.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	    long_description=long_description,
36	    url='http://github.com/karmab/kcli',
37	    author='Karim Boumedhel',

--------------------------------------------------

Code scanned:
	Total lines of code: 44749
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 325.0
		High: 1047.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 1236.0
		High: 136.0
Files skipped (0):
