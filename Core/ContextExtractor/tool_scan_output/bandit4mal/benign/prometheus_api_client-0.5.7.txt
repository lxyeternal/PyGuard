Run started:2025-04-12 17:44:56.744476

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/prometheus_api_client/prometheus_connect.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	        self,
48	        url: str = "http://127.0.0.1:9090",
49	        headers: dict = None,
50	        disable_ssl: bool = False,
51	        retry: Retry = None,
52	        auth: tuple = None,
53	        proxy: dict = None,
54	        session: Session = None,
55	        timeout: int = None,
56	    ):
57	        """Functions as a Constructor for the class PrometheusConnect."""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/prometheus_api_client/prometheus_connect.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	        """
94	        response = self._session.get(
95	            "{0}/".format(self.url),
96	            verify=self._session.verify,
97	            headers=self.headers,
98	            params=params,
99	            auth=self.auth,
100	            cert=self._session.cert,
101	            timeout=self._timeout,
102	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/prometheus_api_client/prometheus_connect.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	        params = params or {}
132	        response = self._session.get(
133	            "{0}/api/v1/labels".format(self.url),
134	            verify=self._session.verify,
135	            headers=self.headers,
136	            params=params,
137	            auth=self.auth,
138	            cert=self._session.cert,
139	            timeout=self._timeout,
140	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/prometheus_api_client/prometheus_connect.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	        params = params or {}
163	        response = self._session.get(
164	            "{0}/api/v1/label/{1}/values".format(self.url, label_name),
165	            verify=self._session.verify,
166	            headers=self.headers,
167	            params=params,
168	            auth=self.auth,
169	            cert=self._session.cert,
170	            timeout=self._timeout,
171	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/prometheus_api_client/prometheus_connect.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	        # using the query API to get raw data
215	        response = self._session.get(
216	            "{0}/api/v1/query".format(self.url),
217	            params={**{"query": query}, **params},
218	            verify=self._session.verify,
219	            headers=self.headers,
220	            auth=self.auth,
221	            cert=self._session.cert,
222	            timeout=self._timeout,
223	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/prometheus_api_client/prometheus_connect.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
301	            # using the query API to get raw data
302	            response = self._session.get(
303	                "{0}/api/v1/query".format(self.url),
304	                params={
305	                    **{
306	                        "query": query + "[" + str(chunk_seconds) + "s" + "]",
307	                        "time": start + chunk_seconds,
308	                    },
309	                    **params,
310	                },
311	                verify=self._session.verify,
312	                headers=self.headers,
313	                auth=self.auth,
314	                cert=self._session.cert,
315	                timeout=self._timeout,
316	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/prometheus_api_client/prometheus_connect.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
358	        with open(file_path, "wb") as file:
359	            file.write(payload)
360	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/prometheus_api_client/prometheus_connect.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
409	        # using the query API to get raw data
410	        response = self._session.get(
411	            "{0}/api/v1/query".format(self.url),
412	            params={**{"query": query}, **params},
413	            verify=self._session.verify,
414	            headers=self.headers,
415	            auth=self.auth,
416	            cert=self._session.cert,
417	            timeout=timeout,
418	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/prometheus_api_client/prometheus_connect.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
456	        # using the query_range API to get raw data
457	        response = self._session.get(
458	            "{0}/api/v1/query_range".format(self.url),
459	            params={**{"query": query, "start": start, "end": end, "step": step}, **params},
460	            verify=self._session.verify,
461	            headers=self.headers,
462	            auth=self.auth,
463	            cert=self._session.cert,
464	            timeout=timeout,
465	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/setup.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5	with open("README.md", "r") as fh:
6	    long_description = fh.read()
7	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/setup.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    long_description_content_type="text/markdown",
37	    url="https://github.com/4n4nd/prometheus-api-client-python",
38	    install_requires=get_install_requires(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/tests/test_prometheus_connect.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	    def setUp(self):  # noqa D102
148	        self.pc = PrometheusConnect(url="http://doesnt_matter.xyz", disable_ssl=True)
149	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/tests/test_prometheus_connect.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
150	    def test_network_is_blocked(self):  # noqa D102
151	        resp = requests.get("https://google.com")
152	        self.assertEqual(resp.status_code, 403)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/tests/test_prometheus_connect.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	    def test_network_is_blocked(self):  # noqa D102
151	        resp = requests.get("https://google.com")
152	        self.assertEqual(resp.status_code, 403)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/tests/test_prometheus_connect.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	            self.assertEqual(len(handler.requests), 0)
158	            resp = requests.get("https://redhat.com")
159	            self.assertEqual(resp.status_code, 500)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/tests/test_prometheus_connect.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	            self.assertEqual(len(handler.requests), 0)
158	            resp = requests.get("https://redhat.com")
159	            self.assertEqual(resp.status_code, 500)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_api_client-0.5.7/prometheus_api_client-0.5.7/tests/test_prometheus_connect.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
163	            request = handler.requests[0]
164	            self.assertEqual(request.url, "https://redhat.com/")
165	

--------------------------------------------------

Code scanned:
	Total lines of code: 1538
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 0.0
Files skipped (0):
