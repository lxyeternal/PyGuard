Run started:2025-04-12 13:57:13.103698

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	            for k in ["p256dh", "auth"]:
176	                if keys.get(k) is None:
177	                    raise WebPushException("Missing keys value: {}".format(k))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
179	                    keys[k] = bytes(cast(str, keys[k]).encode("utf8"))
180	            receiver_raw = base64.urlsafe_b64decode(
181	                self._repad(cast(bytes, keys["p256dh"]))
182	            )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
185	            self.receiver_key = receiver_raw
186	            self.auth_key = base64.urlsafe_b64decode(
187	                self._repad(cast(bytes, keys["auth"]))
188	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
253	            self.verb("Encrypting to aesgcm...")
254	            crypto_key = base64.urlsafe_b64encode(crypto_key).strip(b"=")
255	            encrypted = http_ece.encrypt(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
266	            if salt:
267	                reply["salt"] = base64.urlsafe_b64encode(salt).strip(b"=")
268	        return reply

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
290	            with open("encrypted.data", "wb") as f:
291	                f.write(encoded_data)
292	            data = "--data-binary @encrypted.data"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
341	                # Append the p256dh to the end of any existing crypto-key
342	                crypto_key = headers.get("crypto-key", "")
343	                if crypto_key:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
363	                self.verb("Guessing this is legacy GCM...")
364	                endpoint = "https://android.googleapis.com/gcm/send"
365	            else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
366	                self.verb("Guessing this is FCM...")
367	                endpoint = "https://fcm.googleapis.com/fcm/send"
368	            reg_ids = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
377	            if data:
378	                buffer = encoded.get("body")
379	                if buffer:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
379	                if buffer:
380	                    gcm_data["raw_data"] = base64.b64encode(buffer).decode("utf8")
381	            gcm_data["time_to_live"] = int(headers["ttl"] if "ttl" in headers else ttl)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:380
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
379	                if buffer:
380	                    gcm_data["raw_data"] = base64.b64encode(buffer).decode("utf8")
381	            gcm_data["time_to_live"] = int(headers["ttl"] if "ttl" in headers else ttl)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
389	        else:
390	            encoded_data = encoded.get("body")
391	            endpoint = self.subscription_info["endpoint"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
420	
421	        resp = self.requests_method.post(
422	            endpoint,
423	            timeout=timeout,
424	            **params,
425	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
444	        if self.aiohttp_session:
445	            resp = await self.aiohttp_session.post(endpoint, timeout=timeout, **params)
446	            resp_text = await resp.text()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
448	            async with aiohttp.ClientSession() as session:
449	                resp = await session.post(endpoint, timeout=timeout, **params)
450	                resp_text = await resp.text()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
531	            logging.info("Generating VAPID headers...")
532	        if not vapid_claims.get("aud"):
533	            url = urlparse(cast(str, subscription_info.get("endpoint")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
532	        if not vapid_claims.get("aud"):
533	            url = urlparse(cast(str, subscription_info.get("endpoint")))
534	            aud = "{}://{}".format(url.scheme, url.netloc)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
537	        # It's possible that a previously set `exp` field is no longer valid.
538	        if not vapid_claims.get("exp") or int(vapid_claims.get("exp") or 0) < int(
539	            time.time()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__init__.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
537	        # It's possible that a previously set `exp` field is no longer valid.
538	        if not vapid_claims.get("exp") or int(vapid_claims.get("exp") or 0) < int(
539	            time.time()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__main__.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
41	            try:
42	                args.sub_info = json.loads(r.read())
43	            except JSONDecodeError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__main__.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	            with open(args.data) as r:
49	                args.data = r.read()
50	        if args.head:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__main__.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
52	                try:
53	                    args.head = json.loads(r.read())
54	                except JSONDecodeError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/__main__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	                try:
61	                    args.claims = json.loads(r.read())
62	                except JSONDecodeError as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	
28	    def _gen_subscription_info(self, recv_key=None, endpoint="https://example.com/"):
29	        if not recv_key:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
33	            "keys": {
34	                "auth": base64.urlsafe_b64encode(os.urandom(16)).strip(b"="),
35	                "p256dh": self._get_pubkey_str(recv_key),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
39	    def _get_pubkey_str(self, priv_key):
40	        return base64.urlsafe_b64encode(
41	            priv_key.public_key().public_bytes(
42	                encoding=serialization.Encoding.X962,
43	                format=serialization.PublicFormat.UncompressedPoint,
44	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        subscription_info = {
50	            "endpoint": "https://example.com/",
51	            "keys": {
52	                "p256dh": (
53	                    "BOrnIslXrUow2VAzKCUAE4sIbK00daEZCswOcf8m3T"
54	                    "F8V82B-OpOg5JbmYLg44kRcvQC1E2gMJshsUYA-_zMPR8"
55	                ),
56	                "auth": "k8JV6sjdbhAi1n3_LDBLvA",
57	            },
58	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	            WebPusher,
72	            {"endpoint": "https://example.com", "keys": {"p256dh": "AAA="}},
73	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	            WebPusher,
77	            {"endpoint": "https://example.com", "keys": {"auth": "AAA="}},
78	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	            {
83	                "endpoint": "https://example.com",
84	                "keys": {"p256dh": "AAA=", "auth": "AAA="},
85	            },
86	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
109	            if "salt" in encoded:
110	                raw_salt = base64.urlsafe_b64decode(push._repad(encoded["salt"]))
111	            raw_dh = None

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
112	            if content_encoding != "aes128gcm":
113	                raw_dh = base64.urlsafe_b64decode(push._repad(encoded["crypto_key"]))
114	            raw_auth = base64.urlsafe_b64decode(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
113	                raw_dh = base64.urlsafe_b64decode(push._repad(encoded["crypto_key"]))
114	            raw_auth = base64.urlsafe_b64decode(
115	                push._repad(subscription_info["keys"]["auth"])
116	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
140	        WebPusher(subscription_info).send(data, headers)
141	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
142	        pheaders = mock_post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
142	        pheaders = mock_post.call_args[1].get("headers")
143	        assert pheaders.get("ttl") == "0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	        pheaders = mock_post.call_args[1].get("headers")
143	        assert pheaders.get("ttl") == "0"
144	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	        assert pheaders.get("ttl") == "0"
144	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
145	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	        assert pheaders.get("ttl") == "0"
144	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
145	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
144	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
145	        ckey = pheaders.get("crypto-key")
146	        assert "pre-existing" in ckey

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	        assert "pre-existing" in ckey
147	        assert pheaders.get("content-encoding") == "aes128gcm"
148	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	        )
162	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
163	        pheaders = mock_post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
163	        pheaders = mock_post.call_args[1].get("headers")
164	        assert pheaders.get("ttl") == "0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	        pheaders = mock_post.call_args[1].get("headers")
164	        assert pheaders.get("ttl") == "0"
165	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
169	        auth = json.loads(
170	            base64.urlsafe_b64decode(
171	                repad(pheaders["authorization"].split(".")[1])
172	            ).decode("utf8")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
173	        )
174	        assert subscription_info.get("endpoint", "").startswith(auth["aud"])
175	        assert "vapid" in pheaders.get("authorization")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
174	        assert subscription_info.get("endpoint", "").startswith(auth["aud"])
175	        assert "vapid" in pheaders.get("authorization")
176	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	        assert "vapid" in pheaders.get("authorization")
176	        ckey = pheaders.get("crypto-key")
177	        assert "dh=" in ckey

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	        assert "dh=" in ckey
178	        assert pheaders.get("content-encoding") == "aesgcm"
179	        assert pheaders.get("test-header") == "test-value"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	        assert pheaders.get("content-encoding") == "aesgcm"
179	        assert pheaders.get("test-header") == "test-value"
180	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	        claims: Dict[str, Union[str, int]] = dict(
189	            sub="mailto:ops@example.com", aud="https://example.com"
190	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	            sub="mailto:ops@example.com",
209	            aud="https://example.com",
210	            exp=int(time.time() - 48600),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
233	            vapid_claims={
234	                "aud": "https://example.com",
235	                "sub": "mailto:ops@example.com",
236	            },
237	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
250	            vapid_claims={
251	                "aud": "https://example.com",
252	                "sub": "mailto:ops@example.com",
253	            },
254	            vapid_private_key=self.vapid_key,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
261	        WebPusher(subscription_info).send("", headers)
262	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
263	        pheaders = mock_post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
263	        pheaders = mock_post.call_args[1].get("headers")
264	        assert pheaders.get("ttl") == "0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
263	        pheaders = mock_post.call_args[1].get("headers")
264	        assert pheaders.get("ttl") == "0"
265	        assert "encryption" not in pheaders

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	        assert "encryption" not in pheaders
266	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
267	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	        assert "encryption" not in pheaders
266	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
267	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
266	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
267	        ckey = pheaders.get("crypto-key")
268	        assert "pre-existing" in ckey

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
288	        WebPusher(subscription_info).send(data)
289	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
290	        pheaders = mock_post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
289	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
290	        pheaders = mock_post.call_args[1].get("headers")
291	        assert pheaders.get("ttl") == "0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
290	        pheaders = mock_post.call_args[1].get("headers")
291	        assert pheaders.get("ttl") == "0"
292	        assert pheaders.get("content-encoding") == "aes128gcm"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	        assert pheaders.get("ttl") == "0"
292	        assert pheaders.get("content-encoding") == "aes128gcm"
293	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
300	            vapid_claims={
301	                "aud": "https://example.com",
302	                "sub": "mailto:ops@example.com",
303	            },
304	            vapid_private_key=self.vapid_key,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
308	        for s in [
309	            "curl -vX POST https://example.com",
310	            '-H "content-encoding: aes128gcm"',
311	            '-H "authorization: vapid ',
312	            '-H "ttl: 0"',
313	            '-H "content-length:',
314	        ]:
315	            assert s in result, "missing: {}".format(s)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
319	        assert "apple" == ci["foo"]
320	        assert "apple" == ci.get("FOO")
321	        assert "apple" == ci.get("Foo")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	        assert "apple" == ci.get("FOO")
321	        assert "apple" == ci.get("Foo")
322	        del ci["FOO"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
322	        del ci["FOO"]
323	        assert ci.get("Foo") is None
324	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
327	        subscription_info = self._gen_subscription_info(
328	            None, endpoint="https://android.googleapis.com/gcm/send/regid123"
329	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
333	        wp.send(data, headers, gcm_key="gcm_key_value")
334	        pdata = json.loads(mock_post.call_args[1].get("data"))
335	        pheaders = mock_post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
334	        pdata = json.loads(mock_post.call_args[1].get("data"))
335	        pheaders = mock_post.call_args[1].get("headers")
336	        assert pdata["registration_ids"][0] == "regid123"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
336	        assert pdata["registration_ids"][0] == "regid123"
337	        assert pheaders.get("authorization") == "key=gcm_key_value"
338	        assert pheaders.get("content-type") == "application/json"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
337	        assert pheaders.get("authorization") == "key=gcm_key_value"
338	        assert pheaders.get("content-type") == "application/json"
339	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
344	        WebPusher(subscription_info).send(timeout=5.2)
345	        assert mock_post.call_args[1].get("timeout") == 5.2
346	        webpush(subscription_info, timeout=10.001)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
346	        webpush(subscription_info, timeout=10.001)
347	        assert mock_post.call_args[1].get("timeout") == 10.001
348	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
354	        WebPusher(subscription_info, requests_session=mock_session).send(data, headers)
355	        assert subscription_info.get("endpoint") == mock_session.post.call_args[0][0]
356	        pheaders = mock_session.post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
355	        assert subscription_info.get("endpoint") == mock_session.post.call_args[0][0]
356	        pheaders = mock_session.post.call_args[1].get("headers")
357	        assert pheaders.get("ttl") == "0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
356	        pheaders = mock_session.post.call_args[1].get("headers")
357	        assert pheaders.get("ttl") == "0"
358	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
357	        assert pheaders.get("ttl") == "0"
358	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
359	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
357	        assert pheaders.get("ttl") == "0"
358	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
359	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
359	        ckey = pheaders.get("crypto-key")
360	        assert "pre-existing" in ckey

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
360	        assert "pre-existing" in ckey
361	        assert pheaders.get("content-encoding") == "aes128gcm"
362	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
370	        await WebPusher(subscription_info).send_async(data, headers)
371	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
372	        pheaders = mock_post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
371	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
372	        pheaders = mock_post.call_args[1].get("headers")
373	        assert pheaders.get("ttl") == "0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
372	        pheaders = mock_post.call_args[1].get("headers")
373	        assert pheaders.get("ttl") == "0"
374	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
373	        assert pheaders.get("ttl") == "0"
374	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
375	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
373	        assert pheaders.get("ttl") == "0"
374	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
375	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
374	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
375	        ckey = pheaders.get("crypto-key")
376	        assert "pre-existing" in ckey

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
376	        assert "pre-existing" in ckey
377	        assert pheaders.get("content-encoding") == "aes128gcm"
378	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
383	        await WebPusher(subscription_info).send_async("", headers)
384	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
385	        pheaders = mock_post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
384	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
385	        pheaders = mock_post.call_args[1].get("headers")
386	        assert pheaders.get("ttl") == "0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
385	        pheaders = mock_post.call_args[1].get("headers")
386	        assert pheaders.get("ttl") == "0"
387	        assert "encryption" not in pheaders

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
387	        assert "encryption" not in pheaders
388	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
389	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
387	        assert "encryption" not in pheaders
388	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
389	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
388	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
389	        ckey = pheaders.get("crypto-key")
390	        assert "pre-existing" in ckey

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
396	        await WebPusher(subscription_info).send_async(data)
397	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
398	        pheaders = mock_post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
397	        assert subscription_info.get("endpoint") == mock_post.call_args[0][0]
398	        pheaders = mock_post.call_args[1].get("headers")
399	        assert pheaders.get("ttl") == "0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
398	        pheaders = mock_post.call_args[1].get("headers")
399	        assert pheaders.get("ttl") == "0"
400	        assert pheaders.get("content-encoding") == "aes128gcm"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	        assert pheaders.get("ttl") == "0"
400	        assert pheaders.get("content-encoding") == "aes128gcm"
401	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
404	        subscription_info = self._gen_subscription_info(
405	            None, endpoint="https://android.googleapis.com/fcm/send/regid123"
406	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
410	        await wp.send_async(data, headers, gcm_key="gcm_key_value")
411	        pdata = json.loads(mock_post.call_args[1].get("data"))
412	        pheaders = mock_post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
411	        pdata = json.loads(mock_post.call_args[1].get("data"))
412	        pheaders = mock_post.call_args[1].get("headers")
413	        assert pdata["registration_ids"][0] == "regid123"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
413	        assert pdata["registration_ids"][0] == "regid123"
414	        assert pheaders.get("authorization") == "key=gcm_key_value"
415	        assert pheaders.get("content-type") == "application/json"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
414	        assert pheaders.get("authorization") == "key=gcm_key_value"
415	        assert pheaders.get("content-type") == "application/json"
416	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
421	        await WebPusher(subscription_info).send_async(timeout=5.2)
422	        assert mock_post.call_args[1].get("timeout") == 5.2
423	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
431	        )
432	        assert subscription_info.get("endpoint") == mock_session.post.call_args[0][0]
433	        pheaders = mock_session.post.call_args[1].get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
432	        assert subscription_info.get("endpoint") == mock_session.post.call_args[0][0]
433	        pheaders = mock_session.post.call_args[1].get("headers")
434	        assert pheaders.get("ttl") == "0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
433	        pheaders = mock_session.post.call_args[1].get("headers")
434	        assert pheaders.get("ttl") == "0"
435	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
434	        assert pheaders.get("ttl") == "0"
435	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
436	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
434	        assert pheaders.get("ttl") == "0"
435	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
436	        ckey = pheaders.get("crypto-key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
435	        assert pheaders.get("AUTHENTICATION") == headers.get("Authentication")
436	        ckey = pheaders.get("crypto-key")
437	        assert "pre-existing" in ckey

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
437	        assert "pre-existing" in ckey
438	        assert pheaders.get("content-encoding") == "aes128gcm"
439	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
450	        response.text = (
451	            '{"code": 401, "errno": 109, "error": '
452	            '"Unauthorized", "more_info": "http://'
453	            "autopush.readthedocs.io/en/latest/htt"
454	            'p.html#error-codes", "message": "Requ'
455	            "est did not validate missing authoriz"
456	            'ation header"}'
457	        )
458	        response.json.return_value = json.loads(response.text)
459	        response.status_code = 401

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
465	        assert "{}".format(exp.response), "<Response [401]>"
466	        assert cast(requests.Response, exp.response).json().get("errno") == 109
467	        exp = WebPushException("foo", [1, 2, 3])

--------------------------------------------------

Code scanned:
	Total lines of code: 993
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 98.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 114.0
		High: 1.0
Files skipped (0):
