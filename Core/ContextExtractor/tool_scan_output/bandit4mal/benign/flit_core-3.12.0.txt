Run started:2025-04-12 16:58:03.697294

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
148	        with target_path.open('rb') as f:
149	            node = ast.parse(f.read())
150	        for child in node.body:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
303	    for group_name in sorted(d):
304	        fp.write(u'[{}]\n'.format(group_name))
305	        group = d[group_name]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
307	            val = group[name]
308	            fp.write(u'{}={}\n'.format(name, val))
309	        fp.write(u'\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
308	            fp.write(u'{}={}\n'.format(name, val))
309	        fp.write(u'\n')
310	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
312	    with open(path, 'rb') as f:
313	        h = hashlib.new(algorithm, f.read())
314	    return h.hexdigest()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
412	            value = getattr(self, self._normalise_field_name(field))
413	            fp.write(u"{}: {}\n".format(field, value))
414	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
422	                value = '\n        '.join(value.splitlines())
423	                fp.write(u"{}: {}\n".format(field, value))
424	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
428	        if license_expr:
429	            fp.write(u'License-Expression: {}\n'.format(license_expr))
430	        elif license:  # Deprecated, superseded by License-Expression

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
430	        elif license:  # Deprecated, superseded by License-Expression
431	            fp.write(u'License: {}\n'.format(license))
432	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
433	        for clsfr in self.classifiers:
434	            fp.write(u'Classifier: {}\n'.format(clsfr))
435	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
436	        for file in self.license_files:
437	            fp.write(u'License-File: {}\n'.format(file))
438	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
440	            normalised_req = self._normalise_requires_dist(req)
441	            fp.write(u'Requires-Dist: {}\n'.format(normalised_req))
442	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
443	        for url in self.project_urls:
444	            fp.write(u'Project-URL: {}\n'.format(url))
445	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
447	            normalised_extra = normalise_core_metadata_name(extra)
448	            fp.write(u'Provides-Extra: {}\n'.format(normalised_extra))
449	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/common.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
450	        if self.description is not None:
451	            fp.write(u'\n' + self.description + u'\n')
452	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/config.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	        with desc_path.open('r', encoding='utf-8') as f:
288	            raw_desc = f.read()
289	    except IOError as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/config.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
469	            raise ConfigError(
470	                "Invalid glob pattern for [project.license-files]: '{}'. "
471	                "Pattern contains invalid characters. "
472	                "https://packaging.python.org/en/latest/specifications/pyproject-toml/#license-files"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/sdist.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
182	                if ti.isreg():
183	                    with open(path, 'rb') as f:
184	                        tf.addfile(ti, f)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/vendor/tomli/_parser.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
52	    """Parse TOML from a binary file object."""
53	    s_bytes = fp.read()
54	    try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
28	def _write_wheel_file(f, supports_py2=False):
29	    f.write(wheel_file_template)
30	    if supports_py2:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
28	def _write_wheel_file(f, supports_py2=False):
29	    f.write(wheel_file_template)
30	    if supports_py2:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
30	    if supports_py2:
31	        f.write(u"Tag: py2-none-any\n")
32	    f.write(u"Tag: py3-none-any\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
30	    if supports_py2:
31	        f.write(u"Tag: py2-none-any\n")
32	    f.write(u"Tag: py3-none-any\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
31	        f.write(u"Tag: py2-none-any\n")
32	    f.write(u"Tag: py3-none-any\n")
33	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
31	        f.write(u"Tag: py2-none-any\n")
32	    f.write(u"Tag: py3-none-any\n")
33	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	            while True:
130	                buf = src.read(1024 * 8)
131	                if not buf:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
133	                hashsum.update(buf)
134	                dst.write(buf)
135	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
133	                hashsum.update(buf)
134	                dst.write(buf)
135	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
136	        size = os.stat(full_path).st_size
137	        hash_digest = urlsafe_b64encode(hashsum.digest()).decode('ascii').rstrip('=')
138	        self.records.append((rel_path, hash_digest, size))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
154	        hashsum = hashlib.sha256(b)
155	        hash_digest = urlsafe_b64encode(hashsum.digest()).decode('ascii').rstrip('=')
156	        self.wheel_zip.writestr(zi, b, compress_type=zipfile.ZIP_DEFLATED)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	        with self._write_to_zip(self.module.name + ".pth") as f:
169	            f.write(str(self.module.source_dir.resolve()))
170	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
168	        with self._write_to_zip(self.module.name + ".pth") as f:
169	            f.write(str(self.module.source_dir.resolve()))
170	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
199	            for path, hash, size in self.records:
200	                f.write(u'{},sha256={},{}\n'.format(path, hash, size))
201	            # RECORD itself is recorded with no hash or size

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
199	            for path, hash, size in self.records:
200	                f.write(u'{},sha256={},{}\n'.format(path, hash, size))
201	            # RECORD itself is recorded with no hash or size

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
201	            # RECORD itself is recorded with no hash or size
202	            f.write(self.dist_info + '/RECORD,,\n')
203	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/flit_core/wheel.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
201	            # RECORD itself is recorded with no hash or size
202	            f.write(self.dist_info + '/RECORD,,\n')
203	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/tests_core/test_config.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    assert inf.module == 'module1'
18	    assert inf.metadata['home_page'] == 'http://github.com/sirrobin/module1'
19	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/tests_core/test_config.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    assert inf.module == 'ns1.pkg'
23	    assert inf.metadata['home_page'] == 'http://github.com/sirrobin/module1'
24	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/tests_core/test_sdist.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
34	def test_clean_tarinfo():
35	    with tarfile.open(mode='w', fileobj=BytesIO()) as tf:
36	        ti = tf.gettarinfo(str(samples_dir / 'module1.py'))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flit_core-3.12.0/flit_core-3.12.0/tests_core/test_versionno.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
32	    assert nv('v1.3-pre2') == '1.3rc2'
33	    assert nv(' 1.2.5.6\t') == '1.2.5.6'
34	    assert nv('1.0-alpha3-post02+ubuntu_xenial_5') == '1.0a3.post2+ubuntu.xenial.5'

--------------------------------------------------

Code scanned:
	Total lines of code: 3838
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 36.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 0.0
Files skipped (0):
