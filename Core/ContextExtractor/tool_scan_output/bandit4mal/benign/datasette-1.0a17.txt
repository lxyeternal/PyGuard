Run started:2025-04-12 12:56:12.167706

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
349	            with metadata_files[0].open() as fp:
350	                metadata = parse_metadata(fp.read())
351	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
353	            with config_files[0].open() as fp:
354	                config = parse_metadata(fp.read())
355	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
398	        else:
399	            self.executor = futures.ThreadPoolExecutor(
400	                max_workers=self.setting("num_sql_threads")
401	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
491	        if request:
492	            for environment in pm.hook.jinja2_environment_from_request(
493	                datasette=self, request=request, env=environment
494	            ):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
539	                values = [database_name, db.is_memory, schema_version]
540	            await internal_db.execute_write(
541	                """
542	                INSERT OR REPLACE INTO catalog_databases (database_name, path, is_memory, schema_version)
543	                VALUES {}
544	            """.format(
545	                    placeholders
546	                ),
547	                values,
548	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:751
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
750	        # TODO upsert only supported on SQLite 3.24.0 (2018-06-04)
751	        await self.get_internal_database().execute_write(
752	            """
753	              INSERT INTO metadata_instance(key, value)
754	                VALUES(?, ?)
755	                ON CONFLICT(key) DO UPDATE SET value = excluded.value;
756	            """,
757	            [key, value],
758	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
761	        # TODO upsert only supported on SQLite 3.24.0 (2018-06-04)
762	        await self.get_internal_database().execute_write(
763	            """
764	              INSERT INTO metadata_databases(database_name, key, value)
765	                VALUES(?, ?, ?)
766	                ON CONFLICT(database_name, key) DO UPDATE SET value = excluded.value;
767	            """,
768	            [database_name, key, value],
769	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
774	        # TODO upsert only supported on SQLite 3.24.0 (2018-06-04)
775	        await self.get_internal_database().execute_write(
776	            """
777	              INSERT INTO metadata_resources(database_name, resource_name, key, value)
778	                VALUES(?, ?, ?, ?)
779	                ON CONFLICT(database_name, resource_name, key) DO UPDATE SET value = excluded.value;
780	            """,
781	            [database_name, resource_name, key, value],
782	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
792	        # TODO upsert only supported on SQLite 3.24.0 (2018-06-04)
793	        await self.get_internal_database().execute_write(
794	            """
795	              INSERT INTO metadata_columns(database_name, resource_name, column_name, key, value)
796	                VALUES(?, ?, ?, ?, ?)
797	                ON CONFLICT(database_name, resource_name, column_name, key) DO UPDATE SET value = excluded.value;
798	            """,
799	            [database_name, resource_name, column_name, key, value],
800	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
847	            with open(os.path.join(str(app_root), "datasette/static/app.css")) as fp:
848	                self._app_css_hash = hashlib.sha1(fp.read().encode("utf8")).hexdigest()[
849	                    :6

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:1753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1752	        actor = None
1753	        for actor in pm.hook.actor_from_request(datasette=self.ds, request=request):
1754	            actor = await await_me_maybe(actor)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:2033
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2032	        if path.startswith("/"):
2033	            path = f"http://localhost{path}"
2034	        return path

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:2044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2043	    async def get(self, path, **kwargs):
2044	        return await self._request("get", path, **kwargs)
2045	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:2047
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2046	    async def options(self, path, **kwargs):
2047	        return await self._request("options", path, **kwargs)
2048	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:2050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2049	    async def head(self, path, **kwargs):
2050	        return await self._request("head", path, **kwargs)
2051	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:2053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2052	    async def post(self, path, **kwargs):
2053	        return await self._request("post", path, **kwargs)
2054	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:2056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2055	    async def put(self, path, **kwargs):
2056	        return await self._request("put", path, **kwargs)
2057	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:2059
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2058	    async def patch(self, path, **kwargs):
2059	        return await self._request("patch", path, **kwargs)
2060	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:2062
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2061	    async def delete(self, path, **kwargs):
2062	        return await self._request("delete", path, **kwargs)
2063	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/app.py:2070
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2069	        ) as client:
2070	            return await client.request(
2071	                method, self._fix(path, avoid_path_rewrites), **kwargs
2072	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/cli.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	                    textwrap.dedent(
102	                        """
103	                    Your Python installation does not have the ability to load SQLite extensions.
104	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/cli.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
140	    if inspect_file == "-":
141	        sys.stdout.write(json.dumps(inspect_data, indent=2))
142	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/cli.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
143	        with open(inspect_file, "w") as fp:
144	            fp.write(json.dumps(inspect_data, indent=2))
145	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/cli.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
546	    if metadata:
547	        metadata_data = parse_metadata(metadata.read())
548	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/cli.py:551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
550	    if config:
551	        config_data = parse_metadata(config.read())
552	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/cli.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
639	    if root:
640	        url = "http://{}:{}{}?token={}".format(
641	            host, port, ds.urls.path("-/auth-token"), ds._root_token

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/cli.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
353	    "--host",
354	    default="127.0.0.1",
355	    help=(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/cli.py:810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
809	                + suggestion
810	                + "\n\nRead more: https://docs.datasette.io/en/stable/spatialite.html"
811	            )
812	        except ConnectionProblem as e:
813	            raise click.UsageError(
814	                f"Connection to {database.path} failed check: {str(e.args[0])}"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/plugins.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	        except importlib_metadata.PackageNotFoundError:
81	            sys.stderr.write("Plugin {} could not be found\n".format(package_name))
82	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/cloudrun.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	        fail_if_publish_binary_not_installed(
97	            "gcloud", "Google Cloud", "https://cloud.google.com/sdk/"
98	        )
99	        project = check_output(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/cloudrun.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
169	                    with open("metadata.json") as fp:
170	                        print(fp.read())
171	                print("\n==== Dockerfile ====\n")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/cloudrun.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
172	                with open("Dockerfile") as fp:
173	                    print(fp.read())
174	                print("\n====================\n")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	        fail_if_publish_binary_not_installed(
63	            "heroku", "Heroku", "https://cli.heroku.com"
64	        )
65	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	    if metadata:
182	        metadata_content = parse_metadata(metadata.read())
183	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
193	            with open("metadata.json", "w") as fp:
194	                fp.write(json.dumps(metadata_content, indent=2))
195	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
193	            with open("metadata.json", "w") as fp:
194	                fp.write(json.dumps(metadata_content, indent=2))
195	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
196	        with open("runtime.txt", "w") as fp:
197	            fp.write("python-3.11.0")
198	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
196	        with open("runtime.txt", "w") as fp:
197	            fp.write("python-3.11.0")
198	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	            install = [
201	                f"https://github.com/simonw/datasette/archive/{branch}.zip"
202	            ] + list(install)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
206	        with open("requirements.txt", "w") as fp:
207	            fp.write("\n".join(install))
208	        os.mkdir("bin")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
206	        with open("requirements.txt", "w") as fp:
207	            fp.write("\n".join(install))
208	        os.mkdir("bin")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
209	        with open("bin/post_compile", "w") as fp:
210	            fp.write("datasette inspect --inspect-file inspect-data.json")
211	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
209	        with open("bin/post_compile", "w") as fp:
210	            fp.write("datasette inspect --inspect-file inspect-data.json")
211	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
242	        with open("Procfile", "w") as fp:
243	            fp.write(procfile_cmd)
244	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/publish/heroku.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
242	        with open("Procfile", "w") as fp:
243	            fp.write(procfile_cmd)
244	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
180	                    "$base64": True,
181	                    "encoded": base64.b64encode(obj).decode("latin1"),
182	                }

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:181
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
180	                    "$base64": True,
181	                    "encoded": base64.b64encode(obj).decode("latin1"),
182	                }

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
373	):
374	    cmd = ["datasette", "serve", "--host", "0.0.0.0"]
375	    environment_variables = environment_variables or {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
399	    if branch:
400	        install = [f"https://github.com/simonw/datasette/archive/{branch}.zip"] + list(
401	            install

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
470	    if metadata:
471	        metadata_content = parse_metadata(metadata.read())
472	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
498	            with open("metadata.json", "w") as fp:
499	                fp.write(json.dumps(metadata_content, indent=2))
500	        with open("Dockerfile", "w") as fp:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
498	            with open("metadata.json", "w") as fp:
499	                fp.write(json.dumps(metadata_content, indent=2))
500	        with open("Dockerfile", "w") as fp:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
500	        with open("Dockerfile", "w") as fp:
501	            fp.write(dockerfile)
502	        for path, filename in zip(file_paths, file_names):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
500	        with open("Dockerfile", "w") as fp:
501	            fp.write(dockerfile)
502	        for path, filename in zip(file_paths, file_names):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:754
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
753	    with open(path, "r") as file:
754	        code = compile(file.read(), path, "exec", dont_inherit=True)
755	    exec(code, mod.__dict__)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
754	        code = compile(file.read(), path, "exec", dont_inherit=True)
755	    exec(code, mod.__dict__)
756	    return mod

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
823	            raise WriteLimitExceeded(f"CSV contains more than {self.limit_bytes} bytes")
824	        await self.writer.write(bytes)
825	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
823	            raise WriteLimitExceeded(f"CSV contains more than {self.limit_bytes} bytes")
824	        await self.writer.write(bytes)
825	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
831	    async def write(self, content):
832	        await self.writer.write(markupsafe.escape(content))
833	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
831	    async def write(self, content):
832	        await self.writer.write(markupsafe.escape(content))
833	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:1058
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1057	            with open(list(config.values())[0]) as fp:
1058	                return fp.read()
1059	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/__init__.py:1445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1444	        while True:
1445	            chunk = await f.read(chunk_size)
1446	            if not chunk:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/asgi.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
96	        cookies = SimpleCookie()
97	        cookies.load(self.headers.get("cookie", ""))
98	        return {key: value.value for key, value in cookies.items()}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/utils/asgi.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
302	        while more_body:
303	            chunk = await fp.read(chunk_size)
304	            more_body = len(chunk) == chunk_size

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/views/base.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
244	                textwrap.dedent(
245	                    """
246	                <p>SQL query took too long. The time limit is controlled by the

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/views/database.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
400	        try:
401	            cursor = await db.execute_write(canned_query["sql"], params_for_query)
402	            # success message can come from on_success_message or on_success_message_sql

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/datasette/views/database.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
538	                    textwrap.dedent(
539	                        """
540	                    <p>SQL query took too long. The time limit is controlled by the

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/setup.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
9	    ) as fp:
10	        return fp.read()
11	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/setup.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
18	    with open(path) as fp:
19	        exec(fp.read(), g)
20	    return g["__version__"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/setup.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
18	    with open(path) as fp:
19	        exec(fp.read(), g)
20	    return g["__version__"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/setup.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    license="Apache License, Version 2.0",
31	    url="https://datasette.io/",
32	    project_urls={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/setup.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	    project_urls={
33	        "Documentation": "https://docs.datasette.io/en/stable/",
34	        "Changelog": "https://docs.datasette.io/en/stable/changelog.html",
35	        "Live demo": "https://latest.datasette.io/",
36	        "Source code": "https://github.com/simonw/datasette",
37	        "Issues": "https://github.com/simonw/datasette/issues",
38	        "CI": "https://github.com/simonw/datasette/actions?query=workflow%3ATest",
39	    },
40	    packages=find_packages(exclude=("tests",)),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/setup.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	        "Documentation": "https://docs.datasette.io/en/stable/",
34	        "Changelog": "https://docs.datasette.io/en/stable/changelog.html",
35	        "Live demo": "https://latest.datasette.io/",
36	        "Source code": "https://github.com/simonw/datasette",
37	        "Issues": "https://github.com/simonw/datasette/issues",
38	        "CI": "https://github.com/simonw/datasette/actions?query=workflow%3ATest",
39	    },
40	    packages=find_packages(exclude=("tests",)),
41	    package_data={"datasette": ["templates/*.html"]},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/setup.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	        "Changelog": "https://docs.datasette.io/en/stable/changelog.html",
35	        "Live demo": "https://latest.datasette.io/",
36	        "Source code": "https://github.com/simonw/datasette",
37	        "Issues": "https://github.com/simonw/datasette/issues",
38	        "CI": "https://github.com/simonw/datasette/actions?query=workflow%3ATest",
39	    },
40	    packages=find_packages(exclude=("tests",)),
41	    package_data={"datasette": ["templates/*.html"]},
42	    include_package_data=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/setup.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	        "Live demo": "https://latest.datasette.io/",
36	        "Source code": "https://github.com/simonw/datasette",
37	        "Issues": "https://github.com/simonw/datasette/issues",
38	        "CI": "https://github.com/simonw/datasette/actions?query=workflow%3ATest",
39	    },
40	    packages=find_packages(exclude=("tests",)),
41	    package_data={"datasette": ["templates/*.html"]},
42	    include_package_data=True,
43	    python_requires=">=3.8",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/setup.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	        "Source code": "https://github.com/simonw/datasette",
37	        "Issues": "https://github.com/simonw/datasette/issues",
38	        "CI": "https://github.com/simonw/datasette/actions?query=workflow%3ATest",
39	    },
40	    packages=find_packages(exclude=("tests",)),
41	    package_data={"datasette": ["templates/*.html"]},
42	    include_package_data=True,
43	    python_requires=">=3.8",
44	    install_requires=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        "Issues": "https://github.com/simonw/datasette/issues",
38	        "CI": "https://github.com/simonw/datasette/actions?query=workflow%3ATest",
39	    },
40	    packages=find_packages(exclude=("tests",)),
41	    package_data={"datasette": ["templates/*.html"]},
42	    include_package_data=True,
43	    python_requires=">=3.8",
44	    install_requires=[
45	        "asgiref>=3.2.10",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
670	        "error": (
671	            "<p>SQL query took too long. The time limit is controlled by the\n"
672	            '<a href="https://docs.datasette.io/en/stable/settings.html#sql-time-limit-ms">sql_time_limit_ms</a>\n'
673	            "configuration option.</p>\n"
674	            '<textarea style="width: 90%">select sleep(0.5)</textarea>\n'
675	            "<script>\n"
676	            'let ta = document.querySelector("textarea");\n'
677	            'ta.style.height = ta.scrollHeight + "px";\n'
678	            "</script>"
679	        ),
680	        "status": 400,
681	        "title": "SQL Interrupted",
682	    }
683	
684	
685	@pytest.mark.asyncio

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
920	                "table": "one",
921	                "table_url": "http://localhost/data/one",
922	                "table_api_url": "http://localhost/data/one.json",
923	                "schema": (
924	                    "CREATE TABLE [one] (\n"
925	                    "   [id] INTEGER PRIMARY KEY,\n"
926	                    "   [title] TEXT,\n"
927	                    "   [score] INTEGER,\n"
928	                    "   [weight] FLOAT,\n"
929	                    "   [thumbnail] BLOB\n"
930	                    ")"
931	                ),
932	            },
933	            ["create-table"],
934	        ),
935	        # Successful creation with rows:
936	        (
937	            {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
921	                "table_url": "http://localhost/data/one",
922	                "table_api_url": "http://localhost/data/one.json",
923	                "schema": (
924	                    "CREATE TABLE [one] (\n"
925	                    "   [id] INTEGER PRIMARY KEY,\n"
926	                    "   [title] TEXT,\n"
927	                    "   [score] INTEGER,\n"
928	                    "   [weight] FLOAT,\n"
929	                    "   [thumbnail] BLOB\n"
930	                    ")"
931	                ),
932	            },
933	            ["create-table"],
934	        ),
935	        # Successful creation with rows:
936	        (
937	            {
938	                "table": "two",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:958
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
957	                "table": "two",
958	                "table_url": "http://localhost/data/two",
959	                "table_api_url": "http://localhost/data/two.json",
960	                "schema": (
961	                    "CREATE TABLE [two] (\n"
962	                    "   [id] INTEGER PRIMARY KEY,\n"
963	                    "   [title] TEXT,\n"
964	                    "   [score] FLOAT\n"
965	                    ")"
966	                ),
967	                "row_count": 2,
968	            },
969	            ["create-table", "insert-rows"],
970	        ),
971	        # Successful creation with row:
972	        (
973	            {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:959
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
958	                "table_url": "http://localhost/data/two",
959	                "table_api_url": "http://localhost/data/two.json",
960	                "schema": (
961	                    "CREATE TABLE [two] (\n"
962	                    "   [id] INTEGER PRIMARY KEY,\n"
963	                    "   [title] TEXT,\n"
964	                    "   [score] FLOAT\n"
965	                    ")"
966	                ),
967	                "row_count": 2,
968	            },
969	            ["create-table", "insert-rows"],
970	        ),
971	        # Successful creation with row:
972	        (
973	            {
974	                "table": "three",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
986	                "table": "three",
987	                "table_url": "http://localhost/data/three",
988	                "table_api_url": "http://localhost/data/three.json",
989	                "schema": (
990	                    "CREATE TABLE [three] (\n"
991	                    "   [id] INTEGER PRIMARY KEY,\n"
992	                    "   [title] TEXT,\n"
993	                    "   [score] FLOAT\n"
994	                    ")"
995	                ),
996	                "row_count": 1,
997	            },
998	            ["create-table", "insert-rows"],
999	        ),
1000	        # Create with row and no primary key
1001	        (
1002	            {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:988
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
987	                "table_url": "http://localhost/data/three",
988	                "table_api_url": "http://localhost/data/three.json",
989	                "schema": (
990	                    "CREATE TABLE [three] (\n"
991	                    "   [id] INTEGER PRIMARY KEY,\n"
992	                    "   [title] TEXT,\n"
993	                    "   [score] FLOAT\n"
994	                    ")"
995	                ),
996	                "row_count": 1,
997	            },
998	            ["create-table", "insert-rows"],
999	        ),
1000	        # Create with row and no primary key
1001	        (
1002	            {
1003	                "table": "four",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:1013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1012	                "table": "four",
1013	                "table_url": "http://localhost/data/four",
1014	                "table_api_url": "http://localhost/data/four.json",
1015	                "schema": ("CREATE TABLE [four] (\n" "   [name] TEXT\n" ")"),
1016	                "row_count": 1,
1017	            },
1018	            ["create-table", "insert-rows"],
1019	        ),
1020	        # Create table with compound primary key
1021	        (
1022	            {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:1014
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1013	                "table_url": "http://localhost/data/four",
1014	                "table_api_url": "http://localhost/data/four.json",
1015	                "schema": ("CREATE TABLE [four] (\n" "   [name] TEXT\n" ")"),
1016	                "row_count": 1,
1017	            },
1018	            ["create-table", "insert-rows"],
1019	        ),
1020	        # Create table with compound primary key
1021	        (
1022	            {
1023	                "table": "five",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:1032
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1031	                "table": "five",
1032	                "table_url": "http://localhost/data/five",
1033	                "table_api_url": "http://localhost/data/five.json",
1034	                "schema": (
1035	                    "CREATE TABLE [five] (\n   [type] TEXT,\n   [key] INTEGER,\n"
1036	                    "   [title] TEXT,\n   PRIMARY KEY ([type], [key])\n)"
1037	                ),
1038	                "row_count": 1,
1039	            },
1040	            ["create-table", "insert-rows"],
1041	        ),
1042	        # Error: Table is required
1043	        (
1044	            {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:1033
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1032	                "table_url": "http://localhost/data/five",
1033	                "table_api_url": "http://localhost/data/five.json",
1034	                "schema": (
1035	                    "CREATE TABLE [five] (\n   [type] TEXT,\n   [key] INTEGER,\n"
1036	                    "   [title] TEXT,\n   PRIMARY KEY ([type], [key])\n)"
1037	                ),
1038	                "row_count": 1,
1039	            },
1040	            ["create-table", "insert-rows"],
1041	        ),
1042	        # Error: Table is required
1043	        (
1044	            {
1045	                "row": {"id": 1},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_api_write.py:1373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1372	@pytest.mark.asyncio
1373	@pytest.mark.xfail(reason="Flaky, see https://github.com/simonw/datasette/issues/2356")
1374	@pytest.mark.parametrize(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_base_view.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    assert json.loads(response.body) == {
35	        "absolute_url": "http://localhost/",
36	        "request_path": "/foo",
37	    }
38	    # Try a HEAD request

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_base_view.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	    assert json.loads(response.body) == {
66	        "absolute_url": "http://localhost/",
67	        "request_path": "/foo",
68	    }
69	    # Try a HEAD request

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_base_view.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	        "method": "POST",
82	        "absolute_url": "http://localhost/",
83	        "request_path": "/foo",
84	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_canned_queries.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
430	    assert (
431	        '<link rel="alternate" type="application/json+datasette" href="http://localhost/data/update_name.json">'
432	        in response.text
433	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_canned_queries.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
435	        response.headers["link"]
436	        == 'http://localhost/data/update_name.json; rel="alternate"; type="application/json+datasette"'
437	    )
438	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_cli.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
130	        immutable=[],
131	        host="127.0.0.1",
132	        port=8001,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_cli_serve_server.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	def test_serve_localhost_http(ds_localhost_http_server):
8	    response = httpx.get("http://localhost:8041/_memory.json")
9	    assert {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_cli_serve_server.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    client = httpx.Client(transport=transport)
24	    response = client.get("http://localhost/_memory.json")
25	    assert {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_csv.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	    assert response.text == (
151	        "rowid,data\r\n"
152	        "1,http://localhost/fixtures/binary_data/1.blob?_blob_column=data\r\n"
153	        "2,http://localhost/fixtures/binary_data/2.blob?_blob_column=data\r\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_csv.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	    assert response.text == (
166	        "rowid,data\r\n"
167	        '1,"http://localhost/fixtures/-/query.blob?sql=select+rowid,+data+from+binary_data&_blob_column=data&_blob_hash=f3088978da8f9aea479ffc7f631370b968d2e855eeb172bea7f6c7a04262bb6d"\r\n'
168	        '2,"http://localhost/fixtures/-/query.blob?sql=select+rowid,+data+from+binary_data&_blob_column=data&_blob_hash=b835b0483cedb86130b9a2c280880bf5fadc5318ddf8c18d0df5204d40df1724"\r\n'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_csv.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
203	
204	@pytest.mark.xfail(reason="Flaky, see https://github.com/simonw/datasette/issues/2355")
205	def test_max_csv_mb(app_client_csv_max_mb_one):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    assert [
22	        {"name": "created", "toggle_url": "http://localhost/?_facet=created"},
23	        {"name": "planet_int", "toggle_url": "http://localhost/?_facet=planet_int"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        {"name": "created", "toggle_url": "http://localhost/?_facet=created"},
23	        {"name": "planet_int", "toggle_url": "http://localhost/?_facet=planet_int"},
24	        {"name": "on_earth", "toggle_url": "http://localhost/?_facet=on_earth"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        {"name": "planet_int", "toggle_url": "http://localhost/?_facet=planet_int"},
24	        {"name": "on_earth", "toggle_url": "http://localhost/?_facet=on_earth"},
25	        {"name": "state", "toggle_url": "http://localhost/?_facet=state"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        {"name": "on_earth", "toggle_url": "http://localhost/?_facet=on_earth"},
25	        {"name": "state", "toggle_url": "http://localhost/?_facet=state"},
26	        {"name": "_city_id", "toggle_url": "http://localhost/?_facet=_city_id"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	        {"name": "state", "toggle_url": "http://localhost/?_facet=state"},
26	        {"name": "_city_id", "toggle_url": "http://localhost/?_facet=_city_id"},
27	        {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	            "name": "_neighborhood",
29	            "toggle_url": "http://localhost/?_facet=_neighborhood",
30	        },
31	        {"name": "tags", "toggle_url": "http://localhost/?_facet=tags"},
32	        {
33	            "name": "complex_array",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	        },
31	        {"name": "tags", "toggle_url": "http://localhost/?_facet=tags"},
32	        {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	            "name": "complex_array",
34	            "toggle_url": "http://localhost/?_facet=complex_array",
35	        },
36	    ] == suggestions
37	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	            "name": "created",
52	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=created",
53	        },
54	        {
55	            "name": "state",
56	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=state",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	            "name": "state",
56	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=state",
57	        },
58	        {
59	            "name": "_city_id",
60	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=_city_id",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	            "name": "_city_id",
60	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=_city_id",
61	        },
62	        {
63	            "name": "_neighborhood",
64	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=_neighborhood",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	            "name": "_neighborhood",
64	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=_neighborhood",
65	        },
66	        {
67	            "name": "tags",
68	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=tags",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	            "name": "tags",
68	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=tags",
69	        },
70	        {
71	            "name": "complex_array",
72	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=complex_array",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	            "name": "complex_array",
72	            "toggle_url": "http://localhost/?_facet=planet_int&_facet=on_earth&_facet=complex_array",
73	        },
74	    ] == suggestions
75	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	                    "count": 6,
121	                    "toggle_url": "http://localhost/?_facet=_city_id&_city_id__exact=1",
122	                    "selected": False,
123	                },
124	                {
125	                    "value": 2,
126	                    "label": "Los Angeles",
127	                    "count": 4,
128	                    "toggle_url": "http://localhost/?_facet=_city_id&_city_id__exact=2",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	                    "count": 4,
128	                    "toggle_url": "http://localhost/?_facet=_city_id&_city_id__exact=2",
129	                    "selected": False,
130	                },
131	                {
132	                    "value": 3,
133	                    "label": "Detroit",
134	                    "count": 4,
135	                    "toggle_url": "http://localhost/?_facet=_city_id&_city_id__exact=3",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	                    "count": 4,
135	                    "toggle_url": "http://localhost/?_facet=_city_id&_city_id__exact=3",
136	                    "selected": False,
137	                },
138	                {
139	                    "value": 4,
140	                    "label": "Memnonia",
141	                    "count": 1,
142	                    "toggle_url": "http://localhost/?_facet=_city_id&_city_id__exact=4",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	                    "count": 1,
142	                    "toggle_url": "http://localhost/?_facet=_city_id&_city_id__exact=4",
143	                    "selected": False,
144	                },
145	            ],
146	            "truncated": False,
147	        }
148	    ] == buckets

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	                    "count": 2,
173	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Downtown",
174	                    "selected": False,
175	                },
176	                {
177	                    "value": "Arcadia Planitia",
178	                    "label": "Arcadia Planitia",
179	                    "count": 1,
180	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Arcadia+Planitia",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
179	                    "count": 1,
180	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Arcadia+Planitia",
181	                    "selected": False,
182	                },
183	                {
184	                    "value": "Bernal Heights",
185	                    "label": "Bernal Heights",
186	                    "count": 1,
187	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Bernal+Heights",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	                    "count": 1,
187	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Bernal+Heights",
188	                    "selected": False,
189	                },
190	                {
191	                    "value": "Corktown",
192	                    "label": "Corktown",
193	                    "count": 1,
194	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Corktown",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
193	                    "count": 1,
194	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Corktown",
195	                    "selected": False,
196	                },
197	                {
198	                    "value": "Dogpatch",
199	                    "label": "Dogpatch",
200	                    "count": 1,
201	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Dogpatch",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	                    "count": 1,
201	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Dogpatch",
202	                    "selected": False,
203	                },
204	                {
205	                    "value": "Greektown",
206	                    "label": "Greektown",
207	                    "count": 1,
208	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Greektown",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
207	                    "count": 1,
208	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Greektown",
209	                    "selected": False,
210	                },
211	                {
212	                    "value": "Hayes Valley",
213	                    "label": "Hayes Valley",
214	                    "count": 1,
215	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Hayes+Valley",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
214	                    "count": 1,
215	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Hayes+Valley",
216	                    "selected": False,
217	                },
218	                {
219	                    "value": "Hollywood",
220	                    "label": "Hollywood",
221	                    "count": 1,
222	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Hollywood",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
221	                    "count": 1,
222	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Hollywood",
223	                    "selected": False,
224	                },
225	                {
226	                    "value": "Koreatown",
227	                    "label": "Koreatown",
228	                    "count": 1,
229	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Koreatown",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	                    "count": 1,
229	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Koreatown",
230	                    "selected": False,
231	                },
232	                {
233	                    "value": "Los Feliz",
234	                    "label": "Los Feliz",
235	                    "count": 1,
236	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Los+Feliz",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
235	                    "count": 1,
236	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Los+Feliz",
237	                    "selected": False,
238	                },
239	                {
240	                    "value": "Mexicantown",
241	                    "label": "Mexicantown",
242	                    "count": 1,
243	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Mexicantown",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
242	                    "count": 1,
243	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Mexicantown",
244	                    "selected": False,
245	                },
246	                {
247	                    "value": "Mission",
248	                    "label": "Mission",
249	                    "count": 1,
250	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Mission",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
249	                    "count": 1,
250	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Mission",
251	                    "selected": False,
252	                },
253	                {
254	                    "value": "SOMA",
255	                    "label": "SOMA",
256	                    "count": 1,
257	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=SOMA",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
256	                    "count": 1,
257	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=SOMA",
258	                    "selected": False,
259	                },
260	                {
261	                    "value": "Tenderloin",
262	                    "label": "Tenderloin",
263	                    "count": 1,
264	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Tenderloin",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
263	                    "count": 1,
264	                    "toggle_url": "http://localhost/?_facet=_neighborhood&_neighborhood__exact=Tenderloin",
265	                    "selected": False,
266	                },
267	            ],
268	            "truncated": False,
269	        }
270	    ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
295	                    "count": 6,
296	                    "toggle_url": "http://localhost/?_city_id__exact=1",
297	                    "selected": False,
298	                },
299	                {
300	                    "value": 2,
301	                    "label": "Los Angeles",
302	                    "count": 4,
303	                    "toggle_url": "http://localhost/?_city_id__exact=2",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	                    "count": 4,
303	                    "toggle_url": "http://localhost/?_city_id__exact=2",
304	                    "selected": False,
305	                },
306	                {
307	                    "value": 3,
308	                    "label": "Detroit",
309	                    "count": 4,
310	                    "toggle_url": "http://localhost/?_city_id__exact=3",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
309	                    "count": 4,
310	                    "toggle_url": "http://localhost/?_city_id__exact=3",
311	                    "selected": False,
312	                },
313	                {
314	                    "value": 4,
315	                    "label": "Memnonia",
316	                    "count": 1,
317	                    "toggle_url": "http://localhost/?_city_id__exact=4",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
316	                    "count": 1,
317	                    "toggle_url": "http://localhost/?_city_id__exact=4",
318	                    "selected": False,
319	                },
320	            ],
321	            "truncated": False,
322	        }
323	    ] == buckets

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
340	            "type": "array",
341	            "toggle_url": "http://localhost/?_facet_array=tags",
342	        }
343	    ] == suggestions
344	
345	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
380	                    "count": 2,
381	                    "toggle_url": "http://localhost/?_facet_array=tags&tags__arraycontains=tag1",
382	                    "selected": False,
383	                },
384	                {
385	                    "value": "tag2",
386	                    "label": "tag2",
387	                    "count": 1,
388	                    "toggle_url": "http://localhost/?_facet_array=tags&tags__arraycontains=tag2",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
387	                    "count": 1,
388	                    "toggle_url": "http://localhost/?_facet_array=tags&tags__arraycontains=tag2",
389	                    "selected": False,
390	                },
391	                {
392	                    "value": "tag3",
393	                    "label": "tag3",
394	                    "count": 1,
395	                    "toggle_url": "http://localhost/?_facet_array=tags&tags__arraycontains=tag3",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
394	                    "count": 1,
395	                    "toggle_url": "http://localhost/?_facet_array=tags&tags__arraycontains=tag3",
396	                    "selected": False,
397	                },
398	            ],
399	            "hideable": True,
400	            "toggle_url": "/",
401	            "truncated": False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
429	                "count": 2,
430	                "toggle_url": "http://localhost/test_array_facet/otters.json?_facet_array=tags&tags__arraycontains=cunning",
431	                "selected": False,
432	            },
433	            {
434	                "value": "empathetic",
435	                "label": "empathetic",
436	                "count": 2,
437	                "toggle_url": "http://localhost/test_array_facet/otters.json?_facet_array=tags&tags__arraycontains=empathetic",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
436	                "count": 2,
437	                "toggle_url": "http://localhost/test_array_facet/otters.json?_facet_array=tags&tags__arraycontains=empathetic",
438	                "selected": False,
439	            },
440	            {
441	                "value": "friendly",
442	                "label": "friendly",
443	                "count": 2,
444	                "toggle_url": "http://localhost/test_array_facet/otters.json?_facet_array=tags&tags__arraycontains=friendly",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
443	                "count": 2,
444	                "toggle_url": "http://localhost/test_array_facet/otters.json?_facet_array=tags&tags__arraycontains=friendly",
445	                "selected": False,
446	            },
447	            {
448	                "value": "eager",
449	                "label": "eager",
450	                "count": 1,
451	                "toggle_url": "http://localhost/test_array_facet/otters.json?_facet_array=tags&tags__arraycontains=eager",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
450	                "count": 1,
451	                "toggle_url": "http://localhost/test_array_facet/otters.json?_facet_array=tags&tags__arraycontains=eager",
452	                "selected": False,
453	            },
454	        ],
455	        "hideable": True,
456	        "toggle_url": "/test_array_facet/otters.json",
457	        "truncated": False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
480	                    "count": 4,
481	                    "toggle_url": "http://localhost/?_facet_date=created&created__date=2019-01-14",
482	                    "selected": False,
483	                },
484	                {
485	                    "value": "2019-01-15",
486	                    "label": "2019-01-15",
487	                    "count": 4,
488	                    "toggle_url": "http://localhost/?_facet_date=created&created__date=2019-01-15",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
487	                    "count": 4,
488	                    "toggle_url": "http://localhost/?_facet_date=created&created__date=2019-01-15",
489	                    "selected": False,
490	                },
491	                {
492	                    "value": "2019-01-17",
493	                    "label": "2019-01-17",
494	                    "count": 4,
495	                    "toggle_url": "http://localhost/?_facet_date=created&created__date=2019-01-17",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
494	                    "count": 4,
495	                    "toggle_url": "http://localhost/?_facet_date=created&created__date=2019-01-17",
496	                    "selected": False,
497	                },
498	                {
499	                    "value": "2019-01-16",
500	                    "label": "2019-01-16",
501	                    "count": 3,
502	                    "toggle_url": "http://localhost/?_facet_date=created&created__date=2019-01-16",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
501	                    "count": 3,
502	                    "toggle_url": "http://localhost/?_facet_date=created&created__date=2019-01-16",
503	                    "selected": False,
504	                },
505	            ],
506	            "hideable": True,
507	            "toggle_url": "/",
508	            "truncated": False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
525	            "type": "array",
526	            "toggle_url": "http://localhost/test_json_array/foo.json?_extra=suggested_facets&_facet_array=json_column",
527	        }
528	    ]
529	
530	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
548	            "name": "neighbourhood",
549	            "toggle_url": "http://localhost/test_facet_size/neighbourhoods.json?_extra=suggested_facets&_facet=neighbourhood",
550	        }
551	    ]
552	    # Bump up _facet_size= to suggest city too

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
559	            "name": "city",
560	            "toggle_url": "http://localhost/test_facet_size/neighbourhoods.json?_facet_size=50&_extra=suggested_facets&_facet=city",
561	        },
562	        {
563	            "name": "neighbourhood",
564	            "toggle_url": "http://localhost/test_facet_size/neighbourhoods.json?_facet_size=50&_extra=suggested_facets&_facet=neighbourhood",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
563	            "name": "neighbourhood",
564	            "toggle_url": "http://localhost/test_facet_size/neighbourhoods.json?_facet_size=50&_extra=suggested_facets&_facet=neighbourhood",
565	        },
566	    ]
567	    # Facet by city should return expected number of results

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_facets.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
688	                "name": "col",
689	                "toggle_url": "http://localhost/test_facet_only_x_rows/t.json?_extra=suggested_facets&_facet=col",
690	            }
691	        ]
692	        # But if we set suggest_consider to 100 they are not suggested

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	    expected_html_fragments = [
213	        """
214	        <a href="https://docs.datasette.io/en/stable/settings.html#sql-time-limit-ms">sql_time_limit_ms</a>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	                {
240	                    "sql": "select 'this is longer than 5' as a, 'https://example.com/' as b"
241	                }
242	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
248	            '<td class="col-a">this </td>',
249	            '<td class="col-b"><a href="https://example.com/">http</a></td>',
250	        ]
251	
252	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
626	    path = "/fixtures/-/query?" + urllib.parse.urlencode(
627	        {"sql": "select ('https://twitter.com/' || 'simonw') as user_url;"}
628	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
632	    assert (
633	        """<td class="col-user_url">
634	 <a href="https://twitter.com/simonw">
635	  https://twitter.com/simonw
636	 </a>
637	</td>"""
638	        == soup.find("td", {"class": "col-user_url"}).prettify().strip()
639	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
644	    path = "/fixtures/-/query?" + urllib.parse.urlencode(
645	        {"sql": "select ('https://twitter.com/' || 'simonw') as user_url;"}
646	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
662	    assert [
663	        ("sql", "select ('https://twitter.com/' || 'simonw') as user_url;"),
664	        ("_hide_sql", "1"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
869	            not in {
870	                "https://datasette.io/",
871	                "https://github.com/simonw/datasette",
872	                "https://github.com/simonw/datasette/blob/main/LICENSE",
873	                "https://github.com/simonw/datasette/blob/main/tests/fixtures.py",
874	                "/login-as-root",  # Only used for the latest.datasette.io demo
875	            }
876	            and not href.startswith("https://plugin-example.datasette.io/")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
870	                "https://datasette.io/",
871	                "https://github.com/simonw/datasette",
872	                "https://github.com/simonw/datasette/blob/main/LICENSE",
873	                "https://github.com/simonw/datasette/blob/main/tests/fixtures.py",
874	                "/login-as-root",  # Only used for the latest.datasette.io demo
875	            }
876	            and not href.startswith("https://plugin-example.datasette.io/")
877	        ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
871	                "https://github.com/simonw/datasette",
872	                "https://github.com/simonw/datasette/blob/main/LICENSE",
873	                "https://github.com/simonw/datasette/blob/main/tests/fixtures.py",
874	                "/login-as-root",  # Only used for the latest.datasette.io demo
875	            }
876	            and not href.startswith("https://plugin-example.datasette.io/")
877	        ):
878	            # If this has been made absolute it may start http://localhost/

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:873
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
872	                "https://github.com/simonw/datasette/blob/main/LICENSE",
873	                "https://github.com/simonw/datasette/blob/main/tests/fixtures.py",
874	                "/login-as-root",  # Only used for the latest.datasette.io demo
875	            }
876	            and not href.startswith("https://plugin-example.datasette.io/")
877	        ):
878	            # If this has been made absolute it may start http://localhost/
879	            if href.startswith("http://localhost/"):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:876
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
875	            }
876	            and not href.startswith("https://plugin-example.datasette.io/")
877	        ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:879
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
878	            # If this has been made absolute it may start http://localhost/
879	            if href.startswith("http://localhost/"):
880	                href = href[len("http://localost/") :]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:880
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
879	            if href.startswith("http://localhost/"):
880	                href = href[len("http://localost/") :]
881	            assert href.startswith("/prefix/"), json.dumps(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:1005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1004	        # Instance index page
1005	        ("/", "http://localhost/.json"),
1006	        # Table page
1007	        ("/fixtures/facetable", "http://localhost/fixtures/facetable.json"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:1007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1006	        # Table page
1007	        ("/fixtures/facetable", "http://localhost/fixtures/facetable.json"),
1008	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:1010
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1009	            "/fixtures/table~2Fwith~2Fslashes~2Ecsv",
1010	            "http://localhost/fixtures/table~2Fwith~2Fslashes~2Ecsv.json",
1011	        ),
1012	        # Row page
1013	        (
1014	            "/fixtures/no_primary_key/1",
1015	            "http://localhost/fixtures/no_primary_key/1.json",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:1015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1014	            "/fixtures/no_primary_key/1",
1015	            "http://localhost/fixtures/no_primary_key/1.json",
1016	        ),
1017	        # Database index page
1018	        (
1019	            "/fixtures",
1020	            "http://localhost/fixtures.json",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:1020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1019	            "/fixtures",
1020	            "http://localhost/fixtures.json",
1021	        ),
1022	        # Custom query page
1023	        (
1024	            "/fixtures/-/query?sql=select+*+from+facetable",
1025	            "http://localhost/fixtures/-/query.json?sql=select+*+from+facetable",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:1025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1024	            "/fixtures/-/query?sql=select+*+from+facetable",
1025	            "http://localhost/fixtures/-/query.json?sql=select+*+from+facetable",
1026	        ),
1027	        # Canned query page
1028	        (
1029	            "/fixtures/neighborhood_search?text=town",
1030	            "http://localhost/fixtures/neighborhood_search.json?text=town",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:1030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1029	            "/fixtures/neighborhood_search?text=town",
1030	            "http://localhost/fixtures/neighborhood_search.json?text=town",
1031	        ),
1032	        # /-/ pages
1033	        (
1034	            "/-/plugins",
1035	            "http://localhost/-/plugins.json",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_html.py:1035
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1034	            "/-/plugins",
1035	            "http://localhost/-/plugins.json",
1036	        ),
1037	    ),
1038	)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_internals_database.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
467	async def test_execute_write_block_true(db):
468	    await db.execute_write(
469	        "update roadside_attractions set name = ? where pk = ?", ["Mystery!", 1]
470	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_internals_database.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
476	async def test_execute_write_block_false(db):
477	    await db.execute_write(
478	        "update roadside_attractions set name = ? where pk = ?",
479	        ["Mystery!", 1],
480	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_internals_database.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
507	    # The sleep() function is only available if ds._prepare_connection() was called
508	    await db.execute_write("select sleep(0.01)")
509	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_internals_database.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
589	    # Create temporary table in write
590	    await db.execute_write(
591	        "create temporary table created_by_write (id integer primary key)"
592	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_internals_database.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
659	    # Now create a table in foo
660	    await foo1.execute_write("create table foo (t text)")
661	    assert await foo1.table_names() == ["foo"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_internals_database.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
674	    # Using db.execute_write() should work:
675	    await db.execute_write("create table foo (t text)")
676	    assert await db.table_names() == ["foo"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_internals_datasette_client.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
29	    # Try that again using datasette.client.request
30	    response2 = await datasette.client.request(method, path)
31	    assert response2.status_code == expected_status

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_internals_request.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        repr(request)
89	        == '<asgi.Request method="GET" url="http://localhost/foo?multi=1&multi=2&single=3">'
90	    )
91	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_package.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
37	    with open("test.db", "w") as fp:
38	        fp.write("data")
39	    result = runner.invoke(cli.cli, ["package", "test.db", "--secret", "sekrit"])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_package.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	    with open("test.db", "w") as fp:
54	        fp.write("data")
55	    result = runner.invoke(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
123	    encoded = special_href.split("/")[3]
124	    actual_decoded_object = json.loads(base64.b64decode(encoded).decode("utf8"))
125	    assert expected_decoded_object == actual_decoded_object

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:124
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
123	    encoded = special_href.split("/")[3]
124	    actual_decoded_object = json.loads(base64.b64decode(encoded).decode("utf8"))
125	    assert expected_decoded_object == actual_decoded_object

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	            "crossorigin": "anonymous",
137	            "src": "https://plugin-example.datasette.io/jquery.js",
138	        },
139	        {
140	            "src": "https://plugin-example.datasette.io/plugin.module.js",
141	            "type": "module",
142	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	        {
140	            "src": "https://plugin-example.datasette.io/plugin.module.js",
141	            "type": "module",
142	        },
143	    ]:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	    # jquery.js loaded once:
161	    assert 1 == srcs.count("https://plugin-example.datasette.io/jquery.js")
162	    # plugin1.js and plugin2.js are both there:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	    # plugin1.js and plugin2.js are both there:
163	    assert 1 == srcs.count("https://plugin-example.datasette.io/plugin1.js")
164	    assert 1 == srcs.count("https://plugin-example.datasette.io/plugin2.js")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
163	    assert 1 == srcs.count("https://plugin-example.datasette.io/plugin1.js")
164	    assert 1 == srcs.count("https://plugin-example.datasette.io/plugin2.js")
165	    # jquery comes before them both

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	    # jquery comes before them both
166	    assert srcs.index("https://plugin-example.datasette.io/jquery.js") < srcs.index(
167	        "https://plugin-example.datasette.io/plugin1.js"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	    assert srcs.index("https://plugin-example.datasette.io/jquery.js") < srcs.index(
167	        "https://plugin-example.datasette.io/plugin1.js"
168	    )
169	    assert srcs.index("https://plugin-example.datasette.io/jquery.js") < srcs.index(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	    )
169	    assert srcs.index("https://plugin-example.datasette.io/jquery.js") < srcs.index(
170	        "https://plugin-example.datasette.io/plugin2.js"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	    assert srcs.index("https://plugin-example.datasette.io/jquery.js") < srcs.index(
170	        "https://plugin-example.datasette.io/plugin2.js"
171	    )
172	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	async def test_hook_render_cell_link_from_json(ds_client):
176	    sql = """
177	        select '{"href": "http://example.com/", "label":"Example"}'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	    assert a is not None, str(a)
184	    assert a.attrs["href"] == "http://example.com/"
185	    assert a.attrs["data-database"] == "fixtures"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
263	    with open(TEMP_PLUGIN_SECRET_FILE, "w") as fp:
264	        fp.write("FROM_FILE")
265	    assert {"foo": "FROM_FILE"} == ds_client.ds.plugin_config("file-plugin")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
488	        "table": "facetable",
489	        "request": '<asgi.Request method="GET" url="http://localhost/fixtures/facetable.testall">',
490	        "view_name": "table",
491	        "1+1": 2,
492	    }
493	    # Test that query_name is set correctly
494	    query_response = await ds_client.get("/fixtures/pragma_cache_size.testall")
495	    assert query_response.json()["query_name"] == "pragma_cache_size"
496	
497	
498	@pytest.mark.asyncio
499	async def test_hook_register_output_renderer_custom_status_code(ds_client):
500	    response = await ds_client.get(
501	        "/fixtures/pragma_cache_size.testall?status_code=202"
502	    )
503	    assert response.status_code == 202
504	
505	
506	@pytest.mark.asyncio
507	async def test_hook_register_output_renderer_custom_content_type(ds_client):
508	    response = await ds_client.get(
509	        "/fixtures/pragma_cache_size.testall?content_type=text/blah"
510	    )
511	    assert "text/blah" == response.headers["content-type"]
512	
513	
514	@pytest.mark.asyncio
515	async def test_hook_register_output_renderer_custom_headers(ds_client):
516	    response = await ds_client.get(
517	        "/fixtures/pragma_cache_size.testall?header=x-wow:1&header=x-gosh:2"
518	    )
519	    assert "1" == response.headers["x-wow"]
520	    assert "2" == response.headers["x-gosh"]
521	
522	
523	@pytest.mark.asyncio
524	async def test_hook_register_output_renderer_returning_response(ds_client):
525	    response = await ds_client.get("/fixtures/facetable.testresponse")
526	    assert response.status_code == 200
527	    assert response.json() == {"this_is": "json"}
528	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
603	            "name": "pk1",
604	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet_dummy=pk1",
605	            "type": "dummy",
606	        },
607	        {
608	            "name": "pk2",
609	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet_dummy=pk2",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
608	            "name": "pk2",
609	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet_dummy=pk2",
610	            "type": "dummy",
611	        },
612	        {
613	            "name": "pk3",
614	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet_dummy=pk3",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
613	            "name": "pk3",
614	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet_dummy=pk3",
615	            "type": "dummy",
616	        },
617	        {
618	            "name": "content",
619	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet_dummy=content",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
618	            "name": "content",
619	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet_dummy=content",
620	            "type": "dummy",
621	        },
622	        {
623	            "name": "pk1",
624	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet=pk1",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
623	            "name": "pk1",
624	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet=pk1",
625	        },
626	        {
627	            "name": "pk2",
628	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet=pk2",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
627	            "name": "pk2",
628	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet=pk2",
629	        },
630	        {
631	            "name": "pk3",
632	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet=pk3",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
631	            "name": "pk3",
632	            "toggle_url": "http://localhost/fixtures/compound_three_primary_keys.json?_dummy_facet=1&_extra=suggested_facets&_facet=pk3",
633	        },
634	    ]
635	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:907
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
906	    request, exception = ds_client.ds._exception_hook_fired
907	    assert request.url == "http://localhost/trigger-error?x=123"
908	    assert isinstance(exception, ZeroDivisionError)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:1290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1289	    db = ds.add_memory_database("actors_from_ids")
1290	    await db.execute_write(
1291	        "create table actors (id text primary key, name text, age int)"
1292	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:1293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1292	    )
1293	    await db.execute_write(
1294	        "insert into actors (id, name, age) values ('3', 'Cate Blanchett', 52)"
1295	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:1296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1295	    )
1296	    await db.execute_write(
1297	        "insert into actors (id, name, age) values ('5', 'Rooney Mara', 36)"
1298	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:1299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1298	    )
1299	    await db.execute_write(
1300	        "insert into actors (id, name, age) values ('7', 'Sarah Paulson', 46)"
1301	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_plugins.py:1302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1301	    )
1302	    await db.execute_write(
1303	        "insert into actors (id, name, age) values ('9', 'Helena Bonham Carter', 55)"
1304	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_cloudrun.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
16	    with open("test.db", "w") as fp:
17	        fp.write("data")
18	    result = runner.invoke(cli.cli, ["publish", "cloudrun", "test.db"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_cloudrun.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    mock_get_existing_services.return_value = [
41	        {"name": "existing", "created": "2019-01-01", "url": "http://www.example.com/"}
42	    ]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_cloudrun.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	    with open("test.db", "w") as fp:
48	        fp.write("data")
49	    result = runner.invoke(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_cloudrun.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    assert (
53	        "Please provide a service name for this deployment\n\n"
54	        "Using an existing service name will over-write it\n\n"
55	        "Your existing services:\n\n"
56	        "  existing - created 2019-01-01 - http://www.example.com/\n\n"
57	        "Service name: input-service"
58	    ) == result.output.strip()
59	    assert 0 == result.exit_code
60	    tag = "gcr.io/myproject/datasette-input-service"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_cloudrun.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
83	    with open("test.db", "w") as fp:
84	        fp.write("data")
85	    result = runner.invoke(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_cloudrun.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
156	    with open("test.db", "w") as fp:
157	        fp.write("data")
158	    args = ["publish", "cloudrun", "test.db", "--service", "test"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_cloudrun.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
205	    with open("test.db", "w") as fp:
206	        fp.write("data")
207	    with open("metadata.yml", "w") as fp:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_cloudrun.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
207	    with open("metadata.yml", "w") as fp:
208	        fp.write(
209	            textwrap.dedent(
210	                """
211	            title: Hello from metadata YAML

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_cloudrun.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
286	    with open("test.db", "w") as fp:
287	        fp.write("data")
288	    result = runner.invoke(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_cloudrun.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
355	    with open("test.db", "w") as fp:
356	        fp.write("data")
357	    result = runner.invoke(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_heroku.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
15	    with open("test.db", "w") as fp:
16	        fp.write("data")
17	    result = runner.invoke(cli.cli, ["publish", "heroku", "test.db"])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_heroku.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
33	    with open("t.db", "w") as fp:
34	        fp.write("data")
35	    result = runner.invoke(cli.cli, ["publish", "heroku", "t.db"], input="y\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_heroku.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
67	    with open("test.db", "w") as fp:
68	        fp.write("data")
69	    result = runner.invoke(cli.cli, ["publish", "heroku", "test.db", "--tar", "gtar"])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_heroku.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
103	    with open("test.db", "w") as fp:
104	        fp.write("data")
105	    result = runner.invoke(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_heroku.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
147	    with open("test.db", "w") as fp:
148	        fp.write("data")
149	    output = str(tmp_path_factory.mktemp("generate_dir") / "output")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_publish_heroku.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
182	        with open(path / name) as fp:
183	            assert fp.read().strip() == expected

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	            "and": "and",
170	            "json": '{"href": "http://example.com/", "label":"Example"}',
171	        }
172	    ]
173	
174	
175	@pytest.mark.asyncio
176	@pytest.mark.parametrize(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
211	            assert urllib.parse.urlencode({"_next": response.json()["next"]}) in path
212	            path = path.replace("http://localhost", "")
213	        assert count < 30, "Possible infinite loop detected"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
257	        if path:
258	            path = path.replace("http://localhost", "")
259	        assert page < 100

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
279	        if path:
280	            path = path.replace("http://localhost", "")
281	    assert 2 == page

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
334	        if path:
335	            path = path.replace("http://localhost", "")
336	    assert page == 5

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
686	            "5497 Highway 9, Felton, CA 95018",
687	            "https://www.bigfootdiscoveryproject.com/",
688	            37.0414,
689	            -122.0725,
690	        ],
691	    ]
692	
693	    assert (
694	        response.json()["human_description_en"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
733	        if path:
734	            path = path.replace("http://localhost", "")
735	    assert len(fetched) == 201

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:925
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
924	            "count": 2,
925	            "toggle_url": "http://localhost/fixtures/facetable.json?_facet_array=tags&tags__arraycontains=tag1",
926	            "selected": False,
927	        },
928	        {
929	            "value": "tag2",
930	            "label": "tag2",
931	            "count": 1,
932	            "toggle_url": "http://localhost/fixtures/facetable.json?_facet_array=tags&tags__arraycontains=tag2",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:932
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
931	            "count": 1,
932	            "toggle_url": "http://localhost/fixtures/facetable.json?_facet_array=tags&tags__arraycontains=tag2",
933	            "selected": False,
934	        },
935	        {
936	            "value": "tag3",
937	            "label": "tag3",
938	            "count": 1,
939	            "toggle_url": "http://localhost/fixtures/facetable.json?_facet_array=tags&tags__arraycontains=tag3",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:939
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
938	            "count": 1,
939	            "toggle_url": "http://localhost/fixtures/facetable.json?_facet_array=tags&tags__arraycontains=tag3",
940	            "selected": False,
941	        },
942	    ]
943	
944	
945	@pytest.mark.asyncio

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_api.py:1240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1239	            path = link[1:].split(">")[0]
1240	            path = path.replace("http://localhost", "")
1241	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_html.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        assert [str(td) for td in tds] == [
79	            '<td class="col-url type-str"><a href="https://www.mysteryspot.com/">http</a></td>',
80	            '<td class="col-url type-str"><a href="https://winchestermysteryhouse.com/">http</a></td>',
81	            '<td class="col-url type-none">\xa0</td>',
82	            '<td class="col-url type-str"><a href="https://www.bigfootdiscoveryproject.com/">http</a></td>',
83	        ]
84	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_html.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	            '<td class="col-url type-str"><a href="https://www.mysteryspot.com/">http</a></td>',
80	            '<td class="col-url type-str"><a href="https://winchestermysteryhouse.com/">http</a></td>',
81	            '<td class="col-url type-none">\xa0</td>',
82	            '<td class="col-url type-str"><a href="https://www.bigfootdiscoveryproject.com/">http</a></td>',
83	        ]
84	
85	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_html.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	            '<td class="col-url type-none">\xa0</td>',
82	            '<td class="col-url type-str"><a href="https://www.bigfootdiscoveryproject.com/">http</a></td>',
83	        ]
84	
85	
86	@pytest.mark.asyncio
87	async def test_add_filter_redirects(ds_client):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_table_html.py:642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
641	    assert (
642	        '<li><a href="http://localhost/fixtures/foreign_key_references?_facet=foreign_key_with_blank_label&amp;foreign_key_with_blank_label=3"'
643	        ' data-facet-value="3">-</a> 1</li>'
644	    ) in response.text
645	
646	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	        "-- sql comment to skip\nupdate blah;",
142	        "update blah set some_column='# Hello there\n\n* This is a list\n* of items\n--\n[And a link](https://github.com/simonw/datasette-render-markdown).'\nas demo_markdown",
143	        "PRAGMA case_sensitive_like = true",
144	        "SELECT * FROM pragma_not_on_allow_list('idx52')",
145	        "/* This comment is not valid. select 1",
146	        "/**/\nupdate foo set bar = 1\n/* test */ select 1",
147	    ],
148	)
149	def test_validate_sql_select_bad(bad_sql):
150	    with pytest.raises(utils.InvalidSql):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	        "--sql comment to skip\nselect foo from bar",
160	        "select '# Hello there\n\n* This is a list\n* of items\n--\n[And a link](https://github.com/simonw/datasette-render-markdown).'\nas demo_markdown",
161	        "select 1 + 1",
162	        "explain select 1 + 1",
163	        "explain\nselect 1 + 1",
164	        "explain query plan select 1 + 1",
165	        "explain  query  plan\nselect 1 + 1",
166	        "SELECT\nblah FROM foo",
167	        "WITH RECURSIVE cnt(x) AS (SELECT 1 UNION ALL SELECT x+1 FROM cnt LIMIT 10) SELECT x FROM cnt;",
168	        "explain WITH RECURSIVE cnt(x) AS (SELECT 1 UNION ALL SELECT x+1 FROM cnt LIMIT 10) SELECT x FROM cnt;",
169	        "explain query plan WITH RECURSIVE cnt(x) AS (SELECT 1 UNION ALL SELECT x+1 FROM cnt LIMIT 10) SELECT x FROM cnt;",
170	        "SELECT * FROM pragma_index_info('idx52')",
171	        "select * from pragma_table_xinfo('table')",
172	        # Various types of comment
173	        "-- comment\nselect 1",
174	        "-- one line\n  -- two line\nselect 1",
175	        "  /* comment */\nselect 1",
176	        "  /* comment */select 1",
177	        "/* comment */\n -- another\n /* one more */ select 1",
178	        "/* This comment \n has multiple lines */\nselect 1",
179	    ],
180	)
181	def test_validate_sql_select_good(good_sql):
182	    utils.validate_sql_select(good_sql)
183	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
233	    [
234	        ("http://www.google.com/", True),
235	        ("https://example.com/", True),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
234	        ("http://www.google.com/", True),
235	        ("https://example.com/", True),
236	        ("www.google.com", False),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
236	        ("www.google.com", False),
237	        ("http://www.google.com/ is a search engine", False),
238	    ],

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
263	        with open("hello", "w") as fp:
264	            fp.write("world")
265	        # Default usage of this should use symlink

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
263	        with open("hello", "w") as fp:
264	            fp.write("world")
265	        # Default usage of this should use symlink

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
281	            with open(hello) as fp:
282	                assert "world" == fp.read()
283	            # It should be a hard link

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
293	        with open("hello", "w") as fp:
294	            fp.write("world")
295	        # Default usage of this should use symlink

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
293	        with open("hello", "w") as fp:
294	            fp.write("world")
295	        # Default usage of this should use symlink

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
311	            with open(hello) as fp:
312	                assert "world" == fp.read()
313	            # It should be a copy, not a hard link

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
320	        with open("hello", "w") as fp:
321	            fp.write("world")
322	        with utils.temporary_docker_directory(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
320	        with open("hello", "w") as fp:
321	            fp.write("world")
322	        with utils.temporary_docker_directory(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
337	            with open(df) as fp:
338	                df_contents = fp.read()
339	            assert "'$PWD'" in df_contents

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
647	    (
648	        ("https://example.com/", 5, "http"),
649	        ("https://example.com/foo/bar", 15, "https://exampl"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
648	        ("https://example.com/", 5, "http"),
649	        ("https://example.com/foo/bar", 15, "https://exampl"),
650	        ("https://example.com/foo/bar/baz.jpg", 30, "https://example.com/foo/ba.jpg"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
648	        ("https://example.com/", 5, "http"),
649	        ("https://example.com/foo/bar", 15, "https://exampl"),
650	        ("https://example.com/foo/bar/baz.jpg", 30, "https://example.com/foo/ba.jpg"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
649	        ("https://example.com/foo/bar", 15, "https://exampl"),
650	        ("https://example.com/foo/bar/baz.jpg", 30, "https://example.com/foo/ba.jpg"),
651	        # Extensions longer than 4 characters are not treated specially:
652	        ("https://example.com/foo/bar/baz.jpeg2", 30, "https://example.com/foo/bar/b"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
649	        ("https://example.com/foo/bar", 15, "https://exampl"),
650	        ("https://example.com/foo/bar/baz.jpg", 30, "https://example.com/foo/ba.jpg"),
651	        # Extensions longer than 4 characters are not treated specially:
652	        ("https://example.com/foo/bar/baz.jpeg2", 30, "https://example.com/foo/bar/b"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
651	        # Extensions longer than 4 characters are not treated specially:
652	        ("https://example.com/foo/bar/baz.jpeg2", 30, "https://example.com/foo/bar/b"),
653	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
651	        # Extensions longer than 4 characters are not treated specially:
652	        ("https://example.com/foo/bar/baz.jpeg2", 30, "https://example.com/foo/bar/b"),
653	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
653	        (
654	            "https://example.com/foo/bar/baz.jpeg2",
655	            None,
656	            "https://example.com/foo/bar/baz.jpeg2",
657	        ),
658	    ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/datasette-1.0a17/datasette-1.0a17/tests/test_utils.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
655	            None,
656	            "https://example.com/foo/bar/baz.jpeg2",
657	        ),
658	    ),
659	)
660	def test_truncate_url(url, length, expected):

--------------------------------------------------

Code scanned:
	Total lines of code: 26016
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 173.0
		High: 94.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 263.0
		High: 4.0
Files skipped (0):
