Run started:2025-04-12 10:53:37.780195

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/cmdline.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	
23	HELP = """
24	███████╗███████╗ █████╗ ██████╗ ██████╗ ███████╗██████╗
25	██╔════╝██╔════╝██╔══██╗██╔══██╗██╔══██╗██╔════╝██╔══██╗
26	█████╗  █████╗  ███████║██████╔╝██║  ██║█████╗  ██████╔╝
27	██╔══╝  ██╔══╝  ██╔══██║██╔═══╝ ██║  ██║██╔══╝  ██╔══██╗
28	██║     ███████╗██║  ██║██║     ██████╔╝███████╗██║  ██║
29	╚═╝     ╚══════╝╚═╝  ╚═╝╚═╝     ╚═════╝ ╚══════╝╚═╝  ╚═╝
30	
31	Version: {version}
32	Document: https://feapder.com
33	
34	Usage:
35	  feapder <command> [options] [args]
36	      
37	Available commands:
38	"""
39	
40	NEW_VERSION_TIP = """

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/cmdline.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	with open(join(dirname(dirname(__file__)), "VERSION"), "rb") as f:
47	    VERSION = f.read().decode("ascii").strip()
48	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/cmdline.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	    try:
66	        url = "https://pypi.org/simple/feapder/"
67	        resp = requests.get(url, timeout=3, verify=False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/cmdline.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	        url = "https://pypi.org/simple/feapder/"
67	        resp = requests.get(url, timeout=3, verify=False)
68	        html = resp.text

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/cmdline.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
82	                if os.name == "nt":
83	                    os.system("")
84	                print(tip)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/cmdline.py:83
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
82	                if os.name == "nt":
83	                    os.system("")
84	                print(tip)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_init.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
29	            text = "__all__ = %s" % dumps_json(__all__)
30	            file.write(text)

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_item.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
21	    file = file.replace("{DATE}", tools.get_current_date())
22	    file = file.replace("{USER}", os.getenv("FEAPDER_USER") or getpass.getuser())
23	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_item.py:22
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
21	    file = file.replace("{DATE}", tools.get_current_date())
22	    file = file.replace("{USER}", os.getenv("FEAPDER_USER") or getpass.getuser())
23	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_item.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
77	        with open(template_path, "r", encoding="utf-8") as file:
78	            item_template = file.read()
79	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_item.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
149	        with open(item_file, "w", encoding="utf-8") as file:
150	            file.write(item_template)
151	            print("\n%s 生成成功" % item_file)

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_project.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
19	    file = file.replace("{DATE}", tools.get_current_date())
20	    file = file.replace("{USER}", os.getenv("FEAPDER_USER") or getpass.getuser())
21	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_project.py:20
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
19	    file = file.replace("{DATE}", tools.get_current_date())
20	    file = file.replace("{USER}", os.getenv("FEAPDER_USER") or getpass.getuser())
21	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_project.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	            ) as dst_file:
31	                content = src_file.read()
32	                content = deal_file_info(content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_project.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
32	                content = deal_file_info(content)
33	                dst_file.write(content)
34	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_spider.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
20	    file = file.replace("{DATE}", tools.get_current_date())
21	    file = file.replace("{USER}", os.getenv("FEAPDER_USER") or getpass.getuser())
22	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_spider.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
20	    file = file.replace("{DATE}", tools.get_current_date())
21	    file = file.replace("{USER}", os.getenv("FEAPDER_USER") or getpass.getuser())
22	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_spider.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	        with open(template_path, "r", encoding="utf-8") as file:
67	            spider_template = file.read()
68	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/create/create_spider.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	        with open(file_name, "w", encoding="utf-8") as file:
85	            file.write(spider)
86	            print("\n%s 生成成功" % spider_name)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/shell.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
191	        "--url",
192	        help="请求指定地址, 如 feapder shell --url http://www.spidertools.cn/",
193	        metavar="",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/commands/zip.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
41	                print(f"  adding {filepath}")
42	                file.write(filepath)
43	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/core/scheduler.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	        if "auto_stop_when_spider_done" in kwargs:
99	            self._keep_alive = not kwargs.get("auto_stop_when_spider_done")
100	        else:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/core/scheduler.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
213	                        result.parser_name = result.parser_name or parser.name
214	                        self._request_buffer.put_request(result)
215	                        result_type = 1

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/core/scheduler.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
222	                        if result_type == 1:
223	                            self._request_buffer.put_request(result)
224	                        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/core/scheduler.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
480	        # 计算抓取时长
481	        data = self._redisdb.hget(
482	            self._tab_spider_status, SPIDER_START_TIME_KEY, is_pop=True
483	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/core/scheduler.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
514	
515	        last_spider_end_time = self._redisdb.hget(
516	            self._tab_spider_status, SPIDER_END_TIME_KEY
517	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/core/scheduler.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
562	    def have_alive_spider(self, heartbeat_interval=10):
563	        heartbeat_time = self._redisdb.hget(self._tab_spider_status, HEARTBEAT_TIME_KEY)
564	        if heartbeat_time:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/core/spiders/batch_spider.py:1013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1012	                        if not self._keep_alive:
1013	                            self._stop_all_thread()
1014	                            break

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/core/spiders/batch_spider.py:1207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1206	                if self.all_thread_is_done():
1207	                    self._stop_all_thread()
1208	                    break

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/core/spiders/task_spider.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
530	                        if not self._keep_alive:
531	                            self._stop_all_thread()
532	                            break

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/core/spiders/task_spider.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
724	                if self.all_thread_is_done():
725	                    self._stop_all_thread()
726	                    break

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/dedup/bitarray.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	            raise Exception(
51	                '需要安装feapder完整版\ncommand: pip install "feapder[all]"\n若安装出错，参考：https://feapder.com/#/question/%E5%AE%89%E8%A3%85%E9%97%AE%E9%A2%98'
52	            )
53	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/downloader/_requests.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
19	    def download(self, request) -> Response:
20	        response = requests.request(
21	            request.method, request.url, **request.requests_kwargs
22	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/downloader/_requests.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
41	    def download(self, request) -> Response:
42	        response = self._session.request(
43	            request.method, request.url, **request.requests_kwargs
44	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool/proxy_pool.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	    def pull_proxies(self):
35	        resp = requests.get(self.proxy_api)
36	        proxies = resp.text.strip()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	    proxies = {
33	        "http": "http://{}".format(proxy_id),
34	        "https": "http://{}".format(proxy_id),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	        "http": "http://{}".format(proxy_id),
34	        "https": "http://{}".format(proxy_id),
35	    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	    """
45	    proxy_source_url = kwargs.get("proxy_source_url", [])
46	    if not isinstance(proxy_source_url, list):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	    abs_filename = os.path.join(proxy_path, filename)
76	    update_interval = kwargs.get("local_proxy_file_cache_timeout", 60)
77	    update_flag = 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	    if update_flag:
88	        response = requests.get(proxy_source_url, timeout=20)
89	        with open(os.path.join(proxy_path, filename), "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	        with open(os.path.join(proxy_path, filename), "w") as f:
90	            f.write(response.text)
91	    return get_proxy_from_file(filename)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	            proxies = {
129	                "https": "http://%s:%s" % (ip, port),
130	                "http": "http://%s:%s" % (ip, port),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	                "https": "http://%s:%s" % (ip, port),
130	                "http": "http://%s:%s" % (ip, port),
131	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
150	    redis_conn = redis.StrictRedis.from_url(proxy_source_url)
151	    key = kwargs.get("redis_proxies_key")
152	    assert key, "从redis中获取代理 需要指定 redis_proxies_key"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	        proxies_list.append(
158	            {"https": "http://%s" % proxy, "http": "http://%s" % proxy}
159	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	        proxies_list.append(
158	            {"https": "http://%s" % proxy, "http": "http://%s" % proxy}
159	        )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:187
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
186	        # socket检测成功 不代表代理一定可用 Connection closed by foreign host. 这种情况就不行
187	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sk:
188	            sk.settimeout(timeout)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
187	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sk:
188	            sk.settimeout(timeout)
189	            try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
190	                # 必须检测 否则代理永远不刷新
191	                sk.connect((ip, int(port)))
192	                ok = 1

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
195	                    logger.debug("check proxy failed: {} {}:{}".format(e, ip, port))
196	            sk.close()
197	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
199	            proxies = {
200	                "http": "http://{}:{}".format(ip, port),
201	                "https": "http://{}:{}".format(ip, port),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	                "http": "http://{}:{}".format(ip, port),
201	                "https": "http://{}:{}".format(ip, port),
202	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	        try:
204	            r = requests.get(
205	                "http://www.baidu.com", proxies=proxies, timeout=timeout, stream=True
206	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
204	            r = requests.get(
205	                "http://www.baidu.com", proxies=proxies, timeout=timeout, stream=True
206	            )
207	            ok = 1

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
207	            ok = 1
208	            r.close()
209	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
340	            return {}
341	        _url = proxies.get(protocol[0])
342	        if not _url.startswith("http"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
391	        # 队列最大长度
392	        self.max_queue_size = kwargs.get("size", -1)
393	        # 实际代理数量

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
396	        # 代理获取地址 http://localhost/proxy.txt
397	        self.proxy_source_url = kwargs.get("proxy_source_url", [])
398	        if not isinstance(self.proxy_source_url, list):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
403	        # 处理日志
404	        self.logger = kwargs.get("logger") or log
405	        kwargs["logger"] = self.logger

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
409	        # 代理池重置间隔
410	        self.reset_interval = kwargs.get("reset_interval", 5)
411	        # 强制重置一下代理 添加新的代理进来 防止一直使用旧的被封的代理

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
411	        # 强制重置一下代理 添加新的代理进来 防止一直使用旧的被封的代理
412	        self.reset_interval_max = kwargs.get("reset_interval_max", 180)
413	        # 是否监测代理有效性

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
413	        # 是否监测代理有效性
414	        self.check_valid = kwargs.get("check_valid", True)
415	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
538	                self.logger.exception(e)
539	        return self.get(retry)
540	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
584	                    if not proxy_item.update_ts:
585	                        proxy_item.update_ts = self.proxy_item_update_ts_dict.get(
586	                            proxy_item.proxy_id, 0
587	                        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
690	        if proxy_id:
691	            return self.proxy_dict.get(proxy_id)
692	        if proxies:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/proxy_pool_old.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
693	            proxy_id = ProxyItem(proxies).proxy_id
694	            return self.proxy_dict.get(proxy_id)
695	        return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
272	                key in self.__class__._DEFAULT_KEY_VALUE_
273	                and self.__class__._DEFAULT_KEY_VALUE_.get(key) == value
274	                or key in self.__class__._CUSTOM_PROPERTIES_

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
318	        # 设置请求方法
319	        method = self.__dict__.get("method")
320	        if not method:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
327	        # 设置user—agent
328	        headers = self.requests_kwargs.get("headers", {})
329	        if "user-agent" not in headers and "User-Agent" not in headers:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
331	                # 随机user—agent
332	                ua = self.__class__.user_agent_pool.get(setting.USER_AGENT_TYPE)
333	                headers.update({"User-Agent": ua})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
343	        # 代理
344	        proxies = self.requests_kwargs.get("proxies", -1)
345	        if proxies == -1 and setting.PROXY_ENABLE and setting.PROXY_EXTRACT_API:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
415	    def get_params(self):
416	        return self.requests_kwargs.get("params")
417	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
423	        """
424	        return self.requests_kwargs.get("proxies")
425	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
434	            return re.sub(
435	                "http.*?//", "", proxies.get("http", "") or proxies.get("https", "")
436	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
434	            return re.sub(
435	                "http.*?//", "", proxies.get("http", "") or proxies.get("https", "")
436	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
444	    def get_headers(self) -> dict:
445	        return self.requests_kwargs.get("headers", {})
446	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
447	    def get_user_agent(self) -> str:
448	        return self.get_headers().get("user_agent") or self.get_headers().get(
449	            "User-Agent"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
447	    def get_user_agent(self) -> str:
448	        return self.get_headers().get("user_agent") or self.get_headers().get(
449	            "User-Agent"
450	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
452	    def get_cookies(self) -> dict:
453	        cookies = self.requests_kwargs.get("cookies")
454	        if cookies and isinstance(cookies, RequestsCookieJar):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
457	        if not cookies:
458	            cookie_str = self.get_headers().get("Cookie") or self.get_headers().get(
459	                "cookie"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
457	        if not cookies:
458	            cookie_str = self.get_headers().get("Cookie") or self.get_headers().get(
459	                "cookie"
460	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
470	        """
471	        url = self.__dict__.get("url", "")
472	        # url 归一化

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
476	        for arg in ["params", "data", "files", "auth", "cert", "json"]:
477	            if self.requests_kwargs.get(arg):
478	                args.append(self.requests_kwargs.get(arg))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
477	            if self.requests_kwargs.get(arg):
478	                args.append(self.requests_kwargs.get(arg))
479	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/request.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
521	        """
522	        response_dict = self._cache_db.strget(self._cached_redis_key)
523	        if not response_dict:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/response.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149	        """
150	        content_type = self.headers.get("Content-Type") or self.headers.get(
151	            "content-type"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/response.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149	        """
150	        content_type = self.headers.get("Content-Type") or self.headers.get(
151	            "content-type"
152	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/response.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
313	    def is_html(self):
314	        content_type = self.headers.get("Content-Type", "")
315	        if "text/html" in content_type:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/response.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	    def extract(self):
331	        return self.selector.get()
332	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/response.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
390	        fd, fname = tempfile.mkstemp(".html")
391	        os.write(fd, body)
392	        os.close(fd)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/network/response.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
390	        fd, fname = tempfile.mkstemp(".html")
391	        os.write(fd, body)
392	        os.close(fd)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/email_sender.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	        if filepath:
81	            attach = MIMEText(open(filepath, "rb").read(), "base64", "utf-8")
82	            attach.add_header(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/metrics.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
20	# this thread should stop running in the forked process
21	_executor = concurrent.futures.ThreadPoolExecutor(
22	    max_workers=1, thread_name_prefix="metrics"
23	)

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/metrics.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
58	        self.lock = threading.Lock()
59	        self.hostname = socket.gethostname()
60	        self.last_emit_ts = time.time()  # 上次提交时间

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/metrics.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
58	        self.lock = threading.Lock()
59	        self.hostname = socket.gethostname()
60	        self.last_emit_ts = time.time()  # 上次提交时间

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/metrics.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
207	        try:
208	            self.influxdb.close()
209	        except Exception as e:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/metrics.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
555	        return
556	    _emitter.close()
557	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
244	        def new_method(*args, **kwargs):
245	            signal.signal(signal.SIGALRM, handle)  # 设置信号和回调函数
246	            signal.alarm(timeout)  # 设置 timeout 秒的闹钟

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:245
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
244	        def new_method(*args, **kwargs):
245	            signal.signal(signal.SIGALRM, handle)  # 设置信号和回调函数
246	            signal.alarm(timeout)  # 设置 timeout 秒的闹钟

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
266	        if data:
267	            r = requests.post(
268	                url, headers=headers, timeout=TIME_OUT, data=data, proxies=proxies
269	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
270	        else:
271	            r = requests.get(url, headers=headers, timeout=TIME_OUT, proxies=proxies)
272	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
279	    finally:
280	        r and r.close()
281	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
301	        if data:
302	            response = requests.post(
303	                url,
304	                headers=headers,
305	                data=data,
306	                params=params,
307	                timeout=TIME_OUT,
308	                proxies=proxies,
309	                cookies=cookies,
310	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
311	        else:
312	            response = requests.get(
313	                url,
314	                headers=headers,
315	                params=params,
316	                timeout=TIME_OUT,
317	                proxies=proxies,
318	                cookies=cookies,
319	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
324	    finally:
325	        response and response.close()
326	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
394	    for cookie in cookies:
395	        if cookie.get("name"):
396	            cookie_dict[cookie["name"]] = cookie["value"]

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:786
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
785	    try:
786	        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
787	        s.connect(("8.8.8.8", 80))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
786	        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
787	        s.connect(("8.8.8.8", 80))
788	        ip = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
786	        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
787	        s.connect(("8.8.8.8", 80))
788	        ip = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
792	        if s:
793	            s.close()
794	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
820	        try:
821	            response = requests.get(
822	                check_url, headers=headers, proxies=proxies, stream=True, timeout=20
823	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
830	            if response:
831	                response.close()
832	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:835
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
834	        ip, port = proxy.split(":")
835	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sk:
836	            sk.settimeout(7)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
835	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sk:
836	            sk.settimeout(7)
837	            try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:838
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
837	            try:
838	                sk.connect((ip, int(port)))  # 检查代理服务器是否开着
839	                is_valid = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:1107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1106	        cp.read_file(f)
1107	    return cp.get(section, key)
1108	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:1168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1167	        with open(filename, "r", encoding=encoding) as file:
1168	            content = file.readlines() if readlines else file.read()
1169	    except Exception as e:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:1168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1167	        with open(filename, "r", encoding=encoding) as file:
1168	            content = file.readlines() if readlines else file.read()
1169	    except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:1214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1213	    try:
1214	        content_type = request.urlopen(url).info().get("Content-Type", "")
1215	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:1214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1213	    try:
1214	        content_type = request.urlopen(url).info().get("Content-Type", "")
1215	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:1264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1263	        # print ('进度条 %.2f%%' % percent, end = '\r')
1264	        sys.stdout.write("进度条 %.2f%%" % percent + "\r")
1265	        sys.stdout.flush()

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:1277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
1276	
1277	            request.urlretrieve(url, file_path, progress_callfunc, data)
1278	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:1935
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1934	        return data
1935	    return base64.b64encode(str(data).encode()).decode("utf8")
1936	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:1935
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1934	        return data
1935	    return base64.b64encode(str(data).encode()).decode("utf8")
1936	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2203	        for key in keys:
2204	            current_data = data.get(key)
2205	            current_data = format_sql_value(current_data)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2448	    try:
2449	        if get_redisdb().strget(key):
2450	            return True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2460	
2461	        if time.time() - freq_limit_record.get(key) < rate_limit:
2462	            return True

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
2504	        ).digest()
2505	        sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))
2506	        url = f"{url}&timestamp={timestamp}&sign={sign}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2505
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
2504	        ).digest()
2505	        sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))
2506	        url = f"{url}&timestamp={timestamp}&sign={sign}"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2533	    try:
2534	        response = requests.post(
2535	            url, headers=headers, data=json.dumps(data).encode("utf8")
2536	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2537	        result = response.json()
2538	        response.close()
2539	        if result.get("errcode") == 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2538	        response.close()
2539	        if result.get("errcode") == 0:
2540	            return True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2541	        else:
2542	            raise Exception(result.get("errmsg"))
2543	    except Exception as e:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
2579	    ) as email:
2580	        return email.send(receivers=email_receiver, title=title, content=message)
2581	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
2579	    ) as email:
2580	        return email.send(receivers=email_receiver, title=title, content=message)
2581	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2604	
2605	    url = "http://www.linkedsee.com/alarm/zabbix"
2606	
2607	    data = {"content": message}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2607	    data = {"content": message}
2608	    response = requests.post(url, data=json.dumps(data), headers=headers)
2609	    return response

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2648	    try:
2649	        response = requests.post(
2650	            url, headers=headers, data=json.dumps(data).encode("utf8")
2651	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2652	        result = response.json()
2653	        response.close()
2654	        if result.get("errcode") == 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2653	        response.close()
2654	        if result.get("errcode") == 0:
2655	            return True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2656	        else:
2657	            raise Exception(result.get("errmsg"))
2658	    except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2695	        at = " ".join(
2696	            [f'<at user_id="{u.get("open_id")}">{u.get("name")}</at>' for u in user]
2697	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2695	        at = " ".join(
2696	            [f'<at user_id="{u.get("open_id")}">{u.get("name")}</at>' for u in user]
2697	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2702	    try:
2703	        response = requests.post(
2704	            url, headers=headers, data=json.dumps(data).encode("utf8")
2705	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2706	        result = response.json()
2707	        response.close()
2708	        if result.get("StatusCode") == 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2707	        response.close()
2708	        if result.get("StatusCode") == 0:
2709	            return True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/tools.py:2711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2710	        else:
2711	            raise Exception(result.get("msg"))
2712	    except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/webdriver/selenium_driver.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
275	            ) as f:
276	                js = f.read()
277	                driver.execute_cdp_cmd(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/webdriver/selenium_driver.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
285	            ) as f:
286	                js = f.read()
287	            driver.execute_cdp_cmd(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/webdriver/selenium_driver.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
379	            ) as f:
380	                js = f.read()
381	                driver.execute_cdp_cmd(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/feapder/utils/webdriver/selenium_driver.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
389	            ) as f:
390	                js = f.read()
391	            driver.execute_cdp_cmd(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	with open(join(dirname(__file__), "feapder/VERSION"), "rb") as fh:
20	    version = fh.read().decode("ascii").strip()
21	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/setup.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	with open("README.md", "r", encoding="utf8") as fh:
23	    long_description = fh.read()
24	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/setup.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	    entry_points={"console_scripts": ["feapder = feapder.commands.cmdline:execute"]},
79	    url="https://github.com/Boris-code/feapder.git",
80	    packages=packages,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/air-spider/test_air_spider.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	            print(i)
29	            yield feapder.Request("https://www.baidu.com")
30	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/air-spider/test_air_spider_filter.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        for i in range(200):
28	            yield feapder.Request("https://www.baidu.com")
29	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/air-spider/test_air_spider_item.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    def start_requests(self):
28	        yield feapder.Request("https://www.baidu.com")
29	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/air-spider/test_render_spider.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    def start_requests(self, *args, **kws):
16	        yield feapder.Request("https://www.baidu.com", render=True)
17	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/jd_spider.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	        task_id, item_id = task
29	        url = "https://item.jd.com/{}.html".format(item_id)
30	        yield feapder.Request(url, task_id=task_id)  # 携带task_id字段

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/mongo_spider.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    def start_requests(self):
25	        yield feapder.Request("https://www.baidu.com")
26	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/spider-integration/spiders/sina_news_parser.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        """
18	        yield feapder.Request("https://news.sina.com.cn/")
19	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/spider-integration/spiders/tencent_news_parser.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    def start_requests(self):
18	        yield feapder.Request("https://news.qq.com/")
19	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/spider/spiders/test_spider.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        for i in range(1):
17	            yield feapder.Request(f"https://www.baidu.com#{i}", callback=self.parse)
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/spider/spiders/test_spider2.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        for i in range(100):
17	            yield feapder.Request("https://www.baidu.com#{}".format(i))
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/task-spider/test_task_spider.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        # 加种子任务 框架会调用这个函数，方便往redis里塞任务，但不能写成死循环。实际业务中可以自己写个脚本往redis里塞任务
17	        self._redisdb.zadd(self._task_table, {"id": 1, "url": "https://www.baidu.com"})
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test-debugger/main.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    test_debugger.TestDebugger.to_DebugSpider(
17	        request=feapder.Request("https://spidertools.cn", render=True),
18	        redis_key="test:xxx",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test-debugger/spiders/test_debugger.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    def start_requests(self):
15	        yield feapder.Request("https://spidertools.cn", render=True)
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test-debugger/spiders/test_debugger.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    TestDebugger.to_DebugSpider(
27	        request=feapder.Request("https://spidertools.cn", render=True), redis_key="test:xxx"
28	    ).start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	
23	request = Request("https://www.baidu.com", data=b"fdsfbjdkafdskfdsfhdf234312321321dsfadsfadf")
24	a = request.to_dict

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_download_midware.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        yield feapder.Request(
22	            "https://www.baidu.com", download_midware=download_midware
23	        )
24	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_download_midware.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	        yield feapder.Request(
32	            "https://www.baidu.com", download_midware=[download_midware, self.download_midware]
33	        )
34	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_playwright.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    def start_requests(self):
25	        yield feapder.Request("https://www.baidu.com", render=True)
26	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_playwright2.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        yield feapder.Request(
50	            "http://www.soutushenqi.com/image/search/?searchWord=%E6%A0%91%E5%8F%B6",
51	            render=True,
52	        )
53	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_rander.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	        for i in range(10):
7	            yield feapder.Request("https://baidu.com/#{}".format(i), render=True)
8	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_rander2.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        for i in range(10):
11	            yield feapder.Request("https://news.qq.com/#{}".format(i), render=True)
12	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_rander3.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	    def start_requests(self):
9	        yield feapder.Request("http://www.baidu.com", render=True)
10	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_rander_xhr.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    def start_requests(self):
28	        yield feapder.Request("http://www.spidertools.cn", render=True)
29	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_request.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	def test_selector():
15	    request = Request("https://www.baidu.com?a=1&b=2", data={}, params=None)
16	    response = request.get_response()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_request.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	
39	    resp = Response.from_text(text=text, url="http://feapder.com/#/README")
40	    print(resp.text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_request.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	def test_to_dict():
45	    request = Request("https://www.baidu.com?a=1&b=2", data={"a":1}, params="k=1", callback="test", task_id=1, cookies={"a":1})
46	    print(request.to_dict)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_spider_params.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    def start_requests(self):
20	        yield feapder.Request(f"https://www.baidu.com")
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_task.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	task_key = ["id", "url"]
15	task = [1, "http://www.badu.com"]
16	task = PerfectDict(_dict=dict(zip(task_key, task)), _values=task)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_task.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	task = PerfectDict(id=1, url="http://www.badu.com")
19	task = PerfectDict({"id":"1", "url":"http://www.badu.com"})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_task.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	task = PerfectDict(id=1, url="http://www.badu.com")
19	task = PerfectDict({"id":"1", "url":"http://www.badu.com"})
20	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_webdriver.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	            browser = webdriver_pool.get()
23	            browser.get("https://baidu.com")
24	            print(browser.title)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/test_webdriver.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    ) as browser:
37	        browser.get("https://httpbin.org/get")
38	        html = browser.page_source

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/feapder-1.9.2/feapder-1.9.2/tests/user_pool/test_guest_user_pool.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        self.user_pool = GuestUserPool(
23	            "test:user_pool", page_url="https://www.baidu.com"
24	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 17263
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 60.0
		High: 127.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 176.0
		High: 11.0
Files skipped (0):
