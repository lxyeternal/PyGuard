Run started:2025-04-12 17:25:29.926261

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    author_email='brandon@rhodesmill.org',
13	    url='http://github.com/brandon-rhodes/python-skyfield/',
14	    classifiers=[

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/constellationlib.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
86	    data = get_data('skyfield', 'data/constellations.gz')
87	    data = zlib.decompress(data, zlib.MAX_WBITS+32).decode('ascii')
88	    return [line.split(' ', 1) for line in data.splitlines()]

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/constellationlib.py:87
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
86	    data = get_data('skyfield', 'data/constellations.gz')
87	    data = zlib.decompress(data, zlib.MAX_WBITS+32).decode('ascii')
88	    return [line.split(' ', 1) for line in data.splitlines()]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/data/earth_orientation.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    import pandas as pd
12	    f = load.open('http://eclipse.gsfc.nasa.gov/SEcat5/deltat.html')
13	    tables = pd.read_html(f.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/data/earth_orientation.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
12	    f = load.open('http://eclipse.gsfc.nasa.gov/SEcat5/deltat.html')
13	    tables = pd.read_html(f.read())
14	    df = tables[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/data/earth_orientation.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	    # http://astro.ukho.gov.uk/nao/lvm/Table-S15.2020.txt
27	    content = f.read()
28	    banner = b'- ' * 36 + b'-\n'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/data/hipparcos.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	
14	URL = 'https://cdsarc.cds.unistra.fr/ftp/cats/I/239/hip_main.dat'
15	
16	# But what if someone runs `gzip` on the file again?  Then the new URL
17	# will break like the old one did.  It appears that VizieR makes no
18	# guarantee that raw catalog URLs are stable, and that we need to switch
19	# to one of their catalog generation URLs, which produce text in a new
20	# format that Skyfield will have to learn.  Discussion at:
21	# https://github.com/skyfielders/python-skyfield/issues/454
22	
23	url = URL  # old name, in case anyone used it

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/data/mpc.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	MPCORB_URL = 'https://www.minorplanetcenter.net/iau/MPCORB/MPCORB.DAT.gz'
14	
15	_MPCORB_COLUMNS = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/data/mpc.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	
112	COMET_URL = 'https://www.minorplanetcenter.net/iau/MPCORB/CometEls.txt'
113	
114	_COMET_COLUMNS = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/data/tycho2.py:1
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	URL = 'https://cdsarc.u-strasbg.fr/ftp/cats/I/239/tyc_main.dat'
2	
3	PANDAS_MESSAGE = """Skyfield needs Pandas to load the Tycho2 catalog
4	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
47	try:
48	    urlopen('', cafile=None)
49	except TypeError:

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
47	try:
48	    urlopen('', cafile=None)
49	except TypeError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	
62	_IERS = 'https://hpiers.obspm.fr/iers/bul/bulc/'
63	_IERS2 = 'https://datacenter.iers.org/products/eop/rapid/standard/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	_IERS = 'https://hpiers.obspm.fr/iers/bul/bulc/'
63	_IERS2 = 'https://datacenter.iers.org/products/eop/rapid/standard/'
64	_JPL = 'https://ssd.jpl.nasa.gov/ftp/eph/planets/bsp/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	_IERS2 = 'https://datacenter.iers.org/products/eop/rapid/standard/'
64	_JPL = 'https://ssd.jpl.nasa.gov/ftp/eph/planets/bsp/'
65	_NAIF_KERNELS = 'https://naif.jpl.nasa.gov/pub/naif/generic_kernels/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	_JPL = 'https://ssd.jpl.nasa.gov/ftp/eph/planets/bsp/'
65	_NAIF_KERNELS = 'https://naif.jpl.nasa.gov/pub/naif/generic_kernels/'
66	_NAIF = 'https://naif.jpl.nasa.gov/pub/naif/generic_kernels/spk/satellites/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	_NAIF_KERNELS = 'https://naif.jpl.nasa.gov/pub/naif/generic_kernels/'
66	_NAIF = 'https://naif.jpl.nasa.gov/pub/naif/generic_kernels/spk/satellites/'
67	
68	def _open_binary(path):

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
485	            ssl_context = create_default_context(cafile=certifi.where())
486	            connection = urlopen(url, context=ssl_context)
487	        elif _supports_cafile_argument:

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:486
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
485	            ssl_context = create_default_context(cafile=certifi.where())
486	            connection = urlopen(url, context=ssl_context)
487	        elif _supports_cafile_argument:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
487	        elif _supports_cafile_argument:
488	            connection = urlopen(url, cafile=certifi.where())
489	        else:

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:488
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
487	        elif _supports_cafile_argument:
488	            connection = urlopen(url, cafile=certifi.where())
489	        else:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
489	        else:
490	            connection = urlopen(url)  # Very old Python: no certificate check.
491	    except Exception as e:

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:490
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
489	        else:
490	            connection = urlopen(url)  # Very old Python: no certificate check.
491	    except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
529	            while True:
530	                data = connection.read(blocksize)
531	                if not data:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
529	            while True:
530	                data = connection.read(blocksize)
531	                if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/iokit.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
532	                    break
533	                w.write(data)
534	                length += len(data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/planetarylib.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	        try:
62	            if not file.read(7).startswith(_TEXT_MAGIC_NUMBERS):
63	                raise ValueError('file must start with one of the patterns:'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/planetarylib.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	        file.seek(0)
77	        if file.read(7) != b'DAF/PCK':
78	            raise ValueError('file must start with the bytes "DAF/PCK"')

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
30	    finally:
31	        shutil.rmtree(path)
32	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
34	    with open(load.path_to(path), 'wb') as f:
35	        f.write(content)
36	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
34	    with open(load.path_to(path), 'wb') as f:
35	        f.write(content)
36	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
38	    with open(load.path_to(path), 'rb') as f:
39	        return f.read()
40	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	def test_build_url(load):
50	    url = 'https://ssd.jpl.nasa.gov/ftp/eph/planets/bsp/de421.bsp'
51	    assert load.build_url('de421.bsp') == url

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	    with open(os.path.join(load.directory, 'file.tle'), 'wb') as f:
57	        f.write(b'example text\n')
58	    data = load.open('file.tle').read()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
56	    with open(os.path.join(load.directory, 'file.tle'), 'wb') as f:
57	        f.write(b'example text\n')
58	    data = load.open('file.tle').read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	        f.write(b'example text\n')
58	    data = load.open('file.tle').read()
59	    assert data == b'example text\n'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
63	    with open(os.path.join(load.directory, 'folder', 'file.tle'), 'wb') as f:
64	        f.write(b'example text\n')
65	    data = load.open('folder/file.tle').read()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
63	    with open(os.path.join(load.directory, 'folder', 'file.tle'), 'wb') as f:
64	        f.write(b'example text\n')
65	    data = load.open('folder/file.tle').read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
64	        f.write(b'example text\n')
65	    data = load.open('folder/file.tle').read()
66	    assert data == b'example text\n'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	    c2 = FakeConnection()
135	    t1 = Thread(target=load, args=('Leap_Second.dat',))
136	    t2 = Thread(target=load, args=('Leap_Second.dat',))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
135	    t1 = Thread(target=load, args=('Leap_Second.dat',))
136	    t2 = Thread(target=load, args=('Leap_Second.dat',))
137	    t1.daemon = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/skyfield-1.53/skyfield-1.53/skyfield/tests/test_io_parsing.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
117	    g = gzip.GzipFile(mode='wb', fileobj=b)
118	    g.write(sample_hipparcos_line)
119	    g.close()

--------------------------------------------------

Code scanned:
	Total lines of code: 14135
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 25.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 5.0
Files skipped (0):
