Run started:2025-04-12 18:08:37.121749

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/archs/inception.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	# http://download.tensorflow.org/models/image/imagenet/inception-2015-12-05.tgz
13	FID_WEIGHTS_URL = 'https://github.com/mseitzer/pytorch-fid/releases/download/fid_weights/pt_inception-2015-12-05-6726825d.pth'  # noqa: E501
14	LOCAL_FID_WEIGHTS = 'experiments/pretrained_models/pt_inception-2015-12-05-6726825d.pth'  # noqa: E501

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/data/data_util.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	        img_paths = sorted(list(scandir(path, full_path=True)))
29	    imgs = [cv2.imread(v).astype(np.float32) / 255. for v in img_paths]
30	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/models/hifacegan_model.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
265	
266	                imwrite(tensor2img(visuals['result']), save_img_path)
267	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/models/sr_model.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
182	                                                 f'{img_name}_{self.opt["name"]}.png')
183	                imwrite(sr_img, save_img_path)
184	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/models/stylegan2_model.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
272	            save_img_path = osp.join(self.opt['path']['visualization'], 'test', f'test_{self.opt["name"]}.png')
273	        imwrite(result, save_img_path)
274	        # add sample images to tb_logger

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/models/video_base_model.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	                                                 f'{img_name}_{self.opt["name"]}.png')
85	                imwrite(result_img, save_img_path)
86	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/models/video_recurrent_model.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	                            # image name only for REDS dataset
149	                        imwrite(result_img, img_path)
150	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/download_util.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    session = requests.Session()
23	    URL = 'https://docs.google.com/uc?export=download'
24	    params = {'id': file_id}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/download_util.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
25	
26	    response = session.get(URL, params=params, stream=True)
27	    token = get_confirm_token(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/download_util.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	        params['confirm'] = token
30	        response = session.get(URL, params=params, stream=True)
31	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/download_util.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	    # get file size
33	    response_file_size = session.get(URL, params=params, stream=True, headers={'Range': 'bytes=0-2'})
34	    if 'Content-Range' in response_file_size.headers:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/download_util.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
64	            if chunk:  # filter out keep-alive new chunks
65	                f.write(chunk)
66	        if pbar is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/flow_util.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	        assert concat_axis in [0, 1]
22	        cat_flow = cv2.imread(flow_path, cv2.IMREAD_UNCHANGED)
23	        if cat_flow.ndim != 2:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/flow_util.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	            try:
31	                header = f.read(4).decode('utf-8')
32	            except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/flow_util.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
62	        with open(filename, 'wb') as f:
63	            f.write('PIEH'.encode('utf-8'))
64	            np.array([flow.shape[1], flow.shape[0]], dtype=np.int32).tofile(f)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/flow_util.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	        os.makedirs(os.path.dirname(filename), exist_ok=True)
73	        cv2.imwrite(filename, dxdy)
74	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/img_util.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
150	        os.makedirs(dir_name, exist_ok=True)
151	    ok = cv2.imwrite(file_path, img, params)
152	    if not ok:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/lmdb_util.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
83	
84	        pool = Pool(n_thread)
85	        for path, key in zip(img_path_list, keys):

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/lmdb_util.py:84
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
83	
84	        pool = Pool(n_thread)
85	        for path, key in zip(img_path_list, keys):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/lmdb_util.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
94	        # obtain data size for one image
95	        img = cv2.imread(osp.join(data_path, img_path_list[0]), cv2.IMREAD_UNCHANGED)
96	        _, img_byte = cv2.imencode('.png', img, [cv2.IMWRITE_PNG_COMPRESSION, compress_level])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/lmdb_util.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	        # write meta information
121	        txt_file.write(f'{key}.png ({h},{w},{c}) {compress_level}\n')
122	        if idx % batch == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/lmdb_util.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	
146	    img = cv2.imread(path, cv2.IMREAD_UNCHANGED)
147	    if img.ndim == 2:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/lmdb_util.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
187	        h, w, c = img_shape
188	        self.txt_file.write(f'{key}.png ({h},{w},{c}) {self.compress_level}\n')
189	        if self.counter % self.batch == 0:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/basicsr/utils/options.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
127	            # using exec function
128	            exec(eval_str)
129	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	    with open('README.md', encoding='utf-8') as f:
14	        content = f.read()
15	    return content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/setup.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	    with open('VERSION', 'r') as f:
68	        SHORT_VERSION = f.read().strip()
69	    VERSION_INFO = ', '.join([x if x.isdigit() else f'"{x}"' for x in SHORT_VERSION.split('.')])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/setup.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	    with open(version_file, 'w') as f:
73	        f.write(version_file_str)
74	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/setup.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
77	    with open(version_file, 'r') as f:
78	        exec(compile(f.read(), version_file, 'exec'))
79	    return locals()['__version__']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/setup.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
77	    with open(version_file, 'r') as f:
78	        exec(compile(f.read(), version_file, 'exec'))
79	    return locals()['__version__']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/basicsr-1.4.2/basicsr-1.4.2/setup.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	        keywords='computer vision, restoration, super resolution',
156	        url='https://github.com/xinntao/BasicSR',
157	        include_package_data=True,

--------------------------------------------------

Code scanned:
	Total lines of code: 12849
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 24.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 3.0
Files skipped (0):
