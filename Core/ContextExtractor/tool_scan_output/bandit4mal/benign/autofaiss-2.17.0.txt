Run started:2025-04-12 11:34:13.612129

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/external/descriptions.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    index with just one cluster makes it possible to memory-map it.""",
31	    IndexBlock.IVF: """IVF (Inverted File Index):
32	    The vector space is divided into several groups that are represented by a cluster vector.
33	    The algorithm first looks for the closest cluster vectors by iterating over them one by one.
34	    Then, The IVF mapping is used to read the vectors in the selected groups. The algorithm reads
35	    each of them and select the k nearest neighbors.
36	    It is possible to memory-map this index on disk, it reduces the RAM footprint to the size of
37	    its cluster vectors, but the index is slower in that case.
38	    -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
39	    IndexBlock.IVF_HNSW: """IVF + HNSW (Inverted File Index + Hierarchical Navigable Small World index):
40	    The vector space is divided into several groups that are represented by a cluster vector. 
41	    The algorithm first looks for the closest cluster vectors using an HNSW index (instead of 
42	    iterating over them one by one in the version without HNSW). Then, The IVF mapping is used
43	    to read the vectors in the selected groups. The algorithm reads each of them and selects
44	    the k nearest neighbors.
45	    It is possible to memory-map this index on disk, it reduces the RAM footprint to the size of the
46	    hnsw index, but the index is slower in that case.
47	    -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
48	    IndexBlock.PQ: """PQ (Product Quantization):
49	    The vectors are compressed using product quantization.
50	    Some clever optimizations are implemented to compute distances in the compressed space.
51	    -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
52	    IndexBlock.OPQ: """OPQ (Optimized Product Quantization):
53	    The vectors are projected using a rotation matrix. The matrix is trained to minimize
54	    the average compression error.
55	    -> More info: http://kaiminghe.com/publications/pami13opq.pdf""",
56	    IndexBlock.HNSW: """HNSW (Hierarchical Navigable Small World):
57	    All the vectors are stored in a 2D array without compression, and
58	    a bidirectional graph is built on the top of the vectors to enable a fast search.
59	    This index can't be memory-mapped on disk.
60	    -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf""",
61	    IndexBlock.PAD: """PAD (Padding):
62	    Preprocessing operations where a padding with 0s is added to the end of the vectors.""",
63	}
64	
65	
66	TUNABLE_PARAMETERS_DESCRIPTION_BLOCKS = {
67	    TunableParam.NPROBE: """    - nprobe: The number of vector groups to explore, the search time is proportional
68	      to this value. If nprobe is high, the recall will also be high.
69	      -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/external/descriptions.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
39	    IndexBlock.IVF_HNSW: """IVF + HNSW (Inverted File Index + Hierarchical Navigable Small World index):
40	    The vector space is divided into several groups that are represented by a cluster vector. 
41	    The algorithm first looks for the closest cluster vectors using an HNSW index (instead of 
42	    iterating over them one by one in the version without HNSW). Then, The IVF mapping is used
43	    to read the vectors in the selected groups. The algorithm reads each of them and selects
44	    the k nearest neighbors.
45	    It is possible to memory-map this index on disk, it reduces the RAM footprint to the size of the
46	    hnsw index, but the index is slower in that case.
47	    -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
48	    IndexBlock.PQ: """PQ (Product Quantization):
49	    The vectors are compressed using product quantization.
50	    Some clever optimizations are implemented to compute distances in the compressed space.
51	    -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
52	    IndexBlock.OPQ: """OPQ (Optimized Product Quantization):
53	    The vectors are projected using a rotation matrix. The matrix is trained to minimize
54	    the average compression error.
55	    -> More info: http://kaiminghe.com/publications/pami13opq.pdf""",
56	    IndexBlock.HNSW: """HNSW (Hierarchical Navigable Small World):
57	    All the vectors are stored in a 2D array without compression, and
58	    a bidirectional graph is built on the top of the vectors to enable a fast search.
59	    This index can't be memory-mapped on disk.
60	    -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf""",
61	    IndexBlock.PAD: """PAD (Padding):
62	    Preprocessing operations where a padding with 0s is added to the end of the vectors.""",
63	}
64	
65	
66	TUNABLE_PARAMETERS_DESCRIPTION_BLOCKS = {
67	    TunableParam.NPROBE: """    - nprobe: The number of vector groups to explore, the search time is proportional
68	      to this value. If nprobe is high, the recall will also be high.
69	      -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
70	    TunableParam.EFSEARCH: """    - efsearch: The number of times a greedy search is done in the HNSW graph. The results
71	      of the different greedy searches are combined to get a more precise result.
72	      The search time is proportional to this value. If efsearch is high, the recall will be high.
73	      -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf       """,
74	    TunableParam.HT: """    - ht (Hamming threshold): A threshold value to approximate the vector distances using the hamming distance.
75	      Computing the Hamming distances between two vectors is much faster than computing the real distance,
76	      but it is also less precise. We found out that it was better to deactivate this parameter as it
77	      decreases the recall score over speed improvements (default value is 2048)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/external/descriptions.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	    -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
48	    IndexBlock.PQ: """PQ (Product Quantization):
49	    The vectors are compressed using product quantization.
50	    Some clever optimizations are implemented to compute distances in the compressed space.
51	    -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
52	    IndexBlock.OPQ: """OPQ (Optimized Product Quantization):
53	    The vectors are projected using a rotation matrix. The matrix is trained to minimize
54	    the average compression error.
55	    -> More info: http://kaiminghe.com/publications/pami13opq.pdf""",
56	    IndexBlock.HNSW: """HNSW (Hierarchical Navigable Small World):
57	    All the vectors are stored in a 2D array without compression, and
58	    a bidirectional graph is built on the top of the vectors to enable a fast search.
59	    This index can't be memory-mapped on disk.
60	    -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf""",
61	    IndexBlock.PAD: """PAD (Padding):
62	    Preprocessing operations where a padding with 0s is added to the end of the vectors.""",
63	}
64	
65	
66	TUNABLE_PARAMETERS_DESCRIPTION_BLOCKS = {
67	    TunableParam.NPROBE: """    - nprobe: The number of vector groups to explore, the search time is proportional
68	      to this value. If nprobe is high, the recall will also be high.
69	      -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
70	    TunableParam.EFSEARCH: """    - efsearch: The number of times a greedy search is done in the HNSW graph. The results
71	      of the different greedy searches are combined to get a more precise result.
72	      The search time is proportional to this value. If efsearch is high, the recall will be high.
73	      -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf       """,
74	    TunableParam.HT: """    - ht (Hamming threshold): A threshold value to approximate the vector distances using the hamming distance.
75	      Computing the Hamming distances between two vectors is much faster than computing the real distance,
76	      but it is also less precise. We found out that it was better to deactivate this parameter as it
77	      decreases the recall score over speed improvements (default value is 2048)
78	      -> More info: https://arxiv.org/pdf/1609.01882.pdf""",
79	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/external/descriptions.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
52	    IndexBlock.OPQ: """OPQ (Optimized Product Quantization):
53	    The vectors are projected using a rotation matrix. The matrix is trained to minimize
54	    the average compression error.
55	    -> More info: http://kaiminghe.com/publications/pami13opq.pdf""",
56	    IndexBlock.HNSW: """HNSW (Hierarchical Navigable Small World):
57	    All the vectors are stored in a 2D array without compression, and
58	    a bidirectional graph is built on the top of the vectors to enable a fast search.
59	    This index can't be memory-mapped on disk.
60	    -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf""",
61	    IndexBlock.PAD: """PAD (Padding):
62	    Preprocessing operations where a padding with 0s is added to the end of the vectors.""",
63	}
64	
65	
66	TUNABLE_PARAMETERS_DESCRIPTION_BLOCKS = {
67	    TunableParam.NPROBE: """    - nprobe: The number of vector groups to explore, the search time is proportional
68	      to this value. If nprobe is high, the recall will also be high.
69	      -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
70	    TunableParam.EFSEARCH: """    - efsearch: The number of times a greedy search is done in the HNSW graph. The results
71	      of the different greedy searches are combined to get a more precise result.
72	      The search time is proportional to this value. If efsearch is high, the recall will be high.
73	      -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf       """,
74	    TunableParam.HT: """    - ht (Hamming threshold): A threshold value to approximate the vector distances using the hamming distance.
75	      Computing the Hamming distances between two vectors is much faster than computing the real distance,
76	      but it is also less precise. We found out that it was better to deactivate this parameter as it
77	      decreases the recall score over speed improvements (default value is 2048)
78	      -> More info: https://arxiv.org/pdf/1609.01882.pdf""",
79	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/external/descriptions.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    -> More info: http://kaiminghe.com/publications/pami13opq.pdf""",
56	    IndexBlock.HNSW: """HNSW (Hierarchical Navigable Small World):
57	    All the vectors are stored in a 2D array without compression, and
58	    a bidirectional graph is built on the top of the vectors to enable a fast search.
59	    This index can't be memory-mapped on disk.
60	    -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf""",
61	    IndexBlock.PAD: """PAD (Padding):
62	    Preprocessing operations where a padding with 0s is added to the end of the vectors.""",
63	}
64	
65	
66	TUNABLE_PARAMETERS_DESCRIPTION_BLOCKS = {
67	    TunableParam.NPROBE: """    - nprobe: The number of vector groups to explore, the search time is proportional
68	      to this value. If nprobe is high, the recall will also be high.
69	      -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
70	    TunableParam.EFSEARCH: """    - efsearch: The number of times a greedy search is done in the HNSW graph. The results
71	      of the different greedy searches are combined to get a more precise result.
72	      The search time is proportional to this value. If efsearch is high, the recall will be high.
73	      -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf       """,
74	    TunableParam.HT: """    - ht (Hamming threshold): A threshold value to approximate the vector distances using the hamming distance.
75	      Computing the Hamming distances between two vectors is much faster than computing the real distance,
76	      but it is also less precise. We found out that it was better to deactivate this parameter as it
77	      decreases the recall score over speed improvements (default value is 2048)
78	      -> More info: https://arxiv.org/pdf/1609.01882.pdf""",
79	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/external/descriptions.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	TUNABLE_PARAMETERS_DESCRIPTION_BLOCKS = {
67	    TunableParam.NPROBE: """    - nprobe: The number of vector groups to explore, the search time is proportional
68	      to this value. If nprobe is high, the recall will also be high.
69	      -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
70	    TunableParam.EFSEARCH: """    - efsearch: The number of times a greedy search is done in the HNSW graph. The results
71	      of the different greedy searches are combined to get a more precise result.
72	      The search time is proportional to this value. If efsearch is high, the recall will be high.
73	      -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf       """,
74	    TunableParam.HT: """    - ht (Hamming threshold): A threshold value to approximate the vector distances using the hamming distance.
75	      Computing the Hamming distances between two vectors is much faster than computing the real distance,
76	      but it is also less precise. We found out that it was better to deactivate this parameter as it

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/external/descriptions.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	      -> More info: https://hal.inria.fr/inria-00514462/PDF/jegou_pq_postprint.pdf""",
70	    TunableParam.EFSEARCH: """    - efsearch: The number of times a greedy search is done in the HNSW graph. The results
71	      of the different greedy searches are combined to get a more precise result.
72	      The search time is proportional to this value. If efsearch is high, the recall will be high.
73	      -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf       """,
74	    TunableParam.HT: """    - ht (Hamming threshold): A threshold value to approximate the vector distances using the hamming distance.
75	      Computing the Hamming distances between two vectors is much faster than computing the real distance,
76	      but it is also less precise. We found out that it was better to deactivate this parameter as it
77	      decreases the recall score over speed improvements (default value is 2048)
78	      -> More info: https://arxiv.org/pdf/1609.01882.pdf""",
79	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/external/descriptions.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	      -> More info: https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf       """,
74	    TunableParam.HT: """    - ht (Hamming threshold): A threshold value to approximate the vector distances using the hamming distance.
75	      Computing the Hamming distances between two vectors is much faster than computing the real distance,
76	      but it is also less precise. We found out that it was better to deactivate this parameter as it
77	      decreases the recall score over speed improvements (default value is 2048)
78	      -> More info: https://arxiv.org/pdf/1609.01882.pdf""",
79	}

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/indices/distributed.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
158	    """
159	    fs = _get_file_system(small_indices_folder)
160	    small_indices_files = sorted(fs.ls(small_indices_folder, detail=False))

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/indices/distributed.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
221	    """Merge all the indices from src_folder into n indices, and return the folder for the next stage, as well as the metrics"""
222	    fs = _get_file_system(src_folder)
223	    nb_indices_on_src_folder = len(fs.ls(src_folder, detail=False))

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/indices/distributed.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
292	    temporary_indices_folder = make_path_absolute(temporary_indices_folder)
293	    fs = _get_file_system(temporary_indices_folder)
294	    if fs.exists(temporary_indices_folder):

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/indices/distributed.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
693	    n_threads = min(maximum_nb_threads, len(big_partitions) + int(len(small_partitions) > 0))
694	    with ThreadPool(n_threads) as p:
695	        small_index_metrics_future = (

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/indices/index_utils.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	    with NamedTemporaryFile(delete=False) as output_file:
121	        output_file.write(index_bytes)
122	        tmp_name = output_file.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/indices/index_utils.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
120	    with NamedTemporaryFile(delete=False) as output_file:
121	        output_file.write(index_bytes)
122	        tmp_name = output_file.name

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/indices/index_utils.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
136	    with open(tmp_name, "rb") as index_file:
137	        b = index_file.read()
138	        os.remove(tmp_name)

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/autofaiss/indices/index_utils.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
158	    src_dest_paths = zip(indices_file_paths, dst_paths)
159	    with ThreadPool(min(16, len(indices_file_paths))) as pool:
160	        for _ in pool.imap_unordered(partial(_download_one, fs=fs), src_dest_paths):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
12	    with Path("autofaiss/version.py").open(encoding="utf-8") as file:
13	        metadata = dict(re.findall(r'__([a-z]+)__\s*=\s*"([^"]+)"', file.read()))
14	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/setup.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
16	    with Path(Path(__file__).parent, "README.md").open(encoding="utf-8") as file:
17	        long_description = file.read()
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/autofaiss-2.17.0/autofaiss-2.17.0/setup.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	        packages=setuptools.find_packages(),
54	        url="https://github.com/criteo/autofaiss",
55	    )

--------------------------------------------------

Code scanned:
	Total lines of code: 3883
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 10.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 0.0
Files skipped (0):
