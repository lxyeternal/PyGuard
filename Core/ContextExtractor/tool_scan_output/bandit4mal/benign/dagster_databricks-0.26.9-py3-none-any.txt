Run started:2025-04-12 17:26:36.988803

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/_test_utils.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	        with open(script_file, "rb") as f:
75	            source = f.read().decode("utf-8")
76	    else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/_test_utils.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
78	    dbfs_client = files.DbfsAPI(client.api_client)
79	    contents = base64.b64encode(source.encode("utf-8")).decode("utf-8")
80	    if dbfs_path is None:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/_test_utils.py:79
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
78	    dbfs_client = files.DbfsAPI(client.api_client)
79	    contents = base64.b64encode(source.encode("utf-8")).decode("utf-8")
80	    if dbfs_path is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	        description=(
70	            "The key of the tag. The key length must be between 1 and 127 UTF-8 "
71	            "characters, inclusive. For a list of all restrictions, see AWS Tag Restrictions: "
72	            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html#tag-restrictions"
73	        ),
74	        is_required=True,
75	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        description=(
79	            "The value of the tag. The value length must be less than or equal to "
80	            "255 UTF-8 characters. For a list of all restrictions, see AWS Tag Restrictions: "
81	            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html#tag-restrictions"
82	        ),
83	        is_required=True,
84	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	        description=(
122	            "S3 endpoint, e.g. https://s3-us-west-2.amazonaws.com. "
123	            "Either region or endpoint must be set. If both are set, endpoint is used."
124	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	        description=(
150	            "(Optional) Set canned access control list, e.g. bucket-owner-full-control.If"
151	            " canned_acl is set, the cluster instance profile must have s3:PutObjectAcl permission"
152	            " on the destination bucket and prefix. The full list of possible canned ACLs can be"
153	            " found at"
154	            " https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html#canned-acl. By"
155	            " default only the object owner gets full control. If you are using cross account role"
156	            " for writing data, you may want to set bucket-owner-full-control to make bucket owner"
157	            " able to read the logs."
158	        ),
159	        is_required=False,
160	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
266	        description=(
267	            "Attributes related to clusters running on Amazon Web Services. "
268	            "If not specified at cluster creation, a set of default values is used. "
269	            "See aws_attributes at https://docs.databricks.com/dev-tools/api/latest/clusters.html."
270	        ),
271	        is_required=False,
272	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
459	        description=(
460	            "Autoscaling Local Storage: when enabled, this cluster dynamically acquires attitional"
461	            " disk space when its Spark workers are running low on disk space. This feature"
462	            " requires specific AWS permissions to function correctly - refer to"
463	            " https://docs.databricks.com/clusters/configure.html#autoscaling-local-storage for"
464	            " details."
465	        ),
466	        is_required=False,
467	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
565	        description=(
566	            "List of dependences to exclude. For example: "
567	            '["slf4j:slf4j", "*:hadoop-client"]. '
568	            "Maven dependency exclusions: "
569	            "https://maven.apache.org/guides/introduction/introduction-to-optional-and-excludes-dependencies.html."
570	        ),
571	        is_required=False,
572	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
621	        description=(
622	            "URI of the wheel or zipped wheels to be installed. DBFS and S3 URIs are "
623	            'supported. For example: { "whl": "dbfs:/my/whl" } or { "whl": "s3://my-bucket/whl" }.'
624	            "If S3 is used, make sure the cluster has read access on the library. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:1039
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1038	        description=(
1039	            "job permission spec; ref:"
1040	            " https://docs.databricks.com/security/access-control/jobs-acl.html#job-permissions"
1041	        ),
1042	        is_required=False,
1043	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:1054
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1053	        description=(
1054	            "cluster permission spec; ref:"
1055	            " https://docs.databricks.com/security/access-control/cluster-acl.html#cluster-level-permissions"
1056	        ),
1057	        is_required=False,
1058	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:1083
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1082	        description=(
1083	            "Oauth credentials for interacting with the Databricks REST API via a service"
1084	            " principal. See https://docs.databricks.com/en/dev-tools/auth.html#oauth-2-0"
1085	        ),
1086	        default_value=None,
1087	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/configs.py:1108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1107	        description=(
1108	            "Azure service principal oauth credentials for interacting with the Databricks REST API"
1109	            " via a service"
1110	            " principal. See"
1111	            " https://learn.microsoft.com/en-us/azure/databricks/administration-guide/users-groups/service-principals"
1112	        ),
1113	        default_value=None,
1114	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	
288	        jdoc = dbfs_service.read(path=dbfs_path, length=block_size)
289	        jdoc_data = check.not_none(jdoc.data, f"read file {dbfs_path} with no data")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
289	        jdoc_data = check.not_none(jdoc.data, f"read file {dbfs_path} with no data")
290	        data += base64.b64decode(jdoc_data)
291	        while jdoc.bytes_read == block_size:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:290
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
289	        jdoc_data = check.not_none(jdoc.data, f"read file {dbfs_path} with no data")
290	        data += base64.b64decode(jdoc_data)
291	        while jdoc.bytes_read == block_size:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
292	            bytes_read += check.not_none(jdoc.bytes_read)
293	            jdoc = dbfs_service.read(path=dbfs_path, offset=bytes_read, length=block_size)
294	            jdoc_data = check.not_none(jdoc.data, f"read file {dbfs_path} with no data")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
294	            jdoc_data = check.not_none(jdoc.data, f"read file {dbfs_path} with no data")
295	            data += base64.b64decode(jdoc_data)
296	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:295
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
294	            jdoc_data = check.not_none(jdoc.data, f"read file {dbfs_path} with no data")
295	            data += base64.b64decode(jdoc_data)
296	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
315	
316	        block = file_obj.read(block_size)
317	        while block:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
317	        while block:
318	            data = base64.b64encode(block).decode("utf-8")
319	            dbfs_service.add_block(data=data, handle=handle)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:318
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
317	        while block:
318	            data = base64.b64encode(block).decode("utf-8")
319	            dbfs_service.add_block(data=data, handle=handle)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
319	            dbfs_service.add_block(data=data, handle=handle)
320	            block = file_obj.read(block_size)
321	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
442	        """Submit a new run using the 'Runs submit' API."""
443	        existing_cluster_id = run_config["cluster"].get("existing")
444	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
444	
445	        new_cluster = run_config["cluster"].get("new")
446	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	
479	            tags = new_cluster.get("custom_tags", {})
480	            if isinstance(tags, list):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
492	        # Add them if they're not already added by users in config.
493	        libraries = list(run_config.get("libraries", []))
494	        install_default_libraries = run_config.get("install_default_libraries", True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
493	        libraries = list(run_config.get("libraries", []))
494	        install_default_libraries = run_config.get("install_default_libraries", True)
495	        if install_default_libraries:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
519	            sum(
520	                task.get(key) is not None
521	                for key in [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
532	        return self.client.workspace_client.jobs.submit(
533	            run_name=run_config.get("run_name"),
534	            tasks=[

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
544	            ],
545	            idempotency_token=run_config.get("idempotency_token"),
546	            timeout_seconds=run_config.get("timeout_seconds"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
545	            idempotency_token=run_config.get("idempotency_token"),
546	            timeout_seconds=run_config.get("timeout_seconds"),
547	            health=jobs.JobsHealthRules.from_dict({"rules": run_config["job_health_settings"]})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks.py:584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
583	        )
584	        cluster = self.client.workspace_client.clusters.get(cluster_id)
585	        log_config = cluster.cluster_log_conf

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_pyspark_step_launcher.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
312	            log.info(stdout)
313	            sys.stdout.write(stdout)
314	        except Exception as e:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_pyspark_step_launcher.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
312	            log.info(stdout)
313	            sys.stdout.write(stdout)
314	        except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_pyspark_step_launcher.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
324	            log.info(stderr)
325	            sys.stderr.write(stderr)
326	        except Exception as e:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_pyspark_step_launcher.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
324	            log.info(stderr)
325	            sys.stderr.write(stderr)
326	        except Exception as e:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_pyspark_step_launcher.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
408	                Sequence[EventLogEntry],
409	                deserialize_value(pickle.loads(gzip.decompress(serialized_records))),
410	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_step_main.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
131	            events_queue = Queue()
132	            event_writing_thread = Thread(
133	                target=event_writing_loop,
134	                kwargs=dict(events_queue=events_queue, put_events_fn=put_events),
135	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_step_main.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
150	                stderr_str = stderr.getvalue()
151	                sys.stderr.write(stderr_str)
152	                handle.write(stderr_str.encode())

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_step_main.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
150	                stderr_str = stderr.getvalue()
151	                sys.stderr.write(stderr_str)
152	                handle.write(stderr_str.encode())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_step_main.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
151	                sys.stderr.write(stderr_str)
152	                handle.write(stderr_str.encode())
153	            with open(stdout_filepath, "wb") as handle:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_step_main.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
151	                sys.stderr.write(stderr_str)
152	                handle.write(stderr_str.encode())
153	            with open(stdout_filepath, "wb") as handle:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_step_main.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
154	                stdout_str = stdout.getvalue()
155	                sys.stdout.write(stdout_str)
156	                handle.write(stdout_str.encode())

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_step_main.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
154	                stdout_str = stdout.getvalue()
155	                sys.stdout.write(stdout_str)
156	                handle.write(stdout_str.encode())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_step_main.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	                sys.stdout.write(stdout_str)
156	                handle.write(stdout_str.encode())
157	            if events_queue is not None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/databricks_step_main.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
155	                sys.stdout.write(stdout_str)
156	                handle.write(stdout_str.encode())
157	            if events_queue is not None:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/pipes.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
346	            path = os.path.join(tempdir, _CONTEXT_FILENAME)
347	            contents = base64.b64encode(json.dumps(context).encode("utf-8")).decode("utf-8")
348	            self.dbfs_client.put(path, contents=contents, overwrite=True)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/pipes.py:347
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
346	            path = os.path.join(tempdir, _CONTEXT_FILENAME)
347	            contents = base64.b64encode(json.dumps(context).encode("utf-8")).decode("utf-8")
348	            self.dbfs_client.put(path, contents=contents, overwrite=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/pipes.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
410	        try:
411	            raw_message = self.dbfs_client.read(message_path)
412	            message_data = check.not_none(raw_message.data, "Read message with null data.")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/pipes.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
414	            # base64-encoded.
415	            return base64.b64decode(message_data).decode("utf-8")
416	        # An error here is an expected result, since an IOError will be thrown if the next message

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/pipes.py:415
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
414	            # base64-encoded.
415	            return base64.b64decode(message_data).decode("utf-8")
416	        # An error here is an expected result, since an IOError will be thrown if the next message

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/pipes.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
474	                    return None
475	                read_response = self.dbfs_client.read(log_path)
476	                assert read_response.data

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/pipes.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
476	                assert read_response.data
477	                content = base64.b64decode(read_response.data).decode("utf-8")
478	                chunk = content[self.log_position :]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/pipes.py:477
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
476	                assert read_response.data
477	                content = base64.b64decode(read_response.data).decode("utf-8")
478	                chunk = content[self.log_position :]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/resources.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    host: Optional[str] = Field(
37	        description="Databricks host, e.g. https://uksouth.azuredatabricks.com", default=None
38	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/resources.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	        description=(
43	            "Databricks OAuth credentials for using a service principal. See"
44	            " https://docs.databricks.com/en/dev-tools/auth.html#oauth-2-0"
45	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/resources.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        description=(
50	            "Azure service principal credentials. See"
51	            " https://learn.microsoft.com/en-us/azure/databricks/dev-tools/auth#requirements-for-oauth-u2m-authentication-setup"
52	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagster_databricks-0.26.9-py3-none-any/dagster_databricks/resources.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        description=(
57	            "DEPRECATED: The Databricks workspace ID, as described in"
58	            " https://docs.databricks.com/workspace/workspace-details.html#workspace-instance-names-urls-and-ids."
59	            " This is no longer used and will be removed in a 0.21."

--------------------------------------------------

Code scanned:
	Total lines of code: 3191
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 38.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 54.0
		High: 7.0
Files skipped (0):
