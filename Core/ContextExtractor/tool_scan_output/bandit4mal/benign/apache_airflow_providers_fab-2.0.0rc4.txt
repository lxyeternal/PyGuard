Run started:2025-04-12 12:02:11.849863

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/api/auth/backend/kerberos_auth.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	    """Initialize application with kerberos."""
61	    hostname = app.config.get("SERVER_NAME")
62	    if not hostname:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/api/auth/backend/kerberos_auth.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	    if "KRB5_KTNAME" not in os.environ:
71	        os.environ["KRB5_KTNAME"] = conf.get("kerberos", "keytab")
72	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/api/auth/backend/kerberos_auth.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	    def decorated(*args, **kwargs):
127	        if current_app.config.get("AUTH_ROLE_PUBLIC", None):
128	            response = function(*args, **kwargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/api/auth/backend/kerberos_auth.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
130	
131	        header = request.headers.get("Authorization")
132	        if header:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/api_endpoints/role_and_permission_endpoint.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
126	    try:
127	        data = role_schema.load(body)
128	    except ValidationError as err:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/api_endpoints/role_and_permission_endpoint.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
159	    try:
160	        data = role_schema.load(body)
161	    except ValidationError as err:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/api_endpoints/user_endpoint.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
91	    try:
92	        data = user_schema.load(request.json)
93	    except ValidationError as e:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/api_endpoints/user_endpoint.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
134	    try:
135	        data = user_schema.load(request.json)
136	    except ValidationError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/cli_commands/user_command.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
193	        with open(args.export, "w") as file:
194	            file.write(json.dumps(users, sort_keys=True, indent=4))
195	            print_export_output("users", users, file)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/cli_commands/user_command.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	        with open(json_file) as file:
209	            users_list = json.loads(file.read())
210	    except ValueError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
363	
364	        resp = requests.get(jwks_url)
365	        if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
380	
381	        verify_signature = self.oauth_remotes["authentik"].client_kwargs.get("verify_signature", True)
382	        if verify_signature:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
383	            # Validate the token using authentik certificate
384	            jwks_uri = self.oauth_remotes["authentik"].server_metadata.get("jwks_uri")
385	            if jwks_uri:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	        """Register FAB auth manager related views."""
400	        if not self.appbuilder.get_app.config.get("FAB_ADD_SECURITY_VIEWS", True):
401	            return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
476	        self.appbuilder.menu.add_separator("Security")
477	        if self.appbuilder.get_app.config.get("FAB_ADD_SECURITY_PERMISSION_VIEW", True):
478	            self.appbuilder.add_view(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
484	            )
485	        if self.appbuilder.get_app.config.get("FAB_ADD_SECURITY_VIEW_MENU_VIEW", True):
486	            self.appbuilder.add_view(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
492	            )
493	        if self.appbuilder.get_app.config.get("FAB_ADD_SECURITY_PERMISSION_VIEWS_VIEW", True):
494	            self.appbuilder.add_view(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
559	                    session_details = interface.serializer.loads(want_bytes(s.data))
560	                    if session_details.get("_user_id") == user.id:
561	                        session.delete(s)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
599	        """Get the public role."""
600	        return self.appbuilder.get_app.config.get("AUTH_ROLE_PUBLIC", None)
601	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
714	        """Get the auth username for CI."""
715	        return self.appbuilder.get_app.config.get("AUTH_USERNAME_CI", True)
716	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
742	        """Return FAB builtin roles."""
743	        return self.appbuilder.get_app.config.get("FAB_ROLES", {})
744	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
882	
883	            roles_mapping = self.appbuilder.get_app.config.get("FAB_ROLES_MAPPING", {})
884	            for pk, name in roles_mapping.items():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1008	                    for role in non_admin_roles:
1009	                        access_control_role = access_control.get(role.name)
1010	                        target_perms_for_role = set()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:1015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1014	                            elif isinstance(access_control_role, dict):
1015	                                target_perms_for_role = access_control_role.get(resource_name, set())
1016	                        if perm.action.name not in target_perms_for_role:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:1216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1215	            perms = config["perms"]
1216	            role = existing_roles.get(role_name) or self.add_role(role_name)
1217	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:1219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1218	            for action_name, resource_name in perms:
1219	                perm = non_dag_perms.get((action_name, resource_name)) or self.create_permission(
1220	                    action_name, resource_name

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:1234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1233	        """Update a role in the database."""
1234	        role = self.get_session.get(self.role_model, role_id)
1235	        if not role:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:1363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1362	    def get_user_by_id(self, pk):
1363	        return self.get_session.get(self.user_model, pk)
1364	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:1953
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1952	            oauth_response[token_key],
1953	            oauth_response.get(token_secret, ""),
1954	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:1966
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1965	            if _provider["name"] == provider:
1966	                return _provider.get("token_key", "oauth_token")
1967	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:1977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1976	            if _provider["name"] == provider:
1977	                return _provider.get("token_secret", "oauth_token_secret")
1978	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2019
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2018	                username=username,
2019	                first_name=userinfo.get("first_name", ""),
2020	                last_name=userinfo.get("last_name", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2019	                first_name=userinfo.get("first_name", ""),
2020	                last_name=userinfo.get("last_name", ""),
2021	                email=userinfo.get("email", "") or f"{username}@email.notfound",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2020	                last_name=userinfo.get("last_name", ""),
2021	                email=userinfo.get("email", "") or f"{username}@email.notfound",
2022	                role=self._oauth_calculate_user_roles(userinfo),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2047
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2046	        if provider == "github" or provider == "githublocal":
2047	            me = self.oauth_remotes[provider].get("user")
2048	            data = me.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2049	            log.debug("User info from GitHub: %s", data)
2050	            return {"username": "github_" + data.get("login")}
2051	        # for twitter

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2052	        if provider == "twitter":
2053	            me = self.oauth_remotes[provider].get("account/settings.json")
2054	            data = me.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2055	            log.debug("User info from Twitter: %s", data)
2056	            return {"username": "twitter_" + data.get("screen_name", "")}
2057	        # for linkedin

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2059
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2058	        if provider == "linkedin":
2059	            me = self.oauth_remotes[provider].get(
2060	                "people/~:(id,email-address,first-name,last-name)?format=json"
2061	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2065
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2064	            return {
2065	                "username": "linkedin_" + data.get("id", ""),
2066	                "email": data.get("email-address", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2065	                "username": "linkedin_" + data.get("id", ""),
2066	                "email": data.get("email-address", ""),
2067	                "first_name": data.get("firstName", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2067
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2066	                "email": data.get("email-address", ""),
2067	                "first_name": data.get("firstName", ""),
2068	                "last_name": data.get("lastName", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2067	                "first_name": data.get("firstName", ""),
2068	                "last_name": data.get("lastName", ""),
2069	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2071	        if provider == "google":
2072	            me = self.oauth_remotes[provider].get("userinfo")
2073	            data = me.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2075	            return {
2076	                "username": "google_" + data.get("id", ""),
2077	                "first_name": data.get("given_name", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2077
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2076	                "username": "google_" + data.get("id", ""),
2077	                "first_name": data.get("given_name", ""),
2078	                "last_name": data.get("family_name", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2077	                "first_name": data.get("given_name", ""),
2078	                "last_name": data.get("family_name", ""),
2079	                "email": data.get("email", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2078	                "last_name": data.get("family_name", ""),
2079	                "email": data.get("email", ""),
2080	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2087
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2086	                "email": me["email"] if "email" in me else me["upn"],
2087	                "first_name": me.get("given_name", ""),
2088	                "last_name": me.get("family_name", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2088
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2087	                "first_name": me.get("given_name", ""),
2088	                "last_name": me.get("family_name", ""),
2089	                "username": me["oid"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2090
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2089	                "username": me["oid"],
2090	                "role_keys": me.get("roles", []),
2091	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2093	        if provider == "openshift":
2094	            me = self.oauth_remotes[provider].get("apis/user.openshift.io/v1/users/~")
2095	            data = me.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2097
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2096	            log.debug("User info from OpenShift: %s", data)
2097	            return {"username": "openshift_" + data.get("metadata").get("name")}
2098	        # for Okta

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2097
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2096	            log.debug("User info from OpenShift: %s", data)
2097	            return {"username": "openshift_" + data.get("metadata").get("name")}
2098	        # for Okta

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2099	        if provider == "okta":
2100	            me = self.oauth_remotes[provider].get("userinfo")
2101	            data = me.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2105	                    "username": f"{provider}_{data['sub']}",
2106	                    "first_name": data.get("given_name", ""),
2107	                    "last_name": data.get("family_name", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2106	                    "first_name": data.get("given_name", ""),
2107	                    "last_name": data.get("family_name", ""),
2108	                    "email": data["email"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2108	                    "email": data["email"],
2109	                    "role_keys": data.get("groups", []),
2110	                }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2111	            else:
2112	                log.error(data.get("error_description"))
2113	            return {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2119	                "username": f"{provider}_{data['sub']}",
2120	                "first_name": data.get("given_name", ""),
2121	                "last_name": data.get("family_name", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2120	                "first_name": data.get("given_name", ""),
2121	                "last_name": data.get("family_name", ""),
2122	                "email": data["email"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2122	                "email": data["email"],
2123	                "role_keys": data.get("groups", []),
2124	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2126	        if provider in ["keycloak", "keycloak_before_17"]:
2127	            me = self.oauth_remotes[provider].get("openid-connect/userinfo")
2128	            me.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2131	            return {
2132	                "username": data.get("preferred_username", ""),
2133	                "first_name": data.get("given_name", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2132	                "username": data.get("preferred_username", ""),
2133	                "first_name": data.get("given_name", ""),
2134	                "last_name": data.get("family_name", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2133	                "first_name": data.get("given_name", ""),
2134	                "last_name": data.get("family_name", ""),
2135	                "email": data.get("email", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2134	                "last_name": data.get("family_name", ""),
2135	                "email": data.get("email", ""),
2136	                "role_keys": data.get("groups", []),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2135	                "email": data.get("email", ""),
2136	                "role_keys": data.get("groups", []),
2137	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2144	                "email": me["preferred_username"],
2145	                "first_name": me.get("given_name", ""),
2146	                "username": me["nickname"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2146	                "username": me["nickname"],
2147	                "role_keys": me.get("groups", []),
2148	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2155	        """Get authentication (OAuth) token."""
2156	        token = session.get("oauth")
2157	        log.debug("Token Get: %s", token)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2161	    def ldap_extract_list(ldap_dict: dict[str, list[bytes]], field_name: str) -> list[str]:
2162	        raw_list = ldap_dict.get(field_name, [])
2163	        # decode - removing empty strings

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2167	    def ldap_extract(ldap_dict: dict[str, list[bytes]], field_name: str, fallback: str) -> str:
2168	        raw_value = ldap_dict.get(field_name, [b""])
2169	        # decode - if empty string, default to fallback, otherwise take first element

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2184	        """
2185	        if conf.get("fab", "SESSION_BACKEND") == "database":
2186	            session.sid = str(uuid.uuid4())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2190	
2191	        return requests.get(MICROSOFT_KEY_SET_URL).json()
2192	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2193	    def _decode_and_validate_azure_jwt(self, id_token: str) -> dict[str, str]:
2194	        verify_signature = self.oauth_remotes["azure"].client_kwargs.get("verify_signature", False)
2195	        if verify_signature:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/auth_manager/security_manager/override.py:2384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2383	        if self.auth_roles_mapping:
2384	            user_role_keys = userinfo.get("role_keys", [])
2385	            user_role_objects.update(self.get_roles_from_keys(user_role_keys))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/src/airflow/providers/fab/get_provider_info.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        "name": "Fab",
28	        "description": "`Flask App Builder <https://flask-appbuilder.readthedocs.io/>`__\n",
29	        "config": {
30	            "fab": {
31	                "description": "This section contains configs specific to FAB provider.",
32	                "options": {
33	                    "auth_rate_limited": {
34	                        "description": "Boolean for enabling rate limiting on authentication endpoints.\n",
35	                        "version_added": "1.0.2",
36	                        "type": "boolean",
37	                        "example": None,
38	                        "default": "True",
39	                    },
40	                    "auth_rate_limit": {
41	                        "description": "Rate limit for authentication endpoints.\n",
42	                        "version_added": "1.0.2",
43	                        "type": "string",
44	                        "example": None,
45	                        "default": "5 per 40 second",
46	                    },
47	                    "update_fab_perms": {
48	                        "description": "Update FAB permissions and sync security manager roles\non webserver startup\n",
49	                        "version_added": "1.0.2",
50	                        "type": "string",
51	                        "example": None,
52	                        "default": "True",
53	                    },
54	                    "auth_backends": {
55	                        "description": "Comma separated list of auth backends to authenticate users of the API.\n",
56	                        "version_added": "2.0.0",
57	                        "type": "string",
58	                        "example": None,
59	                        "default": "airflow.providers.fab.auth_manager.api.auth.backend.session",
60	                    },
61	                    "config_file": {
62	                        "description": "Path of webserver config file used for configuring the webserver parameters\n",
63	                        "version_added": "2.0.0",
64	                        "type": "string",
65	                        "example": None,
66	                        "default": "{AIRFLOW_HOME}/webserver_config.py",
67	                    },
68	                    "session_backend": {
69	                        "description": "The type of backend used to store web session data, can be ``database`` or ``securecookie``. For the\n``database`` backend, sessions are store in the database and they can be\nmanaged there (for example when you reset password of the user, all sessions for that user are\ndeleted). For the ``securecookie`` backend, sessions are stored in encrypted cookies on the client\nside. The ``securecookie`` mechanism is 'lighter' than database backend, but sessions are not\ndeleted when you reset password of the user, which means that other than waiting for expiry time,\nthe only way to invalidate all sessions for a user is to change secret_key and restart webserver\n(which also invalidates and logs out all other user's sessions).\n\nWhen you are using ``database`` backend, make sure to keep your database session table small\nby periodically running ``airflow db clean --table session`` command, especially if you have\nautomated API calls that will create a new session for each call rather than reuse the sessions\nstored in browser cookies.\n",
70	                        "version_added": "2.0.0",
71	                        "type": "string",
72	                        "example": "securecookie",
73	                        "default": "database",
74	                    },
75	                    "session_lifetime_minutes": {
76	                        "description": "The UI cookie lifetime in minutes. User will be logged out from UI after\n``[fab] session_lifetime_minutes`` of non-activity\n",
77	                        "version_added": "2.0.0",
78	                        "type": "integer",
79	                        "example": None,
80	                        "default": "43200",
81	                    },
82	                },
83	            }
84	        },
85	        "auth-managers": ["airflow.providers.fab.auth_manager.fab_auth_manager.FabAuthManager"],
86	    }

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/tests/unit/fab/auth_manager/api_endpoints/test_auth.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
71	    def test_success(self):
72	        token = "Basic " + b64encode(b"test:test").decode()
73	        clear_db_pools()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/tests/unit/fab/auth_manager/api_endpoints/test_auth.py:72
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
71	    def test_success(self):
72	        token = "Basic " + b64encode(b"test:test").decode()
73	        clear_db_pools()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/tests/unit/fab/auth_manager/cli_commands/test_user_command.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
336	        with open(users_filename) as file:
337	            retrieved_users = json.loads(file.read())
338	        os.remove(users_filename)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/tests/unit/fab/auth_manager/cli_commands/test_user_command.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
355	            try:
356	                f.write(json_file_content.encode())
357	                f.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_fab-2.0.0rc4/apache_airflow_providers_fab-2.0.0rc4/tests/unit/fab/auth_manager/cli_commands/test_user_command.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
355	            try:
356	                f.write(json_file_content.encode())
357	                f.flush()

--------------------------------------------------

Code scanned:
	Total lines of code: 12048
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 81.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 82.0
		High: 1.0
Files skipped (0):
