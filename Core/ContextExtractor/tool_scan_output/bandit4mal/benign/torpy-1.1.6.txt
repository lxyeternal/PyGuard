Run started:2025-04-12 11:33:59.913932

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	with open(path.join(here, 'README.md'), encoding='utf-8') as f:
24	    long_description = f.read()
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/setup.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    long_description_content_type='text/markdown',
32	    url='https://github.com/torpyorg/torpy',
33	    author='James Brown',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/setup.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    project_urls={
52	        'Bug Reports': 'https://github.com/torpyorg/torpy/issues',
53	        'Source': 'https://github.com/torpyorg/torpy/',
54	    },
55	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/setup.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	        'Bug Reports': 'https://github.com/torpyorg/torpy/issues',
53	        'Source': 'https://github.com/torpyorg/torpy/',
54	    },
55	)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
55	                # Send some data to it
56	                stream.send(b'GET / HTTP/1.0\r\nHost: %s\r\n\r\n' % hostname.encode())
57	                recv = recv_all(stream).decode()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
71	                # Send some data to it
72	                stream.send(b'GET / HTTP/1.0\r\nHost: %s\r\n\r\n' % hostname.encode())
73	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
79	def test_requests_no_agent():
80	    data = requests_request('https://httpbin.org/headers', retries=RETRIES)
81	    assert 'User-Agent' not in data

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
79	def test_requests_no_agent():
80	    data = requests_request('https://httpbin.org/headers', retries=RETRIES)
81	    assert 'User-Agent' not in data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	def test_requests_no_agent():
80	    data = requests_request('https://httpbin.org/headers', retries=RETRIES)
81	    assert 'User-Agent' not in data

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
84	def test_requests():
85	    data = requests_request('https://httpbin.org/headers', headers={'User-Agent': 'Mozilla/5.0'}, retries=RETRIES)
86	    assert 'Mozilla' in data

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
84	def test_requests():
85	    data = requests_request('https://httpbin.org/headers', headers={'User-Agent': 'Mozilla/5.0'}, retries=RETRIES)
86	    assert 'Mozilla' in data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	def test_requests():
85	    data = requests_request('https://httpbin.org/headers', headers={'User-Agent': 'Mozilla/5.0'}, retries=RETRIES)
86	    assert 'Mozilla' in data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	
99	                r = s.get('https://google.com', timeout=30)
100	                logger.warning(r)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	
99	                r = s.get('https://google.com', timeout=30)
100	                logger.warning(r)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	
104	                r = s.get('https://stackoverflow.com/questions/tagged/python')
105	                assert r.text.rstrip().endswith('</html>')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
103	
104	                r = s.get('https://stackoverflow.com/questions/tagged/python')
105	                assert r.text.rstrip().endswith('</html>')

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
110	def test_urlopener_no_agent():
111	    data = urllib_request('https://httpbin.org/headers', verbose=1, retries=RETRIES)
112	    assert 'User-Agent' not in data

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
110	def test_urlopener_no_agent():
111	    data = urllib_request('https://httpbin.org/headers', verbose=1, retries=RETRIES)
112	    assert 'User-Agent' not in data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	def test_urlopener_no_agent():
111	    data = urllib_request('https://httpbin.org/headers', verbose=1, retries=RETRIES)
112	    assert 'User-Agent' not in data

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
115	def test_urlopener():
116	    data = urllib_request('https://httpbin.org/headers', headers=[('User-Agent', 'Mozilla/5.0')], verbose=1,
117	                          retries=RETRIES)
118	    assert 'Mozilla' in data

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
115	def test_urlopener():
116	    data = urllib_request('https://httpbin.org/headers', headers=[('User-Agent', 'Mozilla/5.0')], verbose=1,
117	                          retries=RETRIES)
118	    assert 'Mozilla' in data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
115	def test_urlopener():
116	    data = urllib_request('https://httpbin.org/headers', headers=[('User-Agent', 'Mozilla/5.0')], verbose=1,
117	                          retries=RETRIES)
118	    assert 'Mozilla' in data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	        links = [
126	            'https://httpbin.org/headers',
127	            'https://google.com',
128	            'https://ifconfig.me',
129	            'http://facebookcorewwwi.onion',
130	        ]
131	        if HS_BASIC_HOST:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	            'https://httpbin.org/headers',
127	            'https://google.com',
128	            'https://ifconfig.me',
129	            'http://facebookcorewwwi.onion',
130	        ]
131	        if HS_BASIC_HOST:
132	            links.append('http://' + HS_BASIC_HOST)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	            'https://google.com',
128	            'https://ifconfig.me',
129	            'http://facebookcorewwwi.onion',
130	        ]
131	        if HS_BASIC_HOST:
132	            links.append('http://' + HS_BASIC_HOST)
133	        links = links * 10

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	            'https://ifconfig.me',
129	            'http://facebookcorewwwi.onion',
130	        ]
131	        if HS_BASIC_HOST:
132	            links.append('http://' + HS_BASIC_HOST)
133	        links = links * 10
134	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	                    logger.debug('get link: %s', link)
140	                    r = sess.get(link, timeout=30)
141	                    logger.warning('get link %s finish: %s', link, r)

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
145	
146	            pool = ThreadPool(10)
147	            for i, w in enumerate(pool._pool):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
149	            results = pool.map(process, links)
150	            pool.close()
151	            pool.join()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
168	                # Send some data to it
169	                stream.send(b'GET / HTTP/1.0\r\nHost: %s.onion\r\n\r\n' % hs.onion.encode())
170	                recv = recv_all(stream).decode()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
187	                # Send some data to it
188	                stream.send(b'GET / HTTP/1.0\r\nHost: %s\r\n\r\n' % hs.hostname.encode())
189	                recv = recv_all(stream).decode()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
207	                # Send some data to it
208	                stream.send(b'GET / HTTP/1.0\r\nHost: %s.onion\r\n\r\n' % hidden_service.encode())
209	                recv = recv_all(stream).decode()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
220	    with tor_requests_session(auth_data=auth_data, retries=RETRIES) as sess:
221	        r = sess.get('http://{}/'.format(HS_BASIC_HOST), timeout=30)
222	        logger.warning(r)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
220	    with tor_requests_session(auth_data=auth_data, retries=RETRIES) as sess:
221	        r = sess.get('http://{}/'.format(HS_BASIC_HOST), timeout=30)
222	        logger.warning(r)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
239	                kind = type(sock_or_stream)
240	                data = sock_or_stream.recv(1024)
241	                logger.info('%s: %r', kind.__name__, data.decode())

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
253	
254	                    stream.send(b'GET / HTTP/1.0\r\nHost: %s\r\n\r\n' % hostname.encode())
255	                    sock_w.send(b'some data')

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
254	                    stream.send(b'GET / HTTP/1.0\r\nHost: %s\r\n\r\n' % hostname.encode())
255	                    sock_w.send(b'some data')
256	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/integration/test_integration.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
259	
260	                    sock_w.close()
261	                    assert events[socket.socket]['close'].wait(10), 'no sock close received'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/unittest/test_consensus.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
11	                {'_nickname': 'moria1', '_fingerprint': b'\x96\x95\xdf\xc3_\xfe\xb8a2\x9b\x9f\x1a\xb0LF9p \xce1',
12	                 '_digest': None, '_ip': '128.31.0.39', '_or_port': 9101, '_dir_port': 9131, '_version': None,
13	                 '_flags': [RouterFlags.Authority], '_consensus': None, '_service_key': None,
14	                 '_dir_flags': DirectoryServer.AUTH_FLAGS, '_v3ident': 'D586D18309DED4CD6D57C18FDB97EFA96D330566',
15	                 '_ipv6': None,
16	                 '_bridge': False}),
17	        (
18	                '"tor26 orport=443 v3ident=14C131DFC5C6F93646BE72FA1401C02A8DF2E8B4 ipv6=[2001:858:2:2:aabb:0:563b:1526]:443 86.59.21.38:80 847B 1F85 0344 D787 6491 A548 92F9 0493 4E4E B85D"',  # noqa: E501

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/unittest/test_consensus.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
19	                {'_nickname': 'tor26', '_fingerprint': b'\x84{\x1f\x85\x03D\xd7\x87d\x91\xa5H\x92\xf9\x04\x93NN\xb8]',
20	                 '_digest': None, '_ip': '86.59.21.38', '_or_port': 443, '_dir_port': 80, '_version': None,
21	                 '_flags': [RouterFlags.Authority], '_consensus': None, '_service_key': None,
22	                 '_dir_flags': DirectoryServer.AUTH_FLAGS, '_v3ident': '14C131DFC5C6F93646BE72FA1401C02A8DF2E8B4',
23	                 '_ipv6': '[2001:858:2:2:aabb:0:563b:1526]:443', '_bridge': False}),
24	        (
25	                '"dizum orport=443 v3ident=E8A9C45EDE6D711294FADF8E7951F4DE6CA56B58 45.66.33.45:80 7EA6 EAD6 FD83 083C 538F 4403 8BBF A077 587D D755"',  # noqa: E501

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/unittest/test_consensus.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
26	                {'_nickname': 'dizum', '_fingerprint': b'~\xa6\xea\xd6\xfd\x83\x08<S\x8fD\x03\x8b\xbf\xa0wX}\xd7U',
27	                 '_digest': None, '_ip': '45.66.33.45', '_or_port': 443, '_dir_port': 80, '_version': None,
28	                 '_flags': [RouterFlags.Authority], '_consensus': None, '_service_key': None,
29	                 '_dir_flags': DirectoryServer.AUTH_FLAGS, '_v3ident': 'E8A9C45EDE6D711294FADF8E7951F4DE6CA56B58',
30	                 '_ipv6': None, '_bridge': False}),
31	        (
32	                '"Serge orport=9001 bridge 66.111.2.131:9030 BA44 A889 E64B 93FA A2B1 14E0 2C2A 279A 8555 C533"',

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/unittest/test_consensus.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
33	                {'_nickname': 'Serge', '_fingerprint': b"\xbaD\xa8\x89\xe6K\x93\xfa\xa2\xb1\x14\xe0,*'\x9a\x85U\xc53",
34	                 '_digest': None, '_ip': '66.111.2.131', '_or_port': 9001, '_dir_port': 9030, '_version': None,
35	                 '_flags': [RouterFlags.Authority], '_consensus': None, '_service_key': None,
36	                 '_dir_flags': DirectoryFlags.BRIDGE_DIRINFO, '_v3ident': None, '_ipv6': None, '_bridge': True}),
37	        (
38	                '"gabelmoo orport=443 v3ident=ED03BB616EB2F60BEC80151114BB25CEF515B226 ipv6=[2001:638:a000:4140::ffff:189]:443 131.188.40.189:80 F204 4413 DAC2 E02E 3D6B CF47 35A1 9BCA 1DE9 7281"',  # noqa: E501

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/unittest/test_consensus.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
40	                 '_fingerprint': b'\xf2\x04D\x13\xda\xc2\xe0.=k\xcfG5\xa1\x9b\xca\x1d\xe9r\x81', '_digest': None,
41	                 '_ip': '131.188.40.189', '_or_port': 443, '_dir_port': 80, '_version': None,
42	                 '_flags': [RouterFlags.Authority], '_consensus': None, '_service_key': None,
43	                 '_dir_flags': DirectoryServer.AUTH_FLAGS, '_v3ident': 'ED03BB616EB2F60BEC80151114BB25CEF515B226',
44	                 '_ipv6': '[2001:638:a000:4140::ffff:189]:443', '_bridge': False})
45	    ],
46	    ids=[
47	        'moria1',

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/tests/unittest/test_documents.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	    with open(fpath) as f:
36	        return f.read()
37	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cache_storage.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
55	            with open(os.path.join(self._base_dir, key), 'r') as f:
56	                return file_path, f.read()
57	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cache_storage.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	        with open(os.path.join(self._base_dir, key), 'w') as f:
62	            f.write(content)
63	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cell_socket.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
57	        self._socket = ssl.wrap_socket(
58	            socket.socket(socket.AF_INET, socket.SOCK_STREAM), ssl_version=ssl.PROTOCOL_TLSv1_2
59	        )

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cell_socket.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
61	        try:
62	            self._socket.settimeout(15.0)
63	            self._socket.connect((self._router.ip, self._router.or_port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cell_socket.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
62	            self._socket.settimeout(15.0)
63	            self._socket.connect((self._router.ip, self._router.or_port))
64	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cell_socket.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
77	        with self._send_close_lock:
78	            self._socket.close()
79	            self._socket = None

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cell_socket.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
94	            if len(self._data) < self._next_len:
95	                more_data = self._socket.recv(TorCellSocket.RECV_BUFF_SIZE)
96	                self._data.extend(more_data)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cell_socket.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
103	    def recv_cell_async(self):
104	        more_data = self._socket.recv(TorCellSocket.RECV_BUFF_SIZE)
105	        self._data.extend(more_data)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cell_socket.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
113	
114	            self._next_len = self._cells_builder.send(send_buff)
115	            if self._next_len is None:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cell_socket.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
113	
114	            self._next_len = self._cells_builder.send(send_buff)
115	            if self._next_len is None:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
168	        self._selector.unregister(self._cntrl_r)
169	        self._cntrl_w.close()
170	        self._cntrl_r.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
169	        self._cntrl_w.close()
170	        self._cntrl_r.close()
171	        self._selector.unregister(self._tor_socket.ssl_socket)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
171	        self._selector.unregister(self._tor_socket.ssl_socket)
172	        self._selector.close()
173	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
179	        logger.debug('Stopping receiver thread...')
180	        self._cntrl_w.send(b'\1')
181	        self.join()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
344	        """Close the circuit."""
345	        self.close()
346	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
387	                    # Destroy the circuit itself
388	                    self._send(CellDestroy(CircuitReason.FINISHED, self.id))
389	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
393	        for stream in list(self._streams.values()):
394	            stream.close()
395	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
530	        with self._handler_mgr.create_waiter(wait_cell) as w:
531	            self._send(cell)
532	            return w.get()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
540	            self._encrypt(relay_cell)
541	            self._send(relay_cell)
542	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
598	        if address:
599	            tor_stream.connect(address)
600	        return tor_stream

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/circuit.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
658	                            # And finally try to agree to rendezvous with the hidden service
659	                            extend_node = introduction.connect(hidden_service, rendezvous_cookie)
660	                            self._circuit_nodes.append(extend_node)

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
41	        addr, port = csock.getsockname()
42	        csock.sendall(b'\x05\0\0\x01\x7f\0\0\x01' + struct.pack('!H', port))
43	        try:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
46	                if ssock in r:
47	                    buf = ssock.recv(4096)
48	                    if len(buf) == 0:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
49	                        break
50	                    csock.send(buf)
51	                if csock in r:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
51	                if csock in r:
52	                    buf = csock.recv(4096)
53	                    if len(buf) == 0:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
54	                        break
55	                    ssock.send(buf)
56	        except BaseException:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
59	            logger.info('[socks] Close ssock')
60	            ssock.close()
61	            logger.info('[socks] Close csock')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
61	            logger.info('[socks] Close csock')
62	            csock.close()
63	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:74
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
73	        """Start listen incoming connections."""
74	        lsock = self.listen_socket = socket.socket(2, 1, 6)
75	        lsock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
82	        """Close listen incoming connections."""
83	        self.listen_socket.close()
84	        if exc_type:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
104	    def __init__(self, circuit, client_sock, client_addr):
105	        if client_addr[0] == '127.0.0.1':
106	            thread_name = 'Socks-%s' % client_addr[1]

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
115	        try:
116	            self.client_sock.send(b'\x05' + err)
117	            self.client_sock.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
116	            self.client_sock.send(b'\x05' + err)
117	            self.client_sock.close()
118	            self.client_sock = None

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
131	        try:
132	            ver = csock.recv(1)
133	            if ver != b'\x05':

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
134	                return self.error(b'\xff')
135	            nmeth, = array.array('B', csock.recv(1))
136	            _ = recv_exact(csock, nmeth)  # read methods

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
136	            _ = recv_exact(csock, nmeth)  # read methods
137	            csock.send(b'\x05\0')
138	            hbuf = recv_exact(csock, 4)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
148	            elif atyp == 3:
149	                n, = array.array('B', csock.recv(1))
150	                dst = recv_exact(csock, n).decode()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
163	            logger.exception('[socks] csock close by exception')
164	            csock.close()
165	            self.client_sock = None

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/cli/socks.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
169	    parser = ArgumentParser(description=__doc__, prog=os.path.basename(__file__))
170	    parser.add_argument('-i', '--ip', default='127.0.0.1', help='ip address to bind to')
171	    parser.add_argument('-p', '--port', default=1050, type=int, help='bind port')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
66	        """Close the tor client."""
67	        self.close()
68	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/client.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
69	    def close(self):
70	        self._consensus.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/consesus.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
223	        if self._dir_guard:
224	            self._dir_guard.close()
225	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/consesus.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
369	        if self._dir_guard_ttl and self._dir_guard_ttl < datetime.utcnow():
370	            self._dir_guard.close()
371	            self._dir_guard_ttl = self._dir_guard = self._dir_circuit = None

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/crypto_common.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
33	def b64decode(data):
34	    return base64.b64decode(data + '=' * (len(data) % 4))
35	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/crypto_common.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
33	def b64decode(data):
34	    return base64.b64decode(data + '=' * (len(data) % 4))
35	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/guard.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
65	        self.__tor_socket = TorCellSocket(self._router)
66	        self.__tor_socket.connect()
67	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/guard.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
98	        """Disconnect from Guard node."""
99	        self.close()
100	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/guard.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
105	        self._receiver.stop()
106	        self.__tor_socket.close()
107	        self._state = GuardState.Disconnected

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/guard.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
129	    def send_cell(self, cell):
130	        return self._sender.send(cell)
131	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/guard.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
149	            # We must close here because we didn't enter to circuit yet to guard by context manager
150	            circuit.close()
151	            raise

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/hiddenservice.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
64	            raise Exception('v3 onion hidden service not supported yet')
65	        self._descriptor_cookie = b64decode(descriptor_cookie) if descriptor_cookie else None
66	        self._auth_type = auth_type

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/hiddenservice.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
281	        intro_points_raw_base64 = HSDescriptorParser.parse(response)
282	        intro_points_raw = b64decode(intro_points_raw_base64)
283	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/http/client.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
50	        if headers['Content-Encoding'] == 'deflate':
51	            body = zlib.decompress(body)
52	        elif headers['Content-Encoding'] == 'gzip':

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/http/client.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
50	        if headers['Content-Encoding'] == 'deflate':
51	            body = zlib.decompress(body)
52	        elif headers['Content-Encoding'] == 'gzip':

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/http/client.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
52	        elif headers['Content-Encoding'] == 'gzip':
53	            body = gzip.decompress(body)
54	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/http/urlopener.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
47	        self._sock.close_tor_stream()
48	        super().close()
49	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/http/urlopener.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
60	        """Connect to the host and port specified in __init__."""
61	        self.sock = self._tor_info.connect((self.host, self.port), self.timeout, self.source_address)
62	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/http/urlopener.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
67	        logger.debug('[TorHTTPConnection] close')
68	        super().close()
69	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/http/urlopener.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
75	    def connect(self):
76	        TorHTTPConnection.connect(self)
77	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
82	        try:
83	            data = sock.recv(1024)
84	            self._send_func(data)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
94	            self._selector.unregister(self._cntrl_r)
95	            self._cntrl_w.close()
96	            self._cntrl_r.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
95	            self._cntrl_w.close()
96	            self._cntrl_r.close()
97	            self.close_sock()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
97	            self.close_sock()
98	            self._selector.close()
99	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
109	        self._selector.unregister(self._our_sock)
110	        self._our_sock.close()
111	        self._our_sock = None

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
116	            logger.debug('Stopping...')
117	            self._cntrl_w.send(b'\1')
118	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
130	    def append(self, data):
131	        self._our_sock.send(data)
132	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
171	        """Close the stream."""
172	        self.close()
173	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
270	        # Now we can connect to its address
271	        self._connect(address)
272	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
335	                logger.debug('Flush buffer')
336	                our_sock.send(self._buffer)
337	                self._buffer.clear()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
349	            logger.debug('[as_socket] finally')
350	            client_socket.close()
351	            self.close_socket()

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/stream.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
355	        if timeout:
356	            client_sock.settimeout(timeout)
357	        self._loop.start()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
45	def fp_to_str(fp):
46	    return b64encode(fp).decode()
47	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
45	def fp_to_str(fp):
46	    return b64encode(fp).decode()
47	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/utils.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
195	    with opener.open(url, timeout=timeout) as response:
196	        data = response.read()
197	        if response.info().get('Content-Encoding') == 'gzip':

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/utils.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
197	        if response.info().get('Content-Encoding') == 'gzip':
198	            data = gzip.decompress(data)
199	        elif response.info().get('Content-Encoding') == 'deflate':

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/utils.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
199	        elif response.info().get('Content-Encoding') == 'deflate':
200	            data = zlib.decompress(data)
201	        return data.decode('utf-8')

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torpy-1.1.6/torpy-1.1.6/torpy/utils.py:200
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
199	        elif response.info().get('Content-Encoding') == 'deflate':
200	            data = zlib.decompress(data)
201	        return data.decode('utf-8')

--------------------------------------------------

Code scanned:
	Total lines of code: 6152
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 94.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 115.0
		High: 6.0
Files skipped (0):
