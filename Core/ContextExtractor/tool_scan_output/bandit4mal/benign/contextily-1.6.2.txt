Run started:2025-04-12 12:37:33.240892

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/contextily/tile.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
61	def _clear_cache():
62	    shutil.rmtree(tmpdir, ignore_errors=True)
63	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/contextily/tile.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
178	        for band in range(b):
179	            raster.write(Z[:, :, band], band + 1)
180	    return Z, ext

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/contextily/tile.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
419	        ) as mraster:
420	            mraster.write(img)
421	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/contextily/tile.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
451	    try:
452	        request = requests.get(tile_url, headers={"user-agent": USER_AGENT})
453	        request.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/contextily/tile.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
621	    """
622	    min_zoom = provider.get("min_zoom", 0)
623	    if "max_zoom" in provider:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/contextily/tile.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
623	    if "max_zoom" in provider:
624	        max_zoom = provider.get("max_zoom")
625	        max_zoom_known = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/docs/conf.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	intersphinx_mapping = {
82	    "xyzservices": ("https://xyzservices.readthedocs.io/en/stable/", None),
83	}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/tests/test_cx.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	    rtr = rio.open("test.tif")
33	    img = np.array([band for band in rtr.read()]).transpose(1, 2, 0)
34	    solu = (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/tests/test_cx.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	    rtr = rio.open("test2.tif")
61	    rimg = np.array([band for band in rtr.read()]).transpose(1, 2, 0)
62	    assert rimg.shape == img.shape

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/tests/test_cx.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
157	    rtr = rio.open("test.tif")
158	    img = np.array([band for band in rtr.read()])
159	    wimg, _ = cx.warp_img_transform(img, rtr.transform, rtr.crs, "epsg:4326")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/contextily-1.6.2/contextily-1.6.2/tests/test_cx.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
230	    # with specific string url (not dict) -> error when specified
231	    url = "https://a.tile.openstreetmap.org/{z}/{x}/{y}.png"
232	    with pytest.raises(ValueError):

--------------------------------------------------

Code scanned:
	Total lines of code: 1740
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 0.0
Files skipped (0):
