Run started:2025-04-12 16:58:47.511212

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/__init__.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	            raise RuntimeError(
95	                "\033[91mYour system has an unsupported version of sqlite3. Chroma \
96	                    requires sqlite3 >= 3.35.0.\033[0m\n"
97	                "\033[94mPlease visit \

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/__init__.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
324	        print(
325	            "\033[93mDon't have an API key?\033[0m Get one at https://app.trychroma.com"
326	        )
327	        api_key = input("Please enter your Chroma API key: ")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	                + __version__
123	                + " (https://github.com/chroma-core/chroma)"
124	            )
125	
126	            self._clients[loop_hash] = httpx.AsyncClient(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
147	
148	        response = await self._get_client().request(method, url, **cast(Any, kwargs))
149	        BaseHTTPClient._raise_chroma_error(response)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
154	    async def heartbeat(self) -> int:
155	        response = await self._make_request("get", "")
156	        return int(response["nanosecond heartbeat"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
164	    ) -> None:
165	        await self._make_request(
166	            "post",
167	            f"/tenants/{tenant}/databases",
168	            json={"name": name},
169	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
177	    ) -> Database:
178	        response = await self._make_request(
179	            "get",
180	            f"/tenants/{tenant}/databases/{name}",
181	            params={"tenant": tenant},
182	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
194	    ) -> None:
195	        await self._make_request(
196	            "delete",
197	            f"/tenants/{tenant}/databases/{name}",
198	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
207	    ) -> Sequence[Database]:
208	        response = await self._make_request(
209	            "get",
210	            f"/tenants/{tenant}/databases",
211	            params=BaseHTTPClient._clean_params(
212	                {
213	                    "limit": limit,
214	                    "offset": offset,
215	                }

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
226	    async def create_tenant(self, name: str) -> None:
227	        await self._make_request(
228	            "post",
229	            "/tenants",
230	            json={"name": name},
231	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
235	    async def get_tenant(self, name: str) -> Tenant:
236	        resp_json = await self._make_request(
237	            "get",
238	            "/tenants/" + name,
239	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
245	    async def get_user_identity(self) -> UserIdentity:
246	        return UserIdentity(**(await self._make_request("get", "/auth/identity")))
247	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
256	    ) -> Sequence[CollectionModel]:
257	        resp_json = await self._make_request(
258	            "get",
259	            f"/tenants/{tenant}/databases/{database}/collections",
260	            params=BaseHTTPClient._clean_params(
261	                {
262	                    "limit": limit,
263	                    "offset": offset,
264	                }

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
277	    ) -> int:
278	        resp_json = await self._make_request(
279	            "get",
280	            f"/tenants/{tenant}/databases/{database}/collections_count",
281	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
301	        )
302	        resp_json = await self._make_request(
303	            "post",
304	            f"/tenants/{tenant}/databases/{database}/collections",
305	            json={
306	                "name": name,
307	                "metadata": metadata,
308	                "configuration": config_json,
309	                "get_or_create": get_or_create,
310	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
343	    ) -> CollectionModel:
344	        resp_json = await self._make_request(
345	            "get",
346	            f"/tenants/{tenant}/databases/{database}/collections/{name}",
347	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
384	    ) -> None:
385	        await self._make_request(
386	            "put",
387	            f"/tenants/{tenant}/databases/{database}/collections/{id}",
388	            json={
389	                "new_metadata": new_metadata,
390	                "new_name": new_name,
391	                "new_configuration": update_collection_configuration_to_json(
392	                    new_configuration
393	                )
394	                if new_configuration
395	                else None,
396	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
406	    ) -> None:
407	        await self._make_request(
408	            "delete",
409	            f"/tenants/{tenant}/databases/{database}/collections/{name}",
410	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
420	        """Returns the number of embeddings in the database"""
421	        resp_json = await self._make_request(
422	            "get",
423	            f"/tenants/{tenant}/databases/{database}/collections/{collection_id}/count",
424	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
470	
471	        resp_json = await self._make_request(
472	            "post",
473	            f"/tenants/{tenant}/databases/{database}/collections/{collection_id}/get",
474	            json={
475	                "ids": ids,
476	                "where": where,
477	                "sort": sort,
478	                "limit": limit,
479	                "offset": offset,
480	                "where_document": where_document,
481	                "include": filtered_include,
482	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
505	    ) -> None:
506	        await self._make_request(
507	            "post",
508	            f"/tenants/{tenant}/databases/{database}/collections/{collection_id}/delete",
509	            json={"where": where, "ids": ids, "where_document": where_document},
510	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
527	        """
528	        return await self._make_request(
529	            "post",
530	            url,
531	            json={
532	                "ids": batch[0],
533	                "embeddings": batch[1],
534	                "metadatas": batch[2],
535	                "documents": batch[3],
536	                "uris": batch[4],
537	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
640	
641	        resp_json = await self._make_request(
642	            "post",
643	            f"/tenants/{tenant}/databases/{database}/collections/{collection_id}/query",
644	            json={
645	                "query_embeddings": convert_np_embeddings_to_list(query_embeddings)
646	                if query_embeddings is not None
647	                else None,
648	                "n_results": n_results,
649	                "where": where,
650	                "where_document": where_document,
651	                "include": filtered_include,
652	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
668	    async def reset(self) -> bool:
669	        resp_json = await self._make_request("post", "/reset")
670	        return cast(bool, resp_json)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
674	    async def get_version(self) -> str:
675	        resp_json = await self._make_request("get", "/version")
676	        return cast(str, resp_json)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/async_fastapi.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
685	        if self._max_batch_size == -1:
686	            resp_json = await self._make_request("get", "/pre-flight-checks")
687	            self._max_batch_size = cast(int, resp_json["max_batch_size"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	            + __version__
79	            + " (https://github.com/chroma-core/chroma)"
80	        )
81	
82	        if self._settings.chroma_server_ssl_verify is not None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
104	
105	        response = self._session.request(method, url, **cast(Any, kwargs))
106	        BaseHTTPClient._raise_chroma_error(response)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
112	        """Returns the current server time in nanoseconds to check if the server is alive"""
113	        resp_json = self._make_request("get", "/heartbeat")
114	        return int(resp_json["nanosecond heartbeat"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
124	        """Creates a database"""
125	        self._make_request(
126	            "post",
127	            f"/tenants/{tenant}/databases",
128	            json={"name": name},
129	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
139	        """Returns a database"""
140	        resp_json = self._make_request(
141	            "get",
142	            f"/tenants/{tenant}/databases/{name}",
143	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
155	        """Deletes a database"""
156	        self._make_request(
157	            "delete",
158	            f"/tenants/{tenant}/databases/{name}",
159	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
169	        """Returns a list of all databases"""
170	        json_databases = self._make_request(
171	            "get",
172	            f"/tenants/{tenant}/databases",
173	            params=BaseHTTPClient._clean_params(
174	                {
175	                    "limit": limit,
176	                    "offset": offset,
177	                }

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
188	    def create_tenant(self, name: str) -> None:
189	        self._make_request("post", "/tenants", json={"name": name})
190	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
193	    def get_tenant(self, name: str) -> Tenant:
194	        resp_json = self._make_request("get", "/tenants/" + name)
195	        return Tenant(name=resp_json["name"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
199	    def get_user_identity(self) -> UserIdentity:
200	        return UserIdentity(**self._make_request("get", "/auth/identity"))
201	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
211	        """Returns a list of all collections"""
212	        json_collections = self._make_request(
213	            "get",
214	            f"/tenants/{tenant}/databases/{database}/collections",
215	            params=BaseHTTPClient._clean_params(
216	                {
217	                    "limit": limit,
218	                    "offset": offset,
219	                }

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
234	        """Returns a count of collections"""
235	        resp_json = self._make_request(
236	            "get",
237	            f"/tenants/{tenant}/databases/{database}/collections_count",
238	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
252	        """Creates a collection"""
253	        resp_json = self._make_request(
254	            "post",
255	            f"/tenants/{tenant}/databases/{database}/collections",
256	            json={
257	                "name": name,
258	                "metadata": metadata,
259	                "configuration": create_collection_configuration_to_json(configuration)
260	                if configuration
261	                else None,
262	                "get_or_create": get_or_create,
263	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
295	        """Returns a collection"""
296	        resp_json = self._make_request(
297	            "get",
298	            f"/tenants/{tenant}/databases/{database}/collections/{name}",
299	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
336	        """Updates a collection"""
337	        self._make_request(
338	            "put",
339	            f"/tenants/{tenant}/databases/{database}/collections/{id}",
340	            json={
341	                "new_metadata": new_metadata,
342	                "new_name": new_name,
343	                "new_configuration": update_collection_configuration_to_json(
344	                    new_configuration
345	                )
346	                if new_configuration
347	                else None,
348	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
359	        """Deletes a collection"""
360	        self._make_request(
361	            "delete",
362	            f"/tenants/{tenant}/databases/{database}/collections/{name}",
363	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
373	        """Returns the number of embeddings in the database"""
374	        resp_json = self._make_request(
375	            "get",
376	            f"/tenants/{tenant}/databases/{database}/collections/{collection_id}/count",
377	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
423	
424	        resp_json = self._make_request(
425	            "post",
426	            f"/tenants/{tenant}/databases/{database}/collections/{collection_id}/get",
427	            json={
428	                "ids": ids,
429	                "where": where,
430	                "sort": sort,
431	                "limit": limit,
432	                "offset": offset,
433	                "where_document": where_document,
434	                "include": filtered_include,
435	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
459	        """Deletes embeddings from the database"""
460	        self._make_request(
461	            "post",
462	            f"/tenants/{tenant}/databases/{database}/collections/{collection_id}/delete",
463	            json={
464	                "ids": ids,
465	                "where": where,
466	                "where_document": where_document,
467	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
485	        """
486	        self._make_request(
487	            "post",
488	            url,
489	            json={
490	                "ids": batch[0],
491	                "embeddings": batch[1],
492	                "metadatas": batch[2],
493	                "documents": batch[3],
494	                "uris": batch[4],
495	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
609	        """Gets the nearest neighbors of a single embedding"""
610	        resp_json = self._make_request(
611	            "post",
612	            f"/tenants/{tenant}/databases/{database}/collections/{collection_id}/query",
613	            json={
614	                "query_embeddings": convert_np_embeddings_to_list(query_embeddings)
615	                if query_embeddings is not None
616	                else None,
617	                "n_results": n_results,
618	                "where": where,
619	                "where_document": where_document,
620	                "include": filtered_include,
621	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
638	        """Resets the database"""
639	        resp_json = self._make_request("post", "/reset")
640	        return cast(bool, resp_json)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
645	        """Returns the version of the server"""
646	        resp_json = self._make_request("get", "/version")
647	        return cast(str, resp_json)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/fastapi.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
657	        if self._max_batch_size == -1:
658	            resp_json = self._make_request("get", "/pre-flight-checks")
659	            self._max_batch_size = cast(int, resp_json["max_batch_size"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/models/CollectionCommon.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
564	            raise ValueError(
565	                "You must provide an embedding function to compute embeddings."
566	                "https://docs.trychroma.com/guides/embeddings"
567	            )

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/rust.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
43	
44	if platform.system() != "Windows":
45	    import resource

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/rust.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
43	
44	if platform.system() != "Windows":
45	    import resource

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/rust.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
45	    import resource
46	elif platform.system() == "Windows":
47	    import ctypes

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/rust.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
45	    import resource
46	elif platform.system() == "Windows":
47	    import ctypes

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/rust.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
66	
67	        if platform.system() != "Windows":
68	            max_file_handles = resource.getrlimit(resource.RLIMIT_NOFILE)[0]

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/rust.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
66	
67	        if platform.system() != "Windows":
68	            max_file_handles = resource.getrlimit(resource.RLIMIT_NOFILE)[0]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/api/types.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
621	        raise ValueError(
622	            f"Expected EmbeddingFunction.__call__ to have the following signature: {protocol_signature}, got {function_signature}\n"
623	            "Please see https://docs.trychroma.com/guides/embeddings for details of the EmbeddingFunction interface.\n"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/auth/basic_authn/__init__.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
51	    def authenticate(self) -> ClientAuthHeaders:
52	        encoded = base64.b64encode(
53	            f"{self._creds.get_secret_value()}".encode("utf-8")
54	        ).decode("utf-8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/auth/basic_authn/__init__.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
51	    def authenticate(self) -> ClientAuthHeaders:
52	        encoded = base64.b64encode(
53	            f"{self._creds.get_secret_value()}".encode("utf-8")
54	        ).decode("utf-8")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/auth/basic_authn/__init__.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
112	
113	            base64_decoded = base64.b64decode(_auth_header).decode("utf-8")
114	            if ":" not in base64_decoded:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/auth/basic_authn/__init__.py:113
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
112	
113	            base64_decoded = base64.b64decode(_auth_header).decode("utf-8")
114	            if ":" not in base64_decoded:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/cli/cli.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    try:
24	        url = f"https://api.github.com/repos/chroma-core/chroma/releases"
25	        response = requests.get(url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/cli/cli.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	        url = f"https://api.github.com/repos/chroma-core/chroma/releases"
25	        response = requests.get(url)
26	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/config.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	
35	LEGACY_ERROR = """\033[91mYou are using a deprecated configuration of Chroma.
36	
37	\033[94mIf you do not have data you wish to migrate, you only need to change how you construct
38	your Chroma client. Please see the "New Clients" section of https://docs.trychroma.com/deployment/migration.
39	________________________________________________________________________________________________
40	
41	If you do have data you wish to migrate, we have a migration tool you can use in order to
42	migrate your data to the new Chroma architecture.
43	Please `pip install chroma-migrate` and run `chroma-migrate` to migrate your data and then
44	change how you construct your Chroma client.
45	
46	See https://docs.trychroma.com/deployment/migration for more information or join our discord at https://discord.gg/MMeYNTmh3x for help!\033[0m"""
47	
48	_legacy_config_keys = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/config.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
379	                raise RuntimeError(
380	                    "Chroma is running in http-only client mode, and can only be run with 'chromadb.api.fastapi.FastAPI' or 'chromadb.api.async_fastapi.AsyncFastAPI' as the chroma_api_impl. \
381	            see https://docs.trychroma.com/guides#using-the-python-http-only-client for more information."
382	                )

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/config.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
401	        if settings["chroma_server_nofile"] is not None:
402	            if platform.system() != "Windows":
403	                import resource

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/config.py:402
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
401	        if settings["chroma_server_nofile"] is not None:
402	            if platform.system() != "Windows":
403	                import resource

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/db/impl/grpc/server.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
78	    def start(self) -> None:
79	        self._server = grpc.server(futures.ThreadPoolExecutor(max_workers=10))
80	        add_SysDBServicer_to_server(self, self._server)  # type: ignore

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/distributed/segment_directory.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
37	        self._memberlist = [
38	            Member(id="a", ip="10.0.0.1", node="node1"),
39	            Member(id="b", ip="10.0.0.2", node="node2"),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/distributed/segment_directory.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
38	            Member(id="a", ip="10.0.0.1", node="node1"),
39	            Member(id="b", ip="10.0.0.2", node="node2"),
40	            Member(id="c", ip="10.0.0.3", node="node3"),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/distributed/segment_directory.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
39	            Member(id="b", ip="10.0.0.2", node="node2"),
40	            Member(id="c", ip="10.0.0.3", node="node3"),
41	        ]

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/manager/local.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
37	
38	if platform.system() != "Windows":
39	    import resource

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/manager/local.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
37	
38	if platform.system() != "Windows":
39	    import resource

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/manager/local.py:38
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
37	
38	if platform.system() != "Windows":
39	    import resource

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/manager/local.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
39	    import resource
40	elif platform.system() == "Windows":
41	    import ctypes

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/manager/local.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
39	    import resource
40	elif platform.system() == "Windows":
41	    import ctypes

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/manager/local.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
39	    import resource
40	elif platform.system() == "Windows":
41	    import ctypes

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/manager/local.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
89	            self._vector_segment_type = SegmentType.HNSW_LOCAL_PERSISTED
90	            if platform.system() != "Windows":
91	                self._max_file_handles = resource.getrlimit(resource.RLIMIT_NOFILE)[0]

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/manager/local.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
89	            self._vector_segment_type = SegmentType.HNSW_LOCAL_PERSISTED
90	            if platform.system() != "Windows":
91	                self._max_file_handles = resource.getrlimit(resource.RLIMIT_NOFILE)[0]

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/manager/local.py:90
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
89	            self._vector_segment_type = SegmentType.HNSW_LOCAL_PERSISTED
90	            if platform.system() != "Windows":
91	                self._max_file_handles = resource.getrlimit(resource.RLIMIT_NOFILE)[0]

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/vector/local_persistent_hnsw.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
511	                self.close_persistent_index()
512	                shutil.rmtree(data_path, ignore_errors=True)
513	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/segment/impl/vector/local_persistent_hnsw.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
519	            self.close_persistent_index()
520	            shutil.rmtree(data_path, ignore_errors=False)
521	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/telemetry/product/__init__.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	                    new_user_id = str(uuid.uuid4())
90	                    f.write(new_user_id)
91	                self._curr_user_id = new_user_id

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/telemetry/product/__init__.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
93	                with open(self.USER_ID_PATH, "r") as f:
94	                    self._curr_user_id = f.read()
95	        except Exception:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/telemetry/product/posthog.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	            logger.info(
23	                "Anonymized telemetry enabled. See \
24	                    https://docs.trychroma.com/telemetry for more information."
25	            )

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/client/test_cloud_client.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
54	    ctx = multiprocessing.get_context("spawn")
55	    proc = ctx.Process(target=_run_server, args=args, daemon=True)
56	    proc.start()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/client/test_multiple_clients_concurrency.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
35	
36	    with ThreadPoolExecutor(max_workers=CLIENT_COUNT) as executor:
37	        executor.map(run_target, range(CLIENT_COUNT))

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:172
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
171	def find_free_port() -> int:
172	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
173	        s.bind(("", 0))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
230	        server.app(),
231	        host="0.0.0.0",
232	        port=port,

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
299	    def run(args: Any) -> Generator[System, None, None]:
300	        proc = ctx.Process(target=_run_server, args=args, daemon=True)
301	        proc.start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
409	    with tempfile.NamedTemporaryFile("w", suffix=".htpasswd", delete=False) as f:
410	        f.write("admin:$2y$05$e5sRb6NCcSH3YfbIxe1AGu2h5K7OOd982OXKmd8WyQ3DRQ4MvpnZS\n")
411	        f.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
409	    with tempfile.NamedTemporaryFile("w", suffix=".htpasswd", delete=False) as f:
410	        f.write("admin:$2y$05$e5sRb6NCcSH3YfbIxe1AGu2h5K7OOd982OXKmd8WyQ3DRQ4MvpnZS\n")
411	        f.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
410	        f.write("admin:$2y$05$e5sRb6NCcSH3YfbIxe1AGu2h5K7OOd982OXKmd8WyQ3DRQ4MvpnZS\n")
411	        f.close()
412	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
432	        for user, cred in creds.items():
433	            f.write(f"{user}:{cred}\n")
434	        f.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
432	        for user, cred in creds.items():
433	            f.write(f"{user}:{cred}\n")
434	        f.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
433	            f.write(f"{user}:{cred}\n")
434	        f.close()
435	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
447	    with tempfile.NamedTemporaryFile("w", suffix=".htpasswd", delete=False) as f:
448	        f.write("admin:$2y$05$e5sRb6NCcSH3YfbIxe1AGu2h5K7OOd982OXKmd8WyQ3DRQ4MvpnZS\n")
449	        f.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
447	    with tempfile.NamedTemporaryFile("w", suffix=".htpasswd", delete=False) as f:
448	        f.write("admin:$2y$05$e5sRb6NCcSH3YfbIxe1AGu2h5K7OOd982OXKmd8WyQ3DRQ4MvpnZS\n")
449	        f.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
448	        f.write("admin:$2y$05$e5sRb6NCcSH3YfbIxe1AGu2h5K7OOd982OXKmd8WyQ3DRQ4MvpnZS\n")
449	        f.close()
450	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
464	    ) as server_authn_file:
465	        server_authn_file.write(
466	            "admin:$2y$05$e5sRb6NCcSH3YfbIxe1AGu2h5K7OOd982OXKmd8WyQ3DRQ4MvpnZS\n"
467	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
464	    ) as server_authn_file:
465	        server_authn_file.write(
466	            "admin:$2y$05$e5sRb6NCcSH3YfbIxe1AGu2h5K7OOd982OXKmd8WyQ3DRQ4MvpnZS\n"
467	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
467	        )
468	        server_authn_file.close()
469	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
472	        ) as server_authz_file:
473	            server_authz_file.write(
474	                """
475	roles_mapping:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
472	        ) as server_authz_file:
473	            server_authz_file.write(
474	                """
475	roles_mapping:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
503	            )
504	            server_authz_file.close()
505	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
521	    with tempfile.NamedTemporaryFile("w", suffix=".authn", delete=False) as f:
522	        f.write(
523	            """
524	users:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
521	    with tempfile.NamedTemporaryFile("w", suffix=".authn", delete=False) as f:
522	        f.write(
523	            """
524	users:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
535	        )
536	        f.close()
537	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:842
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
841	
842	        client = ClientCreator.from_system(self._system)
843	        self._created_clients.append(client)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
859	        ):
860	            return cast(AdminClient, AsyncAdminClientSync.from_system(self._system))
861	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:862
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
861	
862	        return AdminClient.from_system(self._system)
863	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
887	    else:
888	        client = ClientCreator.from_system(system)
889	        client.reset()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
905	    else:
906	        client = ClientCreator.from_system(system_http_server)
907	        yield client

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/conftest.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
913	    system_ssl.reset_state()
914	    client = ClientCreator.from_system(system_ssl)
915	    yield client

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/ef/test_default_ef.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
73	    ef = ONNXMiniLM_L6_V2()
74	    shutil.rmtree(ef.DOWNLOAD_PATH)  # clean up any existing models
75	    with pytest.raises(ValueError) as e:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/ef/test_default_ef.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
82	    ef = ONNXMiniLM_L6_V2()
83	    shutil.rmtree(ef.DOWNLOAD_PATH, ignore_errors=True)  # clean up any existing models
84	    os.makedirs(ef.DOWNLOAD_PATH, exist_ok=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/ef/test_default_ef.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
86	    with open(path, "wb") as f:  # create invalid file to simulate partial download
87	        f.write(b"invalid")
88	    ef._download_model_if_not_exists()  # re-download model

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/ef/test_ollama_ef.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    pytest.importorskip("ollama", reason="ollama not installed")
28	    ef = OllamaEmbeddingFunction(url="http://localhost:11434/api/embeddings")
29	    embeddings = ef(["Here is an article about llamas...", "this is another article"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/ef/test_ollama_ef.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    pytest.importorskip("ollama", reason="ollama not installed")
35	    ef = OllamaEmbeddingFunction(url="http://localhost:11434/this_is_wrong")
36	    with pytest.raises(Exception) as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/ef/test_onnx_mini_lm_l6_v2.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	                    ef._download(
124	                        url="https://test.url",
125	                        fname=os.path.join(temp_dir, "test_file"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_cross_version_persist.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	    """Returns the pinned minimum version and the latest version of chromadb."""
46	    url = "https://pypi.org/pypi/chromadb/json"
47	    data = json.load(request.urlopen(request.Request(url)))

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_cross_version_persist.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
46	    url = "https://pypi.org/pypi/chromadb/json"
47	    data = json.load(request.urlopen(request.Request(url)))
48	    versions = list(data["releases"].keys())

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_cross_version_persist.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
157	    path = get_path_to_version_install(version)
158	    shutil.rmtree(path)
159	    # Cleanup the persisted data

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_cross_version_persist.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
161	    if os.path.exists(data_path):
162	        shutil.rmtree(data_path, ignore_errors=True)
163	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_cross_version_persist.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
196	        if packaging_version.Version(version) >= packaging_version.Version("0.5.4"):
197	            api = old_module.api.client.Client.from_system(system)
198	        coll = api.create_collection(

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_cross_version_persist.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
283	    conn1, conn2 = multiprocessing.Pipe()
284	    p = ctx.Process(
285	        target=persist_generated_data_with_old_version,
286	        args=(version, settings, collection_strategy, embeddings_strategy, conn2),
287	    )

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_cross_version_persist.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
300	    system.start()
301	    client = ClientCreator.from_system(system)
302	    coll = client.get_collection(

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_persist.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
117	    system_1.start()
118	    client_1 = ClientCreator.from_system(system_1)
119	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_persist.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
148	    system_2.start()
149	    client_2 = ClientCreator.from_system(system_2)
150	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_persist.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
176	    system.start()
177	    client = ClientCreator.from_system(system)
178	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_persist.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
241	        system.start()
242	        client = ClientCreator.from_system(system)
243	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_persist.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
314	        ctx = get_multiprocessing_context()  # type: ignore[no-untyped-call]
315	        p = ctx.Process(
316	            target=load_and_check,
317	            args=(self.settings, collection_name, self.record_set_state, conn2),
318	        )

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_restart_persist.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
38	        self.system = system
39	        client = Client.from_system(system)
40	        super().__init__(client)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/property/test_restart_persist.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
66	        self.client.clear_system_cache()
67	        self.client = Client.from_system(self.system)
68	        self.collection = self.client.get_collection(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_api.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
43	    if os.path.exists(persist_dir):
44	        shutil.rmtree(persist_dir, ignore_errors=True)
45	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_api.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
64	    if os.path.exists(persist_dir):
65	        shutil.rmtree(persist_dir, ignore_errors=True)
66	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_api.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	    "embeddings": [[1.1, 2.3, 3.2], [1.2, 2.24, 3.2]],
240	    "ids": ["https://example.com/1", "https://example.com/2"],
241	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_api.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	    "embeddings": [[1.1, 2.3, 3.2], [1.2, 2.24, 3.2]],
240	    "ids": ["https://example.com/1", "https://example.com/2"],
241	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_api.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	    "embeddings": [[1.1, 2.3, 3.2], [1.2, 2.24, 3.2]],
282	    "ids": ["https://example.com/1", "https://example.com/2"],
283	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_api.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	    "embeddings": [[1.1, 2.3, 3.2], [1.2, 2.24, 3.2]],
282	    "ids": ["https://example.com/1", "https://example.com/2"],
283	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_api.py:1326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1325	        embeddings=large_records,
1326	        ids=[f"http://example.com/{i}" for i in range(len(large_records))],
1327	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_api.py:1365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1364	    embeddings2 = np.random.rand(10, 512).astype(np.float32).tolist()
1365	    ids1 = [f"http://example.com/1/{i}" for i in range(len(embeddings1))]
1366	    ids2 = [f"http://example.com/2/{i}" for i in range(len(embeddings2))]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_api.py:1366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1365	    ids1 = [f"http://example.com/1/{i}" for i in range(len(embeddings1))]
1366	    ids2 = [f"http://example.com/2/{i}" for i in range(len(embeddings2))]
1367	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_cli.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
30	    print(args)
31	    server_process = multiprocessing.Process(target=start_app, args=(args,))
32	    server_process.start()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_cli.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
54	    # Add some data
55	    client = Client.from_system(system)
56	    collection1 = client.create_collection("collection1")

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_cli.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
118	    shutdown_event = ctx.Event()
119	    process = ctx.Process(
120	        target=simulate_transactional_write,
121	        args=(sqlite_persistent.settings, ready_event, shutdown_event),
122	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_client.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
89	    try:
90	        http_api_factory(settings=Settings(chroma_server_host="127.0.0.1"))
91	    except ValueError as e:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_multithreaded.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
54	    coll = client.create_collection(name="test", metadata=test_hnsw_config)
55	    with ThreadPoolExecutor(max_workers=num_workers) as executor:
56	        futures: List[Future[Any]] = []

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/test/test_multithreaded.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
169	
170	    with ThreadPoolExecutor(max_workers=num_workers) as executor:
171	        futures: List[Future[Any]] = []

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/data_loaders.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
22	    def __call__(self, uris: Sequence[Optional[URI]]) -> List[Optional[Image]]:
23	        with ThreadPoolExecutor(max_workers=self._max_workers) as executor:
24	            return list(executor.map(self._load_image, uris))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/huggingface_embedding_function.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	
43	        self._api_url = f"https://api-inference.huggingface.co/pipeline/feature-extraction/{model_name}"
44	        self._session = httpx.Client()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/jina_embedding_function.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	
43	        self._api_url = "https://api.jina.ai/v1/embeddings"
44	        self._session = httpx.Client()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/ollama_embedding_function.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        self,
18	        url: str = "http://localhost:11434",
19	        model_name: str = DEFAULT_MODEL_NAME,
20	        timeout: int = 60,
21	    ) -> None:
22	        """

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/onnx_mini_lm_l6_v2.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
22	    sha256_hash = hashlib.sha256()
23	    with open(fname, "rb") as f:
24	        # Read and update hash in chunks to avoid using too much memory

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/onnx_mini_lm_l6_v2.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	        # Read and update hash in chunks to avoid using too much memory
25	        for byte_block in iter(lambda: f.read(4096), b""):
26	            sha256_hash.update(byte_block)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/onnx_mini_lm_l6_v2.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    MODEL_DOWNLOAD_URL = (
42	        "https://chroma-onnx-models.s3.amazonaws.com/all-MiniLM-L6-v2/onnx.tar.gz"
43	    )
44	    _MODEL_SHA256 = "913d7300ceae3b2dbc2c50d1de4baacab4be7b9380491c27fab7418616a16ec3"
45	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/onnx_mini_lm_l6_v2.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
107	            total = int(resp.headers.get("content-length", 0))
108	            with open(fname, "wb") as file, self.tqdm(
109	                desc=str(fname),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/onnx_mini_lm_l6_v2.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	                for data in resp.iter_bytes(chunk_size=chunk_size):
116	                    size = file.write(data)
117	                    bar.update(size)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/onnx_mini_lm_l6_v2.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
299	            ):
300	                self._download(
301	                    url=self.MODEL_DOWNLOAD_URL,
302	                    fname=os.path.join(self.DOWNLOAD_PATH, self.ARCHIVE_FILENAME),
303	                )

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/onnx_mini_lm_l6_v2.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
303	                )
304	            with tarfile.open(
305	                name=os.path.join(self.DOWNLOAD_PATH, self.ARCHIVE_FILENAME),
306	                mode="r:gz",
307	            ) as tar:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/open_clip_embedding_function.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	            raise ValueError(
45	                "The open_clip python package is not installed. Please install it with `pip install open-clip-torch`. https://github.com/mlfoundations/open_clip"
46	            )
47	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/roboflow_embedding_function.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        api_key: Optional[str] = None,
28	        api_url: str = "https://infer.roboflow.com",
29	        api_key_env_var: str = "CHROMA_ROBOFLOW_API_KEY",
30	    ) -> None:
31	        """
32	        Create a RoboflowEmbeddingFunction.

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/roboflow_embedding_function.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
74	                image.save(buffer, format="JPEG")
75	                base64_image = base64.b64encode(buffer.getvalue()).decode("utf-8")
76	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chromadb-1.0.4/chromadb-1.0.4/chromadb/utils/embedding_functions/roboflow_embedding_function.py:75
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
74	                image.save(buffer, format="JPEG")
75	                base64_image = base64.b64encode(buffer.getvalue()).decode("utf-8")
76	

--------------------------------------------------

Code scanned:
	Total lines of code: 31484
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 122.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 154.0
		High: 11.0
Files skipped (0):
