Run started:2025-04-12 11:18:29.087924

Test results:
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/plugin.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
54	    yield loop
55	    loop.close()
56	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/plugin.py:163
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
162	def unused_port():
163	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
164	        s.bind(('127.0.0.1', 0))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/plugin.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
163	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
164	        s.bind(('127.0.0.1', 0))
165	        return s.getsockname()[1]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/plugin.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
188	        for server in servers:
189	            loop.run_until_complete(server.close())
190	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/plugin.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
211	        for client in clients:
212	            loop.run_until_complete(client.close())
213	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/plugin.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
232	        for client in clients:
233	            loop.run_until_complete(client.close())
234	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
38	
39	    def __init__(self, app, host='127.0.0.1',
40	                 loop=None, protocol=None,
41	                 backlog=100, ssl=None,
42	                 scheme=None, connections=None,
43	                 **kwargs):
44	        if not isinstance(app, Sanic):

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:78
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
77	    async def start_server(self):
78	        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
79	        self.socket.bind((self.host, 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
125	            # Stop Server
126	            self.server.close()
127	            await self.server.wait_closed()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
137	                else:
138	                    conn.close()
139	            await asyncio.gather(*coros)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
170	    def __init__(self, app, loop=None,
171	                 host='127.0.0.1',
172	                 protocol=None,
173	                 ssl=None,
174	                 scheme=None,
175	                 **kwargs):
176	        if not isinstance(app, Sanic):
177	            raise TypeError("app should be a Sanic application.")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
234	            for resp in self._responses:
235	                await resp.aclose()
236	            for ws in self._websockets:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
236	            for ws in self._websockets:
237	                await ws.close()
238	            await self._session.aclose()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
237	                await ws.close()
238	            await self._session.aclose()
239	            await self._server.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
238	            await self._session.aclose()
239	            await self._server.close()
240	            self._closed = True

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
243	        url = self._server.make_url(uri)
244	        response = await self._session.request(
245	                method, url, *args, **kwargs
246	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
250	    async def get(self, uri, *args, **kwargs):
251	        return await self._request(GET, uri, *args, **kwargs)
252	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
253	    async def post(self, uri, *args, **kwargs):
254	        return await self._request(POST, uri, *args, **kwargs)
255	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
256	    async def put(self, uri, *args, **kwargs):
257	        return await self._request(PUT, uri, *args, **kwargs)
258	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
259	    async def delete(self, uri, *args, **kwargs):
260	        return await self._request(DELETE, uri, *args, **kwargs)
261	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
262	    async def patch(self, uri, *args, **kwargs):
263	        return await self._request(PATCH, uri, *args, **kwargs)
264	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
265	    async def options(self, uri, *args, **kwargs):
266	        return await self._request(OPTIONS, uri, *args, **kwargs)
267	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
268	    async def head(self, uri, *args, **kwargs):
269	        return await self._request(HEAD, uri, *args, **kwargs)
270	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
275	        url = self._server.make_url(uri)
276	        ws_conn = await websockets.connect(url, *args, **kwargs)
277	        # Save it, clean up later.

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_sanic-1.9.1-py3-none-any/pytest_sanic/utils.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
286	    async def __aexit__(self, exc_type, exc_value, traceback):
287	        await self.close()

--------------------------------------------------

Code scanned:
	Total lines of code: 392
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 2.0
Files skipped (0):
