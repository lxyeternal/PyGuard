Run started:2025-04-12 11:38:58.970860

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/bin/build_js_bundle.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
51	    subprocess.check_call("npm run build -- --mode preview", cwd=HTML_RENDERER_DIR, shell=True)
52	    shutil.rmtree(DOCS_PREVIEW_DIR, ignore_errors=True)
53	    shutil.copytree(HTML_RENDERER_DIR + "/dist", DOCS_PREVIEW_DIR)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/bin/bump_version.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        url_opts = urllib.parse.urlencode({"q": f"is:pr merged:>{cd_date}T{cd_time}{cd_tz}"})
50	        url = f"https://github.com/joerick/pyinstrument/pulls?{url_opts}"
51	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/bin/bump_version.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	        print("error: This version doesn't conform to PEP440")
74	        print("       https://www.python.org/dev/peps/pep-0440/")
75	        sys.exit(1)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/__main__.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
382	            sys.argv[:] = argv
383	            exec(code, globs, None)
384	        except (SystemExit, KeyboardInterrupt) as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/__main__.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
395	    else:
396	        f.write(renderer.render(session))
397	        if should_close_f_after_writing:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/magic/magic.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	        default=0.001,
123	        help="The minimum time, in seconds, between each stack sample. See: https://pyinstrument.readthedocs.io/en/latest/reference.html#pyinstrument.Profiler.interval",
124	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/magic/magic.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
132	        default="disabled",
133	        help="Configures how this Profiler tracks time in a program that uses async/await. See: https://pyinstrument.readthedocs.io/en/latest/reference.html#pyinstrument.Profiler.async_mode",
134	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/magic/magic.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
281	        try:
282	            threading.Thread(target=loop.run_forever).start()
283	            asyncio.set_event_loop(loop)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/middleware.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
91	                with open(file_path, "w", encoding="utf-8") as f:
92	                    f.write(output)
93	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/renderers/html.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
97	            with codecs.getwriter("utf-8")(output_file) as f:
98	                f.write(self.render(session))
99	        else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/renderers/html.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
100	            with codecs.open(output_filename, "w", "utf-8") as f:
101	                f.write(self.render(session))
102	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/renderers/speedscope.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	    shared: dict[str, list[SpeedscopeFrame]]
75	    schema: str = "https://www.speedscope.app/file-format-schema.json"
76	    active_profile_index: None = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/session.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	ASSERTION_MESSAGE = (
18	    "Please raise an issue at https://github.com/joerick/pyinstrument/issues and "
19	    "let me know how you caused this error!"
20	)
21	
22	
23	class Session:
24	    def __init__(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/stack_sampler.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
302	
303	    thread = threading.current_thread()
304	    thread_identifier = "%s\x00%s\x00%i" % (thread.name, "<thread>", thread.ident)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/pyinstrument/vendor/decorator.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
179	            code = compile(src, filename, 'single')
180	            exec(code, evaldict)
181	        except Exception:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/setup.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    author_email="joerick@mac.com",
28	    url="https://github.com/joerick/pyinstrument",
29	    keywords=["profiling", "profile", "profiler", "cpu", "time", "sampling"],

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/test/low_level/test_floatclock.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
7	
8	lib = ctypes.CDLL(native_module.__file__)
9	

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/test/low_level/test_timing_thread.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
9	
10	lib = ctypes.CDLL(native_module.__file__)
11	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/test/test_cmdline.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
75	        program_path.write_text(BUSY_WAIT_SCRIPT)
76	        program_path.chmod(0x755)
77	        monkeypatch.setenv("PATH", str(tmp_path), prepend=os.pathsep)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/test/test_cmdline.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
165	        program_path.write_text(EXECUTION_DETAILS_SCRIPT)
166	        program_path.chmod(0x755)
167	        monkeypatch.setenv("PATH", str(tmp_path), prepend=os.pathsep)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/test/test_profiler.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
206	
207	    assert output["$schema"] == "https://www.speedscope.app/file-format-schema.json"
208	    assert "pyinstrument" in output["exporter"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/test/test_pstats_renderer.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	    with open(fname, "wb") as fid:
51	        fid.write(pstats_data.encode(encoding="utf-8", errors="surrogateescape"))
52	    stats: Any = Stats(str(fname))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/test/test_pstats_renderer.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	    with open(file, mode="w", encoding="utf-8", errors="surrogateescape", newline="") as f:
98	        f.write(data_blob_string)
99	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyinstrument-5.0.1/pyinstrument-5.0.1/test/test_pstats_renderer.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	    with open(fname, "wb") as fid:
128	        fid.write(pstats_data.encode(encoding="utf-8", errors="surrogateescape"))
129	    stats: Any = Stats(str(fname))

--------------------------------------------------

Code scanned:
	Total lines of code: 6599
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 2.0
Files skipped (0):
