Run started:2025-04-12 10:15:10.333410

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
113	        szhdr = struct.pack(self.szhdr_format, len(string))
114	        os.write(self.headf.fileno(), szhdr + string)
115	        if hpos == self.chunksize:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
130	        tfd = self.tailf.fileno()
131	        szhdr = os.read(tfd, self.szhdr_size)
132	        if not szhdr:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	        (size,) = struct.unpack(self.szhdr_format, szhdr)
135	        data = os.read(tfd, size)
136	        tcnt += 1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
153	        tfd_initial_pos = os.lseek(tfd, 0, os.SEEK_CUR)
154	        szhdr = os.read(tfd, self.szhdr_size)
155	        if not szhdr:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
157	        (size,) = struct.unpack(self.szhdr_format, szhdr)
158	        data = os.read(tfd, size)
159	        os.lseek(tfd, tfd_initial_pos, os.SEEK_SET)

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
195	        with suppress(OSError):
196	            Path(self.path).rmdir()
197	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
209	            self.f = Path(path).open("rb+")  # noqa: SIM115
210	            qsize = self.f.read(self.SIZE_SIZE)
211	            (self.size,) = struct.unpack(self.SIZE_FORMAT, qsize)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
214	            self.f = Path(path).open("wb+")  # noqa: SIM115
215	            self.f.write(struct.pack(self.SIZE_FORMAT, 0))
216	            self.size = 0

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
220	            raise TypeError(f"Unsupported type: {type(string).__name__}")
221	        self.f.write(string)
222	        ssize = struct.pack(self.SIZE_FORMAT, len(string))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
222	        ssize = struct.pack(self.SIZE_FORMAT, len(string))
223	        self.f.write(ssize)
224	        self.size += 1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
229	        self.f.seek(-self.SIZE_SIZE, os.SEEK_END)
230	        (size,) = struct.unpack(self.SIZE_FORMAT, self.f.read())
231	        self.f.seek(-size - self.SIZE_SIZE, os.SEEK_END)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
231	        self.f.seek(-size - self.SIZE_SIZE, os.SEEK_END)
232	        data = self.f.read(size)
233	        self.f.seek(-size, os.SEEK_CUR)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
241	        self.f.seek(-self.SIZE_SIZE, os.SEEK_END)
242	        (size,) = struct.unpack(self.SIZE_FORMAT, self.f.read())
243	        self.f.seek(-size - self.SIZE_SIZE, os.SEEK_END)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
243	        self.f.seek(-size - self.SIZE_SIZE, os.SEEK_END)
244	        return self.f.read(size)
245	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/queue.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
248	            self.f.seek(0)
249	            self.f.write(struct.pack(self.SIZE_FORMAT, self.size))
250	        self.f.close()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/tests/__init__.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
13	    def tearDown(self) -> None:
14	        shutil.rmtree(self.qdir)
15	        shutil.rmtree(self.tmpdir)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/queuelib-1.8.0/queuelib-1.8.0/queuelib/tests/__init__.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
14	        shutil.rmtree(self.qdir)
15	        shutil.rmtree(self.tmpdir)
16	

--------------------------------------------------

Code scanned:
	Total lines of code: 1084
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 0.0
Files skipped (0):
