Run started:2025-04-12 14:38:22.226456

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
25	    with codecs.open(filepath, "rb", "utf-8") as file_handle:
26	        return file_handle.read()
27	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/setup.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	    author_email="development@svix.com",
92	    url="https://www.svix.com",
93	    license="MIT",

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/api/common.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
141	
142	        response = await self._httpx_async_client.request(**httpx_kwargs)
143	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/api/common.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
149	            httpx_kwargs["headers"]["svix-retry-count"] = str(retry_count)
150	            response = await self._httpx_async_client.request(**httpx_kwargs)
151	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/api/common.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
171	
172	        response = self._httpx_client.request(**httpx_kwargs)
173	        for retry_count, sleep_time in enumerate(self._client.retry_schedule):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/api/common.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
178	            httpx_kwargs["headers"]["svix-retry-count"] = str(retry_count)
179	            response = self._httpx_client.request(**httpx_kwargs)
180	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/api/svix.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	
22	DEFAULT_SERVER_URL = "https://api.svix.com"
23	
24	
25	@dataclass
26	class SvixOptions:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/api/svix.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        if region == "us":
61	            regional_url = "https://api.us.svix.com"
62	        elif region == "eu":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/api/svix.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	        elif region == "eu":
63	            regional_url = "https://api.eu.svix.com"
64	        elif region == "in":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/api/svix.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	        elif region == "in":
65	            regional_url = "https://api.in.svix.com"
66	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/webhooks.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
28	                whsecret = whsecret[len(self._SECRET_PREFIX) :]
29	            self._whsecret = base64.b64decode(whsecret)
30	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/webhooks.py:29
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
28	                whsecret = whsecret[len(self._SECRET_PREFIX) :]
29	            self._whsecret = base64.b64decode(whsecret)
30	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/webhooks.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
48	
49	        expected_sig = base64.b64decode(
50	            self.sign(msg_id=msg_id, timestamp=timestamp, data=data).split(",")[1]
51	        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/webhooks.py:49
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
48	
49	        expected_sig = base64.b64decode(
50	            self.sign(msg_id=msg_id, timestamp=timestamp, data=data).split(",")[1]
51	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/webhooks.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
56	                continue
57	            sig_bytes = base64.b64decode(signature)
58	            if hmac.compare_digest(expected_sig, sig_bytes):

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/webhooks.py:57
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
56	                continue
57	            sig_bytes = base64.b64decode(signature)
58	            if hmac.compare_digest(expected_sig, sig_bytes):

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/webhooks.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
66	        signature = hmac_data(self._whsecret, to_sign)
67	        return f"v1,{base64.b64encode(signature).decode('utf-8')}"
68	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/svix/webhooks.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
66	        signature = hmac_data(self._whsecret, to_sign)
67	        return f"v1,{base64.b64encode(signature).decode('utf-8')}"
68	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_client.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	def endpoint_url() -> str:
49	    return "http://localhost/webhook/receiver"
50	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_client.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
211	
212	    httpserver.expect_oneshot_request(
213	        endpoint_path,
214	        method="POST",
215	        json=payload,
216	    ).respond_with_handler(webhook_handler)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_httpretty.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	def test_octothorpe_in_query_param():
9	    svx = svix.Svix("token",svix.SvixOptions(server_url="http://test.example"))
10	    httpretty.register_uri(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_httpretty.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	        httpretty.GET,
12	        "http://test.example/api/v1/app/app_id/msg?tag=test%23test",
13	        body='{"data":[],"iterator":null,"prevIterator":null,"done":true}'
14	    )
15	    svx.message.list("app_id",MessageListOptions(tag="test#test"))
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_httpretty.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	def test_struct_enum_with_fields():
19	    svx = svix.Svix("token", svix.SvixOptions(server_url="http://test.example"))
20	    ingest_source = IngestSource(svx._client)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_httpretty.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        httpretty.POST,
23	        "http://test.example/ingest/api/v1/source",
24	        body='{"type":"cron","config":{"content_type":"mendy/tired","payload":"@hello there","schedule":"* * * * *"},"id":"src_2yZwUhtgs5Ai8T9yRQJXA","uid":"unique-identifier","name":"string","ingestUrl":"http://example.com","createdAt":"2019-08-24T14:15:22Z","updatedAt":"2019-08-24T14:15:22Z"}',
25	    )
26	    source_in = IngestSourceIn(
27	        name="name",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_httpretty.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        "http://test.example/ingest/api/v1/source",
24	        body='{"type":"cron","config":{"content_type":"mendy/tired","payload":"@hello there","schedule":"* * * * *"},"id":"src_2yZwUhtgs5Ai8T9yRQJXA","uid":"unique-identifier","name":"string","ingestUrl":"http://example.com","createdAt":"2019-08-24T14:15:22Z","updatedAt":"2019-08-24T14:15:22Z"}',
25	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_httpretty.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	def test_struct_enum_without_fields():
41	    svx = svix.Svix("token", svix.SvixOptions(server_url="http://test.example"))
42	    ingest_source = IngestSource(svx._client)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_httpretty.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        httpretty.POST,
45	        "http://test.example/ingest/api/v1/source",
46	        body='{"type":"generic-webhook","config":{},"id":"src_2yZwUhtgs5Ai8T9yRQJXA","uid":"unique-identifier","name":"string","ingestUrl":"http://example.com","createdAt":"2019-08-24T14:15:22Z","updatedAt":"2019-08-24T14:15:22Z"}',
47	    )
48	    source_in = IngestSourceIn(name="name", type="generic-webhook", config={})
49	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_httpretty.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        "http://test.example/ingest/api/v1/source",
46	        body='{"type":"generic-webhook","config":{},"id":"src_2yZwUhtgs5Ai8T9yRQJXA","uid":"unique-identifier","name":"string","ingestUrl":"http://example.com","createdAt":"2019-08-24T14:15:22Z","updatedAt":"2019-08-24T14:15:22Z"}',
47	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_kitchen_sink.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    ep = CLIENT.endpoint.create(
45	        app.id, EndpointIn(url="https://example.svix.com/", channels=["ch0", "ch1"])
46	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_openapi.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3	def test_openapi_json_is_available(svix_server_url: str) -> None:
4	    r = requests.get(f"{svix_server_url}/api/v1/openapi.json")
5	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_webhooks.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
26	        to_sign = f"{defaultMsgID}.{ts}.{defaultPayload}".encode()
27	        signature = base64.b64encode(
28	            hmac_data(base64.b64decode(defaultSecret), to_sign)
29	        ).decode("utf-8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_webhooks.py:27
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
26	        to_sign = f"{defaultMsgID}.{ts}.{defaultPayload}".encode()
27	        signature = base64.b64encode(
28	            hmac_data(base64.b64decode(defaultSecret), to_sign)
29	        ).decode("utf-8")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_webhooks.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
27	        signature = base64.b64encode(
28	            hmac_data(base64.b64decode(defaultSecret), to_sign)
29	        ).decode("utf-8")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/svix-1.64.0/svix-1.64.0/tests/test_webhooks.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
27	        signature = base64.b64encode(
28	            hmac_data(base64.b64decode(defaultSecret), to_sign)
29	        ).decode("utf-8")

--------------------------------------------------

Code scanned:
	Total lines of code: 6974
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 6.0
Files skipped (0):
