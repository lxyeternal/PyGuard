Run started:2025-04-12 15:45:48.166000

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1121	        # Add in any headers specified in keyword arguments:
1122	        headers = kwargs.get('headers', {})
1123	        req_kw.update({

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1135	            try:
1136	                response = self.parent.request(method, full_url, **req_kw)
1137	                self.postprocess(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1152	            status = response.status_code
1153	            retry_logic = self.retry.get(status, 0)
1154	            if not response.ok and retry_logic != 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1157	                    # Retry a specific number of times (-1 implies infinite)
1158	                    if http_attempts.get(status, 0)>=retry_logic or \
1159	                            sum(http_attempts.values())>self.max_http_attempts:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1168	                        return response
1169	                    http_attempts[status] = 1 + http_attempts.get(status, 0)
1170	                sleep_timer *= self.cooldown_factor()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1261	
1262	    url = "https://events.pagerduty.com"
1263	
1264	    def __init__(self, api_key: str, debug=False):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1346	        response = successful_response(
1347	            self.post('/v2/enqueue', json=event),
1348	            context='submitting an event to the events API',

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1365	            kw['json'].update({'routing_key': self.api_key})
1366	        return super(EventsAPISession, self).post(*args, **kw)
1367	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1415	        if type(custom_details) is dict:
1416	            details = event.setdefault('payload', {}).get('custom_details', {})
1417	            details.update(custom_details)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1440	
1441	    url = "https://events.pagerduty.com"
1442	
1443	    def __init__(self, api_key: str, debug=False):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1486	        event = deepcopy(properties)
1487	        response = self.post('/v2/change/enqueue', json=event)
1488	        response_body = try_decoding(successful_response(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1491	        ))
1492	        return response_body.get("id", None)
1493	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1582	
1583	    url = 'https://api.pagerduty.com'
1584	    """Base URL of the REST API"""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1612	        if not hasattr(self, '_api_key_access') or self._api_key_access is None:
1613	            response = self.get('/users/me')
1614	            if response.status_code == 400:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1614	            if response.status_code == 400:
1615	                message = try_decoding(response).get('error', '')
1616	                if 'account-level access token' in message:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1809	        if params is not None:
1810	            offset = int(params.get('offset', 0))
1811	        n = 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1827	            r = successful_response(
1828	                self.get(url, params=data.copy()),
1829	                context='classic pagination'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1901
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1900	            r = successful_response(
1901	                self.get(url, params=user_params),
1902	                context='cursor-based pagination',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1913	            # Advance to the next page
1914	            next_cursor = body.get('next_cursor', None)
1915	            more = bool(next_cursor)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1922	        """
1923	        return self.get(url, **kw)
1924	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1931
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1930	        """
1931	        return self.post(url, **kw)
1932	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:1996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1995	        else:
1996	            return self.rpost(resource, json=values)
1997	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:2013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2012	        status = response.status_code
2013	        request_date = response.headers.get('date', '(missing header)')
2014	        request_id = response.headers.get('x-request-id', '(missing header)')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:2014
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2013	        request_date = response.headers.get('date', '(missing header)')
2014	        request_id = response.headers.get('x-request-id', '(missing header)')
2015	        request_time = response.elapsed.total_seconds()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:2085
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2084	        """
2085	        return self.get(resource, **kw)
2086	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:2103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2102	        """
2103	        return self.post(path, **kw)
2104	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/pdpyras.py:2133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2132	            try:
2133	                url = self.rget('users', params={'limit':1})[0]['html_url']
2134	                self._subdomain = url.split('/')[2].split('.')[0]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	        license='MIT',
13	        url='https://pagerduty.github.io/pdpyras',
14	        download_url='https://pypi.org/project/pdpyras/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pdpyras-5.4.0/pdpyras-5.4.0/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        url='https://pagerduty.github.io/pdpyras',
14	        download_url='https://pypi.org/project/pdpyras/',
15	        install_requires=['requests', 'urllib3'],

--------------------------------------------------

Code scanned:
	Total lines of code: 1827
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 24.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 0.0
Files skipped (0):
