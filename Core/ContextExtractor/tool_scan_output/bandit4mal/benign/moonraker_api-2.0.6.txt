Run started:2025-04-12 13:25:22.633601

Test results:
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/moonraker_api/moonrakerclient.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
78	        """
79	        async with self.request(method, **kwargs) as req:
80	            return await req.get_result()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/moonraker_api/websockets/websocketclient.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
182	    async def _request(self, method: str, **kwargs: Any) -> WebsocketRequest:
183	        req_id, data = self._build_websocket_request(method, **kwargs)
184	        req = WebsocketRequest(req_id, data, timeout=self._timeout, loop=self._loop)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/moonraker_api/websockets/websocketclient.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
200	        return AwaitableTaskContext[WebsocketRequest](
201	            self._request(method, **kwargs), self._requests
202	        )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/moonraker_api/websockets/websocketclient.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
280	                    headers = [("X-Api-Key", self.api_key)]
281	                async with self.session.ws_connect(
282	                    self._build_websocket_uri(),
283	                    headers=headers,
284	                    receive_timeout=self._timeout,
285	                    autoping=True,
286	                    heartbeat=self._timeout / 3,
287	                ) as websocket:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/moonraker_api/websockets/websocketclient.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
294	                        (
295	                            self._loop.create_task(self.loop_recv(websocket)),
296	                            self._loop.create_task(self.loop_send(websocket)),

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/moonraker_api/websockets/websocketclient.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
295	                            self._loop.create_task(self.loop_recv(websocket)),
296	                            self._loop.create_task(self.loop_send(websocket)),
297	                        ),

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/moonraker_api/websockets/websocketclient.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
354	        if self._ws:
355	            await self._ws.close()
356	        if self._runtask:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    long_description_content_type="text/markdown",
18	    url="https://github.com/cmroche/moonraker-api",
19	    packages=setuptools.find_packages(exclude=["tests"]),

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
42	
43	    await moonraker.connect()
44	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
47	
48	    await moonraker.disconnect()
49	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
64	
65	    await moonraker.connect()
66	    with pytest.raises(ClientAlreadyConnectedError):

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
66	    with pytest.raises(ClientAlreadyConnectedError):
67	        await moonraker.connect()
68	    assert moonraker.is_connected

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
70	
71	    await moonraker.disconnect()
72	    assert moonraker.state == WEBSOCKET_STATE_STOPPED

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
79	    with pytest.raises(ClientNotAuthenticatedError):
80	        connected = await moonraker.connect()
81	        assert not connected

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
84	
85	    await moonraker.disconnect()
86	    assert not moonraker.is_connected

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
93	
94	    await moonraker.connect()
95	    await moonraker.get_host_info()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
95	    await moonraker.get_host_info()
96	    await moonraker.disconnect()
97	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
102	
103	    await moonraker.connect()
104	    with pytest.raises(asyncio.CancelledError):

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
105	        await moonraker.get_host_info()
106	    await moonraker.disconnect()
107	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
112	
113	    await moonraker.connect()
114	    with pytest.raises(asyncio.TimeoutError):

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
115	        await moonraker.get_host_info()
116	    await moonraker.disconnect()
117	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
124	        await moonraker.get_host_info()
125	    await moonraker.disconnect()
126	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
139	        await moonraker.get_host_info()
140	    await moonraker.disconnect()
141	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
153	            await moonraker.get_host_info()
154	    await moonraker.disconnect()
155	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
163	
164	    await moonraker.connect()
165	    supported_modules = await moonraker.get_supported_modules()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
165	    supported_modules = await moonraker.get_supported_modules()
166	    await moonraker.disconnect()
167	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
174	
175	    await moonraker.connect()
176	    status = await moonraker.get_klipper_status()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
176	    status = await moonraker.get_klipper_status()
177	    await moonraker.disconnect()
178	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
193	
194	    await moonraker.connect()
195	    assert moonraker.is_connected

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
196	    response = await moonraker.call_method(method)
197	    await moonraker.disconnect()
198	    assert not moonraker.is_connected

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
216	
217	    await moonraker.connect()
218	    assert moonraker.is_connected

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
223	
224	    await moonraker.disconnect()
225	    assert not moonraker.is_connected

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
236	
237	    await moonraker.connect()
238	    assert moonraker.is_connected

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/moonraker_api-2.0.6/moonraker_api-2.0.6/tests/test_moonrakerclient.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
246	
247	    await moonraker.disconnect()
248	    assert not moonraker.is_connected

--------------------------------------------------

Code scanned:
	Total lines of code: 663
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 33.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 0.0
Files skipped (0):
