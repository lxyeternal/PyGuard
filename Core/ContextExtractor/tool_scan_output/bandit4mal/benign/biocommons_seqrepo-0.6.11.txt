Run started:2025-04-12 15:55:20.594637

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/docs/utils.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
51	def hex_to_base64url(s):
52	    return urlsafe_b64encode(unhexlify(s)).decode("ascii")
53	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/docs/utils.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
54	def base64url_to_hex(s):
55	    return hexlify(urlsafe_b64decode(s)).decode("ascii")
56	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/misc/threading-tests/threading-verification.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
41	    q = Queue()
42	    p = Process(target=fetch_seq, args=(q, nsa))
43	    p.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/misc/threading-tests/threading-verification.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	    def _test(sr):
67	        r = fetch_in_thread(sr, nsa)
68	        print(r)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/cli.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	    epilog = (
102	        f"seqrepo {__version__}"
103	        "See https://github.com/biocommons/biocommons.seqrepo for more information"

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/cli.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
692	        new_mode = mode & ~mode_aw
693	        os.chmod(p, new_mode)
694	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/cli.py:693
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
692	        new_mode = mode & ~mode_aw
693	        os.chmod(p, new_mode)
694	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/cli.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
699	    ):
700	        _drop_write(dp)
701	    _drop_write(tmp_dir)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/cli.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
699	    ):
700	        _drop_write(dp)
701	    _drop_write(tmp_dir)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/cli.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
700	        _drop_write(dp)
701	    _drop_write(tmp_dir)
702	    os.rename(tmp_dir, dst_dir)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/cli.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
700	        _drop_write(dp)
701	    _drop_write(tmp_dir)
702	    os.rename(tmp_dir, dst_dir)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/cli.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
715	            [
716	                "seqrepo (https://github.com/biocommons/biocommons.seqrepo/)",
717	                "version: " + __version__,
718	                "instance path: " + seqrepo_dir,
719	            ]
720	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/dataproxy.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	        _logger.info(f"Fetching {url} {params if (start or end) else ''}")
165	        resp = requests.get(url, params=params, timeout=60)
166	        if resp.status_code == 404:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/dataproxy.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
173	        _logger.info("Fetching %s", url)
174	        resp = requests.get(url, timeout=60)
175	        if resp.status_code == 404:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/dataproxy.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
220	
221	    uri = uri or os.environ.get("SEQREPO_DATAPROXY_URI", None)
222	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/dataproxy.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
259	
260	    dp1 = create_dataproxy("seqrepo+http://localhost:5000/seqrepo")
261	    dp2 = create_dataproxy("seqrepo+file:///usr/local/share/seqrepo/latest")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/fastadir/fabgz.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        raise RuntimeError(
57	            "{exe} doesn't exist; you need to install htslib and tabix "
58	            "(See https://github.com/biocommons/biocommons.seqrepo#requirements)".format(exe=exe)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/fastadir/fabgz.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
147	                raise RuntimeError("Writer has already been closed -- create a new FabgzWriter.")
148	            self._fh.write(">" + seq_id + "\n")
149	            for line in wrap_lines(seq, line_width):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/fastadir/fabgz.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
149	            for line in wrap_lines(seq, line_width):
150	                self._fh.write(line + "\n")
151	            self._added.add(seq_id)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/fastadir/fabgz.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
164	            _fh.close()
165	            os.chmod(self.filename, stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)
166	            os.chmod(self.filename + ".fai", stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/fastadir/fabgz.py:165
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
164	            _fh.close()
165	            os.chmod(self.filename, stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)
166	            os.chmod(self.filename + ".fai", stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/fastadir/fabgz.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
165	            os.chmod(self.filename, stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)
166	            os.chmod(self.filename + ".fai", stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)
167	            os.chmod(self.filename + ".gzi", stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/fastadir/fabgz.py:166
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
165	            os.chmod(self.filename, stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)
166	            os.chmod(self.filename + ".fai", stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)
167	            os.chmod(self.filename + ".gzi", stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/fastadir/fabgz.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
166	            os.chmod(self.filename + ".fai", stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)
167	            os.chmod(self.filename + ".gzi", stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)
168	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/src/biocommons/seqrepo/fastadir/fabgz.py:167
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
166	            os.chmod(self.filename + ".fai", stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)
167	            os.chmod(self.filename + ".gzi", stat.S_IRUSR | stat.S_IRGRP | stat.S_IROTH)
168	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/tests/conftest.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	def rest_dataproxy():
17	    url = os.environ.get("SEQREPO_REST_URL", "http://localhost:5000/seqrepo")
18	    return SeqRepoRESTDataProxy(base_url=url)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/tests/test_fabgz.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
37	
38	    shutil.rmtree(tmpdir)
39	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/tests/test_fabgz.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	if __name__ == "__main__":
47	    test_write_reread()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/tests/test_fastadir.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
32	
33	    shutil.rmtree(tmpdir)
34	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/biocommons_seqrepo-0.6.11/biocommons_seqrepo-0.6.11/tests/test_seqaliasdb.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
92	
93	    shutil.rmtree(tmpdir)
94	

--------------------------------------------------

Code scanned:
	Total lines of code: 2463
	Total lines skipped (#nosec): 1

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 21.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 4.0
Files skipped (0):
