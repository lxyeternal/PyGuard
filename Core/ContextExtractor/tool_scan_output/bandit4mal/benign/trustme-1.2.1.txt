Run started:2025-04-12 11:30:24.951575

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/docs/source/conf.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	intersphinx_mapping = {
50	    "python": ('https://docs.python.org/3', None),
51	    # https://github.com/pyca/pyopenssl/issues/1046
52	    "pyopenssl": ('https://www.pyopenssl.org/en/20.0.1/', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/docs/source/conf.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    # https://github.com/pyca/pyopenssl/issues/1046
52	    "pyopenssl": ('https://www.pyopenssl.org/en/20.0.1/', None),
53	    "trio": ('https://trio.readthedocs.io/en/latest/', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/docs/source/conf.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    "pyopenssl": ('https://www.pyopenssl.org/en/20.0.1/', None),
53	    "trio": ('https://trio.readthedocs.io/en/latest/', None),
54	}

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/src/trustme/__init__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
60	def random_text() -> str:
61	    return urlsafe_b64encode(os.urandom(12)).decode("ascii")
62	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/src/trustme/__init__.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	        with open(path, mode) as f:
169	            f.write(self._data)
170	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/src/trustme/__init__.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
168	        with open(path, mode) as f:
169	            f.write(self._data)
170	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/src/trustme/__init__.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
203	        try:
204	            f.write(self._data)
205	            f.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/src/trustme/__init__.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
203	        try:
204	            f.write(self._data)
205	            f.close()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/src/trustme/_cli.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
27	        nargs="*",
28	        default=("localhost", "127.0.0.1", "::1"),
29	        help="Identities for the certificate. Defaults to 'localhost 127.0.0.1 ::1'.",

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
255	    with (tmp_path / "test1").open("rb") as f:
256	        assert f.read() == test_data
257	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
262	    with (tmp_path / "test2").open("rb") as f:
263	        assert f.read() == test_data
264	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
269	    with (tmp_path / "test2").open("rb") as f:
270	        assert f.read() == b"asdf" + test_data
271	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
276	        with open(path, "rb") as f:
277	            assert f.read() == test_data
278	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
296	            # Send and receive some data to prove the connection is good
297	            wrapped_client_sock.send(b"x")
298	            assert wrapped_client_sock.recv(1) == b"y"

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
296	            # Send and receive some data to prove the connection is good
297	            wrapped_client_sock.send(b"x")
298	            assert wrapped_client_sock.recv(1) == b"y"

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
297	            wrapped_client_sock.send(b"x")
298	            assert wrapped_client_sock.recv(1) == b"y"
299	            wrapped_client_sock.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
298	            assert wrapped_client_sock.recv(1) == b"y"
299	            wrapped_client_sock.close()
300	        except:  # pragma: no cover

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
303	        finally:
304	            raw_client_sock.close()
305	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
310	            # Prove that we're connected
311	            assert wrapped_server_sock.recv(1) == b"x"
312	            wrapped_server_sock.send(b"y")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
311	            assert wrapped_server_sock.recv(1) == b"x"
312	            wrapped_server_sock.send(b"y")
313	            wrapped_server_sock.close()

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
311	            assert wrapped_server_sock.recv(1) == b"x"
312	            wrapped_server_sock.send(b"y")
313	            wrapped_server_sock.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
312	            wrapped_server_sock.send(b"y")
313	            wrapped_server_sock.close()
314	        except:  # pragma: no cover

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
317	        finally:
318	            raw_server_sock.close()
319	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:323
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
322	        # So we need to do this the hard way.
323	        listener = socket.socket()
324	        listener.bind(("127.0.0.1", 0))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
323	        listener = socket.socket()
324	        listener.bind(("127.0.0.1", 0))
325	        listener.listen(1)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:326
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
325	        listener.listen(1)
326	        raw_client_sock = socket.socket()
327	        raw_client_sock.connect(listener.getsockname())

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
326	        raw_client_sock = socket.socket()
327	        raw_client_sock.connect(listener.getsockname())
328	        raw_server_sock, _ = listener.accept()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
328	        raw_server_sock, _ = listener.accept()
329	        listener.close()
330	        with ThreadPoolExecutor(2) as tpe:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
329	        listener.close()
330	        with ThreadPoolExecutor(2) as tpe:
331	            f1 = tpe.submit(fake_ssl_client, ca, raw_client_sock, hostname)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
443	        # IP addresses
444	        "127.0.0.1": x509.IPAddress(IPv4Address("127.0.0.1")),
445	        "::1": x509.IPAddress(IPv6Address("::1")),
446	        # Check normalization
447	        "0000::1": x509.IPAddress(IPv6Address("::1")),
448	        # IP networks
449	        "127.0.0.0/24": x509.IPAddress(IPv4Network("127.0.0.0/24")),
450	        "2001::/16": x509.IPAddress(IPv6Network("2001::/16")),
451	        # Check normalization
452	        "2001:0000::/16": x509.IPAddress(IPv6Network("2001::/16")),
453	        # Email address
454	        "example@example.com": x509.RFC822Name("example@example.com"),
455	    }
456	
457	    for hostname, expected in cases.items():
458	        # Can't repr the got or expected values here, at least until
459	        # cryptography v2.1 is out, because in v2.0 on py2, DNSName.__repr__
460	        # blows up on IDNs.
461	        print(f"testing: {hostname!r}")
462	        pem = ca.issue_cert(hostname).cert_chain_pems[0].bytes()
463	        cert = x509.load_pem_x509_certificate(pem)
464	        san = cert.extensions.get_extension_for_class(x509.SubjectAlternativeName)
465	        assert_is_leaf(cert)
466	        got = list(san.value)[0]
467	        assert got == expected
468	
469	
470	def test_backcompat() -> None:
471	    ca = CA()
472	    # We can still use the old name
473	    ca.issue_server_cert("example.com")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/trustme-1.2.1/trustme-1.2.1/tests/test_trustme.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
443	        # IP addresses
444	        "127.0.0.1": x509.IPAddress(IPv4Address("127.0.0.1")),
445	        "::1": x509.IPAddress(IPv6Address("::1")),

--------------------------------------------------

Code scanned:
	Total lines of code: 1053
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 22.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 2.0
Files skipped (0):
