Run started:2025-04-12 11:04:59.721622

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/docs/conf.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
17	    with open("index.rst", "w") as fh:
18	        fh.write("Documentation for this project has moved to https://kislyuk.github.io/" + project)
19	else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/docs/conf.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    with open("index.rst", "w") as fh:
18	        fh.write("Documentation for this project has moved to https://kislyuk.github.io/" + project)
19	else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/setup.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	    name="yq",
7	    url="https://github.com/kislyuk/yq",
8	    license="Apache Software License",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
125	        with tempfile.NamedTemporaryFile() as tf, tempfile.TemporaryFile() as tf2:
126	            tf.write(b".a")
127	            tf.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
125	        with tempfile.NamedTemporaryFile() as tf, tempfile.TemporaryFile() as tf2:
126	            tf.write(b".a")
127	            tf.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	            tf.seek(0)
128	            tf2.write(b'{"a": 1}')
129	            for arg in "--from-file", "-f":

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
127	            tf.seek(0)
128	            tf2.write(b'{"a": 1}')
129	            for arg in "--from-file", "-f":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
156	        with tempfile.TemporaryFile() as tf, tempfile.TemporaryFile() as tf2:
157	            tf.write(b'{"a": "b"}')
158	            tf.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
156	        with tempfile.TemporaryFile() as tf, tempfile.TemporaryFile() as tf2:
157	            tf.write(b'{"a": "b"}')
158	            tf.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
158	            tf.seek(0)
159	            tf2.write(b'{"a": 1}')
160	            tf2.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
158	            tf.seek(0)
159	            tf2.write(b'{"a": 1}')
160	            tf2.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
178	        with tempfile.TemporaryFile() as tf:
179	            tf.write(yaml_with_tags.encode())
180	            tf.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
178	        with tempfile.TemporaryFile() as tf:
179	            tf.write(yaml_with_tags.encode())
180	            tf.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
185	        with io.open(cfn_filename) as fh:
186	            self.assertEqual(self.run_yq("", ["-Y", ".", cfn_filename]), fh.read())
187	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
189	        with tempfile.NamedTemporaryFile() as tf, tempfile.NamedTemporaryFile() as tf2:
190	            tf.write(b"- foo\n- bar\n")
191	            tf.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
189	        with tempfile.NamedTemporaryFile() as tf, tempfile.NamedTemporaryFile() as tf2:
190	            tf.write(b"- foo\n- bar\n")
191	            tf.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
191	            tf.seek(0)
192	            tf2.write(b"- foo\n- bar\n")
193	            tf2.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
191	            tf.seek(0)
192	            tf2.write(b"- foo\n- bar\n")
193	            tf2.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
194	            self.run_yq("", ["-i", "-y", ".[0]", tf.name, tf2.name])
195	            self.assertEqual(tf.read(), b"foo\n...\n")
196	            self.assertEqual(tf2.read(), b"foo\n...\n")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
195	            self.assertEqual(tf.read(), b"foo\n...\n")
196	            self.assertEqual(tf2.read(), b"foo\n...\n")
197	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
201	            tf2.seek(0)
202	            self.assertEqual(tf.read(), b"foo\n...\n")
203	            self.assertEqual(tf2.read(), b"foo\n...\n")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
202	            self.assertEqual(tf.read(), b"foo\n...\n")
203	            self.assertEqual(tf2.read(), b"foo\n...\n")
204	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
206	        with tempfile.NamedTemporaryFile() as tf:
207	            tf.write(b'[GLOBAL]\nversion="1.0.0"\n')
208	            tf.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
206	        with tempfile.NamedTemporaryFile() as tf:
207	            tf.write(b'[GLOBAL]\nversion="1.0.0"\n')
208	            tf.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
209	            self.run_yq("", ["-i", "-t", '.GLOBAL.version="1.0.1"', tf.name], input_format="toml")
210	            self.assertEqual(tf.read(), b'[GLOBAL]\nversion = "1.0.1"\n')
211	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
233	        with tempfile.TemporaryFile() as tf, tempfile.TemporaryFile() as tf2:
234	            tf.write(b"<a><b/></a>")
235	            tf.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
233	        with tempfile.TemporaryFile() as tf, tempfile.TemporaryFile() as tf2:
234	            tf.write(b"<a><b/></a>")
235	            tf.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
235	            tf.seek(0)
236	            tf2.write(b"<a><c/></a>")
237	            tf2.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
235	            tf.seek(0)
236	            tf2.write(b"<a><c/></a>")
237	            tf2.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
249	        with tempfile.TemporaryFile() as tf:
250	            tf.write(b'<a><b c="d">e</b><b>f</b></a>')
251	            tf.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/test/test.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
249	        with tempfile.TemporaryFile() as tf:
250	            tf.write(b'<a><b c="d">e</b><b>f</b></a>')
251	            tf.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	                with open(input_stream.name, "w") as fh:
139	                    fh.write(out_fh.getvalue())
140	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	                    exit_func("{}: Error: detected unsafe YAML entity expansion".format(prog))
161	                out_stream.write(chunk)
162	            out_stream.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
161	                out_stream.write(chunk)
162	            out_stream.write("\n")
163	            last_loader_pos = loader_pos

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
242	                    xml_doc = xmltodict.parse(
243	                        input_stream.buffer if isinstance(input_stream, io.TextIOWrapper) else input_stream.read(),
244	                        disable_entities=True,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
247	                    json.dump(xml_doc, json_buffer, cls=JSONDateTimeEncoder)
248	                    json_buffer.write("\n")
249	                elif input_format == "toml":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
253	                    json.dump(toml_doc, json_buffer, cls=JSONDateTimeEncoder)
254	                    json_buffer.write("\n")
255	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
296	                            raise
297	                    output_stream.write("\n")
298	            elif output_format == "toml":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
328	                    json.dump(entry, jq.stdin)
329	                    jq.stdin.write("\n")
330	                    return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
333	                    xml_doc = xmltodict.parse(
334	                        input_stream.buffer if isinstance(input_stream, io.TextIOWrapper) else input_stream.read(),
335	                        disable_entities=True,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
344	                for input_stream in input_streams:
345	                    toml_doc = toml_loader(input_stream.read())
346	                    json.dump(toml_doc, jq.stdin, cls=JSONDateTimeEncoder)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/__init__.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
346	                    json.dump(toml_doc, jq.stdin, cls=JSONDateTimeEncoder)
347	                    jq.stdin.write("\n")
348	            else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/loader.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
127	def hash_key(key):
128	    return b64encode(sha224(key.encode() if isinstance(key, str) else key).digest()).decode()
129	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yq-3.4.3/yq-3.4.3/yq/loader.py:128
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
127	def hash_key(key):
128	    return b64encode(sha224(key.encode() if isinstance(key, str) else key).digest()).decode()
129	

--------------------------------------------------

Code scanned:
	Total lines of code: 1055
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 41.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 1.0
Files skipped (0):
