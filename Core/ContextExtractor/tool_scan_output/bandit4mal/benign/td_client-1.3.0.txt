Run started:2025-04-12 14:10:21.574466

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	
85	    DEFAULT_ENDPOINT = "https://api.treasuredata.com/"
86	    DEFAULT_IMPORT_ENDPOINT = "https://api-import.treasuredata.com/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	    DEFAULT_ENDPOINT = "https://api.treasuredata.com/"
86	    DEFAULT_IMPORT_ENDPOINT = "https://api-import.treasuredata.com/"
87	
88	    def __init__(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	            if not urlparse.urlparse(endpoint).scheme:
114	                endpoint = "https://{}".format(endpoint)
115	            self._endpoint = endpoint

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	            else:
153	                return self._init_http_proxy("http://%s" % (http_proxy,), **kwargs)
154	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
167	        headers["accept-encoding"] = "deflate, gzip"
168	        url, headers = self.build_request(path=path, headers=headers, **kwargs)
169	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
185	            try:
186	                response = self.send_request(
187	                    "GET",
188	                    url,
189	                    fields=params,
190	                    headers=headers,
191	                    decode_content=True,
192	                    preload_content=False,
193	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
245	        headers = {} if headers is None else dict(headers)
246	        url, headers = self.build_request(path=path, headers=headers, **kwargs)
247	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
273	            try:
274	                response = self.send_request(
275	                    "POST",
276	                    url,
277	                    fields=fields,
278	                    body=body,
279	                    headers=headers,
280	                    decode_content=True,
281	                    preload_content=False,
282	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
341	            headers["content-type"] = "application/octet-stream"
342	        url, headers = self.build_request(path=path, headers=headers, **kwargs)
343	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
361	            else:
362	                stream = array("b", bytes_or_stream.read())
363	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
361	            else:
362	                stream = array("b", bytes_or_stream.read())
363	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
369	        try:
370	            response = self.send_request(
371	                "PUT",
372	                url,
373	                body=stream,
374	                headers=headers,
375	                decode_content=True,
376	                preload_content=False,
377	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
399	        headers = {} if headers is None else dict(headers)
400	        url, headers = self.build_request(path=path, headers=headers, **kwargs)
401	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
417	            try:
418	                response = self.send_request(
419	                    "DELETE",
420	                    url,
421	                    fields=params,
422	                    headers=headers,
423	                    decode_content=True,
424	                    preload_content=False,
425	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
500	        if body is None:
501	            return self.http.request(
502	                method, url, fields=fields, headers=headers, **kwargs
503	            )

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
510	            body = body.tobytes()
511	        return self.http.urlopen(method, url, body=body, headers=headers, **kwargs)
512	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
556	                        mp = packer.pack(normalized_msgpack(item))
557	                    gz.write(mp)
558	        fp.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/api.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
556	                        mp = packer.pack(normalized_msgpack(item))
557	                    gz.write(mp)
558	        fp.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	        ) as res:
43	            code, body = res.status, res.read()
44	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	        ) as res:
61	            code, body = res.status, res.read()
62	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	        with self.get(create_url("/v3/bulk_import/show/{name}", name=name)) as res:
75	            code, body = res.status, res.read()
76	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	        with self.get("/v3/bulk_import/list", params) as res:
90	            code, body = res.status, res.read()
91	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
109	        ) as res:
110	            code, body = res.status, res.read()
111	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
154	        ) as res:
155	            code, body = res.status, res.read()
156	            if code / 100 != 2:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
215	        ) as res:
216	            code, body = res.status, res.read()
217	            if code / 100 != 2:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	        ) as res:
234	            code, body = res.status, res.read()
235	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
251	        ) as res:
252	            code, body = res.status, res.read()
253	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
270	        ) as res:
271	            code, body = res.status, res.read()
272	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
289	        ) as res:
290	            code, body = res.status, res.read()
291	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
309	            if code != 200:
310	                body = res.read()
311	                self.raise_error("Failed to get bulk import error records", res, body)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/bulk_import_api.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
312	
313	            body = io.BytesIO(res.read())
314	            decompressor = gzip.GzipFile(fileobj=body)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/import_api.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	        with self.put(path, bytes_or_stream, size, **kwargs) as res:
49	            code, body = res.status, res.read()
50	            if code / 100 != 2:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	        with self.get("/v3/job/list", params) as res:
62	            code, body = res.status, res.read()
63	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
122	        with self.get(create_url("/v3/job/show/{job_id}", job_id=job_id)) as res:
123	            code, body = res.status, res.read()
124	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
178	        with self.get(create_url("/v3/job/status/{job_id}", job_id=job_id)) as res:
179	            code, body = res.status, res.read()
180	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
295	            else:
296	                yield res.read()
297	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
325	                        for chunk in response.stream(1024):
326	                            f.write(chunk)
327	                    return True

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
325	                        for chunk in response.stream(1024):
326	                            f.write(chunk)
327	                    return True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
337	                    with open(f"{file_name}.part{i}", "rb") as part_file:
338	                        final_file.write(part_file.read())
339	                    os.remove(f"{file_name}.part{i}")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
337	                    with open(f"{file_name}.part{i}", "rb") as part_file:
338	                        final_file.write(part_file.read())
339	                    os.remove(f"{file_name}.part{i}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
337	                    with open(f"{file_name}.part{i}", "rb") as part_file:
338	                        final_file.write(part_file.read())
339	                    os.remove(f"{file_name}.part{i}")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
346	
347	            with ThreadPoolExecutor(max_workers=num_threads) as executor:
348	                while start < file_size:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
371	        with self.post(create_url("/v3/job/kill/{job_id}", job_id=job_id)) as res:
372	            code, body = res.status, res.read()
373	            if code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/td_client-1.3.0/td_client-1.3.0/tdclient/job_api.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
422	        ) as res:
423	            code, body = res.status, res.read()
424	            if code != 200:

--------------------------------------------------

Code scanned:
	Total lines of code: 4504
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 40.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 44.0
		High: 0.0
Files skipped (0):
