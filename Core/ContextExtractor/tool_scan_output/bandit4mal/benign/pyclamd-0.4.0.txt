Run started:2025-04-12 13:24:31.655336

Test results:
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
189	
190	        EICAR = base64.b64decode(eicar_b64.encode('ascii'))
191	        return EICAR

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:190
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
189	
190	        EICAR = base64.b64decode(eicar_b64.encode('ascii'))
191	        return EICAR

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
548	            while True:
549	                chunk = stream.read(chunk_size)
550	                if not chunk:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
553	                try:
554	                    self.clamd_socket.send(size)
555	                    self.clamd_socket.send(chunk)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
554	                    self.clamd_socket.send(size)
555	                    self.clamd_socket.send(chunk)
556	                except socket.error:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
559	            # Terminating stream
560	            self.clamd_socket.send(struct.pack('!L', 0))
561	        else:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
566	                try:
567	                    self.clamd_socket.send(size)
568	                    self.clamd_socket.send(chunk)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
567	                    self.clamd_socket.send(size)
568	                    self.clamd_socket.send(chunk)
569	                except socket.error:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
572	                # Terminating stream
573	                self.clamd_socket.send(struct.pack('!L', 0))
574	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
610	            cmd = 'n{0}\n'.format(cmd)
611	        self.clamd_socket.send(cmd)
612	        return

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
623	            try:
624	                data = self.clamd_socket.recv(4096)
625	            except socket.error:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
658	        """
659	        self.clamd_socket.close()
660	        return

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:742
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
741	        """
742	        self.clamd_socket = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
743	        if not self.timeout is None:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
743	        if not self.timeout is None:
744	            self.clamd_socket.settimeout(self.timeout)
745	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
746	        try:
747	            self.clamd_socket.connect(self.unix_socket)
748	        except socket.error:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
759	    """
760	    def __init__(self, host='127.0.0.1', port=3310, timeout=None):
761	        """

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:789
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
788	        """
789	        self.clamd_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
790	        if not self.timeout is None:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
790	        if not self.timeout is None:
791	            self.clamd_socket.settimeout(self.timeout)
792	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
792	        try:
793	            self.clamd_socket.connect((self.host, self.port))
794	        except socket.error:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:827
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
826	
827	def init_network_socket(host='127.0.0.1', port=3310, timeout=None):
828	    """Deprecated API - use ClamdNetworkSocket instead."""

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
885	    import os
886	    os.system('pydoc ./{0}.py'.format(__name__))
887	    return

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/pyclamd.py:886
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
885	    import os
886	    os.system('pydoc ./{0}.py'.format(__name__))
887	    return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/test_pyclamd.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
157	    """
158	    void = open('/tmp/EICAR','wb').write(cd.EICAR())
159	    assert_equals(cd.scan_file('/tmp/EICAR')['/tmp/EICAR'], ('FOUND', 'Eicar-Test-Signature'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/test_pyclamd.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	    """
165	    void = open('/tmp/NO_EICAR','w').write('no virus in this file')
166	    assert(cd.scan_file('/tmp/NO_EICAR') is None)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/test_pyclamd.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
194	    """
195	    void = open('/tmp/EICAR-éèô请收藏我们的网址','wb').write(cd.EICAR())
196	    r = cd.scan_file('/tmp/EICAR-éèô请收藏我们的网址')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/test_pyclamd.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
205	    """
206	    file_data = open('./probleme_data.pdf', 'rb').read()
207	    v = cd.scan_stream(file_data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/test_pyclamd.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
214	    """
215	    file_data = open('./probleme_data_clean.pdf', 'rb').read()
216	    v = cd.scan_stream(file_data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/test_pyclamd.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
221	def test_scan_stream_filelike_eicar():
222	    void = open('/tmp/EICAR','wb').write(cd.EICAR())
223	    f = open('/tmp/EICAR', 'rb')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/pyclamd/test_pyclamd.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
228	def test_scan_stream_filelike_clean():
229	    void = open('/tmp/NO_EICAR','w').write('no virus in this file')
230	    f = open('/tmp/NO_EICAR', 'rb')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/setup.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	       version = pyclamd.__version__,
21	       download_url = 'http://xael.org/norman/python/pyclamd/',
22	       package_dir={'pyclamd': 'pyclamd'},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/setup.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	       keywords='python, clamav, antivirus, scanner, virus, libclamav',
29	       url = 'http://xael.org/pages/pyclamd-en.html',
30	       bugtrack_url = 'https://bitbucket.org/xael/pyclamd',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyclamd-0.4.0/pyClamd-0.4.0/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	       url = 'http://xael.org/pages/pyclamd-en.html',
30	       bugtrack_url = 'https://bitbucket.org/xael/pyclamd',
31	       include_dirs = ['/usr/local/include'],

--------------------------------------------------

Code scanned:
	Total lines of code: 820
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 4.0
Files skipped (0):
