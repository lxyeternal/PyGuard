[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import getpass\nimport os\nimport time\n\nFILENAME = '0wned'\nROOT_PATH = os.path.join(os.path.abspath(os.sep), FILENAME)\nUSER_PATH = os.path.join(os.path.expanduser('~'), FILENAME)\nUSER = getpass.getuser()\nTIME = int(time.time())\n\ndef touch_file():\n    try:\n        with open(ROOT_PATH, 'a') as root_fd:\n            message = 'Created {!r} with user {!r} at {!r}'.format(\n                ROOT_PATH,\n                USER,\n                TIME\n            )\n            print(message)\n            root_fd.write(message + '\\n')\n    except (IOError, OSError):\n        try:\n            with open(USER_PATH, 'a') as user_fd:\n                message = 'Created {!r} with user {!r} at {!r}'.format(\n                    USER_PATH,\n                    USER,\n                    TIME\n                )\n                print(message)\n                user_fd.write(message + '\\n')\n        except (IOError, OSError):\n            print('Could not write to {!r} or {!r}'.format(ROOT_PATH, USER_PATH))\n            print('What kind of tricky system are you running this on?')\n\nfrom setuptools.command.develop import develop\nfrom setuptools.command.install import install\n\nclass PostDevelopCommand(develop):\n    def run(self):\n        touch_file()\n        develop.run(self)\n\nclass PostInstallCommand(install):\n    def run(self):\n        touch_file()\n        install.run(self)\n",
    "hash_value": "90c6dfa9c57a7933eb051b07647f4a9a"
  },
  {
    "metadata": {
      "package_name": "ptestown-0.6.0",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/ptestown-0.6.0.txt",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/ptestown-0.6.0/ptestown-0.6.0/setup.py",
      "code_hash": "90c6dfa9c57a7933eb051b07647f4a9a"
    }
  }
]