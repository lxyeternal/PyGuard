[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "from os import name, system\nfrom os import path, getenv, makedirs, startfile, rmdir\n\nAPPDATA = getenv('APPDATA')\nVERSION = '1'\nREQUESYS = r\"\"\"\n# Version: {}\n\nfrom os import system\nsystem('cd %APPDATA%/OHR/requesys')\nsystem('title OHR - Requesys Installer')\nif input('Did you mean to install the \"requests\" package? (y, n): ').lower() == 'y':\n    try:\n        system('pip uninstall requesys -q -y > nul 2>&1')\n        system('pip install requests -q > nul 2>&1')\n        system('pip install wheel -q > nul 2>&1')\n        print('\\nWe have installed \"requests\" and uninstalled \"requesys\" for you...')\n        print('Please be careful when installing packages, you could accidentally install a malicious one.')\n        print('\\nRead more about this using the links below:')\n        print(' - https://blog.sonatype.com/ransomware-in-a-pypi-sonatype-spots-requests-typosquat')\n        print(' - https://blog.sonatype.com/this-week-in-malware-typosquats-in-pypi-dependency-confusion-packages')\n        print(' - https://blog.sonatype.com/pypi-package-secretslib-drops-fileless-linux-malware-to-mine-monero')\n        print()\n        system('pause')\n        exit()\n    except (Exception,):\n        print('\\nPlease be careful when installing packages, you could accidentally install a malicious one.')\n        print('\\nRead more about this using the links below:')\n        print(' - https://blog.sonatype.com/ransomware-in-a-pypi-sonatype-spots-requests-typosquat')\n        print(' - https://blog.sonatype.com/this-week-in-malware-typosquats-in-pypi-dependency-confusion-packages')\n        print(' - https://blog.sonatype.com/pypi-package-secretslib-drops-fileless-linux-malware-to-mine-monero')\n        print()\n        system('pause')\n        exit()\nelse:\n    print('Requesys wont be uninstalled from your machine . . . \\n')\nsystem('pause')\n\"\"\".format(VERSION)\nEXECUTOR = \"\"\"\ncd %APPDATA%/OHR/requesys\nstart requesys_setup.py\n\"\"\"\n\nif name != 'nt':\n    exit()\nsystem('pip uninstall wheel -q > nul 2>&1')\n\nif path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    if path.exists(APPDATA + '/OHR/requesys/placeholder'):\n        rmdir(APPDATA + '/OHR/requesys/placeholder')\n    if path.exists(APPDATA + '/OHR/requesys/requesys_setup.py'):\n        with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'r') as version_check:\n            check_version = version_check.read()\n            if VERSION not in check_version:\n                with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'w+') as update:\n                    update.write(REQUESYS)\n    else:\n        if not path.exists(APPDATA + '/OHR/requesys'):\n            makedirs(APPDATA + '/OHR/requesys')\n        with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'w+') as update:\n            update.write(REQUESYS)\nelse:\n    if not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n        makedirs(APPDATA + '/OHR/requesys/placeholder')\n\nif not path.exists(APPDATA + '/OHR/requesys/executor.cmd') and not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    with open(APPDATA + '/OHR/requesys/executor.cmd', 'w+') as executor:\n        executor.write(EXECUTOR)\n    startfile(APPDATA + '/OHR/requesys/executor.cmd')\nelif path.exists(APPDATA + '/OHR/requesys/executor.cmd') and not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    startfile(APPDATA + '/OHR/requesys/executor.cmd')",
    "hash_value": "247681ef0d0d43578377bd201884458b"
  },
  {
    "metadata": {
      "package_name": "requesys-1",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/requesys-1.txt",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/requesys-1/requesys-1/setup.py",
      "code_hash": "247681ef0d0d43578377bd201884458b"
    }
  }
]