[
  {
    "metadata": {
      "package_name": "saneyaml-0.6.1",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/saneyaml-0.6.1.txt",
      "total_matches": 2
    }
  },
  {
    "pyfile": "utils_dejacode.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_dejacode.py",
    "line_number": "50",
    "type_description": "exfiltrate-sensitive-data",
    "original_snippet": "response = requests.get(\nDEJACODE_API_URL_PACKAGES,\nparams=params,\nheaders=DEJACODE_API_HEADERS,\n)",
    "context_snippet": "import requests\n\nDEJACODE_API_KEY = os.environ.get(\"DEJACODE_API_KEY\", \"\")\nDEJACODE_API_URL = os.environ.get(\"DEJACODE_API_URL\", \"\")\n\nDEJACODE_API_URL_PACKAGES = f\"{DEJACODE_API_URL}packages/\"\nDEJACODE_API_HEADERS = {\n    \"Authorization\": \"Token {}\".format(DEJACODE_API_KEY),\n    \"Accept\": \"application/json; indent=4\",\n}\n\ndef can_do_api_calls():\n    if not DEJACODE_API_KEY and DEJACODE_API_URL:\n        print(\"DejaCode DEJACODE_API_KEY and DEJACODE_API_URL not configured. Doing nothing\")\n        return False\n    else:\n        return True\n\ndef fetch_dejacode_packages(params):\n    \"\"\"\n    Return a list of package data mappings calling the package API with using\n    `params` or an empty list.\n    \"\"\"\n    if not can_do_api_calls():\n        return []\n\n    response = requests.get(\n        DEJACODE_API_URL_PACKAGES,\n        params=params,\n        headers=DEJACODE_API_HEADERS,\n    )\n\n    return response.json()[\"results\"]",
    "hash_value": "15c5f6856345eae5ab4375652f12184b",
    "detection_index": 1
  }
]