[
  {
    "metadata": {
      "package_name": "delocate-0.13.0",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/delocate-0.13.0.txt",
      "total_matches": 8
    }
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/delocate-0.13.0/delocate-0.13.0/wheel_makers/fakepkg1/setup.py",
    "line_number": "19",
    "type_description": "code-execution",
    "original_snippet": "check_call(\n[\"cc\", \"-dynamiclib\", pjoin(LIBS, \"extfunc.c\"), \"-o\", EXTLIB] + arch_flags\n)",
    "context_snippet": "from os.path import abspath, dirname\nfrom os.path import join as pjoin\nfrom subprocess import check_call\n\nHERE = abspath(dirname(__file__))\nLIBS = pjoin(HERE, \"libs\")\nEXTLIB = pjoin(LIBS, \"libextfunc.dylib\")\n\n# Compile external extension with absolute path in install id\narch_flags = [\"-arch\", \"arm64\", \"-arch\", \"x86_64\"]  # dual arch\ncheck_call(\n    [\"cc\", \"-dynamiclib\", pjoin(LIBS, \"extfunc.c\"), \"-o\", EXTLIB] + arch_flags\n)",
    "hash_value": "df1b47cd080c9652fc66415d0109d1b8",
    "detection_index": 1
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/delocate-0.13.0/delocate-0.13.0/wheel_makers/fakepkg_namespace/setup.py",
    "line_number": "12",
    "type_description": "code-execution",
    "original_snippet": "subprocess.run(\n[\n\"cc\",\nstr(LIBS / \"extfunc2.c\"),\n\"-dynamiclib\",\n\"-install_name\",\n\"@rpath/libextfunc2_rpath.dylib\",\n\"-o\",\nstr(LIBS / \"libextfunc2_rpath.dylib\"),\n]\n+ ARCH_FL...k=True,\n)",
    "context_snippet": "import subprocess\nfrom pathlib import Path\n\nfrom setuptools import Extension, setup  # type: ignore\n\nHERE = Path(__file__).parent.resolve(strict=True)\nLIBS = HERE / \"libs\"\nARCH_FLAGS = [\"-arch\", \"arm64\", \"-arch\", \"x86_64\"]  # Dual architecture.\n\nsubprocess.run(\n    [\n        \"cc\",\n        str(LIBS / \"extfunc2.c\"),\n        \"-dynamiclib\",\n        \"-install_name\",\n        \"@rpath/libextfunc2_rpath.dylib\",\n        \"-o\",\n        str(LIBS / \"libextfunc2_rpath.dylib\"),\n    ]\n    + ARCH_FLAGS,\n    check=True,\n)\n",
    "hash_value": "3a801de97bc211a51ce38e228fbfc1a0",
    "detection_index": 1
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/delocate-0.13.0/delocate-0.13.0/wheel_makers/fakepkg_toplevel/setup.py",
    "line_number": "12",
    "type_description": "code-execution",
    "original_snippet": "subprocess.run(\n[\n\"cc\",\nstr(LIBS / \"extfunc2.c\"),\n\"-dynamiclib\",\n\"-install_name\",\n\"@rpath/libextfunc2_rpath.dylib\",\n\"-o\",\nstr(LIBS / \"libextfunc2_rpath.dylib\"),\n]\n+ ARCH_FL...k=True,\n)",
    "context_snippet": "import subprocess\nfrom pathlib import Path\n\nfrom setuptools import Extension, setup  # type: ignore\n\nHERE = Path(__file__).parent.resolve(strict=True)\nLIBS = HERE / \"libs\"\nARCH_FLAGS = [\"-arch\", \"arm64\", \"-arch\", \"x86_64\"]  # Dual architecture.\n\nsubprocess.run(\n    [\n        \"cc\",\n        str(LIBS / \"extfunc2.c\"),\n        \"-dynamiclib\",\n        \"-install_name\",\n        \"@rpath/libextfunc2_rpath.dylib\",\n        \"-o\",\n        str(LIBS / \"libextfunc2_rpath.dylib\"),\n    ]\n    + ARCH_FLAGS,\n    check=True,\n)\n",
    "hash_value": "3a801de97bc211a51ce38e228fbfc1a0",
    "detection_index": 1
  }
]