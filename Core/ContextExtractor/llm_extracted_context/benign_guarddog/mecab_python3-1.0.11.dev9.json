[
  {
    "metadata": {
      "package_name": "mecab_python3-1.0.11.dev9",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/mecab_python3-1.0.11.dev9.txt",
      "total_matches": 1
    }
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/mecab_python3-1.0.11.dev9/mecab_python3-1.0.11.dev9/setup.py",
    "line_number": "95",
    "type_description": "code-execution",
    "original_snippet": "output = subprocess.check_output([\"mecab-config\", arg],\nenv=clocale_env)",
    "context_snippet": "import os\nimport subprocess\nimport sys\n\ndef maybe_build_libmecab_and_adjust_flags(ext):\n    if USE_BUNDLED_LIBMECAB:\n        subprocess.check_call([\n            sys.executable,\n            os.path.join(SRCDIR, \"scripts/build-bundled-libmecab.py\"),\n            SRCDIR\n        ])\n        inc_dir  = [os.path.join(SRCDIR, \"build/libmecab/mecab/src\")]\n        lib_dirs = [os.path.join(SRCDIR, \"build/libmecab/mecab/src\")]\n\n        # mecab-config --libs-only-l will produce the list of\n        # libraries needed to link with a hypothetical *shared*\n        # libmecab; we built a *static* libmecab, so what we actually\n        # need is -lmecab + the value of the LIBS substitution\n        # variable from the Makefile.\n        libs = [\"mecab\"]\n        with open(os.path.join(SRCDIR, \"build/libmecab/mecab/Makefile\"),\n                  \"rt\") as fp:\n            for line in fp:\n                if line.startswith(\"LIBS =\"):\n                    for lib in line.partition(\"=\")[2].split():\n                        if lib[:2] == \"-l\":\n                            libs.append(lib[2:])\n                    break\n\n    else:\n        # Ensure use of the \"C\" locale when invoking mecab-config.\n        # (\"C.UTF-8\" would be better if available, but there's no\n        # good way to find out whether it's available.)\n        clocale_env = {}\n        for k, v in os.environ.items():\n            if not (k.startswith(\"LC_\") or k == \"LANG\" or k == \"LANGUAGE\"):\n                clocale_env[k] = v\n        clocale_env[\"LC_ALL\"] = \"C\"\n\n        def mecab_config(arg):\n            output = subprocess.check_output([\"mecab-config\", arg],\n                                             env=clocale_env)\n            if not isinstance(output, str):\n                output = output.decode(\"utf-8\")\n            return output.split()\n\n        inc_dir  = mecab_config(\"--inc-dir\")\n        lib_dirs = mecab_config(\"--libs-only-L\")\n        libs     = mecab_config(\"--libs-only-l\")\n\n    swig_opts = [\"-O\", \"-builtin\", \"-c++\"]\n\n    if sys.version_info.major >= 3:\n        swig_opts.append(\"-py3\")\n\n    swig_opts.extend(\"-I\"+d for d in inc_dir)\n\n    ext.include_dirs = inc_dir\n    ext.library_dirs = lib_dirs\n    ext.libraries    = libs\n    ext.swig_opts    = swig_opts\n    ext.extra_compile_args = [\"-Wno-unused-variable\"]\n\n    sys.stderr.write(\"Extension build configuration adjusted:\\n\"\n                     \" include_dirs = {!r}\\n\"\n                     \" library_dirs = {!r}\\n\"\n                     \" libraries    = {!r}\\n\"\n                     \" swig_opts    = {!r}\\n\"\n                     .format(inc_dir, lib_dirs, libs, swig_opts))",
    "hash_value": "636911285a7128f95890e62cc93481d9",
    "detection_index": 1
  }
]