[
  {
    "metadata": {
      "package_name": "kodexa-7.4.414330611518",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/kodexa-7.4.414330611518.txt",
      "total_matches": 16
    }
  },
  {
    "pyfile": "client.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/kodexa-7.4.414330611518/kodexa-7.4.414330611518/kodexa/platform/client.py",
    "line_number": "6775",
    "type_description": "exfiltrate-sensitive-data",
    "original_snippet": "obj_response = requests.get(\nf\"{url}/api/account/me\",\nheaders={\"content-type\": \"application/json\",\n\"x-access-token\": token,\n\"cf-access-token\": os.environ.get(\"CF_TOKE...        )",
    "context_snippet": "    @staticmethod\n    def login(url, token):\n        \"\"\"\n        A static method to login to the Kodexa platform.\n\n        Args:\n            url (str): The URL for the Kodexa platform.\n            token (str): The email for the user.\n\n        Returns:\n            KodexaClient: A KodexaClient instance.\n\n        Raises:\n            Exception: If the status code is not 200.\n        \"\"\"\n\n        obj_response = requests.get(\n            f\"{url}/api/account/me\",\n            headers={\"content-type\": \"application/json\",\n                     \"x-access-token\": token,\n                     \"cf-access-token\": os.environ.get(\"CF_TOKEN\", \"\")}\n        )\n        if obj_response.status_code == 200:\n            return KodexaClient(url, obj_response.text)\n\n        raise Exception(f\"Check your URL and password [{obj_response.status_code}]\")",
    "hash_value": "aa7d5a1365310aaec1f5ff19dce5945a",
    "detection_index": 1
  },
  {
    "pyfile": "kodexa.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/kodexa-7.4.414330611518/kodexa-7.4.414330611518/kodexa/platform/kodexa.py",
    "line_number": "311",
    "type_description": "exfiltrate-sensitive-data",
    "original_snippet": "obj_response = requests.get(\nf\"{kodexa_url}/api/account/me\",\nheaders={\"content-type\": \"application/json\", \"x-access-token\": token, \"cf-access-token\": os.environ.get(\"CF_TOKEN\", \"\")}\n)",
    "context_snippet": "    @classmethod\n    def login(cls, kodexa_url, token, profile=None):\n        \"\"\"\n        Login to the Kodexa platform.\n\n        Args:\n            kodexa_url (str): The URL of the Kodexa platform.\n            token (str): The token to use for login.\n            profile (str, optional): The profile to use. Defaults to None.\n        \"\"\"\n        from requests.auth import HTTPBasicAuth\n\n        obj_response = requests.get(\n            f\"{kodexa_url}/api/account/me\",\n            headers={\"content-type\": \"application/json\", \"x-access-token\": token, \"cf-access-token\": os.environ.get(\"CF_TOKEN\", \"\")}\n        )\n        if obj_response.status_code == 200:\n            kodexa_config = get_config(profile, create=True)\n\n            if profile not in kodexa_config:\n                kodexa_config[profile] = {}\n\n            kodexa_config[profile][\"url\"] = kodexa_url\n            kodexa_config[profile][\"access_token\"] = token\n            save_config(kodexa_config)\n            print(\"Logged in\")\n        else:\n            print(f\"Check your URL and password [{obj_response.status_code}]\")",
    "hash_value": "e556ff32e186035c8f3495cab8ce6cce",
    "detection_index": 1
  }
]