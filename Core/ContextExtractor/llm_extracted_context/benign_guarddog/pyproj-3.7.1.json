[
  {
    "metadata": {
      "package_name": "pyproj-3.7.1",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/pyproj-3.7.1.txt",
      "total_matches": 1
    }
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyproj-3.7.1/pyproj-3.7.1/setup.py",
    "line_number": "43",
    "type_description": "code-execution",
    "original_snippet": "proj_ver = subprocess.check_output(str(proj), stderr=subprocess.STDOUT).decode(",
    "context_snippet": "import os\nimport platform\nimport re\nimport shutil\nimport subprocess\nimport sys\nfrom pathlib import Path\n\nPROJ_VERSION_SEARCH = re.compile(r\".*Rel\\.\\s+(?P<version>\\d+\\.\\d+\\.\\d+).*\")\nVERSION_SEARCH = re.compile(r\".*(?P<version>\\d+\\.\\d+\\.\\d+).*\")\n\ndef _parse_version(version: str) -> tuple[int, int, int]:\n    match = VERSION_SEARCH.search(version)\n    if not match:\n        raise SystemExit(\n            f\"PROJ version unable to be determined from {version}. \"\n            \"Please set the PROJ_VERSION environment variable.\"\n        )\n    return tuple(\n        int(ver) for ver in match.groupdict()[\"version\"].split(\".\", maxsplit=2)\n    )\n\ndef get_proj_version(proj_dir: Path) -> tuple[int, int, int]:\n    \"\"\"\n    Determine PROJ version.\n\n    Prefer PROJ_VERSION environment variable.\n    If PROJ_VERSION is not set, try to determine the version from the PROJ executable.\n    \"\"\"\n    proj_version = os.environ.get(\"PROJ_VERSION\")\n    if proj_version:\n        return _parse_version(proj_version)\n    proj = proj_dir / \"bin\" / \"proj\"\n    proj_ver = subprocess.check_output(str(proj), stderr=subprocess.STDOUT).decode(\n        \"ascii\"\n    )\n    match = PROJ_VERSION_SEARCH.search(proj_ver)\n    if not match:\n        raise SystemExit(\n            \"PROJ version unable to be determined. \"\n            \"Please set the PROJ_VERSION environment variable.\"\n        )\n    return _parse_version(match.groupdict()[\"version\"])",
    "hash_value": "ad1d7fa8512e3446beb8ee554b9b68b6",
    "detection_index": 1
  }
]