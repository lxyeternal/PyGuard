[
  {
    "metadata": {
      "package_name": "uamqp-1.6.11",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/uamqp-1.6.11.txt",
      "total_matches": 2
    }
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/uamqp-1.6.11/uamqp-1.6.11/setup.py",
    "line_number": "183",
    "type_description": "code-execution",
    "original_snippet": "subprocess.check_call(joined_cmd, shell=True, universal_newlines=True, env=build_env)",
    "context_snippet": "import os\nimport subprocess\nimport platform\nimport distutils\nfrom distutils import log as logger\n\ndef get_generator_flags():\n    flags = [\"-G\"]\n    if is_win:\n        flags.append(\"\\\"Visual Studio 17 2022\\\"\")\n        flags.append(\"-A\")\n        flags.append(\"ARM64\" if platform.machine() == \"ARM64\" else \"x64\" if is_x64 else \"Win32\")\n    else:\n        flags.append(\"\\\"Unix Makefiles\\\"\")\n    return \" \".join(flags)\n\ndef get_build_env():\n    build_env = os.environ.copy()\n    return {k.upper(): v for k, v in build_env.items()}\n\nclass build_ext(build_ext_orig):\n    def build_cmake(self, ext):\n        cwd = os.getcwd()\n        self.cmake_build_dir = self.build_temp + \"/cmake\"\n        create_folder_no_exception(self.cmake_build_dir)\n        extdir = self.get_ext_fullpath(ext.name)\n        create_folder_no_exception(extdir)\n        logger.info(\"will build uamqp in %s\", self.cmake_build_dir)\n        os.chdir(cwd + \"/\" + self.cmake_build_dir)\n        generator_flags = get_generator_flags()\n        logger.info(\"Building with generator flags: {}\".format(generator_flags))\n        build_env = get_build_env()\n        # Configure\n        configure_command = [\n            \"cmake\",\n            cwd + \"/src/vendor/azure-uamqp-c/\",\n            generator_flags,\n            \"-Duse_openssl:bool={}\".format(\"ON\" if use_openssl else \"OFF\"),\n            \"-Duse_default_uuid:bool=ON \",\n            \"-Duse_builtin_httpapi:bool=ON \",\n            \"-Dskip_samples:bool=ON\",\n            \"-DCMAKE_POSITION_INDEPENDENT_CODE=TRUE\",\n            \"-DCMAKE_BUILD_TYPE=Release\"\n        ]\n        joined_cmd = \" \".join(configure_command)\n        logger.info(\"calling %s\", joined_cmd)\n        subprocess.check_call(joined_cmd, shell=True, universal_newlines=True, env=build_env)",
    "hash_value": "8979619ed4127c4a17d90ad5d1633f7a",
    "detection_index": 1
  }
]