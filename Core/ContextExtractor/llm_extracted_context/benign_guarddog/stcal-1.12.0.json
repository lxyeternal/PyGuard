[
  {
    "metadata": {
      "package_name": "stcal-1.12.0",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/stcal-1.12.0.txt",
      "total_matches": 1
    }
  },
  {
    "pyfile": "astrometric_utils.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/stcal-1.12.0/stcal-1.12.0/src/stcal/tweakreg/astrometric_utils.py",
    "line_number": "207",
    "type_description": "exfiltrate-sensitive-data",
    "original_snippet": "rawcat = requests.get(service_url, headers=headers, timeout=timeout)",
    "context_snippet": "import requests\nfrom astropy.table import Table\n\nSERVICELOCATION = os.environ.get(ASTROMETRIC_CAT_ENVVAR, DEF_CAT_URL)\nTIMEOUT = 30.0  # in seconds\n\ndef get_catalog(\n    right_ascension,\n    declination,\n    epoch=2016.0,\n    search_radius=0.1,\n    catalog=\"GAIADR3\",\n    timeout=TIMEOUT,\n):\n    \"\"\"Extract catalog from VO web service.\n    ...\n    \"\"\"\n    service_type = \"vo/CatalogSearch.aspx\"\n    spec_str = \"RA={}&DEC={}&EPOCH={}&SR={}&FORMAT={}&CAT={}&MINDET=5\"\n    headers = {\"Content-Type\": \"text/csv\"}\n    fmt = \"CSV\"\n\n    spec = spec_str.format(\n        right_ascension,\n        declination,\n        epoch,\n        search_radius,\n        fmt,\n        catalog\n    )\n    service_url = f\"{SERVICELOCATION}/{service_type}?{spec}\"\n    try:\n        rawcat = requests.get(service_url, headers=headers, timeout=timeout)\n    except requests.exceptions.ConnectionError:\n        raise requests.exceptions.ConnectionError(\n            \"Could not connect to the VO API server. Try again later.\"\n        )\n    except requests.exceptions.Timeout:\n        raise requests.exceptions.Timeout(\"The request to the VO API server timed out.\")\n    except requests.exceptions.RequestException:\n        raise requests.exceptions.RequestException(\n            \"There was an unexpected error with the request.\"\n        )\n    r_contents = rawcat.content.decode()  # convert from bytes to a String\n    rstr = r_contents.split(\"\\r\\n\")\n    # remove initial line describing the number of sources returned\n    # CRITICAL to proper interpretation of CSV data\n    del rstr[0]\n\n    return Table.read(rstr, format=\"csv\")",
    "hash_value": "b7b308b19068ec763f47e0891595d3b8",
    "detection_index": 1
  }
]