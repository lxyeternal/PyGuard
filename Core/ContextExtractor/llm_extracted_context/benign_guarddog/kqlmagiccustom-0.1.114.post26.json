[
  {
    "metadata": {
      "package_name": "kqlmagiccustom-0.1.114.post26",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/kqlmagiccustom-0.1.114.post26.txt",
      "total_matches": 2
    }
  },
  {
    "pyfile": "my_aad_helper.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/kqlmagiccustom-0.1.114.post26/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py",
    "line_number": "346",
    "type_description": "clipboard-access",
    "original_snippet": "pyperclip.copy(device_code)",
    "context_snippet": "def acquire_token(self):\n    \"\"\"Acquire tokens from AAD.\"\"\"\n    previous_token = self._current_token\n    try:\n        ...\n        elif self._authentication_method is AuthenticationMethod.aad_code_login:\n            logger().debug(f\"_MyAadHelper::acquire_token - aad/code - resource: '{self._resource}', client: '{self._client_id}'\")\n            code: dict = self._current_adal_context.acquire_user_code(self._resource, self._client_id)\n            url = code[OAuth2DeviceCodeResponseParameters.VERIFICATION_URL]\n            device_code = code[OAuth2DeviceCodeResponseParameters.USER_CODE].strip()\n\n            device_code_login_notification = self._options.get(\"device_code_login_notification\")\n            if device_code_login_notification == \"auto\":\n                if self._options.get(\"notebook_app\") in [\"azuredatastudiosaw\"]:\n                    device_code_login_notification = \"terminal\"\n                elif self._options.get(\"notebook_app\") in [\"ipython\"]:\n                    device_code_login_notification = \"popup_interaction\"\n                elif self._options.get(\"notebook_app\") in [\"visualstudiocode\", \"azuredatastudio\"]:\n                    device_code_login_notification = \"popup_interaction\"\n                elif self._options.get(\"notebook_app\") in [\"nteract\"]:\n\n                    if self._options.get(\"kernel_location\") == \"local\":\n                        # ntreact cannot execute authentication script, workaround using temp_file_server webbrowser\n                        if self._options.get(\"temp_files_server_address\") is not None:\n                            import urllib.parse\n                            indirect_url = f'{self._options.get(\"temp_files_server_address\")}/webbrowser?url={urllib.parse.quote(url)}&kernelid={self._options.get(\"kernel_id\")}'\n                            url = indirect_url\n                            device_code_login_notification = \"popup_interaction\"\n                        else:\n                            device_code_login_notification = \"browser\"\n                    else:\n                        device_code_login_notification = \"terminal\"\n                else:\n                    device_code_login_notification = \"button\"\n\n            if (self._options.get(\"kernel_location\") == \"local\"\n                    or device_code_login_notification in [\"browser\"]\n                    or (device_code_login_notification == \"popup_interaction\" and self._options.get(\"popup_interaction\") == \"webbrowser_open_at_kernel\")):\n                # copy code to local clipboard\n                try:\n                    pyperclip = Dependencies.get_module(\"pyperclip\", dont_throw=True)\n                    if pyperclip is not None:\n                        pyperclip.copy(device_code)\n                except: # pylint: disable=bare-except\n                    pass\n            ...\n",
    "hash_value": "d3f44ec853181dbc418615cc23d33efc",
    "detection_index": 1
  },
  {
    "pyfile": "my_aad_helper_msal.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/kqlmagiccustom-0.1.114.post26/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py",
    "line_number": "518",
    "type_description": "clipboard-access",
    "original_snippet": "pyperclip.copy(device_code)",
    "context_snippet": "def acquire_token(self):\n    \"\"\"Acquire tokens from AAD.\"\"\"\n    acquire_token_result = None\n    previous_token = self._current_token\n    try:\n        ...\n        elif self._authentication_method is AuthenticationMethod.aad_code_login:\n            flow = self._current_msal_client_app.initiate_device_flow(scopes=self._scopes)\n            url = flow[OAuth2DeviceCodeResponseParameters.VERIFICATION_URL]\n            device_code = flow[OAuth2DeviceCodeResponseParameters.USER_CODE].strip()\n            ...\n            if (self._options.get(\"kernel_location\") == \"local\"\n                    or device_code_login_notification in [\"browser\", \"browser_reference\"]\n                    or (device_code_login_notification == \"popup_interaction\" and self._options.get(\"popup_interaction\") == \"webbrowser_open_at_kernel\")):\n                # copy code to local clipboard\n                try:\n                    pyperclip = Dependencies.get_module(\"pyperclip\", dont_throw=True)\n                    if pyperclip is not None:\n                        pyperclip.copy(device_code)\n                except: # pylint: disable=bare-except\n                    pass\n            ...",
    "hash_value": "31c8de2794967f9bc5136f4ccf4b7264",
    "detection_index": 1
  }
]