[
  {
    "metadata": {
      "package_name": "flaskfarm-4.1.37",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/flaskfarm-4.1.37.txt",
      "total_matches": 1
    }
  },
  {
    "pyfile": "discord.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flaskfarm-4.1.37/FlaskFarm-4.1.37/flaskfarm/lib/support/base/discord.py",
    "line_number": "228",
    "type_description": "shady-links",
    "original_snippet": "def discord_cdn(cls, byteio=None, filepath=None, filename=None, webhook_url=\"https://discord.com/api/webhooks/1050549730964410470/ttge1ggOfIxrCSeTmYbIIsUWyMGAQj-nN6QBgwZTqLcHtUKcqjZ8wFWSWAhHmZne57t7\", content='', retry=True):",
    "context_snippet": "@classmethod\n    def discord_cdn(cls, byteio=None, filepath=None, filename=None, webhook_url=\"https://discord.com/api/webhooks/1050549730964410470/ttge1ggOfIxrCSeTmYbIIsUWyMGAQj-nN6QBgwZTqLcHtUKcqjZ8wFWSWAhHmZne57t7\", content='', retry=True):\n        data = None\n        if webhook_url is None:\n            webhook_url =  webhook_list[random.randint(0,9)] \n\n        try:\n            webhook = DiscordWebhook(url=webhook_url, content=content)\n            if byteio is None and filepath is not None:\n                import io\n                with open(filepath, 'rb') as fh:\n                    byteio = io.BytesIO(fh.read())\n                \n            webhook.add_file(file=byteio.getvalue(), filename=filename)\n            embed = DiscordEmbed()\n            response = webhook.execute()\n            data = None\n            if type(response) == type([]):\n                if len(response) > 0:\n                    data = response[0].json()\n            else:\n                data = response.json()    \n            \n            if data is not None and 'attachments' in data:\n                target = data['attachments'][0]['url']\n                if requests.get(target).status_code == 200:\n                    return target\n            if retry:\n                time.sleep(1)\n                return cls.discord_proxy_image_localfile(filepath, retry=False)\n        except Exception as e: \n            logger.error(f\"Exception:{str(e)}\")\n            logger.error(traceback.format_exc())\n            if retry:\n                time.sleep(1)\n                return cls.discord_proxy_image_localfile(filepath, retry=False)",
    "hash_value": "18244409a89f62905e8bf08930079813",
    "detection_index": 1
  }
]