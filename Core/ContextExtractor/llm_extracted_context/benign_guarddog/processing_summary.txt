Malicious Code Processing Summary
==============

Total txt files: 9131
Successfully processed: 22
Skipped (Already exists): 358
Skipped (Duplicate code): 0
Processing failed: 0

Duplicate malicious code patterns: 13

Top 10 duplicate malicious code patterns:
-------------------

1. Occurrence count: 5 packages
   Type: code-execution
   Hash value: 5c5f9a0ff3d27d1291d145856fd9122e
   First analysis package: basicsr-1.4.2
   Code:
     import os
     import subprocess
     
     def get_git_hash():
     
         def _minimal_ext_cmd(cmd):
             # construct minimal environment
             env = {}
             for k in ['SYSTEMROOT', 'PATH', 'HOME']:
                 v = os.environ.get(k)
                 if v is not None:
                     env[k] = v
             # LANGUAGE is used on win32
             env['LANGUAGE'] = 'C'
             env['LANG'] = 'C'
             env['LC_ALL'] = 'C'
             out = subprocess.Popen(cmd, stdout=subprocess.PIPE, env=env).communicate()[0]
             return out
     
         try:
             out = _minimal_ext_cmd(['git', 'rev-parse', 'HEAD'])
             sha = out.strip().decode('ascii')
         except OSError:
             sha = 'unknown'
     
         return sha
   Package list: basicsr-1.4.2, facexlib-0.3.0, pyiqa-0.1.13, gfpgan-1.3.8, realesrgan-0.3.0

2. Occurrence count: 4 packages
   Type: code-execution
   Hash value: b70511a5aec8110591ad3e376676d74e
   First analysis package: correctionlib-2.6.4
   Code:
     with remove_output("pybind11/include", "pybind11/share"):
         # Generate the files if they are not present.
         with TemporaryDirectory() as tmpdir:
             cmd = ["cmake", "-S", ".", "-B", tmpdir] + [
                 "-DCMAKE_INSTALL_PREFIX=pybind11",
                 "-DBUILD_TESTING=OFF",
                 "-DPYBIND11_NOPYTHON=ON",
                 "-Dprefix_for_pc_file=${pcfiledir}/../../",
             ]
             if "CMAKE_ARGS" in os.environ:
                 fcommand = [
                     c
                     for c in os.environ["CMAKE_ARGS"].split()
                     if "DCMAKE_INSTALL_PREFIX" not in c
                 ]
                 cmd += fcommand
             subprocess.run(cmd, check=True, cwd=DIR, stdout=sys.stdout, stderr=sys.stderr)
             subprocess.run(
                 ["cmake", "--install", tmpdir],
                 check=True,
                 cwd=DIR,
                 stdout=sys.stdout,
                 stderr=sys.stderr,
             )
   Package list: correctionlib-2.6.4, ntgcalls-1.3.3, mmcif-0.91.0, opencc-1.1.9

3. Occurrence count: 2 packages
   Type: shady-links
   Hash value: c49e8769f1653dfa2f41e4513ff280c7
   First analysis package: py_cord-2.6.1
   Code:
         @property
         def url(self) -> str:
             """Returns the webhook's url."""
             return f"https://discord.com/api/webhooks/{self.id}/{self.token}"
   Package list: py_cord-2.6.1, py_cord-2.6.1

4. Occurrence count: 2 packages
   Type: obfuscation
   Hash value: 963679988aef866f5c97b4458d548a05
   First analysis package: h2o_pysparkling_3.2-3.46.0.6.post1
   Code:
     def get_builtin(fn_name):
         import builtins
         return getattr(builtins, fn_name, None)
   Package list: h2o_pysparkling_3.2-3.46.0.6.post1, h2o_pysparkling_3.1-3.46.0.6.post1

5. Occurrence count: 2 packages
   Type: exfiltrate-sensitive-data
   Hash value: 15c5f6856345eae5ab4375652f12184b
   First analysis package: license_expression-30.4.1
   Code:
     import requests
     
     DEJACODE_API_KEY = os.environ.get("DEJACODE_API_KEY", "")
     DEJACODE_API_URL = os.environ.get("DEJACODE_API_URL", "")
     
     DEJACODE_API_URL_PACKAGES = f"{DEJACODE_API_URL}packages/"
     DEJACODE_API_HEADERS = {
         "Authorization": "Token {}".format(DEJACODE_API_KEY),
         "Accept": "application/json; indent=4",
     }
     
     def can_do_api_calls():
         if not DEJACODE_API_KEY and DEJACODE_API_URL:
             print(
                 "DejaCode DEJACODE_API_KEY and DEJACODE_API_URL not configured. Doing nothing")
             return False
         else:
             return True
     
     def fetch_dejacode_packages(params):
         """
         Return a list of package data mappings calling the package API with using
         `params` or an empty list.
         """
         if not can_do_api_calls():
             return []
     
         response = requests.get(
             DEJACODE_API_URL_PACKAGES,
             params=params,
             headers=DEJACODE_API_HEADERS,
         )
     
         return response.json()["results"]
   Package list: license_expression-30.4.1, saneyaml-0.6.1

6. Occurrence count: 2 packages
   Type: shady-links
   Hash value: 9853238667e9820943bfc82acda771b0
   First analysis package: discord_py-2.5.2
   Code:
         @property
         def url(self) -> str:
             """:class:`str` : Returns the webhook's url."""
             return f'https://discord.com/api/webhooks/{self.id}/{self.token}'
   Package list: discord_py-2.5.2, discord_py-2.5.2

7. Occurrence count: 2 packages
   Type: code-execution
   Hash value: 2b292210137141c6ef698a3effd59000
   First analysis package: mmcif-0.91.0
   Code:
     with remove_output("pybind11/include", "pybind11/share"):
         # Generate the files if they are not present.
         with TemporaryDirectory() as tmpdir:
             cmd = ["cmake", "-S", ".", "-B", tmpdir] + [
                 "-DCMAKE_INSTALL_PREFIX=pybind11",
                 "-DBUILD_TESTING=OFF",
                 "-DPYBIND11_NOPYTHON=ON",
             ]
             cmake_opts = dict(cwd=DIR, stdout=sys.stdout, stderr=sys.stderr)
             subprocess.check_call(cmd, **cmake_opts)
             subprocess.check_call(["cmake", "--install", tmpdir], **cmake_opts)
     
         txt = get_and_replace(setup_py, version=version, extra_cmd=extra_cmd)
         code = compile(txt, setup_py, "exec")
         exec(code, {"SDist": SDist})
   Package list: mmcif-0.91.0, praat_parselmouth-0.4.5

8. Occurrence count: 2 packages
   Type: obfuscation
   Hash value: e32ba70876fe3c210676eeef3506c77a
   First analysis package: wrapt-1.17.2
   Code:
     else:
         string_types = str,
     
         import builtins
     
         exec_ = getattr(builtins, "exec")
         del builtins
   Package list: wrapt-1.17.2, newrelic-10.8.1

9. Occurrence count: 2 packages
   Type: obfuscation
   Hash value: 780de2fab062496f7f0a675078b56254
   First analysis package: pydevd-3.3.0
   Code:
     def get_interpreter():
         try:
             interpreterInterface = getattr(__builtin__, "interpreter")
         except AttributeError:
             interpreterInterface = InterpreterInterface(None, None, threading.current_thread())
             __builtin__.interpreter = interpreterInterface
             sys.stderr.write(interpreterInterface.get_greeting_msg())
             sys.stderr.flush()
     
         return interpreterInterface
   Package list: pydevd-3.3.0, debugpy-1.8.14

10. Occurrence count: 2 packages
   Type: obfuscation
   Hash value: aca334754abb717ea9b8a08f562b7dfe
   First analysis package: pydevd-3.3.0
   Code:
     if PY3:
         import builtins
     
         exec_ = getattr(builtins, "exec")
     
         def reraise(tp, value, tb=None):
             if value is None:
                 value = tp()
             if value.__traceback__ is not tb:
                 raise value.with_traceback(tb)
             raise value
     
     else:
     
         def exec_(_code_, _globs_=None, _locs_=None):
             """Execute code in a namespace."""
             if _globs_ is None:
                 frame = sys._getframe(1)
                 _globs_ = frame.f_globals
                 if _locs_ is None:
                     _locs_ = frame.f_locals
                 del frame
             elif _locs_ is None:
                 _locs_ = _globs_
             exec("""exec _code_ in _globs_, _locs_""")
     
         exec_(
             """def reraise(tp, value, tb=None):
         raise tp, value, tb
     """
         )
   Package list: pydevd-3.3.0, debugpy-1.8.14

