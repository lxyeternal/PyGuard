[
  {
    "metadata": {
      "package_name": "dagster_cloud-1.10.9",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/dagster_cloud-1.10.9.txt",
      "total_matches": 1
    }
  },
  {
    "pyfile": "io_manager.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/dagster_cloud-1.10.9/dagster_cloud-1.10.9/dagster_cloud/serverless/io_manager.py",
    "line_number": "35",
    "type_description": "exfiltrate-sensitive-data",
    "original_snippet": "aws_creds = requests.get(f\"http://{ECS_AGENT_IP}{relative_uri}\").json()",
    "context_snippet": "import os\nimport requests\nECS_AGENT_IP = \"169.254.170.2\"\n\nclass PickledObjectServerlessIOManager(UPathIOManager):\n    def _refresh_boto_session(self) -> tuple[boto3.Session, datetime.datetime]:\n        # We have to do this whacky way to get credentials to ensure that we get iam role\n        # we assigned to the task. If we used the default boto behavior, it could get overriden\n        # when users set AWS env vars.\n        relative_uri = os.environ[\"AWS_CONTAINER_CREDENTIALS_RELATIVE_URI\"]\n        aws_creds = requests.get(f\"http://{ECS_AGENT_IP}{relative_uri}\").json()\n        session = boto3.Session(\n            aws_access_key_id=aws_creds[\"AccessKeyId\"],\n            aws_secret_access_key=aws_creds[\"SecretAccessKey\"],\n            aws_session_token=aws_creds[\"Token\"],\n        )\n        expiration = parser.parse(aws_creds[\"Expiration\"])\n        return session, expiration  # pyright: ignore[reportReturnType]",
    "hash_value": "74403c34f0a7f9dc109769fbbd6e55c0",
    "detection_index": 1
  }
]