[
  {
    "metadata": {
      "package_name": "sqlmesh-0.171.3.dev4",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/sqlmesh-0.171.3.dev4.txt",
      "total_matches": 1
    }
  },
  {
    "pyfile": "controller.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py",
    "line_number": "517",
    "type_description": "exfiltrate-sensitive-data",
    "original_snippet": "request = requests.post(\nos.environ[\"GITHUB_GRAPHQL_URL\"],\njson={\"query\": query},\nheaders=headers,\n)",
    "context_snippet": "def _get_merge_state_status(self) -> MergeStateStatus:\n    \"\"\"\n    This feature is currently in preview and therefore not available in the python module.\n    So we query GraphQL directly instead.\n    \"\"\"\n    headers = {\n        \"Authorization\": f\"Bearer {self._token}\",\n        \"Accept\": \"application/vnd.github.merge-info-preview+json\",\n    }\n    query = f\"\"\"{{\n        repository(owner: \"{self._event.pull_request_info.owner}\", name: \"{self._event.pull_request_info.repo}\") {{\n            pullRequest(number: {self._event.pull_request_info.pr_number}) {{\n                title\n                state\n                mergeStateStatus\n            }}\n        }}\n    }}\"\"\"\n    request = requests.post(\n        os.environ[\"GITHUB_GRAPHQL_URL\"],\n        json={\"query\": query},\n        headers=headers,\n    )\n    if request.status_code == 200:\n        merge_status = MergeStateStatus(\n            request.json()[\"data\"][\"repository\"][\"pullRequest\"][\"mergeStateStatus\"].lower()\n        )\n        logger.debug(f\"Merge state status: {merge_status.value}\")\n        return merge_status\n    raise CICDBotError(f\"Unable to get merge state status. Error: {request.text}\")",
    "hash_value": "33df3e40ce9d71c6b0e3c1f752cbc73f",
    "detection_index": 1
  }
]