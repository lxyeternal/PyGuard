[
  {
    "metadata": {
      "package_name": "clr_loader-0.2.7.post0",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/clr_loader-0.2.7.post0.txt",
      "total_matches": 1
    }
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/clr_loader-0.2.7.post0/clr_loader-0.2.7.post0/setup.py",
    "line_number": "74",
    "type_description": "code-execution",
    "original_snippet": "self.spawn([\"dotnet\", \"build\", lib.path] + opts)",
    "context_snippet": "class build_dotnet(Command):\n    \"\"\"Build command for dotnet-cli based builds\"\"\"\n\n    description = \"Build DLLs with dotnet-cli\"\n    user_options = [\n        (\"dotnet-config=\", None, \"dotnet build configuration\"),\n        (\n            \"inplace\",\n            \"i\",\n            \"ignore build-lib and put compiled extensions into the source \"\n            + \"directory alongside your pure Python modules\",\n        ),\n    ]\n\n    def initialize_options(self):\n        self.dotnet_config = None\n        self.build_lib = None\n        self.inplace = False\n\n    def finalize_options(self):\n        if self.dotnet_config is None:\n            self.dotnet_config = \"release\"\n\n        build = self.distribution.get_command_obj(\"build\")\n        build.ensure_finalized()\n        if self.inplace:\n            self.build_lib = \".\"\n        else:\n            self.build_lib = build.build_lib\n\n    def run(self):\n        dotnet_modules = self.distribution.dotnet_libs\n\n        for lib in dotnet_modules:\n            output = os.path.join(\n                os.path.abspath(self.build_lib), lib.args.pop(\"output\")\n            )\n            rename = lib.args.pop(\"rename\", {})\n\n            opts = sum(\n                [\n                    [\"--\" + name.replace(\"_\", \"-\"), value]\n                    for name, value in lib.args.items()\n                ],\n                [],\n            )\n\n            opts.extend([\"--configuration\", self.dotnet_config])\n            opts.extend([\"--output\", output])\n\n            self.announce(\"Running dotnet build...\", level=distutils.log.INFO)\n            self.spawn([\"dotnet\", \"build\", lib.path] + opts)\n\n            for k, v in rename.items():\n                source = os.path.join(output, k)\n                dest = os.path.join(output, v)\n\n                if os.path.isfile(source):\n                    try:\n                        os.remove(dest)\n                    except OSError:\n                        pass\n\n                    self.move_file(src=source, dst=dest, level=distutils.log.INFO)\n                else:\n                    self.warn(\n                        \"Can't find file to rename: {}, current dir: {}\".format(\n                            source, os.getcwd()\n                        )\n                    )",
    "hash_value": "b0a3a699f2f02cb76e3cec4dd30286bf",
    "detection_index": 1
  }
]