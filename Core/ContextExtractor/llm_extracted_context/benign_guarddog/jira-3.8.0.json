[
  {
    "metadata": {
      "package_name": "jira-3.8.0",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/jira-3.8.0.txt",
      "total_matches": 1
    }
  },
  {
    "pyfile": "make_local_jira_user.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/jira-3.8.0/jira-3.8.0/make_local_jira_user.py",
    "line_number": "45",
    "type_description": "exfiltrate-sensitive-data",
    "original_snippet": "requests.get(CI_JIRA_URL + \"rest/api/2/permissions\")",
    "context_snippet": "import sys\nimport time\nfrom os import environ\n\nimport requests\n\nfrom jira import JIRA\n\nCI_JIRA_URL = environ[\"CI_JIRA_URL\"]\n\nif __name__ == \"__main__\":\n    if environ.get(\"CI_JIRA_TYPE\", \"Server\").upper() == \"CLOUD\":\n        print(\"Do not need to create a user for Jira Cloud CI, quitting.\")\n        sys.exit()\n\n    start_time = time.time()\n    timeout_mins = 15\n    print(\n        \"waiting for instance of jira to be running, to add a user for CI system:\\n\"\n        f\" timeout = {timeout_mins} mins\"\n    )\n    while True:\n        try:\n            requests.get(CI_JIRA_URL + \"rest/api/2/permissions\")\n            print(\"JIRA IS REACHABLE\")\n            add_user_to_jira()\n            break\n        except (requests.exceptions.Timeout, requests.exceptions.ConnectionError) as ex:\n            print(f\"encountered {ex} while waiting for the JiraServer docker\")\n            time.sleep(20)\n        if start_time + 60 * timeout_mins < time.time():\n            raise TimeoutError(\n                f\"Jira server wasn't reachable within timeout {timeout_mins}\"\n            )",
    "hash_value": "990059feb2019731570707a787c0a0e1",
    "detection_index": 1
  }
]