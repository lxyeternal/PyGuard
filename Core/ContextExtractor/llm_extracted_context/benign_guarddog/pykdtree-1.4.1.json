[
  {
    "metadata": {
      "package_name": "pykdtree-1.4.1",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/pykdtree-1.4.1.txt",
      "total_matches": 1
    }
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pykdtree-1.4.1/pykdtree-1.4.1/setup.py",
    "line_number": "173",
    "type_description": "code-execution",
    "original_snippet": "query = run(cmd, shell=True, check=False, capture_output=True)",
    "context_snippet": "def _compile_link_paths_from_manifest(cmd):\n    \"\"\"Parse include and library paths from OSX package managers.\n\n    Example executions::\n\n        # Homebrew\n        $ brew ls --verbose libomp\n        /opt/homebrew/Cellar/libomp/15.0.7/INSTALL_RECEIPT.json\n        /opt/homebrew/Cellar/libomp/15.0.7/.brew/libomp.rb\n        /opt/homebrew/Cellar/libomp/15.0.7/include/ompt.h\n        /opt/homebrew/Cellar/libomp/15.0.7/include/omp.h\n        /opt/homebrew/Cellar/libomp/15.0.7/include/omp-tools.h\n        /opt/homebrew/Cellar/libomp/15.0.7/lib/libomp.dylib\n        /opt/homebrew/Cellar/libomp/15.0.7/lib/libomp.a\n\n        # MacPorts\n        $ port contents libomp\n        Port libomp contains:\n          /opt/local/include/libomp/omp-tools.h\n          /opt/local/include/libomp/omp.h\n          /opt/local/include/libomp/ompt.h\n          /opt/local/lib/libomp/libgomp.dylib\n          /opt/local/lib/libomp/libiomp5.dylib\n          /opt/local/lib/libomp/libomp.dylib\n          /opt/local/share/doc/libomp/LICENSE.TXT\n          /opt/local/share/doc/libomp/README.txt\n\n    \"\"\"\n    from subprocess import run\n    query = run(cmd, shell=True, check=False, capture_output=True)\n    if query.returncode != 0:\n        return None, None\n    manifest = query.stdout.decode(\"UTF-8\")\n    # find all the unique directories mentioned in the manifest\n    dirs = set(os.path.split(filename)[0] for filename in re.findall(r'^\\s*(/.*?)\\s*$', manifest, re.MULTILINE))\n    # find a unique libdir and incdir\n    inc = tuple(d for d in dirs if re.search(r'/include(\\W|$)', d))\n    lib = tuple(d for d in dirs if re.search(r'/lib(\\W|$)', d))\n    # only return success if there's no ambiguity\n    return (inc + lib) if len(inc) == 1 and len(lib) == 1 else (None, None)",
    "hash_value": "d7ebd695f33978cba3a39ca755206115",
    "detection_index": 1
  }
]