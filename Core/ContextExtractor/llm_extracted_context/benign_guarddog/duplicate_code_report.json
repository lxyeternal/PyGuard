[
  {
    "hash": "5c5f9a0ff3d27d1291d145856fd9122e",
    "count": 5,
    "packages": [
      "basicsr-1.4.2",
      "facexlib-0.3.0",
      "pyiqa-0.1.13",
      "gfpgan-1.3.8",
      "realesrgan-0.3.0"
    ],
    "code": "import os\nimport subprocess\n\ndef get_git_hash():\n\n    def _minimal_ext_cmd(cmd):\n        # construct minimal environment\n        env = {}\n        for k in ['SYSTEMROOT', 'PATH', 'HOME']:\n            v = os.environ.get(k)\n            if v is not None:\n                env[k] = v\n        # LANGUAGE is used on win32\n        env['LANGUAGE'] = 'C'\n        env['LANG'] = 'C'\n        env['LC_ALL'] = 'C'\n        out = subprocess.Popen(cmd, stdout=subprocess.PIPE, env=env).communicate()[0]\n        return out\n\n    try:\n        out = _minimal_ext_cmd(['git', 'rev-parse', 'HEAD'])\n        sha = out.strip().decode('ascii')\n    except OSError:\n        sha = 'unknown'\n\n    return sha",
    "type": "code-execution",
    "first_analysis": "basicsr-1.4.2",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/basicsr-1.4.2.txt"
  },
  {
    "hash": "b70511a5aec8110591ad3e376676d74e",
    "count": 4,
    "packages": [
      "correctionlib-2.6.4",
      "ntgcalls-1.3.3",
      "mmcif-0.91.0",
      "opencc-1.1.9"
    ],
    "code": "with remove_output(\"pybind11/include\", \"pybind11/share\"):\n    # Generate the files if they are not present.\n    with TemporaryDirectory() as tmpdir:\n        cmd = [\"cmake\", \"-S\", \".\", \"-B\", tmpdir] + [\n            \"-DCMAKE_INSTALL_PREFIX=pybind11\",\n            \"-DBUILD_TESTING=OFF\",\n            \"-DPYBIND11_NOPYTHON=ON\",\n            \"-Dprefix_for_pc_file=${pcfiledir}/../../\",\n        ]\n        if \"CMAKE_ARGS\" in os.environ:\n            fcommand = [\n                c\n                for c in os.environ[\"CMAKE_ARGS\"].split()\n                if \"DCMAKE_INSTALL_PREFIX\" not in c\n            ]\n            cmd += fcommand\n        subprocess.run(cmd, check=True, cwd=DIR, stdout=sys.stdout, stderr=sys.stderr)\n        subprocess.run(\n            [\"cmake\", \"--install\", tmpdir],\n            check=True,\n            cwd=DIR,\n            stdout=sys.stdout,\n            stderr=sys.stderr,\n        )",
    "type": "code-execution",
    "first_analysis": "correctionlib-2.6.4",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/correctionlib-2.6.4.txt"
  },
  {
    "hash": "c49e8769f1653dfa2f41e4513ff280c7",
    "count": 2,
    "packages": [
      "py_cord-2.6.1",
      "py_cord-2.6.1"
    ],
    "code": "    @property\n    def url(self) -> str:\n        \"\"\"Returns the webhook's url.\"\"\"\n        return f\"https://discord.com/api/webhooks/{self.id}/{self.token}\"",
    "type": "shady-links",
    "first_analysis": "py_cord-2.6.1",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/py_cord-2.6.1.txt"
  },
  {
    "hash": "963679988aef866f5c97b4458d548a05",
    "count": 2,
    "packages": [
      "h2o_pysparkling_3.2-3.46.0.6.post1",
      "h2o_pysparkling_3.1-3.46.0.6.post1"
    ],
    "code": "def get_builtin(fn_name):\n    import builtins\n    return getattr(builtins, fn_name, None)",
    "type": "obfuscation",
    "first_analysis": "h2o_pysparkling_3.2-3.46.0.6.post1",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/h2o_pysparkling_3.2-3.46.0.6.post1.txt"
  },
  {
    "hash": "15c5f6856345eae5ab4375652f12184b",
    "count": 2,
    "packages": [
      "license_expression-30.4.1",
      "saneyaml-0.6.1"
    ],
    "code": "import requests\n\nDEJACODE_API_KEY = os.environ.get(\"DEJACODE_API_KEY\", \"\")\nDEJACODE_API_URL = os.environ.get(\"DEJACODE_API_URL\", \"\")\n\nDEJACODE_API_URL_PACKAGES = f\"{DEJACODE_API_URL}packages/\"\nDEJACODE_API_HEADERS = {\n    \"Authorization\": \"Token {}\".format(DEJACODE_API_KEY),\n    \"Accept\": \"application/json; indent=4\",\n}\n\ndef can_do_api_calls():\n    if not DEJACODE_API_KEY and DEJACODE_API_URL:\n        print(\n            \"DejaCode DEJACODE_API_KEY and DEJACODE_API_URL not configured. Doing nothing\")\n        return False\n    else:\n        return True\n\ndef fetch_dejacode_packages(params):\n    \"\"\"\n    Return a list of package data mappings calling the package API with using\n    `params` or an empty list.\n    \"\"\"\n    if not can_do_api_calls():\n        return []\n\n    response = requests.get(\n        DEJACODE_API_URL_PACKAGES,\n        params=params,\n        headers=DEJACODE_API_HEADERS,\n    )\n\n    return response.json()[\"results\"]",
    "type": "exfiltrate-sensitive-data",
    "first_analysis": "license_expression-30.4.1",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/license_expression-30.4.1.txt"
  },
  {
    "hash": "9853238667e9820943bfc82acda771b0",
    "count": 2,
    "packages": [
      "discord_py-2.5.2",
      "discord_py-2.5.2"
    ],
    "code": "    @property\n    def url(self) -> str:\n        \"\"\":class:`str` : Returns the webhook's url.\"\"\"\n        return f'https://discord.com/api/webhooks/{self.id}/{self.token}'",
    "type": "shady-links",
    "first_analysis": "discord_py-2.5.2",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/discord_py-2.5.2.txt"
  },
  {
    "hash": "2b292210137141c6ef698a3effd59000",
    "count": 2,
    "packages": [
      "mmcif-0.91.0",
      "praat_parselmouth-0.4.5"
    ],
    "code": "with remove_output(\"pybind11/include\", \"pybind11/share\"):\n    # Generate the files if they are not present.\n    with TemporaryDirectory() as tmpdir:\n        cmd = [\"cmake\", \"-S\", \".\", \"-B\", tmpdir] + [\n            \"-DCMAKE_INSTALL_PREFIX=pybind11\",\n            \"-DBUILD_TESTING=OFF\",\n            \"-DPYBIND11_NOPYTHON=ON\",\n        ]\n        cmake_opts = dict(cwd=DIR, stdout=sys.stdout, stderr=sys.stderr)\n        subprocess.check_call(cmd, **cmake_opts)\n        subprocess.check_call([\"cmake\", \"--install\", tmpdir], **cmake_opts)\n\n    txt = get_and_replace(setup_py, version=version, extra_cmd=extra_cmd)\n    code = compile(txt, setup_py, \"exec\")\n    exec(code, {\"SDist\": SDist})",
    "type": "code-execution",
    "first_analysis": "mmcif-0.91.0",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/mmcif-0.91.0.txt"
  },
  {
    "hash": "e32ba70876fe3c210676eeef3506c77a",
    "count": 2,
    "packages": [
      "wrapt-1.17.2",
      "newrelic-10.8.1"
    ],
    "code": "else:\n    string_types = str,\n\n    import builtins\n\n    exec_ = getattr(builtins, \"exec\")\n    del builtins",
    "type": "obfuscation",
    "first_analysis": "wrapt-1.17.2",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/wrapt-1.17.2.txt"
  },
  {
    "hash": "780de2fab062496f7f0a675078b56254",
    "count": 2,
    "packages": [
      "pydevd-3.3.0",
      "debugpy-1.8.14"
    ],
    "code": "def get_interpreter():\n    try:\n        interpreterInterface = getattr(__builtin__, \"interpreter\")\n    except AttributeError:\n        interpreterInterface = InterpreterInterface(None, None, threading.current_thread())\n        __builtin__.interpreter = interpreterInterface\n        sys.stderr.write(interpreterInterface.get_greeting_msg())\n        sys.stderr.flush()\n\n    return interpreterInterface",
    "type": "obfuscation",
    "first_analysis": "pydevd-3.3.0",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/pydevd-3.3.0.txt"
  },
  {
    "hash": "aca334754abb717ea9b8a08f562b7dfe",
    "count": 2,
    "packages": [
      "pydevd-3.3.0",
      "debugpy-1.8.14"
    ],
    "code": "if PY3:\n    import builtins\n\n    exec_ = getattr(builtins, \"exec\")\n\n    def reraise(tp, value, tb=None):\n        if value is None:\n            value = tp()\n        if value.__traceback__ is not tb:\n            raise value.with_traceback(tb)\n        raise value\n\nelse:\n\n    def exec_(_code_, _globs_=None, _locs_=None):\n        \"\"\"Execute code in a namespace.\"\"\"\n        if _globs_ is None:\n            frame = sys._getframe(1)\n            _globs_ = frame.f_globals\n            if _locs_ is None:\n                _locs_ = frame.f_locals\n            del frame\n        elif _locs_ is None:\n            _locs_ = _globs_\n        exec(\"\"\"exec _code_ in _globs_, _locs_\"\"\")\n\n    exec_(\n        \"\"\"def reraise(tp, value, tb=None):\n    raise tp, value, tb\n\"\"\"\n    )",
    "type": "obfuscation",
    "first_analysis": "pydevd-3.3.0",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/pydevd-3.3.0.txt"
  },
  {
    "hash": "f4fac2b59320d2e573ff06f75258aa00",
    "count": 2,
    "packages": [
      "paste-3.10.1",
      "jc-1.25.4"
    ],
    "code": "def lookup(name, frame, locals):\n    \"\"\"Find the value for a given name in the given environment.\"\"\"\n    if name in locals:\n        return 'local', locals[name]\n    if name in frame.f_globals:\n        return 'global', frame.f_globals[name]\n    if '__builtins__' in frame.f_globals:\n        builtins = frame.f_globals['__builtins__']\n        if isinstance(builtins, dict):\n            if name in builtins:\n                return 'builtin', builtins[name]\n        else:\n            if hasattr(builtins, name):\n                return 'builtin', getattr(builtins, name)\n    return None, __UNDEF__",
    "type": "obfuscation",
    "first_analysis": "paste-3.10.1",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/paste-3.10.1.txt"
  },
  {
    "hash": "3a801de97bc211a51ce38e228fbfc1a0",
    "count": 2,
    "packages": [
      "delocate-0.13.0",
      "delocate-0.13.0"
    ],
    "code": "import subprocess\nfrom pathlib import Path\n\nfrom setuptools import Extension, setup  # type: ignore\n\nHERE = Path(__file__).parent.resolve(strict=True)\nLIBS = HERE / \"libs\"\nARCH_FLAGS = [\"-arch\", \"arm64\", \"-arch\", \"x86_64\"]  # Dual architecture.\n\nsubprocess.run(\n    [\n        \"cc\",\n        str(LIBS / \"extfunc2.c\"),\n        \"-dynamiclib\",\n        \"-install_name\",\n        \"@rpath/libextfunc2_rpath.dylib\",\n        \"-o\",\n        str(LIBS / \"libextfunc2_rpath.dylib\"),\n    ]\n    + ARCH_FLAGS,\n    check=True,\n)\n",
    "type": "code-execution",
    "first_analysis": "delocate-0.13.0",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/delocate-0.13.0.txt"
  },
  {
    "hash": "bb8e96a93c66fd4320edfb46e7923920",
    "count": 2,
    "packages": [
      "urlobject-2.4.3",
      "webassets-2.0"
    ],
    "code": "if PY3:\n    import builtins\n    exec_ = getattr(builtins, \"exec\")\n\n\n    def reraise(tp, value, tb=None):\n        if value.__traceback__ is not tb:\n            raise value.with_traceback(tb)\n        raise value\n\n\n    print_ = getattr(builtins, \"print\")\n    del builtins\n\nelse:\n    def exec_(_code_, _globs_=None, _locs_=None):\n        \"\"\"Execute code in a namespace.\"\"\"\n        if _globs_ is None:\n            frame = sys._getframe(1)\n            _globs_ = frame.f_globals\n            if _locs_ is None:\n                _locs_ = frame.f_locals\n            del frame\n        elif _locs_ is None:\n            _locs_ = _globs_\n        exec(\"\"\"exec _code_ in _globs_, _locs_\"\"\")\n\n\n    exec_(\"\"\"def reraise(tp, value, tb=None):\n    raise tp, value, tb\n\"\"\")\n\n\n    def print_(*args, **kwargs):\n        \"\"\"The new-style print function.\"\"\"\n        fp = kwargs.pop(\"file\", sys.stdout)\n        if fp is None:\n            return\n        def write(data):\n            if not isinstance(data, basestring):\n                data = str(data)\n            fp.write(data)\n        want_unicode = False\n        sep = kwargs.pop(\"sep\", None)\n        if sep is not None:\n            if isinstance(sep, unicode):\n                want_unicode = True\n            elif not isinstance(sep, str):\n                raise TypeError(\"sep must be None or a string\")\n        end = kwargs.pop(\"end\", None)\n        if end is not None:\n            if isinstance(end, unicode):\n                want_unicode = True\n            elif not isinstance(end, str):\n                raise TypeError(\"end must be None or a string\")\n        if kwargs:\n            raise TypeError(\"invalid keyword arguments to print()\")\n        if not want_unicode:\n            for arg in args:\n                if isinstance(arg, unicode):\n                    want_unicode = True\n                    break\n        if want_unicode:\n            newline = unicode(\"\\n\")\n            space = unicode(\" \")\n        else:\n            newline = \"\\n\"\n            space = \" \"\n        if sep is None:\n            sep = space\n        if end is None:\n            end = newline\n        for i, arg in enumerate(args):\n            if i:\n                write(sep)\n            write(arg)\n        write(end)\n",
    "type": "obfuscation",
    "first_analysis": "urlobject-2.4.3",
    "first_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/urlobject-2.4.3.txt"
  }
]