[
  {
    "metadata": {
      "package_name": "nvidia-pyindex-1.0.9",
      "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/detect_output/study/guarddog/benign/nvidia-pyindex-1.0.9.txt",
      "total_matches": 2
    }
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/nvidia-pyindex-1.0.9/nvidia-pyindex-1.0.9/setup.py",
    "line_number": "60",
    "type_description": "code-execution",
    "original_snippet": "subprocess.call(\nshlex.split(\"nvidia_pyindex uninstall\"),\nshell=True,\nstdout=subprocess.DEVNULL,\nstderr=subprocess.DEVNULL\n)",
    "context_snippet": "import os\nimport shlex\nimport subprocess\nfrom nvidia_pyindex.utils import get_configuration_files\nfrom nvidia_pyindex.utils import get_configuration_files_by_priority\n\ndef _install_nvidia_pypi_index():\n    try:\n        subprocess.call(\n            shlex.split(\"nvidia_pyindex uninstall\"),\n            shell=True,\n            stdout=subprocess.DEVNULL,\n            stderr=subprocess.DEVNULL\n        )\n    except:\n        pass\n\n    debug_mode = bool(os.environ.get(\"DEBUG_MODE\", False))\n\n    config_filedict = get_configuration_files()\n    config_filelist = get_configuration_files_by_priority()\n\n    print(\"%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\")\n    print(\"Setting User Pip Configuration ...\")\n    print(\"%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\")\n    print(\"\\n######################\\n\")\n\n    pre_existing_configfile = None\n    for config_file in config_filelist:\n        try:\n            if os.path.isfile(config_file):\n                print(\"Editing pip conf file: %s ...\" % config_file)\n                maybe_edit_pip_config_file(\n                    config_file,\n                    config_filedict=config_filedict,\n                    debug_mode=debug_mode\n                )\n                pre_existing_configfile = config_file\n                break\n        except (FileNotFoundError, PermissionError) as e:\n            print(\"Error: {}: {}\".format(e.__class__.__name__, str(e)))\n            pass\n\n    if pre_existing_configfile is None:\n        for config_file in config_filelist:\n            print(\"\\nProcessing pip conf file: %s ...\" % config_file)\n            try:\n                if not os.path.exists(config_file):\n                    print(\"Creating pip conf file: %s ...\" % config_file)\n                    create_pip_config_file(\n                        filepath=config_file,\n                        config_filedict=config_filedict\n                    )\n            except (FileNotFoundError, PermissionError) as e:\n                print(\"Error: {}: {}\".format(e.__class__.__name__, str(e)))\n                pass\n    else:\n        with open(pre_existing_configfile, 'r') as _file:\n            original_content = _file.readlines()\n\n        for config_file in config_filelist:\n            print(\"\\nProcessing pip conf file: %s ...\" % config_file)\n            try:\n\n                try:\n                    with open(config_file, 'r') as _file:\n                        backup_content = _file.readlines()\n                except:\n                    pass\n\n                try:\n                    os.remove(config_file)\n                    os.remove(config_file.old)\n                    with open(\"%s.old\" % config_file, 'w') as _file:\n                        _file.writelines(backup_content)\n                except:\n                    pass\n\n                with open(config_file, 'w') as _file:\n                    _file.writelines(original_content)\n\n            except (FileNotFoundError, PermissionError) as e:\n                print(\"Error: {}: {}\".format(e.__class__.__name__, str(e)))\n                pass\n\n    print(\"\\n######################\\n\")\n\n    time.sleep(2)  # allow readable logs in verbose logs. Please do not delete.",
    "hash_value": "3b78934bb3111ddfe6e4ab00ff341804",
    "detection_index": 1
  }
]