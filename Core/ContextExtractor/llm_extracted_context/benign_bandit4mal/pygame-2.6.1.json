[
  {
    "metadata": {
      "package_name": "pygame-2.6.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "png.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pygame-2.6.1/pygame-2.6.1/test/test_utils/png.py",
    "line_number": "3748",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "3747\t            tupltype = \"RGB_ALPHA\"\n3748\t        file.write(\n3749\t            \"P7\\nWIDTH %d\\nHEIGHT %d\\nDEPTH %d\\nMAXVAL %d\\n\"\n3750\t            \"TUPLTYPE %s\\nENDHDR\\n\" % (width, height, planes, maxval, tupltype)\n3751\t        )",
    "context_snippet": "def write_pnm(file, width, height, pixels, meta):\n    \"\"\"Write a Netpbm PNM/PAM file.\"\"\"\n\n    bitdepth = meta[\"bitdepth\"]\n    maxval = 2**bitdepth - 1\n    # Rudely, the number of image planes can be used to determine\n    # whether we are L (PGM), LA (PAM), RGB (PPM), or RGBA (PAM).\n    planes = meta[\"planes\"]\n    # Can be an assert as long as we assume that pixels and meta came\n    # from a PNG file.\n    assert planes in (1, 2, 3, 4)\n    if planes in (1, 3):\n        if 1 == planes:\n            # PGM\n            # Could generate PBM if maxval is 1, but we don't (for one\n            # thing, we'd have to convert the data, not just blat it\n            # out).\n            fmt = \"P5\"\n        else:\n            # PPM\n            fmt = \"P6\"\n        file.write(\"%s %d %d %d\\n\" % (fmt, width, height, maxval))\n    if planes in (2, 4):\n        # PAM\n        # See http://netpbm.sourceforge.net/doc/pam.html\n        if 2 == planes:\n            tupltype = \"GRAYSCALE_ALPHA\"\n        else:\n            tupltype = \"RGB_ALPHA\"\n        file.write(\n            \"P7\\nWIDTH %d\\nHEIGHT %d\\nDEPTH %d\\nMAXVAL %d\\n\"\n            \"TUPLTYPE %s\\nENDHDR\\n\" % (width, height, planes, maxval, tupltype)\n        )\n    # Values per row\n    vpr = planes * width\n    # struct format\n    fmt = \">%d\" % vpr\n    if maxval > 0xFF:\n        fmt = fmt + \"H\"\n    else:\n        fmt = fmt + \"B\"\n    for row in pixels:\n        file.write(struct.pack(fmt, *row))\n    file.flush()",
    "hash_value": "4dfb7e6541395b264b96ddfd71c87f18"
  }
]