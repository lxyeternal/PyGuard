[
  {
    "metadata": {
      "package_name": "geocoder-1.38.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "cli.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/geocoder-1.38.1/geocoder-1.38.1/geocoder/cli.py",
    "line_number": "45",
    "type_description": "B833:input",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "44\t    try:\n45\t        for line in fileinput.input():\n46\t            locations.append(line.strip())",
    "context_snippet": "@click.command()\n@click.argument('location', nargs=-1)\n@click.option('--provider', '-p', default='osm', type=click.Choice(providers))\n@click.option('--method', '-m', default='geocode', type=click.Choice(methods))\n@click.option('--output', '-o', default='json', type=click.Choice(outputs))\n@click.option('--units', '-u', default='kilometers', type=click.Choice(units))\n@click.option('--timeout', '-t', default=5.0)\n@click.option('--distance', is_flag=True)\n@click.option('--language', default='')\n@click.option('--url', default='')\n@click.option('--proxies')\n@click.option('--key')\n# following are for Tamu provider\n@click.option('--city', '-c', default='')\n@click.option('--state', '-s', default='')\n@click.option('--zipcode', '-z', default='')\ndef cli(location, **kwargs):\n    \"\"\"Geocode an arbitrary number of strings from Command Line.\"\"\"\n\n    locations = []\n\n    # Read Standard Input\n    # $ cat foo.txt | geocode\n    try:\n        for line in fileinput.input():\n            locations.append(line.strip())\n    except:\n        pass\n\n    # Read multiple files & user input location\n    for item in location:\n        if os.path.exists(item):\n            with open(item, 'rb') as f:\n                locations += f.read().splitlines()\n        else:\n            locations.append(item)\n\n    # Distance calculation\n    if kwargs['distance']:\n        d = geocoder.distance(locations, **kwargs)\n        click.echo(d)\n        return\n\n    # Geocode results from user input\n    for location in locations:\n        g = geocoder.get(location.strip(), **kwargs)\n        try:\n            click.echo(json.dumps(getattr(g, kwargs['output'])))\n        except IOError:\n            # When invalid command is entered a broken pipe error occurs\n            return",
    "hash_value": "f0afa1626e74967a49e4d1116a042938"
  }
]