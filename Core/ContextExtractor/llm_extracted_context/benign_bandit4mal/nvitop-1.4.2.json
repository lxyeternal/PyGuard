[
  {
    "metadata": {
      "package_name": "nvitop-1.4.2",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "libcuda.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/nvitop-1.4.2/nvitop-1.4.2/nvitop/api/libcuda.py",
    "line_number": "428",
    "type_description": "B841:cdll",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "427\t                    try:\n428\t                        __cudaLib = _ctypes.CDLL(lib_filename)\n429\t                        break",
    "context_snippet": "def __LoadCudaLibrary() -> None:\n    \"\"\"Load the library if it isn't loaded already.\n\n    Raises:\n        CUDAError_NotInitialized:\n            If cannot found the CUDA driver library.\n    \"\"\"\n    global __cudaLib  # pylint: disable=global-statement\n\n    if __cudaLib is None:\n        # Lock to ensure only one caller loads the library\n        with __libLoadLock:\n            # Ensure the library still isn't loaded\n            if __cudaLib is None:\n                # Platform specific libcuda location\n                system = _platform.system()\n                if system == 'Darwin':\n                    lib_filenames = [\n                        'libcuda.1.dylib',  # check library path first\n                        'libcuda.dylib',\n                        '/usr/local/cuda/lib/libcuda.1.dylib',\n                        '/usr/local/cuda/lib/libcuda.dylib',\n                    ]\n                elif system == 'Linux':\n                    lib_filenames = [\n                        'libcuda.so',  # check library path first\n                        '/usr/lib64/nvidia/libcuda.so',  # Redhat/CentOS/Fedora\n                        '/usr/lib/x86_64-linux-gnu/libcuda.so',  # Ubuntu\n                        '/usr/lib/wsl/lib/libcuda.so',  # WSL\n                    ]\n                    # Also add libraries with version suffix `.1`\n                    lib_filenames = list(\n                        _itertools.chain.from_iterable((f'{lib}.1', lib) for lib in lib_filenames),\n                    )\n                elif system == 'Windows':\n                    bits = 8 * _ctypes.sizeof(_ctypes.c_void_p)  # 64 or 32\n                    lib_filenames = [f'nvcuda{bits}.dll', 'nvcuda.dll']\n                # Open library\n                for lib_filename in lib_filenames:\n                    try:\n                        __cudaLib = _ctypes.CDLL(lib_filename)\n                        break\n                    except OSError:\n                        pass\n                if __cudaLib is None:\n                    _cudaCheckReturn(CUDA_ERROR_NOT_INITIALIZED)",
    "hash_value": "f5fce87f8f4e2974df6eb90b4a52c77a"
  }
]