[
  {
    "metadata": {
      "package_name": "tecton-1.2.0b10",
      "total_matches": 3,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "okta.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tecton-1.2.0b10/tecton-1.2.0b10/tecton/identities/okta.py",
    "line_number": "203",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "202\t            sys.exit(1)\n203\t        url = r.headers.get(\"location\")\n204\t        return self._extract_code_from_url(url, state)",
    "context_snippet": "    def _session_token_auth(self, authorize_url: str, state: str) -> str:\n        # We disallow redirects so that we can extract the code from the\n        # redirect location.\n        r = http.session().get(authorize_url, allow_redirects=False)\n        r.raise_for_status()\n        if r.status_code != 302:\n            print(\"Unsuccessful headless Okta auth.\", file=sys.stderr)\n            sys.exit(1)\n        url = r.headers.get(\"location\")\n        return self._extract_code_from_url(url, state)",
    "hash_value": "3be7d9892d9b0af1c80962165218f5ac"
  },
  {
    "pyfile": "shuffle.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tecton-1.2.0b10/tecton-1.2.0b10/tecton/vendor/pyspark/pyspark/shuffle.py",
    "line_number": "62",
    "type_description": "B817:system",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "61\t                          \"support with spilling\")\n62\t            if platform.system() == \"Darwin\":\n63\t                import resource",
    "context_snippet": "def get_used_memory():\n    \"\"\" Return the used memory in MiB \"\"\"\n    if platform.system() == 'Linux':\n        for line in open('/proc/self/status'):\n            if line.startswith('VmRSS:'):\n                return int(line.split()[1]) >> 10\n\n    else:\n        warnings.warn(\"Please install psutil to have better \"\n                      \"support with spilling\")\n        if platform.system() == \"Darwin\":\n            import resource\n            rss = resource.getrusage(resource.RUSAGE_SELF).ru_maxrss\n            return rss >> 20\n        # TODO: support windows\n\n    return 0",
    "hash_value": "45f156d479c25a50ac67586ea242a810"
  },
  {
    "pyfile": "vendor_dill.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tecton-1.2.0b10/tecton-1.2.0b10/tecton/vendor/vendor_dill.py",
    "line_number": "20",
    "type_description": "B836:rmtree",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "19\tvendor_dir = parent_dir / \"dill\"\n20\tshutil.rmtree(vendor_dir, ignore_errors=True)\n21\tvendor_dir.mkdir()",
    "context_snippet": "import os\nimport tempfile\nimport shutil\nfrom pathlib import Path\nimport subprocess\nimport zipfile\n\nDILL_VERSION = \"0.3.0\"\n\nparent_dir = Path(__file__).parent\nvendor_dir = parent_dir / \"dill\"\nshutil.rmtree(vendor_dir, ignore_errors=True)\nvendor_dir.mkdir()\n\nwith tempfile.TemporaryDirectory() as d:\n    d = Path(d)\n    os.chdir(d)\n    subprocess.check_call([\"pip\", \"wheel\", f\"dill=={DILL_VERSION}\"])\n\n\n    def extract_whl(package_name):\n        whl_glob = list(d.glob(f\"{package_name}-*.whl\"))\n        assert len(whl_glob) == 1\n        whl = whl_glob[0]\n        with zipfile.ZipFile(whl) as z:\n            for name in z.namelist():\n                if all((name.startswith(f\"{package_name}/\"),\n                        name.endswith(\".py\"),\n                        not \"/tests/\" in name,\n                        not \"/examples/\" in name)):\n                    print(name)\n                    z.extract(name, path=vendor_dir)\n\n    extract_whl(\"dill\")\n\n\nsubprocess.check_call([\"patch\", str(vendor_dir / \"dill/objtypes.py\"), str(parent_dir / \"dill_objtypes.patch\")])",
    "hash_value": "0d7370d1f4e509b5ffcdf398a133014d"
  }
]