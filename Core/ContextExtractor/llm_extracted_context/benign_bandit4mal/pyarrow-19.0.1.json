[
  {
    "metadata": {
      "package_name": "pyarrow-19.0.1",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_io.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyarrow-19.0.1/pyarrow-19.0.1/pyarrow/tests/test_io.py",
    "line_number": "343",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "342\t    assert not pf.seekable()\n343\t    pf.write(b'foobar\\n')\n344\t    assert bio.getvalue() == b'foobar\\n'",
    "context_snippet": "def test_python_file_implicit_mode(tmpdir):\n    path = os.path.join(str(tmpdir), 'foo.txt')\n    with open(path, 'wb') as f:\n        pf = pa.PythonFile(f)\n        assert pf.writable()\n        assert not pf.readable()\n        assert not pf.seekable()  # PyOutputStream isn't seekable\n        f.write(b'foobar\\n')\n\n    with open(path, 'rb') as f:\n        pf = pa.PythonFile(f)\n        assert pf.readable()\n        assert not pf.writable()\n        assert pf.seekable()\n        assert pf.read() == b'foobar\\n'\n\n    bio = BytesIO()\n    pf = pa.PythonFile(bio)\n    assert pf.writable()\n    assert not pf.readable()\n    assert not pf.seekable()\n    pf.write(b'foobar\\n')\n    assert bio.getvalue() == b'foobar\\n'\n",
    "hash_value": "71a351872f3f8f2c3afff30569adde70"
  },
  {
    "pyfile": "test_io.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyarrow-19.0.1/pyarrow-19.0.1/pyarrow/tests/test_io.py",
    "line_number": "1047",
    "type_description": "B832:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1046\t        f1.write(val)\n1047\t        f2.write(val)\n1048",
    "context_snippet": "def test_mock_output_stream():\n    # Make sure that the MockOutputStream and the BufferOutputStream record the\n    # same size\n\n    # 10 bytes\n    val = b'dataabcdef'\n\n    f1 = pa.MockOutputStream()\n    f2 = pa.BufferOutputStream()\n\n    K = 1000\n    for i in range(K):\n        f1.write(val)\n        f2.write(val)\n\n    assert f1.size() == len(f2.getvalue())\n\n    # Do the same test with a table\n    record_batch = pa.RecordBatch.from_arrays([pa.array([1, 2, 3])], ['a'])\n\n    f1 = pa.MockOutputStream()\n    f2 = pa.BufferOutputStream()\n\n    stream_writer1 = pa.RecordBatchStreamWriter(f1, record_batch.schema)\n    stream_writer2 = pa.RecordBatchStreamWriter(f2, record_batch.schema)\n\n    stream_writer1.write_batch(record_batch)\n    stream_writer2.write_batch(record_batch)\n    stream_writer1.close()\n    stream_writer2.close()\n\n    assert f1.size() == len(f2.getvalue())",
    "hash_value": "03131c32f5f3b553551c395a04acc45e"
  }
]