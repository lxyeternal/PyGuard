[
  {
    "metadata": {
      "package_name": "mindsdb-25.4.2.1",
      "total_matches": 3,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "initialize.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/mindsdb-25.4.2.1/mindsdb-25.4.2.1/mindsdb/api/http/initialize.py",
    "line_number": "312",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "311\t        try:\n312\t            email_confirmed = int(request.headers.get('email-confirmed', 1))\n313\t        except Exception:",
    "context_snippet": "@app.before_request\n    def before_request():\n        logger.debug(f\"HTTP {request.method}: {request.path}\")\n        ctx.set_default()\n        config = Config()\n\n        # region routes where auth is required\n        if (\n            config['auth']['http_auth_enabled'] is True\n            and any(request.path.startswith(f'/api{ns.path}') for ns in protected_namespaces)\n            and check_auth() is False\n        ):\n            return http_error(\n                HTTPStatus.UNAUTHORIZED, 'Unauthorized',\n                'Authorization is required to complete the request'\n            )\n        # endregion\n\n        company_id = request.headers.get('company-id')\n        user_class = request.headers.get('user-class')\n\n        try:\n            email_confirmed = int(request.headers.get('email-confirmed', 1))\n        except Exception:\n            email_confirmed = 1\n\n        try:\n            user_id = int(request.headers.get('user-id', 0))\n        except Exception:\n            user_id = 0\n\n        try:\n            session_id = request.cookies.get('session')\n        except Exception:\n            session_id = \"unknown\"\n\n        if company_id is not None:\n            try:\n                company_id = int(company_id)\n            except Exception as e:\n                logger.error(\n                    f\"Cloud not parse company id: {company_id} | exception: {e}\"\n                )\n                company_id = None\n\n        if user_class is not None:\n            try:\n                user_class = int(user_class)\n            except Exception as e:\n                logger.error(\n                    f\"Cloud not parse user_class: {user_class} | exception: {e}\"\n                )\n                user_class = 0\n        else:\n            user_class = 0\n\n        ctx.user_id = user_id\n        ctx.session_id = session_id\n        ctx.company_id = company_id\n        ctx.user_class = user_class\n        ctx.email_confirmed = email_confirmed",
    "hash_value": "7a541a41025fd76926f2726c8dad8b13"
  },
  {
    "pyfile": "google_user_oauth_utilities.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/mindsdb-25.4.2.1/mindsdb-25.4.2.1/mindsdb/integrations/utilities/handlers/auth_utilities/google/google_user_oauth_utilities.py",
    "line_number": "57",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "56\t        if self.credentials_url:\n57\t            response = requests.get(self.credentials_url)\n58\t            if response.status_code == 200:",
    "context_snippet": "import requests\nfrom pathlib import Path\nimport json\nfrom mindsdb.utilities import log\nlogger = log.getLogger(__name__)\n\nclass GoogleUserOAuth2Manager:\n    def _download_oauth_user_info(self):\n        # if credentials_url is set, attempt to download the contents of the files\n        # this will be given preference over credentials_file\n        if self.credentials_url:\n            response = requests.get(self.credentials_url)\n            if response.status_code == 200:\n                return response.json()\n            else:\n                logger.error(\"Failed to get credentials from URL\", response.status_code)\n\n        # if credentials_file is set, attempt to read the contents of the file\n        if self.credentials_file:\n            path = Path(self.credentials_file).expanduser()\n            if path.exists():\n                with open(path, 'r') as f:\n                    return json.load(f)\n            else:\n                logger.error(\"Credentials file does not exist\")\n\n        raise ValueError('OAuth2 credentials could not be found')",
    "hash_value": "4f44a1adc27f2c1ffe66291db630d311"
  },
  {
    "pyfile": "dockerhub.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/mindsdb-25.4.2.1/mindsdb-25.4.2.1/mindsdb/integrations/handlers/dockerhub_handler/dockerhub.py",
    "line_number": "47",
    "type_description": "B822:request",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "46\t        url = f'{self.docker_hub_base_endpoint}namespaces/{namespace}/repositories/{repo}/tags/{tag}'\n47\t        return self.make_request(url)\n48",
    "context_snippet": "import json\nimport requests\n\n\nclass DockerHubClient:\n    def __init__(self):\n        self.auth_token = None\n        self.docker_hub_base_endpoint = \"https://hub.docker.com/v2/\"\n\n    def make_request(self, url, method='GET', data=None):\n        if method not in ['GET', 'POST']:\n            raise ValueError('Invalid HTTP request method')\n        headers = {'Content-type': 'application/json'}\n        if self.auth_token:\n            headers['Authorization'] = 'JWT ' + self.auth_token\n        request_method = getattr(requests, method.lower())\n        if data and len(data) > 0:\n            data = json.dumps(data)\n            resp = request_method(url, data, headers=headers)\n        else:\n            resp = request_method(url, headers=headers)\n        content = {}\n        if resp.status_code == 200:\n            content = {'content': json.loads(resp.content.decode()), 'code': 200}\n        else:\n            content = {'content': {}, 'code': resp.status_code, 'error': resp.text}\n        return content\n\n    def get_repo_tag(self, namespace, repo, tag):\n        url = f'{self.docker_hub_base_endpoint}namespaces/{namespace}/repositories/{repo}/tags/{tag}'\n        return self.make_request(url)\n",
    "hash_value": "40eb76250c16cf49a0339469b2725a46"
  }
]