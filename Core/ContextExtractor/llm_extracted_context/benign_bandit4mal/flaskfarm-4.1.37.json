[
  {
    "metadata": {
      "package_name": "flaskfarm-4.1.37",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "sub_process.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flaskfarm-4.1.37/FlaskFarm-4.1.37/flaskfarm/lib/support/base/sub_process.py",
    "line_number": "149",
    "type_description": "B812:system",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "148\t            logger.debug(f\"{self.command=}\")\n149\t            if platform.system() == 'Windows':\n150\t                self.process = subprocess.Popen(self.command, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, universal_newlines=True, shell=self.shell, env=self.env, encoding='utf8', bufsize=0)",
    "context_snippet": "def __execute_thread_function(self):\n    try:\n        self.command = self.command_for_windows(self.command)\n        logger.debug(f\"{self.command=}\")\n        if platform.system() == 'Windows':\n            self.process = subprocess.Popen(self.command, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, universal_newlines=True, shell=self.shell, env=self.env, encoding='utf8', bufsize=0)\n\n        else:\n            if self.uid == None:\n                self.process = subprocess.Popen(self.command, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, universal_newlines=True, shell=self.shell, env=self.env, encoding='utf8', bufsize=0)\n            else:\n                self.process = subprocess.Popen(self.command, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, universal_newlines=True, shell=self.shell, env=self.env, preexec_fn=demote(self.uid, self.gid), encoding='utf8', bufsize=0)\n        SupportSubprocess.__instance_list.append(self)\n        self.send_stdout_callback(self.call_id, 'START', None)\n        self.__start_communicate()\n        self.__start_send_callback()\n        if self.process is not None:\n            if self.timeout != None:\n                self.process.wait(timeout=self.timeout)\n                self.process_close()\n            else:\n                self.process.wait()\n        self.remove_instance(self)\n        logger.info(f\"{self.command} END\")\n    except Exception as e: \n        logger.error(f'Exception:{str(e)}')\n        logger.error(traceback.format_exc())\n        logger.warning(self.command)\n        self.send_stdout_callback(self.call_id, 'ERROR', str(e))\n        self.send_stdout_callback(self.call_id, 'ERROR', str(traceback.format_exc()))\n    finally:\n        if self.stdout_callback != None:\n            #self.stdout_callback(self.call_id, 'thread_end', None)\n            pass",
    "hash_value": "6a0eb01721fe51344e6cc3ef1325c1fa"
  }
]