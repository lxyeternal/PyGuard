[
  {
    "metadata": {
      "package_name": "locustio-1.0b2",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_web.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/locustio-1.0b2/locustio-1.0b2/locust/test/test_web.py",
    "line_number": "303",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "302\t    def test_index_with_basic_auth_enabled_correct_credentials(self):\n303\t        self.assertEqual(200, requests.get(\"http://127.0.0.1:%i/?ele=phino\" % self.web_port, auth=('john', 'doe')).status_code)\n304",
    "context_snippet": "class TestWebUIAuth(LocustTestCase):\n    def setUp(self):\n        super(TestWebUIAuth, self).setUp()\n\n        parser = get_parser(default_config_files=[])\n        options = parser.parse_args([\"--web-auth\", \"john:doe\"])\n        self.runner = Runner(self.environment)\n        self.stats = self.runner.stats\n        self.web_ui = self.environment.create_web_ui(\"127.0.0.1\", 0, auth_credentials=options.web_auth)\n        self.web_ui.app.view_functions[\"request_stats\"].clear_cache()\n        gevent.sleep(0.01)\n        self.web_port = self.web_ui.server.server_port\n\n    def tearDown(self):\n        super(TestWebUIAuth, self).tearDown()\n        self.web_ui.stop()\n        self.runner.quit()\n\n    def test_index_with_basic_auth_enabled_correct_credentials(self):\n        self.assertEqual(200, requests.get(\"http://127.0.0.1:%i/?ele=phino\" % self.web_port, auth=('john', 'doe')).status_code)\n",
    "hash_value": "8bd0a42ecdcfab899bfa57dc7aef5d79"
  },
  {
    "pyfile": "test_log.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/locustio-1.0b2/locustio-1.0b2/locust/test/test_log.py",
    "line_number": "83",
    "type_description": "B803:gethostname",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "82\t        self.assertIn(\n83\t            \"%s/INFO/custom_logger: test\" % socket.gethostname(),\n84\t            output,",
    "context_snippet": "    def test_logging_output(self):\n        with temporary_file(textwrap.dedent(\"\"\"\n            import logging\n            from locust import User, task, constant\n            \n            custom_logger = logging.getLogger(\"custom_logger\")\n            \n            class MyUser(User):\n                wait_time = constant(2)\n                @task\n                def my_task(self):\n                    print(\"running my_task\")\n                    logging.info(\"custom log message\")\n                    custom_logger.info(\"test\")\n        \"\"\")) as file_path:\n            output = subprocess.check_output([\n                \"locust\", \n                \"-f\", file_path, \n                \"-u\", \"1\",\n                \"-r\", \"1\",\n                \"-t\", \"1\",\n                \"--headless\",\n            ], stderr=subprocess.STDOUT, timeout=10).decode(\"utf-8\")\n        \n        self.assertIn(\n            \"%s/INFO/locust.main: Run time limit set to 1 seconds\" % socket.gethostname(),\n            output,\n        )\n        self.assertIn(\n            \"%s/INFO/locust.main: Time limit reached. Stopping Locust.\" % socket.gethostname(),\n            output,\n        )\n        self.assertIn(\n            \"%s/INFO/locust.main: Shutting down (exit code 0), bye.\" % socket.gethostname(),\n            output,\n        )\n        self.assertIn(\n            \"\\nrunning my_task\\n\",\n            output,\n        )\n        # check that custom message of root logger is also printed\n        self.assertIn(\n            \"%s/INFO/root: custom log message\" % socket.gethostname(),\n            output,\n        )\n        # check that custom message of custom_logger is also printed\n        self.assertIn(\n            \"%s/INFO/custom_logger: test\" % socket.gethostname(),\n            output,\n        )",
    "hash_value": "abe6f834593a246163b0aa67f02b6a4d"
  }
]