[
  {
    "metadata": {
      "package_name": "resource-0.2.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "django.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/resource-0.2.1/Resource-0.2.1/rsrc/framework/django.py",
    "line_number": "95",
    "type_description": "B835:load",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "94\t        def get_data(self, request):\n95\t            return payload(request)\n96",
    "context_snippet": "def get_data(self, request):\n    return payload(request)\n\ndef payload(request):\n    \"\"\"\n    Inspired by `Django REST framework` - https://github.com/tomchristie/django-rest-framework\n    \"\"\"\n\n    # get the content body of the request, as a stream.\n    try:\n        content_length = int(request.META.get('CONTENT_LENGTH',\n                             request.META.get('HTTP_CONTENT_LENGTH')))\n    except (ValueError, TypeError):\n        content_length = 0\n\n    if content_length == 0:\n        stream = None\n    else:\n        stream = request\n\n    content_type = request.META.get('HTTP_CONTENT_TYPE',\n                                    request.META.get('CONTENT_TYPE'))\n\n    if stream is None or content_type is None:\n        return {}\n\n    encoding = settings.DEFAULT_CHARSET\n    try:\n        data = stream.read().decode(encoding)\n        return json.loads(data)\n    except ValueError:\n        return {}",
    "hash_value": "b23f310a6f54418f8b70269d66b8f2e4"
  }
]