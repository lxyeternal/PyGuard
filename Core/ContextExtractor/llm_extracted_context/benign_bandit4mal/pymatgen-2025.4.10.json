[
  {
    "metadata": {
      "package_name": "pymatgen-2025.4.10",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "boltztrap.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py",
    "line_number": "261",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "260\t        with open(output_file, mode=\"w\", encoding=\"utf-8\") as file:\n261\t            file.write(\"test\\n\")\n262\t            file.write(f\"{len(self._bs.kpoints)}\\n\")",
    "context_snippet": "def write_energy(self, output_file) -> None:\n    \"\"\"Write the energy to an output file.\n\n    Args:\n        output_file: Filename\n    \"\"\"\n    with open(output_file, mode=\"w\", encoding=\"utf-8\") as file:\n        file.write(\"test\\n\")\n        file.write(f\"{len(self._bs.kpoints)}\\n\")\n\n        if self.run_type == \"FERMI\":\n            sign = -1.0 if self.cond_band else 1.0\n            for i, kpt in enumerate(self._bs.kpoints):\n                eigs = []\n                eigs.append(\n                    Energy(\n                        self._bs.bands[Spin(self.spin)][self.band_nb][i] - self._bs.efermi,\n                        \"eV\",\n                    ).to(\"Ry\")\n                )\n                a, b, c = kpt.frac_coords\n                file.write(f\"{a:12.8f} {b:12.8f} {c:12.8f}{len(eigs)}\\n\")\n                for e in eigs:\n                    file.write(f\"{sign * float(e):18.8f}\\n\")\n\n        else:\n            for i, kpt in enumerate(self._bs.kpoints):\n                eigs = []\n                spin_lst = [self.spin] if self.run_type == \"DOS\" else self._bs.bands\n\n                for spin in spin_lst:\n                    # use 90% of bottom bands since highest eigenvalues\n                    # are usually incorrect\n                    # ask Geoffroy Hautier for more details\n                    nb_bands = math.floor(self._bs.nb_bands * (1 - self.cb_cut))\n                    for j in range(nb_bands):\n                        eigs.append(\n                            Energy(\n                                self._bs.bands[Spin(spin)][j][i] - self._bs.efermi,\n                                \"eV\",\n                            ).to(\"Ry\")\n                        )\n                eigs.sort()\n\n                if self.run_type == \"DOS\" and self._bs.is_spin_polarized:\n                    eigs.insert(0, self._ll)\n                    eigs.append(self._hl)\n                a, b, c = kpt.frac_coords\n                file.write(f\"{a:12.8f} {b:12.8f} {c:12.8f} {len(eigs)}\\n\")\n\n                for e in eigs:\n                    file.write(f\"{float(e):18.8f}\\n\")",
    "hash_value": "f79f1c71b406f131d6b9db4547dd91c2"
  }
]