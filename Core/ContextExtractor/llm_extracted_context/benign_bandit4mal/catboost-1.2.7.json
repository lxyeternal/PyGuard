[
  {
    "metadata": {
      "package_name": "catboost-1.2.7",
      "total_matches": 3,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "core.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/catboost-1.2.7/catboost-1.2.7/catboost/core.py",
    "line_number": "27",
    "type_description": "B812:system",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "26\n27\tif platform.system() == 'Linux':\n28\t    try:",
    "context_snippet": "import ctypes\nimport platform\n\nif platform.system() == 'Linux':\n    try:\n        ctypes.CDLL('librt.so')\n    except Exception:\n        pass",
    "hash_value": "4472c04b3341c0c71f17d7144f0f9531"
  },
  {
    "pyfile": "intelccompiler.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/catboost-1.2.7/catboost-1.2.7/catboost_all_src/contrib/python/numpy/py2/numpy/distutils/intelccompiler.py",
    "line_number": "67",
    "type_description": "B817:system",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "66\n67\t        if platform.system() == 'Darwin':\n68\t            shared_flag = '-Wl,-undefined,dynamic_lookup'",
    "context_snippet": "def __init__(self, verbose=0, dry_run=0, force=0):\n    UnixCCompiler.__init__(self, verbose, dry_run, force)\n\n    v = self.get_version()\n    mpopt = 'openmp' if v and v < '15' else 'qopenmp'\n    self.cc_exe = ('icc -fPIC -fp-model strict -O3 '\n                   '-fomit-frame-pointer -{}').format(mpopt)\n    compiler = self.cc_exe\n\n    if platform.system() == 'Darwin':\n        shared_flag = '-Wl,-undefined,dynamic_lookup'\n    else:\n        shared_flag = '-shared'\n    self.set_executables(compiler=compiler,\n                         compiler_so=compiler,\n                         compiler_cxx=compiler,\n                         archiver='xiar' + ' cru',\n                         linker_exe=compiler + ' -shared-intel',\n                         linker_so=compiler + ' ' + shared_flag +\n                         ' -shared-intel')",
    "hash_value": "779d1192b036eacb997d2e75bf01da74"
  },
  {
    "pyfile": "Cythonize.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/catboost-1.2.7/catboost-1.2.7/catboost_all_src/contrib/tools/cython/Cython/Build/Cythonize.py",
    "line_number": "113",
    "type_description": "B839:pool",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "112\t                        try:\n113\t                            pool = multiprocessing.Pool(options.parallel)\n114\t                        except OSError:",
    "context_snippet": "def cython_compile(path_pattern, options):\n    pool = None\n    all_paths = map(os.path.abspath, extended_iglob(path_pattern))\n    try:\n        for path in all_paths:\n            if options.build_inplace:\n                base_dir = path\n                while not os.path.isdir(base_dir) or is_package_dir(base_dir):\n                    base_dir = os.path.dirname(base_dir)\n            else:\n                base_dir = None\n\n            if os.path.isdir(path):\n                # recursively compiling a package\n                paths = [os.path.join(path, '**', '*.{py,pyx}')]\n            else:\n                # assume it's a file(-like thing)\n                paths = [path]\n\n            ext_modules = cythonize(\n                paths,\n                nthreads=options.parallel,\n                exclude_failures=options.keep_going,\n                exclude=options.excludes,\n                compiler_directives=options.directives,\n                compile_time_env=options.compile_time_env,\n                force=options.force,\n                quiet=options.quiet,\n                depfile=options.depfile,\n                **options.options)\n\n            if ext_modules and options.build:\n                if len(ext_modules) > 1 and options.parallel > 1:\n                    if pool is None:\n                        try:\n                            pool = multiprocessing.Pool(options.parallel)\n                        except OSError:\n                            pool = _FakePool()\n                    pool.map_async(run_distutils, [\n                        (base_dir, [ext]) for ext in ext_modules])\n                else:\n                    run_distutils((base_dir, ext_modules))\n    except:\n        if pool is not None:\n            pool.terminate()\n        raise\n    else:\n        if pool is not None:\n            pool.close()\n            pool.join()",
    "hash_value": "d4e812dcf95cc2b532e4237fff433d87"
  }
]