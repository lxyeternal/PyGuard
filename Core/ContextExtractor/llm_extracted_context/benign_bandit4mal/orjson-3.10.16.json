[
  {
    "metadata": {
      "package_name": "orjson-3.10.16",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "generate-encoding-data.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/orjson-3.10.16/orjson-3.10.16/include/cargo/encoding_rs-0.8.35/generate-encoding-data.py",
    "line_number": "367",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "366\t  partially_generated_file = open(path, \"r\")\n367\t  full = partially_generated_file.read()\n368\t  partially_generated_file.close()",
    "context_snippet": "def read_non_generated(path):\n  partially_generated_file = open(path, \"r\")\n  full = partially_generated_file.read()\n  partially_generated_file.close()\n\n  generated_begin = \"// BEGIN GENERATED CODE. PLEASE DO NOT EDIT.\"\n  generated_end = \"// END GENERATED CODE\"\n\n  generated_begin_index = full.find(generated_begin)\n  if generated_begin_index < 0:\n    sys.stderr.write(\"Can't find generated code start marker in %s. Exiting.\\n\" % path)\n    sys.exit(-1)\n  generated_end_index = full.find(generated_end)\n  if generated_end_index < 0:\n    sys.stderr.write(\"Can't find generated code end marker in %s. Exiting.\\n\" % path)\n    sys.exit(-1)\n\n  return (full[0:generated_begin_index + len(generated_begin)],\n          full[generated_end_index:])",
    "hash_value": "c707fc5e3f4ff59b1140c723ab4083d0"
  },
  {
    "pyfile": "generate-encoding-data.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/orjson-3.10.16/orjson-3.10.16/include/cargo/encoding_rs-0.8.35/generate-encoding-data.py",
    "line_number": "1965",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1964\n1965\tcodepage_file.write(\"\"\"];\n1966",
    "context_snippet": "codepage_file.write(codepage_end)\ncodepage_file.close()\n\n(codepage_test_begin, codepage_test_end) = read_non_generated(\"../codepage/src/tests.rs\")\n\ncodepage_test_file = open(\"../codepage/src/tests.rs\", \"w\")\n\ncodepage_test_file.write(codepage_test_begin)\ncodepage_test_file.write(\"\"\"\n// Instead, please regenerate using generate-encoding-data.py\n\n#[test]\nfn test_to_encoding() {\n    assert_eq!(to_encoding(0), None);\n\n\"\"\")\n\nfor code_page in code_pages:\n  codepage_test_file.write(\"    assert_eq!(to_encoding(%d), Some(%s));\\n\" % (code_page, to_constant_name(encodings_by_code_page[code_page])))  \n\ncodepage_test_file.write(\"\"\"}\n\n#[test]\nfn test_from_encoding() {\n\"\"\")\n\nfor name in preferred:\n  if code_pages_by_encoding.has_key(name):\n    codepage_test_file.write(\"    assert_eq!(from_encoding(%s), Some(%d));\\n\" % (to_constant_name(name), code_pages_by_encoding[name]))\n  else:\n    codepage_test_file.write(\"    assert_eq!(from_encoding(%s), None);\\n\" % to_constant_name(name))\n\ncodepage_test_file.write(\"\"\"}\n\"\"\")\n\ncodepage_test_file.write(codepage_test_end)\ncodepage_test_file.close()\n\nsubprocess.call([\"cargo\", \"fmt\"])\n",
    "hash_value": "32170ba166a20b9d58deed2c6a4985d6"
  }
]