[
  {
    "metadata": {
      "package_name": "backports_tarfile-1.2.0",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_tarfile.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/backports_tarfile-1.2.0/backports_tarfile-1.2.0/tests/test_tarfile.py",
    "line_number": "418",
    "type_description": "B834:open",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "417\t        # file object's current position\n418\t        with open(self.tarname, \"rb\") as fobj:\n419\t            tarfile.is_tarfile(fobj)",
    "context_snippet": "def test_is_tarfile_valid(self):\n    # is_tarfile works on filenames\n    self.assertTrue(tarfile.is_tarfile(self.tarname))\n\n    # is_tarfile works on path-like objects\n    self.assertTrue(tarfile.is_tarfile(os_helper.FakePath(self.tarname)))\n\n    # is_tarfile works on file objects\n    with open(self.tarname, \"rb\") as fobj:\n        self.assertTrue(tarfile.is_tarfile(fobj))\n\n    # is_tarfile works on file-like objects\n    with open(self.tarname, \"rb\") as fobj:\n        self.assertTrue(tarfile.is_tarfile(io.BytesIO(fobj.read())))",
    "hash_value": "cca5b9430a1840d4006b1101d6f6e96b"
  },
  {
    "pyfile": "test_tarfile.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/backports_tarfile-1.2.0/backports_tarfile-1.2.0/tests/test_tarfile.py",
    "line_number": "765",
    "type_description": "B834:open",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "764\t        with os_helper.temp_dir(DIR), \\\n765\t             tarfile.open(tarname, encoding=\"iso8859-1\") as tar:\n766\t            directories = [t for t in tar if t.isdir()]",
    "context_snippet": "def test_extractall_pathlike_dir(self):\n    DIR = os.path.join(TEMPDIR, \"extractall\")\n    with os_helper.temp_dir(DIR), \\\n         tarfile.open(tarname, encoding=\"iso8859-1\") as tar:\n        directories = [t for t in tar if t.isdir()]\n        tar.extractall(os_helper.FakePath(DIR), directories, filter='fully_trusted')\n        for tarinfo in directories:\n            path = os.path.join(DIR, tarinfo.name)\n            self.assertEqual(os.path.getmtime(path), tarinfo.mtime)",
    "hash_value": "540601789f6a348da43197e3d8d80a3e"
  }
]