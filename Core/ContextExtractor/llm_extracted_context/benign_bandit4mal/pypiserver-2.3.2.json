[
  {
    "metadata": {
      "package_name": "pypiserver-2.3.2",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "bottle.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pypiserver-2.3.2/pypiserver-2.3.2/pypiserver/bottle.py",
    "line_number": "1211",
    "type_description": "B801:b64decode",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1210\t                if _lscmp(sig, base64.b64encode(hash)):\n1211\t                    dst = pickle.loads(base64.b64decode(msg))\n1212\t                    if dst and dst[0] == key:",
    "context_snippet": "def get_cookie(self, key, default=None, secret=None, digestmod=hashlib.sha256):\n    \"\"\" Return the content of a cookie. To read a `Signed Cookie`, the\n        `secret` must match the one used to create the cookie (see\n        :meth:`Response.set_cookie <BaseResponse.set_cookie>`). If anything goes wrong (missing\n        cookie or wrong signature), return a default value. \"\"\"\n    value = self.cookies.get(key)\n    if secret:\n        # See BaseResponse.set_cookie for details on signed cookies.\n        if value and value.startswith('!') and '?' in value:\n            sig, msg = map(tob, value[1:].split('?', 1))\n            hash = hmac.new(tob(secret), msg, digestmod=digestmod).digest()\n            if _lscmp(sig, base64.b64encode(hash)):\n                dst = pickle.loads(base64.b64decode(msg))\n                if dst and dst[0] == key:\n                    return dst[1]\n        return default\n    return value or default",
    "hash_value": "a8e22d8997c07614f52a9798d579f8c0"
  }
]