[
  {
    "metadata": {
      "package_name": "bpython-0.25",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "repl.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/bpython-0.25/bpython-0.25/bpython/curtsiesfrontend/repl.py",
    "line_number": "2102",
    "type_description": "B828:signal",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "2101\t        finally:\n2102\t            signal.signal(signal.SIGWINCH, prev_sigwinch_handler)\n2103",
    "context_snippet": "def focus_on_subprocess(self, args):\n    prev_sigwinch_handler = signal.getsignal(signal.SIGWINCH)\n    try:\n        signal.signal(signal.SIGWINCH, self.orig_sigwinch_handler)\n        with Termmode(self.orig_stdin, self.orig_tcattrs):\n            terminal = self.window.t\n            with terminal.fullscreen():\n                sys.__stdout__.write(terminal.save)\n                sys.__stdout__.write(terminal.move(0, 0))\n                sys.__stdout__.flush()\n                p = subprocess.Popen(\n                    args,\n                    stdin=self.orig_stdin,\n                    stderr=sys.__stderr__,\n                    stdout=sys.__stdout__,\n                )\n                p.wait()\n                sys.__stdout__.write(terminal.restore)\n                sys.__stdout__.flush()\n    finally:\n        signal.signal(signal.SIGWINCH, prev_sigwinch_handler)",
    "hash_value": "0ccfa763a9501475496e29ecc25f071c"
  },
  {
    "pyfile": "repl.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/bpython-0.25/bpython-0.25/bpython/repl.py",
    "line_number": "999",
    "type_description": "B842:runsource",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "998\n999\t        more: bool = self.interp.runsource(\"\\n\".join(self.buffer))\n1000",
    "context_snippet": "def push(self, s, insert_into_history=True) -> bool:\n    \"\"\"Push a line of code onto the buffer so it can process it all\n    at once when a code block ends\"\"\"\n    # This push method is used by cli and urwid, but not curtsies\n    s = s.rstrip(\"\\n\")\n    self.buffer.append(s)\n\n    if insert_into_history:\n        self.insert_into_history(s)\n\n    more: bool = self.interp.runsource(\"\\n\".join(self.buffer))\n\n    if not more:\n        self.buffer = []\n\n    return more",
    "hash_value": "34b104d1400f8948fbe445e05b4d9d05"
  }
]