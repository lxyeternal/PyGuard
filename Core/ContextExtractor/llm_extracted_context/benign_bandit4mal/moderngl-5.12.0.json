[
  {
    "metadata": {
      "package_name": "moderngl-5.12.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "_moderngl.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/moderngl-5.12.0/moderngl-5.12.0/_moderngl.py",
    "line_number": "214",
    "type_description": "B841:cdll",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "213\t            try:\n214\t                lib = ctypes.CDLL(\"libEGL.so\")\n215\t                proc = ctypes.cast(lib.eglGetProcAddress, ctypes.CFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p))",
    "context_snippet": "class DefaultLoader:\n    def __init__(self):\n        import ctypes\n        import sys\n\n        def funcptr(lib, name):\n            return ctypes.cast(getattr(lib, name, 0), ctypes.c_void_p).value or 0\n\n        if sys.platform.startswith(\"win\"):\n            lib = ctypes.WinDLL(\"opengl32.dll\")\n            proc = ctypes.cast(lib.wglGetProcAddress, ctypes.WINFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p))\n            if not lib.wglGetCurrentContext():\n                raise RuntimeError(\"Cannot detect window with OpenGL support\")\n\n            def loader(name):\n                return proc(name.encode()) or funcptr(lib, name)\n\n        elif sys.platform.startswith(\"linux\"):\n            try:\n                lib = ctypes.CDLL(\"libEGL.so\")\n                proc = ctypes.cast(lib.eglGetProcAddress, ctypes.CFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p))\n                if not lib.eglGetCurrentContext():\n                    raise RuntimeError(\"Cannot detect window with OpenGL support\")\n\n                def loader(name):\n                    return proc(name.encode())\n\n            except:\n                lib = ctypes.CDLL(\"libGL.so\")\n                proc = ctypes.cast(lib.glXGetProcAddress, ctypes.CFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p))\n                if not lib.glXGetCurrentContext():\n                    raise RuntimeError(\"Cannot detect window with OpenGL support\")\n\n                def loader(name):\n                    return proc(name.encode()) or funcptr(lib, name)\n\n        elif sys.platform.startswith(\"darwin\"):\n            lib = ctypes.CDLL(\"/System/Library/Frameworks/OpenGL.framework/OpenGL\")\n\n            def loader(name):\n                return funcptr(lib, name)\n\n        elif sys.platform.startswith(\"emscripten\"):\n            lib = ctypes.CDLL(None)\n\n            def loader(name):\n                return funcptr(lib, name)\n\n        elif sys.platform.startswith(\"wasi\"):\n            lib = ctypes.CDLL(None)\n\n            def loader(name):\n                return funcptr(lib, name)\n\n        self.load_opengl_function = loader\n\n    def __enter__(self):\n        pass\n\n    def __exit__(self, *args):\n        pass\n\n    def release(self):\n        pass",
    "hash_value": "d9a933bc77435f9ec7fb2960367400c4"
  }
]