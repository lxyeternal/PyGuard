[
  {
    "metadata": {
      "package_name": "requests_auth-8.0.0",
      "total_matches": 3,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_oauth2_implicit.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/requests_auth-8.0.0/requests_auth-8.0.0/tests/oauth2/implicit/test_oauth2_implicit.py",
    "line_number": "489",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "488\n489\t    requests.get(\"http://authorized_only\", auth=auth)\n490\t    tab.assert_success()",
    "context_snippet": "def test_oauth2_implicit_flow_token_is_reused_if_only_nonce_differs(\n    token_cache, responses: RequestsMock, browser_mock: BrowserMock\n):\n    auth1 = requests_auth.OAuth2Implicit(\n        \"http://provide_token?response_type=custom_token&nonce=1\",\n        token_field_name=\"custom_token\",\n    )\n    expiry_in_1_hour = datetime.datetime.now(\n        datetime.timezone.utc\n    ) + datetime.timedelta(hours=1)\n    token = create_token(expiry_in_1_hour)\n    tab = browser_mock.add_response(\n        opened_url=\"http://provide_token?response_type=custom_token&state=67b95d2c7555751d1d72c97c7cd9ad6630c8395e0eaa51ee86ac7e451211ded9cd98a7190848789fe93632d8960425710e93f1f5549c6c6bc328bf3865a85ff2&redirect_uri=http%3A%2F%2Flocalhost%3A5000%2F&nonce=%5B%271%27%5D\",\n        reply_url=\"http://localhost:5000\",\n        data=f\"custom_token={token}&state=67b95d2c7555751d1d72c97c7cd9ad6630c8395e0eaa51ee86ac7e451211ded9cd98a7190848789fe93632d8960425710e93f1f5549c6c6bc328bf3865a85ff2\",\n    )\n    responses.get(\n        \"http://authorized_only\",\n        match=[header_matcher({\"Authorization\": f\"Bearer {token}\"})],\n    )\n\n    requests.get(\"http://authorized_only\", auth=auth1)\n\n    auth2 = requests_auth.OAuth2Implicit(\n        \"http://provide_token?response_type=custom_token&nonce=2\",\n        token_field_name=\"custom_token\",\n    )\n    responses.get(\n        \"http://authorized_only\",\n        match=[header_matcher({\"Authorization\": f\"Bearer {token}\"})],\n    )\n\n    requests.get(\"http://authorized_only\", auth=auth2)\n    tab.assert_success()\n",
    "hash_value": "c7504fa4bd4b2eabeccd4c8d733355f4"
  },
  {
    "pyfile": "test_oauth2_authorization_code_wakatime.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/requests_auth-8.0.0/requests_auth-8.0.0/tests/oauth2/authorization_code/test_oauth2_authorization_code_wakatime.py",
    "line_number": "416",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "415\t    )\n416\t    responses.get(\n417\t        \"https://authorized_only\",\n418\t        match=[header_matcher({\"Authorization\": \"Bearer waka_tok_67890\"})],\n419\t    )",
    "context_snippet": "def test_oauth2_authorization_code_flow_refresh_token(\n    token_cache, responses: RequestsMock, browser_mock: BrowserMock\n):\n    auth = requests_auth.WakaTimeAuthorizationCode(\n        \"jPJQV0op6Pu3b66MWDi8b1wD\",\n        \"waka_sec_0c4MBGeR9LN74LzV5uelF9SgeQ32CqfeWpIuieneBbsL57dAAlqqJWDiVDJOlsSx61pVwHMKlsb3uMvU\",\n        scope=\"email\",\n    )\n    tab = browser_mock.add_response(\n        opened_url=\"https://wakatime.com/oauth/authorize?client_id=jPJQV0op6Pu3b66MWDi8b1wD&client_secret=waka_sec_0c4MBGeR9LN74LzV5uelF9SgeQ32CqfeWpIuieneBbsL57dAAlqqJWDiVDJOlsSx61pVwHMKlsb3uMvU&scope=email&response_type=code&state=5d0adb208bdbecaf5cfb6de0bf4ba0aea52986f3fc5ea7bc30c4b2db449c17e5c9d15f9a3926476cdaf1c72e9f73c7cfdc624dde0187c38d8c6b04532770df2a&redirect_uri=http%3A%2F%2Flocalhost%3A5000%2F\",\n        reply_url=\"http://localhost:5000#code=SplxlOBeZQQYbYS6WxSbIA&state=5d0adb208bdbecaf5cfb6de0bf4ba0aea52986f3fc5ea7bc30c4b2db449c17e5c9d15f9a3926476cdaf1c72e9f73c7cfdc624dde0187c38d8c6b04532770df2a\",\n    )\n    responses.post(\n        \"https://wakatime.com/oauth/token\",\n        body=\"access_token=waka_tok_12345&token_type=bearer&expires_in=0&refresh_token=waka_ref_12345&scope=email&example_parameter=example_value\",\n        content_type=\"text/html; charset=utf-8\",\n        match=[\n            urlencoded_params_matcher(\n                {\n                    \"grant_type\": \"authorization_code\",\n                    \"redirect_uri\": \"http://localhost:5000/\",\n                    \"client_id\": \"jPJQV0op6Pu3b66MWDi8b1wD\",\n                    \"client_secret\": \"waka_sec_0c4MBGeR9LN74LzV5uelF9SgeQ32CqfeWpIuieneBbsL57dAAlqqJWDiVDJOlsSx61pVwHMKlsb3uMvU\",\n                    \"scope\": \"email\",\n                    \"response_type\": \"code\",\n                    \"code\": \"SplxlOBeZQQYbYS6WxSbIA\",\n                }\n            )\n        ],\n    )\n    responses.get(\n        \"https://authorized_only\",\n        match=[header_matcher({\"Authorization\": \"Bearer waka_tok_12345\"})],\n    )\n\n    requests.get(\"https://authorized_only\", auth=auth)\n\n    tab.assert_success()\n\n    # response for refresh token grant\n    responses.post(\n        \"https://wakatime.com/oauth/token\",\n        body=\"access_token=waka_tok_67890&token_type=bearer&expires_in=3600&refresh_token=waka_ref_12345&scope=email&example_parameter=example_value\",\n        content_type=\"text/html; charset=utf-8\",\n        match=[\n            urlencoded_params_matcher(\n                {\n                    \"grant_type\": \"refresh_token\",\n                    \"refresh_token\": \"waka_ref_12345\",\n                    \"client_id\": \"jPJQV0op6Pu3b66MWDi8b1wD\",\n                    \"client_secret\": \"waka_sec_0c4MBGeR9LN74LzV5uelF9SgeQ32CqfeWpIuieneBbsL57dAAlqqJWDiVDJOlsSx61pVwHMKlsb3uMvU\",\n                    \"scope\": \"email\",\n                    \"response_type\": \"code\",\n                }\n            )\n        ],\n    )\n    responses.get(\n        \"https://authorized_only\",\n        match=[header_matcher({\"Authorization\": \"Bearer waka_tok_67890\"})],\n    )\n\n    requests.get(\"https://authorized_only\", auth=auth)\n",
    "hash_value": "a8a7a7be2feda6f14803f7ec34389afa"
  },
  {
    "pyfile": "test_oauth2_authorization_code.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/requests_auth-8.0.0/requests_auth-8.0.0/tests/oauth2/authorization_code/test_oauth2_authorization_code.py",
    "line_number": "282",
    "type_description": "B821:post",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "281\t    )\n282\t    responses.post(\n283\t        \"http://provide_access_token\",\n284\t        json={\n285\t            \"access_token\": \"2YotnFZFEjr1zCsicMWpAA\",\n286\t            \"token_type\": \"example\",\n287\t            \"expires_in\": \"0\",\n288\t            \"refresh_token\": \"tGzv3JOkF0XG5Qx2TlKWIA\",\n289\t            \"example_parameter\": \"example_value\",\n290\t        },\n291\t        match=[\n292\t            urlencoded_params_matcher(\n293\t                {\n294\t                    \"grant_type\": \"authorization_code\",\n295\t                    \"redirect_uri\": \"http://localhost:5000/\",\n296\t                    \"response_type\": \"code\",\n297\t                    \"code\": \"SplxlOBeZQQYbYS6WxSbIA\",\n298\t                }",
    "context_snippet": "def test_refresh_token(token_cache, responses: RequestsMock, browser_mock: BrowserMock):\n    auth = requests_auth.OAuth2AuthorizationCode(\n        \"http://provide_code\", \"http://provide_access_token\"\n    )\n    tab = browser_mock.add_response(\n        opened_url=\"http://provide_code?response_type=code&state=163f0455b3e9cad3ca04254e5a0169553100d3aa0756c7964d897da316a695ffed5b4f46ef305094fd0a88cfe4b55ff257652015e4aa8f87b97513dba440f8de&redirect_uri=http%3A%2F%2Flocalhost%3A5000%2F\",\n        reply_url=\"http://localhost:5000#code=SplxlOBeZQQYbYS6WxSbIA&state=163f0455b3e9cad3ca04254e5a0169553100d3aa0756c7964d897da316a695ffed5b4f46ef305094fd0a88cfe4b55ff257652015e4aa8f87b97513dba440f8de\",\n    )\n    responses.post(\n        \"http://provide_access_token\",\n        json={\n            \"access_token\": \"2YotnFZFEjr1zCsicMWpAA\",\n            \"token_type\": \"example\",\n            \"expires_in\": \"0\",\n            \"refresh_token\": \"tGzv3JOkF0XG5Qx2TlKWIA\",\n            \"example_parameter\": \"example_value\",\n        },\n        match=[\n            urlencoded_params_matcher(\n                {\n                    \"grant_type\": \"authorization_code\",\n                    \"redirect_uri\": \"http://localhost:5000/\",\n                    \"response_type\": \"code\",\n                    \"code\": \"SplxlOBeZQQYbYS6WxSbIA\",\n                }\n            )\n        ],\n    )\n    responses.get(\n        \"http://authorized_only\",\n        match=[header_matcher({\"Authorization\": \"Bearer 2YotnFZFEjr1zCsicMWpAA\"})],\n    )\n\n    requests.get(\"http://authorized_only\", auth=auth)\n\n    tab.assert_success()\n\n    # response for refresh token grant\n    responses.post(\n        \"http://provide_access_token\",\n        json={\n            \"access_token\": \"rVR7Syg5bjZtZYjbZIW\",\n            \"token_type\": \"example\",\n            \"expires_in\": 3600,\n            \"refresh_token\": \"tGzv3JOkF0XG5Qx2TlKWIA\",\n            \"example_parameter\": \"example_value\",\n        },\n        match=[\n            urlencoded_params_matcher(\n                {\n                    \"grant_type\": \"refresh_token\",\n                    \"refresh_token\": \"tGzv3JOkF0XG5Qx2TlKWIA\",\n                    \"response_type\": \"code\",\n                }\n            )\n        ],\n    )\n    responses.get(\n        \"http://authorized_only\",\n        match=[header_matcher({\"Authorization\": \"Bearer rVR7Syg5bjZtZYjbZIW\"})],\n    )\n\n    requests.get(\"http://authorized_only\", auth=auth)\n",
    "hash_value": "96d1a50554220967699f01d67de6411e"
  }
]