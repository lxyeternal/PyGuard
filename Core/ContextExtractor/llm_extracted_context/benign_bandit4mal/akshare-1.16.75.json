[
  {
    "metadata": {
      "package_name": "akshare-1.16.75",
      "total_matches": 5,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "macro_constitute.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/akshare-1.16.75/akshare-1.16.75/akshare/economic/macro_constitute.py",
    "line_number": "183",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "182\t        bar.set_description(f\"Please wait for a moment, now downloading {item}'s data\")\n183\t        res = requests.get(\n184\t            url=f\"https://datacenter-api.jin10.com/reports/list?\"\n185\t            f\"category=opec&date={item}&_={str(int(round(t * 1000)))}\",\n186\t            headers=headers,\n187\t        )",
    "context_snippet": "def macro_cons_opec_month() -> pd.DataFrame:\n    \"\"\"\n    欧佩克报告-月度, 数据区间从 20170118-至今\n    这里返回的具体索引日期的数据为上一个月的数据, 由于某些国家的数据有缺失\n    只选择有数据的国家返回\n    20200312:fix:由于 “厄瓜多尔” 已经有几个月没有更新数据，在这里加以剔除\n    https://datacenter.jin10.com/reportType/dc_opec_report\n    :return: 欧佩克报告-月度\n    :rtype: pandas.DataFrame\n    \"\"\"\n    t = time.time()\n    big_df = pd.DataFrame()\n    headers = {\n        \"accept\": \"*/*\",\n        \"accept-encoding\": \"gzip, deflate, br\",\n        \"accept-language\": \"zh-CN,zh;q=0.9,en;q=0.8\",\n        \"cache-control\": \"no-cache\",\n        \"origin\": \"https://datacenter.jin10.com\",\n        \"pragma\": \"no-cache\",\n        \"referer\": \"https://datacenter.jin10.com/reportType/dc_opec_report\",\n        \"sec-fetch-mode\": \"cors\",\n        \"sec-fetch-site\": \"same-site\",\n        \"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) \"\n        \"Chrome/79.0.3945.117 Safari/537.36\",\n        \"x-app-id\": \"rU6QIu7JHe2gOUeR\",\n        \"x-csrf-token\": \"\",\n        \"x-version\": \"1.0.0\",\n    }\n    res = requests.get(\n        url=f\"https://datacenter-api.jin10.com/reports/dates?category=opec&_={str(int(round(t * 1000)))}\",\n        headers=headers,\n    )  # 日期序列\n    all_date_list = res.json()[\"data\"]\n    bar = tqdm(reversed(all_date_list))\n    for item in bar:\n        bar.set_description(f\"Please wait for a moment, now downloading {item}'s data\")\n        res = requests.get(\n            url=f\"https://datacenter-api.jin10.com/reports/list?\"\n            f\"category=opec&date={item}&_={str(int(round(t * 1000)))}\",\n            headers=headers,\n        )\n        temp_df = pd.DataFrame(\n            res.json()[\"data\"][\"values\"],\n            columns=pd.DataFrame(res.json()[\"data\"][\"keys\"])[\"name\"].tolist(),\n        ).T\n        temp_df.columns = temp_df.iloc[0, :]\n        temp_df = temp_df.iloc[1:, :]\n        try:\n            temp_df = temp_df[\n                [\n                    \"阿尔及利亚\",\n                    \"安哥拉\",\n                    \"加蓬\",\n                    \"伊朗\",\n                    \"伊拉克\",\n                    \"科威特\",\n                    \"利比亚\",\n                    \"尼日利亚\",\n                    \"沙特\",\n                    \"阿联酋\",\n                    \"委内瑞拉\",\n                    \"欧佩克产量\",\n                ]\n            ].iloc[-2, :]\n        except:  # noqa: E722\n            temp_df = temp_df[\n                [\n                    \"阿尔及利亚\",\n                    \"安哥拉\",\n                    \"加蓬\",\n                    \"伊朗\",\n                    \"伊拉克\",\n                    \"科威特\",\n                    \"利比亚\",\n                    \"尼日利亚\",\n                    \"沙特\",\n                    \"阿联酋\",\n                    \"委内瑞拉\",\n                    \"欧佩克产量\",\n                ]\n            ].iloc[-1, :]\n        temp_df.dropna(inplace=True)\n        big_df[temp_df.name] = temp_df\n    big_df = big_df.T\n    big_df = big_df.astype(float)\n    big_df.reset_index(inplace=True)\n    big_df.rename(columns={\"index\": \"日期\"}, inplace=True)\n    big_df.columns.name = None\n    return big_df",
    "hash_value": "00374edb02ad5cf653dd83f0e3994164"
  },
  {
    "pyfile": "macro_china.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/akshare-1.16.75/akshare-1.16.75/akshare/economic/macro_china.py",
    "line_number": "1357",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1356\t        params.update({\"pageNumber\": page})\n1357\t        r = requests.get(url, params=params)\n1358\t        data_json = r.json()",
    "context_snippet": "def macro_china_lpr() -> pd.DataFrame:\n    \"\"\"\n    LPR品种详细数据\n    https://data.eastmoney.com/cjsj/globalRateLPR.html\n    :return: LPR品种详细数据\n    :rtype: pandas.DataFrame\n    \"\"\"\n    import warnings\n\n    warnings.filterwarnings(action=\"ignore\", category=FutureWarning)\n\n    url = \"https://datacenter-web.eastmoney.com/api/data/v1/get\"\n    params = {\n        \"reportName\": \"RPTA_WEB_RATE\",\n        \"columns\": \"ALL\",\n        \"sortColumns\": \"TRADE_DATE\",\n        \"sortTypes\": \"-1\",\n        \"token\": \"894050c76af8597a853f5b408b759f5d\",\n        \"pageNumber\": \"1\",\n        \"pageSize\": \"500\",\n        \"p\": \"1\",\n        \"pageNo\": \"1\",\n        \"pageNum\": \"1\",\n    }\n    r = requests.get(url, params=params)\n    data_json = r.json()\n    total_page = data_json[\"result\"][\"pages\"]\n    big_df = pd.DataFrame()\n    tqdm = get_tqdm()\n    for page in tqdm(range(1, total_page + 1), leave=False):\n        params.update({\"pageNumber\": page})\n        r = requests.get(url, params=params)\n        data_json = r.json()\n        temp_df = pd.DataFrame(data_json[\"result\"][\"data\"])\n        big_df = pd.concat(objs=[big_df, temp_df], ignore_index=True)\n\n    big_df[\"TRADE_DATE\"] = pd.to_datetime(big_df[\"TRADE_DATE\"], errors=\"coerce\").dt.date\n    big_df[\"LPR1Y\"] = pd.to_numeric(big_df[\"LPR1Y\"], errors=\"coerce\")\n    big_df[\"LPR5Y\"] = pd.to_numeric(big_df[\"LPR5Y\"], errors=\"coerce\")\n    big_df[\"RATE_1\"] = pd.to_numeric(big_df[\"RATE_1\"], errors=\"coerce\")\n    big_df[\"RATE_2\"] = pd.to_numeric(big_df[\"RATE_2\"], errors=\"coerce\")\n    big_df.sort_values(by=[\"TRADE_DATE\"], inplace=True)\n    big_df.reset_index(inplace=True, drop=True)\n    return big_df",
    "hash_value": "fdbf2b3cbd0268695cf9a35e4f3102d4"
  },
  {
    "pyfile": "macro_china.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/akshare-1.16.75/akshare-1.16.75/akshare/economic/macro_china.py",
    "line_number": "1625",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1624\t    }\n1625\t    r = requests.get(url, params=params)\n1626\t    data_json = r.json()",
    "context_snippet": "def macro_china_qyspjg() -> pd.DataFrame:\n    \"\"\"\n    东方财富-经济数据一览-中国-企业商品价格指数\n    https://data.eastmoney.com/cjsj/qyspjg.html\n    :return: 企业商品价格指数\n    :rtype: pandas.DataFrame\n    \"\"\"\n    url = \"https://datacenter-web.eastmoney.com/api/data/v1/get\"\n    params = {\n        \"columns\": \"REPORT_DATE,TIME,BASE,BASE_SAME,BASE_SEQUENTIAL,FARM_BASE,FARM_BASE_SAME,\"\n        \"FARM_BASE_SEQUENTIAL,MINERAL_BASE,MINERAL_BASE_SAME,MINERAL_BASE_SEQUENTIAL,\"\n        \"ENERGY_BASE,ENERGY_BASE_SAME,ENERGY_BASE_SEQUENTIAL\",\n        \"pageNumber\": \"1\",\n        \"pageSize\": \"2000\",\n        \"sortColumns\": \"REPORT_DATE\",\n        \"sortTypes\": \"-1\",\n        \"source\": \"WEB\",\n        \"client\": \"WEB\",\n        \"reportName\": \"RPT_ECONOMY_GOODS_INDEX\",\n        \"p\": \"1\",\n        \"pageNo\": \"1\",\n        \"pageNum\": \"1\",\n    }\n    r = requests.get(url, params=params)\n    data_json = r.json()\n    temp_df = pd.DataFrame(data_json[\"result\"][\"data\"])\n    temp_df.rename(\n        columns={\n            \"REPORT_DATE\": \"-\",\n            \"TIME\": \"月份\",\n            \"BASE\": \"总指数-指数值\",\n            \"BASE_SAME\": \"总指数-同比增长\",\n            \"BASE_SEQUENTIAL\": \"总指数-环比增长\",\n            \"FARM_BASE\": \"农产品-指数值\",\n            \"FARM_BASE_SAME\": \"农产品-同比增长\",\n            \"FARM_BASE_SEQUENTIAL\": \"农产品-环比增长\",\n            \"MINERAL_BASE\": \"矿产品-指数值\",\n            \"MINERAL_BASE_SAME\": \"矿产品-同比增长\",\n            \"MINERAL_BASE_SEQUENTIAL\": \"矿产品-环比增长\",\n            \"ENERGY_BASE\": \"煤油电-指数值\",\n            \"ENERGY_BASE_SAME\": \"煤油电-同比增长\",\n            \"ENERGY_BASE_SEQUENTIAL\": \"煤油电-环比增长\",\n        },\n        inplace=True,\n    )\n\n    temp_df = temp_df[\n        [\n            \"月份\",\n            \"总指数-指数值\",\n            \"总指数-同比增长\",\n            \"总指数-环比增长\",\n            \"农产品-指数值\",\n            \"农产品-同比增长\",\n            \"农产品-环比增长\",\n            \"矿产品-指数值\",\n            \"矿产品-同比增长\",\n            \"矿产品-环比增长\",\n            \"煤油电-指数值\",\n            \"煤油电-同比增长\",\n            \"煤油电-环比增长\",\n        ]\n    ]\n    temp_df[\"总指数-指数值\"] = pd.to_numeric(temp_df[\"总指数-指数值\"], errors=\"coerce\")\n    temp_df[\"总指数-同比增长\"] = pd.to_numeric(\n        temp_df[\"总指数-同比增长\"], errors=\"coerce\"\n    )\n    temp_df[\"总指数-环比增长\"] = pd.to_numeric(\n        temp_df[\"总指数-环比增长\"], errors=\"coerce\"\n    )\n    temp_df[\"农产品-指数值\"] = pd.to_numeric(temp_df[\"农产品-指数值\"], errors=\"coerce\")\n    temp_df[\"农产品-同比增长\"] = pd.to_numeric(\n        temp_df[\"农产品-同比增长\"], errors=\"coerce\"\n    )\n    temp_df[\"农产品-环比增长\"] = pd.to_numeric(\n        temp_df[\"农产品-环比增长\"], errors=\"coerce\"\n    )\n    temp_df[\"矿产品-指数值\"] = pd.to_numeric(temp_df[\"矿产品-指数值\"], errors=\"coerce\")\n    temp_df[\"矿产品-同比增长\"] = pd.to_numeric(\n        temp_df[\"矿产品-同比增长\"], errors=\"coerce\"\n    )\n    temp_df[\"矿产品-环比增长\"] = pd.to_numeric(\n        temp_df[\"矿产品-环比增长\"], errors=\"coerce\"\n    )\n    temp_df[\"煤油电-指数值\"] = pd.to_numeric(temp_df[\"煤油电-指数值\"], errors=\"coerce\")\n    temp_df[\"煤油电-同比增长\"] = pd.to_numeric(\n        temp_df[\"煤油电-同比增长\"], errors=\"coerce\"\n    )\n    temp_df[\"煤油电-环比增长\"] = pd.to_numeric(\n        temp_df[\"煤油电-环比增长\"], errors=\"coerce\"\n    )\n    return temp_df",
    "hash_value": "e63629ac2f9edfe9a3090df56603a366"
  },
  {
    "pyfile": "macro_china.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/akshare-1.16.75/akshare-1.16.75/akshare/economic/macro_china.py",
    "line_number": "911",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "910\t    params = {\"_\": t}\n911\t    res = requests.get(\n912\t        url=\"https://cdn.jin10.com/data_center/reports/sge.json\", params=params\n913\t    )",
    "context_snippet": "def macro_china_au_report() -> pd.DataFrame:\n    \"\"\"\n    上海黄金交易所报告, 数据区间从20100331-至今\n    https://datacenter.jin10.com/reportType/dc_sge_report\n    :return: pandas.DataFrame\n    \"\"\"\n    t = time.time()\n    params = {\"_\": t}\n    res = requests.get(\n        url=\"https://cdn.jin10.com/data_center/reports/sge.json\", params=params\n    )\n    json_data = res.json()\n    big_df = pd.DataFrame()\n    for item in json_data[\"values\"].keys():\n        temp_df = pd.DataFrame(json_data[\"values\"][item])\n        temp_df[\"date\"] = item\n        temp_df.columns = [\n            \"商品\",\n            \"开盘价\",\n            \"最高价\",\n            \"最低价\",\n            \"收盘价\",\n            \"涨跌\",\n            \"涨跌幅\",\n            \"加权平均价\",\n            \"成交量\",\n            \"成交金额\",\n            \"持仓量\",\n            \"交收方向\",\n            \"交收量\",\n            \"日期\",\n        ]\n        big_df = pd.concat([big_df, temp_df], ignore_index=True)\n    big_df = big_df[\n        [\n            \"日期\",\n            \"商品\",\n            \"开盘价\",\n            \"最高价\",\n            \"最低价\",\n            \"收盘价\",\n            \"涨跌\",\n            \"涨跌幅\",\n            \"加权平均价\",\n            \"成交量\",\n            \"成交金额\",\n            \"持仓量\",\n            \"交收方向\",\n            \"交收量\",\n        ]\n    ]\n    big_df[\"日期\"] = pd.to_datetime(big_df[\"日期\"]).dt.date\n    big_df.sort_values([\"日期\"], inplace=True, ignore_index=True)\n    big_df[\"持仓量\"] = pd.to_numeric(big_df[\"持仓量\"], errors=\"coerce\")\n    big_df[\"交收量\"] = pd.to_numeric(big_df[\"交收量\"], errors=\"coerce\")\n    return big_df",
    "hash_value": "9e2806c425aa219e6ffd132eabd47a32"
  },
  {
    "pyfile": "demjson.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/akshare-1.16.75/akshare-1.16.75/akshare/utils/demjson.py",
    "line_number": "6382",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "6381\t        try:\n6382\t            fp.write(jsondata)\n6383\t        finally:",
    "context_snippet": "def encode_to_file(filename, obj, encoding=\"utf-8\", overwrite=False, **kwargs):\n    \"\"\"Encodes a Python object into JSON and writes into the given file.\n\n    If no encoding is given, then UTF-8 will be used.\n\n    See the encode() function for a description of other possible options.\n\n    If the file already exists and the 'overwrite' option is not set\n    to True, then the existing file will not be overwritten.  (Note,\n    there is a subtle race condition in the check so there are\n    possible conditions in which a file may be overwritten)\n\n    \"\"\"\n    import os\n    import errno\n\n    if not encoding:\n        encoding = \"utf-8\"\n\n    if not isinstance(filename, str) or not filename:\n        raise TypeError(\"Expected a file name\")\n\n    if not overwrite and os.path.exists(filename):\n        raise IOError(errno.EEXIST, \"File exists: %r\" % filename)\n\n    jsondata = encode(obj, encoding=encoding, **kwargs)\n\n    try:\n        fp = open(filename, \"wb\")\n    except Exception:\n        raise\n    else:\n        try:\n            fp.write(jsondata)\n        finally:\n            fp.close()",
    "hash_value": "b6e113d46752a75d0d724aa2314ba6de"
  }
]