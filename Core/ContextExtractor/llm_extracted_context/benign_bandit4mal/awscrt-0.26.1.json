[
  {
    "metadata": {
      "package_name": "awscrt-0.26.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_http_client.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/awscrt-0.26.1/awscrt-0.26.1/test/test_http_client.py",
    "line_number": "58",
    "type_description": "B827:httpserver",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "57\n58\t        self.server = HTTPServer((self.hostname, 0), TestRequestHandler)\n59\t        if secure:",
    "context_snippet": "    def _start_server(self, secure, http_1_0=False):\n        # HTTP/1.0 closes the connection at the end of each request\n        # HTTP/1.1 will keep the connection alive\n        if http_1_0:\n            TestRequestHandler.protocol_version = \"HTTP/1.0\"\n        else:\n            TestRequestHandler.protocol_version = \"HTTP/1.1\"\n\n        self.server = HTTPServer((self.hostname, 0), TestRequestHandler)\n        if secure:\n            context = ssl.SSLContext(ssl.PROTOCOL_TLS_SERVER)\n            context.load_cert_chain(certfile='test/resources/unittest.crt', keyfile=\"test/resources/unittest.key\")\n            self.server.socket = context.wrap_socket(self.server.socket, server_side=True)\n        self.port = self.server.server_address[1]\n\n        # put requests are stored in this dict\n        self.server.put_requests = {}\n\n        self.server_thread = threading.Thread(target=self.server.serve_forever, name='test_server')\n        self.server_thread.start()",
    "hash_value": "648488db5156c9198d9a4f8d7057049f"
  }
]