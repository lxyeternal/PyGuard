[
  {
    "metadata": {
      "package_name": "cellpose-3.1.1.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "io.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cellpose-3.1.1.1/cellpose-3.1.1.1/cellpose/io.py",
    "line_number": "199",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "198\t        else:\n199\t            img, metadata = nrrd.read(filename)\n200\t            if img.ndim == 3:",
    "context_snippet": "def imread(filename):\n    \"\"\"\n    Read in an image file with tif or image file type supported by cv2.\n\n    Args:\n        filename (str): The path to the image file.\n\n    Returns:\n        numpy.ndarray: The image data as a NumPy array.\n\n    Raises:\n        None\n\n    Raises an error if the image file format is not supported.\n\n    Examples:\n        >>> img = imread(\"image.tif\")\n    \"\"\"\n    # ensure that extension check is not case sensitive\n    ext = os.path.splitext(filename)[-1].lower()\n    if ext == \".tif\" or ext == \".tiff\" or ext == \".flex\":\n        with tifffile.TiffFile(filename) as tif:\n            ltif = len(tif.pages)\n            try:\n                full_shape = tif.shaped_metadata[0][\"shape\"]\n            except:\n                try:\n                    page = tif.series[0][0]\n                    full_shape = tif.series[0].shape\n                except:\n                    ltif = 0\n            if ltif < 10:\n                img = tif.asarray()\n            else:\n                page = tif.series[0][0]\n                shape, dtype = page.shape, page.dtype\n                ltif = int(np.prod(full_shape) / np.prod(shape))\n                io_logger.info(f\"reading tiff with {ltif} planes\")\n                img = np.zeros((ltif, *shape), dtype=dtype)\n                for i, page in enumerate(tqdm(tif.series[0])):\n                    img[i] = page.asarray()\n                img = img.reshape(full_shape)\n        return img\n    elif ext == \".dax\":\n        img = load_dax(filename)\n        return img\n    elif ext == \".nd2\":\n        if not ND2:\n            io_logger.critical(\"ERROR: need to 'pip install nd2' to load in .nd2 file\")\n            return None\n    elif ext == \".nrrd\":\n        if not NRRD:\n            io_logger.critical(\n                \"ERROR: need to 'pip install pynrrd' to load in .nrrd file\")\n            return None\n        else:\n            img, metadata = nrrd.read(filename)\n            if img.ndim == 3:\n                img = img.transpose(2, 0, 1)\n            return img\n    elif ext != \".npy\":\n        try:\n            img = cv2.imread(filename, -1)  #cv2.LOAD_IMAGE_ANYDEPTH)\n            if img.ndim > 2:\n                img = img[..., [2, 1, 0]]\n            return img\n        except Exception as e:\n            io_logger.critical(\"ERROR: could not read file, %s\" % e)\n            return None\n    else:\n        try:\n            dat = np.load(filename, allow_pickle=True).item()\n            masks = dat[\"masks\"]\n            return masks\n        except Exception as e:\n            io_logger.critical(\"ERROR: could not read masks from file, %s\" % e)\n            return None",
    "hash_value": "24dee4c20b53867939d0c39946eae861"
  }
]