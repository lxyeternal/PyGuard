[
  {
    "metadata": {
      "package_name": "sslyze-6.1.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "session_renegotiation_plugin.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/sslyze-6.1.0/sslyze-6.1.0/sslyze/plugins/session_renegotiation_plugin.py",
    "line_number": "155",
    "type_description": "B804:connect",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "154\t        # Perform the TLS handshake\n155\t        ssl_connection.connect()\n156\t        supports_secure_renegotiation = ssl_connection.ssl_client.get_secure_renegotiation_support()",
    "context_snippet": "def _test_secure_renegotiation(server_info: ServerConnectivityInfo) -> Tuple[_ScanJobResultEnum, bool]:\n    \"\"\"Check whether the server supports secure renegotiation.\"\"\"\n    # Try with TLS 1.2 even if the server supports TLS 1.3 or higher as there is no reneg with TLS 1.3\n    if server_info.tls_probing_result.highest_tls_version_supported.value >= TlsVersionEnum.TLS_1_3.value:\n        tls_version_to_use = TlsVersionEnum.TLS_1_2\n        downgraded_from_tls_1_3 = True\n    else:\n        tls_version_to_use = server_info.tls_probing_result.highest_tls_version_supported\n        downgraded_from_tls_1_3 = False\n\n    ssl_connection = server_info.get_preconfigured_tls_connection(\n        override_tls_version=tls_version_to_use,\n        should_use_legacy_openssl=True,  # Only the legacy SSL client has methods to check for secure reneg\n    )\n    if not isinstance(ssl_connection.ssl_client, LegacySslClient):\n        raise RuntimeError(\"Should never happen\")\n\n    try:\n        # Perform the TLS handshake\n        ssl_connection.connect()\n        supports_secure_renegotiation = ssl_connection.ssl_client.get_secure_renegotiation_support()\n\n    # Should only happen when the server only supports TLS 1.3\n    except ServerRejectedTlsHandshake:\n        if downgraded_from_tls_1_3:\n            supports_secure_renegotiation = True  # Technically TLS 1.3 has no renegotiation therefore it is secure\n        else:\n            raise\n\n    finally:\n        ssl_connection.close()\n\n    return _ScanJobResultEnum.SUPPORTS_SECURE_RENEG, supports_secure_renegotiation",
    "hash_value": "cc78265639f83faa4b18e7a603fcaea1"
  }
]