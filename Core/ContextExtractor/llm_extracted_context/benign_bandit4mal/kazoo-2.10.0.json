[
  {
    "metadata": {
      "package_name": "kazoo-2.10.0",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_client.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py",
    "line_number": "425",
    "type_description": "B807:close",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "424\t        # close the connection to free the socket\n425\t        client.close()\n426\t        assert client._connection._write_sock is None",
    "context_snippet": "def test_closed(self):\n    client = self.client\n    client.stop()\n\n    write_sock = client._connection._write_sock\n\n    # close the connection to free the socket\n    client.close()\n    assert client._connection._write_sock is None\n\n    # sneak in and patch client to simulate race between a thread\n    # calling stop(); close() and one running a command\n    oldstate = client._state\n    client._state = KeeperState.CONNECTED\n    client._connection._write_sock = write_sock\n\n    try:\n        # simulate call made after write socket is closed\n        with pytest.raises(ConnectionClosedError):\n            client.exists(\"/\")\n\n        # simulate call made after write socket is set to None\n        client._connection._write_sock = None\n\n        with pytest.raises(ConnectionClosedError):\n            client.exists(\"/\")\n\n    finally:\n        # reset for teardown\n        client._state = oldstate\n        client._connection._write_sock = None",
    "hash_value": "ac2ae12db0be1e6841139c48443b5f7f"
  },
  {
    "pyfile": "test_selectors_select.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_selectors_select.py",
    "line_number": "54",
    "type_description": "B813:popen",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "53\t        cmd = \"for i in 0 1 2 3 4 5 6 7 8 9; do echo testing...; sleep 1; done\"\n54\t        p = os.popen(cmd, \"r\")\n55\t        for tout in (0, 1, 2, 4, 8, 16) + (None,) * 10:",
    "context_snippet": "    def test_select(self):\n        cmd = \"for i in 0 1 2 3 4 5 6 7 8 9; do echo testing...; sleep 1; done\"\n        p = os.popen(cmd, \"r\")\n        for tout in (0, 1, 2, 4, 8, 16) + (None,) * 10:\n            rfd, wfd, xfd = select([p], [], [], tout)\n            if (rfd, wfd, xfd) == ([], [], []):\n                continue\n            if (rfd, wfd, xfd) == ([p], [], []):\n                line = p.readline()\n                if not line:\n                    break\n                continue\n            self.fail(\"Unexpected return values from select():\", rfd, wfd, xfd)\n        p.close()",
    "hash_value": "e8527b784c68933f12e51085e021f351"
  }
]