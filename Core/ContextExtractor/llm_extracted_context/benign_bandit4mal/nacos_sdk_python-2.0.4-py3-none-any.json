[
  {
    "metadata": {
      "package_name": "nacos_sdk_python-2.0.4-py3-none-any",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "client.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/nacos_sdk_python-2.0.4-py3-none-any/nacos/client.py",
    "line_number": "865",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "864\t            resp = self._do_sync_req(\"/nacos/v1/auth/login\", None, params, None, self.default_timeout, \"POST\", \"login\")\n865\t            c = resp.read()\n866\t            response_data = json.loads(c.decode(\"UTF-8\"))",
    "context_snippet": "def get_access_token(self, force_refresh=False):\n    current_time = time.time()\n    if self.token and not force_refresh and self.token_expire_time > current_time:\n        return self.token\n\n    params = {\n        \"username\": self.username,\n        \"password\": self.password\n    }\n    try:\n        resp = self._do_sync_req(\"/nacos/v1/auth/login\", None, params, None, self.default_timeout, \"POST\", \"login\")\n        c = resp.read()\n        response_data = json.loads(c.decode(\"UTF-8\"))\n        self.token = response_data.get('accessToken')\n        self.token_ttl = response_data.get('tokenTtl', 18000)  # 默认使用返回值，无返回则使用18000秒\n        self.token_expire_time = current_time + self.token_ttl - 10  # 更新 Token 的过期时间\n        logger.info(\n            f\"[get_access_token] AccessToken: {self.token}, TTL: {self.token_ttl}，force_refresh：{force_refresh}\")\n    except Exception as e:\n        logger.exception(\"[get-access-token] exception %s occur\" % str(e))\n        raise",
    "hash_value": "59d6dc81dec81c25406707d9c8f325bf"
  }
]