[
  {
    "metadata": {
      "package_name": "gocardless_pro-2.5.0",
      "total_matches": 6,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "payer_themes_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/payer_themes_integration_test.py",
    "line_number": "46",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "45\t      assert len(rsps.calls) == 2\n46\t      assert rsps.calls[0].request.headers.get('Idempotency-Key') == rsps.calls[1].request.headers.get('Idempotency-Key')\n47\t    body = fixture['body']['payer_themes']",
    "context_snippet": "@responses.activate\ndef test_timeout_payer_themes_create_for_creditor_retries():\n    fixture = helpers.load_fixture('payer_themes')['create_for_creditor']\n    with helpers.stub_timeout_then_response(fixture) as rsps:\n      response = helpers.client.payer_themes.create_for_creditor(*fixture['url_params'])\n      assert len(rsps.calls) == 2\n      assert rsps.calls[0].request.headers.get('Idempotency-Key') == rsps.calls[1].request.headers.get('Idempotency-Key')\n    body = fixture['body']['payer_themes']\n\n    assert isinstance(response, resources.PayerTheme)",
    "hash_value": "360014cad6c6d9511d0e96e3e5dda26b"
  },
  {
    "pyfile": "billing_requests_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/billing_requests_integration_test.py",
    "line_number": "1125",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1124\t    assert response.mandate_request.verify == body.get('mandate_request')['verify']\n1125\t    assert response.payment_request.amount == body.get('payment_request')['amount']\n1126\t    assert response.payment_request.app_fee == body.get('payment_request')['app_fee']",
    "context_snippet": "@responses.activate\ndef test_billing_requests_get():\n    fixture = helpers.load_fixture('billing_requests')['get']\n    helpers.stub_response(fixture)\n    response = helpers.client.billing_requests.get(*fixture['url_params'])\n    body = fixture['body']['billing_requests']\n\n    assert isinstance(response, resources.BillingRequest)\n    assert responses.calls[-1].request.headers.get('Idempotency-Key') is None\n    assert response.actions == body.get('actions')\n    assert response.created_at == body.get('created_at')\n    assert response.fallback_enabled == body.get('fallback_enabled')\n    assert response.fallback_occurred == body.get('fallback_occurred')\n    assert response.id == body.get('id')\n    assert response.metadata == body.get('metadata')\n    assert response.purpose_code == body.get('purpose_code')\n    assert response.status == body.get('status')\n    assert response.instalment_schedule_request.app_fee == body.get('instalment_schedule_request')['app_fee']\n    assert response.instalment_schedule_request.currency == body.get('instalment_schedule_request')['currency']\n    assert response.instalment_schedule_request.instalments_with_dates == body.get('instalment_schedule_request')['instalments_with_dates']\n    assert response.instalment_schedule_request.instalments_with_schedule == body.get('instalment_schedule_request')['instalments_with_schedule']\n    assert response.instalment_schedule_request.links == body.get('instalment_schedule_request')['links']\n    assert response.instalment_schedule_request.metadata == body.get('instalment_schedule_request')['metadata']\n    assert response.instalment_schedule_request.name == body.get('instalment_schedule_request')['name']\n    assert response.instalment_schedule_request.payment_reference == body.get('instalment_schedule_request')['payment_reference']\n    assert response.instalment_schedule_request.retry_if_possible == body.get('instalment_schedule_request')['retry_if_possible']\n    assert response.instalment_schedule_request.total_amount == body.get('instalment_schedule_request')['total_amount']\n    assert response.links.bank_authorisation == body.get('links')['bank_authorisation']\n    assert response.links.creditor == body.get('links')['creditor']\n    assert response.links.customer == body.get('links')['customer']\n    assert response.links.customer_bank_account == body.get('links')['customer_bank_account']\n    assert response.links.customer_billing_detail == body.get('links')['customer_billing_detail']\n    assert response.links.instalment_schedule_request == body.get('links')['instalment_schedule_request']\n    assert response.links.instalment_schedule_request_instalment_schedule == body.get('links')['instalment_schedule_request_instalment_schedule']\n    assert response.links.mandate_request == body.get('links')['mandate_request']\n    assert response.links.mandate_request_mandate == body.get('links')['mandate_request_mandate']\n    assert response.links.organisation == body.get('links')['organisation']\n    assert response.links.payment_provider == body.get('links')['payment_provider']\n    assert response.links.payment_request == body.get('links')['payment_request']\n    assert response.links.payment_request_payment == body.get('links')['payment_request_payment']\n    assert response.links.subscription_request == body.get('links')['subscription_request']\n    assert response.links.subscription_request_subscription == body.get('links')['subscription_request_subscription']\n    assert response.mandate_request.authorisation_source == body.get('mandate_request')['authorisation_source']\n    assert response.mandate_request.consent_type == body.get('mandate_request')['consent_type']\n    assert response.mandate_request.constraints == body.get('mandate_request')['constraints']\n    assert response.mandate_request.currency == body.get('mandate_request')['currency']\n    assert response.mandate_request.description == body.get('mandate_request')['description']\n    assert response.mandate_request.links == body.get('mandate_request')['links']\n    assert response.mandate_request.metadata == body.get('mandate_request')['metadata']\n    assert response.mandate_request.payer_requested_dual_signature == body.get('mandate_request')['payer_requested_dual_signature']\n    assert response.mandate_request.scheme == body.get('mandate_request')['scheme']\n    assert response.mandate_request.sweeping == body.get('mandate_request')['sweeping']\n    assert response.mandate_request.verify == body.get('mandate_request')['verify']\n    assert response.payment_request.amount == body.get('payment_request')['amount']\n    assert response.payment_request.app_fee == body.get('payment_request')['app_fee']\n    assert response.payment_request.currency == body.get('payment_request')['currency']\n    assert response.payment_request.description == body.get('payment_request')['description']\n    assert response.payment_request.funds_settlement == body.get('payment_request')['funds_settlement']\n    assert response.payment_request.links == body.get('payment_request')['links']\n    assert response.payment_request.metadata == body.get('payment_request')['metadata']\n    assert response.payment_request.reference == body.get('payment_request')['reference']\n    assert response.payment_request.scheme == body.get('payment_request')['scheme']\n    assert response.resources.customer == body.get('resources')['customer']\n    assert response.resources.customer_bank_account == body.get('resources')['customer_bank_account']\n    assert response.resources.customer_billing_detail == body.get('resources')['customer_billing_detail']\n    assert response.subscription_request.amount == body.get('subscription_request')['amount']\n    assert response.subscription_request.app_fee == body.get('subscription_request')['app_fee']\n    assert response.subscription_request.count == body.get('subscription_request')['count']\n    assert response.subscription_request.currency == body.get('subscription_request')['currency']\n    assert response.subscription_request.day_of_month == body.get('subscription_request')['day_of_month']\n    assert response.subscription_request.interval == body.get('subscription_request')['interval']\n    assert response.subscription_request.interval_unit == body.get('subscription_request')['interval_unit']\n    assert response.subscription_request.links == body.get('subscription_request')['links']\n    assert response.subscription_request.metadata == body.get('subscription_request')['metadata']\n    assert response.subscription_request.month == body.get('subscription_request')['month']\n    assert response.subscription_request.name == body.get('subscription_request')['name']\n    assert response.subscription_request.payment_reference == body.get('subscription_request')['payment_reference']\n    assert response.subscription_request.retry_if_possible == body.get('subscription_request')['retry_if_possible']\n    assert response.subscription_request.start_date == body.get('subscription_request')['start_date']",
    "hash_value": "21daf4d14ebe691d4a69c06798e31991"
  },
  {
    "pyfile": "payer_authorisations_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/payer_authorisations_integration_test.py",
    "line_number": "272",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "271\t    assert response.customer.company_name == body.get('customer')['company_name']\n272\t    assert response.customer.country_code == body.get('customer')['country_code']\n273\t    assert response.customer.danish_identity_number == body.get('customer')['danish_identity_number']",
    "context_snippet": "@responses.activate\ndef test_payer_authorisations_get():\n    fixture = helpers.load_fixture('payer_authorisations')['get']\n    helpers.stub_response(fixture)\n    response = helpers.client.payer_authorisations.get(*fixture['url_params'])\n    body = fixture['body']['payer_authorisations']\n\n    assert isinstance(response, resources.PayerAuthorisation)\n    assert responses.calls[-1].request.headers.get('Idempotency-Key') is None\n    assert response.created_at == body.get('created_at')\n    assert response.id == body.get('id')\n    assert response.incomplete_fields == body.get('incomplete_fields')\n    assert response.status == body.get('status')\n    assert response.bank_account.account_holder_name == body.get('bank_account')['account_holder_name']\n    assert response.bank_account.account_number == body.get('bank_account')['account_number']\n    assert response.bank_account.account_number_ending == body.get('bank_account')['account_number_ending']\n    assert response.bank_account.account_number_suffix == body.get('bank_account')['account_number_suffix']\n    assert response.bank_account.account_type == body.get('bank_account')['account_type']\n    assert response.bank_account.bank_code == body.get('bank_account')['bank_code']\n    assert response.bank_account.branch_code == body.get('bank_account')['branch_code']\n    assert response.bank_account.country_code == body.get('bank_account')['country_code']\n    assert response.bank_account.currency == body.get('bank_account')['currency']\n    assert response.bank_account.iban == body.get('bank_account')['iban']\n    assert response.bank_account.metadata == body.get('bank_account')['metadata']\n    assert response.customer.address_line1 == body.get('customer')['address_line1']\n    assert response.customer.address_line2 == body.get('customer')['address_line2']\n    assert response.customer.address_line3 == body.get('customer')['address_line3']\n    assert response.customer.city == body.get('customer')['city']\n    assert response.customer.company_name == body.get('customer')['company_name']\n    assert response.customer.country_code == body.get('customer')['country_code']\n    assert response.customer.danish_identity_number == body.get('customer')['danish_identity_number']\n    assert response.customer.email == body.get('customer')['email']\n    assert response.customer.family_name == body.get('customer')['family_name']\n    assert response.customer.given_name == body.get('customer')['given_name']\n    assert response.customer.locale == body.get('customer')['locale']\n    assert response.customer.metadata == body.get('customer')['metadata']\n    assert response.customer.postal_code == body.get('customer')['postal_code']\n    assert response.customer.region == body.get('customer')['region']\n    assert response.customer.swedish_identity_number == body.get('customer')['swedish_identity_number']\n    assert response.links.bank_account == body.get('links')['bank_account']\n    assert response.links.customer == body.get('links')['customer']\n    assert response.links.mandate == body.get('links')['mandate']\n    assert response.mandate.metadata == body.get('mandate')['metadata']\n    assert response.mandate.payer_ip_address == body.get('mandate')['payer_ip_address']\n    assert response.mandate.reference == body.get('mandate')['reference']\n    assert response.mandate.scheme == body.get('mandate')['scheme']",
    "hash_value": "a87b00afbdd1ea56e8cfd31e8cc9e020"
  },
  {
    "pyfile": "blocks_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/blocks_integration_test.py",
    "line_number": "60",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "59\t      assert len(rsps.calls) == 2\n60\t      assert rsps.calls[0].request.headers.get('Idempotency-Key') == rsps.calls[1].request.headers.get('Idempotency-Key')\n61\t    body = fixture['body']['blocks']",
    "context_snippet": "@responses.activate\ndef test_timeout_blocks_create_retries():\n    fixture = helpers.load_fixture('blocks')['create']\n    with helpers.stub_timeout_then_response(fixture) as rsps:\n      response = helpers.client.blocks.create(*fixture['url_params'])\n      assert len(rsps.calls) == 2\n      assert rsps.calls[0].request.headers.get('Idempotency-Key') == rsps.calls[1].request.headers.get('Idempotency-Key')\n    body = fixture['body']['blocks']\n\n    assert isinstance(response, resources.Block)\n",
    "hash_value": "79737e225cc1db96a98e449fcf781a83"
  },
  {
    "pyfile": "redirect_flows_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/redirect_flows_integration_test.py",
    "line_number": "50",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "49\t    helpers.client.redirect_flows.create(*fixture['url_params'])\n50\t    assert responses.calls[0].request.headers.get('Idempotency-Key') != responses.calls[1].request.headers.get('Idempotency-Key')\n51",
    "context_snippet": "@responses.activate\ndef test_redirect_flows_create_new_idempotency_key_for_each_call():\n    fixture = helpers.load_fixture('redirect_flows')['create']\n    helpers.stub_response(fixture)\n    helpers.client.redirect_flows.create(*fixture['url_params'])\n    helpers.client.redirect_flows.create(*fixture['url_params'])\n    assert responses.calls[0].request.headers.get('Idempotency-Key') != responses.calls[1].request.headers.get('Idempotency-Key')\n",
    "hash_value": "134e4be276d19822c72ef8bb8c6d06cf"
  },
  {
    "pyfile": "billing_request_flows_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/billing_request_flows_integration_test.py",
    "line_number": "97",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "96\t    assert response.expires_at == body.get('expires_at')\n97\t    assert response.id == body.get('id')\n98\t    assert response.language == body.get('language')",
    "context_snippet": "@responses.activate\ndef test_billing_request_flows_create():\n    fixture = helpers.load_fixture('billing_request_flows')['create']\n    helpers.stub_response(fixture)\n    response = helpers.client.billing_request_flows.create(*fixture['url_params'])\n    body = fixture['body']['billing_request_flows']\n\n    assert isinstance(response, resources.BillingRequestFlow)\n    assert responses.calls[-1].request.headers.get('Idempotency-Key') is not None\n    assert response.authorisation_url == body.get('authorisation_url')\n    assert response.auto_fulfil == body.get('auto_fulfil')\n    assert response.created_at == body.get('created_at')\n    assert response.customer_details_captured == body.get('customer_details_captured')\n    assert response.exit_uri == body.get('exit_uri')\n    assert response.expires_at == body.get('expires_at')\n    assert response.id == body.get('id')\n    assert response.language == body.get('language')\n    assert response.lock_bank_account == body.get('lock_bank_account')\n    assert response.lock_currency == body.get('lock_currency')\n    assert response.lock_customer_details == body.get('lock_customer_details')\n    assert response.redirect_uri == body.get('redirect_uri')\n    assert response.session_token == body.get('session_token')\n    assert response.show_redirect_buttons == body.get('show_redirect_buttons')\n    assert response.show_success_redirect_button == body.get('show_success_redirect_button')\n    assert response.skip_success_screen == body.get('skip_success_screen')\n    assert response.links.billing_request == body.get('links')['billing_request']\n    assert response.prefilled_bank_account.account_type == body.get('prefilled_bank_account')['account_type']\n    assert response.prefilled_customer.address_line1 == body.get('prefilled_customer')['address_line1']\n    assert response.prefilled_customer.address_line2 == body.get('prefilled_customer')['address_line2']\n    assert response.prefilled_customer.address_line3 == body.get('prefilled_customer')['address_line3']\n    assert response.prefilled_customer.city == body.get('prefilled_customer')['city']\n    assert response.prefilled_customer.company_name == body.get('prefilled_customer')['company_name']\n    assert response.prefilled_customer.country_code == body.get('prefilled_customer')['country_code']\n    assert response.prefilled_customer.danish_identity_number == body.get('prefilled_customer')['danish_identity_number']\n    assert response.prefilled_customer.email == body.get('prefilled_customer')['email']\n    assert response.prefilled_customer.family_name == body.get('prefilled_customer')['family_name']\n    assert response.prefilled_customer.given_name == body.get('prefilled_customer')['given_name']\n    assert response.prefilled_customer.postal_code == body.get('prefilled_customer')['postal_code']\n    assert response.prefilled_customer.region == body.get('prefilled_customer')['region']\n    assert response.prefilled_customer.swedish_identity_number == body.get('prefilled_customer')['swedish_identity_number']",
    "hash_value": "4cf93957ee009ad5922ea009c9359335"
  }
]