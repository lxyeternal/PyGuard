[
  {
    "metadata": {
      "package_name": "aiofiles-24.1.0",
      "total_matches": 3,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_text.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/aiofiles-24.1.0/aiofiles-24.1.0/tests/threadpool/test_text.py",
    "line_number": "120",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "119\t        while True:\n120\t            char = await file.read(1)\n121\t            if char:",
    "context_snippet": "@pytest.mark.parametrize(\"mode\", [\"r\", \"r+\", \"a+\"])\nasync def test_staggered_read(mode):\n    \"\"\"Read bytes repeatedly.\"\"\"\n    filename = join(dirname(__file__), \"..\", \"resources\", \"test_file1.txt\")\n    async with aioopen(filename, mode=mode) as file:\n        await file.seek(0)  # Needed for the append mode.\n\n        actual = []\n        while True:\n            char = await file.read(1)\n            if char:\n                actual.append(char)\n            else:\n                break\n\n        assert \"\" == (await file.read())\n\n    expected = []\n    with open(filename, mode=\"r\") as f:\n        while True:\n            char = f.read(1)\n            if char:\n                expected.append(char)\n            else:\n                break\n\n    assert actual == expected\n\n    assert file.closed",
    "hash_value": "ad1f0b159bc344bd9e2423002900ec4a"
  },
  {
    "pyfile": "test_os.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/aiofiles-24.1.0/aiofiles-24.1.0/tests/test_os.py",
    "line_number": "146",
    "type_description": "B812:system",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "145\t@pytest.mark.skipif(\n146\t    platform.system() in (\"Windows\"), reason=\"sendfile() doesn't work on Win\"\n147\t)",
    "context_snippet": "@pytest.mark.skipif(\n    platform.system() in (\"Windows\"), reason=\"sendfile() doesn't work on Win\"\n)\nasync def test_sendfile_socket(unused_tcp_port):\n    \"\"\"Test the sendfile functionality, file-to-socket.\"\"\"\n    filename = join(dirname(__file__), \"resources\", \"test_file1.txt\")\n\n    with open(filename, mode=\"rb\") as f:\n        contents = f.read()\n\n    async def serve_file(_, writer):\n        out_fd = writer.transport.get_extra_info(\"socket\").fileno()\n        size = (await aiofiles.os.stat(filename)).st_size\n        in_file = await aiofiles.open(filename)\n        try:\n            in_fd = in_file.fileno()\n            await aiofiles.os.sendfile(out_fd, in_fd, 0, size)\n        finally:\n            await in_file.close()\n            await writer.drain()\n            writer.close()\n\n    server = await asyncio.start_server(serve_file, port=unused_tcp_port)\n\n    reader, writer = await asyncio.open_connection(\"127.0.0.1\", unused_tcp_port)\n    actual_contents = await reader.read()\n    writer.close()\n\n    assert contents == actual_contents\n    server.close()\n\n    await server.wait_closed()",
    "hash_value": "04d49eba509e976dc4cc9eec36dd8add"
  },
  {
    "pyfile": "test_os.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/aiofiles-24.1.0/aiofiles-24.1.0/tests/test_os.py",
    "line_number": "417",
    "type_description": "B837:rmdir",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "416\t    assert other_dir_entity.name == \"other_dir\"\n417\t    await aiofiles.os.rmdir(other_dir)\n418\t    await aiofiles.os.rmdir(some_dir)",
    "context_snippet": "async def test_scandir_dir_with_only_one_dir():\n    \"\"\"Test the scandir call when the dir has one dir.\"\"\"\n    some_dir = join(dirname(__file__), \"resources\", \"some_dir\")\n    other_dir = join(some_dir, \"other_dir\")\n    await aiofiles.os.mkdir(some_dir)\n    await aiofiles.os.mkdir(other_dir)\n    dir_iterator = await aiofiles.os.scandir(some_dir)\n    other_dir_entity = next(dir_iterator)\n    assert other_dir_entity.name == \"other_dir\"\n    await aiofiles.os.rmdir(other_dir)\n    await aiofiles.os.rmdir(some_dir)",
    "hash_value": "2162672ddbfacf2cc203890f3587e797"
  }
]