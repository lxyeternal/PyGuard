[
  {
    "metadata": {
      "package_name": "flexget-3.15.31",
      "total_matches": 5,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "api_emby.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flexget-3.15.31/flexget-3.15.31/flexget/components/emby/api_emby.py",
    "line_number": "1334",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1333\n1334\t                self.source_id = file.get('Id')\n1335",
    "context_snippet": "def __init__(self, **kwargs):\n    if not kwargs:\n        return\n\n    myfield_map = EmbyApiMedia.field_map.copy()\n\n    if 'field_map' in kwargs:\n        myfield_map = EmbyApiBase.merge_field_map(kwargs.get('field_map'), myfield_map)\n\n    EmbyApiBase.update_using_map(self, EmbyApiMedia.field_map, kwargs)\n\n    self.auth = EmbyApi.get_auth(**kwargs)\n\n    if self.created_date:\n        self.created_date = EmbyApi.strtotime(self.created_date)\n\n    if self.aired_date:\n        self.aired_date = EmbyApi.strtotime(self.aired_date)\n\n    if self.mtype:\n        self.mtype = self.mtype.lower()\n\n    if 'MediaSources' in kwargs:\n        self.media_sources_raw = kwargs.get('MediaSources')\n        for file in self.media_sources_raw:\n            if 'Type' not in file or file.get('Type') != 'Default':\n                continue\n\n            if 'MediaStreams' not in file:\n                continue\n\n            self.source_id = file.get('Id')\n\n            for stream in file.get('MediaStreams'):\n                if stream.get('Type') == 'Video':\n                    self.quality = stream.get('DisplayTitle')\n\n                if stream.get('Type') == 'Subtitle' and stream.get('Language'):\n                    if not self.subtitles:\n                        self.subtitles = []\n\n                    self.subtitles.append(stream['Language'])\n\n                if stream.get('Type') == 'Audio' and 'Language' in stream:\n                    if not self.audio:\n                        self.audio = []\n\n                    self.audio.append(stream['Language'])\n\n    self.library = self.get_libary()",
    "hash_value": "c0b4f21c22a90eeee1e4e73021842c64"
  },
  {
    "pyfile": "newznab.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flexget-3.15.31/flexget-3.15.31/flexget/components/sites/sites/newznab.py",
    "line_number": "129",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "128\t        elif arg_entry.get('tmdb_id'):\n129\t            params['tmdbid'] = arg_entry.get('tmdb_id')\n130\t        elif arg_entry.get('imdb_id'):",
    "context_snippet": "    def do_search_tvsearch(self, arg_entry, task, url, params):\n        logger.info('Searching for {}', arg_entry['title'])\n        # normally this should be used with next_series_episodes who has provided season and episodenumber\n        if (\n            'series_name' not in arg_entry\n            or 'series_season' not in arg_entry\n            or 'series_episode' not in arg_entry\n        ):\n            return []\n        if arg_entry.get('tvdb_id'):\n            params['tvdbid'] = arg_entry.get('tvdb_id')\n        elif arg_entry.get('trakt_id'):\n            params['traktid'] = arg_entry.get('trakt_id')\n        elif arg_entry.get('tvmaze_series_id'):\n            params['tvmazeid'] = arg_entry.get('tvmaze_series_id')\n        elif arg_entry.get('tmdb_id'):\n            params['tmdbid'] = arg_entry.get('tmdb_id')\n        elif arg_entry.get('imdb_id'):\n            params['imdbid'] = arg_entry.get('imdb_id')\n        elif arg_entry.get('tvrage_id'):\n            params['rid'] = arg_entry.get('tvrage_id')\n        else:\n            params['q'] = arg_entry['series_name']\n        params['ep'] = arg_entry['series_episode']\n        params['season'] = arg_entry['series_season']\n        return self.fill_entries_for_url(url, params, task)",
    "hash_value": "4ce75b39c61ee5f3d657478587d06ba0"
  },
  {
    "pyfile": "api_emby.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flexget-3.15.31/flexget-3.15.31/flexget/components/emby/api_emby.py",
    "line_number": "2046",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "2045\t            seasons_filter = []\n2046\t            seasons_filter = list(filter(lambda s: s.get('IndexNumber') == target_season, seasons))\n2047\t            seasons = seasons_filter",
    "context_snippet": "    @staticmethod\n    def search(**kwargs) -> 'EmbyApiSeason':\n        args = {}\n\n        auth = EmbyApi.get_auth(**kwargs)\n        kwargs['auth'] = auth\n\n        parameters = {}\n        field_map = EmbyApiBase.merge_field_map(\n            EmbyApiSeason.field_map_up,\n            EmbyApiSerie.field_map_up,\n            EmbyApiMedia.field_map,\n            allow_new=True,\n        )\n\n        EmbyApi.update_using_map(parameters, field_map, kwargs, allow_new=True)\n\n        # We need to have information regarding the series\n        season_serie = None\n        if 'api_serie' in kwargs:\n            season_serie = kwargs.get('api_serie')\n\n        if not season_serie:\n            season_serie = EmbyApiSerie.search(**kwargs)\n\n        if not season_serie:\n            logger.warning('Not possible to determine season, serie not found')\n            return None\n\n        if 'season_id' in parameters:\n            args['Ids'] = parameters.get('season_id')\n        else:\n            args['ParentId'] = season_serie.serie_id\n\n        args['IncludeItemTypes'] = 'Season'\n\n        EmbyApi.set_common_search_arg(args)\n\n        logger.debug('Search season with: {}', args)\n        seasons = EmbyApi.resquest_emby(EMBY_ENDPOINT_SEARCH, auth, 'GET', **args)\n        if not seasons or 'Items' not in seasons or not seasons['Items']:\n            logger.warning('No season found')\n            return None\n\n        seasons = seasons['Items']\n\n        target_season = parameters.get('season')\n        if not target_season:\n            target_season = EmbyApiSeason.parse_string(\n                parameters.get('search_string', parameters.get('base_name'))\n            )\n\n        if target_season:\n            seasons_filter = []\n            seasons_filter = list(filter(lambda s: s.get('IndexNumber') == target_season, seasons))\n            seasons = seasons_filter\n\n        if len(seasons) == 1:\n            season = seasons[0]\n        elif len(seasons) > 1:\n            logger.warning(\n                'More than one season found for {} {}', season_serie.fullname, target_season\n            )\n            return None\n        else:\n            logger.warning('No season found')\n            return None\n\n        season_api = EmbyApiSeason(auth=auth, api_serie=season_serie, **season)\n        if season_api:\n            logger.debug(\"Found season '{}' in emby server\", season_api.fullname)\n            return season_api\n        return None",
    "hash_value": "252a417468dac4feb2a44f861a425094"
  },
  {
    "pyfile": "db.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flexget-3.15.31/flexget-3.15.31/flexget/components/trakt/db.py",
    "line_number": "350",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "349\t    def update(self, actor, session):\n350\t        if self.id and self.id != actor.get('ids').get('trakt'):\n351\t            raise ValueError('Tried to update db actors with different actor data')",
    "context_snippet": "class TraktActor(Base):\n    __tablename__ = 'trakt_actors'\n\n    id = Column(Integer, primary_key=True, nullable=False)\n    name = Column(Unicode)\n    slug = Column(Unicode)\n    tmdb = Column(Integer)\n    imdb = Column(Unicode)\n    biography = Column(Unicode)\n    birthday = Column(Date)\n    death = Column(Date)\n    homepage = Column(Unicode)\n\n    def __init__(self, actor, session):\n        super().__init__()\n        self.update(actor, session)\n\n    def update(self, actor, session):\n        if self.id and self.id != actor.get('ids').get('trakt'):\n            raise ValueError('Tried to update db actors with different actor data')\n        if not self.id:\n            self.id = actor.get('ids').get('trakt')\n        self.name = actor.get('name')\n        ids = actor.get('ids')\n        self.imdb = ids.get('imdb')\n        self.slug = ids.get('slug')\n        self.tmdb = ids.get('tmdb')\n        self.biography = actor.get('biography')\n        if actor.get('birthday'):\n            self.birthday = dateutil_parse(actor.get('birthday'))\n        if actor.get('death'):\n            self.death = dateutil_parse(actor.get('death'))\n        self.homepage = actor.get('homepage')\n\n    def to_dict(self):\n        return {'name': self.name, 'trakt_id': self.id, 'imdb_id': self.imdb, 'tmdb_id': self.tmdb}",
    "hash_value": "7ee98f202d1da40bdc032cc942de08bc"
  },
  {
    "pyfile": "ombi_list.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flexget-3.15.31/flexget-3.15.31/flexget/components/managed_lists/lists/ombi_list.py",
    "line_number": "894",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "893\t                ombi_id=parent_request.get('externalProviderId'),\n894\t                ombi_status=parent_request.get('status'),\n895\t                ombi_request_id=parent_request.get('id'),",
    "context_snippet": "def generate_tv_entry(self, parent_request, child_request=None, season=None, episode=None):\n    if self.config.get('type') == 'shows':\n        log.debug('Found: %s', parent_request.get('title'))\n        if not parent_request.get('imdbId'):\n            simdburl = ''\n        else:\n            simdburl = 'http://www.imdb.com/title/' + parent_request.get('imdbId') + '/'\n        return Entry(\n            title=self.generate_title(parent_request),\n            url=simdburl,\n            series_name=self.generate_title(parent_request),\n            tvdb_id=parent_request.get('tvDbId'),\n            imdb_id=parent_request.get('imdbId'),\n            tmdb_id=parent_request.get('externalProviderId'),\n            ombi_id=parent_request.get('externalProviderId'),\n            ombi_status=parent_request.get('status'),\n            ombi_request_id=parent_request.get('id'),\n        )\n    if self.config.get('type') == 'seasons':\n        log.debug('Found: %s S%s', parent_request.get('title'), season.get('seasonNumber'))\n        if not parent_request.get('imdbId'):\n            simdburl = ''\n        else:\n            simdburl = 'http://www.imdb.com/title/' + parent_request.get('imdbId') + '/'\n        return Entry(\n            title=self.generate_title(parent_request, season),\n            url=simdburl,\n            series_name=self.generate_title(parent_request),\n            series_season=season.get('seasonNumber'),\n            series_id=self.generate_series_id(season),\n            tvdb_id=parent_request.get('tvDbId'),\n            imdb_id=parent_request.get('imdbId'),\n            tmdb_id=parent_request.get('externalProviderId'),\n            tmdb_season=season.get('seasonNumber'),\n            ombi_id=parent_request.get('externalProviderId'),\n            ombi_childrequest_id=child_request.get('id'),\n            ombi_season_id=season.get('id'),\n            ombi_season=season.get('seasonNumber'),\n            ombi_status=parent_request.get('status'),\n            ombi_request_id=parent_request.get('id'),\n        )\n    if self.config.get('type') == 'episodes':\n        log.debug(\n            'Found: %s S%sE%s',\n            parent_request.get('title'),\n            season.get('seasonNumber'),\n            episode.get('episodeNumber'),\n        )\n        if not parent_request.get('imdbId'):\n            simdburl = ''\n        else:\n            simdburl = 'http://www.imdb.com/title/' + parent_request.get('imdbId') + '/'\n        return Entry(\n            title=self.generate_title(parent_request, season, episode),\n            url=simdburl,\n            series_name=self.generate_title(parent_request),\n            series_season=season.get('seasonNumber'),\n            series_episode=episode.get('episodeNumber'),\n            series_id=self.generate_series_id(season, episode),\n            tvdb_id=parent_request.get('tvDbId'),\n            imdb_id=parent_request.get('imdbId'),\n            tmdb_id=parent_request.get('externalProviderId'),\n            tmdb_season=season.get('seasonNumber'),\n            tmdb_episode=episode.get('episodeNumber'),\n            ombi_id=parent_request.get('externalProviderId'),\n            ombi_request_id=parent_request.get('id'),\n            ombi_childrequest_id=child_request.get('id'),\n            ombi_season_id=season.get('id'),\n            ombi_season=season.get('seasonNumber'),\n            ombi_episode_id=episode.get('id'),\n            ombi_episode=episode.get('episodeNumber'),\n            ombi_approved=episode.get('approved'),\n            ombi_available=episode.get('available'),\n            ombi_requested=episode.get('requested'),\n        )\n    raise plugin.PluginError('Error: Unknown list type {}.'.format(self.config.get('type')))",
    "hash_value": "dcb607f9c04d307e1d0b2bc13cb19918"
  }
]