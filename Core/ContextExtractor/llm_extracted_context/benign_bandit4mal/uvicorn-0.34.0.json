[
  {
    "metadata": {
      "package_name": "uvicorn-0.34.0",
      "total_matches": 3,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_websocket.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/uvicorn-0.34.0/uvicorn-0.34.0/tests/protocols/test_websocket.py",
    "line_number": "454",
    "type_description": "B805:send",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "453\t    async def app(scope: Scope, receive: ASGIReceiveCallable, send: ASGISendCallable):\n454\t        await send({\"type\": \"websocket.accept\"})\n455\t        return 123",
    "context_snippet": "async def test_asgi_return_value(ws_protocol_cls: WSProtocol, http_protocol_cls: HTTPProtocol, unused_tcp_port: int):\n    \"\"\"\n    The ASGI callable should return 'None'. If it doesn't, make sure that\n    the connection is closed with an error condition.\n    \"\"\"\n\n    async def app(scope: Scope, receive: ASGIReceiveCallable, send: ASGISendCallable):\n        await send({\"type\": \"websocket.accept\"})\n        return 123\n\n    config = Config(app=app, ws=ws_protocol_cls, http=http_protocol_cls, lifespan=\"off\", port=unused_tcp_port)\n    async with run_server(config):\n        async with websockets.client.connect(f\"ws://127.0.0.1:{unused_tcp_port}\") as websocket:\n            with pytest.raises(websockets.exceptions.ConnectionClosed):\n                _ = await websocket.recv()\n        assert websocket.close_code == 1006",
    "hash_value": "0c76ae48ceef4b95c99e0a399b73d1f3"
  },
  {
    "pyfile": "test_websocket.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/uvicorn-0.34.0/uvicorn-0.34.0/tests/protocols/test_websocket.py",
    "line_number": "1164",
    "type_description": "B805:send",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1163\t        assert message[\"type\"] == \"lifespan.shutdown\"\n1164\t        await send({\"type\": \"lifespan.shutdown.complete\"})\n1165",
    "context_snippet": "async def lifespan_app(scope: Scope, receive: ASGIReceiveCallable, send: ASGISendCallable):\n    message = await receive()\n    assert message[\"type\"] == \"lifespan.startup\" and \"state\" in scope\n    scope[\"state\"][\"a\"] = 123\n    scope[\"state\"][\"b\"] = [1]\n    await send({\"type\": \"lifespan.startup.complete\"})\n    message = await receive()\n    assert message[\"type\"] == \"lifespan.shutdown\"\n    await send({\"type\": \"lifespan.shutdown.complete\"})",
    "hash_value": "1da784135747c45d66bb2d7851473c7b"
  },
  {
    "pyfile": "h11_impl.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/uvicorn-0.34.0/uvicorn-0.34.0/uvicorn/protocols/http/h11_impl.py",
    "line_number": "298",
    "type_description": "B831:send",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "297\t        event = h11.Response(status_code=400, headers=headers, reason=reason)\n298\t        output = self.conn.send(event)\n299\t        self.transport.write(output)",
    "context_snippet": "def send_400_response(self, msg: str) -> None:\n    reason = STATUS_PHRASES[400]\n    headers: list[tuple[bytes, bytes]] = [\n        (b\"content-type\", b\"text/plain; charset=utf-8\"),\n        (b\"connection\", b\"close\"),\n    ]\n    event = h11.Response(status_code=400, headers=headers, reason=reason)\n    output = self.conn.send(event)\n    self.transport.write(output)\n\n    output = self.conn.send(event=h11.Data(data=msg.encode(\"ascii\")))\n    self.transport.write(output)\n\n    output = self.conn.send(event=h11.EndOfMessage())\n    self.transport.write(output)\n\n    self.transport.close()",
    "hash_value": "30cf3dfbf32bf699c8d4ef1163ccb449"
  }
]