[
  {
    "metadata": {
      "package_name": "kaldiio-2.18.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "utils.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/kaldiio-2.18.1/kaldiio-2.18.1/kaldiio/utils.py",
    "line_number": "182",
    "type_description": "B813:popen",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "181\t        cmd = name.strip()[1:].encode(default_encoding)\n182\t        return my_popen(cmd, mode)\n183\t    # If read mode",
    "context_snippet": "def open_like_kaldi(name, mode=\"r\"):\n    \"\"\"Open a file like kaldi io\n\n    Args:\n        name (str or file):\n        mode (str):\n    \"\"\"\n    # If file descriptor\n    if not isinstance(name, string_types):\n        if PY3 and \"b\" in mode and isinstance(name, TextIOBase):\n            return name.buffer\n        else:\n            return name\n\n    # If writting to stdout\n    if name.strip().endswith(\"|\"):\n        cmd = name.strip()[:-1].encode(default_encoding)\n        return my_popen(cmd, mode)\n    # If reading from stdin\n    elif name.strip().startswith(\"|\"):\n        cmd = name.strip()[1:].encode(default_encoding)\n        return my_popen(cmd, mode)\n    # If read mode\n    elif name == \"-\" and \"r\" in mode:\n        if PY3:\n            if mode == \"rb\":\n                return _stdstream_wrap(sys.stdin.buffer)\n            else:\n                return _stdstream_wrap(\n                    io.TextIOWrapper(sys.stdin.buffer, encoding=default_encoding)\n                )\n        else:\n            return _stdstream_wrap(sys.stdin)\n    # If write mode\n    elif name == \"-\" and (\"w\" in mode or \"a\" in mode):\n        if PY3:\n            if mode == \"wb\" or mode == \"ab\":\n                return _stdstream_wrap(sys.stdout.buffer)\n            else:\n                return _stdstream_wrap(\n                    io.TextIOWrapper(sys.stdout.buffer, encoding=default_encoding)\n                )\n        else:\n            return _stdstream_wrap(sys.stdout)\n    else:\n        encoding = None if \"b\" in mode else default_encoding\n        return io.open(name, mode, encoding=encoding)\n",
    "hash_value": "6de5ffa8da5089eb3455e152d0ded45d"
  }
]