[
  {
    "metadata": {
      "package_name": "pipenv-2024.4.1",
      "total_matches": 3,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "project.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pipenv-2024.4.1/pipenv-2024.4.1/pipenv/project.py",
    "line_number": "988",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "987\t            sources = [self.default_source]\n988\t            if os.environ.get(\"PIPENV_PYPI_MIRROR\"):\n989\t                sources[0][\"url\"] = os.environ[\"PIPENV_PYPI_MIRROR\"]",
    "context_snippet": "def pipfile_sources(self, expand_vars=True):\n    if self.pipfile_is_empty or \"source\" not in self.parsed_pipfile:\n        sources = [self.default_source]\n        if os.environ.get(\"PIPENV_PYPI_MIRROR\"):\n            sources[0][\"url\"] = os.environ[\"PIPENV_PYPI_MIRROR\"]\n        return sources\n    # We need to make copies of the source info so we don't\n    # accidentally modify the cache. See #2100 where values are\n    # written after the os.path.expandvars() call.\n    sources = [\n        {k: safe_expandvars(v) if expand_vars else v for k, v in source.items()}\n        for source in self.parsed_pipfile[\"source\"]\n    ]\n    for source in sources:\n        if os.environ.get(\"PIPENV_PYPI_MIRROR\") and is_pypi_url(source.get(\"url\")):\n            source[\"url\"] = os.environ[\"PIPENV_PYPI_MIRROR\"]\n    return sources",
    "hash_value": "9be197f3293647b7639d610a46e7af4c"
  },
  {
    "pyfile": "cache.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pipenv-2024.4.1/pipenv-2024.4.1/pipenv/patched/pip/_internal/network/cache.py",
    "line_number": "78",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "77\t            with adjacent_tmp_file(path) as f:\n78\t                f.write(data)\n79",
    "context_snippet": "def _write(self, path: str, data: bytes) -> None:\n    with suppressed_cache_errors():\n        ensure_dir(os.path.dirname(path))\n\n        with adjacent_tmp_file(path) as f:\n            f.write(data)\n\n        replace(f.name, path)",
    "hash_value": "7a75cd0b8b37fc144e49f85af17a3657"
  },
  {
    "pyfile": "markers.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pipenv-2024.4.1/pipenv-2024.4.1/pipenv/patched/pip/_vendor/packaging/markers.py",
    "line_number": "251",
    "type_description": "B817:system",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "250\t        \"platform_release\": platform.release(),\n251\t        \"platform_system\": platform.system(),\n252\t        \"platform_version\": platform.version(),",
    "context_snippet": "def default_environment() -> Environment:\n    iver = format_full_version(sys.implementation.version)\n    implementation_name = sys.implementation.name\n    return {\n        \"implementation_name\": implementation_name,\n        \"implementation_version\": iver,\n        \"os_name\": os.name,\n        \"platform_machine\": platform.machine(),\n        \"platform_release\": platform.release(),\n        \"platform_system\": platform.system(),\n        \"platform_version\": platform.version(),\n        \"python_full_version\": platform.python_version(),\n        \"platform_python_implementation\": platform.python_implementation(),\n        \"python_version\": \".\".join(platform.python_version_tuple()[:2]),\n        \"sys_platform\": sys.platform,\n    }",
    "hash_value": "119df6c210793341ccde58742ae018da"
  }
]