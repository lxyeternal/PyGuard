[
  {
    "metadata": {
      "package_name": "keras_nightly-3.9.0.dev2025032003",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "saving_lib.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/keras_nightly-3.9.0.dev2025032003/keras_nightly-3.9.0.dev2025032003/keras/src/saving/saving_lib.py",
    "line_number": "168",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "167\t    with open(file_utils.join(dirpath, _METADATA_FILENAME), \"w\") as f:\n168\t        f.write(metadata_json)\n169\t    with open(file_utils.join(dirpath, _CONFIG_FILENAME), \"w\") as f:",
    "context_snippet": "def _save_model_to_dir(model, dirpath, weights_format):\n    if not file_utils.exists(dirpath):\n        file_utils.makedirs(dirpath)\n    config_json, metadata_json = _serialize_model_as_json(model)\n    with open(file_utils.join(dirpath, _METADATA_FILENAME), \"w\") as f:\n        f.write(metadata_json)\n    with open(file_utils.join(dirpath, _CONFIG_FILENAME), \"w\") as f:\n        f.write(config_json)\n    weights_filepath = file_utils.join(dirpath, _VARS_FNAME_H5)\n    assert_dirpath = file_utils.join(dirpath, _ASSETS_DIRNAME)\n    try:\n        if weights_format == \"h5\":\n            weights_store = H5IOStore(weights_filepath, mode=\"w\")\n        elif weights_format == \"npz\":\n            weights_store = NpzIOStore(weights_filepath, mode=\"w\")\n        else:\n            raise ValueError(\n                \"Unknown `weights_format` argument. \"\n                \"Expected 'h5' or 'npz'. \"\n                f\"Received: weights_format={weights_format}\"\n            )\n        asset_store = DiskIOStore(assert_dirpath, mode=\"w\")\n        _save_state(\n            model,\n            weights_store=weights_store,\n            assets_store=asset_store,\n            inner_path=\"\",\n            visited_saveables=set(),\n        )\n    finally:\n        weights_store.close()\n        asset_store.close()",
    "hash_value": "1b4eb9d1858890e236d49c15d8970362"
  }
]