[
  {
    "metadata": {
      "package_name": "urllib3-2.4.0",
      "total_matches": 5,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_response.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/urllib3-2.4.0/urllib3-2.4.0/test/test_response.py",
    "line_number": "1197",
    "type_description": "B830:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1196\t        resp = HTTPResponse(fp, headers=headers, preload_content=False)\n1197\t        resp.read()\n1198\t        assert resp.length_remaining == 0",
    "context_snippet": "def test_length_after_read(self) -> None:\n    headers = {\"content-length\": \"5\"}\n\n    # Test no defined length\n    fp = BytesIO(b\"12345\")\n    resp = HTTPResponse(fp, preload_content=False)\n    resp.read()\n    assert resp.length_remaining is None\n\n    # Test our update from content-length\n    fp = BytesIO(b\"12345\")\n    resp = HTTPResponse(fp, headers=headers, preload_content=False)\n    resp.read()\n    assert resp.length_remaining == 0\n\n    # Test partial read\n    fp = BytesIO(b\"12345\")\n    resp = HTTPResponse(fp, headers=headers, preload_content=False)\n    data = resp.stream(2)\n    next(data)\n    assert resp.length_remaining == 3",
    "hash_value": "137bb9dc8e9402697625afcdf010768a"
  },
  {
    "pyfile": "conftest.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/urllib3-2.4.0/urllib3-2.4.0/test/conftest.py",
    "line_number": "216",
    "type_description": "B830:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "215\n216\t    with run_server_and_proxy_in_thread(\n217\t        \"https\", \"127.0.0.1\", tmpdir, ca, proxy_cert, server_cert\n218\t    ) as cfg:",
    "context_snippet": "@pytest.fixture\ndef ipv4_san_proxy_with_server(\n    tmp_path_factory: pytest.TempPathFactory,\n) -> typing.Generator[tuple[ServerConfig, ServerConfig]]:\n    tmpdir = tmp_path_factory.mktemp(\"certs\")\n    ca = trustme.CA()\n    # IP address in Subject Alternative Name\n    proxy_cert = ca.issue_cert(\"127.0.0.1\")\n\n    server_cert = ca.issue_cert(\"localhost\")\n\n    with run_server_and_proxy_in_thread(\n        \"https\", \"127.0.0.1\", tmpdir, ca, proxy_cert, server_cert\n    ) as cfg:\n        yield cfg",
    "hash_value": "4de76b5253fa443fec1e1884249271f9"
  },
  {
    "pyfile": "test_socketlevel.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/urllib3-2.4.0/urllib3-2.4.0/test/with_dummyserver/test_socketlevel.py",
    "line_number": "711",
    "type_description": "B807:close",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "710\n711\t            sock.close()  # Close the socket.\n712",
    "context_snippet": "def socket_handler(listener: socket.socket) -> None:\n    sock = listener.accept()[0]\n    # First request.\n    # Pause before responding so the first request times out.\n    buf = b\"\"\n    while not buf.endswith(b\"\\r\\n\\r\\n\"):\n        buf += sock.recv(65536)\n\n    # send unknown http protocol\n    body = \"bad http 0.5 response\"\n    sock.send(\n        (\n            \"HTTP/0.5 200 OK\\r\\n\"\n            \"Content-Type: text/plain\\r\\n\"\n            \"Content-Length: %d\\r\\n\"\n            \"\\r\\n\"\n            \"%s\" % (len(body), body)\n        ).encode(\"utf-8\")\n    )\n    sock.close()\n\n    # Second request.\n    sock = listener.accept()[0]\n    buf = b\"\"\n    while not buf.endswith(b\"\\r\\n\\r\\n\"):\n        buf += sock.recv(65536)\n\n    # Now respond immediately.\n    sock.send(\n        (\n            \"HTTP/1.1 200 OK\\r\\n\"\n            \"Content-Type: text/plain\\r\\n\"\n            \"Content-Length: %d\\r\\n\"\n            \"\\r\\n\"\n            \"foo\" % (len(\"foo\"))\n        ).encode(\"utf-8\")\n    )\n\n    sock.close()  # Close the socket.",
    "hash_value": "1c37096a5f18b892309e287991803e01"
  },
  {
    "pyfile": "test_emscripten.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/urllib3-2.4.0/urllib3-2.4.0/test/contrib/emscripten/test_emscripten.py",
    "line_number": "1015",
    "type_description": "B825:request",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1014\t        with pytest.raises(TimeoutError):\n1015\t            conn.request(\"GET\", \"/slow\")\n1016\t            conn.getresponse()",
    "context_snippet": "@pytest.mark.with_jspi\ndef test_timeout_jspi(\n    selenium_coverage: typing.Any,\n    testserver_http: PyodideServerInfo,\n    run_from_server: ServerRunnerInfo,\n) -> None:\n    @run_in_pyodide\n    def pyodide_test(selenium, host, port):  # type: ignore[no-untyped-def]\n        import pytest\n\n        import urllib3.contrib.emscripten.fetch\n        from urllib3.connection import HTTPConnection\n        from urllib3.exceptions import TimeoutError\n\n        conn = HTTPConnection(host, port, timeout=0.1)\n        assert urllib3.contrib.emscripten.fetch.has_jspi() is True\n        with pytest.raises(TimeoutError):\n            conn.request(\"GET\", \"/slow\")\n            conn.getresponse()\n\n    pyodide_test(\n        selenium_coverage, testserver_http.http_host, testserver_http.http_port\n    )",
    "hash_value": "18aa5bc4236d70adaacf0acbdca4ad81"
  },
  {
    "pyfile": "test_emscripten.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/urllib3-2.4.0/urllib3-2.4.0/test/contrib/emscripten/test_emscripten.py",
    "line_number": "206",
    "type_description": "B826:getresponse",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "205\t        conn.request(\"GET\", f\"http://{host}:{port}/status?status=404 NOT FOUND\")\n206\t        response = conn.getresponse()\n207\t        assert isinstance(response, BaseHTTPResponse)",
    "context_snippet": "def test_404(\n    selenium_coverage: typing.Any, testserver_http: PyodideServerInfo, has_jspi: bool\n) -> None:\n    @run_in_pyodide  # type: ignore[misc]\n    def pyodide_test(selenium_coverage, host: str, port: int) -> None:  # type: ignore[no-untyped-def]\n        from urllib3.connection import HTTPConnection\n        from urllib3.response import BaseHTTPResponse\n\n        conn = HTTPConnection(host, port)\n        conn.request(\"GET\", f\"http://{host}:{port}/status?status=404 NOT FOUND\")\n        response = conn.getresponse()\n        assert isinstance(response, BaseHTTPResponse)\n        assert response.status == 404\n\n    pyodide_test(\n        selenium_coverage, testserver_http.http_host, testserver_http.http_port\n    )",
    "hash_value": "7f4563be33809ede138e47e32881d326"
  }
]