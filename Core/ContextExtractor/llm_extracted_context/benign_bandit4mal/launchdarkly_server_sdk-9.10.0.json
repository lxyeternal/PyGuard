[
  {
    "metadata": {
      "package_name": "launchdarkly_server_sdk-9.10.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "migrator.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/launchdarkly_server_sdk-9.10.0/launchdarkly_server_sdk-9.10.0/ldclient/migrations/migrator.py",
    "line_number": "97",
    "type_description": "B840:executor",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "96\n97\t        old = Executor(Origin.OLD, self.__write_config.old, tracker, self.__measure_latency, self.__measure_errors, payload)\n98\t        new = Executor(Origin.NEW, self.__write_config.new, tracker, self.__measure_latency, self.__measure_errors, payload)",
    "context_snippet": "def write(self, key: str, context: Context, default_stage: Stage, payload: Optional[Any] = None) -> WriteResult:\n    stage, tracker = self.__client.migration_variation(key, context, default_stage)\n    tracker.operation(Operation.WRITE)\n\n    old = Executor(Origin.OLD, self.__write_config.old, tracker, self.__measure_latency, self.__measure_errors, payload)\n    new = Executor(Origin.NEW, self.__write_config.new, tracker, self.__measure_latency, self.__measure_errors, payload)\n\n    if stage == Stage.OFF:\n        result = old.run()\n        write_result = WriteResult(result)\n    elif stage == Stage.DUALWRITE:\n        authoritative_result, nonauthoritative_result = self.__write_both(old, new, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.SHADOW:\n        authoritative_result, nonauthoritative_result = self.__write_both(old, new, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.LIVE:\n        authoritative_result, nonauthoritative_result = self.__write_both(new, old, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.RAMPDOWN:\n        authoritative_result, nonauthoritative_result = self.__write_both(new, old, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    else:\n        result = new.run()\n        write_result = WriteResult(result)\n\n    self.__client.track_migration_op(tracker)\n\n    return write_result",
    "hash_value": "976e4e216724ad02c7bb1e646dbc7b7c"
  }
]