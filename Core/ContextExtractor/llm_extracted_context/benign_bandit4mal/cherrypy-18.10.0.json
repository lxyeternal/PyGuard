[
  {
    "metadata": {
      "package_name": "cherrypy-18.10.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "plugins.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cherrypy-18.10.0/cherrypy-18.10.0/cherrypy/process/plugins.py",
    "line_number": "296",
    "type_description": "B811:getuid",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "295\t            if pwd:\n296\t                name = pwd.getpwuid(os.getuid())[0]\n297\t            if grp:",
    "context_snippet": "def start(self):\n    # uid/gid\n    def current_ids():\n        \"\"\"Return the current (uid, gid) if available.\"\"\"\n        name, group = None, None\n        if pwd:\n            name = pwd.getpwuid(os.getuid())[0]\n        if grp:\n            group = grp.getgrgid(os.getgid())[0]\n        return name, group\n\n    if self.finalized:\n        if not (self.uid is None and self.gid is None):\n            self.bus.log('Already running as uid: %r gid: %r' %\n                         current_ids())\n    else:\n        if self.uid is None and self.gid is None:\n            if pwd or grp:\n                self.bus.log('uid/gid not set', level=30)\n        else:\n            self.bus.log('Started as uid: %r gid: %r' % current_ids())\n            if self.gid is not None:\n                os.setgid(self.gid)\n                os.setgroups([])\n            if self.uid is not None:\n                os.setuid(self.uid)\n            self.bus.log('Running as uid: %r gid: %r' % current_ids())\n\n    # umask\n    if self.finalized:\n        if self.umask is not None:\n            self.bus.log('umask already set to: %03o' % self.umask)\n    else:\n        if self.umask is None:\n            self.bus.log('umask not set', level=30)\n        else:\n            old_umask = os.umask(self.umask)\n            self.bus.log('umask old: %03o, new: %03o' %\n                         (old_umask, self.umask))\n\n    self.finalized = True\n# This is slightly higher than the priority for server.start\n# in order to facilitate the most common use: starting on a low\n# port (which requires root) and then dropping to another user.\nstart.priority = 77",
    "hash_value": "b94ab560b09cdce62a8c9b9816b167a1"
  }
]