[
  {
    "metadata": {
      "package_name": "pyobjc_core-11.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_archiving_secure_interop.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyobjc_core-11.0/pyobjc_core-11.0/PyObjCTest/test_archiving_secure_interop.py",
    "line_number": "84",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "83\t            with tempfile.NamedTemporaryFile() as fp:\n84\t                fp.write(data.bytes())\n85\t                fp.flush()",
    "context_snippet": "def test_interop_date(self):\n    testval = datetime.date.today()\n\n    v = NSArray.arrayWithObject_(testval)\n    (\n        data,\n        error,\n    ) = NSKeyedArchiver.archivedDataWithRootObject_requiringSecureCoding_error_(\n        v, True, None\n    )\n\n    if data is None:\n        self.fail(f\"Cannot create archive: {error}\")\n\n    with tempfile.NamedTemporaryFile() as fp:\n        fp.write(data.bytes())\n        fp.flush()\n\n        converted = subprocess.check_output([self.progpath, fp.name])\n\n    converted = loads(converted)\n    value = converted[0]\n    self.assertIsInstance(value, datetime.datetime)\n    # XXX: Checking the value itself is problematic because\n    #      the datetime parser in plistlib is not timezone aware.\n    # self.assertEqual(value.year, testval.year)\n    # self.assertEqual(value.month, testval.month)\n    # self.assertEqual(value.day, testval.day)",
    "hash_value": "1c5c1f089b0a3967b4c545f3333b6e73"
  }
]