[
  {
    "metadata": {
      "package_name": "vosk-0.3.45-py3-none-win_amd64",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "__init__.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/vosk-0.3.45-py3-none-win_amd64/vosk/__init__.py",
    "line_number": "115",
    "type_description": "B819:urlretrieve",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "114\t            reporthook = self.download_progress_hook(t)\n115\t            urlretrieve(MODEL_PRE_URL + str(model_name.name) + \".zip\",\n116\t                    str(model_name) + \".zip\", reporthook=reporthook, data=None)\n117\t            t.total = t.n",
    "context_snippet": "from urllib.request import urlretrieve\nfrom zipfile import ZipFile\nfrom tqdm import tqdm\nMODEL_PRE_URL = \"https://alphacephei.com/vosk/models/\"\nclass Model:\n    def download_model(self, model_name):\n        if not (model_name.parent).exists():\n            (model_name.parent).mkdir(parents=True)\n        with tqdm(unit=\"B\", unit_scale=True, unit_divisor=1024, miniters=1,\n                desc=(MODEL_PRE_URL + str(model_name.name) + \".zip\").rsplit(\"/\",\n                    maxsplit=1)[-1]) as t:\n            reporthook = self.download_progress_hook(t)\n            urlretrieve(MODEL_PRE_URL + str(model_name.name) + \".zip\",\n                    str(model_name) + \".zip\", reporthook=reporthook, data=None)\n            t.total = t.n\n            with ZipFile(str(model_name) + \".zip\", \"r\") as model_ref:\n                model_ref.extractall(model_name.parent)\n            Path(str(model_name) + \".zip\").unlink()\n    def download_progress_hook(self, t):\n        last_b = [0]\n        def update_to(b=1, bsize=1, tsize=None):\n            if tsize not in (None, -1):\n                t.total = tsize\n            displayed = t.update((b - last_b[0]) * bsize)\n            last_b[0] = b\n            return displayed\n        return update_to",
    "hash_value": "db53f06991cb0f5c6c12fe846cb764de"
  }
]