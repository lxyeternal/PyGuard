[
  {
    "metadata": {
      "package_name": "tidevice-0.12.10",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "_hexdump.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tidevice-0.12.10/tidevice-0.12.10/tidevice/_hexdump.py",
    "line_number": "455",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "454\t        normalize_py()\n455\t        sys.stdout.write(restore(instream.read()))\n456",
    "context_snippet": "def main():\n  from optparse import OptionParser\n  parser = OptionParser(usage='''\n  %prog [binfile|-]\n  %prog -r hexfile\n  %prog --test [logfile]''', version=__version__)\n  parser.add_option('-r', '--restore', action='store_true',\n                                       help='restore binary from hex dump')\n  parser.add_option('--test', action='store_true', help='run hexdump sanity checks')\n\n  options, args = parser.parse_args()\n\n  if options.test:\n    if args:\n      runtest(logfile=args[0])\n    else:\n      runtest()\n  elif not args or len(args) > 1:\n    parser.print_help()\n    sys.exit(-1)\n  else:\n    ## dump file\n    if not options.restore:\n      # [x] memory effective dump\n      if args[0] == '-':\n        if not PY3K:\n          hexdump(sys.stdin)\n        else:\n          hexdump(sys.stdin.buffer)\n      else:\n        hexdump(open(args[0], 'rb'))\n\n    ## restore file\n    else:\n      # prepare input stream\n      if args[0] == '-':\n        instream = sys.stdin\n      else:\n        if PY3K:\n          instream = open(args[0])\n        else:\n          instream = open(args[0], 'rb')\n\n      # output stream\n      # [ ] memory efficient restore\n      if PY3K:\n        sys.stdout.buffer.write(restore(instream.read()))\n      else:\n        # Windows - binary mode for sys.stdout to prevent data corruption\n        normalize_py()\n        sys.stdout.write(restore(instream.read()))",
    "hash_value": "af2d35ca778985512747bf8686973f61"
  },
  {
    "pyfile": "plistlib2.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tidevice-0.12.10/tidevice-0.12.10/tidevice/plistlib2.py",
    "line_number": "1002",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1001\t    writer = _FORMATS[fmt][\"writer\"](fp, sort_keys=sort_keys, skipkeys=skipkeys)\n1002\t    writer.write(value)\n1003",
    "context_snippet": "def dump(value, fp, *, fmt=FMT_XML, sort_keys=True, skipkeys=False):\n    \"\"\"Write 'value' to a .plist file. 'fp' should be a writable,\n    binary file object.\n    \"\"\"\n    if fmt not in _FORMATS:\n        raise ValueError(\"Unsupported format: %r\"%(fmt,))\n\n    writer = _FORMATS[fmt][\"writer\"](fp, sort_keys=sort_keys, skipkeys=skipkeys)\n    writer.write(value)\n",
    "hash_value": "3337b116d400544d01300e746d9cf367"
  }
]