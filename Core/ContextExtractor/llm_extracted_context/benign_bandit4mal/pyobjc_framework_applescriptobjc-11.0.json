[
  {
    "metadata": {
      "package_name": "pyobjc_framework_applescriptobjc-11.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "pyobjc_setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyobjc_framework_applescriptobjc-11.0/pyobjc_framework_applescriptobjc-11.0/pyobjc_setup.py",
    "line_number": "355",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "354\t    with tempfile.NamedTemporaryFile(mode=\"w\", suffix=\".c\") as fp:\n355\t        fp.write(\"#include <stdarg.h>\\nint main(void) { return 0; }\\n\")\n356\t        fp.flush()",
    "context_snippet": "def _working_compiler(executable):\n    with tempfile.NamedTemporaryFile(mode=\"w\", suffix=\".c\") as fp:\n        fp.write(\"#include <stdarg.h>\\nint main(void) { return 0; }\\n\")\n        fp.flush()\n\n        cflags = get_config_var(\"CFLAGS\")\n        cflags = shlex.split(cflags)\n\n        p = subprocess.Popen(\n            [executable, \"-c\", fp.name] + cflags,\n            stdout=subprocess.PIPE,\n            stderr=subprocess.PIPE,\n        )\n        status = p.wait()\n        p.stdout.close()\n        p.stderr.close()\n        if status != 0:\n            return False\n\n        binfile = fp.name[:-1] + \"o\"\n        if os.path.exists(binfile):\n            os.unlink(binfile)\n\n        binfile = os.path.basename(binfile)\n        if os.path.exists(binfile):\n            os.unlink(binfile)\n\n    cflags = get_config_var(\"CFLAGS\")\n    if re.search(r\"-arch\\s+i386\", cflags) is not None:\n        raise DistutilsPlatformError(\"i386 (32-bit) is not supported by PyObjC\")\n\n    if re.search(r\"-arch\\s+ppc\", cflags) is not None:\n        raise DistutilsPlatformError(\"PowerPC is not supported by PyObjC\")\n\n    return True",
    "hash_value": "b9c94bc9d46d3eca7df6953154767e69"
  }
]