[
  {
    "metadata": {
      "package_name": "greenlet-3.1.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_version.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/greenlet-3.1.1/greenlet-3.1.1/src/greenlet/tests/test_version.py",
    "line_number": "38",
    "type_description": "B813:popen",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "37\t        invoke_setup = \"%s %s --version\" % (sys.executable, setup_py)\n38\t        with os.popen(invoke_setup) as f:\n39\t            sversion = f.read().strip()",
    "context_snippet": "class VersionTests(NonLeakingTestCase):\n    def test_version(self):\n        def find_dominating_file(name):\n            if os.path.exists(name):\n                return name\n\n            tried = []\n            here = os.path.abspath(os.path.dirname(__file__))\n            for i in range(10):\n                up = ['..'] * i\n                path = [here] + up + [name]\n                fname = os.path.join(*path)\n                fname = os.path.abspath(fname)\n                tried.append(fname)\n                if os.path.exists(fname):\n                    return fname\n            raise AssertionError(\"Could not find file \" + name + \"; checked \" + str(tried))\n\n        try:\n            setup_py = find_dominating_file('setup.py')\n        except AssertionError as e:\n            self.skipTest(\"Unable to find setup.py; must be out of tree. \" + str(e))\n\n        invoke_setup = \"%s %s --version\" % (sys.executable, setup_py)\n        with os.popen(invoke_setup) as f:\n            sversion = f.read().strip()\n\n        self.assertEqual(sversion, greenlet.__version__)\n",
    "hash_value": "00a0aeb1841cfa4ef7469631322b288b"
  }
]