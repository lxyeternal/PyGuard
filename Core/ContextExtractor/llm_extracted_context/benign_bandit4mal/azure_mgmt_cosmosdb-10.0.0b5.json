[
  {
    "metadata": {
      "package_name": "azure_mgmt_cosmosdb-10.0.0b5",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/azure_mgmt_cosmosdb-10.0.0b5/azure_mgmt_cosmosdb-10.0.0b5/setup.py",
    "line_number": "36",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "35\twith open(\"README.md\", encoding=\"utf-8\") as f:\n36\t    readme = f.read()\n37\twith open(\"CHANGELOG.md\", encoding=\"utf-8\") as f:",
    "context_snippet": "import re\nimport os.path\nfrom io import open\nfrom setuptools import find_packages, setup\n\n# Change the PACKAGE_NAME only to change folder and different name\nPACKAGE_NAME = \"azure-mgmt-cosmosdb\"\nPACKAGE_PPRINT_NAME = \"Cosmos DB Management\"\n\n# a-b-c => a/b/c\npackage_folder_path = PACKAGE_NAME.replace(\"-\", \"/\")\n# a-b-c => a.b.c\nnamespace_name = PACKAGE_NAME.replace(\"-\", \".\")\n\n# Version extraction inspired from 'requests'\nwith open(\n    os.path.join(package_folder_path, \"version.py\")\n    if os.path.exists(os.path.join(package_folder_path, \"version.py\"))\n    else os.path.join(package_folder_path, \"_version.py\"),\n    \"r\",\n) as fd:\n    version = re.search(r'^VERSION\\s*=\\s*[\\'\"]([^\\'\"]*)[\\'\"]', fd.read(), re.MULTILINE).group(1)\n\nif not version:\n    raise RuntimeError(\"Cannot find version information\")\n\nwith open(\"README.md\", encoding=\"utf-8\") as f:\n    readme = f.read()\nwith open(\"CHANGELOG.md\", encoding=\"utf-8\") as f:\n    changelog = f.read()\n\nsetup(\n    name=PACKAGE_NAME,\n    version=version,\n    description=\"Microsoft Azure {} Client Library for Python\".format(PACKAGE_PPRINT_NAME),\n    long_description=readme + \"\\n\\n\" + changelog,\n    long_description_content_type=\"text/markdown\",\n    license=\"MIT License\",\n    author=\"Microsoft Corporation\",\n    author_email=\"azpysdkhelp@microsoft.com\",\n    url=\"https://github.com/Azure/azure-sdk-for-python\",\n    keywords=\"azure, azure sdk\",  # update with search keywords relevant to the azure service / product\n    classifiers=[\n        \"Development Status :: 4 - Beta\",\n        \"Programming Language :: Python\",\n        \"Programming Language :: Python :: 3 :: Only\",\n        \"Programming Language :: Python :: 3\",\n        \"Programming Language :: Python :: 3.8\",\n        \"Programming Language :: Python :: 3.9\",\n        \"Programming Language :: Python :: 3.10\",\n        \"Programming Language :: Python :: 3.11\",\n        \"Programming Language :: Python :: 3.12\",\n        \"License :: OSI Approved :: MIT License\",\n    ],\n    zip_safe=False,\n    packages=find_packages(\n        exclude=[\n            \"tests\",\n            # Exclude packages that will be covered by PEP420 or nspkg\n            \"azure\",\n            \"azure.mgmt\",\n        ]\n    ),\n    include_package_data=True,\n    package_data={\n        \"pytyped\": [\"py.typed\"],\n    },\n    install_requires=[\n        \"isodate>=0.6.1\",\n        \"typing-extensions>=4.6.0\",\n        \"azure-common>=1.1\",\n        \"azure-mgmt-core>=1.3.2\",\n    ],\n    python_requires=\">=3.8\",\n)\n",
    "hash_value": "40fa87edaeabee4369b8de37edf32918"
  },
  {
    "pyfile": "_mongo_db_resources_operations.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/azure_mgmt_cosmosdb-10.0.0b5/azure_mgmt_cosmosdb-10.0.0b5/azure/mgmt/cosmosdb/operations/_mongo_db_resources_operations.py",
    "line_number": "4782",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "4781\t            try:\n4782\t                response.read()  # Load the body in memory and close the socket\n4783\t            except (StreamConsumedError, StreamClosedError):",
    "context_snippet": "def _create_update_mongo_db_database_initial(\n    self,\n    resource_group_name: str,\n    account_name: str,\n    database_name: str,\n    create_update_mongo_db_database_parameters: Union[_models.MongoDBDatabaseCreateUpdateParameters, IO[bytes]],\n    **kwargs: Any\n) -> Iterator[bytes]:\n    error_map: MutableMapping = {\n        401: ClientAuthenticationError,\n        404: ResourceNotFoundError,\n        409: ResourceExistsError,\n        304: ResourceNotModifiedError,\n    }\n    error_map.update(kwargs.pop(\"error_map\", {}) or {})\n\n    _headers = case_insensitive_dict(kwargs.pop(\"headers\", {}) or {})\n    _params = case_insensitive_dict(kwargs.pop(\"params\", {}) or {})\n\n    api_version: str = kwargs.pop(\"api_version\", _params.pop(\"api-version\", self._config.api_version))\n    content_type: Optional[str] = kwargs.pop(\"content_type\", _headers.pop(\"Content-Type\", None))\n    cls: ClsType[Iterator[bytes]] = kwargs.pop(\"cls\", None)\n\n    content_type = content_type or \"application/json\"\n    _json = None\n    _content = None\n    if isinstance(create_update_mongo_db_database_parameters, (IOBase, bytes)):\n        _content = create_update_mongo_db_database_parameters\n    else:\n        _json = self._serialize.body(\n            create_update_mongo_db_database_parameters, \"MongoDBDatabaseCreateUpdateParameters\"\n        )\n\n    _request = build_create_update_mongo_db_database_request(\n        resource_group_name=resource_group_name,\n        account_name=account_name,\n        database_name=database_name,\n        subscription_id=self._config.subscription_id,\n        api_version=api_version,\n        content_type=content_type,\n        json=_json,\n        content=_content,\n        headers=_headers,\n        params=_params,\n    )\n    _request.url = self._client.format_url(_request.url)\n\n    _decompress = kwargs.pop(\"decompress\", True)\n    _stream = True\n    pipeline_response: PipelineResponse = self._client._pipeline.run(  # pylint: disable=protected-access\n        _request, stream=_stream, **kwargs\n    )\n\n    response = pipeline_response.http_response\n\n    if response.status_code not in [200, 202]:\n        try:\n            response.read()  # Load the body in memory and close the socket\n        except (StreamConsumedError, StreamClosedError):\n            pass\n        map_error(status_code=response.status_code, response=response, error_map=error_map)\n        raise HttpResponseError(response=response, error_format=ARMErrorFormat)\n\n    response_headers = {}\n    if response.status_code == 202:\n        response_headers[\"azure-AsyncOperation\"] = self._deserialize(\n            \"str\", response.headers.get(\"azure-AsyncOperation\")\n        )\n        response_headers[\"location\"] = self._deserialize(\"str\", response.headers.get(\"location\"))\n\n    deserialized = response.stream_download(self._client._pipeline, decompress=_decompress)\n\n    if cls:\n        return cls(pipeline_response, deserialized, response_headers)  # type: ignore\n\n    return deserialized  # type: ignore",
    "hash_value": "056afefb3dffa6aba5e533fc9bafa66f"
  }
]