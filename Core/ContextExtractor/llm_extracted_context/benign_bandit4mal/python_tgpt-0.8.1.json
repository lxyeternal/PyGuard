[
  {
    "metadata": {
      "package_name": "python_tgpt-0.8.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "main.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/python_tgpt-0.8.1/python_tgpt-0.8.1/src/pytgpt/phind/main.py",
    "line_number": "493",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "492\n493\t        elif delta.get(\"metadata\"):\n494\t            if self.quiet:",
    "context_snippet": "def get_message(self, response: dict) -> str:\n    \"\"\"Retrieves message only from response\n\n    Args:\n        response (dict): Response generated by `self.ask`\n\n    Returns:\n        str: Message extracted\n    \"\"\"\n    assert isinstance(response, dict), \"Response should be of dict data-type only\"\n    if response.get(\"type\", \"\") == \"metadata\":\n        return\n\n    delta: dict = response[\"choices\"][0][\"delta\"]\n\n    if not delta:\n        return \"\"\n\n    elif delta.get(\"function_call\"):\n        if self.quiet:\n            return \"\"\n\n        function_call: dict = delta[\"function_call\"]\n        if function_call.get(\"name\"):\n            return function_call[\"name\"]\n        elif function_call.get(\"arguments\"):\n            return function_call.get(\"arguments\")\n\n    elif delta.get(\"metadata\"):\n        if self.quiet:\n            return \"\"\n        return yaml.dump(delta[\"metadata\"])\n\n    else:\n        return (\n            response[\"choices\"][0][\"delta\"].get(\"content\")\n            if response[\"choices\"][0].get(\"finish_reason\") is None\n            else \"\"\n        )",
    "hash_value": "95032f182becaf0a54efcec373def106"
  }
]