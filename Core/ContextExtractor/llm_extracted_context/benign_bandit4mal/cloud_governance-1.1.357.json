[
  {
    "metadata": {
      "package_name": "cloud_governance-1.1.357",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "jira.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cloud_governance-1.1.357/cloud_governance-1.1.357/cloud_governance/common/jira/jira.py",
    "line_number": "260",
    "type_description": "B825:request",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "259\t        logger.debug(\"GET pending tickets: %s\" % endpoint)\n260\t        result = await self.get_request(endpoint)\n261\t        if not result:",
    "context_snippet": "import aiohttp\nimport logging\n\nlogger = logging.getLogger(__name__)\n\nclass Jira(object):\n    ...\n    async def search_tickets(self, query=None):\n        project = {\"project\": self.ticket_queue}\n        prefix = \"/search?jql=\"\n        query_items = []\n\n        if not query:\n            query = project\n        else:\n            query.update(project)\n\n        for k, v in query.items():\n            query_items.append(f\"{k}={v}\")\n\n        jql = \" AND \".join(query_items)\n        endpoint = f\"{prefix}{jql}\"\n        logger.debug(\"GET pending tickets: %s\" % endpoint)\n        result = await self.get_request(endpoint)\n        if not result:\n            logger.error(\"Failed to get pending tickets\")\n            return None\n        return result\n\n    async def get_request(self, endpoint):\n        logger.debug(\"GET: %s\" % endpoint)\n        try:\n            async with aiohttp.ClientSession(\n                headers=self.headers,\n                loop=self.loop,\n            ) as session:\n                async with session.get(\n                    self.url + endpoint,\n                    verify_ssl=False,\n                ) as response:\n                    result = await response.json(content_type=\"application/json\")\n        except Exception as ex:\n            logger.debug(ex)\n            logger.error(\"There was something wrong with your request.\")\n            return None\n        if response.status == 404:\n            logger.error(\"Resource not found: %s\" % self.url + endpoint)\n            return None\n        return result",
    "hash_value": "aeeb0f6a4e963ce14954680faa6e46fc"
  }
]