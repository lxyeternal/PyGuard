[
  {
    "metadata": {
      "package_name": "ftw-1.3.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "http.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ftw-1.3.0/ftw-1.3.0/ftw/http.py",
    "line_number": "62",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "61\t            try:\n62\t                response_data = zipbuf.read()\n63\t            except IOError:",
    "context_snippet": "def parse_content_encoding(self, response_headers, response_data):\n    \"\"\"\n    Parses a response that contains Content-Encoding to retrieve\n    response_data\n    \"\"\"\n    if response_headers['content-encoding'] == 'br':\n        try:\n            response_data = brotli.decompress(response_data)\n        except brotli.error:\n            raise errors.TestError(\n                'Invalid or missing brotli data found',\n                {\n                    'response_data': str(response_data),\n                    'function': 'http.HttpResponse.parse_content_encoding'\n                })\n    elif response_headers['content-encoding'] == 'gzip':\n        buf = BytesIO(response_data)\n        zipbuf = gzip.GzipFile(fileobj=buf)\n        try:\n            response_data = zipbuf.read()\n        except IOError:\n            raise errors.TestError(\n                'Invalid or missing gzip data found',\n                {\n                    'response_data': str(response_data),\n                    'function': 'http.HttpResponse.parse_content_encoding'\n                })\n    elif response_headers['content-encoding'] == 'deflate':\n        try:\n            response_data = zlib.decompress(response_data, -zlib.MAX_WBITS)\n        except zlib.error:\n            raise errors.TestError(\n                'Invalid or missing deflate data found',\n                {\n                    'response_data': str(response_data),\n                    'function': 'http.HttpResponse.parse_content_encoding'\n                })\n    else:\n        raise errors.TestError(\n            'Received unknown Content-Encoding',\n            {\n                'content-encoding':\n                    str(response_headers['content-encoding']),\n                'function': 'http.HttpResponse.parse_content_encoding'\n            })\n    return response_data",
    "hash_value": "653ef034bd3d67aca2b0fbc8b82f1c6c"
  }
]