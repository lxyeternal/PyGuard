[
  {
    "metadata": {
      "package_name": "fudstop-5.9.9",
      "total_matches": 7,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "newyork_fed_sdk - Copy.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/fudstop-5.9.9/fudstop-5.9.9/fudstop/apis/newyork_fed/newyork_fed_sdk - Copy.py",
    "line_number": "480",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "479\n480\t        r = requests.get(url).json()\n481\t        fxswaps = r[\"fxSwaps\"]",
    "context_snippet": "def central_bank_liquidity_swaps(self):\n    \"\"\"Returns operations out of the fed for central bank liquidity swaps\n    \n    ARGS:\n\n    >>> count:\n                the last n records\n    \n    default: 10\n    \n    \"\"\"\n\n    url = f\"https://markets.newyorkfed.org/api/fxs/usdollar/last/10.json\"\n\n    r = requests.get(url).json()\n    fxswaps = r[\"fxSwaps\"]\n    ops = fxswaps[\"operations\"] if \"operations\" in fxswaps else None\n    if ops is not None:\n        return pd.DataFrame(ops)",
    "hash_value": "fa17a8c9a0440421b4dc71a724a60c1f"
  },
  {
    "pyfile": "discord_sdk - Copy.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/fudstop-5.9.9/fudstop-5.9.9/fudstop/apis/discord_/discord_sdk - Copy.py",
    "line_number": "317",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "316\t        name = r.get('name')\n317\t        total_messages = r.get('total_messages_sent')\n318\t        message_count = r.get('message_count')",
    "context_snippet": "def create_thread(self, channel_id:str=\"1193718649404538980\", name:str=\"YOUR THREAD NAME HERE\", topic:str='YOUR DESCRIPTION HERE', nsfw:bool=False, invitable:bool=True, locked:bool=False):\n    connection = self.connect_to_database()\n    self.create_thread_table(connection=connection)\n    payload = {\"name\":name,\"type\":11,\"topic\":topic,\"bitrate\":64000,\"user_limit\":0,\"nsfw\":nsfw,\"flags\":0,\"rate_limit_per_user\":0,\"auto_archive_duration\":10080,\"locked\": locked,\"invitable\":invitable}\n    r = requests.post(f\"https://discord.com/api/v9/channels/{channel_id}/threads\", headers=self.headers, data=json.dumps(payload)).json()\n\n    thread_id = r.get('id')\n    parent_channel = r.get('parent_id')\n    name = r.get('name')\n    total_messages = r.get('total_messages_sent')\n    message_count = r.get('message_count')\n    last_message_id = r.get('last_message_id')\n    guild = r.get('guild_id')\n\n    # Insert the retrieved attributes into the database\n    self.insert_thread(thread_id, parent_channel, name, total_messages, message_count, last_message_id, guild)\n",
    "hash_value": "5123c7f9cc69a66ab5ca830a18c9b5bf"
  },
  {
    "pyfile": "treasury_sdk - Copy.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/fudstop-5.9.9/fudstop-5.9.9/fudstop/apis/treasury/treasury_sdk - Copy.py",
    "line_number": "228",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "227\t        endpoint = f\"https://api.fiscaldata.treasury.gov/services/api/fiscal_service/v2/accounting/od/record_setting_auction?sort=-record_date\"\n228\t        r = requests.get(endpoint).json()\n229\t        data= r['data']",
    "context_snippet": "def record_setting_auctions(self):\n    endpoint = f\"https://api.fiscaldata.treasury.gov/services/api/fiscal_service/v2/accounting/od/record_setting_auction?sort=-record_date\"\n    r = requests.get(endpoint).json()\n    data= r['data']\n\n    return RecordSettingAuctions(data)",
    "hash_value": "116e061502dad8ecfc0b32e973375da0"
  },
  {
    "pyfile": "master_class.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/fudstop-5.9.9/fudstop-5.9.9/fudstop/_markets/finished/master_class.py",
    "line_number": "702",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "701\t        net_cash_flow_from_financing_activities = [i.get('net_cash_flow_from_financing_activities', 0.0) for i in cash_flow_statement]\n702\t        net_cash_flow_from_investing_activities_continuing = [i.get('net_cash_flow_from_investing_activities_continuing', 0.0) for i in cash_flow_statement]\n703\t        net_cash_flow_continuing = [i.get('net_cash_flow_continuing', 0.0) for i in cash_flow_statement]",
    "context_snippet": "    def process_annual_financial_results(self, financials_results):\n        self.id = []\n        self.sic = []\n        self.start_date = []\n        self.end_date = []\n\n        self.id = [i.get('id') for i in financials_results]\n        self.start_date = [i.get('start_date') for i in financials_results]\n        self.end_date = [i.get('end_date') for i in financials_results]\n        self.timeframe = [i.get('timeframe') for i in financials_results]\n        self.fiscal_period = [i.get('fiscal_period') for i in financials_results]\n        self.fiscal_year = [i.get('fiscal_year') for i in financials_results]\n        self.cik = [i.get('cik') for i in financials_results]\n        self.sic = [i.get('sic') for i in financials_results]\n        self.tickers = [i.get('tickers') for i in financials_results]\n        self.company_name = [i.get('company_name') for i in financials_results]\n        self.financials = [i.get('financials') for i in financials_results]\n        balance_sheet = [i.get('balance_sheet') for i in self.financials]\n        comprehensive_income = [i.get('comprehensive_income') for i in self.financials]\n        for i in comprehensive_income[0]:\n            print(i)\n\n\n\n        #income statement\n        income_statement = [i.get('income_statement') for i in self.financials]\n        # Replace None with 0.0 and convert to float for all lists\n        net_income_loss = [i.get('net_income_loss', 0.0) for i in income_statement]\n        income_loss_from_continuing_operations_before_tax = [i.get('income_loss_from_continuing_operations_before_tax') if i is not None else 0.0 for i in income_statement]\n        basic_earnings_per_share = [i.get('basic_earnings_per_share') if i is not None else 0.0 for i in income_statement]\n        net_income_loss_attributable_to_parent = [i.get('net_income_loss_attributable_to_parent') if i is not None else 0.0 for i in income_statement]\n        revenues = [i.get('revenues') if i is not None else 0.0 for i in income_statement]\n        net_income_loss_attributable_to_noncontrolling_interest = [i.get('net_income_loss_attributable_to_noncontrolling_interest') if i is not None else 0.0 for i in income_statement]\n        net_income_loss_available_to_common_stockholders_basic = [i.get('net_income_loss_available_to_common_stockholders_basic') if i is not None else 0.0 for i in income_statement]\n        gross_profit = [i.get('gross_profit') if i is not None else 0.0 for i in income_statement]\n        operating_expenses = [i.get('operating_expenses') if i is not None else 0.0 for i in income_statement]\n        preferred_stock_dividends_and_other_adjustments = [i.get('preferred_stock_dividends_and_other_adjustments') if i is not None else 0.0 for i in income_statement]\n        cost_of_revenue = [i.get('cost_of_revenue') if i is not None else 0.0 for i in income_statement]\n        costs_and_expenses = [i.get('costs_and_expenses') if i is not None else 0.0 for i in income_statement]\n        basic_average_shares = [i.get('basic_average_shares') if i is not None else 0.0 for i in income_statement]\n        interest_expense_operating = [i.get('interest_expense_operating') if i is not None else 0.0 for i in income_statement]\n        income_loss_before_equity_method_investments = [i.get('income_loss_before_equity_method_investments') if i is not None else 0.0 for i in income_statement]\n        nonoperating_income_loss = [i.get('nonoperating_income_loss') if i is not None else 0.0 for i in income_statement]\n        benefits_costs_expenses = [i.get('benefits_costs_expenses') if i is not None else 0.0 for i in income_statement]\n        income_loss_from_equity_method_investments = [i.get('income_loss_from_equity_method_investments') if i is not None else 0.0 for i in income_statement]\n        income_tax_expense_benefit = [i.get('income_tax_expense_benefit') if i is not None else 0.0 for i in income_statement]\n        income_tax_expense_benefit_deferred = [i.get('income_tax_expense_benefit_deferred') if i is not None else 0.0 for i in income_statement]\n        diluted_earnings_per_share = [i.get('diluted_earnings_per_share') if i is not None else 0.0 for i in income_statement]\n        operating_income_loss = [i.get('operating_income_loss') if i is not None else 0.0 for i in income_statement]\n        income_loss_from_continuing_operations_after_tax = [i.get('income_loss_from_continuing_operations_after_tax') if i is not None else 0.0 for i in income_statement]\n        diluted_average_shares = [i.get('diluted_average_shares') if i is not None else 0.0 for i in income_statement]\n\n\n\n        #balance sheet\n        equity_attributable_to_parent = [i.get('equity_attributable_to_parent') if i else None for i in balance_sheet]\n        assets = [i.get('assets') if i else None for i in balance_sheet]\n        noncurrent_liabilities = [i.get('noncurrent_liabilities') if i else None for i in balance_sheet]\n        other_noncurrent_assets = [i.get('other_noncurrent_assets') if i else None for i in balance_sheet]\n        inventory = [i.get('inventory') if i else None for i in balance_sheet]\n        equity = [i.get('equity') if i else None for i in balance_sheet]\n        accounts_payable = [i.get('accounts_payable') if i else None for i in balance_sheet]\n        long_term_debt = [i.get('long_term_debt') if i else None for i in balance_sheet]\n        equity_attributable_to_noncontrolling_interest = [i.get('equity_attributable_to_noncontrolling_interest') if i else None for i in balance_sheet]\n        fixed_assets = [i.get('fixed_assets') if i else None for i in balance_sheet]\n        liabilities = [i.get('liabilities') if i else None for i in balance_sheet]\n        noncurrent_assets = [i.get('noncurrent_assets') if i else None for i in balance_sheet]\n        current_liabilities = [i.get('current_liabilities') if i else None for i in balance_sheet]\n        other_current_liabilities = [i.get('other_current_liabilities') if i else None for i in balance_sheet]\n        other_current_assets = [i.get('other_current_assets') if i else None for i in balance_sheet]\n        current_assets = [i.get('current_assets') if i else None for i in balance_sheet]\n        liabilities_and_equity = [i.get('liabilities_and_equity') if i else None for i in balance_sheet]\n        other_noncurrent_liabilities = [i.get('other_noncurrent_liabilities') if i else None for i in balance_sheet]\n\n\n        #comprehensive income\n        comprehensive_income_loss_attributable_to_parent= [i.get('comprehensive_income_loss_attributable_to_parent') if i else None for i in balance_sheet]\n        comprehensive_income_loss_attributable_to_noncontrolling_interest= [i.get('comprehensive_income_loss_attributable_to_noncontrolling_interest') if i else None for i in balance_sheet]\n        comprehensive_income_loss= [i.get('comprehensive_income_loss') if i else None for i in balance_sheet]\n        other_comprehensive_income_loss= [i.get('other_comprehensive_income_loss') if i else None for i in balance_sheet]\n\n\n        #cashflow statement\n        cash_flow_statement = [i.get('cash_flow_statement') for i in self.financials]\n        net_cash_flow_from_financing_activities = [i.get('net_cash_flow_from_financing_activities', 0.0) for i in cash_flow_statement]\n        net_cash_flow_from_investing_activities_continuing = [i.get('net_cash_flow_from_investing_activities_continuing', 0.0) for i in cash_flow_statement]\n        net_cash_flow_continuing = [i.get('net_cash_flow_continuing', 0.0) for i in cash_flow_statement]\n        net_cash_flow_from_operating_activities = [i.get('net_cash_flow_from_operating_activities', 0.0) for i in cash_flow_statement]\n        net_cash_flow_from_investing_activities = [i.get('net_cash_flow_from_investing_activities', 0.0) for i in cash_flow_statement]\n        net_cash_flow_from_financing_activities_continuing = [i.get('net_cash_flow_from_financing_activities_continuing', 0.0) for i in cash_flow_statement]\n        net_cash_flow_from_operating_activities_continuing = [i.get('net_cash_flow_from_operating_activities_continuing', 0.0) for i in cash_flow_statement]\n        net_cash_flow = [i.get('net_cash_flow', 0.0) for i in cash_flow_statement]\n\n\n        \n        self.value = [\n            item.get('value') if isinstance(item, dict) else None\n            for sublist in [\n                equity_attributable_to_parent, assets, noncurrent_liabilities, other_current_assets, inventory, equity, accounts_payable, long_term_debt, equity_attributable_to_noncontrolling_interest, fixed_assets, liabilities, noncurrent_assets, current_liabilities, other_current_liabilities, other_current_assets, current_assets, liabilities_and_equity, other_noncurrent_liabilities, other_noncurrent_assets,\n                # Add the new attributes here\n                income_loss_from_continuing_operations_before_tax, basic_earnings_per_share, net_income_loss_attributable_to_parent, revenues, net_income_loss_attributable_to_noncontrolling_interest, net_income_loss_available_to_common_stockholders_basic, gross_profit, operating_expenses, preferred_stock_dividends_and_other_adjustments, cost_of_revenue, costs_and_expenses, basic_average_shares, interest_expense_operating, income_loss_before_equity_method_investments, nonoperating_income_loss, benefits_costs_expenses, income_loss_from_equity_method_investments, income_tax_expense_benefit, income_tax_expense_benefit_deferred, diluted_earnings_per_share, operating_income_loss, income_loss_from_continuing_operations_after_tax, diluted_average_shares, net_income_loss,\n                #comp income\n                comprehensive_income_loss_attributable_to_parent, comprehensive_income_loss_attributable_to_noncontrolling_interest, comprehensive_income_loss, other_comprehensive_income_loss,\n                #netcashflow\n                net_cash_flow_from_financing_activities, net_cash_flow_continuing, net_cash_flow_from_investing_activities_continuing, net_cash_flow_from_operating_activities, net_cash_flow_from_investing_activities, net_cash_flow_from_investing_activities_continuing, net_cash_flow_from_financing_activities_continuing, net_cash_flow_from_operating_activities_continuing, net_cash_flow\n            ]\n            for item in sublist\n        ]\n        self.unit = [\n            item.get('unit') if isinstance(item, dict) else None\n            for sublist in [\n                equity_attributable_to_parent, assets, noncurrent_liabilities, other_current_assets, inventory, equity, accounts_payable, long_term_debt, equity_attributable_to_noncontrolling_interest, fixed_assets, liabilities, noncurrent_assets, current_liabilities, other_current_liabilities, other_current_assets, current_assets, liabilities_and_equity, other_noncurrent_liabilities, other_noncurrent_assets,\n                # Add the new attributes here\n                income_loss_from_continuing_operations_before_tax, basic_earnings_per_share, net_income_loss_attributable_to_parent, revenues, net_income_loss_attributable_to_noncontrolling_interest, net_income_loss_available_to_common_stockholders_basic, gross_profit, operating_expenses, preferred_stock_dividends_and_other_adjustments, cost_of_revenue, costs_and_expenses, basic_average_shares, interest_expense_operating, income_loss_before_equity_method_investments, nonoperating_income_loss, benefits_costs_expenses, income_loss_from_equity_method_investments, income_tax_expense_benefit, income_tax_expense_benefit_deferred, diluted_earnings_per_share, operating_income_loss, income_loss_from_continuing_operations_after_tax, diluted_average_shares, net_income_loss,\n                #comp income\n                comprehensive_income_loss_attributable_to_parent, comprehensive_income_loss_attributable_to_noncontrolling_interest, comprehensive_income_loss, other_comprehensive_income_loss,\n                #netcashflow\n                net_cash_flow_from_financing_activities, net_cash_flow_continuing, net_cash_flow_from_investing_activities_continuing, net_cash_flow_from_operating_activities, net_cash_flow_from_investing_activities, net_cash_flow_from_investing_activities_continuing, net_cash_flow_from_financing_activities_continuing, net_cash_flow_from_operating_activities_continuing, net_cash_flow\n            ]\n            for item in sublist\n        ]\n\n        self.label = [\n            item.get('label') if isinstance(item, dict) else None\n            for sublist in [\n                equity_attributable_to_parent, assets, noncurrent_liabilities, other_current_assets, inventory, equity, accounts_payable, long_term_debt, equity_attributable_to_noncontrolling_interest, fixed_assets, liabilities, noncurrent_assets, current_liabilities, other_current_liabilities, other_current_assets, current_assets, liabilities_and_equity, other_noncurrent_liabilities, other_noncurrent_assets,\n                # Add the new attributes here\n                income_loss_from_continuing_operations_before_tax, basic_earnings_per_share, net_income_loss_attributable_to_parent, revenues, net_income_loss_attributable_to_noncontrolling_interest, net_income_loss_available_to_common_stockholders_basic, gross_profit, operating_expenses, preferred_stock_dividends_and_other_adjustments, cost_of_revenue, costs_and_expenses, basic_average_shares, interest_expense_operating, income_loss_before_equity_method_investments, nonoperating_income_loss, benefits_costs_expenses, income_loss_from_equity_method_investments, income_tax_expense_benefit, income_tax_expense_benefit_deferred, diluted_earnings_per_share, operating_income_loss, income_loss_from_continuing_operations_after_tax, diluted_average_shares, net_income_loss,\n                #comp income\n                comprehensive_income_loss_attributable_to_parent, comprehensive_income_loss_attributable_to_noncontrolling_interest, comprehensive_income_loss, other_comprehensive_income_loss,\n                #netcashflow\n                net_cash_flow_from_financing_activities, net_cash_flow_continuing, net_cash_flow_from_investing_activities_continuing, net_cash_flow_from_operating_activities, net_cash_flow_from_investing_activities, net_cash_flow_from_investing_activities_continuing, net_cash_flow_from_financing_activities_continuing, net_cash_flow_from_operating_activities_continuing, net_cash_flow\n            ]\n            for item in sublist\n        ]\n\n        self.order = [\n            item.get('order') if isinstance(item, dict) else None\n            for sublist in [\n                equity_attributable_to_parent, assets, noncurrent_liabilities, other_current_assets, inventory, equity, accounts_payable, long_term_debt, equity_attributable_to_noncontrolling_interest, fixed_assets, liabilities, noncurrent_assets, current_liabilities, other_current_liabilities, other_current_assets, current_assets, liabilities_and_equity, other_noncurrent_liabilities, other_noncurrent_assets,\n                # Add the new attributes here\n                income_loss_from_continuing_operations_before_tax, basic_earnings_per_share, net_income_loss_attributable_to_parent, revenues, net_income_loss_attributable_to_noncontrolling_interest, net_income_loss_available_to_common_stockholders_basic, gross_profit, operating_expenses, preferred_stock_dividends_and_other_adjustments, cost_of_revenue, costs_and_expenses, basic_average_shares, interest_expense_operating, income_loss_before_equity_method_investments, nonoperating_income_loss, benefits_costs_expenses, income_loss_from_equity_method_investments, income_tax_expense_benefit, income_tax_expense_benefit_deferred, diluted_earnings_per_share, operating_income_loss, income_loss_from_continuing_operations_after_tax, diluted_average_shares, net_income_loss,\n                #comp income\n                comprehensive_income_loss_attributable_to_parent, comprehensive_income_loss_attributable_to_noncontrolling_interest, comprehensive_income_loss, other_comprehensive_income_loss,\n                #netcashflow\n                net_cash_flow_from_financing_activities, net_cash_flow_continuing, net_cash_flow_from_investing_activities_continuing, net_cash_flow_from_operating_activities, net_cash_flow_from_investing_activities, net_cash_flow_from_investing_activities_continuing, net_cash_flow_from_financing_activities_continuing, net_cash_flow_from_operating_activities_continuing, net_cash_flow\n            ]\n            for item in sublist\n        ]\n\n        fiscal_years = []\n        fiscal_periods = []\n        start_dates = []\n        end_dates = []\n        timeframes = []\n\n        \n        for i in range(len(self.label)):\n            fiscal_year = self.fiscal_year[i % 10]  # Use modulo to cycle through the 10 fiscal years\n            fiscal_period = self.fiscal_period[i % 10]\n            end_date = self.end_date[i % 10]\n            start_date = self.start_date[i % 10]\n            timeframe = self.timeframe[i % 10]\n\n            fiscal_years.append(fiscal_year)\n            fiscal_periods.append(fiscal_period)\n            start_dates.append(start_date)\n            end_dates.append(end_date)\n            timeframes.append(timeframe)\n\n        print(len(fiscal_years), len(fiscal_periods), len(start_dates), len(end_dates))\n        self.financials_data_dict = { \n            'fiscal_year': fiscal_years,\n            'fiscal_period': fiscal_periods,\n            'start_date': start_dates,\n            'end_date': end_dates,\n            'metric': self.label,\n            'value': self.value,\n            'unit': self.unit\n\n        }\n\n\n        self.as_financials_df = pd.DataFrame(self.financials_data_dict)\n        self.as_financials_df = self.format_large_numbers_in_dataframe(self.as_financials_df).sort_values('end_date', ascending=False)\n        if 'ticker' in self.kwargs:\n            # Add the ticker as a new column\n            self.as_financials_df['ticker'] = self.kwargs['ticker']\n            \n\n        return self.as_financials_df",
    "hash_value": "b4470885eebd209e61bc502c71c3e77f"
  },
  {
    "pyfile": "master_class.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/fudstop-5.9.9/fudstop-5.9.9/fudstop/_markets/finished/master_class.py",
    "line_number": "287",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "286\t        self.prev_low = [float(i.get('l')) if i.get('l') is not None else 'N/A' for i in self.prevDay]\n287\t        self.prev_close = [float(i.get('c')) if i.get('c') is not None else 'N/A' for i in self.prevDay]\n288\t        self.prev_volume = [float(i.get('v')) if i.get('v') is not None else 'N/A' for i in self.prevDay]",
    "context_snippet": "    def process_all_stock_snapshot_results(self, all_stock_snapshot_results):\n        if all_stock_snapshot_results is not None:\n            self.ticker = [i.get('ticker', '') for i in all_stock_snapshot_results]\n            self.todaysChangePerc = [float(i.get('todaysChangePerc', 0.0)) for i in all_stock_snapshot_results]\n            self.todaysChange = [float(i.get('todaysChange', 0.0)) for i in all_stock_snapshot_results]\n            self.updated = [i.get('updated', '') for i in all_stock_snapshot_results]\n        else:\n            # Handle the case where all_stock_snapshot_results is None\n            self.ticker = []\n            self.todaysChangePerc = []\n            self.todaysChange = []\n            self.updated = [] # Default to empty string if 'updated' is None\n\n\n        self.day = [i.get('day') for i in all_stock_snapshot_results]\n        self.day_open = [float(i.get('o')) for i in self.day]\n        self.day_high = [float(i.get('h')) for i in self.day]\n        self.day_low = [float(i.get('l')) for i in self.day]\n        self.day_close = [float(i.get('c')) for i in self.day]\n        self.day_volume = [float(i.get('v')) for i in self.day]\n        self.day_vwap = [float(i.get('vw')) for i in self.day]\n\n\n\n\n        self.lastQuote = [i.get('lastQuote') for i in all_stock_snapshot_results]\n        self.ask  = [float(i.get('P')) for i in self.lastQuote]\n        self.ask_size = [float(i.get('S')) for i in self.lastQuote]\n        self.bid = [float(i.get('p')) for i in self.lastQuote]\n        self.bid_size = [float(i.get('s')) for i in self.lastQuote]\n        self.quote_timestamp = []\n        for i in self.lastQuote:\n            timestamp = i.get('t')\n            if timestamp:\n                try:\n                    # Convert from nanoseconds to seconds\n                    timestamp_seconds = int(timestamp) // 1_000_000_000\n                    # Calculate remaining nanoseconds after converting to seconds\n                    remaining_nanos = int(timestamp) % 1_000_000_000\n\n                    # Create a datetime object for the Unix epoch\n                    epoch = datetime(1970, 1, 1)\n                    # Add the seconds and remaining nanoseconds to the epoch\n                    converted_datetime = epoch + timedelta(seconds=timestamp_seconds, microseconds=remaining_nanos // 1000)\n\n                    # Adjust for Eastern Time (ET) UTC-5\n                    adjusted_datetime = converted_datetime - timedelta(hours=5)\n                    self.quote_timestamp.append(adjusted_datetime.strftime('%Y-%m-%d %H:%M:%S'))\n                except Exception as e:\n                    self.quote_timestamp.append(f'Error: {e}')\n            else:\n                self.quote_timestamp.append('N/A')\n\n        \n        self.lastTrade = [i.get('lastTrade') for i in all_stock_snapshot_results]\n        self.trade_conditions = [i.get('c') for i in self.lastTrade]\n        self.trade_id = [i.get('i') for i in self.lastTrade]\n        self.trade_price = [float(i.get('p')) for i in self.lastTrade]\n        self.trade_size = [float(i.get('s')) for i in self.lastTrade]\n        self.trade_timestamp = []\n        for i in self.lastTrade:\n            timestamp = i.get('t')\n            if timestamp:\n                try:\n                    # Convert from nanoseconds to seconds\n                    timestamp_seconds = int(timestamp) // 1_000_000_000\n                    # Calculate remaining nanoseconds after converting to seconds\n                    remaining_nanos = int(timestamp) % 1_000_000_000\n\n                    # Create a datetime object for the Unix epoch\n                    epoch = datetime(1970, 1, 1)\n                    # Add the seconds and remaining nanoseconds to the epoch\n                    converted_datetime = epoch + timedelta(seconds=timestamp_seconds, microseconds=remaining_nanos // 1000)\n\n                    # Adjust for Eastern Time (ET) UTC-5\n                    adjusted_datetime = converted_datetime - timedelta(hours=5)\n                    self.trade_timestamp.append(adjusted_datetime.strftime('%Y-%m-%d %H:%M:%S'))\n                except Exception as e:\n                    self.trade_timestamp.append(f'Error: {e}')\n            else:\n                self.trade_timestamp.append('N/A')\n        self.trade_exchange = [i.get('x') for i in self.lastTrade]\n\n\n        self.min = [i.get('min') for i in all_stock_snapshot_results]\n        self.min_accumulated_volume = [float(i.get('av')) if i.get('av') is not None else 'N/A' for i in all_stock_snapshot_results]\n        self.min_timestamp = [\n            (\n                datetime.fromtimestamp(\n                    float(i.get('t')) / 1000 if len(str(int(float(i.get('t'))))) == 13 else float(i.get('t')),\n                    tz=timezone.utc\n                ).astimezone(timezone(timedelta(hours=-5)))  # Eastern Time (ET) UTC-5\n                .strftime('%Y-%m-%d %H:%M:%S') if i.get('t') is not None else 'N/A'\n            )\n            for i in self.min\n        ]\n        self.min_num_trades = [float(i.get('n')) if i.get('n') is not None else 'N/A' for i in self.min]\n        self.min_open = [float(i.get('o')) if i.get('o') is not None else 'N/A' for i in self.min]\n        self.min_high = [float(i.get('h')) if i.get('h') is not None else 'N/A' for i in self.min]\n        self.min_low = [float(i.get('l')) if i.get('l') is not None else 'N/A' for i in self.min]\n        self.min_close = [float(i.get('c')) if i.get('c') is not None else 'N/A' for i in self.min]\n        self.min_vwap = [float(i.get('vw')) if i.get('vw') is not None else 'N/A' for i in self.min]\n\n\n        self.prevDay = [i.get('prevDay') for i in all_stock_snapshot_results]\n        self.prev_open = [float(i.get('o')) if i.get('o') is not None else 'N/A' for i in all_stock_snapshot_results]\n        self.prev_high = [float(i.get('h')) if i.get('h') is not None else 'N/A' for i in self.prevDay]\n        self.prev_low = [float(i.get('l')) if i.get('l') is not None else 'N/A' for i in self.prevDay]\n        self.prev_close = [float(i.get('c')) if i.get('c') is not None else 'N/A' for i in self.prevDay]\n        self.prev_volume = [float(i.get('v')) if i.get('v') is not None else 'N/A' for i in self.prevDay]\n        self.prev_vwap = [float(i.get('vw')) if i.get('vw') is not None else 'N/A' for i in self.prevDay]\n\n\n        self.all_stock_snapshot_data_dict = { \n            'ticker': self.ticker,\n            'change_percent': self.todaysChangePerc,\n            'change': self.todaysChange,\n            'day_open': self.day_open,\n            'day_high': self.day_high,\n            'day_low': self.day_low,\n            'day_close': self.day_close,\n            'day_volume': self.day_volume,\n            'day_vwap': self.day_vwap,\n            'prev_open': self.prev_open,\n            'prev_high': self.prev_high,\n            'prev_low': self.prev_low,\n            'prev_close': self.prev_close,\n            'prev_volume': self.prev_volume,\n            'prev_vwap': self.prev_vwap,\n            'min_accumulated_volume': self.min_accumulated_volume,\n            'min_open': self.min_open,\n            'min_high': self.min_high,\n            'min_low': self.min_low,\n            'min_close': self.min_close,\n            'min_vwap': self.min_vwap,\n            'min_num_trades': self.min_num_trades,\n            'min_timestamp': self.min_timestamp,\n            'trade_conditions': self.trade_conditions,\n            'trade_exchange': self.trade_exchange,\n            'trade_price': self.trade_price,\n            'trade_size': self.trade_size,\n            'trade_id': self.trade_id,\n            'trade_timestamp': self.trade_timestamp,\n            'ask': self.ask,\n            'ask_size': self.ask_size,\n            'bid': self.bid,\n            'bid_size': self.bid_size,\n            'quote_timestamp': self.quote_timestamp\n        }\n\n\n        self.all_ticker_snapshots_as_dataframe = pd.DataFrame(self.all_stock_snapshot_data_dict)\n",
    "hash_value": "681e33f1ccf5f910c1e2c64d1af9b959"
  },
  {
    "pyfile": "newyork_fed_sdk.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/fudstop-5.9.9/fudstop-5.9.9/fudstop/apis/newyork_fed/newyork_fed_sdk.py",
    "line_number": "305",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "304\t                    'total_submitted_par': i.get('totalAmtSubmittedPar'),\n305\t                    'total_accepted_par': i.get('totalAmtAcceptedPar'),\n306\t                    'settlement_date': i.get('settlementDate'),",
    "context_snippet": "def all_agency_mortgage_backed_securities(self):\n    \"\"\"Returns Agency Mortgage Backed Securities from the New York Fed API\n    \n    PARAMS:\n\n    >>> operation:\n\n        'all'\n        'purchases'\n        'sales'\n        'roll'\n        'swap'\n    \n    >>> status:\n\n        'announcements'\n        'results'\n    \n        \n    >>> include:\n\n        'summary'\n        'details'\n\n    >>> format:\n\n        'json'\n        'csv'\n        'xml'\n        'xlsx'\n    \n    \"\"\"\n    url = f\"https://markets.newyorkfed.org/beta/api/ambs/all/results/details/search.json?startDate={self.thirty_days_ago}&endDate={today_str}\"\n    print(url)\n    r = requests.get(url).json()\n    ambs = r['ambs'] if 'ambs' in r else None\n\n    all_data_dicts = []\n    \n    if ambs is None:\n        return all_data_dicts\n    \n    auctions = ambs.get('auctions', [])\n    \n    for i in auctions:\n        details = i.get('details', [])\n        \n        for detail in details:\n            data_dict = {\n                'auction_status': i.get(\"auctionStatus\"),\n                'operation_id': i.get('operationId'),\n                'operation_date': i.get('operationDate'),\n                'operation_type': i.get('operationType'),\n                'operation_direction': i.get('operationDirection'),\n                'method': i.get('method'),\n                'release_time': i.get('releaseTime'),\n                'close_time': i.get('closeTime'),\n                'class_type': i.get('classType'),\n                'total_submitted_orig_face': i.get('totalSubmittedOrigFace'),\n                'total_accepted_orig_face': i.get('totalAcceptedOrigFace'),\n                'total_submitted_curr_face': i.get('totalSubmittedCurrFace'),\n                'total_accepted_curr_face': i.get('totalAcceptedCurrFace'),\n                'total_submitted_par': i.get('totalAmtSubmittedPar'),\n                'total_accepted_par': i.get('totalAmtAcceptedPar'),\n                'settlement_date': i.get('settlementDate'),\n                'last_updated': i.get('lastUpdated'),\n                'note': i.get('note'),\n                'inclusion_flag': detail.get('inclusionExclusionFlag'),\n                'security_description': detail.get('securityDescription'),\n                'amt_accepted_par': detail.get('amtAcceptedPar')\n            }\n            all_data_dicts.append(data_dict)\n    df = pd.DataFrame(all_data_dicts)\n    return df",
    "hash_value": "ef8af33ba435d5063c24268b214b909f"
  },
  {
    "pyfile": "polygon_helpers.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/fudstop-5.9.9/fudstop-5.9.9/fudstop/apis/polygonio/polygon_helpers.py",
    "line_number": "647",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "646\t                volume = contract.get('session').get('volume', None)\n647\t                prev_close = contract.get('session').get('previous_close')\n648\t                early_trading_change_percent = contract.get('session').get('early_trading_change_percent')",
    "context_snippet": "async def process_contract(data, db):\n        \n\n    if data is not None:\n        for contract in data:\n            try:\n\n                option_symbol = contract.get('ticker')\n                expiry = contract.get('details').get('expiration_date')\n                strike = contract.get('details').get('strike_price')\n                call_put = contract.get('details').get('contract_type')\n                underlying_symbol = contract.get('underlying_asset').get('ticker')\n                underlying_price = contract.get('underlying_asset').get('price')\n                change_to_breakeven = contract.get('underlying_asset').get('change_to_breakeven')\n\n                \n\n                trade_size = contract.get('last_trade').get('size')\n                trade_price = contract.get('last_trade').get('price')\n                trade_conditions = contract.get('last_trade', None).get('conditions', None)\n                sip_timestamp = contract.get('last_trade', None).get('sip_timestamp', None)\n                if sip_timestamp is not None:\n                    sip_timestamp = datetime.fromtimestamp(sip_timestamp / 1e9)\n                trade_conditions = [option_condition_dict.get(c) for c in trade_conditions] if trade_conditions is not None else []\n                trade_conditions = trade_conditions[0]\n                trade_exchange = OPTIONS_EXCHANGES.get(contract.get('last_trade').get('exchange', None))\n                break_even_price = contract.get('break_even_price', None)\n                implied_volatility = contract.get('implied_volatility', None)\n                open_interest = contract.get('open_interest', None)\n                name = contract.get('name', None)\n                open = contract.get('session').get('open', None)\n                high = contract.get('session').get('high', None)\n                low = contract.get('session').get('low', None)\n                close = contract.get('session').get('close', None)\n                volume = contract.get('session').get('volume', None)\n                prev_close = contract.get('session').get('previous_close')\n                early_trading_change_percent = contract.get('session').get('early_trading_change_percent')\n                change = contract.get('session').get('change')\n                early_trading_change = contract.get('session').get('early_trading_change')\n                change_percent = contract.get('session').get('change_percent', None)\n\n                delta = contract.get('greeks').get('delta')\n                vega = contract.get('greeks').get('vega')\n                theta = contract.get('greeks').get('theta')\n                gamma = contract.get('greeks').get('gamma')\n\n                ask = contract.get('last_quote').get('ask')\n                bid = contract.get('last_quote').get('bid')\n                ask_size = contract.get('last_quote').get('ask_size')\n                bid_size = contract.get('last_quote').get('bid_size')\n                ask_exchange = OPTIONS_EXCHANGES.get(contract.get('last_quote').get('ask_exchange'))\n                bid_exchange = OPTIONS_EXCHANGES.get(contract.get('last_quote').get('bid_exchange'))\n\n\n                data_dict = {\n                    'option_symbol': option_symbol,\n                    'expiry': expiry,\n                    'strike': strike,\n                    'call_put': call_put,\n                    'underlying_symbol': underlying_symbol,\n                    'underlying_price': underlying_price,\n                    'change_to_breakeven': change_to_breakeven,\n                    'trade_size': trade_size,\n                    'trade_price': trade_price,\n                    'trade_conditions': trade_conditions,\n                    'sip_timestamp': sip_timestamp,\n                    'trade_exchange': trade_exchange,\n                    'break_even_price': break_even_price,\n                    'implied_volatility': implied_volatility,\n                    'open_interest': open_interest,\n                    'name': name,\n                    'open': open,\n                    'high': high,\n                    'low': low,\n                    'close': close,\n                    'volume': volume,\n                    'prev_close': prev_close,\n                    'early_trading_change_percent': early_trading_change_percent,\n                    'change': change,\n                    'early_trading_change': early_trading_change,\n                    'change_percent': change_percent,\n                    'delta': delta,\n                    'vega': vega,\n                    'theta': theta,\n                    'gamma': gamma,\n                    'ask': ask,\n                    'bid': bid,\n                    'ask_size': ask_size,\n                    'bid_size': bid_size,\n                    'ask_exchange': ask_exchange,\n                    'bid_exchange': bid_exchange\n                }\n\n\n                return data_dict\n            except Exception as e:\n                # Handle any other exceptions that might occur\n                print(f\"An error occurred: {e}\")",
    "hash_value": "ef17e7c3a012e61ed31ec11057e4705f"
  }
]