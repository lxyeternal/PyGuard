[
  {
    "metadata": {
      "package_name": "pywebpush-2.0.3",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_webpush.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py",
    "line_number": "384",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "383\t        await WebPusher(subscription_info).send_async(\"\", headers)\n384\t        assert subscription_info.get(\"endpoint\") == mock_post.call_args[0][0]\n385\t        pheaders = mock_post.call_args[1].get(\"headers\")",
    "context_snippet": "@patch(\"aiohttp.ClientSession.post\", new_callable=AsyncMock)\nasync def test_send_empty(self, mock_post):\n    subscription_info = self._gen_subscription_info()\n    headers = {\"Crypto-Key\": \"pre-existing\", \"Authentication\": \"bear vapid\"}\n    await WebPusher(subscription_info).send_async(\"\", headers)\n    assert subscription_info.get(\"endpoint\") == mock_post.call_args[0][0]\n    pheaders = mock_post.call_args[1].get(\"headers\")\n    assert pheaders.get(\"ttl\") == \"0\"\n    assert \"encryption\" not in pheaders\n    assert pheaders.get(\"AUTHENTICATION\") == headers.get(\"Authentication\")\n    ckey = pheaders.get(\"crypto-key\")\n    assert \"pre-existing\" in ckey\n",
    "hash_value": "391eef1b7644f2d3ceaf8ad77e19a258"
  }
]