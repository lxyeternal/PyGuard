[
  {
    "metadata": {
      "package_name": "quart-0.20.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "asgi.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/quart-0.20.0/quart-0.20.0/src/quart/asgi.py",
    "line_number": "391",
    "type_description": "B805:send",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "390\t                else:\n391\t                    await send(\n392\t                        cast(\n393\t                            LifespanShutdownCompleteEvent,\n394\t                            {\"type\": \"lifespan.shutdown.complete\"},\n395\t                        ),",
    "context_snippet": "class ASGILifespan:\n    def __init__(self, app: Quart, scope: LifespanScope) -> None:\n        self.app = app\n\n    async def __call__(\n        self, receive: ASGIReceiveCallable, send: ASGISendCallable\n    ) -> None:\n        while True:\n            event = await receive()\n            if event[\"type\"] == \"lifespan.startup\":\n                try:\n                    await self.app.startup()\n                except Exception as error:\n                    await send(\n                        cast(\n                            LifespanStartupFailedEvent,\n                            {\"type\": \"lifespan.startup.failed\", \"message\": str(error)},\n                        ),\n                    )\n                else:\n                    await send(\n                        cast(\n                            LifespanStartupCompleteEvent,\n                            {\"type\": \"lifespan.startup.complete\"},\n                        )\n                    )\n            elif event[\"type\"] == \"lifespan.shutdown\":\n                try:\n                    await self.app.shutdown()\n                except Exception as error:\n                    await send(\n                        cast(\n                            LifespanShutdownFailedEvent,\n                            {\"type\": \"lifespan.shutdown.failed\", \"message\": str(error)},\n                        ),\n                    )\n                else:\n                    await send(\n                        cast(\n                            LifespanShutdownCompleteEvent,\n                            {\"type\": \"lifespan.shutdown.complete\"},\n                        ),\n                    )\n                break",
    "hash_value": "ae1ddf812a53b9ea120c2dd18f8b2750"
  }
]