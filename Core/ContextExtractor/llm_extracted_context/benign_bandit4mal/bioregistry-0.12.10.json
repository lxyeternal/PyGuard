[
  {
    "metadata": {
      "package_name": "bioregistry-0.12.10",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "__init__.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/bioregistry-0.12.10/bioregistry-0.12.10/src/bioregistry/external/obofoundry/__init__.py",
    "line_number": "79",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "78\t        \"preferredPrefix\": record.get(\"preferredPrefix\"),\n79\t        \"license\": record.get(\"license\", {}).get(\"label\"),\n80\t        \"license.url\": record.get(\"license\", {}).get(\"url\"),",
    "context_snippet": "def _process(record: dict[str, Any]) -> dict[str, Any]:\n    for key in (\"browsers\", \"usages\", \"build\", \"layout\", \"taxon\"):\n        record.pop(key, None)\n\n    oid = record[\"id\"].lower()\n\n    # added to throw away placeholder contact\n    contact_github = record.get(\"contact\", {}).get(\"github\")\n    if contact_github == \"ghost\":\n        del record[\"contact\"]\n\n    rv = {\n        \"name\": record[\"title\"],\n        \"description\": record.get(\"description\"),\n        \"deprecated\": record[\"activity_status\"] != \"active\",\n        \"homepage\": record.get(\"homepage\") or record.get(\"repository\"),\n        \"preferredPrefix\": record.get(\"preferredPrefix\"),\n        \"license\": record.get(\"license\", {}).get(\"label\"),\n        \"license.url\": record.get(\"license\", {}).get(\"url\"),\n        \"contact\": record.get(\"contact\", {}).get(\"email\"),\n        \"contact.label\": record.get(\"contact\", {}).get(\"label\"),\n        \"contact.github\": record.get(\"contact\", {}).get(\"github\"),\n        \"contact.orcid\": record.get(\"contact\", {}).get(\"orcid\"),\n        \"repository\": record.get(\"repository\"),\n        \"domain\": record.get(\"domain\"),\n    }\n\n    for key in (\"publications\", \"twitter\"):\n        value = record.get(key)\n        if value:\n            rv[key] = value\n\n    dependencies = record.get(\"dependencies\")\n    if dependencies:\n        rv[\"depends_on\"] = sorted(\n            dependency[\"id\"]\n            for dependency in record.get(\"dependencies\", [])\n            if dependency.get(\"type\") not in {\"BridgeOntology\"}\n        )\n\n    for product in record.get(\"products\", []):\n        if product[\"id\"] == f\"{oid}.obo\":\n            rv[\"download.obo\"] = product[\"ontology_purl\"]\n        elif product[\"id\"] == f\"{oid}.json\":\n            rv[\"download.json\"] = product[\"ontology_purl\"]\n        elif product[\"id\"] == f\"{oid}.owl\":\n            rv[\"download.owl\"] = product[\"ontology_purl\"]\n\n    logo = record.get(\"depicted_by\")\n    if logo:\n        if logo.startswith(\"/images/\"):\n            logo = f\"https://obofoundry.org{logo}\"\n        rv[\"logo\"] = logo\n\n    return {k: v for k, v in rv.items() if v is not None}\n",
    "hash_value": "6d8250e36a1709a90f78f57f3bd2f658"
  }
]