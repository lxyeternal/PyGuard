[
  {
    "metadata": {
      "package_name": "ibm_watsonx_ai-1.3.6",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "hybrid_artifact_loader.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ibm_watsonx_ai-1.3.6/ibm_watsonx_ai-1.3.6/ibm_watsonx_ai/libs/repo/mlrepositoryartifact/hybrid_artifact_loader.py",
    "line_number": "43",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "42\t            if queryparam_val is None:\n43\t                input_stream = self.reader().read()\n44\t            if queryparam_val is not None and queryparam_val == 'full':",
    "context_snippet": "def extract_content(self, queryparam_val, callback):\n    directory_name = 'artifact'\n    try:\n        shutil.rmtree(directory_name)\n    except:\n        pass\n\n    try:\n        id_length = 20\n        dir_id = uid_generate(id_length)\n        model_dir_name = directory_name + dir_id\n\n        gz_file_name = '{}/artifact_content.tar.gz'.format(model_dir_name)\n\n        input_stream = None\n        os.makedirs(model_dir_name)\n        if queryparam_val is None:\n            input_stream = self.reader().read()\n        if queryparam_val is not None and queryparam_val == 'full':\n            input_stream = self._content_reader_gzip()\n        file_content = input_stream.read()\n        gz_f = open(gz_file_name, 'wb+')\n        gz_f.write(file_content)\n        gz_f.close()\n        if queryparam_val is None:\n            self.reader().close()\n\n        with zipfile.ZipFile(gz_file_name) as zip_ref:\n            zip_ref.extractall(model_dir_name)\n        artifact_instance = callback(model_dir_name)\n\n        shutil.rmtree(model_dir_name)\n        return artifact_instance\n    except Exception as ex:\n        shutil.rmtree(model_dir_name)\n        raise ex",
    "hash_value": "92d19f364d9776d5c1cb6c6093b41426"
  }
]