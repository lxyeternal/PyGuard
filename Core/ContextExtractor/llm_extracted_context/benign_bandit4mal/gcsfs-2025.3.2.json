[
  {
    "metadata": {
      "package_name": "gcsfs-2025.3.2",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_core.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gcsfs-2025.3.2/gcsfs-2025.3.2/gcsfs/tests/test_core.py",
    "line_number": "1544",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1543\t    with gcs.open(file, \"wb\") as f:\n1544\t        f.write(b\"This is a test string\")\n1545\t    assert gcs.cat(file) == b\"This is a test string\"",
    "context_snippet": "def test_sign(gcs, monkeypatch):\n    file = TEST_BUCKET + \"/test.jpg\"\n    with gcs.open(file, \"wb\") as f:\n        f.write(b\"This is a test string\")\n    assert gcs.cat(file) == b\"This is a test string\"\n\n    # `sign` is creating a google Client on its own, it needs a realistically\n    # looking credentials file.\n    if not gcs.on_google:\n        monkeypatch.setenv(\n            \"GOOGLE_APPLICATION_CREDENTIALS\",\n            os.path.dirname(__file__) + \"/fake-service-account-credentials.json\",\n        )\n\n    current_ts_utc = int(datetime.now(tz=timezone.utc).timestamp())\n    result = gcs.sign(file)\n\n    # Check it here since emulator doesn't really validate those values\n    params = parse_qs(urlparse(result).query)\n    assert int(params[\"Expires\"][0]) >= current_ts_utc + 100\n\n    response = requests.get(result)\n    assert response.text == \"This is a test string\"",
    "hash_value": "c1327f601b34b621c7239ef60c475a8a"
  }
]