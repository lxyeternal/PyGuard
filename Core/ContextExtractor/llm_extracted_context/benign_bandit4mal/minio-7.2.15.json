[
  {
    "metadata": {
      "package_name": "minio-7.2.15",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "api.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/minio-7.2.15/minio-7.2.15/minio/api.py",
    "line_number": "3085",
    "type_description": "B834:open",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "3084\t        fileobj = None if name else BytesIO()\n3085\t        with tarfile.open(name=name, mode=mode, fileobj=fileobj) as tar:\n3086\t            for obj in object_list:",
    "context_snippet": "def upload_snowball_objects(\n        self,\n        bucket_name: str,\n        object_list: Iterable[SnowballObject],\n        metadata: DictType | None = None,\n        sse: Sse | None = None,\n        tags: Tags | None = None,\n        retention: Retention | None = None,\n        legal_hold: bool = False,\n        staging_filename: str | None = None,\n        compression: bool = False,\n) -> ObjectWriteResult:\n    \"\"\"\n    Uploads multiple objects in a single put call. It is done by creating\n    intermediate TAR file optionally compressed which is uploaded to S3\n    service.\n\n    :param bucket_name: Name of the bucket.\n    :param object_list: An iterable containing\n        :class:`SnowballObject <SnowballObject>` object.\n    :param metadata: Any additional metadata to be uploaded along\n        with your PUT request.\n    :param sse: Server-side encryption.\n    :param tags: :class:`Tags` for the object.\n    :param retention: :class:`Retention` configuration object.\n    :param legal_hold: Flag to set legal hold for the object.\n    :param staging_filename: A staging filename to create intermediate\n        tarball.\n    :param compression: Flag to compress TAR ball.\n    :return: :class:`ObjectWriteResult` object.\n\n    Example::\n        # Upload snowball object.\n        result = client.upload_snowball_objects(\n            \"my-bucket\",\n            [\n                SnowballObject(\"my-object1\", filename=\"/etc/hostname\"),\n                SnowballObject(\n                    \"my-object2\", data=io.BytesIO(\"hello\"), length=5,\n                ),\n                SnowballObject(\n                    \"my-object3\", data=io.BytesIO(\"world\"), length=5,\n                    mod_time=datetime.now(),\n                ),\n            ],\n        )\n    \"\"\"\n    check_bucket_name(bucket_name, s3_check=self._base_url.is_aws_host)\n\n    object_name = f\"snowball.{random()}.tar\"\n\n    # turn list like objects into an iterator.\n    object_list = itertools.chain(object_list)\n\n    metadata = metadata or {}\n    metadata[\"X-Amz-Meta-Snowball-Auto-Extract\"] = \"true\"\n\n    name = staging_filename\n    mode = \"w:gz\" if compression else \"w\"\n    fileobj = None if name else BytesIO()\n    with tarfile.open(name=name, mode=mode, fileobj=fileobj) as tar:\n        for obj in object_list:\n            if obj.filename:\n                tar.add(obj.filename, obj.object_name)\n            else:\n                info = tarfile.TarInfo(obj.object_name)\n                info.size = cast(int, obj.length)\n                info.mtime = int(\n                    time.to_float(obj.mod_time or time.utcnow()),\n                )\n                tar.addfile(info, obj.data)\n\n    if not name:\n        length = cast(BytesIO, fileobj).tell()\n        cast(BytesIO, fileobj).seek(0)\n    else:\n        length = os.stat(name).st_size\n\n    part_size = 0 if length < MIN_PART_SIZE else length\n\n    if name:\n        return self.fput_object(\n            bucket_name,\n            object_name,\n            cast(str, staging_filename),\n            metadata=metadata,\n            sse=sse,\n            tags=tags,\n            retention=retention,\n            legal_hold=legal_hold,\n            part_size=part_size,\n        )\n    return self.put_object(\n        bucket_name,\n        object_name,\n        cast(BinaryIO, fileobj),\n        length,\n        metadata=cast(Union[DictType, None], metadata),\n        sse=sse,\n        tags=tags,\n        retention=retention,\n        legal_hold=legal_hold,\n        part_size=part_size,\n    )",
    "hash_value": "6697cbefd771a4d3bbc6496849bc34d7"
  }
]