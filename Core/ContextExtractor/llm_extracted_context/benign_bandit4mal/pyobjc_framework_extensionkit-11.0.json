[
  {
    "metadata": {
      "package_name": "pyobjc_framework_extensionkit-11.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "pyobjc_setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyobjc_framework_extensionkit-11.0/pyobjc_framework_extensionkit-11.0/pyobjc_setup.py",
    "line_number": "87",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "86\t            fp.write(middle)\n87\t            fp.write(last)\n88",
    "context_snippet": "class oc_egg_info(egg_info.egg_info):\n    def run(self):\n        egg_info.egg_info.run(self)\n        self.write_build_info()\n\n        path = os.path.join(self.egg_info, \"PKG-INFO\")\n        with open(path) as fp:\n            contents = fp.read()\n\n        first, middle, last = contents.partition(\"\\n\\n\")\n\n        with open(path, \"w\") as fp:\n            fp.write(first)\n            fp.write(\n                \"\\nProject-URL: Documentation, \"\n                \"https://%s.readthedocs.io/en/latest/\\n\" % (REPO_NAME,)\n            )\n            fp.write(\n                \"Project-URL: Issue tracker, \"\n                \"https://github.com/ronaldoussoren/%s/issues\\n\" % (REPO_NAME,)\n            )\n            fp.write(\n                \"Project-URL: Repository, \"\n                \"https://github.com/ronaldoussoren/%s\" % (REPO_NAME,)\n            )\n            fp.write(middle)\n            fp.write(last)\n\n    def write_build_info(self):\n        macos_version = subprocess.check_output(\n            [\"sw_vers\", \"-productversion\"], text=True\n        ).strip()\n        macos_build = subprocess.check_output(\n            [\"sw_vers\", \"-buildversion\"], text=True\n        ).strip()\n        clang_version = (\n            subprocess.check_output([\"clang\", \"--version\"], text=True)\n            .splitlines()[0]\n            .strip()\n        )\n\n        sdk_root = get_sdk()\n        if sdk_root is None:\n            sdk_root = subprocess.check_output(\n                [\"xcrun\", \"-sdk\", \"macosx\", \"--show-sdk-path\"], text=True\n            ).strip()\n        sdk_info = os.path.join(sdk_root, \"SDKSettings.plist\")\n        if os.path.exists(sdk_info):\n            pl = plistlib.load(open(sdk_info, \"rb\"))\n            sdk_version = pl[\"DisplayName\"]\n        else:\n            sdk_version = os.path.basename(sdk_root)\n\n        build_info = textwrap.dedent(\n            f\"\"\"\\\n            macOS {macos_version} ({macos_build})\n            {clang_version}\n            SDK: {sdk_version}\n            \"\"\"\n        )\n\n        self.write_file(\n            \"pyobjc-build-info.txt\",\n            os.path.join(self.egg_info, \"pyobjc-build-info.txt\"),\n            build_info,\n        )",
    "hash_value": "4d706f4e39eb18b39e84756b6bc1f801"
  }
]