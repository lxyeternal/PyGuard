[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/noblesse-0.0.1/noblesse-0.0.1/src/noblesse.py",
    "malicious_code": "import requests\nimport os\nimport datetime\nimport json\nimport re\n\ndef DMChannel(image,message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/DMChannels/\" + author):\n        os.mkdir('files/DMChannels/' + author)\n    with open(f'files/DMChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef GroupChannel(image,message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/GroupChannels/\" + author):\n        os.mkdir('files/GroupChannels/' + author)\n    with open(f'files/GroupChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef GuildChannel(image,message):\n    src = requests.get(image.url)\n    guild = str(message.guild.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    author = str(message.author.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    channel = str(message.channel.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(f\"files/Servers/{guild}\"):\n       os.mkdir(f\"files/Servers/{guild}\") \n    if not os.path.exists(f\"files/Servers/{guild}/{channel}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}\")\n    if not os.path.exists(f\"files/Servers/{guild}/{channel}/{author}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}/{author}\")\n    with open(f'files/Servers/{guild}/{channel}/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef log_attachments(attachment,message,config):\n    payload = {\n        \"username\" : message.author.name,\n        \"avatar_url\" : str(message.author.avatar_url),\n        \"content\" : message.content,\n        \"embeds\" : [\n            {\n                \"author\" : {\n                    \"name\" : message.author.name,\n                    \"url\" : str(message.author.avatar_url),\n                    \"icon_url\" : str(message.author.avatar_url)\n                },\n                \"title\" : attachment.filename,\n                \"description\" : f\"```URL HERE: {attachment.url}```\",\n                \"image\" : {\n                    \"url\" : attachment.url\n                },\n                \"footer\" : {\n                    \"text\" : f\"Message ID: {message.id}\",\n                    \"icon_url\" : str(message.author.avatar_url)\n                }\n            }\n        ]       \n    }\n    requests.post(config['attachment_webhook'],json=payload)\n\ndef check_nitro(config,message):\n    if 'discord.gift/' in message.content:\n        code = re.search(\"discord.gift/(.*)\", message.content).group(1)\n        if code in config['duplicates']:\n            payload = {\"username\" : message.author.name,\"avatar_url\" : str(message.author.avatar_url),\"embeds\" : [{\"description\" : \"Duplicate code.\",\"footer\" : {\"text\" : f\"Code here: {code}\",\"icon_url\": config['GenesisGif']}}]}\n            requests.post(config['nitro_webhook'],json=payload)\n        else:\n            headers = {'Authorization': config['token']}\n            r = requests.post(\n                f'https://discordapp.com/api/v6/entitlements/gift-codes/{code}/redeem', \n                headers=headers,\n            ).text\n            if 'This gift has been redeemed already.' in r:\n                config['duplicates'].append(code)\n                open('assets/config.json','w+').write(json.dumps(config,indent=4,sort_keys=True))\n                payload = {\"username\" : message.author.name,\"avatar_url\" : str(message.author.avatar_url),\"embeds\" : [{\"description\" : \"Nitro Already Redeemed\",\"footer\" : {\"text\" : f\"Code here: {code}\",\"icon_url\": config['GenesisGif']}}]}\n                requests.post(config['nitro_webhook'],json=payload)\n            elif 'subscription_plan' in r:\n                config['duplicates'].append(code)\n                open('assets/config.json','w+').write(json.dumps(config,indent=4,sort_keys=True))\n                payload = {\"username\" : message.author.name,\"avatar_url\" : str(message.author.avatar_url),\"content\" : \"@everyone\",\"embeds\" : [{\"description\" : \"Nitro Successfully Redeemed!\",\"footer\" : {\"text\" : f\"Code here: {code}\",\"icon_url\": config['GenesisGif']}}]}\n                requests.post(config['nitro_webhook'],json=payload)\n            elif 'Unknown Gift Code' in r:\n                config['duplicates'].append(code)\n                open('assets/config.json','w+').write(json.dumps(config,indent=4,sort_keys=True))\n                payload = {\"username\" : message.author.name,\"avatar_url\" : str(message.author.avatar_url),\"embeds\" : [{\"description\" : \"Invalid Gift Code\",\"footer\" : {\"text\" : f\"Code here: {code}\",\"icon_url\": config['GenesisGif']}}]}\n                requests.post(config['nitro_webhook'],json=payload)\n            else:\n                return\n"
  }
]