[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35mLOCKOUT_TEMPLATE = get_setting("DEFENDER_LOCKOUT_TEMPLATE")[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35mERROR_MESSAGE = gettext_lazy([0m
[30;1m88 | [0m[35m    "Please enter a correct username and password. "[0m
[30;1m89 | [0m[35m    "Note that both fields are case-sensitive."[0m
[30;1m90 | [0m[35m)[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m12 | [0m[35mDEFENDER_REDIS_URL = get_setting("DEFENDER_REDIS_URL")[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m# redis password quote for special character[0m
[30;1m15 | [0m[35mDEFENDER_REDIS_PASSWORD_QUOTE = get_setting("DEFENDER_REDIS_PASSWORD_QUOTE", False)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m# reuse declared cache from django settings[0m
[30;1m18 | [0m[35mDEFENDER_REDIS_NAME = get_setting("DEFENDER_REDIS_NAME")[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m12 | [0m[35mDEFENDER_REDIS_URL = get_setting("DEFENDER_REDIS_URL")[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m# redis password quote for special character[0m
[30;1m15 | [0m[35mDEFENDER_REDIS_PASSWORD_QUOTE = get_setting("DEFENDER_REDIS_PASSWORD_QUOTE", False)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m# reuse declared cache from django settings[0m
[30;1m18 | [0m[35mDEFENDER_REDIS_NAME = get_setting("DEFENDER_REDIS_NAME")[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11 | [0m[35m# redis server host[0m
[30;1m12 | [0m[35mDEFENDER_REDIS_URL = get_setting("DEFENDER_REDIS_URL")[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m# redis password quote for special character[0m
[30;1m15 | [0m[35mDEFENDER_REDIS_PASSWORD_QUOTE = get_setting("DEFENDER_REDIS_PASSWORD_QUOTE", False)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m# reuse declared cache from django settings[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/exampleapp/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m    "django.contrib.staticfiles.finders.AppDirectoriesFinder",[0m
[30;1m52 | [0m[35m)[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/exampleapp/settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m    "django.contrib.staticfiles.finders.AppDirectoriesFinder",[0m
[30;1m52 | [0m[35m)[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/exampleapp/settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m51 | [0m[35m    "django.contrib.staticfiles.finders.AppDirectoriesFinder",[0m
[30;1m52 | [0m[35m)[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/exampleapp/readme.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1 | [0m[35mExample App[0m
[30;1m2 | [0m[35m===========[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35madmin password is ``admin:password``[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mThis is just a simple example app, used for testing and showing how things work[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/exampleapp/readme.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1 | [0m[35mExample App[0m
[30;1m2 | [0m[35m===========[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35madmin password is ``admin:password``[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mThis is just a simple example app, used for testing and showing how things work[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1197 | [0m[35m        connection.acl_setuser([0m
[30;1m1198 | [0m[35m            'myname',[0m
[30;1m1199 | [0m[35m            enabled=True,[0m
[30;1m1200 | [0m[35m            passwords=["+" + "mypass2", ],[0m
[30;1m1201 | [0m[35m            keys="*",[0m
[30;1m1202 | [0m[35m            commands=["+@all", ])[0m
[30;1m1203 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1187 | [0m[35m    @patch("defender.config.DEFENDER_REDIS_URL", REDIS_URL_NAME_PASS)[0m
[30;1m1188 | [0m[35m    @patch("defender.config.MOCK_REDIS", False)[0m
[30;1m1189 | [0m[35m    def test_get_redis_connection_with_acl(self):[0m
[30;1m1190 | [0m[35m        """ get redis connection with password and name ACL """[0m
[30;1m1191 | [0m[35m        connection = redis.Redis()[0m
[30;1m1192 | [0m[35m[0m
[30;1m1193 | [0m[35m        if connection.info().get('redis_version') < '6':[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1170 | [0m[35m    @patch("defender.config.DEFENDER_REDIS_URL", REDIS_URL_PASS)[0m
[30;1m1171 | [0m[35m    @patch("defender.config.MOCK_REDIS", False)[0m
[30;1m1172 | [0m[35m    def test_get_redis_connection_with_password(self):[0m
[30;1m1173 | [0m[35m        """ get redis connection with password """[0m
[30;1m1174 | [0m[35m[0m
[30;1m1175 | [0m[35m        connection = redis.Redis()[0m
[30;1m1176 | [0m[35m        connection.config_set('requirepass', 'mypass')[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1169 | [0m[35m[0m
[30;1m1170 | [0m[35m    @patch("defender.config.DEFENDER_REDIS_URL", REDIS_URL_PASS)[0m
[30;1m1171 | [0m[35m    @patch("defender.config.MOCK_REDIS", False)[0m
[30;1m1172 | [0m[35m    def test_get_redis_connection_with_password(self):[0m
[30;1m1173 | [0m[35m        """ get redis connection with password """[0m
[30;1m1174 | [0m[35m[0m
[30;1m1175 | [0m[35m        connection = redis.Redis()[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m659 | [0m[35m        self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m660 | [0m[35m[0m
[30;1m661 | [0m[35m        # Successful login should not clear IP lock[0m
[30;1m662 | [0m[35m        self._login(username=VALID_USERNAME, password=VALID_PASSWORD)[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m        # We should still be locked out for the locked[0m
[30;1m665 | [0m[35m        # username using the same IP[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m659 | [0m[35m        self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m660 | [0m[35m[0m
[30;1m661 | [0m[35m        # Successful login should not clear IP lock[0m
[30;1m662 | [0m[35m        self._login(username=VALID_USERNAME, password=VALID_PASSWORD)[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m        # We should still be locked out for the locked[0m
[30;1m665 | [0m[35m        # username using the same IP[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m309 | [0m[35m        """[0m
[30;1m310 | [0m[35m        long_user_agent = "ie6" * 1024[0m
[30;1m311 | [0m[35m        response = self._login([0m
[30;1m312 | [0m[35m            username=VALID_USERNAME, password=VALID_PASSWORD, user_agent=long_user_agent[0m
[30;1m313 | [0m[35m        )[0m
[30;1m314 | [0m[35m        self.assertNotContains(response, LOGIN_FORM_KEY, status_code=302)[0m
[30;1m315 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m309 | [0m[35m        """[0m
[30;1m310 | [0m[35m        long_user_agent = "ie6" * 1024[0m
[30;1m311 | [0m[35m        response = self._login([0m
[30;1m312 | [0m[35m            username=VALID_USERNAME, password=VALID_PASSWORD, user_agent=long_user_agent[0m
[30;1m313 | [0m[35m        )[0m
[30;1m314 | [0m[35m        self.assertNotContains(response, LOGIN_FORM_KEY, status_code=302)[0m
[30;1m315 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m228 | [0m[35m            self._login(username=VALID_USERNAME)[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m        # now login with a valid username and password[0m
[30;1m231 | [0m[35m        self._login(username=VALID_USERNAME, password=VALID_PASSWORD)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        # and we should be able to try again without hitting the failure limit[0m
[30;1m234 | [0m[35m        response = self._login(username=VALID_USERNAME)[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m228 | [0m[35m            self._login(username=VALID_USERNAME)[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m        # now login with a valid username and password[0m
[30;1m231 | [0m[35m        self._login(username=VALID_USERNAME, password=VALID_PASSWORD)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        # and we should be able to try again without hitting the failure limit[0m
[30;1m234 | [0m[35m        response = self._login(username=VALID_USERNAME)[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m227 | [0m[35m        for i in range(0, config.FAILURE_LIMIT):[0m
[30;1m228 | [0m[35m            self._login(username=VALID_USERNAME)[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m        # now login with a valid username and password[0m
[30;1m231 | [0m[35m        self._login(username=VALID_USERNAME, password=VALID_PASSWORD)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        # and we should be able to try again without hitting the failure limit[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m218 | [0m[35m    def test_valid_login(self):[0m
[30;1m219 | [0m[35m        """ Tests a valid login for a real username[0m
[30;1m220 | [0m[35m        """[0m
[30;1m221 | [0m[35m        response = self._login(username=VALID_USERNAME, password=VALID_PASSWORD)[0m
[30;1m222 | [0m[35m        self.assertNotContains(response, LOGIN_FORM_KEY, status_code=302)[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    def test_reset_after_valid_login(self):[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m218 | [0m[35m    def test_valid_login(self):[0m
[30;1m219 | [0m[35m        """ Tests a valid login for a real username[0m
[30;1m220 | [0m[35m        """[0m
[30;1m221 | [0m[35m        response = self._login(username=VALID_USERNAME, password=VALID_PASSWORD)[0m
[30;1m222 | [0m[35m        self.assertNotContains(response, LOGIN_FORM_KEY, status_code=302)[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    def test_reset_after_valid_login(self):[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m        """ Create a valid user for login[0m
[30;1m81 | [0m[35m        """[0m
[30;1m82 | [0m[35m        self.user = User.objects.create_superuser([0m
[30;1m83 | [0m[35m            username=VALID_USERNAME, email="test@example.com", password=VALID_PASSWORD,[0m
[30;1m84 | [0m[35m        )[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    def test_data_integrity_of_get_blocked_ips(self):[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m        """ Create a valid user for login[0m
[30;1m81 | [0m[35m        """[0m
[30;1m82 | [0m[35m        self.user = User.objects.create_superuser([0m
[30;1m83 | [0m[35m            username=VALID_USERNAME, email="test@example.com", password=VALID_PASSWORD,[0m
[30;1m84 | [0m[35m        )[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    def test_data_integrity_of_get_blocked_ips(self):[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        response = self.client.post([0m
[30;1m71 | [0m[35m            ADMIN_LOGIN_URL,[0m
[30;1m72 | [0m[35m            {"username": username, "password": password, LOGIN_FORM_KEY: 1,},[0m
[30;1m73 | [0m[35m            HTTP_USER_AGENT=user_agent,[0m
[30;1m74 | [0m[35m            REMOTE_ADDR=remote_addr,[0m
[30;1m75 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        response = self.client.post([0m
[30;1m71 | [0m[35m            ADMIN_LOGIN_URL,[0m
[30;1m72 | [0m[35m            {"username": username, "password": password, LOGIN_FORM_KEY: 1,},[0m
[30;1m73 | [0m[35m            HTTP_USER_AGENT=user_agent,[0m
[30;1m74 | [0m[35m            REMOTE_ADDR=remote_addr,[0m
[30;1m75 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m            username = self._get_random_str()[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        if password is None:[0m
[30;1m68 | [0m[35m            password = self._get_random_str()[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        response = self.client.post([0m
[30;1m71 | [0m[35m            ADMIN_LOGIN_URL,[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m64 | [0m[35m        if username is None:[0m
[30;1m65 | [0m[35m            username = self._get_random_str()[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        if password is None:[0m
[30;1m68 | [0m[35m            password = self._get_random_str()[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        response = self.client.post([0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m    ):[0m
[30;1m60 | [0m[35m        """ Login a user. If the username or password is not provided[0m
[30;1m61 | [0m[35m        it will use a random string instead. Use the VALID_USERNAME and[0m
[30;1m62 | [0m[35m        VALID_PASSWORD to make a valid login.[0m
[30;1m63 | [0m[35m        """[0m
[30;1m64 | [0m[35m        if username is None:[0m
[30;1m65 | [0m[35m            username = self._get_random_str()[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m        user_agent="test-browser",[0m
[30;1m58 | [0m[35m        remote_addr="127.0.0.1",[0m
[30;1m59 | [0m[35m    ):[0m
[30;1m60 | [0m[35m        """ Login a user. If the username or password is not provided[0m
[30;1m61 | [0m[35m        it will use a random string instead. Use the VALID_USERNAME and[0m
[30;1m62 | [0m[35m        VALID_PASSWORD to make a valid login.[0m
[30;1m63 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m53 | [0m[35m    def _login([0m
[30;1m54 | [0m[35m        self,[0m
[30;1m55 | [0m[35m        username=None,[0m
[30;1m56 | [0m[35m        password=None,[0m
[30;1m57 | [0m[35m        user_agent="test-browser",[0m
[30;1m58 | [0m[35m        remote_addr="127.0.0.1",[0m
[30;1m59 | [0m[35m    ):[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35mLOGIN_FORM_KEY = '<form action="/admin/login/" method="post" id="login-form">'[0m
[30;1m32 | [0m[35mADMIN_LOGIN_URL = reverse("admin:login")[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mVALID_USERNAME = VALID_PASSWORD = "valid"[0m
[30;1m35 | [0m[35mUPPER_USERNAME = "VALID"[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/ci_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m    },[0m
[30;1m52 | [0m[35m][0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/ci_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m    },[0m
[30;1m52 | [0m[35m][0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/ci_settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m51 | [0m[35m    },[0m
[30;1m52 | [0m[35m][0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/test_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m    },[0m
[30;1m49 | [0m[35m][0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/test_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m    },[0m
[30;1m49 | [0m[35m][0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/defender/test_settings.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m48 | [0m[35m    },[0m
[30;1m49 | [0m[35m][0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35mCACHE_PREFIX = get_setting("DEFENDER_CACHE_PREFIX", "defender")[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m# if the django app is behind a reverse proxy, look for the[0m
[30;1m51 | [0m[35m# ip address using this HTTP header value[0m
[30;1m52 | [0m[35mREVERSE_PROXY_HEADER = get_setting([0m
[30;1m53 | [0m[35m    "DEFENDER_REVERSE_PROXY_HEADER", "HTTP_X_FORWARDED_FOR"[0m
[30;1m54 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m# the username failure limit has been reached before issuing the lockout.[0m
[30;1m31 | [0m[35mLOCKOUT_BY_IP_USERNAME = get_setting("DEFENDER_LOCK_OUT_BY_IP_AND_USERNAME", False)[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m# if this is True, The users IP address will not get locked when[0m
[30;1m34 | [0m[35m# there are too many login attempts.[0m
[30;1m35 | [0m[35mDISABLE_IP_LOCKOUT = get_setting("DEFENDER_DISABLE_IP_LOCKOUT", False)[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m)[0m
[30;1m27 | [0m[35mIP_FAILURE_LIMIT = get_setting("DEFENDER_LOGIN_FAILURE_LIMIT_IP", FAILURE_LIMIT)[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m# If this is True, the lockout checks to evaluate if the IP failure limit and[0m
[30;1m30 | [0m[35m# the username failure limit has been reached before issuing the lockout.[0m
[30;1m31 | [0m[35mLOCKOUT_BY_IP_USERNAME = get_setting("DEFENDER_LOCK_OUT_BY_IP_AND_USERNAME", False)[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m80 | [0m[35m        except (TypeError, ValueError):  # pragma: no cover[0m
[30;1m81 | [0m[35m            raise Exception("DEFENDER_LOCKOUT_COOLOFF_TIME needs to be an integer or list of integer[0m
[30;1m82 | [0m[35m    except ValueError:  # pragma: no cover[0m
[30;1m83 | [0m[35m        raise Exception("DEFENDER_LOCKOUT_COOLOFF_TIME needs to be an integer or list of integers ha[0m
[30;1m84 | [0m[35mexcept ValueError:  # pragma: no cover[0m
[30;1m85 | [0m[35m    raise Exception("DEFENDER_COOLOFF_TIME needs to be an integer")  # pragma: no cover[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m            LOCKOUT_COOLOFF_TIMES = cooloff_times[0m
[30;1m78 | [0m[35m        except (TypeError, ValueError):  # pragma: no cover[0m
[30;1m79 | [0m[35m            raise Exception("DEFENDER_LOCKOUT_COOLOFF_TIME needs to be an integer or list of integer[0m
[30;1m80 | [0m[35m    except ValueError:  # pragma: no cover[0m
[30;1m81 | [0m[35m        raise Exception("DEFENDER_LOCKOUT_COOLOFF_TIME needs to be an integer or list of integers ha[0m
[30;1m82 | [0m[35mexcept ValueError:  # pragma: no cover[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/exampleapp/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m    "django.contrib.staticfiles.finders.AppDirectoriesFinder",[0m
[30;1m52 | [0m[35m)[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/exampleapp/settings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m    "defender",[0m
[30;1m45 | [0m[35m][0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m# List of finder classes that know how to find static files in[0m
[30;1m48 | [0m[35m# various locations.[0m
[30;1m49 | [0m[35mSTATICFILES_FINDERS = ([0m
[30;1m50 | [0m[35m    "django.contrib.staticfiles.finders.FileSystemFinder",[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1205 | [0m[35m            redis_client = get_redis_connection()[0m
[30;1m1206 | [0m[35m            self.assertIsInstance(redis_client, Redis)[0m
[30;1m1207 | [0m[35m            redis_client.set('test3', 0)[0m
[30;1m1208 | [0m[35m            result = int(redis_client.get('test3'))[0m
[30;1m1209 | [0m[35m            self.assertEqual(result, 0)[0m
[30;1m1210 | [0m[35m            redis_client.delete('test3')[0m
[30;1m1211 | [0m[35m        except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1190 | [0m[35m        """ get redis connection with password and name ACL """[0m
[30;1m1191 | [0m[35m        connection = redis.Redis()[0m
[30;1m1192 | [0m[35m[0m
[30;1m1193 | [0m[35m        if connection.info().get('redis_version') < '6':[0m
[30;1m1194 | [0m[35m            # redis versions before 6 don't have acl, so skip.[0m
[30;1m1195 | [0m[35m            return[0m
[30;1m1196 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1178 | [0m[35m        redis_client = get_redis_connection()[0m
[30;1m1179 | [0m[35m        self.assertIsInstance(redis_client, Redis)[0m
[30;1m1180 | [0m[35m        redis_client.set('test2', 0)[0m
[30;1m1181 | [0m[35m        result = int(redis_client.get('test2'))[0m
[30;1m1182 | [0m[35m        self.assertEqual(result, 0)[0m
[30;1m1183 | [0m[35m        redis_client.delete('test2')[0m
[30;1m1184 | [0m[35m        # clean up[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1163 | [0m[35m        redis_client = get_redis_connection()[0m
[30;1m1164 | [0m[35m        self.assertIsInstance(redis_client, Redis)[0m
[30;1m1165 | [0m[35m        redis_client.set('test', 0)[0m
[30;1m1166 | [0m[35m        result = int(redis_client.get('test'))[0m
[30;1m1167 | [0m[35m        self.assertEqual(result, 0)[0m
[30;1m1168 | [0m[35m        redis_client.delete('test')[0m
[30;1m1169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1100 | [0m[35m        """ test that the optional username argument has highest precedence[0m
[30;1m1101 | [0m[35m        when provided """[0m
[30;1m1102 | [0m[35m        request_factory = RequestFactory()[0m
[30;1m1103 | [0m[35m        request = request_factory.get(ADMIN_LOGIN_URL)[0m
[30;1m1104 | [0m[35m        request.user = AnonymousUser()[0m
[30;1m1105 | [0m[35m        request.session = SessionStore()[0m
[30;1m1106 | [0m[35m        username = "johndoe"[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1071 | [0m[35m    def test_second_incr(self):[0m
[30;1m1072 | [0m[35m        """ second increment """[0m
[30;1m1073 | [0m[35m        utils.REDIS_SERVER.incr(self.key)[0m
[30;1m1074 | [0m[35m        result = int(utils.REDIS_SERVER.get(self.key))[0m
[30;1m1075 | [0m[35m        self.assertEqual(result, 1)[0m
[30;1m1076 | [0m[35m[0m
[30;1m1077 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1065 | [0m[35m    def test_first_incr(self):[0m
[30;1m1066 | [0m[35m        """ first increment """[0m
[30;1m1067 | [0m[35m        utils.REDIS_SERVER.incr(self.key)[0m
[30;1m1068 | [0m[35m        result = int(utils.REDIS_SERVER.get(self.key))[0m
[30;1m1069 | [0m[35m        self.assertEqual(result, 1)[0m
[30;1m1070 | [0m[35m[0m
[30;1m1071 | [0m[35m    def test_second_incr(self):[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1053 | [0m[35m    def test_second_incr(self):[0m
[30;1m1054 | [0m[35m        """ second increment """[0m
[30;1m1055 | [0m[35m        utils.REDIS_SERVER.incr(self.key)[0m
[30;1m1056 | [0m[35m        result = int(utils.REDIS_SERVER.get(self.key))[0m
[30;1m1057 | [0m[35m        self.assertEqual(result, 1)[0m
[30;1m1058 | [0m[35m[0m
[30;1m1059 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1047 | [0m[35m    def test_first_incr(self):[0m
[30;1m1048 | [0m[35m        """ first increment """[0m
[30;1m1049 | [0m[35m        utils.REDIS_SERVER.incr(self.key)[0m
[30;1m1050 | [0m[35m        result = int(utils.REDIS_SERVER.get(self.key))[0m
[30;1m1051 | [0m[35m        self.assertEqual(result, 1)[0m
[30;1m1052 | [0m[35m[0m
[30;1m1053 | [0m[35m    def test_second_incr(self):[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m880 | [0m[35m        wrong_email = "email@localhost"[0m
[30;1m881 | [0m[35m[0m
[30;1m882 | [0m[35m        request_factory = RequestFactory()[0m
[30;1m883 | [0m[35m        request = request_factory.post("api/login", data={"email": wrong_email})[0m
[30;1m884 | [0m[35m        request.user = AnonymousUser()[0m
[30;1m885 | [0m[35m        request.session = SessionStore()[0m
[30;1m886 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m872 | [0m[35m        Check that a view with custom username blocked correctly[0m
[30;1m873 | [0m[35m        """[0m
[30;1m874 | [0m[35m[0m
[30;1m875 | [0m[35m        @watch_login(status_code=401, get_username=lambda request: request.POST.get("email"))[0m
[30;1m876 | [0m[35m        def fake_api_401_login_different_username(request):[0m
[30;1m877 | [0m[35m            """ Fake the api login with 401 """[0m
[30;1m878 | [0m[35m            return HttpResponse("Invalid", status=401)[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m853 | [0m[35m            return HttpResponse("Ups, wrong credentials", status=401)[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m        request_factory = RequestFactory()[0m
[30;1m856 | [0m[35m        request = request_factory.post("api/login")[0m
[30;1m857 | [0m[35m        request.user = AnonymousUser()[0m
[30;1m858 | [0m[35m        request.session = SessionStore()[0m
[30;1m859 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m822 | [0m[35m            return HttpResponse("Sorry, Invalid credentials", status=401)[0m
[30;1m823 | [0m[35m[0m
[30;1m824 | [0m[35m        request_factory = RequestFactory()[0m
[30;1m825 | [0m[35m        request = request_factory.post("api/login")[0m
[30;1m826 | [0m[35m        request.user = AnonymousUser()[0m
[30;1m827 | [0m[35m        request.session = SessionStore()[0m
[30;1m828 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m791 | [0m[35m            return HttpResponse(status=401)[0m
[30;1m792 | [0m[35m[0m
[30;1m793 | [0m[35m        request_factory = RequestFactory()[0m
[30;1m794 | [0m[35m        request = request_factory.post("api/login")[0m
[30;1m795 | [0m[35m        request.user = AnonymousUser()[0m
[30;1m796 | [0m[35m        request.session = SessionStore()[0m
[30;1m797 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m755 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m756 | [0m[35m[0m
[30;1m757 | [0m[35m        # We shouldn't get a lockout message when attempting to use no username[0m
[30;1m758 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m759 | [0m[35m        self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m        # We shouldn't get a lockout message when attempting to use a[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m702 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m        # We shouldn't get a lockout message when attempting to use no username[0m
[30;1m705 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m706 | [0m[35m        self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m707 | [0m[35m[0m
[30;1m708 | [0m[35m        # We shouldn't get a lockout message when attempting to use a[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m650 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m651 | [0m[35m[0m
[30;1m652 | [0m[35m        # We shouldn't get a lockout message when attempting to use no username[0m
[30;1m653 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m654 | [0m[35m        self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m655 | [0m[35m[0m
[30;1m656 | [0m[35m        # We shouldn't get a lockout message when attempting to use a[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m613 | [0m[35m            response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m614 | [0m[35m            # Check if we are in the same login page[0m
[30;1m615 | [0m[35m            self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m616 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m617 | [0m[35m        self.assertNotContains(response, self.LOCKED_MESSAGE)[0m
[30;1m618 | [0m[35m[0m
[30;1m619 | [0m[35m    @patch("defender.config.USE_CELERY", True)[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m607 | [0m[35m    def test_get_view(self):[0m
[30;1m608 | [0m[35m        """ Check that the decorator doesn't tamper with GET requests """[0m
[30;1m609 | [0m[35m        for i in range(0, config.FAILURE_LIMIT):[0m
[30;1m610 | [0m[35m            response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m611 | [0m[35m            # Check if we are in the same login page[0m
[30;1m612 | [0m[35m            self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m613 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m601 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35m        # doing a get should also get locked out message[0m
[30;1m604 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m605 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m606 | [0m[35m[0m
[30;1m607 | [0m[35m    def test_get_view(self):[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m445 | [0m[35m        self.assertContains(response, self.PERMANENT_LOCKED_MESSAGE)[0m
[30;1m446 | [0m[35m[0m
[30;1m447 | [0m[35m        # doing a get should also get locked out message[0m
[30;1m448 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m449 | [0m[35m        self.assertContains(response, self.PERMANENT_LOCKED_MESSAGE)[0m
[30;1m450 | [0m[35m[0m
[30;1m451 | [0m[35m    def test_login_attempt_model(self):[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m426 | [0m[35m        self.assertTemplateUsed(response, "defender/lockout.html")[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m        # doing a get should also get locked out message[0m
[30;1m429 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m430 | [0m[35m        self.assertEqual(response.status_code, 200)[0m
[30;1m431 | [0m[35m        self.assertTemplateUsed(response, "defender/lockout.html")[0m
[30;1m432 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m        self.assertEqual(response["Location"], lockout_url)[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        # doing a get should also get locked out message[0m
[30;1m408 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m409 | [0m[35m        self.assertEqual(response.status_code, 302)[0m
[30;1m410 | [0m[35m        self.assertEqual(response["Location"], lockout_url)[0m
[30;1m411 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m382 | [0m[35m        self.assertEqual(response["Location"], "http://localhost/othe/login/")[0m
[30;1m383 | [0m[35m[0m
[30;1m384 | [0m[35m        # doing a get should also get locked out message[0m
[30;1m385 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m386 | [0m[35m        self.assertEqual(response.status_code, 302)[0m
[30;1m387 | [0m[35m        self.assertEqual(response["Location"], "http://localhost/othe/login/")[0m
[30;1m388 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m        """ Tests if can handle a long user agent[0m
[30;1m339 | [0m[35m        """[0m
[30;1m340 | [0m[35m        request_factory = RequestFactory()[0m
[30;1m341 | [0m[35m        request = request_factory.get(ADMIN_LOGIN_URL)[0m
[30;1m342 | [0m[35m        request.user = AnonymousUser()[0m
[30;1m343 | [0m[35m        request.session = SessionStore()[0m
[30;1m344 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m        self.assertEqual(utils.get_ip(request), "192.168.24.24")[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m        request_factory = RequestFactory()[0m
[30;1m330 | [0m[35m        request = request_factory.get(ADMIN_LOGIN_URL)[0m
[30;1m331 | [0m[35m        request.user = AnonymousUser()[0m
[30;1m332 | [0m[35m        request.session = SessionStore()[0m
[30;1m333 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m        """ Tests if can handle a long user agent[0m
[30;1m320 | [0m[35m        """[0m
[30;1m321 | [0m[35m        request_factory = RequestFactory()[0m
[30;1m322 | [0m[35m        request = request_factory.get(ADMIN_LOGIN_URL)[0m
[30;1m323 | [0m[35m        request.user = AnonymousUser()[0m
[30;1m324 | [0m[35m        request.session = SessionStore()[0m
[30;1m325 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        # doing a get should also get locked out message[0m
[30;1m215 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m216 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    def test_valid_login(self):[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m        # doing a get should not get locked out message[0m
[30;1m195 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m196 | [0m[35m        self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    @patch("defender.config.IP_FAILURE_LIMIT", 3)[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m        # doing a get should also get locked out message[0m
[30;1m175 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m176 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    @patch("defender.config.USERNAME_FAILURE_LIMIT", 3)[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m            self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m        # doing a get should also get locked out message[0m
[30;1m156 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m157 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m    def test_failure_limit_by_username_once(self):[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        # doing a get should also get locked out message[0m
[30;1m136 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m137 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    def test_failure_limit_by_ip_many(self):[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    def test_login_get(self):[0m
[30;1m117 | [0m[35m        """ visit the login page """[0m
[30;1m118 | [0m[35m        response = self.client.get(ADMIN_LOGIN_URL)[0m
[30;1m119 | [0m[35m        self.assertEqual(response.status_code, 200)[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    def test_failure_limit_by_ip_once(self):[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        if password is None:[0m
[30;1m68 | [0m[35m            password = self._get_random_str()[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        response = self.client.post([0m
[30;1m71 | [0m[35m            ADMIN_LOGIN_URL,[0m
[30;1m72 | [0m[35m            {"username": username, "password": password, LOGIN_FORM_KEY: 1,},[0m
[30;1m73 | [0m[35m            HTTP_USER_AGENT=user_agent,[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1130 | [0m[35m[0m
[30;1m1131 | [0m[35m    @patch("defender.config.BEHIND_REVERSE_PROXY", True)[0m
[30;1m1132 | [0m[35m    def test_get_ip_strips_port_number(self):[0m
[30;1m1133 | [0m[35m        """ make sure the IP address is stripped of its port number """[0m
[30;1m1134 | [0m[35m        req = HttpRequest()[0m
[30;1m1135 | [0m[35m        req.META["HTTP_X_FORWARDED_FOR"] = "1.2.3.4:123456"[0m
[30;1m1136 | [0m[35m        self.assertEqual(utils.get_ip(req), "1.2.3.4")[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1089 | [0m[35m[0m
[30;1m1090 | [0m[35m    def test_ip_address_blocking(self):[0m
[30;1m1091 | [0m[35m        """ ip address blocking """[0m
[30;1m1092 | [0m[35m        ip = "1.2.3.4"[0m
[30;1m1093 | [0m[35m        self.assertFalse(utils.is_source_ip_already_locked(ip))[0m
[30;1m1094 | [0m[35m        utils.block_ip(ip)[0m
[30;1m1095 | [0m[35m        self.assertTrue(utils.is_source_ip_already_locked(ip))[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1088 | [0m[35m        self.assertFalse(utils.is_user_already_locked(username))[0m
[30;1m1089 | [0m[35m[0m
[30;1m1090 | [0m[35m    def test_ip_address_blocking(self):[0m
[30;1m1091 | [0m[35m        """ ip address blocking """[0m
[30;1m1092 | [0m[35m        ip = "1.2.3.4"[0m
[30;1m1093 | [0m[35m        self.assertFalse(utils.is_source_ip_already_locked(ip))[0m
[30;1m1094 | [0m[35m        utils.block_ip(ip)[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m844 | [0m[35m    def test_login_non_blocked_for_non_standard_login_views_different_msg(self):[0m
[30;1m845 | [0m[35m        """[0m
[30;1m846 | [0m[35m        Check that a view wich returns the expected status code but not the[0m
[30;1m847 | [0m[35m        expected message is not causing the IP to be locked out.[0m
[30;1m848 | [0m[35m        """[0m
[30;1m849 | [0m[35m[0m
[30;1m850 | [0m[35m        @watch_login(status_code=401, msg="Invalid credentials")[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m813 | [0m[35m    def test_login_blocked_for_non_standard_login_views_with_msg(self):[0m
[30;1m814 | [0m[35m        """[0m
[30;1m815 | [0m[35m        Check that a view wich returns the expected status code and the[0m
[30;1m816 | [0m[35m        expected message is causing the IP to be locked out.[0m
[30;1m817 | [0m[35m        """[0m
[30;1m818 | [0m[35m[0m
[30;1m819 | [0m[35m        @watch_login(status_code=401, msg="Invalid credentials")[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m781 | [0m[35m    def test_login_blocked_for_non_standard_login_views_without_msg(self):[0m
[30;1m782 | [0m[35m        """[0m
[30;1m783 | [0m[35m        Check that a view wich returns the expected status code is causing[0m
[30;1m784 | [0m[35m        the user to be locked out when we do not expect a specific message[0m
[30;1m785 | [0m[35m        to be returned.[0m
[30;1m786 | [0m[35m        """[0m
[30;1m787 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m759 | [0m[35m        self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m        # We shouldn't get a lockout message when attempting to use a[0m
[30;1m762 | [0m[35m        # different ip address to be sure that username is not blocked.[0m
[30;1m763 | [0m[35m        second_ip = "74.125.127.2"[0m
[30;1m764 | [0m[35m        response = self._login(username=username, remote_addr=second_ip)[0m
[30;1m765 | [0m[35m        # Check if we are in the same login page[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m743 | [0m[35m            self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m744 | [0m[35m[0m
[30;1m745 | [0m[35m        # same ip and same username[0m
[30;1m746 | [0m[35m        ip = "74.125.127.1"[0m
[30;1m747 | [0m[35m        for i in range(0, config.FAILURE_LIMIT):[0m
[30;1m748 | [0m[35m            response = self._login(username=username, remote_addr=ip)[0m
[30;1m749 | [0m[35m            # Check if we are in the same login page[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m742 | [0m[35m            # Check if we are in the same login page[0m
[30;1m743 | [0m[35m            self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m744 | [0m[35m[0m
[30;1m745 | [0m[35m        # same ip and same username[0m
[30;1m746 | [0m[35m        ip = "74.125.127.1"[0m
[30;1m747 | [0m[35m        for i in range(0, config.FAILURE_LIMIT):[0m
[30;1m748 | [0m[35m            response = self._login(username=username, remote_addr=ip)[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m737 | [0m[35m        # try logging in with the same username, but different IPs.[0m
[30;1m738 | [0m[35m        # we shouldn't be locked.[0m
[30;1m739 | [0m[35m        for i in range(0, config.FAILURE_LIMIT + 10):[0m
[30;1m740 | [0m[35m            ip = "74.125.126.{0}".format(i)[0m
[30;1m741 | [0m[35m            response = self._login(username=username, remote_addr=ip)[0m
[30;1m742 | [0m[35m            # Check if we are in the same login page[0m
[30;1m743 | [0m[35m            self.assertContains(response, LOGIN_FORM_KEY)[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m711 | [0m[35m        self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m712 | [0m[35m[0m
[30;1m713 | [0m[35m        # We shouldn't get a lockout message when attempting to use a[0m
[30;1m714 | [0m[35m        # different ip address[0m
[30;1m715 | [0m[35m        second_ip = "74.125.239.99"[0m
[30;1m716 | [0m[35m        response = self._login(username=VALID_USERNAME, remote_addr=second_ip)[0m
[30;1m717 | [0m[35m        # Check if we are in the same login page[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m690 | [0m[35m            self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m691 | [0m[35m[0m
[30;1m692 | [0m[35m        # So, we shouldn't have gotten a lock-out yet.[0m
[30;1m693 | [0m[35m        # same username with same IP[0m
[30;1m694 | [0m[35m        for i in range(0, config.FAILURE_LIMIT):[0m
[30;1m695 | [0m[35m            response = self._login(username=username)[0m
[30;1m696 | [0m[35m            # Check if we are in the same login page[0m
[30;1m697 | [0m[35m            self.assertContains(response, LOGIN_FORM_KEY)[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m682 | [0m[35m        # try logging in with the same IP, but different username[0m
[30;1m683 | [0m[35m        # we shouldn't be blocked.[0m
[30;1m684 | [0m[35m        # same IP different, usernames[0m
[30;1m685 | [0m[35m        ip = "74.125.239.60"[0m
[30;1m686 | [0m[35m        for i in range(0, config.FAILURE_LIMIT + 10):[0m
[30;1m687 | [0m[35m            login_username = "{0}{1}".format(username, i)[0m
[30;1m688 | [0m[35m            response = self._login(username=login_username, remote_addr=ip)[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m681 | [0m[35m[0m
[30;1m682 | [0m[35m        # try logging in with the same IP, but different username[0m
[30;1m683 | [0m[35m        # we shouldn't be blocked.[0m
[30;1m684 | [0m[35m        # same IP different, usernames[0m
[30;1m685 | [0m[35m        ip = "74.125.239.60"[0m
[30;1m686 | [0m[35m        for i in range(0, config.FAILURE_LIMIT + 10):[0m
[30;1m687 | [0m[35m            login_username = "{0}{1}".format(username, i)[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m675 | [0m[35m[0m
[30;1m676 | [0m[35m    @patch("defender.config.DISABLE_IP_LOCKOUT", True)[0m
[30;1m677 | [0m[35m    def test_disable_ip_lockout(self):[0m
[30;1m678 | [0m[35m        """ Check that lockout still works when we disable IP Lock out """[0m
[30;1m679 | [0m[35m[0m
[30;1m680 | [0m[35m        username = "testy"[0m
[30;1m681 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m668 | [0m[35m[0m
[30;1m669 | [0m[35m        # We shouldn't get a lockout message when attempting to use a[0m
[30;1m670 | [0m[35m        # different ip address[0m
[30;1m671 | [0m[35m        ip = "74.125.239.60"[0m
[30;1m672 | [0m[35m        response = self._login(username=VALID_USERNAME, remote_addr=ip)[0m
[30;1m673 | [0m[35m        # Check if we are in the same login page[0m
[30;1m674 | [0m[35m        self.assertContains(response, LOGIN_FORM_KEY)[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m667 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m668 | [0m[35m[0m
[30;1m669 | [0m[35m        # We shouldn't get a lockout message when attempting to use a[0m
[30;1m670 | [0m[35m        # different ip address[0m
[30;1m671 | [0m[35m        ip = "74.125.239.60"[0m
[30;1m672 | [0m[35m        response = self._login(username=VALID_USERNAME, remote_addr=ip)[0m
[30;1m673 | [0m[35m        # Check if we are in the same login page[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m662 | [0m[35m        self._login(username=VALID_USERNAME, password=VALID_PASSWORD)[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m        # We should still be locked out for the locked[0m
[30;1m665 | [0m[35m        # username using the same IP[0m
[30;1m666 | [0m[35m        response = self._login(username=username)[0m
[30;1m667 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m668 | [0m[35m[0m
[30;1m669 | [0m[35m        # We shouldn't get a lockout message when attempting to use a[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m658 | [0m[35m        response = self._login()[0m
[30;1m659 | [0m[35m        self.assertContains(response, LOGIN_FORM_KEY)[0m
[30;1m660 | [0m[35m[0m
[30;1m661 | [0m[35m        # Successful login should not clear IP lock[0m
[30;1m662 | [0m[35m        self._login(username=VALID_USERNAME, password=VALID_PASSWORD)[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m        # We should still be locked out for the locked[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m635 | [0m[35m    @patch("defender.config.LOCKOUT_BY_IP_USERNAME", True)[0m
[30;1m636 | [0m[35m    def test_lockout_by_ip_and_username(self):[0m
[30;1m637 | [0m[35m        """ Check that lockout still works when locking out by[0m
[30;1m638 | [0m[35m           IP and Username combined """[0m
[30;1m639 | [0m[35m[0m
[30;1m640 | [0m[35m        username = "testy"[0m
[30;1m641 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m516 | [0m[35m    @patch("defender.config.BEHIND_REVERSE_PROXY", True)[0m
[30;1m517 | [0m[35m    @patch("defender.config.REVERSE_PROXY_HEADER", "HTTP_X_PROXIED")[0m
[30;1m518 | [0m[35m    def test_get_ip_reverse_proxy_custom_header(self):[0m
[30;1m519 | [0m[35m        """ make sure the ip is correct behind reverse proxy """[0m
[30;1m520 | [0m[35m        req = HttpRequest()[0m
[30;1m521 | [0m[35m        req.META["HTTP_X_PROXIED"] = "1.2.3.4"[0m
[30;1m522 | [0m[35m        self.assertEqual(utils.get_ip(req), "1.2.3.4")[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m510 | [0m[35m        self.assertEqual(ip, "127.0.0.1")[0m
[30;1m511 | [0m[35m[0m
[30;1m512 | [0m[35m        req = HttpRequest()[0m
[30;1m513 | [0m[35m        ip = utils.get_ip_address_from_request(req)[0m
[30;1m514 | [0m[35m        self.assertEqual(ip, "127.0.0.1")[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m    @patch("defender.config.BEHIND_REVERSE_PROXY", True)[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m        req = HttpRequest()[0m
[30;1m508 | [0m[35m        req.META["REMOTE_ADDR"] = "cat"[0m
[30;1m509 | [0m[35m        ip = utils.get_ip_address_from_request(req)[0m
[30;1m510 | [0m[35m        self.assertEqual(ip, "127.0.0.1")[0m
[30;1m511 | [0m[35m[0m
[30;1m512 | [0m[35m        req = HttpRequest()[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m501 | [0m[35m[0m
[30;1m502 | [0m[35m        req = HttpRequest()[0m
[30;1m503 | [0m[35m        req.META["REMOTE_ADDR"] = "192.168.100.34.y"[0m
[30;1m504 | [0m[35m        ip = utils.get_ip_address_from_request(req)[0m
[30;1m505 | [0m[35m        self.assertEqual(ip, "127.0.0.1")[0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m        req = HttpRequest()[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m496 | [0m[35m[0m
[30;1m497 | [0m[35m        req = HttpRequest()[0m
[30;1m498 | [0m[35m        req.META["REMOTE_ADDR"] = "1.2.3.4 "[0m
[30;1m499 | [0m[35m        ip = utils.get_ip_address_from_request(req)[0m
[30;1m500 | [0m[35m        self.assertEqual(ip, "1.2.3.4")[0m
[30;1m501 | [0m[35m[0m
[30;1m502 | [0m[35m        req = HttpRequest()[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m491 | [0m[35m        """ get ip from request, make sure it is correct """[0m
[30;1m492 | [0m[35m        req = HttpRequest()[0m
[30;1m493 | [0m[35m        req.META["REMOTE_ADDR"] = "1.2.3.4"[0m
[30;1m494 | [0m[35m        ip = utils.get_ip_address_from_request(req)[0m
[30;1m495 | [0m[35m        self.assertEqual(ip, "1.2.3.4")[0m
[30;1m496 | [0m[35m[0m
[30;1m497 | [0m[35m        req = HttpRequest()[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m488 | [0m[35m        self.assertRaisesMessage(KeyError, error_msg, get_redis_connection)[0m
[30;1m489 | [0m[35m[0m
[30;1m490 | [0m[35m    def test_get_ip_address_from_request(self):[0m
[30;1m491 | [0m[35m        """ get ip from request, make sure it is correct """[0m
[30;1m492 | [0m[35m        req = HttpRequest()[0m
[30;1m493 | [0m[35m        req.META["REMOTE_ADDR"] = "1.2.3.4"[0m
[30;1m494 | [0m[35m        ip = utils.get_ip_address_from_request(req)[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m359 | [0m[35m        # Make a lockout[0m
[30;1m360 | [0m[35m        self.test_failure_limit_by_ip_once()[0m
[30;1m361 | [0m[35m[0m
[30;1m362 | [0m[35m        # Reset the ip so we can try again[0m
[30;1m363 | [0m[35m        utils.reset_failed_attempts(ip_address="127.0.0.1")[0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m        # Make a login attempt again[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m354 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m    def test_reset_ip(self):[0m
[30;1m357 | [0m[35m        """ Tests if can reset an ip address[0m
[30;1m358 | [0m[35m        """[0m
[30;1m359 | [0m[35m        # Make a lockout[0m
[30;1m360 | [0m[35m        self.test_failure_limit_by_ip_once()[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m301 | [0m[35m    def test_cooling_off_for_trusted_user(self):[0m
[30;1m302 | [0m[35m        """ Test the cooling time for a trusted user[0m
[30;1m303 | [0m[35m        """[0m
[30;1m304 | [0m[35m        # Try the cooling off time[0m
[30;1m305 | [0m[35m        self.test_cooling_off()[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m    def test_long_user_agent_valid(self):[0m
[30;1m308 | [0m[35m        """ Tests if can handle a long user agent[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m299 | [0m[35m        self.test_valid_login()[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m    def test_cooling_off_for_trusted_user(self):[0m
[30;1m302 | [0m[35m        """ Test the cooling time for a trusted user[0m
[30;1m303 | [0m[35m        """[0m
[30;1m304 | [0m[35m        # Try the cooling off time[0m
[30;1m305 | [0m[35m        self.test_cooling_off()[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m286 | [0m[35m        self.assertEqual(utils.lower_username(None), None)[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m    def test_cooling_off(self):[0m
[30;1m289 | [0m[35m        """ Tests if the cooling time allows a user to login[0m
[30;1m290 | [0m[35m        """[0m
[30;1m291 | [0m[35m        self.test_failure_limit_by_ip_once()[0m
[30;1m292 | [0m[35m        # Wait for the cooling off period[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m274 | [0m[35m        """[0m
[30;1m275 | [0m[35m        for username in ["", None]:[0m
[30;1m276 | [0m[35m            for i in range(0, config.FAILURE_LIMIT + 2):[0m
[30;1m277 | [0m[35m                ip = "74.125.239.{0}.".format(i)[0m
[30;1m278 | [0m[35m                self._login(username=username, remote_addr=ip)[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m            self.assertNotIn(username, utils.get_blocked_usernames())[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m        within the cache.[0m
[30;1m263 | [0m[35m        """[0m
[30;1m264 | [0m[35m        for i in range(0, config.FAILURE_LIMIT + 2):[0m
[30;1m265 | [0m[35m            ip = "74.125.239.{0}.".format(i)[0m
[30;1m266 | [0m[35m            self._login(username=UPPER_USERNAME, remote_addr=ip)[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m        self.assertNotIn(UPPER_USERNAME, utils.get_blocked_usernames())[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m252 | [0m[35m            ip = "74.125.239.{0}.".format(i)[0m
[30;1m253 | [0m[35m            self._login(username=VALID_USERNAME, remote_addr=ip)[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m        # try to login with a different ip[0m
[30;1m256 | [0m[35m        response = self._login(username=VALID_USERNAME, remote_addr="8.8.8.8")[0m
[30;1m257 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m    def test_blocked_username_uppercase_saved_lower(self):[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m249 | [0m[35m        another ip[0m
[30;1m250 | [0m[35m        """[0m
[30;1m251 | [0m[35m        for i in range(0, config.FAILURE_LIMIT + 1):[0m
[30;1m252 | [0m[35m            ip = "74.125.239.{0}.".format(i)[0m
[30;1m253 | [0m[35m            self._login(username=VALID_USERNAME, remote_addr=ip)[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m        # try to login with a different ip[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m    def test_blocked_username_cannot_login(self):[0m
[30;1m248 | [0m[35m        """ Test an user with blocked username cannot login using[0m
[30;1m249 | [0m[35m        another ip[0m
[30;1m250 | [0m[35m        """[0m
[30;1m251 | [0m[35m        for i in range(0, config.FAILURE_LIMIT + 1):[0m
[30;1m252 | [0m[35m            ip = "74.125.239.{0}.".format(i)[0m
[30;1m253 | [0m[35m            self._login(username=VALID_USERNAME, remote_addr=ip)[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m235 | [0m[35m        self.assertNotContains(response, self.LOCKED_MESSAGE)[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    def test_blocked_ip_cannot_login(self):[0m
[30;1m238 | [0m[35m        """ Test an user with blocked ip cannot login with another username[0m
[30;1m239 | [0m[35m        """[0m
[30;1m240 | [0m[35m        for i in range(0, config.FAILURE_LIMIT + 1):[0m
[30;1m241 | [0m[35m            self._login(username=VALID_USERNAME)[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m198 | [0m[35m    @patch("defender.config.IP_FAILURE_LIMIT", 3)[0m
[30;1m199 | [0m[35m    def test_ip_failure_limit(self):[0m
[30;1m200 | [0m[35m        """ Tests that the IP failure limit setting is[0m
[30;1m201 | [0m[35m        respected when trying to login one more time than failure limit[0m
[30;1m202 | [0m[35m        """[0m
[30;1m203 | [0m[35m        for i in range(0, config.IP_FAILURE_LIMIT):[0m
[30;1m204 | [0m[35m            username = "john-doe__%d" % i[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    @patch("defender.config.IP_FAILURE_LIMIT", 3)[0m
[30;1m199 | [0m[35m    def test_ip_failure_limit(self):[0m
[30;1m200 | [0m[35m        """ Tests that the IP failure limit setting is[0m
[30;1m201 | [0m[35m        respected when trying to login one more time than failure limit[0m
[30;1m202 | [0m[35m        """[0m
[30;1m203 | [0m[35m        for i in range(0, config.IP_FAILURE_LIMIT):[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m        respected when trying to login one more time than failure limit[0m
[30;1m182 | [0m[35m        """[0m
[30;1m183 | [0m[35m        for i in range(0, config.USERNAME_FAILURE_LIMIT):[0m
[30;1m184 | [0m[35m            ip = "74.125.239.{0}.".format(i)[0m
[30;1m185 | [0m[35m            response = self._login(username=VALID_USERNAME, remote_addr=ip)[0m
[30;1m186 | [0m[35m            # Check if we are in the same login page[0m
[30;1m187 | [0m[35m            self.assertContains(response, LOGIN_FORM_KEY)[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m    @patch("defender.config.USERNAME_FAILURE_LIMIT", 3)[0m
[30;1m179 | [0m[35m    def test_username_failure_limit(self):[0m
[30;1m180 | [0m[35m        """ Tests that the username failure limit setting is[0m
[30;1m181 | [0m[35m        respected when trying to login one more time than failure limit[0m
[30;1m182 | [0m[35m        """[0m
[30;1m183 | [0m[35m        for i in range(0, config.USERNAME_FAILURE_LIMIT):[0m
[30;1m184 | [0m[35m            ip = "74.125.239.{0}.".format(i)[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m        one more time than failure limit[0m
[30;1m162 | [0m[35m        """[0m
[30;1m163 | [0m[35m        for i in range(0, config.FAILURE_LIMIT):[0m
[30;1m164 | [0m[35m            ip = "74.125.239.{0}.".format(i)[0m
[30;1m165 | [0m[35m            response = self._login(username=VALID_USERNAME, remote_addr=ip)[0m
[30;1m166 | [0m[35m            # Check if we are in the same login page[0m
[30;1m167 | [0m[35m            self.assertContains(response, LOGIN_FORM_KEY)[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m    def test_failure_limit_by_username_once(self):[0m
[30;1m160 | [0m[35m        """ Tests the login lock by username when trying to login[0m
[30;1m161 | [0m[35m        one more time than failure limit[0m
[30;1m162 | [0m[35m        """[0m
[30;1m163 | [0m[35m        for i in range(0, config.FAILURE_LIMIT):[0m
[30;1m164 | [0m[35m            ip = "74.125.239.{0}.".format(i)[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m        self.assertContains(response, self.LOCKED_MESSAGE)[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    def test_failure_limit_by_ip_many(self):[0m
[30;1m140 | [0m[35m        """ Tests the login lock by ip when trying to[0m
[30;1m141 | [0m[35m        login a lot of times more than failure limit[0m
[30;1m142 | [0m[35m        """[0m
[30;1m143 | [0m[35m        for i in range(0, config.FAILURE_LIMIT):[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    def test_failure_limit_by_ip_once(self):[0m
[30;1m122 | [0m[35m        """ Tests the login lock by ip when trying to login[0m
[30;1m123 | [0m[35m        one more time than failure limit[0m
[30;1m124 | [0m[35m        """[0m
[30;1m125 | [0m[35m        for i in range(0, config.FAILURE_LIMIT):[0m
[30;1m126 | [0m[35m            response = self._login()[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m        self.assertEqual(response.status_code, 200)[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    def test_failure_limit_by_ip_once(self):[0m
[30;1m122 | [0m[35m        """ Tests the login lock by ip when trying to login[0m
[30;1m123 | [0m[35m        one more time than failure limit[0m
[30;1m124 | [0m[35m        """[0m
[30;1m125 | [0m[35m        for i in range(0, config.FAILURE_LIMIT):[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m        get_blocked_ips() is the same as the data saved[0m
[30;1m89 | [0m[35m        """[0m
[30;1m90 | [0m[35m        data_in = ["127.0.0.1", "4.2.2.1"][0m
[30;1m91 | [0m[35m        for ip in data_in:[0m
[30;1m92 | [0m[35m            utils.block_ip(ip)[0m
[30;1m93 | [0m[35m        data_out = utils.get_blocked_ips()[0m
[30;1m94 | [0m[35m        self.assertEqual(sorted(data_in), sorted(data_out))[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport random[0m
[30;1m2 | [0m[35mimport string[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom unittest.mock import patch[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom django.contrib.auth.models import AnonymousUser, User[0m
[30;1m7 | [0m[35mfrom django.contrib.sessions.backends.db import SessionStore[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/middleware.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m    def __init__(self, get_response):[0m
[30;1m13 | [0m[35m        self.get_response = get_response[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m        # Watch the auth login.[0m
[30;1m16 | [0m[35m        # Monkey-patch only once - otherwise we would be recording[0m
[30;1m17 | [0m[35m        # failed attempts multiple times![0m
[30;1m18 | [0m[35m        if not FailedLoginMiddleware.patched:[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/ci_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m    },[0m
[30;1m52 | [0m[35m][0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/test_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m    },[0m
[30;1m49 | [0m[35m][0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35mSECRET_KEY = os.environ.get("SECRET_KEY", "too-secret-for-test")[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mLOGIN_REDIRECT_URL = "/admin"[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m    login attempts to be relevant.[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    Args:[0m
[30;1m28 | [0m[35m        ip_address (str, optional): IP address to search for. Can be used in conjunction with userna[0m
[30;1m29 | [0m[35m        username (str, optional): Username to search for. Can be used in conjunction with ip_address[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mdef get_approx_account_lockouts_from_login_attempts(ip_address=None, username=None):[0m
[30;1m23 | [0m[35m    """Get the approximate number of account lockouts in a period of ACCESS_ATTEMPT_EXPIRATION hours[0m
[30;1m24 | [0m[35m    This is approximate because we do not consider the time between these failed[0m
[30;1m25 | [0m[35m    login attempts to be relevant.[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    Args:[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/views.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m@staff_member_required[0m
[30;1m27 | [0m[35mdef unblock_ip_view(request, ip_address):[0m
[30;1m28 | [0m[35m    """ upblock the given ip """[0m
[30;1m29 | [0m[35m    if request.method == "POST":[0m
[30;1m30 | [0m[35m        unblock_ip(ip_address)[0m
[30;1m31 | [0m[35m    return HttpResponseRedirect(reverse("defender_blocks_view"))[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/views.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m@staff_member_required[0m
[30;1m12 | [0m[35mdef block_view(request):[0m
[30;1m13 | [0m[35m    """ List the blocked IP and Usernames """[0m
[30;1m14 | [0m[35m    blocked_ip_list = get_blocked_ips()[0m
[30;1m15 | [0m[35m    blocked_username_list = get_blocked_usernames()[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m448 | [0m[35m    user_agent = request.META.get("HTTP_USER_AGENT", "<unknown>")[:255][0m
[30;1m449 | [0m[35m    ip_address = get_ip(request)[0m
[30;1m450 | [0m[35m    http_accept = request.META.get("HTTP_ACCEPT", "<unknown>")[0m
[30;1m451 | [0m[35m    path_info = request.META.get("PATH_INFO", "<unknown>")[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m    if config.USE_CELERY:[0m
[30;1m454 | [0m[35m        from .tasks import add_login_attempt_task[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m    user_agent = request.META.get("HTTP_USER_AGENT", "<unknown>")[:255][0m
[30;1m449 | [0m[35m    ip_address = get_ip(request)[0m
[30;1m450 | [0m[35m    http_accept = request.META.get("HTTP_ACCEPT", "<unknown>")[0m
[30;1m451 | [0m[35m    path_info = request.META.get("PATH_INFO", "<unknown>")[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m    if config.USE_CELERY:[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m445 | [0m[35m[0m
[30;1m446 | [0m[35m    username = username or get_username(request)[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m    user_agent = request.META.get("HTTP_USER_AGENT", "<unknown>")[:255][0m
[30;1m449 | [0m[35m    ip_address = get_ip(request)[0m
[30;1m450 | [0m[35m    http_accept = request.META.get("HTTP_ACCEPT", "<unknown>")[0m
[30;1m451 | [0m[35m    path_info = request.META.get("PATH_INFO", "<unknown>")[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m401 | [0m[35m        return False[0m
[30;1m402 | [0m[35m    if config.DISABLE_IP_LOCKOUT:[0m
[30;1m403 | [0m[35m        return False[0m
[30;1m404 | [0m[35m    return REDIS_SERVER.get(get_ip_blocked_cache_key(ip_address))[0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35mdef is_already_locked(request, get_username=get_username_from_request, username=None):[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m        return False[0m
[30;1m393 | [0m[35m    if config.DISABLE_USERNAME_LOCKOUT:[0m
[30;1m394 | [0m[35m        return False[0m
[30;1m395 | [0m[35m    return REDIS_SERVER.get(get_username_blocked_cache_key(username))[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m[0m
[30;1m398 | [0m[35mdef is_source_ip_already_locked(ip_address):[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m    ip_count = int(ip_count)[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    # get by username[0m
[30;1m219 | [0m[35m    username_count = REDIS_SERVER.get(get_username_attempt_cache_key(username))[0m
[30;1m220 | [0m[35m    if not username_count:[0m
[30;1m221 | [0m[35m        username_count = 0[0m
[30;1m222 | [0m[35m    username_count = int(username_count)[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m    username = lower_username(username or get_username(request))[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    # get by IP[0m
[30;1m213 | [0m[35m    ip_count = REDIS_SERVER.get(get_ip_attempt_cache_key(ip_address))[0m
[30;1m214 | [0m[35m    if not ip_count:[0m
[30;1m215 | [0m[35m        ip_count = 0[0m
[30;1m216 | [0m[35m    ip_count = int(ip_count)[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35mdef get_ip(request):[0m
[30;1m76 | [0m[35m    """ get the ip address from the request """[0m
[30;1m77 | [0m[35m    if config.BEHIND_REVERSE_PROXY:[0m
[30;1m78 | [0m[35m        ip_address = request.META.get(config.REVERSE_PROXY_HEADER, "")[0m
[30;1m79 | [0m[35m        ip_address = ip_address.split(",", 1)[0].strip()[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m        if ip_address == "":[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35mdef get_ip_address_from_request(request):[0m
[30;1m41 | [0m[35m    """ Makes the best attempt to get the client's real IP or return[0m
[30;1m42 | [0m[35m        the loopback """[0m
[30;1m43 | [0m[35m    remote_addr = request.META.get("REMOTE_ADDR", "")[0m
[30;1m44 | [0m[35m    if remote_addr and is_valid_ip(remote_addr):[0m
[30;1m45 | [0m[35m        return remote_addr.strip()[0m
[30;1m46 | [0m[35m    return "127.0.0.1"[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m294 | [0m[35m            user_block = True[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m    # if we have this turned on, then there is no reason to look at ip_block[0m
[30;1m297 | [0m[35m    # we will just look at user_block, and short circut the result since[0m
[30;1m298 | [0m[35m    # we don't need to continue.[0m
[30;1m299 | [0m[35m    if config.DISABLE_IP_LOCKOUT:[0m
[30;1m300 | [0m[35m        # if user_block is True, it means it was blocked[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m293 | [0m[35m            block_username(username)[0m
[30;1m294 | [0m[35m            user_block = True[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m    # if we have this turned on, then there is no reason to look at ip_block[0m
[30;1m297 | [0m[35m    # we will just look at user_block, and short circut the result since[0m
[30;1m298 | [0m[35m    # we don't need to continue.[0m
[30;1m299 | [0m[35m    if config.DISABLE_IP_LOCKOUT:[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m411 | [0m[35m    ip_blocked = is_source_ip_already_locked(get_ip(request))[0m
[30;1m412 | [0m[35m[0m
[30;1m413 | [0m[35m    if config.LOCKOUT_BY_IP_USERNAME:[0m
[30;1m414 | [0m[35m        # if both this IP and this username are present the request is blocked[0m
[30;1m415 | [0m[35m        return ip_blocked and user_blocked[0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35m    return ip_blocked or user_blocked[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35mdef is_already_locked(request, get_username=get_username_from_request, username=None):[0m
[30;1m408 | [0m[35m    """Parse the username & IP from the request, and see if it's[0m
[30;1m409 | [0m[35m    already locked."""[0m
[30;1m410 | [0m[35m    user_blocked = is_user_already_locked(username or get_username(request))[0m
[30;1m411 | [0m[35m    ip_blocked = is_source_ip_already_locked(get_ip(request))[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m[0m
[30;1m398 | [0m[35mdef is_source_ip_already_locked(ip_address):[0m
[30;1m399 | [0m[35m    """Is this IP already locked?"""[0m
[30;1m400 | [0m[35m    if ip_address is None:[0m
[30;1m401 | [0m[35m        return False[0m
[30;1m402 | [0m[35m    if config.DISABLE_IP_LOCKOUT:[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m351 | [0m[35m    """[0m
[30;1m352 | [0m[35m    pipe = REDIS_SERVER.pipeline()[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m    # Because IP is shared, a reset should never clear an IP block[0m
[30;1m355 | [0m[35m    # when using IP/username as block[0m
[30;1m356 | [0m[35m    if not config.LOCKOUT_BY_IP_USERNAME:[0m
[30;1m357 | [0m[35m        unblock_ip(ip_address, pipe=pipe)[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m351 | [0m[35m    """[0m
[30;1m352 | [0m[35m    pipe = REDIS_SERVER.pipeline()[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m    # Because IP is shared, a reset should never clear an IP block[0m
[30;1m355 | [0m[35m    # when using IP/username as block[0m
[30;1m356 | [0m[35m    if not config.LOCKOUT_BY_IP_USERNAME:[0m
[30;1m357 | [0m[35m        unblock_ip(ip_address, pipe=pipe)[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35mdef unblock_ip(ip_address, pipe=None):[0m
[30;1m322 | [0m[35m    """ unblock the given IP """[0m
[30;1m323 | [0m[35m    do_commit = False[0m
[30;1m324 | [0m[35m    if not pipe:[0m
[30;1m325 | [0m[35m        pipe = REDIS_SERVER.pipeline()[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m305 | [0m[35m        # The same as DISABLE_IP_LOCKOUT[0m
[30;1m306 | [0m[35m        return not ip_block[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m    # we want to make sure both the IP and user is blocked before we[0m
[30;1m309 | [0m[35m    # return False[0m
[30;1m310 | [0m[35m    # this is mostly used when a lot of your users are using proxies,[0m
[30;1m311 | [0m[35m    # and you don't want one user to block everyone on that one IP.[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m278 | [0m[35m    # increment the failed count, and get current number[0m
[30;1m279 | [0m[35m    ip_block = False[0m
[30;1m280 | [0m[35m    if not config.DISABLE_IP_LOCKOUT:[0m
[30;1m281 | [0m[35m        # we only want to increment the IP if this is disabled.[0m
[30;1m282 | [0m[35m        ip_count = increment_key(get_ip_attempt_cache_key(ip_address))[0m
[30;1m283 | [0m[35m        # if over the limit, add to block[0m
[30;1m284 | [0m[35m        if ip_count > config.IP_FAILURE_LIMIT:[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m237 | [0m[35mdef block_ip(ip_address):[0m
[30;1m238 | [0m[35m    """ given the ip, block it """[0m
[30;1m239 | [0m[35m    if not ip_address:[0m
[30;1m240 | [0m[35m        # no reason to continue when there is no ip[0m
[30;1m241 | [0m[35m        return[0m
[30;1m242 | [0m[35m    if config.DISABLE_IP_LOCKOUT:[0m
[30;1m243 | [0m[35m        # no need to block, we disabled it.[0m
[30;1m244 | [0m[35m        return[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    username = lower_username(username or get_username(request))[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    # get by IP[0m
[30;1m213 | [0m[35m    ip_count = REDIS_SERVER.get(get_ip_attempt_cache_key(ip_address))[0m
[30;1m214 | [0m[35m    if not ip_count:[0m
[30;1m215 | [0m[35m        ip_count = 0[0m
[30;1m216 | [0m[35m    ip_count = int(ip_count)[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35mdef get_ip_blocked_cache_key(ip_address):[0m
[30;1m120 | [0m[35m    """ get the cache key by ip """[0m
[30;1m121 | [0m[35m    return "{0}:blocked:ip:{1}".format(config.CACHE_PREFIX, ip_address)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35mdef get_ip_attempt_cache_key(ip_address):[0m
[30;1m108 | [0m[35m    """ get the cache key by ip """[0m
[30;1m109 | [0m[35m    return "{0}:failed:ip:{1}".format(config.CACHE_PREFIX, ip_address)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m            """[0m
[30;1m85 | [0m[35m            Some reverse proxies will include a port number with the[0m
[30;1m86 | [0m[35m            IP address; as this port may change from request to request,[0m
[30;1m87 | [0m[35m            and thus make it appear to be different IP addresses, we'll[0m
[30;1m88 | [0m[35m            want to remove the port number, if present:[0m
[30;1m89 | [0m[35m            """[0m
[30;1m90 | [0m[35m            ip_address = strip_port_number(ip_address)[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m        else:[0m
[30;1m84 | [0m[35m            """[0m
[30;1m85 | [0m[35m            Some reverse proxies will include a port number with the[0m
[30;1m86 | [0m[35m            IP address; as this port may change from request to request,[0m
[30;1m87 | [0m[35m            and thus make it appear to be different IP addresses, we'll[0m
[30;1m88 | [0m[35m            want to remove the port number, if present:[0m
[30;1m89 | [0m[35m            """[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35mdef get_ip(request):[0m
[30;1m76 | [0m[35m    """ get the ip address from the request """[0m
[30;1m77 | [0m[35m    if config.BEHIND_REVERSE_PROXY:[0m
[30;1m78 | [0m[35m        ip_address = request.META.get(config.REVERSE_PROXY_HEADER, "")[0m
[30;1m79 | [0m[35m        ip_address = ip_address.split(",", 1)[0].strip()[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m        ip_address = match[1][0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    """[0m
[30;1m65 | [0m[35m    If it's not a valid IP address, we prefer to return[0m
[30;1m66 | [0m[35m    the string as-is instead of returning a potentially[0m
[30;1m67 | [0m[35m    corrupted string:[0m
[30;1m68 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mdef get_ip_address_from_request(request):[0m
[30;1m41 | [0m[35m    """ Makes the best attempt to get the client's real IP or return[0m
[30;1m42 | [0m[35m        the loopback """[0m
[30;1m43 | [0m[35m    remote_addr = request.META.get("REMOTE_ADDR", "")[0m
[30;1m44 | [0m[35m    if remote_addr and is_valid_ip(remote_addr):[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m164[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/defender/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef is_valid_ip(ip_address):[0m
[30;1m29 | [0m[35m    """ Check Validity of an IP address """[0m
[30;1m30 | [0m[35m    if not ip_address:[0m
[30;1m31 | [0m[35m        return False[0m
[30;1m32 | [0m[35m    ip_address = ip_address.strip()[0m

164 matches found.
