[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/env.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m167 | [0m[35m        server = config.get("coiled.server", COILED_SERVER).replace("8000", "5173")[0m
[30;1m168 | [0m[35m        account = workspace or config.get("coiled.workspace", config.get("coiled.account"))[0m
[30;1m169 | [0m[35m        for env_name, env_details in environments.items():[0m
[30;1m170 | [0m[35m            latest_build = env_details["latest_spec"].get("latest_build")[0m
[30;1m171 | [0m[35m            if latest_build:[0m
[30;1m172 | [0m[35m                build_status = latest_build["state"] if latest_build["state"] != "error" else "[red][0m
[30;1m173 | [0m[35m                env_url = f"{server}/software/alias/{env_details['id']}/build/{latest_build['id']}?a[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m175 | [0m[35m        scheduler_address = ssh_info["scheduler_hostname"] or ssh_info["scheduler_public_address"][0m
[30;1m176 | [0m[35m        target = f"ubuntu@{scheduler_address}"[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m        add_ssh_access(scheduler_address, key=ssh_info["private_key"])[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        added, ssh_error = add_host_to_known_hosts(console, target)[0m
[30;1m181 | [0m[35m        if not added:[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m            [[0m
[30;1m66 | [0m[35m                ssh_keygen_path,[0m
[30;1m67 | [0m[35m                "-f",[0m
[30;1m68 | [0m[35m                os.path.expanduser("~/.ssh/known_hosts"),[0m
[30;1m69 | [0m[35m                "-R",[0m
[30;1m70 | [0m[35m                scheduler_address,[0m
[30;1m71 | [0m[35m            ],[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m        ssh_info = cloud.get_ssh_key(cluster_id)[0m
[30;1m58 | [0m[35m        scheduler_address = ssh_info["scheduler_hostname"] or ssh_info["scheduler_address_to_use"][0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        remove_ssh_access(scheduler_address, key=ssh_info["private_key"])[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        # Remove `known_hosts` entries.[0m
[30;1m63 | [0m[35m        # TODO don't like touching the user's `known_hosts` file like this.[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m9 | [0m[35mfrom rich import print[0m
[30;1m10 | [0m[35mfrom rich.console import Console[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom .cluster.ssh import add_ssh_access, get_ssh_add_path, get_ssh_path, remove_ssh_access[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m# Path on VM to sync to.[0m
[30;1m15 | [0m[35m# We use `/scratch` for now because it's already bind-mounted into docker.[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2810 | [0m[35m    elif registry_type == "docker_hub":[0m
[30;1m2811 | [0m[35m        registry = {[0m
[30;1m2812 | [0m[35m            "account": registry_namespace or registry_username,[0m
[30;1m2813 | [0m[35m            "password": registry_access_token,[0m
[30;1m2814 | [0m[35m            "type": registry_type,[0m
[30;1m2815 | [0m[35m            "uri": registry_uri,[0m
[30;1m2816 | [0m[35m            "username": registry_username,[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2768 | [0m[35m        if aws_access_key_id and aws_secret_access_key:[0m
[30;1m2769 | [0m[35m            backend_options["options"]["credentials"] = {[0m
[30;1m2770 | [0m[35m                "aws_access_key": aws_access_key_id,[0m
[30;1m2771 | [0m[35m                "aws_secret_key": aws_secret_access_key,[0m
[30;1m2772 | [0m[35m            }[0m
[30;1m2773 | [0m[35m[0m
[30;1m2774 | [0m[35m            backend_options["options"]["provider_name"] = "aws"[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2560 | [0m[35m                    "type",[0m
[30;1m2561 | [0m[35m                    "project_id",[0m
[30;1m2562 | [0m[35m                    "private_key_id",[0m
[30;1m2563 | [0m[35m                    "private_key",[0m
[30;1m2564 | [0m[35m                    "client_email",[0m
[30;1m2565 | [0m[35m                    "client_id",[0m
[30;1m2566 | [0m[35m                    "auth_uri",[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2559 | [0m[35m                required_keys = [[0m
[30;1m2560 | [0m[35m                    "type",[0m
[30;1m2561 | [0m[35m                    "project_id",[0m
[30;1m2562 | [0m[35m                    "private_key_id",[0m
[30;1m2563 | [0m[35m                    "private_key",[0m
[30;1m2564 | [0m[35m                    "client_email",[0m
[30;1m2565 | [0m[35m                    "client_id",[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2122 | [0m[35m[0m
[30;1m2123 | [0m[35mdef format_cluster_output(d, server):[0m
[30;1m2124 | [0m[35m    d = d.copy()[0m
[30;1m2125 | [0m[35m    for key in ["auth_token", "name", "last_seen"]:[0m
[30;1m2126 | [0m[35m        d.pop(key)[0m
[30;1m2127 | [0m[35m    d["account"] = format_account_output(d["account"])[0m
[30;1m2128 | [0m[35m    # Rename "public_address" to "address"[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m2245 | [0m[35m    log_output[0m
[30;1m2246 | [0m[35m        Stream to output logs to. Defaults to ``sys.stdout``.[0m
[30;1m2247 | [0m[35m    force_rebuild[0m
[30;1m2248 | [0m[35m        By default, if an existing software environment with the same name and dependencies already[0m
[30;1m2249 | [0m[35m        exists, a rebuild is aborted. If this is set to ``True``, those checks are skipped and the[0m
[30;1m2250 | [0m[35m        environment will be rebuilt. Defaults to ``False``[0m
[30;1m2251 | [0m[35m    use_entrypoint[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1411 | [0m[35m            raise ApiResponseStatusError(msg)[0m
[30;1m1412 | [0m[35m[0m
[30;1m1413 | [0m[35m    @overload[0m
[30;1m1414 | [0m[35m    def list_software_environments(self: Cloud[Sync], account: str | None = None) -> dict: ...[0m
[30;1m1415 | [0m[35m[0m
[30;1m1416 | [0m[35m    @overload[0m
[30;1m1417 | [0m[35m    def list_software_environments([0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1062 | [0m[35m            "name": name,[0m
[30;1m1063 | [0m[35m            "container": container,[0m
[30;1m1064 | [0m[35m            "force_rebuild": force_rebuild,[0m
[30;1m1065 | [0m[35m            "md5": md5(json.dumps(senv, sort_keys=True).encode("utf-8")).hexdigest(),[0m
[30;1m1066 | [0m[35m            "use_entrypoint": use_entrypoint,[0m
[30;1m1067 | [0m[35m            "gpu_enabled": gpu_enabled,[0m
[30;1m1068 | [0m[35m            "architecture": architecture,[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m16 | [0m[35mthe right thing depending on whether we're in a sync or async context.[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mWhen it comes to the Cluster class, this complexity is probably forced on us by distributed supporti[0m
[30;1m19 | [0m[35mBut for our own stuff (e.g. create_software_environment) we could probably simplify to a simpler syn[0m
[30;1m20 | [0m[35mif we choose.[0m
[30;1m21 | [0m[35m"""[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mBecause the distributed API can be used as either async and sync, Coiled can too. This is implemente[0m
[30;1m14 | [0m[35mleading-underscore async-only functions like "Cloud._create_software_environment", and then non-unde[0m
[30;1m15 | [0m[35mversions like "Cloud.create_software_environment", where the latter uses a helper method "cloud.sync[0m
[30;1m16 | [0m[35mthe right thing depending on whether we're in a sync or async context.[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mWhen it comes to the Cluster class, this complexity is probably forced on us by distributed supporti[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m694 | [0m[35m        logger.debug(f"Starting upload for {package_name}")[0m
[30;1m695 | [0m[35m        package_bytes = package_file.read()[0m
[30;1m696 | [0m[35m        # s3 expects the md5 to be base64 encoded[0m
[30;1m697 | [0m[35m        wheel_md5 = base64.b64encode(md5(package_bytes).digest()).decode("utf-8")[0m
[30;1m698 | [0m[35m        workspace = workspace or self.default_workspace[0m
[30;1m699 | [0m[35m[0m
[30;1m700 | [0m[35m        response = await self._do_request([0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m693 | [0m[35m        package_name = pathlib.Path(package_file.name).name[0m
[30;1m694 | [0m[35m        logger.debug(f"Starting upload for {package_name}")[0m
[30;1m695 | [0m[35m        package_bytes = package_file.read()[0m
[30;1m696 | [0m[35m        # s3 expects the md5 to be base64 encoded[0m
[30;1m697 | [0m[35m        wheel_md5 = base64.b64encode(md5(package_bytes).digest()).decode("utf-8")[0m
[30;1m698 | [0m[35m        workspace = workspace or self.default_workspace[0m
[30;1m699 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m23 | [0m[35mfrom __future__ import annotations[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mimport asyncio[0m
[30;1m26 | [0m[35mimport base64[0m
[30;1m27 | [0m[35mimport datetime[0m
[30;1m28 | [0m[35mimport json[0m
[30;1m29 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/prefect_serve.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m123 | [0m[35m    # User-provided environment variables[0m
[30;1m124 | [0m[35m    if env:[0m
[30;1m125 | [0m[35m        runtime_env_vars.extend(env)[0m
[30;1m126 | [0m[35m        # Forward environment variables to set in `@coiled.function`-decorated tasks[0m
[30;1m127 | [0m[35m        runtime_env_vars.append(f"COILED_REUSE_ENVIRON_KEYS={','.join(i.split('=')[0] for i in env)}[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    if command[0] != "python":[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/prefect_serve.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m116 | [0m[35m        )[0m
[30;1m117 | [0m[35m        return[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    runtime_env_vars.append(f"DASK_COILED__TOKEN={dask.config.get('coiled.token')}")[0m
[30;1m120 | [0m[35m    if account:[0m
[30;1m121 | [0m[35m        runtime_env_vars.append(f"DASK_COILED__ACCOUNT={account}")[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m408 | [0m[35m        failure_str = ", ".join([f"{pkg['name']} - {pkg['error'] or pkg['note']}" for pkg in halting[0m
[30;1m409 | [0m[35m        raise RuntimeError(f"""Issues with critical packages: {failure_str}[0m
[30;1m410 | [0m[35m[0m
[30;1m411 | [0m[35mYour software environment has conflicting dependency requirements.[0m
[30;1m412 | [0m[35m[0m
[30;1m413 | [0m[35mConsider creating a new environment.[0m
[30;1m414 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m352 | [0m[35m                logger.debug(f"Package - {pkg_with_note['name']}, {pkg_with_note['note']}")[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m        async with cluster._time_cluster_event("package sync", "create env") if cluster else context[0m
[30;1m355 | [0m[35m            package_sync_env_alias = await cloud._create_package_sync_env([0m
[30;1m356 | [0m[35m                packages=approximation,[0m
[30;1m357 | [0m[35m                workspace=workspace,[0m
[30;1m358 | [0m[35m                progress=progress,[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1847 | [0m[35m    import dask.config[0m
[30;1m1848 | [0m[35m    from dask.distributed import Client[0m
[30;1m1849 | [0m[35m[0m
[30;1m1850 | [0m[35m    scheduler_address = os.environ.get("COILED_INTERNAL_DASK_SCHEDULER_ADDRESS")[0m
[30;1m1851 | [0m[35m[0m
[30;1m1852 | [0m[35m    if not scheduler_address:[0m
[30;1m1853 | [0m[35m        raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1821 | [0m[35m    from coiled.capture_environment import scan_and_create[0m
[30;1m1822 | [0m[35m[0m
[30;1m1823 | [0m[35m    with Cloud(workspace=workspace) as cloud:[0m
[30;1m1824 | [0m[35m        package_sync_env_alias = cloud._sync([0m
[30;1m1825 | [0m[35m            scan_and_create,[0m
[30;1m1826 | [0m[35m            cloud=cloud,[0m
[30;1m1827 | [0m[35m            workspace=workspace,[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m451 | [0m[35m        default_environ = {}[0m
[30;1m452 | [0m[35m        if container and "rapidsai" in container:[0m
[30;1m453 | [0m[35m            default_environ = {"DISABLE_JUPYTER": "true", **default_environ}  # needed for "stable" [0m
[30;1m454 | [0m[35m        if os.environ.get("COILED_REUSE_ENVIRON_KEYS"):[0m
[30;1m455 | [0m[35m            keys = os.environ["COILED_REUSE_ENVIRON_KEYS"].split(",")[0m
[30;1m456 | [0m[35m            default_environ.update({key: os.environ[key] for key in keys})[0m
[30;1m457 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m323 | [0m[35m    ----------[0m
[30;1m324 | [0m[35m    software[0m
[30;1m325 | [0m[35m        Name of the software environment to use; this allows you to use and re-use existing[0m
[30;1m326 | [0m[35m        Coiled software environments, and should not be used with package sync or when specifying[0m
[30;1m327 | [0m[35m        a container to use for this specific cluster.[0m
[30;1m328 | [0m[35m    container[0m
[30;1m329 | [0m[35m        Name or URI of container image to use; when using a pre-made container image with Coiled,[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m188 | [0m[35m    def __call__(self, *args, **kwargs):[0m
[30;1m189 | [0m[35m        # If this is being called from on the desired cluster, then run locally.[0m
[30;1m190 | [0m[35m        # This allows one Function (with same desired cluster specs) to call another without overhea[0m
[30;1m191 | [0m[35m        if os.environ.get("COILED_CLUSTER_NAME", None) == self._name:[0m
[30;1m192 | [0m[35m            return self.local(*args, **kwargs)[0m
[30;1m193 | [0m[35m        # Otherwise, submit to cluster.[0m
[30;1m194 | [0m[35m        return self.submit(*args, **kwargs).result()[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m153 | [0m[35m                            single_thread_unsets = [[0m
[30;1m154 | [0m[35m                                key[0m
[30;1m155 | [0m[35m                                for key in coiled.utils.unset_single_thread_defaults().keys()[0m
[30;1m156 | [0m[35m                                if not user_specified_env.get(key)[0m
[30;1m157 | [0m[35m                            ][0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m                            cluster.unset_env_vars(single_thread_unsets)[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mdef conda_command():[0m
[30;1m46 | [0m[35m    return shutil.which(os.environ.get("CONDA_EXE", "conda")) or "conda"[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mdef parse_conda_command(cmd: list):[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mimport aiohttp[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mDDTRACE = environ.get("DD_TRACE_ENABLED", "true").lower() in ["true", "1"][0m
[30;1m18 | [0m[35mif DDTRACE:[0m
[30;1m19 | [0m[35m    try:[0m
[30;1m20 | [0m[35m        from ddtrace import tracer[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2166 | [0m[35m        """[0m
[30;1m2167 | [0m[35m        Send potentially private environment variables to be set on scheduler and all workers.[0m
[30;1m2168 | [0m[35m[0m
[30;1m2169 | [0m[35m        You can use this to send secrets (passwords, auth tokens) that you can use in code running o[0m
[30;1m2170 | [0m[35m        Unlike environment variables set with ``coiled.Cluster(environ=...)``, the values will be tr[0m
[30;1m2171 | [0m[35m        directly to your cluster without being transmitted to Coiled, logged, or written to disk.[0m
[30;1m2172 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m332 | [0m[35m        ``default_cluster_timeout`` set on parent Cloud by default.[0m
[30;1m333 | [0m[35m    environ[0m
[30;1m334 | [0m[35m        Dictionary of environment variables. Values will be transmitted to Coiled; for private envir[0m
[30;1m335 | [0m[35m        (e.g., passwords or access keys you use for data access), :meth:`send_private_envs` is recom[0m
[30;1m336 | [0m[35m    send_dask_config[0m
[30;1m337 | [0m[35m        Whether to send a frozen copy of local ``dask.config`` to the cluster.[0m
[30;1m338 | [0m[35m    unset_single_threading_variables[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m2190 | [0m[35m                    # warn, but don't crash[0m
[30;1m2191 | [0m[35m                    logger.warning(f"error sending environment variables to cluster: {e}")[0m
[30;1m2192 | [0m[35m[0m
[30;1m2193 | [0m[35m    def unset_env_vars(self: ClusterSyncAsync, unset: Iterable[str]):[0m
[30;1m2194 | [0m[35m        return self.sync(self._unset_env_vars, list(unset))[0m
[30;1m2195 | [0m[35m[0m
[30;1m2196 | [0m[35m    async def _unset_env_vars(self, unset: Iterable[str], retries=5):[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m2162 | [0m[35m                    # warn, but don't crash[0m
[30;1m2163 | [0m[35m                    logger.warning(f"error calling {function} on scheduler comm: {e}")[0m
[30;1m2164 | [0m[35m[0m
[30;1m2165 | [0m[35m    def send_private_envs(self: ClusterSyncAsync, env: dict):[0m
[30;1m2166 | [0m[35m        """[0m
[30;1m2167 | [0m[35m        Send potentially private environment variables to be set on scheduler and all workers.[0m
[30;1m2168 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1513 | [0m[35m                    backend_options=self.backend_options,[0m
[30;1m1514 | [0m[35m                    use_scheduler_public_ip=self.use_scheduler_public_ip,[0m
[30;1m1515 | [0m[35m                    use_dashboard_https=self.use_dashboard_https,[0m
[30;1m1516 | [0m[35m                    senv_v2_id=package_sync_senv_id,[0m
[30;1m1517 | [0m[35m                    private_to_creator=self.private_to_creator,[0m
[30;1m1518 | [0m[35m                    extra_worker_on_scheduler=self.extra_worker_on_scheduler,[0m
[30;1m1519 | [0m[35m                    n_worker_specs_per_host=self.n_worker_specs_per_host,[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1483 | [0m[35m                package_sync_senv_id, package_sync_senv_name = await self._package_sync_scan_and_cre[0m
[30;1m1484 | [0m[35m                    architecture=architecture, gpu_enabled=self._is_gpu_cluster[0m
[30;1m1485 | [0m[35m                )[0m
[30;1m1486 | [0m[35m                self._software_environment_name = package_sync_senv_name or self.software_environmen[0m
[30;1m1487 | [0m[35m[0m
[30;1m1488 | [0m[35m                if self.dashboard_custom_subdomain:[0m
[30;1m1489 | [0m[35m                    await self._wait_for_custom_certificate([0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1480 | [0m[35m                        workspace=self.workspace, subdomain=self.dashboard_custom_subdomain[0m
[30;1m1481 | [0m[35m                    )[0m
[30;1m1482 | [0m[35m[0m
[30;1m1483 | [0m[35m                package_sync_senv_id, package_sync_senv_name = await self._package_sync_scan_and_cre[0m
[30;1m1484 | [0m[35m                    architecture=architecture, gpu_enabled=self._is_gpu_cluster[0m
[30;1m1485 | [0m[35m                )[0m
[30;1m1486 | [0m[35m                self._software_environment_name = package_sync_senv_name or self.software_environmen[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1480 | [0m[35m                        workspace=self.workspace, subdomain=self.dashboard_custom_subdomain[0m
[30;1m1481 | [0m[35m                    )[0m
[30;1m1482 | [0m[35m[0m
[30;1m1483 | [0m[35m                package_sync_senv_id, package_sync_senv_name = await self._package_sync_scan_and_cre[0m
[30;1m1484 | [0m[35m                    architecture=architecture, gpu_enabled=self._is_gpu_cluster[0m
[30;1m1485 | [0m[35m                )[0m
[30;1m1486 | [0m[35m                self._software_environment_name = package_sync_senv_name or self.software_environmen[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1450 | [0m[35m                    )[0m
[30;1m1451 | [0m[35m                    self.software_environment = container_senv_name[0m
[30;1m1452 | [0m[35m[0m
[30;1m1453 | [0m[35m                # Validate software environment name, setting `can_have_revision` to False since[0m
[30;1m1454 | [0m[35m                # we don't seem to be using this yet.[0m
[30;1m1455 | [0m[35m                if not self.package_sync:[0m
[30;1m1456 | [0m[35m                    try:[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1421 | [0m[35m                gpu_discrepancy = self._is_gpu_cluster != dask.config.get([0m
[30;1m1422 | [0m[35m                    "coiled.software_is_gpu_cluster", self._is_gpu_cluster[0m
[30;1m1423 | [0m[35m                )[0m
[30;1m1424 | [0m[35m                if reusing_existing_package_sync_env and gpu_discrepancy:[0m
[30;1m1425 | [0m[35m                    # We reuse software environments from `coiled run` and `coiled batch run` when p[0m
[30;1m1426 | [0m[35m                    # We want to avoid reusing package sync envs when there's a GPU / CPU mismatch.[0m
[30;1m1427 | [0m[35m                    # We go in this `if`-block when:[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1415 | [0m[35m                    self.package_sync = True[0m
[30;1m1416 | [0m[35m                    self.software_environment = ""[0m
[30;1m1417 | [0m[35m[0m
[30;1m1418 | [0m[35m                reusing_existing_package_sync_env = self.software_environment == dask.config.get([0m
[30;1m1419 | [0m[35m                    "coiled.software", None[0m
[30;1m1420 | [0m[35m                ) and (dask.config.get("coiled.software") or "").startswith("package-sync-")[0m
[30;1m1421 | [0m[35m                gpu_discrepancy = self._is_gpu_cluster != dask.config.get([0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1371 | [0m[35m                # number of workers...)[0m
[30;1m1372 | [0m[35m                parse_wait_for_workers(self._start_n_workers, self._wait_for_workers_arg)[0m
[30;1m1373 | [0m[35m[0m
[30;1m1374 | [0m[35m                # Determine software environment (legacy or package sync)[0m
[30;1m1375 | [0m[35m                architecture = ([0m
[30;1m1376 | [0m[35m                    ArchitectureTypesEnum.ARM64[0m
[30;1m1377 | [0m[35m                    if ([0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1233 | [0m[35m                package_sync_event["senv_id"] = package_sync_env[0m
[30;1m1234 | [0m[35m                package_sync_event["senv_name"] = senv_name[0m
[30;1m1235 | [0m[35m[0m
[30;1m1236 | [0m[35m                logger.debug(f"Environment capture complete, {package_sync_env}")[0m
[30;1m1237 | [0m[35m        else:[0m
[30;1m1238 | [0m[35m            package_sync_env = None[0m
[30;1m1239 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1230 | [0m[35m                )[0m
[30;1m1231 | [0m[35m                package_sync_env = package_sync_env_alias["id"][0m
[30;1m1232 | [0m[35m                senv_name = package_sync_env_alias["name"][0m
[30;1m1233 | [0m[35m                package_sync_event["senv_id"] = package_sync_env[0m
[30;1m1234 | [0m[35m                package_sync_event["senv_name"] = senv_name[0m
[30;1m1235 | [0m[35m[0m
[30;1m1236 | [0m[35m                logger.debug(f"Environment capture complete, {package_sync_env}")[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1229 | [0m[35m                    force_rich_widget=self._force_rich_widget,[0m
[30;1m1230 | [0m[35m                )[0m
[30;1m1231 | [0m[35m                package_sync_env = package_sync_env_alias["id"][0m
[30;1m1232 | [0m[35m                senv_name = package_sync_env_alias["name"][0m
[30;1m1233 | [0m[35m                package_sync_event["senv_id"] = package_sync_env[0m
[30;1m1234 | [0m[35m                package_sync_event["senv_name"] = senv_name[0m
[30;1m1235 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1228 | [0m[35m                    use_uv_installer=self._package_sync_use_uv_installer,[0m
[30;1m1229 | [0m[35m                    force_rich_widget=self._force_rich_widget,[0m
[30;1m1230 | [0m[35m                )[0m
[30;1m1231 | [0m[35m                package_sync_env = package_sync_env_alias["id"][0m
[30;1m1232 | [0m[35m                senv_name = package_sync_env_alias["name"][0m
[30;1m1233 | [0m[35m                package_sync_event["senv_id"] = package_sync_env[0m
[30;1m1234 | [0m[35m                package_sync_event["senv_name"] = senv_name[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m695 | [0m[35m[0m
[30;1m696 | [0m[35m        self.software_environment = software or dask.config.get("coiled.software")[0m
[30;1m697 | [0m[35m        self.software_container = container[0m
[30;1m698 | [0m[35m        if not container and not self.software_environment and not package_sync:[0m
[30;1m699 | [0m[35m            self.package_sync = True[0m
[30;1m700 | [0m[35m[0m
[30;1m701 | [0m[35m        self.worker_class = worker_class or dask.config.get("coiled.worker.class")[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m693 | [0m[35m        self.batch_job_ids = batch_job_ids[0m
[30;1m694 | [0m[35m        self.extra_user_container = batch_job_container[0m
[30;1m695 | [0m[35m[0m
[30;1m696 | [0m[35m        self.software_environment = software or dask.config.get("coiled.software")[0m
[30;1m697 | [0m[35m        self.software_container = container[0m
[30;1m698 | [0m[35m        if not container and not self.software_environment and not package_sync:[0m
[30;1m699 | [0m[35m            self.package_sync = True[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m567 | [0m[35m        self.init_time = datetime.datetime.now(tz=datetime.timezone.utc)[0m
[30;1m568 | [0m[35m        type(self)._instances.add(self)[0m
[30;1m569 | [0m[35m[0m
[30;1m570 | [0m[35m        senv_kwargs = {"package_sync": package_sync, "software": software, "container": container}[0m
[30;1m571 | [0m[35m        set_senv_kwargs = [name for name, value in senv_kwargs.items() if value][0m
[30;1m572 | [0m[35m        if len(set_senv_kwargs) > 1:[0m
[30;1m573 | [0m[35m            raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m433 | [0m[35m        Start a Jupyter server in the same process as Dask scheduler. The Jupyter server will be beh[0m
[30;1m434 | [0m[35m        with authentication (unless you disable ``use_dashboard_https``, which we strongly recommend[0m
[30;1m435 | [0m[35m        Note that ``jupyterlab`` will need to be installed in the software environment used on the c[0m
[30;1m436 | [0m[35m        (or in your local environment if using package sync).[0m
[30;1m437 | [0m[35m        Once the cluster is running, you can use ``jupyter_link`` to get link to access the Jupyter [0m
[30;1m438 | [0m[35m    mount_bucket[0m
[30;1m439 | [0m[35m        Optional name or list of names of buckets to mount. For example, ``"s3://my-s3-bucket"`` wil[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m378 | [0m[35m        conflicts with local packages. Note, this will only work for conda package with[0m
[30;1m379 | [0m[35m        platform-specific builds (i.e., not "noarch" packages).[0m
[30;1m380 | [0m[35m    package_sync_ignore[0m
[30;1m381 | [0m[35m        A list of package names to exclude from the environment. Note their dependencies may still b[0m
[30;1m382 | [0m[35m        or they may be installed by another package that depends on them![0m
[30;1m383 | [0m[35m    package_sync_only[0m
[30;1m384 | [0m[35m        A list of package names to only include from the environment. Use with caution.[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m374 | [0m[35m        `additional documentation for this feature <https://docs.coiled.io/user_guide/package_sync.h[0m
[30;1m375 | [0m[35m    package_sync_conda_extras[0m
[30;1m376 | [0m[35m        A list of conda package names (available on conda-forge) to include in the environment that[0m
[30;1m377 | [0m[35m        are not in your local environment. Use with caution, as this can lead to dependency[0m
[30;1m378 | [0m[35m        conflicts with local packages. Note, this will only work for conda package with[0m
[30;1m379 | [0m[35m        platform-specific builds (i.e., not "noarch" packages).[0m
[30;1m380 | [0m[35m    package_sync_ignore[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/aws.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m                    token_creds = AWSSessionCredentials([0m
[30;1m84 | [0m[35m                        AccessKeyId=frozen_creds.access_key,[0m
[30;1m85 | [0m[35m                        SecretAccessKey=frozen_creds.secret_key,[0m
[30;1m86 | [0m[35m                        SessionToken=frozen_creds.token,[0m
[30;1m87 | [0m[35m                        Expiration=expiration,[0m
[30;1m88 | [0m[35m                        DefaultRegion=session.region_name,[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m716 | [0m[35m    # Include netrc auth in URLs if available[0m
[30;1m717 | [0m[35m    authed_index_urls = [][0m
[30;1m718 | [0m[35m    for index_url in index_urls:[0m
[30;1m719 | [0m[35m        # Do not bother checking for passwords to pypi.org[0m
[30;1m720 | [0m[35m        if index_url != DEFAULT_PYPI_URL:[0m
[30;1m721 | [0m[35m            try:[0m
[30;1m722 | [0m[35m                parsed_url = parse_url(index_url)[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m706 | [0m[35m        logger.debug(f"Getting password from keyring for {url}")[0m
[30;1m707 | [0m[35m        password = keyring.get_password(url, username)  # type: ignore[reportPossiblyUnboundVariable[0m
[30;1m708 | [0m[35m        if password:[0m
[30;1m709 | [0m[35m            return username, password[0m
[30;1m710 | [0m[35m    return None[0m
[30;1m711 | [0m[35m[0m
[30;1m712 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m705 | [0m[35m    if username is not None:[0m
[30;1m706 | [0m[35m        logger.debug(f"Getting password from keyring for {url}")[0m
[30;1m707 | [0m[35m        password = keyring.get_password(url, username)  # type: ignore[reportPossiblyUnboundVariable[0m
[30;1m708 | [0m[35m        if password:[0m
[30;1m709 | [0m[35m            return username, password[0m
[30;1m710 | [0m[35m    return None[0m
[30;1m711 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35m    if username is not None:[0m
[30;1m706 | [0m[35m        logger.debug(f"Getting password from keyring for {url}")[0m
[30;1m707 | [0m[35m        password = keyring.get_password(url, username)  # type: ignore[reportPossiblyUnboundVariable[0m
[30;1m708 | [0m[35m        if password:[0m
[30;1m709 | [0m[35m            return username, password[0m
[30;1m710 | [0m[35m    return None[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35m    if username is not None:[0m
[30;1m706 | [0m[35m        logger.debug(f"Getting password from keyring for {url}")[0m
[30;1m707 | [0m[35m        password = keyring.get_password(url, username)  # type: ignore[reportPossiblyUnboundVariable[0m
[30;1m708 | [0m[35m        if password:[0m
[30;1m709 | [0m[35m            return username, password[0m
[30;1m710 | [0m[35m    return None[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m703 | [0m[35m        return None[0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35m    if username is not None:[0m
[30;1m706 | [0m[35m        logger.debug(f"Getting password from keyring for {url}")[0m
[30;1m707 | [0m[35m        password = keyring.get_password(url, username)  # type: ignore[reportPossiblyUnboundVariable[0m
[30;1m708 | [0m[35m        if password:[0m
[30;1m709 | [0m[35m            return username, password[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m699 | [0m[35m        logger.debug(f"Getting credentials from keyring for {url}")[0m
[30;1m700 | [0m[35m        cred = keyring.get_credential(url, username)  # type: ignore[reportPossiblyUnboundVariable][0m
[30;1m701 | [0m[35m        if cred is not None:[0m
[30;1m702 | [0m[35m            return cred.username, cred.password[0m
[30;1m703 | [0m[35m        return None[0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35m    if username is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m675 | [0m[35m        try:[0m
[30;1m676 | [0m[35m            _netrc = netrc(netrc_path).authenticators(host)[0m
[30;1m677 | [0m[35m            if _netrc:[0m
[30;1m678 | [0m[35m                # Return with login / password[0m
[30;1m679 | [0m[35m                login_i = 0 if _netrc[0] else 1[0m
[30;1m680 | [0m[35m                return (_netrc[login_i], _netrc[2])[0m
[30;1m681 | [0m[35m        except (NetrcParseError, OSError):[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m628 | [0m[35m        if username and not password:[0m
[30;1m629 | [0m[35m            logger.info(f"No password found for {parsed_url.url}")[0m
[30;1m630 | [0m[35m        elif not username:[0m
[30;1m631 | [0m[35m            logger.info(f"No username or password found for {parsed_url.url}")[0m
[30;1m632 | [0m[35m[0m
[30;1m633 | [0m[35m    return parsed_url.url[0m
[30;1m634 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m626 | [0m[35m            parsed_url = parsed_url._replace(auth=f"{username or ''}:{password or ''}")[0m
[30;1m627 | [0m[35m[0m
[30;1m628 | [0m[35m        if username and not password:[0m
[30;1m629 | [0m[35m            logger.info(f"No password found for {parsed_url.url}")[0m
[30;1m630 | [0m[35m        elif not username:[0m
[30;1m631 | [0m[35m            logger.info(f"No username or password found for {parsed_url.url}")[0m
[30;1m632 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m625 | [0m[35m        elif username or password:[0m
[30;1m626 | [0m[35m            parsed_url = parsed_url._replace(auth=f"{username or ''}:{password or ''}")[0m
[30;1m627 | [0m[35m[0m
[30;1m628 | [0m[35m        if username and not password:[0m
[30;1m629 | [0m[35m            logger.info(f"No password found for {parsed_url.url}")[0m
[30;1m630 | [0m[35m        elif not username:[0m
[30;1m631 | [0m[35m            logger.info(f"No username or password found for {parsed_url.url}")[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m623 | [0m[35m                parsed_url = parsed_url._replace(path=f"/t/{password}{path}")[0m
[30;1m624 | [0m[35m            parsed_url = parsed_url._replace(auth=None)[0m
[30;1m625 | [0m[35m        elif username or password:[0m
[30;1m626 | [0m[35m            parsed_url = parsed_url._replace(auth=f"{username or ''}:{password or ''}")[0m
[30;1m627 | [0m[35m[0m
[30;1m628 | [0m[35m        if username and not password:[0m
[30;1m629 | [0m[35m            logger.info(f"No password found for {parsed_url.url}")[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m622 | [0m[35m            if not path.startswith("/t/"):[0m
[30;1m623 | [0m[35m                parsed_url = parsed_url._replace(path=f"/t/{password}{path}")[0m
[30;1m624 | [0m[35m            parsed_url = parsed_url._replace(auth=None)[0m
[30;1m625 | [0m[35m        elif username or password:[0m
[30;1m626 | [0m[35m            parsed_url = parsed_url._replace(auth=f"{username or ''}:{password or ''}")[0m
[30;1m627 | [0m[35m[0m
[30;1m628 | [0m[35m        if username and not password:[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m620 | [0m[35m            # If the username indicates this is a token (which only happens for mamba auth)[0m
[30;1m621 | [0m[35m            # the token should be embedded directly in the URL and not in the auth portion[0m
[30;1m622 | [0m[35m            if not path.startswith("/t/"):[0m
[30;1m623 | [0m[35m                parsed_url = parsed_url._replace(path=f"/t/{password}{path}")[0m
[30;1m624 | [0m[35m            parsed_url = parsed_url._replace(auth=None)[0m
[30;1m625 | [0m[35m        elif username or password:[0m
[30;1m626 | [0m[35m            parsed_url = parsed_url._replace(auth=f"{username or ''}:{password or ''}")[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m615 | [0m[35m            or get_mamba_auth(netloc)[0m
[30;1m616 | [0m[35m        )[0m
[30;1m617 | [0m[35m        if auth_parts is not None:[0m
[30;1m618 | [0m[35m            username, password = auth_parts[0m
[30;1m619 | [0m[35m        if username == AUTH_BEARER_USERNAME:[0m
[30;1m620 | [0m[35m            # If the username indicates this is a token (which only happens for mamba auth)[0m
[30;1m621 | [0m[35m            # the token should be embedded directly in the URL and not in the auth portion[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m603 | [0m[35m    path = parsed_url.path or ""[0m
[30;1m604 | [0m[35m    netloc = parsed_url.netloc or ""[0m
[30;1m605 | [0m[35m[0m
[30;1m606 | [0m[35m    if not password:[0m
[30;1m607 | [0m[35m        auth_parts = ([0m
[30;1m608 | [0m[35m            # netrc stores things based on entire URL (including username in URL if present)[0m
[30;1m609 | [0m[35m            get_netrc_auth(parsed_url.url)[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m598 | [0m[35m        auth_parts = parsed_url.auth.split(":", 1)[0m
[30;1m599 | [0m[35m        if len(auth_parts) < 2:[0m
[30;1m600 | [0m[35m            auth_parts += [None][0m
[30;1m601 | [0m[35m        username, password = auth_parts[0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35m    path = parsed_url.path or ""[0m
[30;1m604 | [0m[35m    netloc = parsed_url.netloc or ""[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m593 | [0m[35m    else:[0m
[30;1m594 | [0m[35m        parsed_url = url[0m
[30;1m595 | [0m[35m    username = None[0m
[30;1m596 | [0m[35m    password = None[0m
[30;1m597 | [0m[35m    if parsed_url.auth:[0m
[30;1m598 | [0m[35m        auth_parts = parsed_url.auth.split(":", 1)[0m
[30;1m599 | [0m[35m        if len(auth_parts) < 2:[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m582 | [0m[35m[0m
[30;1m583 | [0m[35m@functools.lru_cache[0m
[30;1m584 | [0m[35mdef set_auth_for_url(url: Url | str) -> str:[0m
[30;1m585 | [0m[35m    """Returns a url string with the user and password set from netrc, keyring, mamba, or the URL it[0m
[30;1m586 | [0m[35m    if isinstance(url, str):[0m
[30;1m587 | [0m[35m        try:[0m
[30;1m588 | [0m[35m            parsed_url = parse_url(url)[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m568 | [0m[35m                if auth_type == "CondaToken" or auth_type == "BearerToken":[0m
[30;1m569 | [0m[35m                    domain_auth[domain] = (AUTH_BEARER_USERNAME, auth["token"])[0m
[30;1m570 | [0m[35m                elif auth_type == "BasicHTTPAuthentication":[0m
[30;1m571 | [0m[35m                    domain_auth[domain] = (auth.get("user") or "", auth.get("password") or "")[0m
[30;1m572 | [0m[35m                else:[0m
[30;1m573 | [0m[35m                    logger.debug(f"Encountered unknown mamba auth type {auth_type} for domain {domai[0m
[30;1m574 | [0m[35m    return domain_auth[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m640 | [0m[35mdef get_netrc_auth(url: str, raise_errors=False) -> tuple[str | None, str | None] | None:[0m
[30;1m641 | [0m[35m    """Returns the Requests tuple auth for a given url from netrc."""[0m
[30;1m642 | [0m[35m[0m
[30;1m643 | [0m[35m    netrc_file = os.environ.get("NETRC")[0m
[30;1m644 | [0m[35m    if netrc_file is not None:[0m
[30;1m645 | [0m[35m        netrc_locations = (netrc_file,)[0m
[30;1m646 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m547 | [0m[35m    extra_index_urls.extend(os.environ.get("PIP_EXTRA_INDEX_URL", "").split())[0m
[30;1m548 | [0m[35m    extra_index_urls.extend(os.environ.get("UV_EXTRA_INDEX_URL", "").split())[0m
[30;1m549 | [0m[35m    index_url = os.environ.get("PIP_INDEX_URL", os.environ.get("PIP_PYPI_URL", index_url))[0m
[30;1m550 | [0m[35m    index_url = os.environ.get("UV_INDEX_URL", index_url)[0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m    extra_index_urls = sorted(set(extra_index_urls) - {index_url})[0m
[30;1m553 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m546 | [0m[35m    # See https://pip.pypa.io/en/stable/topics/configuration/#precedence-override-order[0m
[30;1m547 | [0m[35m    extra_index_urls.extend(os.environ.get("PIP_EXTRA_INDEX_URL", "").split())[0m
[30;1m548 | [0m[35m    extra_index_urls.extend(os.environ.get("UV_EXTRA_INDEX_URL", "").split())[0m
[30;1m549 | [0m[35m    index_url = os.environ.get("PIP_INDEX_URL", os.environ.get("PIP_PYPI_URL", index_url))[0m
[30;1m550 | [0m[35m    index_url = os.environ.get("UV_INDEX_URL", index_url)[0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m    extra_index_urls = sorted(set(extra_index_urls) - {index_url})[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m545 | [0m[35m    # Environment variables take precedence over config files[0m
[30;1m546 | [0m[35m    # See https://pip.pypa.io/en/stable/topics/configuration/#precedence-override-order[0m
[30;1m547 | [0m[35m    extra_index_urls.extend(os.environ.get("PIP_EXTRA_INDEX_URL", "").split())[0m
[30;1m548 | [0m[35m    extra_index_urls.extend(os.environ.get("UV_EXTRA_INDEX_URL", "").split())[0m
[30;1m549 | [0m[35m    index_url = os.environ.get("PIP_INDEX_URL", os.environ.get("PIP_PYPI_URL", index_url))[0m
[30;1m550 | [0m[35m    index_url = os.environ.get("UV_INDEX_URL", index_url)[0m
[30;1m551 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m544 | [0m[35m[0m
[30;1m545 | [0m[35m    # Environment variables take precedence over config files[0m
[30;1m546 | [0m[35m    # See https://pip.pypa.io/en/stable/topics/configuration/#precedence-override-order[0m
[30;1m547 | [0m[35m    extra_index_urls.extend(os.environ.get("PIP_EXTRA_INDEX_URL", "").split())[0m
[30;1m548 | [0m[35m    extra_index_urls.extend(os.environ.get("UV_EXTRA_INDEX_URL", "").split())[0m
[30;1m549 | [0m[35m    index_url = os.environ.get("PIP_INDEX_URL", os.environ.get("PIP_PYPI_URL", index_url))[0m
[30;1m550 | [0m[35m    index_url = os.environ.get("UV_INDEX_URL", index_url)[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m542 | [0m[35m    index_url = pixi_conf.get("index-url") or index_url[0m
[30;1m543 | [0m[35m    extra_index_urls.extend(pixi_conf.get("extra-index-urls", []))[0m
[30;1m544 | [0m[35m[0m
[30;1m545 | [0m[35m    # Environment variables take precedence over config files[0m
[30;1m546 | [0m[35m    # See https://pip.pypa.io/en/stable/topics/configuration/#precedence-override-order[0m
[30;1m547 | [0m[35m    extra_index_urls.extend(os.environ.get("PIP_EXTRA_INDEX_URL", "").split())[0m
[30;1m548 | [0m[35m    extra_index_urls.extend(os.environ.get("UV_EXTRA_INDEX_URL", "").split())[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m        open_ssh([0m
[30;1m354 | [0m[35m            address=scheduler_address,[0m
[30;1m355 | [0m[35m            key=ssh_info["private_key"],[0m
[30;1m356 | [0m[35m            jump_to_address=ssh_info["worker_address"],[0m
[30;1m357 | [0m[35m            host_command=command,[0m
[30;1m358 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m341 | [0m[35m            )[0m
[30;1m342 | [0m[35m            return[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m        if not ssh_info["private_key"]:[0m
[30;1m345 | [0m[35m            print("Unable to retrieve SSH key")[0m
[30;1m346 | [0m[35m            return[0m
[30;1m347 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    elif delete_key:[0m
[30;1m321 | [0m[35m        # just delete the key[0m
[30;1m322 | [0m[35m        remove_ssh_access(scheduler_address, key=ssh_info["private_key"])[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m    else:[0m
[30;1m325 | [0m[35m        if not check_ssh_agent():[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m    if add_key:[0m
[30;1m317 | [0m[35m        # just add the key, maybe you want to use rsync or something like that[0m
[30;1m318 | [0m[35m        add_ssh_access(scheduler_address, key=ssh_info["private_key"])[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    elif delete_key:[0m
[30;1m321 | [0m[35m        # just delete the key[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35mdef _add_coiled_to_ssh_config(coiled_config_path):[0m
[30;1m155 | [0m[35m    ssh_dir = Path(os.path.expanduser("~")) / ".ssh"[0m
[30;1m156 | [0m[35m    ssh_config_path = ssh_dir / "config"[0m
[30;1m157 | [0m[35m    include_line = f"Include {coiled_config_path}"[0m
[30;1m158 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35m            if "dask.host" in user_config:[0m
[30;1m53 | [0m[35m                return True[0m
[30;1m54 | [0m[35m            if re.search("IdentityAgent[^\n]+1password", user_config):[0m
[30;1m55 | [0m[35m                print("Coiled cannot add temporary SSH key to [bold]1Password SSH Agent[/bold].")[0m
[30;1m56 | [0m[35m                print([0m
[30;1m57 | [0m[35m                    "You can explicitly allow Coiled to use the system SSH agent by adding these lin[0m
[30;1m58 | [0m[35m                    f"beginning of [green]{user_config_path}[/green]:\n\n{DEFAULT_SSH_AGENT_CONFIG}\[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m            user_config = f.read()[0m
[30;1m52 | [0m[35m            if "dask.host" in user_config:[0m
[30;1m53 | [0m[35m                return True[0m
[30;1m54 | [0m[35m            if re.search("IdentityAgent[^\n]+1password", user_config):[0m
[30;1m55 | [0m[35m                print("Coiled cannot add temporary SSH key to [bold]1Password SSH Agent[/bold].")[0m
[30;1m56 | [0m[35m                print([0m
[30;1m57 | [0m[35m                    "You can explicitly allow Coiled to use the system SSH agent by adding these lin[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mdef check_ssh_agent():[0m
[30;1m48 | [0m[35m    user_config_path = Path(os.path.expanduser("~")) / ".ssh" / "config"[0m
[30;1m49 | [0m[35m    if user_config_path.exists():[0m
[30;1m50 | [0m[35m        with open(user_config_path) as f:[0m
[30;1m51 | [0m[35m            user_config = f.read()[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m91 | [0m[35m            raise FileNotFoundError([0m
[30;1m92 | [0m[35m                f"Unable to find file '{pip}', please make sure it exists "[0m
[30;1m93 | [0m[35m                "and the path is correct. If you are trying to create a "[0m
[30;1m94 | [0m[35m                "software environment by specifying dependencies, you can "[0m
[30;1m95 | [0m[35m                "do so by passing a list of dependencies. For example:\n"[0m
[30;1m96 | [0m[35m                "\tcoiled.create_software_environment(\n"[0m
[30;1m97 | [0m[35m                "\t    name='my-env', pip=['coiled']\n"[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m27 | [0m[35m            "software environment by specifying dependencies, you can "[0m
[30;1m28 | [0m[35m            "do so by passing a list of dependencies or a dictionary. For example:\n"[0m
[30;1m29 | [0m[35m            "\tcoiled.create_software_environment(\n"[0m
[30;1m30 | [0m[35m            "\t    name='my-env', conda={'channels': ['conda-forge'], 'dependencies': ['coiled']}\n"[0m
[30;1m31 | [0m[35m            "\t)"[0m
[30;1m32 | [0m[35m        ) from None[0m
[30;1m33 | [0m[35m    return {[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m24 | [0m[35m        raise FileNotFoundError([0m
[30;1m25 | [0m[35m            f"Unable to find file '{env_path}', please make sure it exists "[0m
[30;1m26 | [0m[35m            "and the path is correct. If you are trying to create a "[0m
[30;1m27 | [0m[35m            "software environment by specifying dependencies, you can "[0m
[30;1m28 | [0m[35m            "do so by passing a list of dependencies or a dictionary. For example:\n"[0m
[30;1m29 | [0m[35m            "\tcoiled.create_software_environment(\n"[0m
[30;1m30 | [0m[35m            "\t    name='my-env', conda={'channels': ['conda-forge'], 'dependencies': ['coiled']}\n"[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m489 | [0m[35m            # a non python package and safe to include[0m
[30;1m490 | [0m[35m            filtered_conda[pypi_name] = packages[0][0m
[30;1m491 | [0m[35m    # remove conda placeholders (there won't be any by here but this makes pyright happy)[0m
[30;1m492 | [0m[35m    pip_env = {pkg_name: pkg for pkg_name, pkg in pip_env.items() if not isinstance(pkg, CondaPlaceH[0m
[30;1m493 | [0m[35m    results = sorted([0m
[30;1m494 | [0m[35m        list(pip_env.values()) + list(filtered_conda.values()),[0m
[30;1m495 | [0m[35m        key=lambda pkg: pkg["name"],[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m458 | [0m[35m        # if a package exists in the pip list but is not a conda place holder[0m
[30;1m459 | [0m[35m        # then the conda package wont be imported and should be discarded[0m
[30;1m460 | [0m[35m        found = False[0m
[30;1m461 | [0m[35m        if pip_env.get(pypi_name):[0m
[30;1m462 | [0m[35m            found = True[0m
[30;1m463 | [0m[35m            pip_package = pip_env[pypi_name][0m
[30;1m464 | [0m[35m            if isinstance(pip_package, CondaPlaceHolder):[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m449 | [0m[35m        site_pkgs_paths = {Path(p).resolve() for p in site.getsitepackages() + [site.getusersitepack[0m
[30;1m450 | [0m[35m    conda_env_future = asyncio.create_task(scan_conda(prefix=prefix, progress=progress))[0m
[30;1m451 | [0m[35m    # only pass locations to support testing, otherwise we should be using sys.path[0m
[30;1m452 | [0m[35m    pip_env_future = asyncio.create_task(scan_pip(locations=locations, progress=progress))[0m
[30;1m453 | [0m[35m    conda_env = await conda_env_future[0m
[30;1m454 | [0m[35m    pip_env = await pip_env_future[0m
[30;1m455 | [0m[35m    filtered_conda = {}[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m447 | [0m[35m            logger.debug("Current working directory was deleted")[0m
[30;1m448 | [0m[35m    if not site_pkgs_paths:[0m
[30;1m449 | [0m[35m        site_pkgs_paths = {Path(p).resolve() for p in site.getsitepackages() + [site.getusersitepack[0m
[30;1m450 | [0m[35m    conda_env_future = asyncio.create_task(scan_conda(prefix=prefix, progress=progress))[0m
[30;1m451 | [0m[35m    # only pass locations to support testing, otherwise we should be using sys.path[0m
[30;1m452 | [0m[35m    pip_env_future = asyncio.create_task(scan_pip(locations=locations, progress=progress))[0m
[30;1m453 | [0m[35m    conda_env = await conda_env_future[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m11 | [0m[35mimport subprocess[0m
[30;1m12 | [0m[35mimport sys[0m
[30;1m13 | [0m[35mimport typing[0m
[30;1m14 | [0m[35mfrom base64 import urlsafe_b64encode[0m
[30;1m15 | [0m[35mfrom collections import defaultdict[0m
[30;1m16 | [0m[35mfrom logging import getLogger[0m
[30;1m17 | [0m[35mfrom pathlib import Path[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35mfrom .get_address import get_address[0m
[30;1m8 | [0m[35mfrom .list import list_clusters[0m
[30;1m9 | [0m[35mfrom .logs import logs[0m
[30;1m10 | [0m[35mfrom .ssh import ssh[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m@click.group(context_settings=CONTEXT_SETTINGS)[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/extensions/prefect/runners.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m16 | [0m[35m            # by the Prefect Worker implementation.[0m
[30;1m17 | [0m[35m            # TODO: Configurable in re-using cluster for flows?[0m
[30;1m18 | [0m[35m            name = self.cluster_kwargs.get("name")[0m
[30;1m19 | [0m[35m            cluster_name = os.environ.get("COILED__CLUSTER_NAME")[0m
[30;1m20 | [0m[35m            if not name and cluster_name:[0m
[30;1m21 | [0m[35m                self.cluster_kwargs["name"] = cluster_name[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/run.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m505 | [0m[35m        "n_workers": n_task_workers,[0m
[30;1m506 | [0m[35m        "software": kwargs["software"],[0m
[30;1m507 | [0m[35m        "show_widget": True,[0m
[30;1m508 | [0m[35m        # batch job can either run in normal Coiled software env (which defaults to package sync)[0m
[30;1m509 | [0m[35m        # or can run in an extra container (which doesn't need to include dask)[0m
[30;1m510 | [0m[35m        "batch_job_container": kwargs["container"],[0m
[30;1m511 | [0m[35m        # if batch job is running in extra container, then we just need a pretty minimal dask contai[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/prometheus.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m70 | [0m[35m      sigV4Region: {creds["region"]}[0m
[30;1m71 | [0m[35m    secureJsonData:[0m
[30;1m72 | [0m[35m      sigV4AccessKey: {creds["sigv4_key"]}[0m
[30;1m73 | [0m[35m      sigV4SecretKey: {creds["sigv4_secret"]}[0m
[30;1m74 | [0m[35m"""[0m
[30;1m75 | [0m[35m    filename = re.sub(r"[^\w]+", "-", creds["name"])[0m
[30;1m76 | [0m[35m    filename = f"{filename}.yaml"[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m595 | [0m[35m            zone_desc = f" ({zone})" if zone else ""[0m
[30;1m596 | [0m[35m            cluster_name = self._cluster_details["name"][0m
[30;1m597 | [0m[35m            env_name = self._cluster_details["senv_alias"]["name"][0m
[30;1m598 | [0m[35m            if env_name.startswith("package-sync-"):[0m
[30;1m599 | [0m[35m                env_name = ""[0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35m            statuses = get_worker_statuses(self._cluster_details)[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m290 | [0m[35m            if env_name.startswith("package-sync-"):[0m
[30;1m291 | [0m[35m                env_name = ""[0m
[30;1m292 | [0m[35m                local_env_name = Path(sys.prefix).name[0m
[30;1m293 | [0m[35m                env_line = f"[bold green]Synced local Python environment:[/bold green] {local_env_na[0m
[30;1m294 | [0m[35m            else:[0m
[30;1m295 | [0m[35m                local_env_name = ""[0m
[30;1m296 | [0m[35m                env_line = f"[bold green]Environment:[/bold green] {env_name}"[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m287 | [0m[35m            zone_desc = f" ({zone})" if zone else ""[0m
[30;1m288 | [0m[35m            link = get_details_url(self.server, self.workspace, self._cluster_details["id"])[0m
[30;1m289 | [0m[35m            env_name = self._cluster_details["senv_alias"]["name"][0m
[30;1m290 | [0m[35m            if env_name.startswith("package-sync-"):[0m
[30;1m291 | [0m[35m                env_name = ""[0m
[30;1m292 | [0m[35m                local_env_name = Path(sys.prefix).name[0m
[30;1m293 | [0m[35m                env_line = f"[bold green]Synced local Python environment:[/bold green] {local_env_na[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m357 | [0m[35m    creds_to_submit = {[0m
[30;1m358 | [0m[35m        "tenant_id": app_creds["tenant"],[0m
[30;1m359 | [0m[35m        "client_id": app_creds["appId"],[0m
[30;1m360 | [0m[35m        "client_secret": app_creds["password"],[0m
[30;1m361 | [0m[35m    }[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m    print("Sending Azure credentials to Coiled... ", end="")[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m# send creds to coiled[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35mAPP_PASS=$(jq -r '.password' app-creds.json)[0m
[30;1m111 | [0m[35mAPP_ID=$(jq -r '.appId' app-creds.json)[0m
[30;1m112 | [0m[35mTENANT=$(jq -r '.tenant' app-creds.json)[0m
[30;1m113 | [0m[35mSETUP_ENDPOINT=/api/v2/cloud-credentials/${COILED_ACCOUNT}/azure[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/amp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m            account=account,[0m
[30;1m81 | [0m[35m        )[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        write_auth = {"sigv4": {"region": region, "access_key": key, "secret_key": secret}}[0m
[30;1m84 | [0m[35m        created_info["write_auth"] = write_auth[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        if verbose:[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35mdef get_ssh_connection(cloud, cluster_id) -> fabric.connection.Connection:[0m
[30;1m64 | [0m[35m    ssh_info = cloud.get_ssh_key(cluster_id=cluster_id)[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    with io.StringIO(ssh_info["private_key"]) as f:[0m
[30;1m67 | [0m[35m        pkey = Ed25519Key(file_obj=f)[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    ssh_address = ssh_info["scheduler_address_to_use"][0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m759 | [0m[35m                    if forward_gcp_adc:[0m
[30;1m760 | [0m[35m                        gcp_creds_to_forward = send_application_default_credentials(cluster, return_[0m
[30;1m761 | [0m[35m                        if gcp_creds_to_forward:[0m
[30;1m762 | [0m[35m                            runtime_env_dict = {**gcp_creds_to_forward.get("env", {}), **runtime_env[0m
[30;1m763 | [0m[35m[0m
[30;1m764 | [0m[35m                    _connection, _container_command, results = run_via_ssh([0m
[30;1m765 | [0m[35m                        cloud=cloud,[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m293 | [0m[35m    interactive: bool = False,[0m
[30;1m294 | [0m[35m    detach: bool = False,[0m
[30;1m295 | [0m[35m    env: dict | None = None,[0m
[30;1m296 | [0m[35m    env_unset: Sequence[str] | None = None,[0m
[30;1m297 | [0m[35m    as_root: bool = False,[0m
[30;1m298 | [0m[35m    workdir: str = "/scratch",[0m
[30;1m299 | [0m[35m    entrypoint: str = "",[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m225 | [0m[35m    else:[0m
[30;1m226 | [0m[35m        entrypoint = get_entrypoint(connection, container_name=DEFAULT_DASK_CONTAINER)[0m
[30;1m227 | [0m[35m        if "cloud-env" in entrypoint:[0m
[30;1m228 | [0m[35m            # hack for cloud-env containers (e.g., package sync) currently required to avoid re-down[0m
[30;1m229 | [0m[35m            # once container is suitably changed, we should just be able to use entrypoint like any [0m
[30;1m230 | [0m[35m            entrypoint = "micromamba run -p /opt/coiled/env"[0m
[30;1m231 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m150 | [0m[35m    skip_entrypoint: bool,[0m
[30;1m151 | [0m[35m    interactive: bool,[0m
[30;1m152 | [0m[35m    detach: bool,[0m
[30;1m153 | [0m[35m    env_unset: Sequence[str] | None = None,[0m
[30;1m154 | [0m[35m    workdir: str = "/scratch",[0m
[30;1m155 | [0m[35m    as_root: bool = False,[0m
[30;1m156 | [0m[35m    in_container_files: Dict[str, str] | None = None,[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m214 | [0m[35m        if not token:[0m
[30;1m215 | [0m[35m            # It's not the normal use-case, but Coiled can also set this env on local client machine[0m
[30;1m216 | [0m[35m            # so that you can use `CoiledShippedCredentials` (with same OAuth2 token) locally and on[0m
[30;1m217 | [0m[35m            token = os.environ.get("COILED_LOCAL_CLOUDSDK_AUTH_ACCESS_TOKEN")[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m        if not token:[0m
[30;1m220 | [0m[35m            # print rather than log since we don't know how logging is configure on the cluster[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m209 | [0m[35m        except Exception:[0m
[30;1m210 | [0m[35m            pass[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        token = os.environ.get("CLOUDSDK_AUTH_ACCESS_TOKEN")[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        if not token:[0m
[30;1m215 | [0m[35m            # It's not the normal use-case, but Coiled can also set this env on local client machine[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m180 | [0m[35m        if GoogleOAuth2Credentials is _FakeCredentialsBase:[0m
[30;1m181 | [0m[35m            raise ImportError("Unable to create Google Credentials object because google-cloud-iam i[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m        env_token = self.get_shipped_token()[0m
[30;1m184 | [0m[35m        if token and env_token and token != env_token:[0m
[30;1m185 | [0m[35m            raise ValueError([0m
[30;1m186 | [0m[35m                "Specified Google OAuth2 token does not match "[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35mfrom urllib3.util import parse_url[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mimport coiled[0m
[30;1m21 | [0m[35mfrom coiled.cli.cluster.ssh import check_ssh_agent[0m
[30;1m22 | [0m[35mfrom coiled.compatibility import DISTRIBUTED_VERSION[0m
[30;1m23 | [0m[35mfrom coiled.errors import DoesNotExist[0m
[30;1m24 | [0m[35mfrom coiled.software_utils import make_coiled_local_name[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/env.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m        server = config.get("coiled.server", COILED_SERVER).replace("8000", "5173")[0m
[30;1m168 | [0m[35m        account = workspace or config.get("coiled.workspace", config.get("coiled.account"))[0m
[30;1m169 | [0m[35m        for env_name, env_details in environments.items():[0m
[30;1m170 | [0m[35m            latest_build = env_details["latest_spec"].get("latest_build")[0m
[30;1m171 | [0m[35m            if latest_build:[0m
[30;1m172 | [0m[35m                build_status = latest_build["state"] if latest_build["state"] != "error" else "[red][0m
[30;1m173 | [0m[35m                env_url = f"{server}/software/alias/{env_details['id']}/build/{latest_build['id']}?a[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/env.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m        table.add_column("Link", style="magenta")[0m
[30;1m166 | [0m[35m        table.add_column("Status", style="green")[0m
[30;1m167 | [0m[35m        server = config.get("coiled.server", COILED_SERVER).replace("8000", "5173")[0m
[30;1m168 | [0m[35m        account = workspace or config.get("coiled.workspace", config.get("coiled.account"))[0m
[30;1m169 | [0m[35m        for env_name, env_details in environments.items():[0m
[30;1m170 | [0m[35m            latest_build = env_details["latest_spec"].get("latest_build")[0m
[30;1m171 | [0m[35m            if latest_build:[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/env.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m        table.add_column("Link", style="magenta")[0m
[30;1m166 | [0m[35m        table.add_column("Status", style="green")[0m
[30;1m167 | [0m[35m        server = config.get("coiled.server", COILED_SERVER).replace("8000", "5173")[0m
[30;1m168 | [0m[35m        account = workspace or config.get("coiled.workspace", config.get("coiled.account"))[0m
[30;1m169 | [0m[35m        for env_name, env_details in environments.items():[0m
[30;1m170 | [0m[35m            latest_build = env_details["latest_spec"].get("latest_build")[0m
[30;1m171 | [0m[35m            if latest_build:[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/env.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        table.add_column("Updated", style="magenta")[0m
[30;1m165 | [0m[35m        table.add_column("Link", style="magenta")[0m
[30;1m166 | [0m[35m        table.add_column("Status", style="green")[0m
[30;1m167 | [0m[35m        server = config.get("coiled.server", COILED_SERVER).replace("8000", "5173")[0m
[30;1m168 | [0m[35m        account = workspace or config.get("coiled.workspace", config.get("coiled.account"))[0m
[30;1m169 | [0m[35m        for env_name, env_details in environments.items():[0m
[30;1m170 | [0m[35m            latest_build = env_details["latest_spec"].get("latest_build")[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/env.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m197 | [0m[35m        Identifier of the software environment to use, in the format (<account>/)<name>. If the soft[0m
[30;1m198 | [0m[35m        is owned by the same account as that passed into "account", the (<account>/) prefix is optio[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        For example, suppose your account is "wondercorp", but your friends at "friendlycorp" have a[0m
[30;1m201 | [0m[35m        named "xgboost" that you want to use; you can specify this with "friendlycorp/xgboost". If y[0m
[30;1m202 | [0m[35m        entered "xgboost", this is shorthand for "wondercorp/xgboost".[0m
[30;1m203 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/env.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m@env.command(context_settings=CONTEXT_SETTINGS)[0m
[30;1m26 | [0m[35m@click.option("-n", "--name", help="Name of software environment, it must be lowercase.")[0m
[30;1m27 | [0m[35m@click.option("--container", default=None, help="Base docker image to use.")[0m
[30;1m28 | [0m[35m@click.option([0m
[30;1m29 | [0m[35m    "--ignore-container-entrypoint",[0m
[30;1m30 | [0m[35m    default=False,[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m.hostname[0m
[30;1m172 | [0m[35m        console.print("[bold]Launching file synchronization...[/]")[0m
[30;1m173 | [0m[35m        ssh_info = cloud.get_ssh_key(cluster_id)[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m        scheduler_address = ssh_info["scheduler_hostname"] or ssh_info["scheduler_public_address"][0m
[30;1m176 | [0m[35m        target = f"ubuntu@{scheduler_address}"[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m        add_ssh_access(scheduler_address, key=ssh_info["private_key"])[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m.hostname[0m
[30;1m55 | [0m[35m        subprocess.run([mutagen_path, "sync", "terminate", MUTAGEN_NAME_FORMAT.format(cluster_id=clu[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        ssh_info = cloud.get_ssh_key(cluster_id)[0m
[30;1m58 | [0m[35m        scheduler_address = ssh_info["scheduler_hostname"] or ssh_info["scheduler_address_to_use"][0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        remove_ssh_access(scheduler_address, key=ssh_info["private_key"])[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m255 | [0m[35m        #  the image before running, and bind-mount `/sync` on the host to `$workdir/sync`[0m
[30;1m256 | [0m[35m        #  in the container? Custom docker images make this tricky; we can't assume anything[0m
[30;1m257 | [0m[35m        #  about the directory layout or what the working directory will be.[0m
[30;1m258 | [0m[35m        inside_dir_setup = f"docker exec tmp-dask-1 bash -c 'ln -s {SYNC_TARGET} .'"[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        symlink_command = [[0m
[30;1m261 | [0m[35m            "ssh",[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35mdef stop_sync(cloud, cluster_id, message=None, wait=False):[0m
[30;1m40 | [0m[35m    mutagen_path = get_mutagen_path()[0m
[30;1m41 | [0m[35m    if cluster_id and mutagen_path and mutagen_session_exists(cluster_id):[0m
[30;1m42 | [0m[35m        # NOTE: we can't tell if the user asked for `--sync` or not at creation.[0m
[30;1m43 | [0m[35m        # Best we can do is check if mutagen is installed and the session exists.[0m
[30;1m44 | [0m[35m        ssh_keygen_path = get_ssh_keygen_path()[0m
[30;1m45 | [0m[35m        if not ssh_keygen_path:[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m255 | [0m[35m        #  the image before running, and bind-mount `/sync` on the host to `$workdir/sync`[0m
[30;1m256 | [0m[35m        #  in the container? Custom docker images make this tricky; we can't assume anything[0m
[30;1m257 | [0m[35m        #  about the directory layout or what the working directory will be.[0m
[30;1m258 | [0m[35m        inside_dir_setup = f"docker exec tmp-dask-1 bash -c 'ln -s {SYNC_TARGET} .'"[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        symlink_command = [[0m
[30;1m261 | [0m[35m            "ssh",[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m253 | [0m[35m        # have capabilities to make a bind mount.[0m
[30;1m254 | [0m[35m        # TODO if we don't like the symlink, Coiled could see what the workdir is for[0m
[30;1m255 | [0m[35m        #  the image before running, and bind-mount `/sync` on the host to `$workdir/sync`[0m
[30;1m256 | [0m[35m        #  in the container? Custom docker images make this tricky; we can't assume anything[0m
[30;1m257 | [0m[35m        #  about the directory layout or what the working directory will be.[0m
[30;1m258 | [0m[35m        inside_dir_setup = f"docker exec tmp-dask-1 bash -c 'ln -s {SYNC_TARGET} .'"[0m
[30;1m259 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m        # If container user doesn't match host user, then we can't do this *inside* container.[0m
[30;1m248 | [0m[35m        outside_dir_setup = f"mkdir -p {SYNC_TARGET} && chmod a+rwx {SYNC_TARGET}"[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        # Within the docker container, symlink the sync directory (`/scratch/sync`)[0m
[30;1m251 | [0m[35m        # into the working directory for Jupyter, so you can actually see the synced[0m
[30;1m252 | [0m[35m        # files in the Jupyter browser. We use a symlink since the container doesn't[0m
[30;1m253 | [0m[35m        # have capabilities to make a bind mount.[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m        # From host (outside container), make the directory and set permissions.[0m
[30;1m247 | [0m[35m        # If container user doesn't match host user, then we can't do this *inside* container.[0m
[30;1m248 | [0m[35m        outside_dir_setup = f"mkdir -p {SYNC_TARGET} && chmod a+rwx {SYNC_TARGET}"[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        # Within the docker container, symlink the sync directory (`/scratch/sync`)[0m
[30;1m251 | [0m[35m        # into the working directory for Jupyter, so you can actually see the synced[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m        if result.returncode != 0:[0m
[30;1m242 | [0m[35m            # there was a problem starting mutagen sync, so no reason to link the sync directory[0m
[30;1m243 | [0m[35m            # (and most likely ssh is the problem so this too would fail)[0m
[30;1m244 | [0m[35m            return False, result.stderr[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m        # From host (outside container), make the directory and set permissions.[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m                    capture_output=True,[0m
[30;1m200 | [0m[35m                    text=True,[0m
[30;1m201 | [0m[35m                )[0m
[30;1m202 | [0m[35m                console.print(f"Existing ssh keys:\n[green]{proc.stdout}[/green]\n")[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m        # Start mutagen[0m
[30;1m205 | [0m[35m        sync_command = [[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35mdef get_ssh_keygen_path() -> str | None:[0m
[30;1m92 | [0m[35m    ssh_keygen_path = shutil.which("ssh-keygen")[0m
[30;1m93 | [0m[35m    if not ssh_keygen_path:[0m
[30;1m94 | [0m[35m        print("[bold red]Unable to find `ssh-keygen`, you may need to install OpenSSH or add it to y[0m
[30;1m95 | [0m[35m        return None[0m
[30;1m96 | [0m[35m    return ssh_keygen_path[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/login.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m66 | [0m[35m        else:[0m
[30;1m67 | [0m[35m            console.print([0m
[30;1m68 | [0m[35m                Markdown("""[0m
[30;1m69 | [0m[35mGo through the quickstart at any point by running[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m```bash[0m
[30;1m72 | [0m[35m$ coiled quickstart[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/batch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m                response = sync_request(cloud, url, "get", data=None, json_output=True)[0m
[30;1m125 | [0m[35m            except ServerDisconnectedError:[0m
[30;1m126 | [0m[35m                continue[0m
[30;1m127 | [0m[35m            state = response.get("state")[0m
[30;1m128 | [0m[35m            if state and "done" in state:[0m
[30;1m129 | [0m[35m                return state[0m
[30;1m130 | [0m[35m            time.sleep(5)[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/batch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m    if isinstance(command, str):[0m
[30;1m50 | [0m[35m        command = shlex.split(command)[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m    env = dict_to_key_val_list(env)[0m
[30;1m53 | [0m[35m    secret_env = dict_to_key_val_list(secret_env)[0m
[30;1m54 | [0m[35m    tag = dict_to_key_val_list(tag)[0m
[30;1m55 | [0m[35m    vm_type = [vm_type] if isinstance(vm_type, str) else vm_type[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/batch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport shlex[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom aiohttp import ServerDisconnectedError[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport coiled[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2017 | [0m[35m        results = response.json()[0m
[30;1m2018 | [0m[35m[0m
[30;1m2019 | [0m[35m        if "results" in results:[0m
[30;1m2020 | [0m[35m            arches = [image.get("architecture") for result in results["results"] for image in result[0m
[30;1m2021 | [0m[35m[0m
[30;1m2022 | [0m[35m            has_intel = "amd64" in arches[0m
[30;1m2023 | [0m[35m            has_arm = "arm64" in arches[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2017 | [0m[35m        results = response.json()[0m
[30;1m2018 | [0m[35m[0m
[30;1m2019 | [0m[35m        if "results" in results:[0m
[30;1m2020 | [0m[35m            arches = [image.get("architecture") for result in results["results"] for image in result[0m
[30;1m2021 | [0m[35m[0m
[30;1m2022 | [0m[35m            has_intel = "amd64" in arches[0m
[30;1m2023 | [0m[35m            has_arm = "arm64" in arches[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2012 | [0m[35m[0m
[30;1m2013 | [0m[35m    try:[0m
[30;1m2014 | [0m[35m        with urllib3.PoolManager() as http:[0m
[30;1m2015 | [0m[35m            response = http.request("GET", url)[0m
[30;1m2016 | [0m[35m[0m
[30;1m2017 | [0m[35m        results = response.json()[0m
[30;1m2018 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1878 | [0m[35m    # there are libraries that distributed by default sets to be single-threaded[0m
[30;1m1879 | [0m[35m    # we want to unset these default values since we're running single task on a (potentially) big m[0m
[30;1m1880 | [0m[35m    for key in DASK_PRESPAWN_THREAD_VARS:[0m
[30;1m1881 | [0m[35m        if dask.config.get(f"distributed.nanny.pre-spawn-environ.{key}", 1) == 1:[0m
[30;1m1882 | [0m[35m            env = {key: "", **env}[0m
[30;1m1883 | [0m[35m    return env[0m
[30;1m1884 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1744 | [0m[35m        identity = sts.get_caller_identity()[0m
[30;1m1745 | [0m[35m[0m
[30;1m1746 | [0m[35m        response["account"] = identity.get("Account")[0m
[30;1m1747 | [0m[35m        response["who"] = identity.get("Arn").split(":")[-1][0m
[30;1m1748 | [0m[35m[0m
[30;1m1749 | [0m[35m        alias = get_account_alias()[0m
[30;1m1750 | [0m[35m        if alias:[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1743 | [0m[35m    try:[0m
[30;1m1744 | [0m[35m        identity = sts.get_caller_identity()[0m
[30;1m1745 | [0m[35m[0m
[30;1m1746 | [0m[35m        response["account"] = identity.get("Account")[0m
[30;1m1747 | [0m[35m        response["who"] = identity.get("Arn").split(":")[-1][0m
[30;1m1748 | [0m[35m[0m
[30;1m1749 | [0m[35m        alias = get_account_alias()[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1736 | [0m[35m        try:[0m
[30;1m1737 | [0m[35m            iam = session.client("iam")[0m
[30;1m1738 | [0m[35m            r = iam.list_account_aliases()[0m
[30;1m1739 | [0m[35m            return r.get("AccountAliases", [])[0][0m
[30;1m1740 | [0m[35m        except Exception:[0m
[30;1m1741 | [0m[35m            return ""[0m
[30;1m1742 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1527 | [0m[35m            # get public/internet routable address from which local user will be hitting scheduler[0m
[30;1m1528 | [0m[35m            if not my_public_ip:[0m
[30;1m1529 | [0m[35m                with urllib3.PoolManager() as pool:[0m
[30;1m1530 | [0m[35m                    my_public_ip = pool.request("GET", "https://api.ipify.org").data.decode("utf-8")[0m
[30;1m1531 | [0m[35m[0m
[30;1m1532 | [0m[35m            cidr = f"{my_public_ip}/32"[0m
[30;1m1533 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1418 | [0m[35m                    logger.warning(f"{key} ({fw[key]}) in backend_options firewall config is not a r[0m
[30;1m1419 | [0m[35m[0m
[30;1m1420 | [0m[35m            for required_key in ("cidr", "ports"):[0m
[30;1m1421 | [0m[35m                if not fw.get(required_key):[0m
[30;1m1422 | [0m[35m                    raise ValueError(f"{required_key} is required for each firewall config")[0m
[30;1m1423 | [0m[35m[0m
[30;1m1424 | [0m[35m            if not isinstance(fw["cidr"], str):[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1407 | [0m[35m        )[0m
[30;1m1408 | [0m[35m[0m
[30;1m1409 | [0m[35m    # validate firewall options[0m
[30;1m1410 | [0m[35m    if backend_options.get("ingress"):[0m
[30;1m1411 | [0m[35m        if not isinstance(backend_options["ingress"], Iterable):[0m
[30;1m1412 | [0m[35m            raise ValueError("ingress in backend_options must be an iterable")[0m
[30;1m1413 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1080 | [0m[35m    """Parse the option to wait for workers."""[0m
[30;1m1081 | [0m[35m    wait_for_workers = ([0m
[30;1m1082 | [0m[35m        # Set 30% as default value to wait for workers[0m
[30;1m1083 | [0m[35m        dask.config.get("coiled.wait-for-workers", 0.3) if wait_for_workers is None else wait_for_wo[0m
[30;1m1084 | [0m[35m    )[0m
[30;1m1085 | [0m[35m[0m
[30;1m1086 | [0m[35m    if wait_for_workers is True:[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1068 | [0m[35m        validate_network(backend_options, customer_hosted)[0m
[30;1m1069 | [0m[35m    if backend_options.get("firewall"):[0m
[30;1m1070 | [0m[35m        cidr = backend_options["firewall"].get("cidr")[0m
[30;1m1071 | [0m[35m        ports = backend_options["firewall"].get("ports")[0m
[30;1m1072 | [0m[35m        if ports:[0m
[30;1m1073 | [0m[35m            validate_ports(ports)[0m
[30;1m1074 | [0m[35m        if cidr:[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1067 | [0m[35m    if backend_options.get("network"):[0m
[30;1m1068 | [0m[35m        validate_network(backend_options, customer_hosted)[0m
[30;1m1069 | [0m[35m    if backend_options.get("firewall"):[0m
[30;1m1070 | [0m[35m        cidr = backend_options["firewall"].get("cidr")[0m
[30;1m1071 | [0m[35m        ports = backend_options["firewall"].get("ports")[0m
[30;1m1072 | [0m[35m        if ports:[0m
[30;1m1073 | [0m[35m            validate_ports(ports)[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1066 | [0m[35m[0m
[30;1m1067 | [0m[35m    if backend_options.get("network"):[0m
[30;1m1068 | [0m[35m        validate_network(backend_options, customer_hosted)[0m
[30;1m1069 | [0m[35m    if backend_options.get("firewall"):[0m
[30;1m1070 | [0m[35m        cidr = backend_options["firewall"].get("cidr")[0m
[30;1m1071 | [0m[35m        ports = backend_options["firewall"].get("ports")[0m
[30;1m1072 | [0m[35m        if ports:[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1064 | [0m[35m    if backend_options.get("zone") and backend_options.get("gcp_project_name"):[0m
[30;1m1065 | [0m[35m        backend_options["gcp_zone"] = backend_options.get("zone")[0m
[30;1m1066 | [0m[35m[0m
[30;1m1067 | [0m[35m    if backend_options.get("network"):[0m
[30;1m1068 | [0m[35m        validate_network(backend_options, customer_hosted)[0m
[30;1m1069 | [0m[35m    if backend_options.get("firewall"):[0m
[30;1m1070 | [0m[35m        cidr = backend_options["firewall"].get("cidr")[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1062 | [0m[35m[0m
[30;1m1063 | [0m[35m    # zone (if set) overrides gcp_zone for gcp[0m
[30;1m1064 | [0m[35m    if backend_options.get("zone") and backend_options.get("gcp_project_name"):[0m
[30;1m1065 | [0m[35m        backend_options["gcp_zone"] = backend_options.get("zone")[0m
[30;1m1066 | [0m[35m[0m
[30;1m1067 | [0m[35m    if backend_options.get("network"):[0m
[30;1m1068 | [0m[35m        validate_network(backend_options, customer_hosted)[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1061 | [0m[35m        backend_options["spot"] = False[0m
[30;1m1062 | [0m[35m[0m
[30;1m1063 | [0m[35m    # zone (if set) overrides gcp_zone for gcp[0m
[30;1m1064 | [0m[35m    if backend_options.get("zone") and backend_options.get("gcp_project_name"):[0m
[30;1m1065 | [0m[35m        backend_options["gcp_zone"] = backend_options.get("zone")[0m
[30;1m1066 | [0m[35m[0m
[30;1m1067 | [0m[35m    if backend_options.get("network"):[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1061 | [0m[35m        backend_options["spot"] = False[0m
[30;1m1062 | [0m[35m[0m
[30;1m1063 | [0m[35m    # zone (if set) overrides gcp_zone for gcp[0m
[30;1m1064 | [0m[35m    if backend_options.get("zone") and backend_options.get("gcp_project_name"):[0m
[30;1m1065 | [0m[35m        backend_options["gcp_zone"] = backend_options.get("zone")[0m
[30;1m1066 | [0m[35m[0m
[30;1m1067 | [0m[35m    if backend_options.get("network"):[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1057 | [0m[35m    if backend_options.get("preemptible") is not None and gcp_backend:[0m
[30;1m1058 | [0m[35m        backend_options["spot"] = backend_options.pop("preemptible")[0m
[30;1m1059 | [0m[35m    # default to on-demand for gpu workers[0m
[30;1m1060 | [0m[35m    if backend_options.get("spot") is None and bool(worker_gpu):[0m
[30;1m1061 | [0m[35m        backend_options["spot"] = False[0m
[30;1m1062 | [0m[35m[0m
[30;1m1063 | [0m[35m    # zone (if set) overrides gcp_zone for gcp[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1054 | [0m[35m    gcp_backend = is_gcp(account, accounts)[0m
[30;1m1055 | [0m[35m    customer_hosted = is_customer_hosted(account, accounts)[0m
[30;1m1056 | [0m[35m    # alias preemptible/spot[0m
[30;1m1057 | [0m[35m    if backend_options.get("preemptible") is not None and gcp_backend:[0m
[30;1m1058 | [0m[35m        backend_options["spot"] = backend_options.pop("preemptible")[0m
[30;1m1059 | [0m[35m    # default to on-demand for gpu workers[0m
[30;1m1060 | [0m[35m    if backend_options.get("spot") is None and bool(worker_gpu):[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1013 | [0m[35m        network_options.get("network_id"),[0m
[30;1m1014 | [0m[35m        network_options.get("scheduler_subnet_id"),[0m
[30;1m1015 | [0m[35m        network_options.get("worker_subnet_id"),[0m
[30;1m1016 | [0m[35m        network_options.get("firewall_id"),[0m
[30;1m1017 | [0m[35m    )[0m
[30;1m1018 | [0m[35m[0m
[30;1m1019 | [0m[35m    for resource_id in resource_ids:[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1012 | [0m[35m    resource_ids = ([0m
[30;1m1013 | [0m[35m        network_options.get("network_id"),[0m
[30;1m1014 | [0m[35m        network_options.get("scheduler_subnet_id"),[0m
[30;1m1015 | [0m[35m        network_options.get("worker_subnet_id"),[0m
[30;1m1016 | [0m[35m        network_options.get("firewall_id"),[0m
[30;1m1017 | [0m[35m    )[0m
[30;1m1018 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1011 | [0m[35m    # check that resource ids, if specified, are strings[0m
[30;1m1012 | [0m[35m    resource_ids = ([0m
[30;1m1013 | [0m[35m        network_options.get("network_id"),[0m
[30;1m1014 | [0m[35m        network_options.get("scheduler_subnet_id"),[0m
[30;1m1015 | [0m[35m        network_options.get("worker_subnet_id"),[0m
[30;1m1016 | [0m[35m        network_options.get("firewall_id"),[0m
[30;1m1017 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1010 | [0m[35m[0m
[30;1m1011 | [0m[35m    # check that resource ids, if specified, are strings[0m
[30;1m1012 | [0m[35m    resource_ids = ([0m
[30;1m1013 | [0m[35m        network_options.get("network_id"),[0m
[30;1m1014 | [0m[35m        network_options.get("scheduler_subnet_id"),[0m
[30;1m1015 | [0m[35m        network_options.get("worker_subnet_id"),[0m
[30;1m1016 | [0m[35m        network_options.get("firewall_id"),[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1006 | [0m[35m            "hosted backend. Please change your backend to configure network."[0m
[30;1m1007 | [0m[35m        )[0m
[30;1m1008 | [0m[35m[0m
[30;1m1009 | [0m[35m    network_options = backend_options.get("network", {})[0m
[30;1m1010 | [0m[35m[0m
[30;1m1011 | [0m[35m    # check that resource ids, if specified, are strings[0m
[30;1m1012 | [0m[35m    resource_ids = ([0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m946 | [0m[35m        True if a customer-hosted backend, else False.[0m
[30;1m947 | [0m[35m    """[0m
[30;1m948 | [0m[35m    user_account = accounts.get(account, {})[0m
[30;1m949 | [0m[35m    backend_type = user_account.get("backend")[0m
[30;1m950 | [0m[35m    customer_hosted = backend_type == "vm"[0m
[30;1m951 | [0m[35m    return customer_hosted[0m
[30;1m952 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m945 | [0m[35m    customer_hosted: bool[0m
[30;1m946 | [0m[35m        True if a customer-hosted backend, else False.[0m
[30;1m947 | [0m[35m    """[0m
[30;1m948 | [0m[35m    user_account = accounts.get(account, {})[0m
[30;1m949 | [0m[35m    backend_type = user_account.get("backend")[0m
[30;1m950 | [0m[35m    customer_hosted = backend_type == "vm"[0m
[30;1m951 | [0m[35m    return customer_hosted[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m926 | [0m[35m    """[0m
[30;1m927 | [0m[35m    user_account = accounts.get(account, {})[0m
[30;1m928 | [0m[35m    user_options = user_account.get("options", {})[0m
[30;1m929 | [0m[35m    gcp_backend = user_account.get("backend") == "vm_gcp" or user_options.get("provider_name") == "g[0m
[30;1m930 | [0m[35m    return gcp_backend[0m
[30;1m931 | [0m[35m[0m
[30;1m932 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m926 | [0m[35m    """[0m
[30;1m927 | [0m[35m    user_account = accounts.get(account, {})[0m
[30;1m928 | [0m[35m    user_options = user_account.get("options", {})[0m
[30;1m929 | [0m[35m    gcp_backend = user_account.get("backend") == "vm_gcp" or user_options.get("provider_name") == "g[0m
[30;1m930 | [0m[35m    return gcp_backend[0m
[30;1m931 | [0m[35m[0m
[30;1m932 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m925 | [0m[35m        True if a GCP backend, else False.[0m
[30;1m926 | [0m[35m    """[0m
[30;1m927 | [0m[35m    user_account = accounts.get(account, {})[0m
[30;1m928 | [0m[35m    user_options = user_account.get("options", {})[0m
[30;1m929 | [0m[35m    gcp_backend = user_account.get("backend") == "vm_gcp" or user_options.get("provider_name") == "g[0m
[30;1m930 | [0m[35m    return gcp_backend[0m
[30;1m931 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m924 | [0m[35m    gcp_backend: bool[0m
[30;1m925 | [0m[35m        True if a GCP backend, else False.[0m
[30;1m926 | [0m[35m    """[0m
[30;1m927 | [0m[35m    user_account = accounts.get(account, {})[0m
[30;1m928 | [0m[35m    user_options = user_account.get("options", {})[0m
[30;1m929 | [0m[35m    gcp_backend = user_account.get("backend") == "vm_gcp" or user_options.get("provider_name") == "g[0m
[30;1m930 | [0m[35m    return gcp_backend[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m773 | [0m[35m        from IPython.core.getipython import get_ipython[0m
[30;1m774 | [0m[35m[0m
[30;1m775 | [0m[35m        ipython = get_ipython()[0m
[30;1m776 | [0m[35m        if ipython and ipython.config.get("SpyderKernelApp"):[0m
[30;1m777 | [0m[35m            is_spyder = True[0m
[30;1m778 | [0m[35m[0m
[30;1m779 | [0m[35m    if is_spyder:[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m522 | [0m[35m            workspace = account_membership.get("account", {}).get("slug") or workspace[0m
[30;1m523 | [0m[35m[0m
[30;1m524 | [0m[35m        # We should always have username from above, but let's be defensive about it just in case.[0m
[30;1m525 | [0m[35m        user = user_dict.get("username")[0m
[30;1m526 | [0m[35m        if not user:[0m
[30;1m527 | [0m[35m            raise ValueError([0m
[30;1m528 | [0m[35m                "Unable to get your account username after login. Please try to login again, if "[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m519 | [0m[35m[0m
[30;1m520 | [0m[35m        if account_membership:[0m
[30;1m521 | [0m[35m            # get slug, in case we matched workspace based on name[0m
[30;1m522 | [0m[35m            workspace = account_membership.get("account", {}).get("slug") or workspace[0m
[30;1m523 | [0m[35m[0m
[30;1m524 | [0m[35m        # We should always have username from above, but let's be defensive about it just in case.[0m
[30;1m525 | [0m[35m        user = user_dict.get("username")[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m519 | [0m[35m[0m
[30;1m520 | [0m[35m        if account_membership:[0m
[30;1m521 | [0m[35m            # get slug, in case we matched workspace based on name[0m
[30;1m522 | [0m[35m            workspace = account_membership.get("account", {}).get("slug") or workspace[0m
[30;1m523 | [0m[35m[0m
[30;1m524 | [0m[35m        # We should always have username from above, but let's be defensive about it just in case.[0m
[30;1m525 | [0m[35m        user = user_dict.get("username")[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m455 | [0m[35m[0m
[30;1m456 | [0m[35m    # If testing locally with `ngrok` we need to[0m
[30;1m457 | [0m[35m    # rewrite the server to localhost[0m
[30;1m458 | [0m[35m    server = server or dask.config.get("coiled.server", COILED_SERVER)[0m
[30;1m459 | [0m[35m    server = normalize_server(server)[0m
[30;1m460 | [0m[35m[0m
[30;1m461 | [0m[35m    browser = True if browser is None else browser[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m@backoff.on_exception(backoff.expo, ApiResponseStatusError, logger=logger)[0m
[30;1m387 | [0m[35masync def _fetch_data(*, session, server, endpoint):[0m
[30;1m388 | [0m[35m    response = await session.request("GET", f"{server}{endpoint}")[0m
[30;1m389 | [0m[35m    if response.status == 426:[0m
[30;1m390 | [0m[35m        # client version upgrade required[0m
[30;1m391 | [0m[35m        await handle_api_exception(response)[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m            if "://" not in server:[0m
[30;1m374 | [0m[35m                server = f"http://{server}"[0m
[30;1m375 | [0m[35m            server = server.rstrip("/")[0m
[30;1m376 | [0m[35m        workspace = workspace or dask.config.get("coiled.workspace", dask.config.get("coiled.account[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m    try:[0m
[30;1m379 | [0m[35m        await handle_credentials([0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m            if "://" not in server:[0m
[30;1m374 | [0m[35m                server = f"http://{server}"[0m
[30;1m375 | [0m[35m            server = server.rstrip("/")[0m
[30;1m376 | [0m[35m        workspace = workspace or dask.config.get("coiled.workspace", dask.config.get("coiled.account[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m    try:[0m
[30;1m379 | [0m[35m        await handle_credentials([0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m    if use_config:[0m
[30;1m370 | [0m[35m        token = token or dask.config.get("coiled.token")[0m
[30;1m371 | [0m[35m        server = server or dask.config.get("coiled.server")[0m
[30;1m372 | [0m[35m        if server:[0m
[30;1m373 | [0m[35m            if "://" not in server:[0m
[30;1m374 | [0m[35m                server = f"http://{server}"[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m            save = True[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m    if use_config:[0m
[30;1m370 | [0m[35m        token = token or dask.config.get("coiled.token")[0m
[30;1m371 | [0m[35m        server = server or dask.config.get("coiled.server")[0m
[30;1m372 | [0m[35m        if server:[0m
[30;1m373 | [0m[35m            if "://" not in server:[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m    # "save" bool means always/never, None means try to do the thing that makes sense[0m
[30;1m361 | [0m[35m    if save is None:[0m
[30;1m362 | [0m[35m        # if token is already set in config and isn't being changed, then no need to save again[0m
[30;1m363 | [0m[35m        if dask.config.get("coiled.token", None) and (not token or token == dask.config.get("coiled.[0m
[30;1m364 | [0m[35m            save = False[0m
[30;1m365 | [0m[35m        else:[0m
[30;1m366 | [0m[35m            # user doesn't already have token saved, so save it without asking[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m    # "save" bool means always/never, None means try to do the thing that makes sense[0m
[30;1m361 | [0m[35m    if save is None:[0m
[30;1m362 | [0m[35m        # if token is already set in config and isn't being changed, then no need to save again[0m
[30;1m363 | [0m[35m        if dask.config.get("coiled.token", None) and (not token or token == dask.config.get("coiled.[0m
[30;1m364 | [0m[35m            save = False[0m
[30;1m365 | [0m[35m        else:[0m
[30;1m366 | [0m[35m            # user doesn't already have token saved, so save it without asking[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m    retry: bool = True,[0m
[30;1m357 | [0m[35m    browser: bool | None = None,[0m
[30;1m358 | [0m[35m):[0m
[30;1m359 | [0m[35m    workspace = workspace or dask.config.get("coiled.workspace", None) or dask.config.get("coiled.ac[0m
[30;1m360 | [0m[35m    # "save" bool means always/never, None means try to do the thing that makes sense[0m
[30;1m361 | [0m[35m    if save is None:[0m
[30;1m362 | [0m[35m        # if token is already set in config and isn't being changed, then no need to save again[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m    retry: bool = True,[0m
[30;1m357 | [0m[35m    browser: bool | None = None,[0m
[30;1m358 | [0m[35m):[0m
[30;1m359 | [0m[35m    workspace = workspace or dask.config.get("coiled.workspace", None) or dask.config.get("coiled.ac[0m
[30;1m360 | [0m[35m    # "save" bool means always/never, None means try to do the thing that makes sense[0m
[30;1m361 | [0m[35m    if save is None:[0m
[30;1m362 | [0m[35m        # if token is already set in config and isn't being changed, then no need to save again[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35mdef has_program_quota(account_usage: dict) -> bool:[0m
[30;1m346 | [0m[35m    return account_usage.get("has_quota") is True[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35masync def login_if_required([0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m        workspace = account_dict.get("slug")[0m
[30;1m326 | [0m[35m    for membership in memberships:[0m
[30;1m327 | [0m[35m        account_details = membership.get("account", {})[0m
[30;1m328 | [0m[35m        has_membership = account_details.get("slug") == workspace or account_details.get("name") == [0m
[30;1m329 | [0m[35m        if has_membership:[0m
[30;1m330 | [0m[35m            return membership[0m
[30;1m331 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m        workspace = account_dict.get("slug")[0m
[30;1m326 | [0m[35m    for membership in memberships:[0m
[30;1m327 | [0m[35m        account_details = membership.get("account", {})[0m
[30;1m328 | [0m[35m        has_membership = account_details.get("slug") == workspace or account_details.get("name") == [0m
[30;1m329 | [0m[35m        if has_membership:[0m
[30;1m330 | [0m[35m            return membership[0m
[30;1m331 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m        account_dict = user_dict.get("default_account") or {}[0m
[30;1m325 | [0m[35m        workspace = account_dict.get("slug")[0m
[30;1m326 | [0m[35m    for membership in memberships:[0m
[30;1m327 | [0m[35m        account_details = membership.get("account", {})[0m
[30;1m328 | [0m[35m        has_membership = account_details.get("slug") == workspace or account_details.get("name") == [0m
[30;1m329 | [0m[35m        if has_membership:[0m
[30;1m330 | [0m[35m            return membership[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m    workspace = workspace or account[0m
[30;1m323 | [0m[35m    if workspace is None:[0m
[30;1m324 | [0m[35m        account_dict = user_dict.get("default_account") or {}[0m
[30;1m325 | [0m[35m        workspace = account_dict.get("slug")[0m
[30;1m326 | [0m[35m    for membership in memberships:[0m
[30;1m327 | [0m[35m        account_details = membership.get("account", {})[0m
[30;1m328 | [0m[35m        has_membership = account_details.get("slug") == workspace or account_details.get("name") == [0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m) -> dict | None:[0m
[30;1m322 | [0m[35m    workspace = workspace or account[0m
[30;1m323 | [0m[35m    if workspace is None:[0m
[30;1m324 | [0m[35m        account_dict = user_dict.get("default_account") or {}[0m
[30;1m325 | [0m[35m        workspace = account_dict.get("slug")[0m
[30;1m326 | [0m[35m    for membership in memberships:[0m
[30;1m327 | [0m[35m        account_details = membership.get("account", {})[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m            exception_cls = PermissionsError[0m
[30;1m284 | [0m[35m        if isinstance(error_body, dict):[0m
[30;1m285 | [0m[35m            errs = error_body.get("non_field_errors")[0m
[30;1m286 | [0m[35m            if "aren't a member" in error_body.get("detail", ""):[0m
[30;1m287 | [0m[35m                raise PermissionsError(error_body["detail"])[0m
[30;1m288 | [0m[35m            elif "message" in error_body:[0m
[30;1m289 | [0m[35m                raise exception_cls(error_body["message"])[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m        if error_body.get("code") == PermissionsError.code:[0m
[30;1m283 | [0m[35m            exception_cls = PermissionsError[0m
[30;1m284 | [0m[35m        if isinstance(error_body, dict):[0m
[30;1m285 | [0m[35m            errs = error_body.get("non_field_errors")[0m
[30;1m286 | [0m[35m            if "aren't a member" in error_body.get("detail", ""):[0m
[30;1m287 | [0m[35m                raise PermissionsError(error_body["detail"])[0m
[30;1m288 | [0m[35m            elif "message" in error_body:[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m        # First see if it's an error we created that has a more useful[0m
[30;1m280 | [0m[35m        # message[0m
[30;1m281 | [0m[35m        error_body = await response.json()[0m
[30;1m282 | [0m[35m        if error_body.get("code") == PermissionsError.code:[0m
[30;1m283 | [0m[35m            exception_cls = PermissionsError[0m
[30;1m284 | [0m[35m        if isinstance(error_body, dict):[0m
[30;1m285 | [0m[35m            errs = error_body.get("non_field_errors")[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m265 | [0m[35m                    f.write(self.tls_scheduler_cert)[0m
[30;1m266 | [0m[35m                ctx = ssl.create_default_context(purpose=ssl.Purpose.SERVER_AUTH, cafile=cert_path)[0m
[30;1m267 | [0m[35m                ctx.verify_mode = ssl.CERT_REQUIRED[0m
[30;1m268 | [0m[35m                ctx.check_hostname = False[0m
[30;1m269 | [0m[35m                ctx.load_cert_chain(cert_path, key_path)[0m
[30;1m270 | [0m[35m        return {[0m
[30;1m271 | [0m[35m            "ssl_context": ctx,[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1969 | [0m[35m[0m
[30;1m1970 | [0m[35m[0m
[30;1m1971 | [0m[35mdef normalize_environ(environ: dict | None) -> Dict[str, str]:[0m
[30;1m1972 | [0m[35m    # env vars have to be strings[0m
[30;1m1973 | [0m[35m    if not environ:[0m
[30;1m1974 | [0m[35m        return {}[0m
[30;1m1975 | [0m[35m    warnings = [][0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1954 | [0m[35m[0m
[30;1m1955 | [0m[35m            if v.startswith("$"):[0m
[30;1m1956 | [0m[35m                if v[1:] in os.environ.keys():[0m
[30;1m1957 | [0m[35m                    # if we get KEY=$FOO, check if FOO is env var and use that as value[0m
[30;1m1958 | [0m[35m                    v = os.environ[v[1:]][0m
[30;1m1959 | [0m[35m                else:[0m
[30;1m1960 | [0m[35m                    logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1938 | [0m[35m        for kv in kv_list:[0m
[30;1m1939 | [0m[35m            kv_split = kv.split("=", maxsplit=1)[0m
[30;1m1940 | [0m[35m            if len(kv_split) == 1 and kv in os.environ.keys():[0m
[30;1m1941 | [0m[35m                # if we get KEY without '=VALUE', then see if KEY matches env var and use that for v[0m
[30;1m1942 | [0m[35m                k = kv[0m
[30;1m1943 | [0m[35m                v = os.environ[k][0m
[30;1m1944 | [0m[35m                d[k] = v[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1880 | [0m[35m    for key in DASK_PRESPAWN_THREAD_VARS:[0m
[30;1m1881 | [0m[35m        if dask.config.get(f"distributed.nanny.pre-spawn-environ.{key}", 1) == 1:[0m
[30;1m1882 | [0m[35m            env = {key: "", **env}[0m
[30;1m1883 | [0m[35m    return env[0m
[30;1m1884 | [0m[35m[0m
[30;1m1885 | [0m[35m[0m
[30;1m1886 | [0m[35mdef short_random_string():[0m
[30;1m1887 | [0m[35m    return str(uuid.uuid4())[:8][0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1879 | [0m[35m    # we want to unset these default values since we're running single task on a (potentially) big m[0m
[30;1m1880 | [0m[35m    for key in DASK_PRESPAWN_THREAD_VARS:[0m
[30;1m1881 | [0m[35m        if dask.config.get(f"distributed.nanny.pre-spawn-environ.{key}", 1) == 1:[0m
[30;1m1882 | [0m[35m            env = {key: "", **env}[0m
[30;1m1883 | [0m[35m    return env[0m
[30;1m1884 | [0m[35m[0m
[30;1m1885 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1874 | [0m[35m    Returns the env vars required to unset the default pre-spawn config that makes certain libraries[0m
[30;1m1875 | [0m[35m    run in single-thread mode.[0m
[30;1m1876 | [0m[35m    """[0m
[30;1m1877 | [0m[35m    env = {}[0m
[30;1m1878 | [0m[35m    # there are libraries that distributed by default sets to be single-threaded[0m
[30;1m1879 | [0m[35m    # we want to unset these default values since we're running single task on a (potentially) big m[0m
[30;1m1880 | [0m[35m    for key in DASK_PRESPAWN_THREAD_VARS:[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1871 | [0m[35m[0m
[30;1m1872 | [0m[35mdef unset_single_thread_defaults() -> dict:[0m
[30;1m1873 | [0m[35m    """[0m
[30;1m1874 | [0m[35m    Returns the env vars required to unset the default pre-spawn config that makes certain libraries[0m
[30;1m1875 | [0m[35m    run in single-thread mode.[0m
[30;1m1876 | [0m[35m    """[0m
[30;1m1877 | [0m[35m    env = {}[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1598 | [0m[35m    elif not https:[0m
[30;1m1599 | [0m[35m        ports.append(8787)[0m
[30;1m1600 | [0m[35m[0m
[30;1m1601 | [0m[35m    if ssh and (not ssh_cidr or target_cidr == ssh_cidr):[0m
[30;1m1602 | [0m[35m        ports.append(22)[0m
[30;1m1603 | [0m[35m    if spark:[0m
[30;1m1604 | [0m[35m        ports.append(15003)[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1579 | [0m[35m        Open port used for ssh (22) to a specific IP address or CIDR distinct from the one used for [0m
[30;1m1580 | [0m[35m        specified in the same way as ``target`` keyword argument.[0m
[30;1m1581 | [0m[35m    ssh: bool[0m
[30;1m1582 | [0m[35m        Open port used for ssh (22), closed by default.[0m
[30;1m1583 | [0m[35m    spark: bool[0m
[30;1m1584 | [0m[35m        Open port used for secured Spark Connect (15003).[0m
[30;1m1585 | [0m[35m    http: bool[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1576 | [0m[35m    jupyter: bool[0m
[30;1m1577 | [0m[35m        Open port used for jupyter (8888), closed by default.[0m
[30;1m1578 | [0m[35m    ssh_target: str[0m
[30;1m1579 | [0m[35m        Open port used for ssh (22) to a specific IP address or CIDR distinct from the one used for [0m
[30;1m1580 | [0m[35m        specified in the same way as ``target`` keyword argument.[0m
[30;1m1581 | [0m[35m    ssh: bool[0m
[30;1m1582 | [0m[35m        Open port used for ssh (22), closed by default.[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1576 | [0m[35m    jupyter: bool[0m
[30;1m1577 | [0m[35m        Open port used for jupyter (8888), closed by default.[0m
[30;1m1578 | [0m[35m    ssh_target: str[0m
[30;1m1579 | [0m[35m        Open port used for ssh (22) to a specific IP address or CIDR distinct from the one used for [0m
[30;1m1580 | [0m[35m        specified in the same way as ``target`` keyword argument.[0m
[30;1m1581 | [0m[35m    ssh: bool[0m
[30;1m1582 | [0m[35m        Open port used for ssh (22), closed by default.[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1566 | [0m[35m    ----------[0m
[30;1m1567 | [0m[35m    target: str[0m
[30;1m1568 | [0m[35m        Open cluster firewall to this range. You can either specify a CIDR,[0m
[30;1m1569 | [0m[35m        or use "me" to automatically get your IP address and use that, or[0m
[30;1m1570 | [0m[35m        "everyone" for "0.0.0.0/0".[0m
[30;1m1571 | [0m[35m    scheduler: int[0m
[30;1m1572 | [0m[35m        Port to open for access to scheduler, 443 by default.[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1556 | [0m[35m    Examples[0m
[30;1m1557 | [0m[35m    --------[0m
[30;1m1558 | [0m[35m    To create a cluster than only accepts connections from your IP address,[0m
[30;1m1559 | [0m[35m    and opens port 22 for SSH access:[0m
[30;1m1560 | [0m[35m    >>> coiled.Cluster([0m
[30;1m1561 | [0m[35m            ...,[0m
[30;1m1562 | [0m[35m            backend_options={**coiled.utils.cluster_firewall("me", ssh=True)}[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1555 | [0m[35m[0m
[30;1m1556 | [0m[35m    Examples[0m
[30;1m1557 | [0m[35m    --------[0m
[30;1m1558 | [0m[35m    To create a cluster than only accepts connections from your IP address,[0m
[30;1m1559 | [0m[35m    and opens port 22 for SSH access:[0m
[30;1m1560 | [0m[35m    >>> coiled.Cluster([0m
[30;1m1561 | [0m[35m            ...,[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1321 | [0m[35m[0m
[30;1m1322 | [0m[35m        error_message = ([0m
[30;1m1323 | [0m[35m            "\n"[0m
[30;1m1324 | [0m[35m            "Unable to find instance types that match the specification: \n"[0m
[30;1m1325 | [0m[35m            f"    Cores: {cpu}  Memory: {memory} GPUs: {gpus}  Arch: {arch}\n"[0m
[30;1m1326 | [0m[35m        )[0m
[30;1m1327 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1304 | [0m[35m[0m
[30;1m1305 | [0m[35m                error_message = ([0m
[30;1m1306 | [0m[35m                    "\n"[0m
[30;1m1307 | [0m[35m                    "Unable to find balanced instance types that match the specification: \n"[0m
[30;1m1308 | [0m[35m                    f"    Cores: {cpu}  Memory: {memory} GPUs: {gpus}  Arch: {arch}\n"[0m
[30;1m1309 | [0m[35m                    "\n"[0m
[30;1m1310 | [0m[35m                    "There are unbalanced instance types (more or less memory per core) that match:\[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m672 | [0m[35m    can_have_revision:[0m
[30;1m673 | [0m[35m        Indicates if this identifier supports having a ":<string>" postfix, as in[0m
[30;1m674 | [0m[35m        the ":1ef489" in "xgboost:1ef489". At time of writing, this only has an effect[0m
[30;1m675 | [0m[35m        on software environments. For other resources this has no meaning. At time[0m
[30;1m676 | [0m[35m        of writing, this only affects the error message that will be printed out.[0m
[30;1m677 | [0m[35m    property_name:[0m
[30;1m678 | [0m[35m        The name of the parameter that was being validated; will be printed[0m
[30;1m679 | [0m[35m        with any error messages, i.e. Unsupported value for "software_environment".[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m671 | [0m[35m        identifier of the resource, i.e. "coiled/xgboost" "coiled/xgboost:1ef489", "xgboost:1ef489" [0m
[30;1m672 | [0m[35m    can_have_revision:[0m
[30;1m673 | [0m[35m        Indicates if this identifier supports having a ":<string>" postfix, as in[0m
[30;1m674 | [0m[35m        the ":1ef489" in "xgboost:1ef489". At time of writing, this only has an effect[0m
[30;1m675 | [0m[35m        on software environments. For other resources this has no meaning. At time[0m
[30;1m676 | [0m[35m        of writing, this only affects the error message that will be printed out.[0m
[30;1m677 | [0m[35m    property_name:[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m541 | [0m[35m            if not has_program_quota(account_usage):[0m
[30;1m542 | [0m[35m                rich.print("[red]You have reached your quota of Coiled credits for this account.")[0m
[30;1m543 | [0m[35m    if save is None:[0m
[30;1m544 | [0m[35m        # Optionally save user credentials for next time[0m
[30;1m545 | [0m[35m        save_creds = input("Save credentials for next time? [Y/n]: ")[0m
[30;1m546 | [0m[35m        if save_creds.lower() in ("y", "yes", ""):[0m
[30;1m547 | [0m[35m            save = True[0m
[30;1m548 | [0m[35m    if save:[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35mimport string[0m
[30;1m17 | [0m[35mimport sys[0m
[30;1m18 | [0m[35mimport threading[0m
[30;1m19 | [0m[35mimport time[0m
[30;1m20 | [0m[35mimport traceback[0m
[30;1m21 | [0m[35mimport uuid[0m
[30;1m22 | [0m[35mimport warnings[0m
[30;1m23 | [0m[35mimport weakref[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m672 | [0m[35m    can_have_revision:[0m
[30;1m673 | [0m[35m        Indicates if this identifier supports having a ":<string>" postfix, as in[0m
[30;1m674 | [0m[35m        the ":1ef489" in "xgboost:1ef489". At time of writing, this only has an effect[0m
[30;1m675 | [0m[35m        on software environments. For other resources this has no meaning. At time[0m
[30;1m676 | [0m[35m        of writing, this only affects the error message that will be printed out.[0m
[30;1m677 | [0m[35m    property_name:[0m
[30;1m678 | [0m[35m        The name of the parameter that was being validated; will be printed[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m671 | [0m[35m        identifier of the resource, i.e. "coiled/xgboost" "coiled/xgboost:1ef489", "xgboost:1ef489" [0m
[30;1m672 | [0m[35m    can_have_revision:[0m
[30;1m673 | [0m[35m        Indicates if this identifier supports having a ":<string>" postfix, as in[0m
[30;1m674 | [0m[35m        the ":1ef489" in "xgboost:1ef489". At time of writing, this only has an effect[0m
[30;1m675 | [0m[35m        on software environments. For other resources this has no meaning. At time[0m
[30;1m676 | [0m[35m        of writing, this only affects the error message that will be printed out.[0m
[30;1m677 | [0m[35m    property_name:[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m565 | [0m[35m            # then use different values).[0m
[30;1m566 | [0m[35m[0m
[30;1m567 | [0m[35m        config, config_file = save_config(new_config=creds)[0m
[30;1m568 | [0m[35m        rich.print(f"Credentials have been saved at {config_file}")[0m
[30;1m569 | [0m[35m        # Make sure saved configuration values are set for the current Python process.[0m
[30;1m570 | [0m[35m        dask.config.update(dask.config.config, config)[0m
[30;1m571 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m526 | [0m[35m        if not user:[0m
[30;1m527 | [0m[35m            raise ValueError([0m
[30;1m528 | [0m[35m                "Unable to get your account username after login. Please try to login again, if "[0m
[30;1m529 | [0m[35m                "the error persists, please reach out to Coiled Support at support@coiled.io"[0m
[30;1m530 | [0m[35m            )[0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m        # Avoid extra printing when creating clusters[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m497 | [0m[35m                if print_invalid_token_messages:[0m
[30;1m498 | [0m[35m                    rich.print([0m
[30;1m499 | [0m[35m                        "You can use [green]coiled login[/green] to authorize a new token for your C[0m
[30;1m500 | [0m[35m                        "or contact us at support@coiled.io if you continue to have problems."[0m
[30;1m501 | [0m[35m                    )[0m
[30;1m502 | [0m[35m                raise[0m
[30;1m503 | [0m[35m        memberships = await _fetch_data(session=session, server=server, endpoint="/api/v2/user/me/me[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m468 | [0m[35m            return result[0m
[30;1m469 | [0m[35m        raise ValueError([0m
[30;1m470 | [0m[35m            "Authorization failed. Please try to login again, and if the error persists, "[0m
[30;1m471 | [0m[35m            "please reach out to Coiled Support at support@coiled.io"[0m
[30;1m472 | [0m[35m        )[0m
[30;1m473 | [0m[35m[0m
[30;1m474 | [0m[35m    if token:[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/states.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m    reasons = {}[0m
[30;1m261 | [0m[35m    for worker in details.get("workers", []):[0m
[30;1m262 | [0m[35m        state = worker.get("current_state", {}).get("state")[0m
[30;1m263 | [0m[35m        reason = worker.get("current_state", {}).get("reason")[0m
[30;1m264 | [0m[35m        if state == "error" and reason:[0m
[30;1m265 | [0m[35m            if reason not in reasons:[0m
[30;1m266 | [0m[35m                reasons[reason] = 1[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/states.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m    reasons = {}[0m
[30;1m261 | [0m[35m    for worker in details.get("workers", []):[0m
[30;1m262 | [0m[35m        state = worker.get("current_state", {}).get("state")[0m
[30;1m263 | [0m[35m        reason = worker.get("current_state", {}).get("reason")[0m
[30;1m264 | [0m[35m        if state == "error" and reason:[0m
[30;1m265 | [0m[35m            if reason not in reasons:[0m
[30;1m266 | [0m[35m                reasons[reason] = 1[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/states.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35mdef group_worker_errors(details: dict) -> Dict[str, int]:[0m
[30;1m260 | [0m[35m    reasons = {}[0m
[30;1m261 | [0m[35m    for worker in details.get("workers", []):[0m
[30;1m262 | [0m[35m        state = worker.get("current_state", {}).get("state")[0m
[30;1m263 | [0m[35m        reason = worker.get("current_state", {}).get("reason")[0m
[30;1m264 | [0m[35m        if state == "error" and reason:[0m
[30;1m265 | [0m[35m            if reason not in reasons:[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/states.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35mdef group_worker_errors(details: dict) -> Dict[str, int]:[0m
[30;1m260 | [0m[35m    reasons = {}[0m
[30;1m261 | [0m[35m    for worker in details.get("workers", []):[0m
[30;1m262 | [0m[35m        state = worker.get("current_state", {}).get("state")[0m
[30;1m263 | [0m[35m        reason = worker.get("current_state", {}).get("reason")[0m
[30;1m264 | [0m[35m        if state == "error" and reason:[0m
[30;1m265 | [0m[35m            if reason not in reasons:[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/states.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35mdef group_worker_errors(details: dict) -> Dict[str, int]:[0m
[30;1m260 | [0m[35m    reasons = {}[0m
[30;1m261 | [0m[35m    for worker in details.get("workers", []):[0m
[30;1m262 | [0m[35m        state = worker.get("current_state", {}).get("state")[0m
[30;1m263 | [0m[35m        reason = worker.get("current_state", {}).get("reason")[0m
[30;1m264 | [0m[35m        if state == "error" and reason:[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/states.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m140 | [0m[35m        updated_dt_str = datetime.strftime(s.updated.astimezone(), DISPLAY_DATETIME_FORMAT)[0m
[30;1m141 | [0m[35m        log_string = ([0m
[30;1m142 | [0m[35m            f"   | {object_types_to_display[s.type]:{max_type_length}} "[0m
[30;1m143 | [0m[35m            f"| {s.name:46} | {s.state:10} at {updated_dt_str} | {s.reason}"[0m
[30;1m144 | [0m[35m        )[0m
[30;1m145 | [0m[35m        if s.state == "error":[0m
[30;1m146 | [0m[35m            logger.log(msg=log_string, level=level or logging.ERROR)[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2835 | [0m[35m                gcp_service_creds_file=gcp_service_creds_file,[0m
[30;1m2836 | [0m[35m            )[0m
[30;1m2837 | [0m[35m        if not gcp_project_id:[0m
[30;1m2838 | [0m[35m            gcp_project_id = parsed_gcp_credentials.get("project_id", "")[0m
[30;1m2839 | [0m[35m        gar_required_kwargs = {[0m
[30;1m2840 | [0m[35m            "gcp_region_name": gcp_region,[0m
[30;1m2841 | [0m[35m            "gcp_project_name": gcp_project_id,[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2784 | [0m[35m            gcp_service_creds_file=gcp_service_creds_file,[0m
[30;1m2785 | [0m[35m        )[0m
[30;1m2786 | [0m[35m        if not gcp_project_id:[0m
[30;1m2787 | [0m[35m            gcp_project_id = parsed_gcp_credentials.get("project_id", "")[0m
[30;1m2788 | [0m[35m        backend_options["options"]["gcp_service_creds_dict"] = parsed_gcp_credentials[0m
[30;1m2789 | [0m[35m[0m
[30;1m2790 | [0m[35m        backend_options["backend"] = "vm"[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2582 | [0m[35m            raise GCPCredentialsError([0m
[30;1m2583 | [0m[35m                f"The supplied file '{gcp_service_creds_file}' is not a valid JSON file."[0m
[30;1m2584 | [0m[35m            ) from None[0m
[30;1m2585 | [0m[35m    if gcp_service_creds_dict and not gcp_service_creds_dict.get("project_id"):[0m
[30;1m2586 | [0m[35m        raise GCPCredentialsError([0m
[30;1m2587 | [0m[35m            "Unable to find 'project_id' in 'gcp_service_creds_dict', make sure this key exists in t[0m
[30;1m2588 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2409 | [0m[35m            data = {}[0m
[30;1m2410 | [0m[35m[0m
[30;1m2411 | [0m[35m            health_check = cloud.health_check()[0m
[30;1m2412 | [0m[35m            status = health_check.get("status", "Issues found")[0m
[30;1m2413 | [0m[35m[0m
[30;1m2414 | [0m[35m            data["health_check"] = health_check[0m
[30;1m2415 | [0m[35m            console.print(f"Performing health check.... Status: {status}")[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2133 | [0m[35m    d["address"] = address[0m
[30;1m2134 | [0m[35m    # Use proxied dashboard address if we're in a hosted notebook[0m
[30;1m2135 | [0m[35m    # or proxying through websockets[0m
[30;1m2136 | [0m[35m    if dask.config.get("coiled.dashboard.proxy", False) or scheme.startswith("ws"):[0m
[30;1m2137 | [0m[35m        d["dashboard_address"] = f"{server}/dashboard/{d['id']}/status"[0m
[30;1m2138 | [0m[35m    return d[0m
[30;1m2139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1670 | [0m[35m        elif backend_options.get("backend") == "vm_azure":[0m
[30;1m1671 | [0m[35m            provider_name = "azure"[0m
[30;1m1672 | [0m[35m        else:[0m
[30;1m1673 | [0m[35m            provider_name = backend_options.get("backend", "")[0m
[30;1m1674 | [0m[35m[0m
[30;1m1675 | [0m[35m        return provider_name[0m
[30;1m1676 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1667 | [0m[35m            provider_name = "aws"[0m
[30;1m1668 | [0m[35m        elif backend_options.get("backend") == "vm_gcp":[0m
[30;1m1669 | [0m[35m            provider_name = "gcp"[0m
[30;1m1670 | [0m[35m        elif backend_options.get("backend") == "vm_azure":[0m
[30;1m1671 | [0m[35m            provider_name = "azure"[0m
[30;1m1672 | [0m[35m        else:[0m
[30;1m1673 | [0m[35m            provider_name = backend_options.get("backend", "")[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1665 | [0m[35m[0m
[30;1m1666 | [0m[35m        elif backend_options.get("backend") == "vm_aws":[0m
[30;1m1667 | [0m[35m            provider_name = "aws"[0m
[30;1m1668 | [0m[35m        elif backend_options.get("backend") == "vm_gcp":[0m
[30;1m1669 | [0m[35m            provider_name = "gcp"[0m
[30;1m1670 | [0m[35m        elif backend_options.get("backend") == "vm_azure":[0m
[30;1m1671 | [0m[35m            provider_name = "azure"[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1663 | [0m[35m        if backend_options.get("backend") == "vm":[0m
[30;1m1664 | [0m[35m            provider_name = backend_options.get("options", {}).get("provider_name", "")[0m
[30;1m1665 | [0m[35m[0m
[30;1m1666 | [0m[35m        elif backend_options.get("backend") == "vm_aws":[0m
[30;1m1667 | [0m[35m            provider_name = "aws"[0m
[30;1m1668 | [0m[35m        elif backend_options.get("backend") == "vm_gcp":[0m
[30;1m1669 | [0m[35m            provider_name = "gcp"[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1661 | [0m[35m        """[0m
[30;1m1662 | [0m[35m        backend_options = await self.get_backend_options(account)[0m
[30;1m1663 | [0m[35m        if backend_options.get("backend") == "vm":[0m
[30;1m1664 | [0m[35m            provider_name = backend_options.get("options", {}).get("provider_name", "")[0m
[30;1m1665 | [0m[35m[0m
[30;1m1666 | [0m[35m        elif backend_options.get("backend") == "vm_aws":[0m
[30;1m1667 | [0m[35m            provider_name = "aws"[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1661 | [0m[35m        """[0m
[30;1m1662 | [0m[35m        backend_options = await self.get_backend_options(account)[0m
[30;1m1663 | [0m[35m        if backend_options.get("backend") == "vm":[0m
[30;1m1664 | [0m[35m            provider_name = backend_options.get("options", {}).get("provider_name", "")[0m
[30;1m1665 | [0m[35m[0m
[30;1m1666 | [0m[35m        elif backend_options.get("backend") == "vm_aws":[0m
[30;1m1667 | [0m[35m            provider_name = "aws"[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1660 | [0m[35m[0m
[30;1m1661 | [0m[35m        """[0m
[30;1m1662 | [0m[35m        backend_options = await self.get_backend_options(account)[0m
[30;1m1663 | [0m[35m        if backend_options.get("backend") == "vm":[0m
[30;1m1664 | [0m[35m            provider_name = backend_options.get("options", {}).get("provider_name", "")[0m
[30;1m1665 | [0m[35m[0m
[30;1m1666 | [0m[35m        elif backend_options.get("backend") == "vm_aws":[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1633 | [0m[35m        """Return the logged in user's AWS credentials"""[0m
[30;1m1634 | [0m[35m        # this doesn't work, since aws credentials aren't (currently) returned by this endpoint[0m
[30;1m1635 | [0m[35m        backend_options = await self.get_backend_options(account)[0m
[30;1m1636 | [0m[35m        credentials = backend_options.get("options", {}).get("credentials", {})[0m
[30;1m1637 | [0m[35m        return credentials[0m
[30;1m1638 | [0m[35m[0m
[30;1m1639 | [0m[35m    @track_context[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1633 | [0m[35m        """Return the logged in user's AWS credentials"""[0m
[30;1m1634 | [0m[35m        # this doesn't work, since aws credentials aren't (currently) returned by this endpoint[0m
[30;1m1635 | [0m[35m        backend_options = await self.get_backend_options(account)[0m
[30;1m1636 | [0m[35m        credentials = backend_options.get("options", {}).get("credentials", {})[0m
[30;1m1637 | [0m[35m        return credentials[0m
[30;1m1638 | [0m[35m[0m
[30;1m1639 | [0m[35m    @track_context[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m938 | [0m[35m            if alias.get("latest_spec"):[0m
[30;1m939 | [0m[35m                assert alias["latest_spec"][0m
[30;1m940 | [0m[35m                spec = alias["latest_spec"][0m
[30;1m941 | [0m[35m                if spec.get("latest_build"):[0m
[30;1m942 | [0m[35m                    assert spec["latest_build"][0m
[30;1m943 | [0m[35m                    build = spec["latest_build"][0m
[30;1m944 | [0m[35m                    if build["state"] == "built":[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m935 | [0m[35m        if wait_build and alias:[0m
[30;1m936 | [0m[35m            # pyright complains unless we nest like this[0m
[30;1m937 | [0m[35m            # only tail software environments that have builds[0m
[30;1m938 | [0m[35m            if alias.get("latest_spec"):[0m
[30;1m939 | [0m[35m                assert alias["latest_spec"][0m
[30;1m940 | [0m[35m                spec = alias["latest_spec"][0m
[30;1m941 | [0m[35m                if spec.get("latest_build"):[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m576 | [0m[35m            await self._close()[0m
[30;1m577 | [0m[35m            if workspace:[0m
[30;1m578 | [0m[35m                match_on_name = [[0m
[30;1m579 | [0m[35m                    w.get("slug") for w in self.accounts.values() if w.get("name", "").lower() == wo[0m
[30;1m580 | [0m[35m                ][0m
[30;1m581 | [0m[35m                if match_on_name:[0m
[30;1m582 | [0m[35m                    raise PermissionsError([0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m576 | [0m[35m            await self._close()[0m
[30;1m577 | [0m[35m            if workspace:[0m
[30;1m578 | [0m[35m                match_on_name = [[0m
[30;1m579 | [0m[35m                    w.get("slug") for w in self.accounts.values() if w.get("name", "").lower() == wo[0m
[30;1m580 | [0m[35m                ][0m
[30;1m581 | [0m[35m                if match_on_name:[0m
[30;1m582 | [0m[35m                    raise PermissionsError([0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m        requests. However, we can disable that by passing in ensure_running=False[0m
[30;1m424 | [0m[35m        """[0m
[30;1m425 | [0m[35m        session = self._ensure_session(ensure_running)[0m
[30;1m426 | [0m[35m        response = await session.request(*args, **kwargs)[0m
[30;1m427 | [0m[35m        return response[0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m    def _ensure_session(self, ensure_running=True) -> aiohttp.ClientSession:[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m            self._default_account = ([0m
[30;1m317 | [0m[35m                workspace or account or dask.config.get("coiled.workspace", dask.config.get("coiled.[0m
[30;1m318 | [0m[35m            )[0m
[30;1m319 | [0m[35m            self._default_backend_options = dask.config.get("coiled.backend-options", None) or {}[0m
[30;1m320 | [0m[35m        self.session: aiohttp.ClientSession | None = None[0m
[30;1m321 | [0m[35m        self.status = "init"[0m
[30;1m322 | [0m[35m        self.cluster_id: int | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m314 | [0m[35m                self.server = "http://" + self.server[0m
[30;1m315 | [0m[35m            self.server = self.server.rstrip("/")[0m
[30;1m316 | [0m[35m            self._default_account = ([0m
[30;1m317 | [0m[35m                workspace or account or dask.config.get("coiled.workspace", dask.config.get("coiled.[0m
[30;1m318 | [0m[35m            )[0m
[30;1m319 | [0m[35m            self._default_backend_options = dask.config.get("coiled.backend-options", None) or {}[0m
[30;1m320 | [0m[35m        self.session: aiohttp.ClientSession | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m314 | [0m[35m                self.server = "http://" + self.server[0m
[30;1m315 | [0m[35m            self.server = self.server.rstrip("/")[0m
[30;1m316 | [0m[35m            self._default_account = ([0m
[30;1m317 | [0m[35m                workspace or account or dask.config.get("coiled.workspace", dask.config.get("coiled.[0m
[30;1m318 | [0m[35m            )[0m
[30;1m319 | [0m[35m            self._default_backend_options = dask.config.get("coiled.backend-options", None) or {}[0m
[30;1m320 | [0m[35m        self.session: aiohttp.ClientSession | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m        with _cluster_creation_lock:[0m
[30;1m310 | [0m[35m            self.user = user or dask.config.get("coiled.user")[0m
[30;1m311 | [0m[35m            self.token = token or dask.config.get("coiled.token")[0m
[30;1m312 | [0m[35m            self.server = server or dask.config.get("coiled.server")[0m
[30;1m313 | [0m[35m            if "://" not in self.server:[0m
[30;1m314 | [0m[35m                self.server = "http://" + self.server[0m
[30;1m315 | [0m[35m            self.server = self.server.rstrip("/")[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m308 | [0m[35m        # TODO deprecation warning for account[0m
[30;1m309 | [0m[35m        with _cluster_creation_lock:[0m
[30;1m310 | [0m[35m            self.user = user or dask.config.get("coiled.user")[0m
[30;1m311 | [0m[35m            self.token = token or dask.config.get("coiled.token")[0m
[30;1m312 | [0m[35m            self.server = server or dask.config.get("coiled.server")[0m
[30;1m313 | [0m[35m            if "://" not in self.server:[0m
[30;1m314 | [0m[35m                self.server = "http://" + self.server[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m    ):[0m
[30;1m308 | [0m[35m        # TODO deprecation warning for account[0m
[30;1m309 | [0m[35m        with _cluster_creation_lock:[0m
[30;1m310 | [0m[35m            self.user = user or dask.config.get("coiled.user")[0m
[30;1m311 | [0m[35m            self.token = token or dask.config.get("coiled.token")[0m
[30;1m312 | [0m[35m            self.server = server or dask.config.get("coiled.server")[0m
[30;1m313 | [0m[35m            if "://" not in self.server:[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2823 | [0m[35m                f"For setting your registry credentials, these fields cannot be empty: {empty_regist[0m
[30;1m2824 | [0m[35m            )[0m
[30;1m2825 | [0m[35m[0m
[30;1m2826 | [0m[35m        # docker username /// account name cannot be uppercase[0m
[30;1m2827 | [0m[35m        if registry_username and any(ele.isupper() for ele in registry_username) is True:[0m
[30;1m2828 | [0m[35m            raise RegistryParameterError("Your dockerhub [registry_username] must be lowercase")[0m
[30;1m2829 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2705 | [0m[35m[0m
[30;1m2706 | [0m[35m    registry_namespace[0m
[30;1m2707 | [0m[35m        A namespace for storing the container images. Defaults to username if not specified. More in[0m
[30;1m2708 | [0m[35m        about docker namespaces can be found here: https://docs.docker.com/docker-hub/repos/create/.[0m
[30;1m2709 | [0m[35m        Only required if registry_type='docker_hub'.[0m
[30;1m2710 | [0m[35m[0m
[30;1m2711 | [0m[35m    registry_access_token[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2689 | [0m[35m        Optional; used to specify zone to use for clusters (for either AWS or GCP).[0m
[30;1m2690 | [0m[35m[0m
[30;1m2691 | [0m[35m    registry_type[0m
[30;1m2692 | [0m[35m        Custom software environments are stored in a docker container registry. By default, containe[0m
[30;1m2693 | [0m[35m        stored in AWS ECR. Users are able to store contains on a private registry by providing addit[0m
[30;1m2694 | [0m[35m        configuration registry_* arguments and specifying registry_type='docker_hub'. To use[0m
[30;1m2695 | [0m[35m        Google Artifact Registry, pass registry_type='gar', gcp_project_id, gcp_region,[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2682 | [0m[35m    instance_service_account[0m
[30;1m2683 | [0m[35m        Email for optional service account to attach to cluster instances; using this is the best pr[0m
[30;1m2684 | [0m[35m        for granting access to your data stored in Google Cloud services. This[0m
[30;1m2685 | [0m[35m        should be a scoped service instance with only the permissions needed to run[0m
[30;1m2686 | [0m[35m        your computations.[0m
[30;1m2687 | [0m[35m[0m
[30;1m2688 | [0m[35m    zone[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2680 | [0m[35m        The Google Cloud Compute region name in which a VPC will be created.[0m
[30;1m2681 | [0m[35m[0m
[30;1m2682 | [0m[35m    instance_service_account[0m
[30;1m2683 | [0m[35m        Email for optional service account to attach to cluster instances; using this is the best pr[0m
[30;1m2684 | [0m[35m        for granting access to your data stored in Google Cloud services. This[0m
[30;1m2685 | [0m[35m        should be a scoped service instance with only the permissions needed to run[0m
[30;1m2686 | [0m[35m        your computations.[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2670 | [0m[35m        managing a Coiled VPC.[0m
[30;1m2671 | [0m[35m[0m
[30;1m2672 | [0m[35m    gcp_service_creds_dict[0m
[30;1m2673 | [0m[35m        A dictionary of the contents of a Google Cloud Compute service account json credentials file[0m
[30;1m2674 | [0m[35m        creating a VPC to host Coiled Cloud related assets.[0m
[30;1m2675 | [0m[35m[0m
[30;1m2676 | [0m[35m    gcp_project_id[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2666 | [0m[35m        Determines if the client connects to the Dask scheduler using it's public or internal addres[0m
[30;1m2667 | [0m[35m[0m
[30;1m2668 | [0m[35m    gcp_service_creds_file[0m
[30;1m2669 | [0m[35m        A string filepath to a Google Cloud Compute service account json credentials file used for c[0m
[30;1m2670 | [0m[35m        managing a Coiled VPC.[0m
[30;1m2671 | [0m[35m[0m
[30;1m2672 | [0m[35m    gcp_service_creds_dict[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2654 | [0m[35m[0m
[30;1m2655 | [0m[35m    aws_region[0m
[30;1m2656 | [0m[35m        The region which Coiled cloud resources will be deployed to and where other resources[0m
[30;1m2657 | [0m[35m        such as the docker registry are located or where a specified VPC will be created.[0m
[30;1m2658 | [0m[35m[0m
[30;1m2659 | [0m[35m    aws_access_key_id[0m
[30;1m2660 | [0m[35m        For AWS support backend, this argument is required to create or use an existing Coiled manag[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2643 | [0m[35m        allow ingress on those ports to the scheduler. For example,[0m
[30;1m2644 | [0m[35m        ``[{"ports" [8787], "cidr": "0.0.0.0/0"}, {"ports" [8786], "cidr": "10.2.0.0/16"}]``[0m
[30;1m2645 | [0m[35m        would allow the dashboard on 8787 to be accessed from any IP address, and the scheduler comm[0m
[30;1m2646 | [0m[35m        be accessed from IP addresses in the 10.2.0.0/16 local network block.[0m
[30;1m2647 | [0m[35m[0m
[30;1m2648 | [0m[35m    firewall[0m
[30;1m2649 | [0m[35m        A single ingress rule for the scheduler firewall/security group; this is deprecated and ingr[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2642 | [0m[35m        This is a list of ingress rules, each rule is a dictionary with a list of ports and a CIDR b[0m
[30;1m2643 | [0m[35m        allow ingress on those ports to the scheduler. For example,[0m
[30;1m2644 | [0m[35m        ``[{"ports" [8787], "cidr": "0.0.0.0/0"}, {"ports" [8786], "cidr": "10.2.0.0/16"}]``[0m
[30;1m2645 | [0m[35m        would allow the dashboard on 8787 to be accessed from any IP address, and the scheduler comm[0m
[30;1m2646 | [0m[35m        be accessed from IP addresses in the 10.2.0.0/16 local network block.[0m
[30;1m2647 | [0m[35m[0m
[30;1m2648 | [0m[35m    firewall[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2584 | [0m[35m            ) from None[0m
[30;1m2585 | [0m[35m    if gcp_service_creds_dict and not gcp_service_creds_dict.get("project_id"):[0m
[30;1m2586 | [0m[35m        raise GCPCredentialsError([0m
[30;1m2587 | [0m[35m            "Unable to find 'project_id' in 'gcp_service_creds_dict', make sure this key exists in t[0m
[30;1m2588 | [0m[35m        )[0m
[30;1m2589 | [0m[35m[0m
[30;1m2590 | [0m[35m    # Type checker doesn't know that this should no longer[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2238 | [0m[35m        Can be a list of packages or a path to a pip requirements file.[0m
[30;1m2239 | [0m[35m        Can be used together with ``conda`` keyword argument, cannot be used together with ``contain[0m
[30;1m2240 | [0m[35m    container[0m
[30;1m2241 | [0m[35m        Reference to a custom container image. For images in Docker Hub, you can reference by name,[0m
[30;1m2242 | [0m[35m        for example, ``daskdev/dask:latest``. For images in other registries, you need to reference [0m
[30;1m2243 | [0m[35m        registry URL, for example, ``789111821368.dkr.ecr.us-east-2.amazonaws.com/prod/coiled``.[0m
[30;1m2244 | [0m[35m        Custom container image cannot be used together with ``conda`` or ``pip``.[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2235 | [0m[35m        Can be used together with ``pip`` keyword argument, cannot be used together with ``container[0m
[30;1m2236 | [0m[35m    pip[0m
[30;1m2237 | [0m[35m        Packages to install into the software environment using pip.[0m
[30;1m2238 | [0m[35m        Can be a list of packages or a path to a pip requirements file.[0m
[30;1m2239 | [0m[35m        Can be used together with ``conda`` keyword argument, cannot be used together with ``contain[0m
[30;1m2240 | [0m[35m    container[0m
[30;1m2241 | [0m[35m        Reference to a custom container image. For images in Docker Hub, you can reference by name,[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2233 | [0m[35m        Specification for packages to install into the software environment using conda.[0m
[30;1m2234 | [0m[35m        Can be a list of packages, a dictionary, or a path to a conda environment YAML file.[0m
[30;1m2235 | [0m[35m        Can be used together with ``pip`` keyword argument, cannot be used together with ``container[0m
[30;1m2236 | [0m[35m    pip[0m
[30;1m2237 | [0m[35m        Packages to install into the software environment using pip.[0m
[30;1m2238 | [0m[35m        Can be a list of packages or a path to a pip requirements file.[0m
[30;1m2239 | [0m[35m        Can be used together with ``conda`` keyword argument, cannot be used together with ``contain[0m
[30;1m2240 | [0m[35m    container[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1488 | [0m[35m        )[0m
[30;1m1489 | [0m[35m        if response.status == 404:[0m
[30;1m1490 | [0m[35m            raise NotFound([0m
[30;1m1491 | [0m[35m                f"Unable to find software environment with the name '{name}' in the workspace '{work[0m
[30;1m1492 | [0m[35m            )[0m
[30;1m1493 | [0m[35m        elif response.status == 403:[0m
[30;1m1494 | [0m[35m            await handle_api_exception(response, exception_cls=PermissionsError)[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1162 | [0m[35m[0m
[30;1m1163 | [0m[35m        if response.status >= 400:[0m
[30;1m1164 | [0m[35m            if response.status == 404:[0m
[30;1m1165 | [0m[35m                raise ValueError(f"Could not find an API token with identifier {identifier}")[0m
[30;1m1166 | [0m[35m            await handle_api_exception(response)[0m
[30;1m1167 | [0m[35m[0m
[30;1m1168 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m934 | [0m[35m        )[0m
[30;1m935 | [0m[35m        if wait_build and alias:[0m
[30;1m936 | [0m[35m            # pyright complains unless we nest like this[0m
[30;1m937 | [0m[35m            # only tail software environments that have builds[0m
[30;1m938 | [0m[35m            if alias.get("latest_spec"):[0m
[30;1m939 | [0m[35m                assert alias["latest_spec"][0m
[30;1m940 | [0m[35m                spec = alias["latest_spec"][0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m693 | [0m[35m        package_name = pathlib.Path(package_file.name).name[0m
[30;1m694 | [0m[35m        logger.debug(f"Starting upload for {package_name}")[0m
[30;1m695 | [0m[35m        package_bytes = package_file.read()[0m
[30;1m696 | [0m[35m        # s3 expects the md5 to be base64 encoded[0m
[30;1m697 | [0m[35m        wheel_md5 = base64.b64encode(md5(package_bytes).digest()).decode("utf-8")[0m
[30;1m698 | [0m[35m        workspace = workspace or self.default_workspace[0m
[30;1m699 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m651 | [0m[35m                await self._revoke_api_token(identifier=token_id)[0m
[30;1m652 | [0m[35m[0m
[30;1m653 | [0m[35m        # after transitioning to new api tokens, we expect we would[0m
[30;1m654 | [0m[35m        # find the in-use token in the tokens list[0m
[30;1m655 | [0m[35m        # but in the meantime the in-use token might be an old-style one we can't revoke[0m
[30;1m656 | [0m[35m        if logged_in_token_id is None:[0m
[30;1m657 | [0m[35m            rich.print("Did not revoke the token you're logged in with now.")[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m650 | [0m[35m            else:[0m
[30;1m651 | [0m[35m                await self._revoke_api_token(identifier=token_id)[0m
[30;1m652 | [0m[35m[0m
[30;1m653 | [0m[35m        # after transitioning to new api tokens, we expect we would[0m
[30;1m654 | [0m[35m        # find the in-use token in the tokens list[0m
[30;1m655 | [0m[35m        # but in the meantime the in-use token might be an old-style one we can't revoke[0m
[30;1m656 | [0m[35m        if logged_in_token_id is None:[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m419 | [0m[35m        """[0m
[30;1m420 | [0m[35m        This wraps the session.request call and injects a per-call UUID.[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m        Most of the time we check that this is in a "running" state before making[0m
[30;1m423 | [0m[35m        requests. However, we can disable that by passing in ensure_running=False[0m
[30;1m424 | [0m[35m        """[0m
[30;1m425 | [0m[35m        session = self._ensure_session(ensure_running)[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m261 | [0m[35m        If given, this event loop will be re-used, otherwise an appropriate one[0m
[30;1m262 | [0m[35m        will be looked up or created.[0m
[30;1m263 | [0m[35m    default_cluster_timeout[0m
[30;1m264 | [0m[35m        Default timeout in seconds to wait for cluster startup before raising ``TimeoutError``.[0m
[30;1m265 | [0m[35m        Pass ``None`` to wait forever, otherwise the default is 20 minutes.[0m
[30;1m266 | [0m[35m    """[0m
[30;1m267 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35mimport platform[0m
[30;1m34 | [0m[35mimport sys[0m
[30;1m35 | [0m[35mimport threading[0m
[30;1m36 | [0m[35mimport time[0m
[30;1m37 | [0m[35mimport warnings[0m
[30;1m38 | [0m[35mimport weakref[0m
[30;1m39 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m40 | [0m[35mfrom dataclasses import dataclass[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mfrom __future__ import annotations[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mimport asyncio[0m
[30;1m26 | [0m[35mimport base64[0m
[30;1m27 | [0m[35mimport datetime[0m
[30;1m28 | [0m[35mimport json[0m
[30;1m29 | [0m[35mimport logging[0m
[30;1m30 | [0m[35mimport numbers[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2459 | [0m[35m    if statinfo.st_size >= 1048576 * max_mb:[0m
[30;1m2460 | [0m[35m        raise ValueError(f"Report file size greater than {max_mb}mb limit")[0m
[30;1m2461 | [0m[35m[0m
[30;1m2462 | [0m[35m    # At this point Dask has generated a local file with the performance report contents[0m
[30;1m2463 | [0m[35m    with Cloud() as cloud:[0m
[30;1m2464 | [0m[35m        result = cloud.upload_performance_report(filename, filename=filename, private=private, accou[0m
[30;1m2465 | [0m[35m        return result[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1335 | [0m[35m            json=aws_credentials,[0m
[30;1m1336 | [0m[35m        )[0m
[30;1m1337 | [0m[35m        if not response.ok:[0m
[30;1m1338 | [0m[35m            logger.debug(f"Failed to update aws creds {response.status}:{await response.text()}")[0m
[30;1m1339 | [0m[35m[0m
[30;1m1340 | [0m[35m    @delete_docstring[0m
[30;1m1341 | [0m[35m    def unset_aws_credentials(self: CloudSyncAsync, account: str | None = None):[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1306 | [0m[35m            json=payload,[0m
[30;1m1307 | [0m[35m        )[0m
[30;1m1308 | [0m[35m        if not response.ok:[0m
[30;1m1309 | [0m[35m            logger.debug(f"Failed to update gcp creds {response.status}:{await response.text()}")[0m
[30;1m1310 | [0m[35m[0m
[30;1m1311 | [0m[35m    @delete_docstring[0m
[30;1m1312 | [0m[35m    def unset_gcp_credentials(self: CloudSyncAsync, account: str | None = None):[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m642 | [0m[35m        tokens = await self._list_api_tokens(include_inactive=True)[0m
[30;1m643 | [0m[35m        logged_in_token_id = None[0m
[30;1m644 | [0m[35m        # we could be more asyncy here by kicking off multiple revokes[0m
[30;1m645 | [0m[35m        # at once but this seems fine[0m
[30;1m646 | [0m[35m        for token_id in tokens:[0m
[30;1m647 | [0m[35m            if self.token.startswith(token_id):[0m
[30;1m648 | [0m[35m                # this is the current token! revoke it last[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/prefect_serve.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        )[0m
[30;1m117 | [0m[35m        return[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    runtime_env_vars.append(f"DASK_COILED__TOKEN={dask.config.get('coiled.token')}")[0m
[30;1m120 | [0m[35m    if account:[0m
[30;1m121 | [0m[35m        runtime_env_vars.append(f"DASK_COILED__ACCOUNT={account}")[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m456 | [0m[35m        table.add_column(key)[0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35m    for pkg in result:[0m
[30;1m459 | [0m[35m        row_values = [str(pkg.get(key, "")) for key in keys][0m
[30;1m460 | [0m[35m        table.add_row(*row_values)[0m
[30;1m461 | [0m[35m    console = Console()[0m
[30;1m462 | [0m[35m    console.print(table)[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m        elif not packages_by_name[critical_package]["include"]:[0m
[30;1m398 | [0m[35m            halting_failures.append(packages_by_name[critical_package])[0m
[30;1m399 | [0m[35m    for package_level in package_levels:[0m
[30;1m400 | [0m[35m        package = packages_by_name.get(package_level["name"])[0m
[30;1m401 | [0m[35m        if package and package["error"]:[0m
[30;1m402 | [0m[35m            if package_level["level"] > package_sync_fail_on or package_sync_strict:[0m
[30;1m403 | [0m[35m                halting_failures.append(package)[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m            if ([0m
[30;1m329 | [0m[35m                pkg["note"][0m
[30;1m330 | [0m[35m                and ([0m
[30;1m331 | [0m[35m                    package_level_lookup.get([0m
[30;1m332 | [0m[35m                        ([0m
[30;1m333 | [0m[35m                            (cast(str, pkg["conda_name"]) if pkg["source"] == "conda" else pkg["name[0m
[30;1m334 | [0m[35m                            pkg["source"],[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m        packages_with_errors = [[0m
[30;1m312 | [0m[35m            ([0m
[30;1m313 | [0m[35m                pkg,[0m
[30;1m314 | [0m[35m                package_level_lookup.get([0m
[30;1m315 | [0m[35m                    ([0m
[30;1m316 | [0m[35m                        (cast(str, pkg["conda_name"]) if pkg["source"] == "conda" else pkg["name"]),[0m
[30;1m317 | [0m[35m                        pkg["source"],[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m        # Never ignore packages in package_sync_conda_extras[0m
[30;1m286 | [0m[35m        if package_sync_conda_extras:[0m
[30;1m287 | [0m[35m            for package in package_sync_conda_extras:[0m
[30;1m288 | [0m[35m                if package_level_lookup.get((package, "conda")) == PackageLevelEnum.IGNORE:[0m
[30;1m289 | [0m[35m                    package_level_lookup[(package, "conda")] = PackageLevelEnum.LOOSE[0m
[30;1m290 | [0m[35m        async with ([0m
[30;1m291 | [0m[35m            cluster._time_cluster_event("package sync", "approximate environment")[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                                )[0m
[30;1m137 | [0m[35m                            )[0m
[30;1m138 | [0m[35m                        )[0m
[30;1m139 | [0m[35m                        else priorities.get(([0m
[30;1m140 | [0m[35m                            (cast(str, pkg["conda_name"]) if pkg["source"] == "conda" else pkg["name[0m
[30;1m141 | [0m[35m                            pkg["source"],[0m
[30;1m142 | [0m[35m                        ))[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m                                or ([0m
[30;1m133 | [0m[35m                                    pkg["wheel_target"][0m
[30;1m134 | [0m[35m                                    # Ignore should override wheel_target (see #2640)[0m
[30;1m135 | [0m[35m                                    and not priorities.get((pkg["name"], pkg["source"])) == PackageL[0m
[30;1m136 | [0m[35m                                )[0m
[30;1m137 | [0m[35m                            )[0m
[30;1m138 | [0m[35m                        )[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m412 | [0m[35m[0m
[30;1m413 | [0m[35mConsider creating a new environment.[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35mBy specifying your packages at once, you're more likely to get a consistent set of versions.[0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35mIf you use conda:[0m
[30;1m418 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m421 | [0m[35mIf you use pip/venv, create a new environment and then:[0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35mpip install coiled package1 package2 package3[0m
[30;1m424 | [0m[35mor[0m
[30;1m425 | [0m[35mpip install -r requirements.txt[0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35mIf that does not solve your issue, please contact support@coiled.io.""")[0m
[30;1m428 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m421 | [0m[35mconda create -n myenv -c conda-forge coiled package1 package2 package3[0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35mIf you use pip/venv, create a new environment and then:[0m
[30;1m424 | [0m[35m[0m
[30;1m425 | [0m[35mpip install coiled package1 package2 package3[0m
[30;1m426 | [0m[35mor[0m
[30;1m427 | [0m[35mpip install -r requirements.txt[0m
[30;1m428 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m359 | [0m[35m                gpu_enabled=gpu_enabled,[0m
[30;1m360 | [0m[35m                architecture=architecture,[0m
[30;1m361 | [0m[35m                # This is okay because we will default to account[0m
[30;1m362 | [0m[35m                # default region in declarative service create_software_environment[0m
[30;1m363 | [0m[35m                region_name=region_name,[0m
[30;1m364 | [0m[35m                use_uv_installer=use_uv_installer,[0m
[30;1m365 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m                "wheel_target": None,[0m
[30;1m98 | [0m[35m            })[0m
[30;1m99 | [0m[35m        else:[0m
[30;1m100 | [0m[35m            # insert the users pip version and hope it exists on conda-forge[0m
[30;1m101 | [0m[35m            packages.append({[0m
[30;1m102 | [0m[35m                "name": "pip",[0m
[30;1m103 | [0m[35m                "path": None,[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m        # package manager[0m
[30;1m80 | [0m[35m        # Insert a conda version of pip to be installed first, it will[0m
[30;1m81 | [0m[35m        # then be used to install the users version of pip[0m
[30;1m82 | [0m[35m        pip = next([0m
[30;1m83 | [0m[35m            (p for p in packages if p["name"] == "pip" and p["source"] == "pip"),[0m
[30;1m84 | [0m[35m            None,[0m
[30;1m85 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m        # This means pip was installed by pip, or the system[0m
[30;1m79 | [0m[35m        # package manager[0m
[30;1m80 | [0m[35m        # Insert a conda version of pip to be installed first, it will[0m
[30;1m81 | [0m[35m        # then be used to install the users version of pip[0m
[30;1m82 | [0m[35m        pip = next([0m
[30;1m83 | [0m[35m            (p for p in packages if p["name"] == "pip" and p["source"] == "pip"),[0m
[30;1m84 | [0m[35m            None,[0m
[30;1m85 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m    if not user_conda_installed_pip:[0m
[30;1m78 | [0m[35m        # This means pip was installed by pip, or the system[0m
[30;1m79 | [0m[35m        # package manager[0m
[30;1m80 | [0m[35m        # Insert a conda version of pip to be installed first, it will[0m
[30;1m81 | [0m[35m        # then be used to install the users version of pip[0m
[30;1m82 | [0m[35m        pip = next([0m
[30;1m83 | [0m[35m            (p for p in packages if p["name"] == "pip" and p["source"] == "pip"),[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/capture_environment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m        None,[0m
[30;1m76 | [0m[35m    )[0m
[30;1m77 | [0m[35m    if not user_conda_installed_pip:[0m
[30;1m78 | [0m[35m        # This means pip was installed by pip, or the system[0m
[30;1m79 | [0m[35m        # package manager[0m
[30;1m80 | [0m[35m        # Insert a conda version of pip to be installed first, it will[0m
[30;1m81 | [0m[35m        # then be used to install the users version of pip[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1847 | [0m[35m    import dask.config[0m
[30;1m1848 | [0m[35m    from dask.distributed import Client[0m
[30;1m1849 | [0m[35m[0m
[30;1m1850 | [0m[35m    scheduler_address = os.environ.get("COILED_INTERNAL_DASK_SCHEDULER_ADDRESS")[0m
[30;1m1851 | [0m[35m[0m
[30;1m1852 | [0m[35m    if not scheduler_address:[0m
[30;1m1853 | [0m[35m        raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1306 | [0m[35m[0m
[30;1m1307 | [0m[35m        data = await response.json()[0m
[30;1m1308 | [0m[35m[0m
[30;1m1309 | [0m[35m        messages = "\n".join(logline.get("message", "") for logline in data)[0m
[30;1m1310 | [0m[35m[0m
[30;1m1311 | [0m[35m        return Log(messages)[0m
[30;1m1312 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m901 | [0m[35m        # Retry logic doesn't make sense because this is called by (frequent) period callback, so we[0m
[30;1m902 | [0m[35m        # for next periodic callback call, otherwise retries will overlap with the periodic callback[0m
[30;1m903 | [0m[35m        session = self._ensure_session()[0m
[30;1m904 | [0m[35m        response = await session.request([0m
[30;1m905 | [0m[35m            "GET", self.server + f"/api/v2/clusters/account/{workspace}/id/{cluster_id}/state"[0m
[30;1m906 | [0m[35m        )[0m
[30;1m907 | [0m[35m        if response.status >= 400:[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m732 | [0m[35m                    else:[0m
[30;1m733 | [0m[35m                        raise ClusterCreationError(error_message)[0m
[30;1m734 | [0m[35m            else:[0m
[30;1m735 | [0m[35m                error_class = PermissionsError if response_json.get("code") == PermissionsError.code[0m
[30;1m736 | [0m[35m                if "message" in response_json:[0m
[30;1m737 | [0m[35m                    raise error_class(response_json["message"])[0m
[30;1m738 | [0m[35m                if "detail" in response_json:[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m711 | [0m[35m            from .widgets import EXECUTION_CONTEXT[0m
[30;1m712 | [0m[35m[0m
[30;1m713 | [0m[35m            if response_json.get("code") == "NO_CLOUD_SETUP":[0m
[30;1m714 | [0m[35m                server_error_message = response_json.get("message")[0m
[30;1m715 | [0m[35m                error_message = f"{server_error_message} or by running `coiled setup`"[0m
[30;1m716 | [0m[35m[0m
[30;1m717 | [0m[35m                if EXECUTION_CONTEXT == "terminal":[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m710 | [0m[35m        if response.status >= 400:[0m
[30;1m711 | [0m[35m            from .widgets import EXECUTION_CONTEXT[0m
[30;1m712 | [0m[35m[0m
[30;1m713 | [0m[35m            if response_json.get("code") == "NO_CLOUD_SETUP":[0m
[30;1m714 | [0m[35m                server_error_message = response_json.get("message")[0m
[30;1m715 | [0m[35m                error_message = f"{server_error_message} or by running `coiled setup`"[0m
[30;1m716 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m646 | [0m[35m            "env_name": software_environment,[0m
[30;1m647 | [0m[35m            "extra_worker_on_scheduler": extra_worker_on_scheduler,[0m
[30;1m648 | [0m[35m            "n_worker_specs_per_host": n_worker_specs_per_host,[0m
[30;1m649 | [0m[35m            "use_aws_creds_endpoint": dask.config.get("coiled.use_aws_creds_endpoint", False),[0m
[30;1m650 | [0m[35m            "custom_subdomain": custom_subdomain,[0m
[30;1m651 | [0m[35m            "batch_job_ids": batch_job_ids,[0m
[30;1m652 | [0m[35m            "extra_user_container": extra_user_container,[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m581 | [0m[35m        if response.status >= 400:[0m
[30;1m582 | [0m[35m            await handle_api_exception(response)[0m
[30;1m583 | [0m[35m        response_json = await response.json()[0m
[30;1m584 | [0m[35m        cert_status = response_json.get("status")[0m
[30;1m585 | [0m[35m        return cert_status[0m
[30;1m586 | [0m[35m[0m
[30;1m587 | [0m[35m    @track_context[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        raise exception_cls([0m
[30;1m89 | [0m[35m            f"Unexpected status code ({response.status}) to {response.method}:{response.url}, contac[0m
[30;1m90 | [0m[35m        ) from None[0m
[30;1m91 | [0m[35m    if error_body.get("code") == PermissionsError.code:[0m
[30;1m92 | [0m[35m        exception_cls = PermissionsError[0m
[30;1m93 | [0m[35m    if "message" in error_body:[0m
[30;1m94 | [0m[35m        raise exception_cls(error_body["message"])[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1749 | [0m[35m        Identifier of the software environment to use, in the format (<account>/)<name>. If the soft[0m
[30;1m1750 | [0m[35m        is owned by the same account as that passed into "account", the (<account>/) prefix is optio[0m
[30;1m1751 | [0m[35m[0m
[30;1m1752 | [0m[35m        For example, suppose your account is "wondercorp", but your friends at "friendlycorp" have a[0m
[30;1m1753 | [0m[35m        named "xgboost" that you want to use; you can specify this with "friendlycorp/xgboost". If y[0m
[30;1m1754 | [0m[35m        entered "xgboost", this is shorthand for "wondercorp/xgboost".[0m
[30;1m1755 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1259 | [0m[35m            async with semaphor:[0m
[30;1m1260 | [0m[35m                return await self._instance_logs(**kwargs)[0m
[30;1m1261 | [0m[35m[0m
[30;1m1262 | [0m[35m        # only get 100 logs at a time; the limit here is redundant since aiohttp session already lim[0m
[30;1m1263 | [0m[35m        # connections but let's be safe just in case[0m
[30;1m1264 | [0m[35m        semaphor = asyncio.Semaphore(value=100)[0m
[30;1m1265 | [0m[35m        results = await asyncio.gather(*[[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1840 | [0m[35m[0m
[30;1m1841 | [0m[35m    This function can be run on a node of a Coiled Batch cluster,[0m
[30;1m1842 | [0m[35m    and returns a dask.distributed.Client object connected to the Dask scheduler running[0m
[30;1m1843 | [0m[35m    on the scheduler node of the Batch cluster (which can also be a Dask cluster).[0m
[30;1m1844 | [0m[35m    """[0m
[30;1m1845 | [0m[35m    import os[0m
[30;1m1846 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1838 | [0m[35m    """[0m
[30;1m1839 | [0m[35m    Get Dask client for a Coiled Batch cluster.[0m
[30;1m1840 | [0m[35m[0m
[30;1m1841 | [0m[35m    This function can be run on a node of a Coiled Batch cluster,[0m
[30;1m1842 | [0m[35m    and returns a dask.distributed.Client object connected to the Dask scheduler running[0m
[30;1m1843 | [0m[35m    on the scheduler node of the Batch cluster (which can also be a Dask cluster).[0m
[30;1m1844 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1034 | [0m[35m                    "have a public IP address.\n\n"[0m
[30;1m1035 | [0m[35m                    "If you're expecting to connect on private IP address, you can run\n"[0m
[30;1m1036 | [0m[35m                    "    coiled config set coiled.use_scheduler_public_ip False\n"[0m
[30;1m1037 | [0m[35m                    "to configure your local Client to use the private IP address, "[0m
[30;1m1038 | [0m[35m                    "or contact support@coiled.io if you'd like help."[0m
[30;1m1039 | [0m[35m                )[0m
[30;1m1040 | [0m[35m            address_to_use = public_address[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1032 | [0m[35m                raise RuntimeError([0m
[30;1m1033 | [0m[35m                    "Your Coiled client is configured to use the public IP address, but the schedule[0m
[30;1m1034 | [0m[35m                    "have a public IP address.\n\n"[0m
[30;1m1035 | [0m[35m                    "If you're expecting to connect on private IP address, you can run\n"[0m
[30;1m1036 | [0m[35m                    "    coiled config set coiled.use_scheduler_public_ip False\n"[0m
[30;1m1037 | [0m[35m                    "to configure your local Client to use the private IP address, "[0m
[30;1m1038 | [0m[35m                    "or contact support@coiled.io if you'd like help."[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1031 | [0m[35m            if not public_ip:[0m
[30;1m1032 | [0m[35m                raise RuntimeError([0m
[30;1m1033 | [0m[35m                    "Your Coiled client is configured to use the public IP address, but the schedule[0m
[30;1m1034 | [0m[35m                    "have a public IP address.\n\n"[0m
[30;1m1035 | [0m[35m                    "If you're expecting to connect on private IP address, you can run\n"[0m
[30;1m1036 | [0m[35m                    "    coiled config set coiled.use_scheduler_public_ip False\n"[0m
[30;1m1037 | [0m[35m                    "to configure your local Client to use the private IP address, "[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1030 | [0m[35m        if use_public_address:[0m
[30;1m1031 | [0m[35m            if not public_ip:[0m
[30;1m1032 | [0m[35m                raise RuntimeError([0m
[30;1m1033 | [0m[35m                    "Your Coiled client is configured to use the public IP address, but the schedule[0m
[30;1m1034 | [0m[35m                    "have a public IP address.\n\n"[0m
[30;1m1035 | [0m[35m                    "If you're expecting to connect on private IP address, you can run\n"[0m
[30;1m1036 | [0m[35m                    "    coiled config set coiled.use_scheduler_public_ip False\n"[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport datetime[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mimport weakref[0m
[30;1m9 | [0m[35mfrom collections import namedtuple[0m
[30;1m10 | [0m[35mfrom typing import ([0m
[30;1m11 | [0m[35m    Awaitable,[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m451 | [0m[35m        default_environ = {}[0m
[30;1m452 | [0m[35m        if container and "rapidsai" in container:[0m
[30;1m453 | [0m[35m            default_environ = {"DISABLE_JUPYTER": "true", **default_environ}  # needed for "stable" [0m
[30;1m454 | [0m[35m        if os.environ.get("COILED_REUSE_ENVIRON_KEYS"):[0m
[30;1m455 | [0m[35m            keys = os.environ["COILED_REUSE_ENVIRON_KEYS"].split(",")[0m
[30;1m456 | [0m[35m            default_environ.update({key: os.environ[key] for key in keys})[0m
[30;1m457 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m    def __call__(self, *args, **kwargs):[0m
[30;1m189 | [0m[35m        # If this is being called from on the desired cluster, then run locally.[0m
[30;1m190 | [0m[35m        # This allows one Function (with same desired cluster specs) to call another without overhea[0m
[30;1m191 | [0m[35m        if os.environ.get("COILED_CLUSTER_NAME", None) == self._name:[0m
[30;1m192 | [0m[35m            return self.local(*args, **kwargs)[0m
[30;1m193 | [0m[35m        # Otherwise, submit to cluster.[0m
[30;1m194 | [0m[35m        return self.submit(*args, **kwargs).result()[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m                            single_thread_unsets = [[0m
[30;1m154 | [0m[35m                                key[0m
[30;1m155 | [0m[35m                                for key in coiled.utils.unset_single_thread_defaults().keys()[0m
[30;1m156 | [0m[35m                                if not user_specified_env.get(key)[0m
[30;1m157 | [0m[35m                            ][0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m                            cluster.unset_env_vars(single_thread_unsets)[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m                            # this won't affect things loaded by dask, but should affect user-code.[0m
[30;1m149 | [0m[35m                            user_specified_env = {[0m
[30;1m150 | [0m[35m                                **(self._environ or {}),[0m
[30;1m151 | [0m[35m                                **(self._cluster_kwargs.get("environ") or {}),[0m
[30;1m152 | [0m[35m                            }[0m
[30;1m153 | [0m[35m                            single_thread_unsets = [[0m
[30;1m154 | [0m[35m                                key[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m390 | [0m[35m        Number of threads to run concurrent tasks in for each VM. -1 can be used to run as many conc[0m
[30;1m391 | [0m[35m        tasks as there are CPU cores. Default is 1.[0m
[30;1m392 | [0m[35m    allow_ingress_from[0m
[30;1m393 | [0m[35m        Control the CIDR from which cluster firewall allows ingress to scheduler; by default this is[0m
[30;1m394 | [0m[35m        to any source address (0.0.0.0/0). You can specify CIDR, or "me" for just your IP address.[0m
[30;1m395 | [0m[35m    local[0m
[30;1m396 | [0m[35m        Whether or not to run this function locally or on cloud VMs. If ``True``, this function will[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m391 | [0m[35m        tasks as there are CPU cores. Default is 1.[0m
[30;1m392 | [0m[35m    allow_ingress_from[0m
[30;1m393 | [0m[35m        Control the CIDR from which cluster firewall allows ingress to scheduler; by default this is[0m
[30;1m394 | [0m[35m        to any source address (0.0.0.0/0). You can specify CIDR, or "me" for just your IP address.[0m
[30;1m395 | [0m[35m    local[0m
[30;1m396 | [0m[35m        Whether or not to run this function locally or on cloud VMs. If ``True``, this function will[0m
[30;1m397 | [0m[35m        run on your local machine, which can be useful for debugging or during development.[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/function.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m                            if self._environ:[0m
[30;1m143 | [0m[35m                                cluster.send_private_envs(self._environ)[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m                            # some env vars are set in dask config early in the dask loading process[0m
[30;1m146 | [0m[35m                            # we set these to `""` since that's what we can do in the relevant dask [0m
[30;1m147 | [0m[35m                            # but some libraries don't accept empty string, so we'll unset them here[0m
[30;1m148 | [0m[35m                            # this won't affect things loaded by dask, but should affect user-code.[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m    """[0m
[30;1m71 | [0m[35m    cmd = [conda_command(), "env", "export", "-n", name, "--no-build", "--json"][0m
[30;1m72 | [0m[35m    output = parse_conda_command(cmd)[0m
[30;1m73 | [0m[35m    output = output.get("dependencies", [])[0m
[30;1m74 | [0m[35m    results = {}[0m
[30;1m75 | [0m[35m    for i in output:[0m
[30;1m76 | [0m[35m        if isinstance(i, str):[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mdef conda_command():[0m
[30;1m46 | [0m[35m    return shutil.which(os.environ.get("CONDA_EXE", "conda")) or "conda"[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mdef parse_conda_command(cmd: list):[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m68 | [0m[35m        Mapping that contains the name and version of each installed package[0m
[30;1m69 | [0m[35m        in the environment[0m
[30;1m70 | [0m[35m    """[0m
[30;1m71 | [0m[35m    cmd = [conda_command(), "env", "export", "-n", name, "--no-build", "--json"][0m
[30;1m72 | [0m[35m    output = parse_conda_command(cmd)[0m
[30;1m73 | [0m[35m    output = output.get("dependencies", [])[0m
[30;1m74 | [0m[35m    results = {}[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m            package, version = i.split("=")[0m
[30;1m78 | [0m[35m            results[package] = version[0m
[30;1m79 | [0m[35m        else:[0m
[30;1m80 | [0m[35m            # TODO: Use pip installed package information which is currently ignored[0m
[30;1m81 | [0m[35m            assert isinstance(i, dict), type(i)[0m
[30;1m82 | [0m[35m            assert list(i.keys()) == ["pip"], list(i.keys())[0m
[30;1m83 | [0m[35m    return results[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m    op_id = COILED_OP_CONTEXT.get()[0m
[30;1m140 | [0m[35m    if op_id:[0m
[30;1m141 | [0m[35m        trace_data["coiled-operation-id"] = op_id[0m
[30;1m142 | [0m[35m    op_name = COILED_OP_CONTEXT.get()[0m
[30;1m143 | [0m[35m    if op_name:[0m
[30;1m144 | [0m[35m        trace_data["coiled-operation-func"] = op_name[0m
[30;1m145 | [0m[35m    return trace_data[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m        span = tracer.current_span()  # type: ignore[0m
[30;1m137 | [0m[35m        if span:[0m
[30;1m138 | [0m[35m            HTTPPropagator.inject(span_context=span.context, headers=trace_data)  # type: ignore[0m
[30;1m139 | [0m[35m    op_id = COILED_OP_CONTEXT.get()[0m
[30;1m140 | [0m[35m    if op_id:[0m
[30;1m141 | [0m[35m        trace_data["coiled-operation-id"] = op_id[0m
[30;1m142 | [0m[35m    op_name = COILED_OP_CONTEXT.get()[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m@contextmanager[0m
[30;1m67 | [0m[35mdef operation_context(name: str):[0m
[30;1m68 | [0m[35m    c_id = COILED_OP_CONTEXT.get()[0m
[30;1m69 | [0m[35m    if c_id:[0m
[30;1m70 | [0m[35m        # already in a coiled op context, don't create a new one[0m
[30;1m71 | [0m[35m        yield c_id[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mimport aiohttp[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mDDTRACE = environ.get("DD_TRACE_ENABLED", "true").lower() in ["true", "1"][0m
[30;1m18 | [0m[35mif DDTRACE:[0m
[30;1m19 | [0m[35m    try:[0m
[30;1m20 | [0m[35m        from ddtrace import tracer[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m            end=datetime.now(tz=timezone.utc),[0m
[30;1m84 | [0m[35m            **{"coiled-operation-id": c_id},  # pyright: ignore[reportArgumentType][0m
[30;1m85 | [0m[35m        )[0m
[30;1m86 | [0m[35m        logger.debug(f"Exiting {name}-{c_id} - DD URL: {trace_url}")[0m
[30;1m87 | [0m[35m        COILED_OP_CONTEXT.set("")[0m
[30;1m88 | [0m[35m        COILED_OP_NAME.set("")[0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2882 | [0m[35m[0m
[30;1m2883 | [0m[35m    @property[0m
[30;1m2884 | [0m[35m    def jupyter_link(self):[0m
[30;1m2885 | [0m[35m        if not self.scheduler_options.get("jupyter"):[0m
[30;1m2886 | [0m[35m            logger.warning([0m
[30;1m2887 | [0m[35m                "Jupyter was not enabled on the cluster scheduler. Use `scheduler_options={'jupyter'[0m
[30;1m2888 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2563 | [0m[35m            # We got a response from scheduler about which of the requested workers are successfully[0m
[30;1m2564 | [0m[35m            # We'll assume that if a worker got removed from the list by the scheduler, there was a [0m
[30;1m2565 | [0m[35m            # (e.g., unique data could not be moved to any other worker), so we won't forcibly stop [0m
[30;1m2566 | [0m[35m            scheduler_retired_names = {w.get("name") for w in scheduler_workers_retired.values()}[0m
[30;1m2567 | [0m[35m[0m
[30;1m2568 | [0m[35m            not_retired_by_scheduler = [w for w in workers if w not in scheduler_retired_names][0m
[30;1m2569 | [0m[35m            if not_retired_by_scheduler:[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2465 | [0m[35m                elif "rate limit" in str(e).lower():[0m
[30;1m2466 | [0m[35m                    # every time we get rate limit, reduce rate at which we check cluster state[0m
[30;1m2467 | [0m[35m                    check_interval = ([0m
[30;1m2468 | [0m[35m                        dask.utils.parse_timedelta(dask.config.get("coiled.cluster-state-check-inter[0m
[30;1m2469 | [0m[35m                        * 1000[0m
[30;1m2470 | [0m[35m                        * self._state_check_failed[0m
[30;1m2471 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2447 | [0m[35m    async def _check_status(self):[0m
[30;1m2448 | [0m[35m        if self.cluster_id and self.status in (Status.running, Status.closing):[0m
[30;1m2449 | [0m[35m            try:[0m
[30;1m2450 | [0m[35m                state = (await self.cloud._get_cluster_state(cluster_id=self.cluster_id, workspace=s[0m
[30;1m2451 | [0m[35m                    "state"[0m
[30;1m2452 | [0m[35m                )[0m
[30;1m2453 | [0m[35m                if state == "stopping":[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2419 | [0m[35m[0m
[30;1m2420 | [0m[35m    async def _flush_cluster_events(self):[0m
[30;1m2421 | [0m[35m        # any events prior to cluster having an ID get queued and sent once there's an event when cl[0m
[30;1m2422 | [0m[35m        if self.cluster_id and dask.config.get("coiled.send_client_events", True):[0m
[30;1m2423 | [0m[35m            url = f"{self.cloud.server}/api/v2/clusters/id/{self.cluster_id}/event"[0m
[30;1m2424 | [0m[35m            while self._cluster_event_queue:[0m
[30;1m2425 | [0m[35m                payload = self._cluster_event_queue.pop(0)[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2354 | [0m[35m        """[0m
[30;1m2355 | [0m[35m        Get credentials and pass them to the scheduler.[0m
[30;1m2356 | [0m[35m        """[0m
[30;1m2357 | [0m[35m        if self.credentials is CredentialsPreferred.NONE and dask.config.get("coiled.use_aws_creds_e[0m
[30;1m2358 | [0m[35m            await self._unset_env_vars(["AWS_CONTAINER_CREDENTIALS_FULL_URI"])[0m
[30;1m2359 | [0m[35m[0m
[30;1m2360 | [0m[35m        if self.credentials is CredentialsPreferred.NONE:[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2339 | [0m[35m                await self._send_env_vars({"CLOUDSDK_AUTH_ACCESS_TOKEN": gcp_token["token"]})[0m
[30;1m2340 | [0m[35m[0m
[30;1m2341 | [0m[35m                if gcp_token.get("expiry") and schedule_callback:[0m
[30;1m2342 | [0m[35m                    self._schedule_cred_update(expiration=gcp_token.get("expiry"), label="Google Clo[0m
[30;1m2343 | [0m[35m                else:[0m
[30;1m2344 | [0m[35m                    logger.debug([0m
[30;1m2345 | [0m[35m                        "Google Cloud OAuth2 token from local credentials shipped to cluster, no sch[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2338 | [0m[35m                # ship token to cluster[0m
[30;1m2339 | [0m[35m                await self._send_env_vars({"CLOUDSDK_AUTH_ACCESS_TOKEN": gcp_token["token"]})[0m
[30;1m2340 | [0m[35m[0m
[30;1m2341 | [0m[35m                if gcp_token.get("expiry") and schedule_callback:[0m
[30;1m2342 | [0m[35m                    self._schedule_cred_update(expiration=gcp_token.get("expiry"), label="Google Clo[0m
[30;1m2343 | [0m[35m                else:[0m
[30;1m2344 | [0m[35m                    logger.debug([0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2332 | [0m[35m                await self._submit_cluster_event([0m
[30;1m2333 | [0m[35m                    "credentials",[0m
[30;1m2334 | [0m[35m                    "forwarding Google credentials",[0m
[30;1m2335 | [0m[35m                    extra_data={"expiration": str(gcp_token.get("expiry"))},[0m
[30;1m2336 | [0m[35m                )[0m
[30;1m2337 | [0m[35m[0m
[30;1m2338 | [0m[35m                # ship token to cluster[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2328 | [0m[35m        if self._try_local_gcp_creds and has_gcp_auth_installed:[0m
[30;1m2329 | [0m[35m            gcp_token = get_gcp_local_session_token(set_local_token_env=True)[0m
[30;1m2330 | [0m[35m[0m
[30;1m2331 | [0m[35m            if gcp_token.get("token"):[0m
[30;1m2332 | [0m[35m                await self._submit_cluster_event([0m
[30;1m2333 | [0m[35m                    "credentials",[0m
[30;1m2334 | [0m[35m                    "forwarding Google credentials",[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2311 | [0m[35m                )[0m
[30;1m2312 | [0m[35m            else:[0m
[30;1m2313 | [0m[35m                logger.debug("AWS STS token from local credentials shipped to cluster, no scheduled [0m
[30;1m2314 | [0m[35m        elif dask.config.get("coiled.use_aws_creds_endpoint", False):[0m
[30;1m2315 | [0m[35m            # since we aren't shipping local creds, remove creds endpoint in credential chain[0m
[30;1m2316 | [0m[35m            await self._unset_env_vars(["AWS_CONTAINER_CREDENTIALS_FULL_URI"])[0m
[30;1m2317 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2302 | [0m[35m[0m
[30;1m2303 | [0m[35m            if schedule_callback:[0m
[30;1m2304 | [0m[35m                self._schedule_cred_update([0m
[30;1m2305 | [0m[35m                    expiration=token_creds.get("Expiration"),[0m
[30;1m2306 | [0m[35m                    label="AWS STS token",[0m
[30;1m2307 | [0m[35m                    extra_warning=([0m
[30;1m2308 | [0m[35m                        " Code running on your cluster may be unable to access other AWS services "[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2297 | [0m[35m            )[0m
[30;1m2298 | [0m[35m            await scheduler_comm.aws_update_credentials(credentials=creds_to_send)[0m
[30;1m2299 | [0m[35m[0m
[30;1m2300 | [0m[35m            if creds_to_send.get("Expiration"):[0m
[30;1m2301 | [0m[35m                self._using_aws_creds_endpoint = True[0m
[30;1m2302 | [0m[35m[0m
[30;1m2303 | [0m[35m            if schedule_callback:[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2293 | [0m[35m            await self._submit_cluster_event([0m
[30;1m2294 | [0m[35m                "credentials",[0m
[30;1m2295 | [0m[35m                "forwarding AWS credentials",[0m
[30;1m2296 | [0m[35m                extra_data={"expiration": str(token_creds.get("Expiration"))},[0m
[30;1m2297 | [0m[35m            )[0m
[30;1m2298 | [0m[35m            await scheduler_comm.aws_update_credentials(credentials=creds_to_send)[0m
[30;1m2299 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2287 | [0m[35m                    # but some other code is stricter in parsing datetime string.[0m
[30;1m2288 | [0m[35m                    return token_creds["Expiration"].astimezone(tz=datetime.timezone.utc).strftime("[0m
[30;1m2289 | [0m[35m                # values should be str | None; make sure we don't use "None"[0m
[30;1m2290 | [0m[35m                return str(token_creds.get(k)) if token_creds.get(k) is not None else None[0m
[30;1m2291 | [0m[35m[0m
[30;1m2292 | [0m[35m            creds_to_send = {k: _format_vals(k) for k in keys}[0m
[30;1m2293 | [0m[35m            await self._submit_cluster_event([0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2287 | [0m[35m                    # but some other code is stricter in parsing datetime string.[0m
[30;1m2288 | [0m[35m                    return token_creds["Expiration"].astimezone(tz=datetime.timezone.utc).strftime("[0m
[30;1m2289 | [0m[35m                # values should be str | None; make sure we don't use "None"[0m
[30;1m2290 | [0m[35m                return str(token_creds.get(k)) if token_creds.get(k) is not None else None[0m
[30;1m2291 | [0m[35m[0m
[30;1m2292 | [0m[35m            creds_to_send = {k: _format_vals(k) for k in keys}[0m
[30;1m2293 | [0m[35m            await self._submit_cluster_event([0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2278 | [0m[35m                keys.append("Expiration")[0m
[30;1m2279 | [0m[35m[0m
[30;1m2280 | [0m[35m            def _format_vals(k: str) -> str | None:[0m
[30;1m2281 | [0m[35m                if k == "Expiration" and isinstance(token_creds.get("Expiration"), datetime.datetime[0m
[30;1m2282 | [0m[35m                    # use assert to make pyright happy since it doesn't understand that the above co[0m
[30;1m2283 | [0m[35m                    # already ensures that token_creds["Expiration"] is not None[0m
[30;1m2284 | [0m[35m                    assert token_creds["Expiration"] is not None[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2274 | [0m[35m[0m
[30;1m2275 | [0m[35m            # creds endpoint will be used iff expiration is sent to plugin[0m
[30;1m2276 | [0m[35m            # so this is a way to (for now) feature flag using creds endpoint (vs. env vars)[0m
[30;1m2277 | [0m[35m            if dask.config.get("coiled.use_aws_creds_endpoint", False):[0m
[30;1m2278 | [0m[35m                keys.append("Expiration")[0m
[30;1m2279 | [0m[35m[0m
[30;1m2280 | [0m[35m            def _format_vals(k: str) -> str | None:[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2262 | [0m[35m                "credentials", "not forwarding AWS credentials, no local session token", level=loggi[0m
[30;1m2263 | [0m[35m            )[0m
[30;1m2264 | [0m[35m[0m
[30;1m2265 | [0m[35m        if token_creds and token_creds.get("SessionToken"):[0m
[30;1m2266 | [0m[35m            scheduler_comm = self._ensure_scheduler_comm()[0m
[30;1m2267 | [0m[35m[0m
[30;1m2268 | [0m[35m            keys = [[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2257 | [0m[35m            await self._submit_cluster_event([0m
[30;1m2258 | [0m[35m                "credential", "not forwarding AWS credentials, could not retrieve local credentials"[0m
[30;1m2259 | [0m[35m            )[0m
[30;1m2260 | [0m[35m        elif not token_creds.get("SessionToken"):[0m
[30;1m2261 | [0m[35m            await self._submit_cluster_event([0m
[30;1m2262 | [0m[35m                "credentials", "not forwarding AWS credentials, no local session token", level=loggi[0m
[30;1m2263 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1977 | [0m[35m        )[0m
[30;1m1978 | [0m[35m        if response:[0m
[30;1m1979 | [0m[35m            self._plan.update(set(response.get("workers", [])))[0m
[30;1m1980 | [0m[35m            self._requested.update(set(response.get("workers", [])))[0m
[30;1m1981 | [0m[35m[0m
[30;1m1982 | [0m[35m    @track_context[0m
[30;1m1983 | [0m[35m    async def _close(self, force_shutdown: bool = False, reason: str | None = None) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1976 | [0m[35m            reason=reason,[0m
[30;1m1977 | [0m[35m        )[0m
[30;1m1978 | [0m[35m        if response:[0m
[30;1m1979 | [0m[35m            self._plan.update(set(response.get("workers", [])))[0m
[30;1m1980 | [0m[35m            self._requested.update(set(response.get("workers", [])))[0m
[30;1m1981 | [0m[35m[0m
[30;1m1982 | [0m[35m    @track_context[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1698 | [0m[35m[0m
[30;1m1699 | [0m[35m                scheduler_current_state = cluster_details["scheduler"]["current_state"][0m
[30;1m1700 | [0m[35m                scheduler_state = ProcessStateEnum(scheduler_current_state["state"])[0m
[30;1m1701 | [0m[35m                if cluster_details["scheduler"].get("instance"):[0m
[30;1m1702 | [0m[35m                    scheduler_instance_state = InstanceStateEnum([0m
[30;1m1703 | [0m[35m                        cluster_details["scheduler"]["instance"]["current_state"]["state"][0m
[30;1m1704 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1659 | [0m[35m            while True:[0m
[30;1m1660 | [0m[35m                cluster_details = await cloud._get_cluster_details(cluster_id=cluster_id, workspace=[0m
[30;1m1661 | [0m[35m[0m
[30;1m1662 | [0m[35m                if cluster_details.get("coiled_hosted"):[0m
[30;1m1663 | [0m[35m                    self._is_coiled_hosted = True[0m
[30;1m1664 | [0m[35m[0m
[30;1m1665 | [0m[35m                # Computing num_workers_to_wait_for inside the while loop is kinda goofy, but I don'[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1550 | [0m[35m            # slightly hacky way to make cluster creation not block if this is a batch job cluster[0m
[30;1m1551 | [0m[35m            if self.batch_job_ids:[0m
[30;1m1552 | [0m[35m                cluster_details = await cloud._get_cluster_details(cluster_id=self.cluster_id, works[0m
[30;1m1553 | [0m[35m                if cluster_details.get("coiled_hosted"):[0m
[30;1m1554 | [0m[35m                    self._is_coiled_hosted = True[0m
[30;1m1555 | [0m[35m            else:[0m
[30;1m1556 | [0m[35m                await self._attach_to_cluster(is_new_cluster=cluster_created)[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1544 | [0m[35m            self._state_check_failed = 0[0m
[30;1m1545 | [0m[35m            self.periodic_callbacks["check_coiled_state"] = PeriodicCallback([0m
[30;1m1546 | [0m[35m                self._check_status,[0m
[30;1m1547 | [0m[35m                dask.utils.parse_timedelta(dask.config.get("coiled.cluster-state-check-interval")) *[0m
[30;1m1548 | [0m[35m            )[0m
[30;1m1549 | [0m[35m[0m
[30;1m1550 | [0m[35m            # slightly hacky way to make cluster creation not block if this is a batch job cluster[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1446 | [0m[35m                        container=self.software_container,[0m
[30;1m1447 | [0m[35m                        workspace=self.workspace,[0m
[30;1m1448 | [0m[35m                        architecture=self.arch,[0m
[30;1m1449 | [0m[35m                        region_name=self.backend_options.get("region_name") if self.backend_options [0m
[30;1m1450 | [0m[35m                    )[0m
[30;1m1451 | [0m[35m                    self.software_environment = container_senv_name[0m
[30;1m1452 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1418 | [0m[35m                reusing_existing_package_sync_env = self.software_environment == dask.config.get([0m
[30;1m1419 | [0m[35m                    "coiled.software", None[0m
[30;1m1420 | [0m[35m                ) and (dask.config.get("coiled.software") or "").startswith("package-sync-")[0m
[30;1m1421 | [0m[35m                gpu_discrepancy = self._is_gpu_cluster != dask.config.get([0m
[30;1m1422 | [0m[35m                    "coiled.software_is_gpu_cluster", self._is_gpu_cluster[0m
[30;1m1423 | [0m[35m                )[0m
[30;1m1424 | [0m[35m                if reusing_existing_package_sync_env and gpu_discrepancy:[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1417 | [0m[35m[0m
[30;1m1418 | [0m[35m                reusing_existing_package_sync_env = self.software_environment == dask.config.get([0m
[30;1m1419 | [0m[35m                    "coiled.software", None[0m
[30;1m1420 | [0m[35m                ) and (dask.config.get("coiled.software") or "").startswith("package-sync-")[0m
[30;1m1421 | [0m[35m                gpu_discrepancy = self._is_gpu_cluster != dask.config.get([0m
[30;1m1422 | [0m[35m                    "coiled.software_is_gpu_cluster", self._is_gpu_cluster[0m
[30;1m1423 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1415 | [0m[35m                    self.package_sync = True[0m
[30;1m1416 | [0m[35m                    self.software_environment = ""[0m
[30;1m1417 | [0m[35m[0m
[30;1m1418 | [0m[35m                reusing_existing_package_sync_env = self.software_environment == dask.config.get([0m
[30;1m1419 | [0m[35m                    "coiled.software", None[0m
[30;1m1420 | [0m[35m                ) and (dask.config.get("coiled.software") or "").startswith("package-sync-")[0m
[30;1m1421 | [0m[35m                gpu_discrepancy = self._is_gpu_cluster != dask.config.get([0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1409 | [0m[35m                        f"architecture of some instance types ({scheduler_vm_types_to_use}, {worker_[0m
[30;1m1410 | [0m[35m                    )[0m
[30;1m1411 | [0m[35m[0m
[30;1m1412 | [0m[35m                if self.arch.vm_arch != dask.config.get("coiled.software_requires_vm_arch", self.arc[0m
[30;1m1413 | [0m[35m                    # specified senv with specified arch comes from `coiled run`[0m
[30;1m1414 | [0m[35m                    # we don't want to re-use senv if it was for a different arch than cluster we're[0m
[30;1m1415 | [0m[35m                    self.package_sync = True[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1307 | [0m[35m            # Set shutdown_on_close here instead of in __init__ to make sure[0m
[30;1m1308 | [0m[35m            # the dask config default isn't used when we are reusing a cluster[0m
[30;1m1309 | [0m[35m            if self.shutdown_on_close is None:[0m
[30;1m1310 | [0m[35m                self.shutdown_on_close = should_try_create and dask.config.get("coiled.shutdown-on-c[0m
[30;1m1311 | [0m[35m[0m
[30;1m1312 | [0m[35m            if should_try_create:[0m
[30;1m1313 | [0m[35m                ([0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1215 | [0m[35m                package_sync_env_alias = await scan_and_create([0m
[30;1m1216 | [0m[35m                    cloud=self.cloud,[0m
[30;1m1217 | [0m[35m                    cluster=self,[0m
[30;1m1218 | [0m[35m                    region_name=self.backend_options.get("region_name") if self.backend_options else[0m
[30;1m1219 | [0m[35m                    architecture=architecture,[0m
[30;1m1220 | [0m[35m                    gpu_enabled=gpu_enabled,[0m
[30;1m1221 | [0m[35m                    workspace=self.workspace,[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1085 | [0m[35m        else:[0m
[30;1m1086 | [0m[35m            # get default types from dask config[0m
[30;1m1087 | [0m[35m            if self.scheduler_vm_types is None:[0m
[30;1m1088 | [0m[35m                self.scheduler_vm_types = dask.config.get("coiled.scheduler.vm_types")[0m
[30;1m1089 | [0m[35m            # accept string or list of strings[0m
[30;1m1090 | [0m[35m            if isinstance(self.scheduler_vm_types, str):[0m
[30;1m1091 | [0m[35m                self.scheduler_vm_types = [self.scheduler_vm_types][0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1063 | [0m[35m        else:[0m
[30;1m1064 | [0m[35m            # get default types from dask config[0m
[30;1m1065 | [0m[35m            if self.worker_vm_types is None:[0m
[30;1m1066 | [0m[35m                self.worker_vm_types = dask.config.get("coiled.worker.vm-types")[0m
[30;1m1067 | [0m[35m            # accept string or list of strings[0m
[30;1m1068 | [0m[35m            if isinstance(self.worker_vm_types, str):[0m
[30;1m1069 | [0m[35m                self.worker_vm_types = [self.worker_vm_types][0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1037 | [0m[35m        if use_rich_widget() and self.cluster_id:[0m
[30;1m1038 | [0m[35m            rich_widget = RichClusterWidget(server=self.cloud.server, workspace=self.workspace)[0m
[30;1m1039 | [0m[35m            cluster_details = cloud._get_cluster_details_synced(cluster_id=self.cluster_id, workspac[0m
[30;1m1040 | [0m[35m            if cluster_details.get("coiled_hosted"):[0m
[30;1m1041 | [0m[35m                self._is_coiled_hosted = True[0m
[30;1m1042 | [0m[35m            self.sync(self._update_cluster_status_logs, asynchronous=False)[0m
[30;1m1043 | [0m[35m            rich_widget.update(cluster_details, self._cluster_status_logs)[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1020 | [0m[35m            cluster_details = self.cloud._get_cluster_details_synced([0m
[30;1m1021 | [0m[35m                cluster_id=self.cluster_id, workspace=self.workspace[0m
[30;1m1022 | [0m[35m            )[0m
[30;1m1023 | [0m[35m            if cluster_details.get("coiled_hosted"):[0m
[30;1m1024 | [0m[35m                self._is_coiled_hosted = True[0m
[30;1m1025 | [0m[35m            self.sync(self._update_cluster_status_logs, asynchronous=False)[0m
[30;1m1026 | [0m[35m            widget.update(cluster_details, self._cluster_status_logs)[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m909 | [0m[35m        else:[0m
[30;1m910 | [0m[35m            self.host_setup_script_content = host_setup_script[0m
[30;1m911 | [0m[35m[0m
[30;1m912 | [0m[35m        idle_timeout = idle_timeout or dask.config.get("distributed.scheduler.idle-timeout", None)[0m
[30;1m913 | [0m[35m        if idle_timeout:[0m
[30;1m914 | [0m[35m            dask.utils.parse_timedelta(idle_timeout)  # fail fast if dask can't parse this timedelta[0m
[30;1m915 | [0m[35m            self.scheduler_options["idle_timeout"] = idle_timeout[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m867 | [0m[35m[0m
[30;1m868 | [0m[35m        self.backend_options = backend_options[0m
[30;1m869 | [0m[35m[0m
[30;1m870 | [0m[35m        scheduler_port = scheduler_port or dask.config.get("coiled.scheduler_port", None)[0m
[30;1m871 | [0m[35m[0m
[30;1m872 | [0m[35m        custom_network_kwargs = {[0m
[30;1m873 | [0m[35m            "allow_ingress_from": allow_ingress_from,[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m861 | [0m[35m            else use_scheduler_public_ip[0m
[30;1m862 | [0m[35m        )[0m
[30;1m863 | [0m[35m        self.use_dashboard_https: bool = ([0m
[30;1m864 | [0m[35m            dask.config.get("coiled.use_dashboard_https", True) if use_dashboard_https is None else [0m
[30;1m865 | [0m[35m        )[0m
[30;1m866 | [0m[35m        self.dashboard_custom_subdomain = dashboard_custom_subdomain[0m
[30;1m867 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m856 | [0m[35m[0m
[30;1m857 | [0m[35m        self.cluster_id: int | None = None[0m
[30;1m858 | [0m[35m        self.use_scheduler_public_ip: bool = ([0m
[30;1m859 | [0m[35m            dask.config.get("coiled.use_scheduler_public_ip", True)[0m
[30;1m860 | [0m[35m            if use_scheduler_public_ip is None[0m
[30;1m861 | [0m[35m            else use_scheduler_public_ip[0m
[30;1m862 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m825 | [0m[35m                v1_debug_loggers = [[0m
[30;1m826 | [0m[35m                    k[0m
[30;1m827 | [0m[35m                    for k, v in dask_log_config.get("loggers", {}).items()[0m
[30;1m828 | [0m[35m                    if isinstance(v, dict) and v.get("level") == "DEBUG"[0m
[30;1m829 | [0m[35m                ][0m
[30;1m830 | [0m[35m                debug_loggers = [*v0_debug_loggers, *v1_debug_loggers][0m
[30;1m831 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m824 | [0m[35m                ][0m
[30;1m825 | [0m[35m                v1_debug_loggers = [[0m
[30;1m826 | [0m[35m                    k[0m
[30;1m827 | [0m[35m                    for k, v in dask_log_config.get("loggers", {}).items()[0m
[30;1m828 | [0m[35m                    if isinstance(v, dict) and v.get("level") == "DEBUG"[0m
[30;1m829 | [0m[35m                ][0m
[30;1m830 | [0m[35m                debug_loggers = [*v0_debug_loggers, *v1_debug_loggers][0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m810 | [0m[35m                )[0m
[30;1m811 | [0m[35m                self.frozen_dask_config = None[0m
[30;1m812 | [0m[35m[0m
[30;1m813 | [0m[35m            dask_log_config = dask.config.get("logging", {})[0m
[30;1m814 | [0m[35m            if dask_log_config:[0m
[30;1m815 | [0m[35m                # logging can be set in different ways in dask config, for example,[0m
[30;1m816 | [0m[35m                # logging:[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m791 | [0m[35m        self.frozen_dask_config = deepcopy(dask.config.config) if send_dask_config else {}[0m
[30;1m792 | [0m[35m        self.credentials = CredentialsPreferred(credentials)[0m
[30;1m793 | [0m[35m        self._credentials_duration_seconds = credentials_duration_seconds[0m
[30;1m794 | [0m[35m        self._default_protocol = dask.config.get("coiled.protocol", "tls")[0m
[30;1m795 | [0m[35m        self._wait_for_workers_arg = wait_for_workers[0m
[30;1m796 | [0m[35m        self._last_logged_state_summary = None[0m
[30;1m797 | [0m[35m        self._try_local_gcp_creds = True[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m787 | [0m[35m[0m
[30;1m788 | [0m[35m        # Cluster-specific kwarg tags take precedence over globally set config tags[0m
[30;1m789 | [0m[35m        kwarg_tags = {k: str(v) for (k, v) in (tags or {}).items() if v}[0m
[30;1m790 | [0m[35m        self.tags = {**dask.config.get("coiled.tags", {}), **kwarg_tags}[0m
[30;1m791 | [0m[35m        self.frozen_dask_config = deepcopy(dask.config.config) if send_dask_config else {}[0m
[30;1m792 | [0m[35m        self.credentials = CredentialsPreferred(credentials)[0m
[30;1m793 | [0m[35m        self._credentials_duration_seconds = credentials_duration_seconds[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m772 | [0m[35m                "The `account` kwarg is deprecated, use `workspace` instead.", DeprecationWarning, s[0m
[30;1m773 | [0m[35m            )[0m
[30;1m774 | [0m[35m[0m
[30;1m775 | [0m[35m        self.name = name or cast(Optional[str], dask.config.get("coiled.name"))[0m
[30;1m776 | [0m[35m        self.workspace = workspace or account[0m
[30;1m777 | [0m[35m        self._start_n_workers = n_workers[0m
[30;1m778 | [0m[35m        self._lock = None[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m732 | [0m[35m        }[0m
[30;1m733 | [0m[35m[0m
[30;1m734 | [0m[35m        # use dask config if kwarg not specified for scheduler gpu[0m
[30;1m735 | [0m[35m        scheduler_gpu = scheduler_gpu if scheduler_gpu is not None else dask.config.get("coiled.sche[0m
[30;1m736 | [0m[35m[0m
[30;1m737 | [0m[35m        self._is_gpu_cluster = ([0m
[30;1m738 | [0m[35m            # explicitly specified GPU (needed for GCP guest GPU)[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m727 | [0m[35m        )[0m
[30;1m728 | [0m[35m        self.scheduler_disk_size = parse_bytes_as_gib(scheduler_disk_size)[0m
[30;1m729 | [0m[35m        self.scheduler_options = {[0m
[30;1m730 | [0m[35m            **(cast(dict, dask.config.get("coiled.scheduler-options", {}))),[0m
[30;1m731 | [0m[35m            **(scheduler_options or {}),[0m
[30;1m732 | [0m[35m        }[0m
[30;1m733 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m723 | [0m[35m        self.scheduler_vm_types = scheduler_vm_types[0m
[30;1m724 | [0m[35m        self.scheduler_cpu = scheduler_cpu or cast(Union[int, List[int]], dask.config.get("coiled.sc[0m
[30;1m725 | [0m[35m        self.scheduler_memory = scheduler_memory or cast([0m
[30;1m726 | [0m[35m            Union[int, List[int]], dask.config.get("coiled.scheduler.memory")[0m
[30;1m727 | [0m[35m        )[0m
[30;1m728 | [0m[35m        self.scheduler_disk_size = parse_bytes_as_gib(scheduler_disk_size)[0m
[30;1m729 | [0m[35m        self.scheduler_options = {[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m721 | [0m[35m        }[0m
[30;1m722 | [0m[35m[0m
[30;1m723 | [0m[35m        self.scheduler_vm_types = scheduler_vm_types[0m
[30;1m724 | [0m[35m        self.scheduler_cpu = scheduler_cpu or cast(Union[int, List[int]], dask.config.get("coiled.sc[0m
[30;1m725 | [0m[35m        self.scheduler_memory = scheduler_memory or cast([0m
[30;1m726 | [0m[35m            Union[int, List[int]], dask.config.get("coiled.scheduler.memory")[0m
[30;1m727 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m716 | [0m[35m        self.worker_gpu_count = int(worker_gpu) if worker_gpu is not None else None[0m
[30;1m717 | [0m[35m        self.worker_gpu_type = worker_gpu_type[0m
[30;1m718 | [0m[35m        self.worker_options = {[0m
[30;1m719 | [0m[35m            **(cast(dict, dask.config.get("coiled.worker-options", {}))),[0m
[30;1m720 | [0m[35m            **(worker_options or {}),[0m
[30;1m721 | [0m[35m        }[0m
[30;1m722 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m707 | [0m[35m            elif worker_cpu < 1:[0m
[30;1m708 | [0m[35m                raise ValueError("`worker_cpu` should be at least 1 for arm instance types.")[0m
[30;1m709 | [0m[35m[0m
[30;1m710 | [0m[35m        self.worker_memory = worker_memory or dask.config.get("coiled.worker.memory")[0m
[30;1m711 | [0m[35m        # FIXME get these from dask config[0m
[30;1m712 | [0m[35m        self.worker_vm_types = worker_vm_types[0m
[30;1m713 | [0m[35m        self.worker_disk_size = parse_bytes_as_gib(worker_disk_size)[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m699 | [0m[35m            self.package_sync = True[0m
[30;1m700 | [0m[35m[0m
[30;1m701 | [0m[35m        self.worker_class = worker_class or dask.config.get("coiled.worker.class")[0m
[30;1m702 | [0m[35m        self.worker_cpu = worker_cpu or cast(Union[int, List[int]], dask.config.get("coiled.worker.c[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m        if isinstance(worker_cpu, int) and worker_cpu <= 1:[0m
[30;1m705 | [0m[35m            if not arm:[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m698 | [0m[35m        if not container and not self.software_environment and not package_sync:[0m
[30;1m699 | [0m[35m            self.package_sync = True[0m
[30;1m700 | [0m[35m[0m
[30;1m701 | [0m[35m        self.worker_class = worker_class or dask.config.get("coiled.worker.class")[0m
[30;1m702 | [0m[35m        self.worker_cpu = worker_cpu or cast(Union[int, List[int]], dask.config.get("coiled.worker.c[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m        if isinstance(worker_cpu, int) and worker_cpu <= 1:[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m693 | [0m[35m        self.batch_job_ids = batch_job_ids[0m
[30;1m694 | [0m[35m        self.extra_user_container = batch_job_container[0m
[30;1m695 | [0m[35m[0m
[30;1m696 | [0m[35m        self.software_environment = software or dask.config.get("coiled.software")[0m
[30;1m697 | [0m[35m        self.software_container = container[0m
[30;1m698 | [0m[35m        if not container and not self.software_environment and not package_sync:[0m
[30;1m699 | [0m[35m            self.package_sync = True[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m684 | [0m[35m        # Set cluster attributes from kwargs (first choice) or dask config[0m
[30;1m685 | [0m[35m[0m
[30;1m686 | [0m[35m        self.private_to_creator = ([0m
[30;1m687 | [0m[35m            dask.config.get("coiled.private-to-creator") if private_to_creator is None else private_[0m
[30;1m688 | [0m[35m        )[0m
[30;1m689 | [0m[35m[0m
[30;1m690 | [0m[35m        self.extra_worker_on_scheduler = extra_worker_on_scheduler[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m590 | [0m[35m        self.package_sync_conda_extras = package_sync_conda_extras[0m
[30;1m591 | [0m[35m        # We set this config option in `coiled hello` to reduce package sync build errors[0m
[30;1m592 | [0m[35m        if not package_sync_only and dask.config.get("coiled._internal.package_sync_only", False):[0m
[30;1m593 | [0m[35m            package_sync_only = dask.config.get("coiled._internal.package_sync_only")[0m
[30;1m594 | [0m[35m        self.package_sync_only = set(package_sync_only) if package_sync_only else None[0m
[30;1m595 | [0m[35m        if isinstance(package_sync, list):[0m
[30;1m596 | [0m[35m            if self.package_sync_only:[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m589 | [0m[35m        self.package_sync_ignore = package_sync_ignore[0m
[30;1m590 | [0m[35m        self.package_sync_conda_extras = package_sync_conda_extras[0m
[30;1m591 | [0m[35m        # We set this config option in `coiled hello` to reduce package sync build errors[0m
[30;1m592 | [0m[35m        if not package_sync_only and dask.config.get("coiled._internal.package_sync_only", False):[0m
[30;1m593 | [0m[35m            package_sync_only = dask.config.get("coiled._internal.package_sync_only")[0m
[30;1m594 | [0m[35m        self.package_sync_only = set(package_sync_only) if package_sync_only else None[0m
[30;1m595 | [0m[35m        if isinstance(package_sync, list):[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2591 | [0m[35m[0m
[30;1m2592 | [0m[35m        # Because there's a limit on URL length and worker names are passed in DELETE as url params,[0m
[30;1m2593 | [0m[35m        # 1. remove the non-unique part of name (worker name is "<cluster name>-worker-<unique id>")[0m
[30;1m2594 | [0m[35m        # 2. limit worker in DELETE request to batch of at most 500.[0m
[30;1m2595 | [0m[35m        worker_name_identifiers = [w.replace(f"{self.name}-worker", "") for w in workers][0m
[30;1m2596 | [0m[35m        batch_size = 200[0m
[30;1m2597 | [0m[35m        for batch_start in range(0, len(worker_name_identifiers), batch_size):[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2463 | [0m[35m                    # this is a fail-safe in case there's some reason this endpoint isn't responding[0m
[30;1m2464 | [0m[35m                    self.periodic_callbacks["check_coiled_state"].stop()[0m
[30;1m2465 | [0m[35m                elif "rate limit" in str(e).lower():[0m
[30;1m2466 | [0m[35m                    # every time we get rate limit, reduce rate at which we check cluster state[0m
[30;1m2467 | [0m[35m                    check_interval = ([0m
[30;1m2468 | [0m[35m                        dask.utils.parse_timedelta(dask.config.get("coiled.cluster-state-check-inter[0m
[30;1m2469 | [0m[35m                        * 1000[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2239 | [0m[35m[0m
[30;1m2240 | [0m[35m        elif self._credentials_duration_seconds and self._credentials_duration_seconds < 900:[0m
[30;1m2241 | [0m[35m            # 15 minutes is min duration for STS token, but if shorter duration explicitly[0m
[30;1m2242 | [0m[35m            # requested, then we'll update as if that were the duration (with lower bound of 5s).[0m
[30;1m2243 | [0m[35m            delay = max(5, int(self._credentials_duration_seconds * 0.5))[0m
[30;1m2244 | [0m[35m[0m
[30;1m2245 | [0m[35m        self._queue_cluster_event("credentials", f"refresh scheduled in {delay} seconds for {label}"[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2234 | [0m[35m                # TODO give user information about what to do in this case[0m
[30;1m2235 | [0m[35m                logger.warning(f"Locally generated {label} expires in less than 5 minutes ({diff}).{[0m
[30;1m2236 | [0m[35m[0m
[30;1m2237 | [0m[35m            # don't try to update sooner than in 1 minute[0m
[30;1m2238 | [0m[35m            delay = max(60, delay)[0m
[30;1m2239 | [0m[35m[0m
[30;1m2240 | [0m[35m        elif self._credentials_duration_seconds and self._credentials_duration_seconds < 900:[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1938 | [0m[35m                await self._submit_cluster_event("adaptive", "disabled", level=logging.INFO)[0m
[30;1m1939 | [0m[35m            self._adaptive.stop()[0m
[30;1m1940 | [0m[35m[0m
[30;1m1941 | [0m[35m        await self._set_plan_requested()  # need to update our understanding of current workers befo[0m
[30;1m1942 | [0m[35m        logger.debug(f"current _plan: {self._plan}")[0m
[30;1m1943 | [0m[35m[0m
[30;1m1944 | [0m[35m        recommendations = await self.recommendations(n)[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1750 | [0m[35m                    enough_workers_ready = False[0m
[30;1m1751 | [0m[35m                    workers_reason_not_ready = ([0m
[30;1m1752 | [0m[35m                        f"Only {len(ready_worker_current)} workers ready "[0m
[30;1m1753 | [0m[35m                        f"(was waiting for at least {num_workers_to_wait_for}). "[0m
[30;1m1754 | [0m[35m                    )[0m
[30;1m1755 | [0m[35m[0m
[30;1m1756 | [0m[35m                # Check if cluster is ready to return to user in a good state[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1532 | [0m[35m                    logger.warning([0m
[30;1m1533 | [0m[35m                        "Using adaptive scaling with default range of "[0m
[30;1m1534 | [0m[35m                        f"`[{DEFAULT_ADAPTIVE_MIN}, {DEFAULT_ADAPTIVE_MAX}]`. "[0m
[30;1m1535 | [0m[35m                        "To manually control the size of your cluster, use n_workers=.\n"[0m
[30;1m1536 | [0m[35m                    )[0m
[30;1m1537 | [0m[35m                logger.info([0m
[30;1m1538 | [0m[35m                    f"Creating Cluster (name: {self.name}, {self.details_url} ). This usually takes [0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1317 | [0m[35m[0m
[30;1m1318 | [0m[35m                user_provider = await self._get_account_cloud_provider_name()[0m
[30;1m1319 | [0m[35m[0m
[30;1m1320 | [0m[35m                # Update backend options for cluster based on the friendlier kwargs[0m
[30;1m1321 | [0m[35m                if self.scheduler_gpu:[0m
[30;1m1322 | [0m[35m                    if user_provider == "gcp":[0m
[30;1m1323 | [0m[35m                        self.backend_options = {[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1160 | [0m[35m        started_at: datetime.datetime | None,[0m
[30;1m1161 | [0m[35m        workspace: str | None = None,[0m
[30;1m1162 | [0m[35m    ):[0m
[30;1m1163 | [0m[35m        # wait at most 2 minutes for cert to be ready[0m
[30;1m1164 | [0m[35m        started_at = started_at or datetime.datetime.now(tz=datetime.timezone.utc)[0m
[30;1m1165 | [0m[35m        timeout_at = started_at + datetime.timedelta(minutes=2)[0m
[30;1m1166 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m996 | [0m[35m[0m
[30;1m997 | [0m[35m    @property[0m
[30;1m998 | [0m[35m    def details_url(self):[0m
[30;1m999 | [0m[35m        """URL for cluster on the web UI at cloud.coiled.io."""[0m
[30;1m1000 | [0m[35m        return get_details_url(self.cloud.server, self.workspace, self.cluster_id)[0m
[30;1m1001 | [0m[35m[0m
[30;1m1002 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m705 | [0m[35m            if not arm:[0m
[30;1m706 | [0m[35m                raise ValueError("`worker_cpu` should be at least 2 for x86 instance types.")[0m
[30;1m707 | [0m[35m            elif worker_cpu < 1:[0m
[30;1m708 | [0m[35m                raise ValueError("`worker_cpu` should be at least 1 for arm instance types.")[0m
[30;1m709 | [0m[35m[0m
[30;1m710 | [0m[35m        self.worker_memory = worker_memory or dask.config.get("coiled.worker.memory")[0m
[30;1m711 | [0m[35m        # FIXME get these from dask config[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m        if isinstance(worker_cpu, int) and worker_cpu <= 1:[0m
[30;1m705 | [0m[35m            if not arm:[0m
[30;1m706 | [0m[35m                raise ValueError("`worker_cpu` should be at least 2 for x86 instance types.")[0m
[30;1m707 | [0m[35m            elif worker_cpu < 1:[0m
[30;1m708 | [0m[35m                raise ValueError("`worker_cpu` should be at least 1 for arm instance types.")[0m
[30;1m709 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m632 | [0m[35m            if backend_options is None:[0m
[30;1m633 | [0m[35m                backend_options = {}[0m
[30;1m634 | [0m[35m            # backend_options supports both `region` and `region_name` (for backwards compatibility[0m
[30;1m635 | [0m[35m            # since we changed it at some point).[0m
[30;1m636 | [0m[35m            # If either of those is specified along with kwarg `region=`, raise an exception.[0m
[30;1m637 | [0m[35m            if "region_name" in backend_options:[0m
[30;1m638 | [0m[35m                raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m548 | [0m[35m        if self.start_adaptive:[0m
[30;1m549 | [0m[35m            n_workers = adaptive_min[0m
[30;1m550 | [0m[35m[0m
[30;1m551 | [0m[35m        # by this point n_workers will always be an int, but pyright isn't good at understanding thi[0m
[30;1m552 | [0m[35m        n_workers = cast(int, n_workers)[0m
[30;1m553 | [0m[35m[0m
[30;1m554 | [0m[35m        # When there's an extra worker on scheduler, we'll request one fewer "worker" VM (non-schedu[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m421 | [0m[35m        Usually the default is the right choice; Coiled supports using 443 concurrently for schedule[0m
[30;1m422 | [0m[35m        and for scheduler dashboard.[0m
[30;1m423 | [0m[35m    allow_ingress_from[0m
[30;1m424 | [0m[35m        Control the CIDR from which cluster firewall allows ingress to scheduler; by default this is[0m
[30;1m425 | [0m[35m        to any source address (0.0.0.0/0). You can specify CIDR, or "me" for just your IP address.[0m
[30;1m426 | [0m[35m    allow_ssh_from[0m
[30;1m427 | [0m[35m        Allow connections to scheduler over port 22 (used for SSH) for a specified IP address or CID[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m354 | [0m[35m        Dask configuration option. Tags specified for cluster using keyword argument[0m
[30;1m355 | [0m[35m        take precedence over those from Dask configuration.[0m
[30;1m356 | [0m[35m    wait_for_workers[0m
[30;1m357 | [0m[35m        Whether to wait for a number of workers before returning control[0m
[30;1m358 | [0m[35m        of the prompt back to the user. Usually, computations will run better[0m
[30;1m359 | [0m[35m        if you wait for most workers before submitting tasks to the cluster.[0m
[30;1m360 | [0m[35m        You can wait for all workers by passing ``True``, or not wait for any[0m
[30;1m361 | [0m[35m        by passing ``False``. You can pass a fraction of the total number of[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m345 | [0m[35m        Whether to use the rich-based widget display.[0m
[30;1m346 | [0m[35m        By default, the widget will show in IPython/Jupyter; specify ``show_widget=True`` to make wi[0m
[30;1m347 | [0m[35m        even when not in IPython/Jupyter (for example, when making cluster in code invoked via CLI).[0m
[30;1m348 | [0m[35m        For use cases involving multiple Clusters at once, ``show_widget=False`` is recommended.[0m
[30;1m349 | [0m[35m    custom_widget[0m
[30;1m350 | [0m[35m        Use the rich-based widget display outside of IPython/Jupyter[0m
[30;1m351 | [0m[35m        (Default: False)[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2938 | [0m[35m            if service:[0m
[30;1m2939 | [0m[35m                mount_kwargs["service"] = service[0m
[30;1m2940 | [0m[35m[0m
[30;1m2941 | [0m[35m            # agent on host VM watches /mount/.requests for info about buckets to mount[0m
[30;1m2942 | [0m[35m            request_files[f"/mount/.requests/todo/{short_random_string()}"] = json.dumps(mount_kwarg[0m
[30;1m2943 | [0m[35m[0m
[30;1m2944 | [0m[35m        if send_adc:[0m
[30;1m2945 | [0m[35m            send_application_default_credentials(self)[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2936 | [0m[35m[0m
[30;1m2937 | [0m[35m            mount_kwargs = {"bucket": single_bucket}[0m
[30;1m2938 | [0m[35m            if service:[0m
[30;1m2939 | [0m[35m                mount_kwargs["service"] = service[0m
[30;1m2940 | [0m[35m[0m
[30;1m2941 | [0m[35m            # agent on host VM watches /mount/.requests for info about buckets to mount[0m
[30;1m2942 | [0m[35m            request_files[f"/mount/.requests/todo/{short_random_string()}"] = json.dumps(mount_kwarg[0m
[30;1m2943 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2927 | [0m[35m                # mount for Google Cloud Storage bucket relies on Application Default Credentials[0m
[30;1m2928 | [0m[35m                send_adc = True[0m
[30;1m2929 | [0m[35m            elif service == "s3":[0m
[30;1m2930 | [0m[35m                # mount for S3 bucket relies on the renewable credential endpoint[0m
[30;1m2931 | [0m[35m                if not self._using_aws_creds_endpoint:[0m
[30;1m2932 | [0m[35m                    logger.warning([0m
[30;1m2933 | [0m[35m                        f"Mounting bucket '{bucket}' requires forwarding of refreshable AWS credenti[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2926 | [0m[35m            if service == "gcs":[0m
[30;1m2927 | [0m[35m                # mount for Google Cloud Storage bucket relies on Application Default Credentials[0m
[30;1m2928 | [0m[35m                send_adc = True[0m
[30;1m2929 | [0m[35m            elif service == "s3":[0m
[30;1m2930 | [0m[35m                # mount for S3 bucket relies on the renewable credential endpoint[0m
[30;1m2931 | [0m[35m                if not self._using_aws_creds_endpoint:[0m
[30;1m2932 | [0m[35m                    logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2924 | [0m[35m                    service = "gcs"[0m
[30;1m2925 | [0m[35m[0m
[30;1m2926 | [0m[35m            if service == "gcs":[0m
[30;1m2927 | [0m[35m                # mount for Google Cloud Storage bucket relies on Application Default Credentials[0m
[30;1m2928 | [0m[35m                send_adc = True[0m
[30;1m2929 | [0m[35m            elif service == "s3":[0m
[30;1m2930 | [0m[35m                # mount for S3 bucket relies on the renewable credential endpoint[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2923 | [0m[35m                if self.workspace_cloud_provider_name == "gcp":[0m
[30;1m2924 | [0m[35m                    service = "gcs"[0m
[30;1m2925 | [0m[35m[0m
[30;1m2926 | [0m[35m            if service == "gcs":[0m
[30;1m2927 | [0m[35m                # mount for Google Cloud Storage bucket relies on Application Default Credentials[0m
[30;1m2928 | [0m[35m                send_adc = True[0m
[30;1m2929 | [0m[35m            elif service == "s3":[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2921 | [0m[35m                if self.workspace_cloud_provider_name == "aws":[0m
[30;1m2922 | [0m[35m                    service = "s3"[0m
[30;1m2923 | [0m[35m                if self.workspace_cloud_provider_name == "gcp":[0m
[30;1m2924 | [0m[35m                    service = "gcs"[0m
[30;1m2925 | [0m[35m[0m
[30;1m2926 | [0m[35m            if service == "gcs":[0m
[30;1m2927 | [0m[35m                # mount for Google Cloud Storage bucket relies on Application Default Credentials[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2919 | [0m[35m            # if s3 or gcs is not explicitly specified, default to storage service for workspace clo[0m
[30;1m2920 | [0m[35m            if not service and "://" not in single_bucket:[0m
[30;1m2921 | [0m[35m                if self.workspace_cloud_provider_name == "aws":[0m
[30;1m2922 | [0m[35m                    service = "s3"[0m
[30;1m2923 | [0m[35m                if self.workspace_cloud_provider_name == "gcp":[0m
[30;1m2924 | [0m[35m                    service = "gcs"[0m
[30;1m2925 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2917 | [0m[35m            # for example, we might add backend support for "r2://" and don't want to block this in [0m
[30;1m2918 | [0m[35m[0m
[30;1m2919 | [0m[35m            # if s3 or gcs is not explicitly specified, default to storage service for workspace clo[0m
[30;1m2920 | [0m[35m            if not service and "://" not in single_bucket:[0m
[30;1m2921 | [0m[35m                if self.workspace_cloud_provider_name == "aws":[0m
[30;1m2922 | [0m[35m                    service = "s3"[0m
[30;1m2923 | [0m[35m                if self.workspace_cloud_provider_name == "gcp":[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2916 | [0m[35m            # don't block other schemes here and pass URI through so they can be handled by code doi[0m
[30;1m2917 | [0m[35m            # for example, we might add backend support for "r2://" and don't want to block this in [0m
[30;1m2918 | [0m[35m[0m
[30;1m2919 | [0m[35m            # if s3 or gcs is not explicitly specified, default to storage service for workspace clo[0m
[30;1m2920 | [0m[35m            if not service and "://" not in single_bucket:[0m
[30;1m2921 | [0m[35m                if self.workspace_cloud_provider_name == "aws":[0m
[30;1m2922 | [0m[35m                    service = "s3"[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2912 | [0m[35m            if single_bucket.startswith("gs://"):[0m
[30;1m2913 | [0m[35m                service = "gcs"[0m
[30;1m2914 | [0m[35m            elif single_bucket.startswith("s3://"):[0m
[30;1m2915 | [0m[35m                service = "s3"[0m
[30;1m2916 | [0m[35m            # don't block other schemes here and pass URI through so they can be handled by code doi[0m
[30;1m2917 | [0m[35m            # for example, we might add backend support for "r2://" and don't want to block this in [0m
[30;1m2918 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2910 | [0m[35m            service = None[0m
[30;1m2911 | [0m[35m[0m
[30;1m2912 | [0m[35m            if single_bucket.startswith("gs://"):[0m
[30;1m2913 | [0m[35m                service = "gcs"[0m
[30;1m2914 | [0m[35m            elif single_bucket.startswith("s3://"):[0m
[30;1m2915 | [0m[35m                service = "s3"[0m
[30;1m2916 | [0m[35m            # don't block other schemes here and pass URI through so they can be handled by code doi[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2907 | [0m[35m        self._queue_cluster_event("mount", "Attempting to mount buckets", extra_data={"buckets": buc[0m
[30;1m2908 | [0m[35m[0m
[30;1m2909 | [0m[35m        for single_bucket in buckets:[0m
[30;1m2910 | [0m[35m            service = None[0m
[30;1m2911 | [0m[35m[0m
[30;1m2912 | [0m[35m            if single_bucket.startswith("gs://"):[0m
[30;1m2913 | [0m[35m                service = "gcs"[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2904 | [0m[35m        send_adc = False[0m
[30;1m2905 | [0m[35m[0m
[30;1m2906 | [0m[35m        buckets: List[str] = [bucket] if isinstance(bucket, str) else bucket[0m
[30;1m2907 | [0m[35m        self._queue_cluster_event("mount", "Attempting to mount buckets", extra_data={"buckets": buc[0m
[30;1m2908 | [0m[35m[0m
[30;1m2909 | [0m[35m        for single_bucket in buckets:[0m
[30;1m2910 | [0m[35m            service = None[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2721 | [0m[35m        interval : timedelta or str[0m
[30;1m2722 | [0m[35m            Milliseconds between checks, defaults to 5000 ms.[0m
[30;1m2723 | [0m[35m        target_duration : timedelta or str[0m
[30;1m2724 | [0m[35m            Amount of time we want a computation to take. This affects how[0m
[30;1m2725 | [0m[35m            aggressively the cluster scales up.[0m
[30;1m2726 | [0m[35m[0m
[30;1m2727 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2463 | [0m[35m                    # this is a fail-safe in case there's some reason this endpoint isn't responding[0m
[30;1m2464 | [0m[35m                    self.periodic_callbacks["check_coiled_state"].stop()[0m
[30;1m2465 | [0m[35m                elif "rate limit" in str(e).lower():[0m
[30;1m2466 | [0m[35m                    # every time we get rate limit, reduce rate at which we check cluster state[0m
[30;1m2467 | [0m[35m                    check_interval = ([0m
[30;1m2468 | [0m[35m                        dask.utils.parse_timedelta(dask.config.get("coiled.cluster-state-check-inter[0m
[30;1m2469 | [0m[35m                        * 1000[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2273 | [0m[35m            ][0m
[30;1m2274 | [0m[35m[0m
[30;1m2275 | [0m[35m            # creds endpoint will be used iff expiration is sent to plugin[0m
[30;1m2276 | [0m[35m            # so this is a way to (for now) feature flag using creds endpoint (vs. env vars)[0m
[30;1m2277 | [0m[35m            if dask.config.get("coiled.use_aws_creds_endpoint", False):[0m
[30;1m2278 | [0m[35m                keys.append("Expiration")[0m
[30;1m2279 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2227 | [0m[35m            diff = expiration - datetime.datetime.now(tz=datetime.timezone.utc)[0m
[30;1m2228 | [0m[35m            delay = int((diff * 0.5).total_seconds())[0m
[30;1m2229 | [0m[35m[0m
[30;1m2230 | [0m[35m            if diff < datetime.timedelta(minutes=5):[0m
[30;1m2231 | [0m[35m                # usually the existing STS token will be from a role assumption and[0m
[30;1m2232 | [0m[35m                # will expire in ~1 hour, but just in case the local session has a very[0m
[30;1m2233 | [0m[35m                # short lived token, let the user know[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2224 | [0m[35m        delay = 45 * 60[0m
[30;1m2225 | [0m[35m[0m
[30;1m2226 | [0m[35m        if expiration:[0m
[30;1m2227 | [0m[35m            diff = expiration - datetime.datetime.now(tz=datetime.timezone.utc)[0m
[30;1m2228 | [0m[35m            delay = int((diff * 0.5).total_seconds())[0m
[30;1m2229 | [0m[35m[0m
[30;1m2230 | [0m[35m            if diff < datetime.timedelta(minutes=5):[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2077 | [0m[35m            deadline = None[0m
[30;1m2078 | [0m[35m        else:[0m
[30;1m2079 | [0m[35m            timeout = dask.utils.parse_timedelta(timeout, "s")[0m
[30;1m2080 | [0m[35m            deadline = time.time() + timeout if timeout else None[0m
[30;1m2081 | [0m[35m[0m
[30;1m2082 | [0m[35m        scheduler_comm = self._ensure_scheduler_comm()[0m
[30;1m2083 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2077 | [0m[35m            deadline = None[0m
[30;1m2078 | [0m[35m        else:[0m
[30;1m2079 | [0m[35m            timeout = dask.utils.parse_timedelta(timeout, "s")[0m
[30;1m2080 | [0m[35m            deadline = time.time() + timeout if timeout else None[0m
[30;1m2081 | [0m[35m[0m
[30;1m2082 | [0m[35m        scheduler_comm = self._ensure_scheduler_comm()[0m
[30;1m2083 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2076 | [0m[35m        if timeout is None:[0m
[30;1m2077 | [0m[35m            deadline = None[0m
[30;1m2078 | [0m[35m        else:[0m
[30;1m2079 | [0m[35m            timeout = dask.utils.parse_timedelta(timeout, "s")[0m
[30;1m2080 | [0m[35m            deadline = time.time() + timeout if timeout else None[0m
[30;1m2081 | [0m[35m[0m
[30;1m2082 | [0m[35m        scheduler_comm = self._ensure_scheduler_comm()[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2073 | [0m[35m        def running_workers(info):[0m
[30;1m2074 | [0m[35m            return len([ws for ws in info["workers"].values() if ws["status"] == Status.running.name[0m
[30;1m2075 | [0m[35m[0m
[30;1m2076 | [0m[35m        if timeout is None:[0m
[30;1m2077 | [0m[35m            deadline = None[0m
[30;1m2078 | [0m[35m        else:[0m
[30;1m2079 | [0m[35m            timeout = dask.utils.parse_timedelta(timeout, "s")[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1827 | [0m[35m                            cluster_id=self.cluster_id,[0m
[30;1m1828 | [0m[35m                        )[0m
[30;1m1829 | [0m[35m                    elif timeout_at is not None and datetime.datetime.now(tz=datetime.timezone.utc) [0m
[30;1m1830 | [0m[35m                        error = "User-specified timeout expired: " + reason_not_ready[0m
[30;1m1831 | [0m[35m                        if widget:[0m
[30;1m1832 | [0m[35m                            widget.update([0m
[30;1m1833 | [0m[35m                                cluster_details,[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1617 | [0m[35m            "spot_policy": self.spot_policy,[0m
[30;1m1618 | [0m[35m            "start_adaptive": self.start_adaptive,[0m
[30;1m1619 | [0m[35m            "errored_worker_count": self.errored_worker_count,[0m
[30;1m1620 | [0m[35m            # NOTE: this is not a measure of the CLUSTER life time[0m
[30;1m1621 | [0m[35m            # just a measure of how long this object has been around[0m
[30;1m1622 | [0m[35m            "cluster_object_life": str(datetime.datetime.now(tz=datetime.timezone.utc) - self.init_t[0m
[30;1m1623 | [0m[35m        }[0m
[30;1m1624 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1434 | [0m[35m[0m
[30;1m1435 | [0m[35m                # create an ad hoc software environment if container was specified[0m
[30;1m1436 | [0m[35m                if self.software_container:[0m
[30;1m1437 | [0m[35m                    # make a valid software env name unique for this container[0m
[30;1m1438 | [0m[35m                    image_and_tag = self.software_container.split("/")[-1][0m
[30;1m1439 | [0m[35m                    uri_uuid = str(uuid.uuid5(uuid.NAMESPACE_DNS, self.software_container))[0m
[30;1m1440 | [0m[35m                    container_senv_name = re.sub([0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1427 | [0m[35m                    # We go in this `if`-block when:[0m
[30;1m1428 | [0m[35m                    #     1. No manual software environment was specified by the user (i.e. `softwar[0m
[30;1m1429 | [0m[35m                    #     2. This cluster is being created from within an existing package sync env[0m
[30;1m1430 | [0m[35m                    #     3. There's a GPU/no-GPU mismatch between the existing package sync env and[0m
[30;1m1431 | [0m[35m                    #        package sync environment being created here.[0m
[30;1m1432 | [0m[35m                    self.package_sync = True[0m
[30;1m1433 | [0m[35m                    self.software_environment = ""[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1426 | [0m[35me sync envs when there's a GPU / CPU mismatch.[0m
[30;1m1427 | [0m[35m                    # We go in this `if`-block when:[0m
[30;1m1428 | [0m[35m                    #     1. No manual software environment was specified by the user (i.e. `softwar[0m
[30;1m1429 | [0m[35m                    #     2. This cluster is being created from within an existing package sync env[0m
[30;1m1430 | [0m[35m                    #     3. There's a GPU/no-GPU mismatch between the existing package sync env and[0m
[30;1m1431 | [0m[35m                    #        package sync environment being created here.[0m
[30;1m1432 | [0m[35m                    self.package_sync = True[0m
[30;1m1433 | [0m[35m                    self.software_environment = ""[0m
[30;1m1434 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m679 | [0m[35m        # yet[0m
[30;1m680 | [0m[35m        super().__init__(asynchronous=asynchronous, loop=self.cloud.loop)[0m
[30;1m681 | [0m[35m[0m
[30;1m682 | [0m[35m        self.timeout = timeout if timeout is not None else self.cloud.default_cluster_timeout[0m
[30;1m683 | [0m[35m[0m
[30;1m684 | [0m[35m        # Set cluster attributes from kwargs (first choice) or dask config[0m
[30;1m685 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m679 | [0m[35m        # yet[0m
[30;1m680 | [0m[35m        super().__init__(asynchronous=asynchronous, loop=self.cloud.loop)[0m
[30;1m681 | [0m[35m[0m
[30;1m682 | [0m[35m        self.timeout = timeout if timeout is not None else self.cloud.default_cluster_timeout[0m
[30;1m683 | [0m[35m[0m
[30;1m684 | [0m[35m        # Set cluster attributes from kwargs (first choice) or dask config[0m
[30;1m685 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m619 | [0m[35m        if arm is None and (batch_job_container or container) and not (scheduler_vm_types or worker_[0m
[30;1m620 | [0m[35m            # The user didn't explicitly ask for ARM or non-ARM, so if they provided a container,[0m
[30;1m621 | [0m[35m            # see if we can match the required arch of that container.[0m
[30;1m622 | [0m[35m            # We're using public Docker Hub endpoint, so this only works currently for public images[0m
[30;1m623 | [0m[35m            image = batch_job_container or container or ""[0m
[30;1m624 | [0m[35m            if is_arm_only_image(image):[0m
[30;1m625 | [0m[35m                arm = True[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m443 | [0m[35m        for Dask), subdirectory name will be taken from bucket name.[0m
[30;1m444 | [0m[35m    host_setup_script[0m
[30;1m445 | [0m[35m        Script to run on the host VM during the setup process.[0m
[30;1m446 | [0m[35m        You can either specify as text of the script to run, or as path to a local script file to co[0m
[30;1m447 | [0m[35m    region[0m
[30;1m448 | [0m[35m        The cloud provider region in which to run the cluster.[0m
[30;1m449 | [0m[35m    arm[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m443 | [0m[35m        for Dask), subdirectory name will be taken from bucket name.[0m
[30;1m444 | [0m[35m    host_setup_script[0m
[30;1m445 | [0m[35m        Script to run on the host VM during the setup process.[0m
[30;1m446 | [0m[35m        You can either specify as text of the script to run, or as path to a local script file to co[0m
[30;1m447 | [0m[35m    region[0m
[30;1m448 | [0m[35m        The cloud provider region in which to run the cluster.[0m
[30;1m449 | [0m[35m    arm[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m442 | [0m[35m        Buckets are mounted to subdirectories in both ``/mount`` and ``./mount`` (relative to workin[0m
[30;1m443 | [0m[35m        for Dask), subdirectory name will be taken from bucket name.[0m
[30;1m444 | [0m[35m    host_setup_script[0m
[30;1m445 | [0m[35m        Script to run on the host VM during the setup process.[0m
[30;1m446 | [0m[35m        You can either specify as text of the script to run, or as path to a local script file to co[0m
[30;1m447 | [0m[35m    region[0m
[30;1m448 | [0m[35m        The cloud provider region in which to run the cluster.[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m437 | [0m[35m use ``jupyter_link`` to get link to access the Jupyter server.[0m
[30;1m438 | [0m[35m    mount_bucket[0m
[30;1m439 | [0m[35m        Optional name or list of names of buckets to mount. For example, ``"s3://my-s3-bucket"`` wil[0m
[30;1m440 | [0m[35m        bucket ``my-s3-bucket``, using your forwarded AWS credentials, and ``"gs://my-gcs-bucket"`` [0m
[30;1m441 | [0m[35m        the GCS bucket ``my-gcs-bucket`` using your forwarded Google Application Default Credentials[0m
[30;1m442 | [0m[35m        Buckets are mounted to subdirectories in both ``/mount`` and ``./mount`` (relative to workin[0m
[30;1m443 | [0m[35m        for Dask), subdirectory name will be taken from bucket name.[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m435 | [0m[35mthe cluster[0m
[30;1m436 | [0m[35m        (or in your local environment if using package sync).[0m
[30;1m437 | [0m[35m        Once the cluster is running, you can use ``jupyter_link`` to get link to access the Jupyter [0m
[30;1m438 | [0m[35m    mount_bucket[0m
[30;1m439 | [0m[35m        Optional name or list of names of buckets to mount. For example, ``"s3://my-s3-bucket"`` wil[0m
[30;1m440 | [0m[35m        bucket ``my-s3-bucket``, using your forwarded AWS credentials, and ``"gs://my-gcs-bucket"`` [0m
[30;1m441 | [0m[35m        the GCS bucket ``my-gcs-bucket`` using your forwarded Google Application Default Credentials[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m424 | [0m[35m        Control the CIDR from which cluster firewall allows ingress to scheduler; by default this is[0m
[30;1m425 | [0m[35m        to any source address (0.0.0.0/0). You can specify CIDR, or "me" for just your IP address.[0m
[30;1m426 | [0m[35m    allow_ssh_from[0m
[30;1m427 | [0m[35m        Allow connections to scheduler over port 22 (used for SSH) for a specified IP address or CID[0m
[30;1m428 | [0m[35m    allow_ssh[0m
[30;1m429 | [0m[35m        Allow connections to scheduler over port 22, used for SSH.[0m
[30;1m430 | [0m[35m    allow_spark[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m422 | [0m[35m        and for scheduler dashboard.[0m
[30;1m423 | [0m[35m    allow_ingress_from[0m
[30;1m424 | [0m[35m        Control the CIDR from which cluster firewall allows ingress to scheduler; by default this is[0m
[30;1m425 | [0m[35m        to any source address (0.0.0.0/0). You can specify CIDR, or "me" for just your IP address.[0m
[30;1m426 | [0m[35m    allow_ssh_from[0m
[30;1m427 | [0m[35m        Allow connections to scheduler over port 22 (used for SSH) for a specified IP address or CID[0m
[30;1m428 | [0m[35m    allow_ssh[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m388 | [0m[35m        Only allow exact packages matches, not recommended unless your client platform/architecture[0m
[30;1m389 | [0m[35m        matches the cluster platform/architecture[0m
[30;1m390 | [0m[35m    package_sync_use_uv_installer[0m
[30;1m391 | [0m[35m        Use ``uv`` to install pip packages when building the software environment. This should only [0m
[30;1m392 | [0m[35m        disabled if you are experiencing issues with ``uv`` and need to use ``pip`` instead.[0m
[30;1m393 | [0m[35m        (Default: True)[0m
[30;1m394 | [0m[35m    private_to_creator[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m328 | [0m[35m        For "local" credentials shipped to cluster as STS token, set the duration of STS token.[0m
[30;1m329 | [0m[35m        If not specified, the AWS default will be used.[0m
[30;1m330 | [0m[35m    timeout[0m
[30;1m331 | [0m[35m        Timeout in seconds to wait for a cluster to start, will use[0m
[30;1m332 | [0m[35m        ``default_cluster_timeout`` set on parent Cloud by default.[0m
[30;1m333 | [0m[35m    environ[0m
[30;1m334 | [0m[35m        Dictionary of environment variables. Values will be transmitted to Coiled; for private envir[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m327 | [0m[35m    credentials_duration_seconds[0m
[30;1m328 | [0m[35m        For "local" credentials shipped to cluster as STS token, set the duration of STS token.[0m
[30;1m329 | [0m[35m        If not specified, the AWS default will be used.[0m
[30;1m330 | [0m[35m    timeout[0m
[30;1m331 | [0m[35m        Timeout in seconds to wait for a cluster to start, will use[0m
[30;1m332 | [0m[35m        ``default_cluster_timeout`` set on parent Cloud by default.[0m
[30;1m333 | [0m[35m    environ[0m
[30;1m334 | [0m[35m        Dictionary of environment variables. Values will be transmitted to Coiled; for private envir[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m316 | [0m[35m        private IP address is routable from where this function call is made[0m
[30;1m317 | [0m[35m        when setting this to False.[0m
[30;1m318 | [0m[35m    use_dashboard_https[0m
[30;1m319 | [0m[35m        When public IP address is used for dashboard, we'll enable HTTPS + auth by default.[0m
[30;1m320 | [0m[35m        You may want to disable this if using something that needs to connect directly to[0m
[30;1m321 | [0m[35m        the scheduler dashboard without authentication, such as jupyter dask-labextension<=6.1.0.[0m
[30;1m322 | [0m[35m    credentials[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m313 | [0m[35m        using its public IP address, which means traffic will be routed over[0m
[30;1m314 | [0m[35m        the public internet. When set to False, traffic will be routed over[0m
[30;1m315 | [0m[35m        the local network the scheduler lives in, so make sure the scheduler[0m
[30;1m316 | [0m[35m        private IP address is routable from where this function call is made[0m
[30;1m317 | [0m[35m        when setting this to False.[0m
[30;1m318 | [0m[35m    use_dashboard_https[0m
[30;1m319 | [0m[35m        When public IP address is used for dashboard, we'll enable HTTPS + auth by default.[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m310 | [0m[35m        Boolean value that determines if the Python client connects to the[0m
[30;1m311 | [0m[35m        Dask scheduler using the scheduler machine's public IP address. The[0m
[30;1m312 | [0m[35m        default behaviour when set to True is to connect to the scheduler[0m
[30;1m313 | [0m[35m        using its public IP address, which means traffic will be routed over[0m
[30;1m314 | [0m[35m        the public internet. When set to False, traffic will be routed over[0m
[30;1m315 | [0m[35m        the local network the scheduler lives in, so make sure the scheduler[0m
[30;1m316 | [0m[35m        private IP address is routable from where this function call is made[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m        Default: "2 minutes", or ``idle_timeout`` if there's a non-default idle timeout[0m
[30;1m309 | [0m[35m    use_scheduler_public_ip[0m
[30;1m310 | [0m[35m        Boolean value that determines if the Python client connects to the[0m
[30;1m311 | [0m[35m        Dask scheduler using the scheduler machine's public IP address. The[0m
[30;1m312 | [0m[35m        default behaviour when set to True is to connect to the scheduler[0m
[30;1m313 | [0m[35m        using its public IP address, which means traffic will be routed over[0m
[30;1m314 | [0m[35m        the public internet. When set to False, traffic will be routed over[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m305 | [0m[35m        When ``shutdown_on_close`` is ``False`` this is disabled,[0m
[30;1m306 | [0m[35m        since ``shutdown_on_close=False`` usually means you want to keep cluster up[0m
[30;1m307 | [0m[35m        after disconnecting so you can later connect a new client.[0m
[30;1m308 | [0m[35m        Default: "2 minutes", or ``idle_timeout`` if there's a non-default idle timeout[0m
[30;1m309 | [0m[35m    use_scheduler_public_ip[0m
[30;1m310 | [0m[35m        Boolean value that determines if the Python client connects to the[0m
[30;1m311 | [0m[35m        Dask scheduler using the scheduler machine's public IP address. The[0m
[30;1m312 | [0m[35m        default behaviour when set to True is to connect to the scheduler[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport logging[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mimport re[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mimport traceback as tb[0m
[30;1m12 | [0m[35mimport uuid[0m
[30;1m13 | [0m[35mimport warnings[0m
[30;1m14 | [0m[35mimport weakref[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m                    if not expiration:[0m
[30;1m71 | [0m[35m                        duration = datetime.timedelta([0m
[30;1m72 | [0m[35m                            seconds=parse_timedelta([0m
[30;1m73 | [0m[35m                                dask.config.get("coiled.aws-sts-expiration-duration-if-unknown", "6m[0m
[30;1m74 | [0m[35m                            )[0m
[30;1m75 | [0m[35m                        )[0m
[30;1m76 | [0m[35m                        expiration = datetime.datetime.now(tz=datetime.timezone.utc) + duration[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m                    AccessKeyId=credentials.get("AccessKeyId", ""),[0m
[30;1m48 | [0m[35m                    SecretAccessKey=credentials.get("SecretAccessKey", ""),[0m
[30;1m49 | [0m[35m                    SessionToken=credentials.get("SessionToken"),[0m
[30;1m50 | [0m[35m                    Expiration=credentials.get("Expiration"),[0m
[30;1m51 | [0m[35m                    DefaultRegion=session.region_name,[0m
[30;1m52 | [0m[35m                )[0m
[30;1m53 | [0m[35m            except botocore.exceptions.ClientError as e:[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m                token_creds = AWSSessionCredentials([0m
[30;1m47 | [0m[35m                    AccessKeyId=credentials.get("AccessKeyId", ""),[0m
[30;1m48 | [0m[35m                    SecretAccessKey=credentials.get("SecretAccessKey", ""),[0m
[30;1m49 | [0m[35m                    SessionToken=credentials.get("SessionToken"),[0m
[30;1m50 | [0m[35m                    Expiration=credentials.get("Expiration"),[0m
[30;1m51 | [0m[35m                    DefaultRegion=session.region_name,[0m
[30;1m52 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m                credentials = credentials["Credentials"][0m
[30;1m46 | [0m[35m                token_creds = AWSSessionCredentials([0m
[30;1m47 | [0m[35m                    AccessKeyId=credentials.get("AccessKeyId", ""),[0m
[30;1m48 | [0m[35m                    SecretAccessKey=credentials.get("SecretAccessKey", ""),[0m
[30;1m49 | [0m[35m                    SessionToken=credentials.get("SessionToken"),[0m
[30;1m50 | [0m[35m                    Expiration=credentials.get("Expiration"),[0m
[30;1m51 | [0m[35m                    DefaultRegion=session.region_name,[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m                credentials = credentials["Credentials"][0m
[30;1m46 | [0m[35m                token_creds = AWSSessionCredentials([0m
[30;1m47 | [0m[35m                    AccessKeyId=credentials.get("AccessKeyId", ""),[0m
[30;1m48 | [0m[35m                    SecretAccessKey=credentials.get("SecretAccessKey", ""),[0m
[30;1m49 | [0m[35m                    SessionToken=credentials.get("SessionToken"),[0m
[30;1m50 | [0m[35m                    Expiration=credentials.get("Expiration"),[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m        # rather than NoCredentialsError[0m
[30;1m102 | [0m[35m        if "Could not connect to the endpoint URL" in str(e):[0m
[30;1m103 | [0m[35m            pass[0m
[30;1m104 | [0m[35m        elif "Connect timeout on endpoint URL" in str(e):[0m
[30;1m105 | [0m[35m            pass[0m
[30;1m106 | [0m[35m        else:[0m
[30;1m107 | [0m[35m            if log:[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m    if "dask" in deps:[0m
[30;1m210 | [0m[35m        # These are included with `dask` on conda-forge[0m
[30;1m211 | [0m[35m        deps = [d for d in deps if d not in ("pandas", "bokeh", "pyarrow")][0m
[30;1m212 | [0m[35m    deps = [PYPI_TO_CONDA.get(p, p) if p not in ("dask", "matplotlib") else p for p in deps][0m
[30;1m213 | [0m[35m    return deps[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m```bash[0m
[30;1m233 | [0m[35mcurl -L -O \\[0m
[30;1m234 | [0m[35m    "https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-$(uname)-$(uname -[0m
[30;1m235 | [0m[35mbash Miniforge3-$(uname)-$(uname -m).sh[0m
[30;1m236 | [0m[35mconda create -n coiled -c conda-forge -y coiled[0m
[30;1m237 | [0m[35mconda activate coiled[0m
[30;1m238 | [0m[35mcoiled quickstart[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m```bash[0m
[30;1m233 | [0m[35mcurl -L -O \\[0m
[30;1m234 | [0m[35m    "https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-$(uname)-$(uname -[0m
[30;1m235 | [0m[35mbash Miniforge3-$(uname)-$(uname -m).sh[0m
[30;1m236 | [0m[35mconda create -n coiled -c conda-forge -y coiled[0m
[30;1m237 | [0m[35mconda activate coiled[0m
[30;1m238 | [0m[35mcoiled quickstart[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m229 | [0m[35mPython installation. One easy option is to make a new environment[0m
[30;1m230 | [0m[35mwith conda:[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m```bash[0m
[30;1m233 | [0m[35mcurl -L -O \\[0m
[30;1m234 | [0m[35m    "https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-$(uname)-$(uname -[0m
[30;1m235 | [0m[35mbash Miniforge3-$(uname)-$(uname -m).sh[0m
[30;1m236 | [0m[35mconda create -n coiled -c conda-forge -y coiled[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport pathlib[0m
[30;1m6 | [0m[35mimport subprocess[0m
[30;1m7 | [0m[35mimport sys[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport importlib_metadata[0m
[30;1m11 | [0m[35mimport rich[0m
[30;1m12 | [0m[35mimport rich.panel[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m640 | [0m[35mdef get_netrc_auth(url: str, raise_errors=False) -> tuple[str | None, str | None] | None:[0m
[30;1m641 | [0m[35m    """Returns the Requests tuple auth for a given url from netrc."""[0m
[30;1m642 | [0m[35m[0m
[30;1m643 | [0m[35m    netrc_file = os.environ.get("NETRC")[0m
[30;1m644 | [0m[35m    if netrc_file is not None:[0m
[30;1m645 | [0m[35m        netrc_locations = (netrc_file,)[0m
[30;1m646 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m577 | [0m[35mdef get_mamba_auth(netloc: str) -> tuple[str, str] | None:[0m
[30;1m578 | [0m[35m    """Returns the Requests tuple auth for a given domain from the mamba auth file."""[0m
[30;1m579 | [0m[35m    # mamba uses the domain as the key[0m
[30;1m580 | [0m[35m    return get_mamba_auth_dict().get(netloc, None)[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m[0m
[30;1m583 | [0m[35m@functools.lru_cache[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m568 | [0m[35m                if auth_type == "CondaToken" or auth_type == "BearerToken":[0m
[30;1m569 | [0m[35m                    domain_auth[domain] = (AUTH_BEARER_USERNAME, auth["token"])[0m
[30;1m570 | [0m[35m                elif auth_type == "BasicHTTPAuthentication":[0m
[30;1m571 | [0m[35m                    domain_auth[domain] = (auth.get("user") or "", auth.get("password") or "")[0m
[30;1m572 | [0m[35m                else:[0m
[30;1m573 | [0m[35m                    logger.debug(f"Encountered unknown mamba auth type {auth_type} for domain {domai[0m
[30;1m574 | [0m[35m    return domain_auth[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m568 | [0m[35m                if auth_type == "CondaToken" or auth_type == "BearerToken":[0m
[30;1m569 | [0m[35m                    domain_auth[domain] = (AUTH_BEARER_USERNAME, auth["token"])[0m
[30;1m570 | [0m[35m                elif auth_type == "BasicHTTPAuthentication":[0m
[30;1m571 | [0m[35m                    domain_auth[domain] = (auth.get("user") or "", auth.get("password") or "")[0m
[30;1m572 | [0m[35m                else:[0m
[30;1m573 | [0m[35m                    logger.debug(f"Encountered unknown mamba auth type {auth_type} for domain {domai[0m
[30;1m574 | [0m[35m    return domain_auth[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m564 | [0m[35m        with auth_file.open("r") as f:[0m
[30;1m565 | [0m[35m            auth_data = json.load(f)[0m
[30;1m566 | [0m[35m            for domain, auth in auth_data.items():[0m
[30;1m567 | [0m[35m                auth_type = auth.get("type")[0m
[30;1m568 | [0m[35m                if auth_type == "CondaToken" or auth_type == "BearerToken":[0m
[30;1m569 | [0m[35m                    domain_auth[domain] = (AUTH_BEARER_USERNAME, auth["token"])[0m
[30;1m570 | [0m[35m                elif auth_type == "BasicHTTPAuthentication":[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m547 | [0m[35m    extra_index_urls.extend(os.environ.get("PIP_EXTRA_INDEX_URL", "").split())[0m
[30;1m548 | [0m[35m    extra_index_urls.extend(os.environ.get("UV_EXTRA_INDEX_URL", "").split())[0m
[30;1m549 | [0m[35m    index_url = os.environ.get("PIP_INDEX_URL", os.environ.get("PIP_PYPI_URL", index_url))[0m
[30;1m550 | [0m[35m    index_url = os.environ.get("UV_INDEX_URL", index_url)[0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m    extra_index_urls = sorted(set(extra_index_urls) - {index_url})[0m
[30;1m553 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m    # See https://pip.pypa.io/en/stable/topics/configuration/#precedence-override-order[0m
[30;1m547 | [0m[35m    extra_index_urls.extend(os.environ.get("PIP_EXTRA_INDEX_URL", "").split())[0m
[30;1m548 | [0m[35m    extra_index_urls.extend(os.environ.get("UV_EXTRA_INDEX_URL", "").split())[0m
[30;1m549 | [0m[35m    index_url = os.environ.get("PIP_INDEX_URL", os.environ.get("PIP_PYPI_URL", index_url))[0m
[30;1m550 | [0m[35m    index_url = os.environ.get("UV_INDEX_URL", index_url)[0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m    extra_index_urls = sorted(set(extra_index_urls) - {index_url})[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m    # See https://pip.pypa.io/en/stable/topics/configuration/#precedence-override-order[0m
[30;1m547 | [0m[35m    extra_index_urls.extend(os.environ.get("PIP_EXTRA_INDEX_URL", "").split())[0m
[30;1m548 | [0m[35m    extra_index_urls.extend(os.environ.get("UV_EXTRA_INDEX_URL", "").split())[0m
[30;1m549 | [0m[35m    index_url = os.environ.get("PIP_INDEX_URL", os.environ.get("PIP_PYPI_URL", index_url))[0m
[30;1m550 | [0m[35m    index_url = os.environ.get("UV_INDEX_URL", index_url)[0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m    extra_index_urls = sorted(set(extra_index_urls) - {index_url})[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m545 | [0m[35m    # Environment variables take precedence over config files[0m
[30;1m546 | [0m[35m    # See https://pip.pypa.io/en/stable/topics/configuration/#precedence-override-order[0m
[30;1m547 | [0m[35m    extra_index_urls.extend(os.environ.get("PIP_EXTRA_INDEX_URL", "").split())[0m
[30;1m548 | [0m[35m    extra_index_urls.extend(os.environ.get("UV_EXTRA_INDEX_URL", "").split())[0m
[30;1m549 | [0m[35m    index_url = os.environ.get("PIP_INDEX_URL", os.environ.get("PIP_PYPI_URL", index_url))[0m
[30;1m550 | [0m[35m    index_url = os.environ.get("UV_INDEX_URL", index_url)[0m
[30;1m551 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m544 | [0m[35m[0m
[30;1m545 | [0m[35m    # Environment variables take precedence over config files[0m
[30;1m546 | [0m[35m    # See https://pip.pypa.io/en/stable/topics/configuration/#precedence-override-order[0m
[30;1m547 | [0m[35m    extra_index_urls.extend(os.environ.get("PIP_EXTRA_INDEX_URL", "").split())[0m
[30;1m548 | [0m[35m    extra_index_urls.extend(os.environ.get("UV_EXTRA_INDEX_URL", "").split())[0m
[30;1m549 | [0m[35m    index_url = os.environ.get("PIP_INDEX_URL", os.environ.get("PIP_PYPI_URL", index_url))[0m
[30;1m550 | [0m[35m    index_url = os.environ.get("UV_INDEX_URL", index_url)[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m540 | [0m[35m    # pixi[0m
[30;1m541 | [0m[35m    pixi_conf = {**tool_dict.get("pixi", {}), **_load_toml("pixi.toml")}.get("pypi-options", {})[0m
[30;1m542 | [0m[35m    index_url = pixi_conf.get("index-url") or index_url[0m
[30;1m543 | [0m[35m    extra_index_urls.extend(pixi_conf.get("extra-index-urls", []))[0m
[30;1m544 | [0m[35m[0m
[30;1m545 | [0m[35m    # Environment variables take precedence over config files[0m
[30;1m546 | [0m[35m    # See https://pip.pypa.io/en/stable/topics/configuration/#precedence-override-order[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m539 | [0m[35m[0m
[30;1m540 | [0m[35m    # pixi[0m
[30;1m541 | [0m[35m    pixi_conf = {**tool_dict.get("pixi", {}), **_load_toml("pixi.toml")}.get("pypi-options", {})[0m
[30;1m542 | [0m[35m    index_url = pixi_conf.get("index-url") or index_url[0m
[30;1m543 | [0m[35m    extra_index_urls.extend(pixi_conf.get("extra-index-urls", []))[0m
[30;1m544 | [0m[35m[0m
[30;1m545 | [0m[35m    # Environment variables take precedence over config files[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m538 | [0m[35m    extra_index_urls.extend(uv_extra_index_urls)[0m
[30;1m539 | [0m[35m[0m
[30;1m540 | [0m[35m    # pixi[0m
[30;1m541 | [0m[35m    pixi_conf = {**tool_dict.get("pixi", {}), **_load_toml("pixi.toml")}.get("pypi-options", {})[0m
[30;1m542 | [0m[35m    index_url = pixi_conf.get("index-url") or index_url[0m
[30;1m543 | [0m[35m    extra_index_urls.extend(pixi_conf.get("extra-index-urls", []))[0m
[30;1m544 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m538 | [0m[35m    extra_index_urls.extend(uv_extra_index_urls)[0m
[30;1m539 | [0m[35m[0m
[30;1m540 | [0m[35m    # pixi[0m
[30;1m541 | [0m[35m    pixi_conf = {**tool_dict.get("pixi", {}), **_load_toml("pixi.toml")}.get("pypi-options", {})[0m
[30;1m542 | [0m[35m    index_url = pixi_conf.get("index-url") or index_url[0m
[30;1m543 | [0m[35m    extra_index_urls.extend(pixi_conf.get("extra-index-urls", []))[0m
[30;1m544 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m533 | [0m[35m    uv_conf = {**tool_dict.get("uv", {}), **_load_toml("uv.toml")}.get("pip", {})[0m
[30;1m534 | [0m[35m    index_url = uv_conf.get("index-url") or index_url[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m    uv_raw_extras = uv_conf.get("extra-index-url")[0m
[30;1m537 | [0m[35m    uv_extra_index_urls = (uv_raw_extras.split() if isinstance(uv_raw_extras, str) else uv_raw_extra[0m
[30;1m538 | [0m[35m    extra_index_urls.extend(uv_extra_index_urls)[0m
[30;1m539 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m531 | [0m[35m            extra_index_urls.append(source_url)[0m
[30;1m532 | [0m[35m    # uv[0m
[30;1m533 | [0m[35m    uv_conf = {**tool_dict.get("uv", {}), **_load_toml("uv.toml")}.get("pip", {})[0m
[30;1m534 | [0m[35m    index_url = uv_conf.get("index-url") or index_url[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m    uv_raw_extras = uv_conf.get("extra-index-url")[0m
[30;1m537 | [0m[35m    uv_extra_index_urls = (uv_raw_extras.split() if isinstance(uv_raw_extras, str) else uv_raw_extra[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m530 | [0m[35m        if source_url := source.get("url"):[0m
[30;1m531 | [0m[35m            extra_index_urls.append(source_url)[0m
[30;1m532 | [0m[35m    # uv[0m
[30;1m533 | [0m[35m    uv_conf = {**tool_dict.get("uv", {}), **_load_toml("uv.toml")}.get("pip", {})[0m
[30;1m534 | [0m[35m    index_url = uv_conf.get("index-url") or index_url[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m    uv_raw_extras = uv_conf.get("extra-index-url")[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m530 | [0m[35m        if source_url := source.get("url"):[0m
[30;1m531 | [0m[35m            extra_index_urls.append(source_url)[0m
[30;1m532 | [0m[35m    # uv[0m
[30;1m533 | [0m[35m    uv_conf = {**tool_dict.get("uv", {}), **_load_toml("uv.toml")}.get("pip", {})[0m
[30;1m534 | [0m[35m    index_url = uv_conf.get("index-url") or index_url[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m    uv_raw_extras = uv_conf.get("extra-index-url")[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m527 | [0m[35m    # poetry[0m
[30;1m528 | [0m[35m    poetry_sources = tool_dict.get("poetry", {}).get("source", [])[0m
[30;1m529 | [0m[35m    for source in poetry_sources:[0m
[30;1m530 | [0m[35m        if source_url := source.get("url"):[0m
[30;1m531 | [0m[35m            extra_index_urls.append(source_url)[0m
[30;1m532 | [0m[35m    # uv[0m
[30;1m533 | [0m[35m    uv_conf = {**tool_dict.get("uv", {}), **_load_toml("uv.toml")}.get("pip", {})[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m525 | [0m[35m    tool_dict = pyproject.get("tool", {})[0m
[30;1m526 | [0m[35m[0m
[30;1m527 | [0m[35m    # poetry[0m
[30;1m528 | [0m[35m    poetry_sources = tool_dict.get("poetry", {}).get("source", [])[0m
[30;1m529 | [0m[35m    for source in poetry_sources:[0m
[30;1m530 | [0m[35m        if source_url := source.get("url"):[0m
[30;1m531 | [0m[35m            extra_index_urls.append(source_url)[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m525 | [0m[35m    tool_dict = pyproject.get("tool", {})[0m
[30;1m526 | [0m[35m[0m
[30;1m527 | [0m[35m    # poetry[0m
[30;1m528 | [0m[35m    poetry_sources = tool_dict.get("poetry", {}).get("source", [])[0m
[30;1m529 | [0m[35m    for source in poetry_sources:[0m
[30;1m530 | [0m[35m        if source_url := source.get("url"):[0m
[30;1m531 | [0m[35m            extra_index_urls.append(source_url)[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    # Load pyproject.toml to check other tool configs[0m
[30;1m524 | [0m[35m    pyproject = _load_toml("pyproject.toml")[0m
[30;1m525 | [0m[35m    tool_dict = pyproject.get("tool", {})[0m
[30;1m526 | [0m[35m[0m
[30;1m527 | [0m[35m    # poetry[0m
[30;1m528 | [0m[35m    poetry_sources = tool_dict.get("poetry", {}).get("source", [])[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m424 | [0m[35m                        version=pkg["version"],[0m
[30;1m425 | [0m[35m                        src=pkg["wheel_target"],[0m
[30;1m426 | [0m[35m                    )[0m
[30;1m427 | [0m[35m                    wheel_timeout = parse_timedelta(dask.config.get("coiled.wheel-creation-timeout",[0m
[30;1m428 | [0m[35m                    try:[0m
[30;1m429 | [0m[35m                        result = await asyncio.wait_for(fut, timeout=wheel_timeout)[0m
[30;1m430 | [0m[35m                    except TimeoutError:[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m387 | [0m[35m                    version=pkg["version"],[0m
[30;1m388 | [0m[35m                    src=pkg["wheel_target"],[0m
[30;1m389 | [0m[35m                )[0m
[30;1m390 | [0m[35m                wheel_timeout = parse_timedelta(dask.config.get("coiled.wheel-creation-timeout", "1m[0m
[30;1m391 | [0m[35m                try:[0m
[30;1m392 | [0m[35m                    result = await asyncio.wait_for(fut, timeout=wheel_timeout)[0m
[30;1m393 | [0m[35m                except TimeoutError:[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m) -> Tuple[List[PackageInfo], List[PackageInfo]]:[0m
[30;1m83 | [0m[35m    return partition([0m
[30;1m84 | [0m[35m        packages,[0m
[30;1m85 | [0m[35m        lambda pkg: priorities.get((pkg["name"], pkg["source"])) == PackageLevelEnum.IGNORE,[0m
[30;1m86 | [0m[35m    )[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m137 | [0m[35m    # These locks are set up such that[0m
[30;1m138 | [0m[35m    # Threads: Block on each other and check if another thread already built the wheel[0m
[30;1m139 | [0m[35m    # Processes: Block on each other, but will not reuse a wheel created by another[0m
[30;1m140 | [0m[35m    # `pip wheel` is never run on the same package at the same time[0m
[30;1m141 | [0m[35m    LOCK_PATH.mkdir(parents=True, exist_ok=True)  # ensure lockfile directory exists[0m
[30;1m142 | [0m[35m    package_lock, thread_lock, tmpdir = WHEEL_BUILD_LOCKS.setdefault([0m
[30;1m143 | [0m[35m        pkg_name,[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m497 | [0m[35m    index_url = DEFAULT_PYPI_URL[0m
[30;1m498 | [0m[35m    extra_index_urls = [][0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m    # Check pip config first[0m
[30;1m501 | [0m[35m    try:[0m
[30;1m502 | [0m[35m        config_output = subprocess.check_output([0m
[30;1m503 | [0m[35m            [[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m473 | [0m[35m    filename = path.name[0m
[30;1m474 | [0m[35m    dir_path = safe_path_resolve(path.parent)[0m
[30;1m475 | [0m[35m    toml_dict = {}[0m
[30;1m476 | [0m[35m    # Walk up the directory tree to find the first toml file (up to 10 levels above)[0m
[30;1m477 | [0m[35m    for _ in range(10):[0m
[30;1m478 | [0m[35m        path = dir_path / filename[0m
[30;1m479 | [0m[35m        if not path.exists():[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m446 | [0m[35m[0m
[30;1m447 | [0m[35m@track_context[0m
[30;1m448 | [0m[35masync def check_pip_happy(progress: Progress | None = None) -> Dict[str, List[str]]:[0m
[30;1m449 | [0m[35m    with simple_progress("Running pip check", progress=progress):[0m
[30;1m450 | [0m[35m        proc = await create_subprocess_exec([0m
[30;1m451 | [0m[35m            executable,[0m
[30;1m452 | [0m[35m            "-m",[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m432 | [0m[35m                            f"Creating wheel for '{pkg['name']}' package timed out after {wheel_time[0m
[30;1m433 | [0m[35m                            "Please retry (this often works), or if you want to increase timeout you[0m
[30;1m434 | [0m[35m                            "  coiled config set coiled.wheel-creation-timeout 2m\n"[0m
[30;1m435 | [0m[35m                            "(or another timeout value)."[0m
[30;1m436 | [0m[35m                        ) from None[0m
[30;1m437 | [0m[35m                    finalized_packages.append(result)[0m
[30;1m438 | [0m[35m    return finalized_packages[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m430 | [0m[35m                    except TimeoutError:[0m
[30;1m431 | [0m[35m                        raise TimeoutError([0m
[30;1m432 | [0m[35m                            f"Creating wheel for '{pkg['name']}' package timed out after {wheel_time[0m
[30;1m433 | [0m[35m                            "Please retry (this often works), or if you want to increase timeout you[0m
[30;1m434 | [0m[35m                            "  coiled config set coiled.wheel-creation-timeout 2m\n"[0m
[30;1m435 | [0m[35m                            "(or another timeout value)."[0m
[30;1m436 | [0m[35m                        ) from None[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m395 | [0m[35m                        f"Creating wheel for '{pkg['name']}' package timed out after {wheel_timeout}[0m
[30;1m396 | [0m[35m                        "Please retry (this often works), or if you want to increase timeout you can[0m
[30;1m397 | [0m[35m                        "  coiled config set coiled.wheel-creation-timeout 2m\n"[0m
[30;1m398 | [0m[35m                        "(or another timeout value)."[0m
[30;1m399 | [0m[35m                    ) from None[0m
[30;1m400 | [0m[35m                finalized_packages.append(result)[0m
[30;1m401 | [0m[35m    return finalized_packages[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m393 | [0m[35m                except TimeoutError:[0m
[30;1m394 | [0m[35m                    raise TimeoutError([0m
[30;1m395 | [0m[35m                        f"Creating wheel for '{pkg['name']}' package timed out after {wheel_timeout}[0m
[30;1m396 | [0m[35m                        "Please retry (this often works), or if you want to increase timeout you can[0m
[30;1m397 | [0m[35m                        "  coiled config set coiled.wheel-creation-timeout 2m\n"[0m
[30;1m398 | [0m[35m                        "(or another timeout value)."[0m
[30;1m399 | [0m[35m                    ) from None[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m    # These locks are set up such that[0m
[30;1m138 | [0m[35m    # Threads: Block on each other and check if another thread already built the wheel[0m
[30;1m139 | [0m[35m    # Processes: Block on each other, but will not reuse a wheel created by another[0m
[30;1m140 | [0m[35m    # `pip wheel` is never run on the same package at the same time[0m
[30;1m141 | [0m[35m    LOCK_PATH.mkdir(parents=True, exist_ok=True)  # ensure lockfile directory exists[0m
[30;1m142 | [0m[35m    package_lock, thread_lock, tmpdir = WHEEL_BUILD_LOCKS.setdefault([0m
[30;1m143 | [0m[35m        pkg_name,[0m
[30;1m144 | [0m[35m        ([0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m    # create_subprocess_exec is broken with IPython on Windows,[0m
[30;1m71 | [0m[35m    # because it uses the wrong event loop[0m
[30;1m72 | [0m[35m    loop = asyncio.get_running_loop()[0m
[30;1m73 | [0m[35m    env = {**os.environ, **(extra_env or {})}[0m
[30;1m74 | [0m[35m    result = loop.run_in_executor([0m
[30;1m75 | [0m[35m        None, lambda: subprocess.run([program, *args], stdout=stdout, stderr=stderr, close_fds=True,[0m
[30;1m76 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                    ):[0m
[30;1m142 | [0m[35m                        return True[0m
[30;1m143 | [0m[35m                    elif ([0m
[30;1m144 | [0m[35m                        worker.get("current_state", {}).get("state")[0m
[30;1m145 | [0m[35m                        and worker["current_state"]["state"] in worker_attrs_to_match[0m
[30;1m146 | [0m[35m                    ):[0m
[30;1m147 | [0m[35m                        return True[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                    ):[0m
[30;1m142 | [0m[35m                        return True[0m
[30;1m143 | [0m[35m                    elif ([0m
[30;1m144 | [0m[35m                        worker.get("current_state", {}).get("state")[0m
[30;1m145 | [0m[35m                        and worker["current_state"]["state"] in worker_attrs_to_match[0m
[30;1m146 | [0m[35m                    ):[0m
[30;1m147 | [0m[35m                        return True[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                    if worker.get("name") and worker["name"] in worker_attrs_to_match:[0m
[30;1m137 | [0m[35m                        return True[0m
[30;1m138 | [0m[35m                    elif ([0m
[30;1m139 | [0m[35m                        worker.get("instance", {}).get("private_ip_address")[0m
[30;1m140 | [0m[35m                        and worker["instance"]["private_ip_address"] in worker_attrs_to_match[0m
[30;1m141 | [0m[35m                    ):[0m
[30;1m142 | [0m[35m                        return True[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                    if worker.get("name") and worker["name"] in worker_attrs_to_match:[0m
[30;1m137 | [0m[35m                        return True[0m
[30;1m138 | [0m[35m                    elif ([0m
[30;1m139 | [0m[35m                        worker.get("instance", {}).get("private_ip_address")[0m
[30;1m140 | [0m[35m                        and worker["instance"]["private_ip_address"] in worker_attrs_to_match[0m
[30;1m141 | [0m[35m                    ):[0m
[30;1m142 | [0m[35m                        return True[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m                    if idx == 0:[0m
[30;1m134 | [0m[35m                        return True[0m
[30;1m135 | [0m[35m                else:[0m
[30;1m136 | [0m[35m                    if worker.get("name") and worker["name"] in worker_attrs_to_match:[0m
[30;1m137 | [0m[35m                        return True[0m
[30;1m138 | [0m[35m                    elif ([0m
[30;1m139 | [0m[35m                        worker.get("instance", {}).get("private_ip_address")[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m            stream_names = [][0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m            if not group_name:[0m
[30;1m166 | [0m[35m                raise click.ClickException("Unable to find CloudWatch Log Group for this cluster.")[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m            if scheduler:[0m
[30;1m169 | [0m[35m                stream_names.append(log_info["scheduler_stream"])[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35m                cluster_id = None[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m        if not cluster_id:[0m
[30;1m117 | [0m[35m            raise click.ClickException(f"Unable to find cluster `{cluster}`")[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        cluster_info = cloud.cluster_details(cluster_id)[0m
[30;1m120 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m                if clusters:[0m
[30;1m97 | [0m[35m                    recent_cluster = clusters[-1][0m
[30;1m98 | [0m[35m                else:[0m
[30;1m99 | [0m[35m                    raise click.ClickException(f"Unable to find cluster with name '{cluster}'")[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m                if follow and recent_cluster["current_state"]["state"] in ([0m
[30;1m102 | [0m[35m                    "stopped",[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m@click.option([0m
[30;1m46 | [0m[35m    "--since",[0m
[30;1m47 | [0m[35m    default=None,[0m
[30;1m48 | [0m[35m    help="For follow, uses `aws logs tail` default (10m), otherwise defaults to start time of cluste[0m
[30;1m49 | [0m[35m)[0m
[30;1m50 | [0m[35m@click.option([0m
[30;1m51 | [0m[35m    "--format",[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m)[0m
[30;1m30 | [0m[35m@click.option([0m
[30;1m31 | [0m[35m    "--workers",[0m
[30;1m32 | [0m[35m    help="Get worker logs ('any', 'all', or comma-delimited list of names, states, or internal IP ad[0m
[30;1m33 | [0m[35m)[0m
[30;1m34 | [0m[35m@click.option([0m
[30;1m35 | [0m[35m    "--follow",[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35mdef remove_ssh_access(address: str, key: str):[0m
[30;1m218 | [0m[35m    if dask.config.get("coiled.use_ssh_agent", False):[0m
[30;1m219 | [0m[35m        add_key_to_agent(address, key, delete=True)[0m
[30;1m220 | [0m[35m    else:[0m
[30;1m221 | [0m[35m        remove_ssh_key_from_config(address)[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35mdef add_ssh_access(address: str, key: str, t=None):[0m
[30;1m211 | [0m[35m    if dask.config.get("coiled.use_ssh_agent", False):[0m
[30;1m212 | [0m[35m        add_key_to_agent(address, key, t)[0m
[30;1m213 | [0m[35m    else:[0m
[30;1m214 | [0m[35m        add_ssh_identity_to_config(address, key)[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m.hostname[0m
[30;1m311 | [0m[35m        if by_ip:[0m
[30;1m312 | [0m[35m            scheduler_address = ssh_info["scheduler_public_address"][0m
[30;1m313 | [0m[35m        else:[0m
[30;1m314 | [0m[35m            scheduler_address = ssh_info["scheduler_hostname"] or ssh_info["scheduler_public_address[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m    if add_key:[0m
[30;1m317 | [0m[35m        # just add the key, maybe you want to use rsync or something like that[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m.hostname[0m
[30;1m262 | [0m[35m    "--by-ip",[0m
[30;1m263 | [0m[35m    default=False,[0m
[30;1m264 | [0m[35m    is_flag=True,[0m
[30;1m265 | [0m[35m    help="Use public IP address of scheduler directly, not using DNS hostname",[0m
[30;1m266 | [0m[35m)[0m
[30;1m267 | [0m[35m@click.option([0m
[30;1m268 | [0m[35m    "--worker",[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m.hostname[0m
[30;1m256 | [0m[35m    "--private",[0m
[30;1m257 | [0m[35m    default=False,[0m
[30;1m258 | [0m[35m    is_flag=True,[0m
[30;1m259 | [0m[35m    help="Use private IP address of scheduler (default is DNS hostname for public IP)",[0m
[30;1m260 | [0m[35m)[0m
[30;1m261 | [0m[35m@click.option([0m
[30;1m262 | [0m[35m    "--by-ip",[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # Default container name is parent dir (tmp) + service name (dask) + instance number (1).[0m
[30;1m349 | [0m[35m        # If we need to make this more flexible in the future, name could be returned by cloud.get_s[0m
[30;1m350 | [0m[35m        # for now we don't need that flexibility and it's okay if SSH CLI requires client update som[0m
[30;1m351 | [0m[35m        command = f"docker exec -it tmp-dask-1 {command or 'bash'}" if dask else command[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m        open_ssh([0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m227 | [0m[35m        ssh_target_label = f"worker at {jump_to_address}"[0m
[30;1m228 | [0m[35m    else:[0m
[30;1m229 | [0m[35m        ssh_target = [f"ubuntu@{address}"][0m
[30;1m230 | [0m[35m        ssh_target_label = f"scheduler at {address}"[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m    ssh_path = get_ssh_path()[0m
[30;1m233 | [0m[35m    if not ssh_path:[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m224 | [0m[35mdef ssh_shell(address: str, jump_to_address: Optional[str] = None, host_command: Optional[str] = Non[0m
[30;1m225 | [0m[35m    if jump_to_address:[0m
[30;1m226 | [0m[35m        ssh_target = ["-J", f"ubuntu@{address}", f"ubuntu@{jump_to_address}"][0m
[30;1m227 | [0m[35m        ssh_target_label = f"worker at {jump_to_address}"[0m
[30;1m228 | [0m[35m    else:[0m
[30;1m229 | [0m[35m        ssh_target = [f"ubuntu@{address}"][0m
[30;1m230 | [0m[35m        ssh_target_label = f"scheduler at {address}"[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m172 | [0m[35m            ...[0m
[30;1m173 | [0m[35m    except Exception as e:[0m
[30;1m174 | [0m[35m        raise coiled.exceptions.CoiledException([0m
[30;1m175 | [0m[35m            "Unable to update your SSH config file to include the Coiled-specific SSH config because[0m
[30;1m176 | [0m[35m            f"  {e}\n\n"[0m
[30;1m177 | [0m[35m            "You can run\n"[0m
[30;1m178 | [0m[35m            "  coiled config set coiled.use_ssh_agent True\n"[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m80 | [0m[35m        # ssh needs file permissions to be set[0m
[30;1m81 | [0m[35m        os.chmod(key_path, mode=0o600)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        cmd = [ssh_add_path][0m
[30;1m84 | [0m[35m        if delete:[0m
[30;1m85 | [0m[35m            cmd.append("-d")[0m
[30;1m86 | [0m[35m        if t:[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # Default container name is parent dir (tmp) + service name (dask) + instance number (1).[0m
[30;1m349 | [0m[35m        # If we need to make this more flexible in the future, name could be returned by cloud.get_s[0m
[30;1m350 | [0m[35m        # for now we don't need that flexibility and it's okay if SSH CLI requires client update som[0m
[30;1m351 | [0m[35m        command = f"docker exec -it tmp-dask-1 {command or 'bash'}" if dask else command[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m        open_ssh([0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m345 | [0m[35m            print("Unable to retrieve SSH key")[0m
[30;1m346 | [0m[35m            return[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # Default container name is parent dir (tmp) + service name (dask) + instance number (1).[0m
[30;1m349 | [0m[35m        # If we need to make this more flexible in the future, name could be returned by cloud.get_s[0m
[30;1m350 | [0m[35m        # for now we don't need that flexibility and it's okay if SSH CLI requires client update som[0m
[30;1m351 | [0m[35m        command = f"docker exec -it tmp-dask-1 {command or 'bash'}" if dask else command[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m342 | [0m[35m            return[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m        if not ssh_info["private_key"]:[0m
[30;1m345 | [0m[35m            print("Unable to retrieve SSH key")[0m
[30;1m346 | [0m[35m            return[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # Default container name is parent dir (tmp) + service name (dask) + instance number (1).[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m337 | [0m[35m        if not scheduler_address:[0m
[30;1m338 | [0m[35m            print([0m
[30;1m339 | [0m[35m                f"[red]Scheduler for {cluster_info['name']} ({cluster_id}) is "[0m
[30;1m340 | [0m[35m                f"[bold]{ssh_info['scheduler_state']}[/bold] and does not currently have an IP addre[0m
[30;1m341 | [0m[35m            )[0m
[30;1m342 | [0m[35m            return[0m
[30;1m343 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m325 | [0m[35m        if not check_ssh_agent():[0m
[30;1m326 | [0m[35m            print("You may get an error, but we'll try SSH anyway...")[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        # open an ssh shell[0m
[30;1m329 | [0m[35m        if ssh_info["scheduler_state"] not in ("starting", "started"):[0m
[30;1m330 | [0m[35m            print([0m
[30;1m331 | [0m[35m                f"[red]Scheduler for {cluster_info['name']} ({cluster_id}) is "[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m    else:[0m
[30;1m325 | [0m[35m        if not check_ssh_agent():[0m
[30;1m326 | [0m[35m            print("You may get an error, but we'll try SSH anyway...")[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        # open an ssh shell[0m
[30;1m329 | [0m[35m        if ssh_info["scheduler_state"] not in ("starting", "started"):[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m314 | [0m[35m            scheduler_address = ssh_info["scheduler_hostname"] or ssh_info["scheduler_public_address[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m    if add_key:[0m
[30;1m317 | [0m[35m        # just add the key, maybe you want to use rsync or something like that[0m
[30;1m318 | [0m[35m        add_ssh_access(scheduler_address, key=ssh_info["private_key"])[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    elif delete_key:[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m279 | [0m[35m    "--delete-key",[0m
[30;1m280 | [0m[35m    default=False,[0m
[30;1m281 | [0m[35m    is_flag=True,[0m
[30;1m282 | [0m[35m    help="Just delete ssh key from local OpenSSH agent",[0m
[30;1m283 | [0m[35m)[0m
[30;1m284 | [0m[35m@click.option([0m
[30;1m285 | [0m[35m    "--dask", default=False, is_flag=True, help="Attach to shell in Dask container rather than shell[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m273 | [0m[35m    "--add-key",[0m
[30;1m274 | [0m[35m    default=False,[0m
[30;1m275 | [0m[35m    is_flag=True,[0m
[30;1m276 | [0m[35m    help="Just add ssh key to local OpenSSH agent, no lifetime/expiration set",[0m
[30;1m277 | [0m[35m)[0m
[30;1m278 | [0m[35m@click.option([0m
[30;1m279 | [0m[35m    "--delete-key",[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35m@click.option([0m
[30;1m268 | [0m[35m    "--worker",[0m
[30;1m269 | [0m[35m    default=None,[0m
[30;1m270 | [0m[35m    help="Connect to worker with specified name or private IP address (default is to connect to sche[0m
[30;1m271 | [0m[35m)[0m
[30;1m272 | [0m[35m@click.option([0m
[30;1m273 | [0m[35m    "--add-key",[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m    "--by-ip",[0m
[30;1m263 | [0m[35m    default=False,[0m
[30;1m264 | [0m[35m    is_flag=True,[0m
[30;1m265 | [0m[35m    help="Use public IP address of scheduler directly, not using DNS hostname",[0m
[30;1m266 | [0m[35m)[0m
[30;1m267 | [0m[35m@click.option([0m
[30;1m268 | [0m[35m    "--worker",[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m256 | [0m[35m    "--private",[0m
[30;1m257 | [0m[35m    default=False,[0m
[30;1m258 | [0m[35m    is_flag=True,[0m
[30;1m259 | [0m[35m    help="Use private IP address of scheduler (default is DNS hostname for public IP)",[0m
[30;1m260 | [0m[35m)[0m
[30;1m261 | [0m[35m@click.option([0m
[30;1m262 | [0m[35m    "--by-ip",[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m236 | [0m[35m    if host_command:[0m
[30;1m237 | [0m[35m        ssh_command.append(host_command)[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    print(f"===Starting SSH session to {ssh_target_label}===")[0m
[30;1m240 | [0m[35m    if host_command:[0m
[30;1m241 | [0m[35m        print(f"> {host_command}")[0m
[30;1m242 | [0m[35m    subprocess.run(ssh_command)[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m    coiled_ssh_dir = Path(os.path.expanduser("~")) / ".coiled" / "ssh"[0m
[30;1m203 | [0m[35m    _delete_coiled_ssh_key_file(coiled_ssh_dir, address)[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m    # Remove identity from Coiled-specific SSH config file[0m
[30;1m206 | [0m[35m    coiled_config_path = os.path.join(coiled_ssh_dir, "coiled-identities")[0m
[30;1m207 | [0m[35m    _remove_host_from_coiled_ssh_config(coiled_config_path, address)[0m
[30;1m208 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35mdef remove_ssh_key_from_config(address: str):[0m
[30;1m201 | [0m[35m    # Remove the SSH key file[0m
[30;1m202 | [0m[35m    coiled_ssh_dir = Path(os.path.expanduser("~")) / ".coiled" / "ssh"[0m
[30;1m203 | [0m[35m    _delete_coiled_ssh_key_file(coiled_ssh_dir, address)[0m
[30;1m204 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m    coiled_config_path = os.path.join(coiled_ssh_dir, "coiled-identities")[0m
[30;1m194 | [0m[35m    _add_host_to_coiled_ssh_config(coiled_config_path, address, key_path)[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    # Make sure Coiled-specific SSH config file is included in general SSH config file[0m
[30;1m197 | [0m[35m    _add_coiled_to_ssh_config(coiled_config_path)[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m    coiled_config_path = os.path.join(coiled_ssh_dir, "coiled-identities")[0m
[30;1m194 | [0m[35m    _add_host_to_coiled_ssh_config(coiled_config_path, address, key_path)[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    # Make sure Coiled-specific SSH config file is included in general SSH config file[0m
[30;1m197 | [0m[35m    _add_coiled_to_ssh_config(coiled_config_path)[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m    # Key[0m
[30;1m190 | [0m[35m    key_path = _write_coiled_ssh_key(coiled_ssh_dir, address, key)[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    # Add host to the Coiled-specific SSH config file[0m
[30;1m193 | [0m[35m    coiled_config_path = os.path.join(coiled_ssh_dir, "coiled-identities")[0m
[30;1m194 | [0m[35m    _add_host_to_coiled_ssh_config(coiled_config_path, address, key_path)[0m
[30;1m195 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35mdef add_ssh_identity_to_config(address: str, key: str):[0m
[30;1m185 | [0m[35m    # Make directory for Coiled-specific SSH things (keys and config)[0m
[30;1m186 | [0m[35m    coiled_ssh_dir = Path(os.path.expanduser("~")) / ".coiled" / "ssh"[0m
[30;1m187 | [0m[35m    os.makedirs(coiled_ssh_dir, exist_ok=True)[0m
[30;1m188 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m            f"  {e}\n\n"[0m
[30;1m177 | [0m[35m            "You can run\n"[0m
[30;1m178 | [0m[35m            "  coiled config set coiled.use_ssh_agent True\n"[0m
[30;1m179 | [0m[35m            "to use the SSH agent instead of SSH config for Coiled SSH access,\n"[0m
[30;1m180 | [0m[35m            "or contact support@coiled.io if you'd like help troubleshooting."[0m
[30;1m181 | [0m[35m        ) from None[0m
[30;1m182 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m            f"  {e}\n\n"[0m
[30;1m177 | [0m[35m            "You can run\n"[0m
[30;1m178 | [0m[35m            "  coiled config set coiled.use_ssh_agent True\n"[0m
[30;1m179 | [0m[35m            "to use the SSH agent instead of SSH config for Coiled SSH access,\n"[0m
[30;1m180 | [0m[35m            "or contact support@coiled.io if you'd like help troubleshooting."[0m
[30;1m181 | [0m[35m        ) from None[0m
[30;1m182 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m            f"  {e}\n\n"[0m
[30;1m177 | [0m[35m            "You can run\n"[0m
[30;1m178 | [0m[35m            "  coiled config set coiled.use_ssh_agent True\n"[0m
[30;1m179 | [0m[35m            "to use the SSH agent instead of SSH config for Coiled SSH access,\n"[0m
[30;1m180 | [0m[35m            "or contact support@coiled.io if you'd like help troubleshooting."[0m
[30;1m181 | [0m[35m        ) from None[0m
[30;1m182 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m            ...[0m
[30;1m173 | [0m[35m    except Exception as e:[0m
[30;1m174 | [0m[35m        raise coiled.exceptions.CoiledException([0m
[30;1m175 | [0m[35m            "Unable to update your SSH config file to include the Coiled-specific SSH config because[0m
[30;1m176 | [0m[35m            f"  {e}\n\n"[0m
[30;1m177 | [0m[35m            "You can run\n"[0m
[30;1m178 | [0m[35m            "  coiled config set coiled.use_ssh_agent True\n"[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m            ...[0m
[30;1m173 | [0m[35m    except Exception as e:[0m
[30;1m174 | [0m[35m        raise coiled.exceptions.CoiledException([0m
[30;1m175 | [0m[35m            "Unable to update your SSH config file to include the Coiled-specific SSH config because[0m
[30;1m176 | [0m[35m            f"  {e}\n\n"[0m
[30;1m177 | [0m[35m            "You can run\n"[0m
[30;1m178 | [0m[35m            "  coiled config set coiled.use_ssh_agent True\n"[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    with open(key_path, "w") as f:[0m
[30;1m105 | [0m[35m        f.write(key)[0m
[30;1m106 | [0m[35m    # ssh needs file permissions to be set[0m
[30;1m107 | [0m[35m    os.chmod(key_path, mode=0o600)[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    return key_path[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m        p = subprocess.run(cmd, capture_output=True, text=True)[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m        if p.returncode and p.stderr:[0m
[30;1m94 | [0m[35m            print("An error occurred calling `ssh-add`. You may need to enable the ssh agent.")[0m
[30;1m95 | [0m[35m            print(p.stderr)[0m
[30;1m96 | [0m[35m            return False[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m        with open(key_path, "w") as f:[0m
[30;1m78 | [0m[35m            f.write(key)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        # ssh needs file permissions to be set[0m
[30;1m81 | [0m[35m        os.chmod(key_path, mode=0o600)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        cmd = [ssh_add_path][0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35mdef add_key_to_agent(address: str, key: str, t: Optional[int] = None, delete: bool = False) -> bool:[0m
[30;1m69 | [0m[35m    """Add (or remove) ssh key to ssh agent."""[0m
[30;1m70 | [0m[35m    ssh_add_path = get_ssh_add_path()[0m
[30;1m71 | [0m[35m    if not ssh_add_path:[0m
[30;1m72 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35mdef add_key_to_agent(address: str, key: str, t: Optional[int] = None, delete: bool = False) -> bool:[0m
[30;1m69 | [0m[35m    """Add (or remove) ssh key to ssh agent."""[0m
[30;1m70 | [0m[35m    ssh_add_path = get_ssh_add_path()[0m
[30;1m71 | [0m[35m    if not ssh_add_path:[0m
[30;1m72 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m                    "You can explicitly allow Coiled to use the system SSH agent by adding these lin[0m
[30;1m58 | [0m[35m                    f"beginning of [green]{user_config_path}[/green]:\n\n{DEFAULT_SSH_AGENT_CONFIG}\[0m
[30;1m59 | [0m[35m                )[0m
[30;1m60 | [0m[35m                if Confirm.ask("May Coiled edit your ssh config to add these lines?", default=True):[0m
[30;1m61 | [0m[35m                    with open(user_config_path, "w") as f:[0m
[30;1m62 | [0m[35m                        f.write(f"{DEFAULT_SSH_AGENT_CONFIG}\n\n{user_config}")[0m
[30;1m63 | [0m[35m                    return True[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m            if re.search("IdentityAgent[^\n]+1password", user_config):[0m
[30;1m55 | [0m[35m                print("Coiled cannot add temporary SSH key to [bold]1Password SSH Agent[/bold].")[0m
[30;1m56 | [0m[35m                print([0m
[30;1m57 | [0m[35m                    "You can explicitly allow Coiled to use the system SSH agent by adding these lin[0m
[30;1m58 | [0m[35m                    f"beginning of [green]{user_config_path}[/green]:\n\n{DEFAULT_SSH_AGENT_CONFIG}\[0m
[30;1m59 | [0m[35m                )[0m
[30;1m60 | [0m[35m                if Confirm.ask("May Coiled edit your ssh config to add these lines?", default=True):[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m            if "dask.host" in user_config:[0m
[30;1m53 | [0m[35m                return True[0m
[30;1m54 | [0m[35m            if re.search("IdentityAgent[^\n]+1password", user_config):[0m
[30;1m55 | [0m[35m                print("Coiled cannot add temporary SSH key to [bold]1Password SSH Agent[/bold].")[0m
[30;1m56 | [0m[35m                print([0m
[30;1m57 | [0m[35m                    "You can explicitly allow Coiled to use the system SSH agent by adding these lin[0m
[30;1m58 | [0m[35m                    f"beginning of [green]{user_config_path}[/green]:\n\n{DEFAULT_SSH_AGENT_CONFIG}\[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m            if "dask.host" in user_config:[0m
[30;1m53 | [0m[35m                return True[0m
[30;1m54 | [0m[35m            if re.search("IdentityAgent[^\n]+1password", user_config):[0m
[30;1m55 | [0m[35m                print("Coiled cannot add temporary SSH key to [bold]1Password SSH Agent[/bold].")[0m
[30;1m56 | [0m[35m                print([0m
[30;1m57 | [0m[35m                    "You can explicitly allow Coiled to use the system SSH agent by adding these lin[0m
[30;1m58 | [0m[35m                    f"beginning of [green]{user_config_path}[/green]:\n\n{DEFAULT_SSH_AGENT_CONFIG}\[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35mdef get_ssh_add_path() -> Optional[str]:[0m
[30;1m40 | [0m[35m    ssh_add_path = shutil.which("ssh-add")[0m
[30;1m41 | [0m[35m    if not ssh_add_path:[0m
[30;1m42 | [0m[35m        print("Unable to find `ssh-add`, you may need to install OpenSSH or add it to your paths.")[0m
[30;1m43 | [0m[35m        return None[0m
[30;1m44 | [0m[35m    return ssh_add_path[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35mdef get_ssh_path() -> Optional[str]:[0m
[30;1m32 | [0m[35m    ssh_path = shutil.which("ssh")[0m
[30;1m33 | [0m[35m    if not ssh_path:[0m
[30;1m34 | [0m[35m        print("Unable to find `ssh`, you may need to install OpenSSH or add it to your paths.")[0m
[30;1m35 | [0m[35m        return None[0m
[30;1m36 | [0m[35m    return ssh_path[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mdef open_ssh(address: str, key: str, jump_to_address: Optional[str] = None, host_command: Optional[s[0m
[30;1m24 | [0m[35m    """Open an SSH session, relies on `ssh` and `ssh-add` (agent)."""[0m
[30;1m25 | [0m[35m    if not add_key_to_agent(address, key, t=5):[0m
[30;1m26 | [0m[35m        return[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/analytics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35masync def dask_setup(scheduler):[0m
[30;1m224 | [0m[35m    url = dask.config.get("coiled.server") + "/api/v2/analytics/preload"[0m
[30;1m225 | [0m[35m    with urllib3.PoolManager() as http:[0m
[30;1m226 | [0m[35m        response = http.request("GET", url)[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m    if response.status != 200:[0m
[30;1m229 | [0m[35m        raise Exception("Unable to collect Coiled plugin", response.status)[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/analytics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35masync def dask_setup(scheduler):[0m
[30;1m224 | [0m[35m    url = dask.config.get("coiled.server") + "/api/v2/analytics/preload"[0m
[30;1m225 | [0m[35m    with urllib3.PoolManager() as http:[0m
[30;1m226 | [0m[35m        response = http.request("GET", url)[0m
[30;1m227 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/analytics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    url = dask.config.get("coiled.server") + "/api/v2/analytics/preload"[0m
[30;1m42 | [0m[35m    with urllib3.PoolManager() as http:[0m
[30;1m43 | [0m[35m        response = http.request("GET", url)[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    if response.status != 200:[0m
[30;1m46 | [0m[35m        raise Exception("Unable to collect Coiled plugin", response.status)[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/analytics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m        pass[0m
[30;1m39 | [0m[35m    client = client or get_client()[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    url = dask.config.get("coiled.server") + "/api/v2/analytics/preload"[0m
[30;1m42 | [0m[35m    with urllib3.PoolManager() as http:[0m
[30;1m43 | [0m[35m        response = http.request("GET", url)[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/analytics.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m        You must be a member of this account[0m
[30;1m194 | [0m[35m        Your default account will be used if none is provided[0m
[30;1m195 | [0m[35m    since (optional):[0m
[30;1m196 | [0m[35m        The amount of time to go back in history to list clusters.[0m
[30;1m197 | [0m[35m        Defaults to seven days.  Leave as ``None`` to collect all history.[0m
[30;1m198 | [0m[35m        Accepts any value parseable by dask.utils.parse_timedelta[0m
[30;1m199 | [0m[35m    user (optional):[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/analytics.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m        You must be a member of this account[0m
[30;1m74 | [0m[35m        Your default account will be used if none is provided[0m
[30;1m75 | [0m[35m    since:[0m
[30;1m76 | [0m[35m        The amount of time to go back in history to list clusters.[0m
[30;1m77 | [0m[35m        Defaults to seven days.  Leave as ``None`` to collect all history.[0m
[30;1m78 | [0m[35m        Accepts any value parseable by dask.utils.parse_timedelta[0m
[30;1m79 | [0m[35m    user:[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35masync def client_token_grant_flow(server, browser, workspace=None):[0m
[30;1m31 | [0m[35m    server = server or dask.config.get("coiled.server", COILED_SERVER)[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    token_data = await make_unattached_token(server, label=get_local_user())[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35masync def make_unattached_token(server, label=None) -> dict:[0m
[30;1m24 | [0m[35m    url = server + "/api/v1/api-tokens-no-user/"[0m
[30;1m25 | [0m[35m    async with aiohttp.ClientSession() as session:[0m
[30;1m26 | [0m[35m        async with session.post(url, data={"label": label}) as resp:[0m
[30;1m27 | [0m[35m            return await resp.json()[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m            "frame_index": idx,[0m
[30;1m43 | [0m[35m            "code": item.get("code"),[0m
[30;1m44 | [0m[35m            "relative_line": item.get("relative_line"),[0m
[30;1m45 | [0m[35m            "filename": item.get("filename"),[0m
[30;1m46 | [0m[35m        }[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    if isinstance(item, str):[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m        return {[0m
[30;1m42 | [0m[35m            "frame_index": idx,[0m
[30;1m43 | [0m[35m            "code": item.get("code"),[0m
[30;1m44 | [0m[35m            "relative_line": item.get("relative_line"),[0m
[30;1m45 | [0m[35m            "filename": item.get("filename"),[0m
[30;1m46 | [0m[35m        }[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m    if isinstance(item, dict):[0m
[30;1m41 | [0m[35m        return {[0m
[30;1m42 | [0m[35m            "frame_index": idx,[0m
[30;1m43 | [0m[35m            "code": item.get("code"),[0m
[30;1m44 | [0m[35m            "relative_line": item.get("relative_line"),[0m
[30;1m45 | [0m[35m            "filename": item.get("filename"),[0m
[30;1m46 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m        "stop": t1,[0m
[30;1m27 | [0m[35m        "callstack": callstack(*kwargs["callstack"]) if "callstack" in kwargs else None,[0m
[30;1m28 | [0m[35m    }[0m
[30;1m29 | [0m[35m    if not dask.config.get("coiled.analytics.computation.code.transmit", True):[0m
[30;1m30 | [0m[35m        del data["callstack"][0m
[30;1m31 | [0m[35m    if hasattr(cluster, "add_span"):[0m
[30;1m32 | [0m[35m        cluster.add_span(span_identifier=s, data=data)[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport uuid[0m
[30;1m3 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m4 | [0m[35mfrom typing import Iterable, Optional[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m    for option in reqs_dict["options"]:[0m
[30;1m110 | [0m[35m        raw_pip.append(option["line"])[0m
[30;1m111 | [0m[35m    for req in reqs_dict["requirements"]:[0m
[30;1m112 | [0m[35m        raw_line = req["requirement_line"].get("line")[0m
[30;1m113 | [0m[35m        if req["is_editable"]:[0m
[30;1m114 | [0m[35m            logger.warning(f"Editable requirement {raw_line!r} is not supported and will be ignored"[0m
[30;1m115 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m                continue[0m
[30;1m70 | [0m[35m            dep, specifier = match.groups()[0m
[30;1m71 | [0m[35m            packages.append({[0m
[30;1m72 | [0m[35m                "name": CONDA_TO_PYPI.get(dep, dep),[0m
[30;1m73 | [0m[35m                "source": "conda",[0m
[30;1m74 | [0m[35m                "channel": channel,[0m
[30;1m75 | [0m[35m                "conda_name": dep,[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m            reqs = RequirementsFile.from_file(str(pip), include_nested=True)[0m
[30;1m90 | [0m[35m        except FileNotFoundError:[0m
[30;1m91 | [0m[35m            raise FileNotFoundError([0m
[30;1m92 | [0m[35m                f"Unable to find file '{pip}', please make sure it exists "[0m
[30;1m93 | [0m[35m                "and the path is correct. If you are trying to create a "[0m
[30;1m94 | [0m[35m                "software environment by specifying dependencies, you can "[0m
[30;1m95 | [0m[35m                "do so by passing a list of dependencies. For example:\n"[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/software.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m            conda_data = safe_load(env_file)[0m
[30;1m23 | [0m[35m    except FileNotFoundError:[0m
[30;1m24 | [0m[35m        raise FileNotFoundError([0m
[30;1m25 | [0m[35m            f"Unable to find file '{env_path}', please make sure it exists "[0m
[30;1m26 | [0m[35m            "and the path is correct. If you are trying to create a "[0m
[30;1m27 | [0m[35m            "software environment by specifying dependencies, you can "[0m
[30;1m28 | [0m[35m            "do so by passing a list of dependencies or a dictionary. For example:\n"[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/cwi_log_link.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m        return f"https://{region}.console.aws.amazon.com/cloudwatch/home?region={region}#{QUERY}"[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    editorString = ([0m
[30;1m40 | [0m[35m        f"fields @timestamp, @message\n| sort @timestamp desc\n| filter @logStream like /^{cluster_n[0m
[30;1m41 | [0m[35m    )[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    params = {[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/websockets.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35mclass ConfigureBackendConnector(WebsocketConnector):[0m
[30;1m154 | [0m[35m    async def on_message(self, message_data: Dict) -> None:[0m
[30;1m155 | [0m[35m        if message_data.get("type") != "update_options":[0m
[30;1m156 | [0m[35m            return[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        message = message_data["message"][0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/websockets.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            print(message, file=self.log_output)[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    async def check_error_message(self, message_data: Dict) -> Optional[str]:[0m
[30;1m113 | [0m[35m        if message_data.get("is_error") or message_data.get("raise"):[0m
[30;1m114 | [0m[35m            return message_data["message"][0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    async def on_error(self, message: WSMessage) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/websockets.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            print(message, file=self.log_output)[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    async def check_error_message(self, message_data: Dict) -> Optional[str]:[0m
[30;1m113 | [0m[35m        if message_data.get("is_error") or message_data.get("raise"):[0m
[30;1m114 | [0m[35m            return message_data["message"][0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    async def on_error(self, message: WSMessage) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spark.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m        connection_string = f"sc://{host}:{port}"[0m
[30;1m206 | [0m[35m        # warn because it's unlikely that someone wants to be connecting insecurely[0m
[30;1m207 | [0m[35m        warnings.warn([0m
[30;1m208 | [0m[35m            f"HTTPS is not enabled for this cluster. Attempting to connect to Spark at {connection_s[0m
[30;1m209 | [0m[35m            "without encryption or authentication. This is not recommended and will only work if you[0m
[30;1m210 | [0m[35m            f"opened {port} for ingress.",[0m
[30;1m211 | [0m[35m            stacklevel=1,[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spark.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m158 | [0m[35m        host = worker.scheduler.address.split("//")[1].split(":")[0][0m
[30;1m159 | [0m[35m        spark_master = f"spark://{host}:7077"[0m
[30;1m160 | [0m[35m        print(f"Launching Spark Worker connecting to {spark_master}")[0m
[30;1m161 | [0m[35m        cmd = ([0m
[30;1m162 | [0m[35m            f"spark-class {self.cls} {spark_master} "[0m
[30;1m163 | [0m[35m            f"--cores {cores} "[0m
[30;1m164 | [0m[35m            f"--memory {int(self.worker.memory_manager.memory_limit * self.worker_memory_factor) // [0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spark.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        spark_config_cmd = " ".join(f"--conf {key}={value}" for key, value in spark_config.items())[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m        cmd = ([0m
[30;1m122 | [0m[35m            f"spark-submit --class {self.cls} "[0m
[30;1m123 | [0m[35m            '--name "SparkConnectServer" '[0m
[30;1m124 | [0m[35m            f"--packages org.apache.spark:spark-connect_2.12:{pyspark.__version__}"[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spark.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m        os.environ["PYSPARK_PYTHON"] = sys.executable[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        host = scheduler.address.split("//")[1].split(":")[0][0m
[30;1m67 | [0m[35m        cmd = f"spark-class {self.cls} --host {host} --port 7077 --webui-port 8080"[0m
[30;1m68 | [0m[35m        print(f"Executing\n{cmd}")[0m
[30;1m69 | [0m[35m        self.proc = subprocess.Popen(shlex.split(cmd))[0m
[30;1m70 | [0m[35m        print("Launched Spark Master")[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spark.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    22,  # ssh[0m
[30;1m39 | [0m[35m    7077,  # spark master <-> worker, so usually just internal to cluster[0m
[30;1m40 | [0m[35m    # dashboards usually get proxied to 443 with auth[0m
[30;1m41 | [0m[35m    8787,  # dash dashboard[0m
[30;1m42 | [0m[35m    4040,  # spark connect[0m
[30;1m43 | [0m[35m    8080,  # spark master[0m
[30;1m44 | [0m[35m    15002,  # spark gRPC port directly exposed without ssl/bearer auth[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spark.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mSPARK_CONNECT_PORT = 15003  # this provides ssl termination with proxy in front of 15002[0m
[30;1m37 | [0m[35mDEBUG_PORTS = [[0m
[30;1m38 | [0m[35m    22,  # ssh[0m
[30;1m39 | [0m[35m    7077,  # spark master <-> worker, so usually just internal to cluster[0m
[30;1m40 | [0m[35m    # dashboards usually get proxied to 443 with auth[0m
[30;1m41 | [0m[35m    8787,  # dash dashboard[0m
[30;1m42 | [0m[35m    4040,  # spark connect[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/spark.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport shlex[0m
[30;1m11 | [0m[35mimport subprocess[0m
[30;1m12 | [0m[35mimport sys[0m
[30;1m13 | [0m[35mimport time[0m
[30;1m14 | [0m[35mimport warnings[0m
[30;1m15 | [0m[35mfrom typing import Optional[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mtry:[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/plugins.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35masync def wait_for_bucket_mounting(timeout: int, logger: logging.Logger):[0m
[30;1m66 | [0m[35m    deadline = time() + timeout[0m
[30;1m67 | [0m[35m    mount_todo_dir = "/mount/.requests/todo"[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def bucket_mounts_are_pending():[0m
[30;1m70 | [0m[35m        return os.path.exists(mount_todo_dir) and os.listdir(mount_todo_dir)[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/plugins.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport asyncio[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mfrom time import time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom distributed.diagnostics.plugin import SchedulerPlugin, WorkerPlugin[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/plugins.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport asyncio[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mfrom time import time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom distributed.diagnostics.plugin import SchedulerPlugin, WorkerPlugin[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/scripts/nyc_parquet.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport dask.dataframe as dd[0m
[30;1m2 | [0m[35mfrom dask.distributed import progress[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport coiled[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m        cluster_info = cloud.cluster_details(cluster_id)[0m
[30;1m42 | [0m[35m    except coiled.errors.ServerError as e:[0m
[30;1m43 | [0m[35m        if "not found" in str(e).lower():[0m
[30;1m44 | [0m[35m            raise click.ClickException(f"Unable to find cluster with id {cluster_id}") from None[0m
[30;1m45 | [0m[35m        else:[0m
[30;1m46 | [0m[35m            raise e[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m        cluster_id = match["id"][0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    if not cluster_id:[0m
[30;1m38 | [0m[35m        raise click.ClickException(f"Unable to find cluster `{cluster}`")[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    try:[0m
[30;1m41 | [0m[35m        cluster_info = cloud.cluster_details(cluster_id)[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m        # default to most recent cluster[0m
[30;1m31 | [0m[35m        clusters = cloud.list_clusters(max_pages=1, just_mine=True)[0m
[30;1m32 | [0m[35m        if not clusters:[0m
[30;1m33 | [0m[35m            raise ValueError(f"Unable to find any clusters for workspace '{cloud.default_workspace}'[0m
[30;1m34 | [0m[35m        match = max(clusters, key=lambda c: c["id"])[0m
[30;1m35 | [0m[35m        cluster_id = match["id"][0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m                recent_cluster = sorted(clusters, key=lambda c: c["created"])[-1][0m
[30;1m20 | [0m[35m            else:[0m
[30;1m21 | [0m[35m                raise click.ClickException([0m
[30;1m22 | [0m[35m                    f"Unable to find cluster with name '{cluster}' in workspace '{cloud.default_work[0m
[30;1m23 | [0m[35m                )[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m            cluster_id = recent_cluster["id"][0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m458 | [0m[35m        # if a package exists in the pip list but is not a conda place holder[0m
[30;1m459 | [0m[35m        # then the conda package wont be imported and should be discarded[0m
[30;1m460 | [0m[35m        found = False[0m
[30;1m461 | [0m[35m        if pip_env.get(pypi_name):[0m
[30;1m462 | [0m[35m            found = True[0m
[30;1m463 | [0m[35m            pip_package = pip_env[pypi_name][0m
[30;1m464 | [0m[35m            if isinstance(pip_package, CondaPlaceHolder):[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m355 | [0m[35m            pkg_name = pkg["name"][0m
[30;1m356 | [0m[35m            # For duplicate .dist-info directories, we need to check which[0m
[30;1m357 | [0m[35m            # version is actually importable[0m
[30;1m358 | [0m[35m            existing_pkg = pkgs_by_name.get(pkg_name)[0m
[30;1m359 | [0m[35m            if existing_pkg is None:[0m
[30;1m360 | [0m[35m                pkgs_by_name[pkg_name] = pkg[0m
[30;1m361 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35mdef _is_hash_match(dist: Distribution, pkg_paths: Dict[str, PackagePath], path: str):[0m
[30;1m289 | [0m[35m    dist_path = Path(str(dist._path)).parent  # type: ignore[0m
[30;1m290 | [0m[35m    pkg_path = pkg_paths.get(path)[0m
[30;1m291 | [0m[35m    if pkg_path is not None and pkg_path.hash is not None:  # type: ignore[0m
[30;1m292 | [0m[35m        pkg_hash = pkg_path.hash  # type: ignore[0m
[30;1m293 | [0m[35m        hash_func = getattr(hashlib, pkg_hash.mode)[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m                    "version": dist.version,[0m
[30;1m242 | [0m[35m                    "wheel_target": url,[0m
[30;1m243 | [0m[35m                }[0m
[30;1m244 | [0m[35m            elif url_metadata.get("dir_info") is not None:[0m
[30;1m245 | [0m[35m                # PEP-610 - Source is a local directory[0m
[30;1m246 | [0m[35m                path = parse_file_uri(url)[0m
[30;1m247 | [0m[35m                return {[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m                # they this is actually just normal a pypi[0m
[30;1m226 | [0m[35m                # and we can ignore direct_url.json[0m
[30;1m227 | [0m[35m                pass[0m
[30;1m228 | [0m[35m            elif url_metadata.get("archive_info") is not None:[0m
[30;1m229 | [0m[35m                # PEP-610 - Source is an archive/wheel, somewhere![0m
[30;1m230 | [0m[35m                p = urlparse(url)[0m
[30;1m231 | [0m[35m                if p.scheme == "file":[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m                    # PEP-610 requires vcs_info to be a dict with a vcs key[0m
[30;1m203 | [0m[35m                    pass[0m
[30;1m204 | [0m[35m                vcs: Literal["git", "hg", "bzr", "svn"] = vcs_info["vcs"][0m
[30;1m205 | [0m[35m                commit = vcs_info.get("commit_id")[0m
[30;1m206 | [0m[35m                url = url_metadata["url"][0m
[30;1m207 | [0m[35m                pip_url = f"{vcs}+{url}"[0m
[30;1m208 | [0m[35m                # uv < 0.5.23 doesn't include commit_id, so we cannot pin[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m                # no url in this file[0m
[30;1m196 | [0m[35m                # invalid PEP-610 so don't do anything[0m
[30;1m197 | [0m[35m                pass[0m
[30;1m198 | [0m[35m            elif url_metadata.get("vcs_info"):[0m
[30;1m199 | [0m[35m                # PEP-610 Source is VCS[0m
[30;1m200 | [0m[35m                vcs_info = url_metadata["vcs_info"][0m
[30;1m201 | [0m[35m                if not isinstance(vcs_info, dict) or "vcs" not in vcs_info:[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m        direct_url_metadata = dist.read_text("direct_url.json")[0m
[30;1m191 | [0m[35m        if direct_url_metadata:[0m
[30;1m192 | [0m[35m            url_metadata = json.loads(direct_url_metadata)[0m
[30;1m193 | [0m[35m            url = url_metadata.get("url")[0m
[30;1m194 | [0m[35m            if not url:[0m
[30;1m195 | [0m[35m                # no url in this file[0m
[30;1m196 | [0m[35m                # invalid PEP-610 so don't do anything[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m            return None[0m
[30;1m135 | [0m[35m        else:[0m
[30;1m136 | [0m[35m            dist = ResilientDistribution(pkg.prefix / metadata_location)  # type: ignore[0m
[30;1m137 | [0m[35m            name = dist.metadata.get("Name") or pkg.name[0m
[30;1m138 | [0m[35m            path = Path(str(dist._path))[0m
[30;1m139 | [0m[35m    else:[0m
[30;1m140 | [0m[35m        name = pkg.name[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35mdef convert_conda_to_pypi_name(name: str):[0m
[30;1m73 | [0m[35m    return CONDA_TO_PYPI.get(name, name)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35mdef normalize_version(version: str):[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m520 | [0m[35m        if not extra_path.is_dir():[0m
[30;1m521 | [0m[35m            continue[0m
[30;1m522 | [0m[35m        if any(recurse_importable_python_files(extra_path)):[0m
[30;1m523 | [0m[35m            # Skip directories that are the same as a package that was installed via pip[0m
[30;1m524 | [0m[35m            git_dir = extra_path / ".git"[0m
[30;1m525 | [0m[35m            if git_dir.exists():[0m
[30;1m526 | [0m[35m                git_path = shutil.which("git") or "git"[0m
[30;1m527 | [0m[35m                try:[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m505 | [0m[35m                url = url.rstrip("/")[0m
[30;1m506 | [0m[35m                pkg_urls.add(url)[0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m    # Handle modules that are not installed via pip or conda[0m
[30;1m509 | [0m[35m    pkg_paths = {pkg["path"].resolve() for pkg in results if pkg["path"]}[0m
[30;1m510 | [0m[35m    extra_paths = ([0m
[30;1m511 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m494 | [0m[35m        list(pip_env.values()) + list(filtered_conda.values()),[0m
[30;1m495 | [0m[35m        key=lambda pkg: pkg["name"],[0m
[30;1m496 | [0m[35m    )[0m
[30;1m497 | [0m[35m    # get set of urls for all packages that were installed via pip[0m
[30;1m498 | [0m[35m    pkg_urls = set()[0m
[30;1m499 | [0m[35m    for pkg in results:[0m
[30;1m500 | [0m[35m        if pkg["wheel_target"]:[0m
[30;1m501 | [0m[35m            url = cast(str, pkg["wheel_target"])[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m469 | [0m[35m                    None,[0m
[30;1m470 | [0m[35m                )[0m
[30;1m471 | [0m[35m                if importable_package is None:[0m
[30;1m472 | [0m[35m                    logger.warning("Could not find importable conda package for %s", pypi_name)[0m
[30;1m473 | [0m[35m                else:[0m
[30;1m474 | [0m[35m                    filtered_conda[pypi_name] = importable_package[0m
[30;1m475 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m463 | [0m[35m            pip_package = pip_env[pypi_name][0m
[30;1m464 | [0m[35m            if isinstance(pip_package, CondaPlaceHolder):[0m
[30;1m465 | [0m[35m                del pip_env[pypi_name][0m
[30;1m466 | [0m[35m                # find the conda package that actually matches with what is importable[0m
[30;1m467 | [0m[35m                importable_package = next([0m
[30;1m468 | [0m[35m                    (p for p in packages if p["path"]),[0m
[30;1m469 | [0m[35m                    None,[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m455 | [0m[35m    filtered_conda = {}[0m
[30;1m456 | [0m[35m    # the pip list is the "truth" of what is imported for python deps[0m
[30;1m457 | [0m[35m    for pypi_name, packages in conda_env.items():[0m
[30;1m458 | [0m[35m        # if a package exists in the pip list but is not a conda place holder[0m
[30;1m459 | [0m[35m        # then the conda package wont be imported and should be discarded[0m
[30;1m460 | [0m[35m        found = False[0m
[30;1m461 | [0m[35m        if pip_env.get(pypi_name):[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m453 | [0m[35m    conda_env = await conda_env_future[0m
[30;1m454 | [0m[35m    pip_env = await pip_env_future[0m
[30;1m455 | [0m[35m    filtered_conda = {}[0m
[30;1m456 | [0m[35m    # the pip list is the "truth" of what is imported for python deps[0m
[30;1m457 | [0m[35m    for pypi_name, packages in conda_env.items():[0m
[30;1m458 | [0m[35m        # if a package exists in the pip list but is not a conda place holder[0m
[30;1m459 | [0m[35m        # then the conda package wont be imported and should be discarded[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m    if metadata_location:[0m
[30;1m130 | [0m[35m        if not metadata_location.exists():[0m
[30;1m131 | [0m[35m            # a file for this package no longer exists[0m
[30;1m132 | [0m[35m            # likely pip installed a new version[0m
[30;1m133 | [0m[35m            # removing the conda installed version[0m
[30;1m134 | [0m[35m            return None[0m
[30;1m135 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35mdef normalize_version(version: str):[0m
[30;1m77 | [0m[35m    """Attempt to normalize version between conda and pip without tripping over conda not supporting[0m
[30;1m78 | [0m[35m    # Bail on non-PEP440 versions like 2023c, which will get parsed as 2023rc0[0m
[30;1m79 | [0m[35m    if not len(version.split(".")) > 2:[0m
[30;1m80 | [0m[35m        return version[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mimport subprocess[0m
[30;1m12 | [0m[35mimport sys[0m
[30;1m13 | [0m[35mimport typing[0m
[30;1m14 | [0m[35mfrom base64 import urlsafe_b64encode[0m
[30;1m15 | [0m[35mfrom collections import defaultdict[0m
[30;1m16 | [0m[35mfrom logging import getLogger[0m
[30;1m17 | [0m[35mfrom pathlib import Path[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/scripts/fill_ipython.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mfrom coiled.utils import error_info_for_tracking[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# Prepopulate first cell with code example[0m
[30;1m10 | [0m[35mip = IPython.get_ipython()[0m
[30;1m11 | [0m[35mscript = pathlib.Path(sys.argv[1]).resolve()[0m
[30;1m12 | [0m[35mcode = script.read_text()[0m
[30;1m13 | [0m[35mip.set_next_input(code)[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/scripts/fill_ipython.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport coiled[0m
[30;1m7 | [0m[35mfrom coiled.utils import error_info_for_tracking[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# Prepopulate first cell with code example[0m
[30;1m10 | [0m[35mip = IPython.get_ipython()[0m
[30;1m11 | [0m[35mscript = pathlib.Path(sys.argv[1]).resolve()[0m
[30;1m12 | [0m[35mcode = script.read_text()[0m
[30;1m13 | [0m[35mip.set_next_input(code)[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/list.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m                cluster_details["name"],[0m
[30;1m45 | [0m[35m                cluster_details["updated"],[0m
[30;1m46 | [0m[35m                get_details_url(cloud.server, workspace or cloud.default_workspace, cluster_details[[0m
[30;1m47 | [0m[35m                cluster_details["current_state"].get("state") or "unknown",[0m
[30;1m48 | [0m[35m            )[0m
[30;1m49 | [0m[35m        console.print(table)[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m    token = dask.config.get("coiled.token")[0m
[30;1m33 | [0m[35m    server = dask.config.get("coiled.server")[0m
[30;1m34 | [0m[35m    # Manually hitting this endpoint to avoid implicitly triggering the login flow[0m
[30;1m35 | [0m[35m    r = httpx.get(f"{server}/api/v2/user/me", headers={"Authorization": f"ApiToken {token}"})[0m
[30;1m36 | [0m[35m    if r.is_success:[0m
[30;1m37 | [0m[35m        return False[0m
[30;1m38 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        return True[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    token = dask.config.get("coiled.token")[0m
[30;1m33 | [0m[35m    server = dask.config.get("coiled.server")[0m
[30;1m34 | [0m[35m    # Manually hitting this endpoint to avoid implicitly triggering the login flow[0m
[30;1m35 | [0m[35m    r = httpx.get(f"{server}/api/v2/user/me", headers={"Authorization": f"ApiToken {token}"})[0m
[30;1m36 | [0m[35m    if r.is_success:[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m        # Need login if no token[0m
[30;1m30 | [0m[35m        return True[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    token = dask.config.get("coiled.token")[0m
[30;1m33 | [0m[35m    server = dask.config.get("coiled.server")[0m
[30;1m34 | [0m[35m    # Manually hitting this endpoint to avoid implicitly triggering the login flow[0m
[30;1m35 | [0m[35m    r = httpx.get(f"{server}/api/v2/user/me", headers={"Authorization": f"ApiToken {token}"})[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mdef needs_login():[0m
[30;1m28 | [0m[35m    if dask.config.get("coiled.token", False) is False:[0m
[30;1m29 | [0m[35m        # Need login if no token[0m
[30;1m30 | [0m[35m        return True[0m
[30;1m31 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m1. {"✅ " if already_run["hello-world"] else ""}Run a script: Hello world[0m
[30;1m253 | [0m[35m2. {"✅ " if already_run["nyc-parquet"] else ""}Dask at scale: Aggregate 1 TB of parquet data[0m
[30;1m254 | [0m[35m3. {"✅ " if already_run["xarray-nwm"] else ""}Xarray at scale: Aggregate 2 TB of geospatial data[0m
[30;1m255 | [0m[35m4. {"✅ " if already_run["pytorch"] else ""}Serverless functions: Train a PyTorch model on a GPU[0m
[30;1m256 | [0m[35m5. Exit[0m
[30;1m257 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m250 | [0m[35mChoose any computation you'd like to run:[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m1. {"✅ " if already_run["hello-world"] else ""}Run a script: Hello world[0m
[30;1m253 | [0m[35m2. {"✅ " if already_run["nyc-parquet"] else ""}Dask at scale: Aggregate 1 TB of parquet data[0m
[30;1m254 | [0m[35m3. {"✅ " if already_run["xarray-nwm"] else ""}Xarray at scale: Aggregate 2 TB of geospatial data[0m
[30;1m255 | [0m[35m4. {"✅ " if already_run["pytorch"] else ""}Serverless functions: Train a PyTorch model on a GPU[0m
[30;1m256 | [0m[35m5. Exit[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m                )[0m
[30;1m231 | [0m[35m            )[0m
[30;1m232 | [0m[35m        elif success is False:[0m
[30;1m233 | [0m[35m            print("See you next time :wave:")[0m
[30;1m234 | [0m[35m            return False[0m
[30;1m235 | [0m[35m    time.sleep(DEFAULT_SLEEP)[0m
[30;1m236 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m    if do_login:[0m
[30;1m204 | [0m[35m        already_run = get_already_run_examples()[0m
[30;1m205 | [0m[35m    else:[0m
[30;1m206 | [0m[35m        # Give some time between messages to avoid lots of text flying by[0m
[30;1m207 | [0m[35m        time.sleep(DEFAULT_SLEEP)[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    # Run "Hello world" if needed[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m                    )[0m
[30;1m176 | [0m[35m                )[0m
[30;1m177 | [0m[35m        else:[0m
[30;1m178 | [0m[35m            console.print("See you next time :wave:")[0m
[30;1m179 | [0m[35m            return True[0m
[30;1m180 | [0m[35m    else:[0m
[30;1m181 | [0m[35m        console.print([0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m        coiled.add_interaction("cli-hello:ready-start", success=True, choice=choice)[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    if choice == "n":[0m
[30;1m140 | [0m[35m        print("See you next time :wave:")[0m
[30;1m141 | [0m[35m        return True[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    # Handle login if needed[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m    # Here, and in a few other places, we need to be careful to not run code[0m
[30;1m92 | [0m[35m    # like `coiled.add_interaction` that triggers the login flow implicitly.[0m
[30;1m93 | [0m[35m    # We want to present the user with the welcome prompt first, so they know[0m
[30;1m94 | [0m[35m    # what to expect -- then do the login flow if needed.[0m
[30;1m95 | [0m[35m    if do_login:[0m
[30;1m96 | [0m[35m        already_run = dict.fromkeys(examples.keys(), False)[0m
[30;1m97 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/hello.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport subprocess[0m
[30;1m6 | [0m[35mimport sys[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport dask[0m
[30;1m10 | [0m[35mimport dask.config[0m
[30;1m11 | [0m[35mimport httpx[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/get_address.py[0m
   Pattern: [32m.hostname[0m
[30;1m52 | [0m[35m        if by_ip:[0m
[30;1m53 | [0m[35m            scheduler_address = ssh_info["scheduler_public_address"][0m
[30;1m54 | [0m[35m        else:[0m
[30;1m55 | [0m[35m            scheduler_address = ssh_info["scheduler_hostname"] or ssh_info["scheduler_public_address[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    print(ssh_info["worker_address"] or scheduler_address, end="")[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/get_address.py[0m
   Pattern: [32m.hostname[0m
[30;1m27 | [0m[35m    "--by-ip",[0m
[30;1m28 | [0m[35m    default=False,[0m
[30;1m29 | [0m[35m    is_flag=True,[0m
[30;1m30 | [0m[35m    help="Use public IP address of scheduler directly, not using DNS hostname",[0m
[30;1m31 | [0m[35m)[0m
[30;1m32 | [0m[35m@click.option([0m
[30;1m33 | [0m[35m    "--worker",[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/get_address.py[0m
   Pattern: [32m.hostname[0m
[30;1m21 | [0m[35m    "--private",[0m
[30;1m22 | [0m[35m    default=False,[0m
[30;1m23 | [0m[35m    is_flag=True,[0m
[30;1m24 | [0m[35m    help="Use private IP address of scheduler (default is DNS hostname for public IP)",[0m
[30;1m25 | [0m[35m)[0m
[30;1m26 | [0m[35m@click.option([0m
[30;1m27 | [0m[35m    "--by-ip",[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/get_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m@click.option([0m
[30;1m33 | [0m[35m    "--worker",[0m
[30;1m34 | [0m[35m    default=None,[0m
[30;1m35 | [0m[35m    help="Connect to worker with specified name or private IP address (default is to connect to sche[0m
[30;1m36 | [0m[35m)[0m
[30;1m37 | [0m[35mdef get_address([0m
[30;1m38 | [0m[35m    cluster: str,[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/get_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m    "--by-ip",[0m
[30;1m28 | [0m[35m    default=False,[0m
[30;1m29 | [0m[35m    is_flag=True,[0m
[30;1m30 | [0m[35m    help="Use public IP address of scheduler directly, not using DNS hostname",[0m
[30;1m31 | [0m[35m)[0m
[30;1m32 | [0m[35m@click.option([0m
[30;1m33 | [0m[35m    "--worker",[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/get_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    "--private",[0m
[30;1m22 | [0m[35m    default=False,[0m
[30;1m23 | [0m[35m    is_flag=True,[0m
[30;1m24 | [0m[35m    help="Use private IP address of scheduler (default is DNS hostname for public IP)",[0m
[30;1m25 | [0m[35m)[0m
[30;1m26 | [0m[35m@click.option([0m
[30;1m27 | [0m[35m    "--by-ip",[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mfrom .get_address import get_address[0m
[30;1m8 | [0m[35mfrom .list import list_clusters[0m
[30;1m9 | [0m[35mfrom .logs import logs[0m
[30;1m10 | [0m[35mfrom .ssh import ssh[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m@click.group(context_settings=CONTEXT_SETTINGS)[0m
[30;1m14 | [0m[35mdef cluster():[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/examples/hello_world.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    --n-tasks {NTASKS} \\[0m
[30;1m39 | [0m[35m    echo Hello world[0m
[30;1m40 | [0m[35m$ coiled batch wait              # Monitor progress while jobs run[0m
[30;1m41 | [0m[35m$ coiled logs | grep Hello       # Grep through job logs[0m
[30;1m42 | [0m[35m```[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35mI'll run this for you here, but you can do this yourself any time.[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/examples/hello_world.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    --n-tasks {NTASKS} \\[0m
[30;1m39 | [0m[35m    echo Hello world[0m
[30;1m40 | [0m[35m$ coiled batch wait              # Monitor progress while jobs run[0m
[30;1m41 | [0m[35m$ coiled logs | grep Hello       # Grep through job logs[0m
[30;1m42 | [0m[35m```[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35mI'll run this for you here, but you can do this yourself any time.[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/examples/hello_world.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport subprocess[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom rich.markdown import Markdown[0m
[30;1m7 | [0m[35mfrom rich.prompt import Prompt[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/extensions/prefect/runners.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m            # by the Prefect Worker implementation.[0m
[30;1m17 | [0m[35m            # TODO: Configurable in re-using cluster for flows?[0m
[30;1m18 | [0m[35m            name = self.cluster_kwargs.get("name")[0m
[30;1m19 | [0m[35m            cluster_name = os.environ.get("COILED__CLUSTER_NAME")[0m
[30;1m20 | [0m[35m            if not name and cluster_name:[0m
[30;1m21 | [0m[35m                self.cluster_kwargs["name"] = cluster_name[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/extensions/prefect/runners.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m            # Has to be in _start, b/c this is called just before flow runtime,[0m
[30;1m16 | [0m[35m            # by the Prefect Worker implementation.[0m
[30;1m17 | [0m[35m            # TODO: Configurable in re-using cluster for flows?[0m
[30;1m18 | [0m[35m            name = self.cluster_kwargs.get("name")[0m
[30;1m19 | [0m[35m            cluster_name = os.environ.get("COILED__CLUSTER_NAME")[0m
[30;1m20 | [0m[35m            if not name and cluster_name:[0m
[30;1m21 | [0m[35m                self.cluster_kwargs["name"] = cluster_name[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m                else:[0m
[30;1m95 | [0m[35m                    duration = ""[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m                state_color = STATE_COLORS.get(task["state"])[0m
[30;1m98 | [0m[35m                if task["exit_code"]:[0m
[30;1m99 | [0m[35m                    state_color = "red"[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35mdef print_job_status(jobs: list[dict], format: Literal["table", "json"], cluster: str | int, sort=No[0m
[30;1m60 | [0m[35m    if sort:[0m
[30;1m61 | [0m[35m        for job in jobs:[0m
[30;1m62 | [0m[35m            job["tasks"].sort(key=lambda task: [task.get(sort_key) for sort_key in sort])[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    if format == "json":[0m
[30;1m65 | [0m[35m        print(jobs)[0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m):[0m
[30;1m37 | [0m[35m    """Check the status of a Coiled Batch job."""[0m
[30;1m38 | [0m[35m    jobs, cluster_id = get_job_status(cluster=cluster, workspace=workspace)[0m
[30;1m39 | [0m[35m    print_job_status(jobs=jobs, format=format, cluster=cluster or cluster_id, sort=sort.split(",") i[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mdef format_duration_seconds(n):[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1722 | [0m[35m        )[0m
[30;1m1723 | [0m[35m[0m
[30;1m1724 | [0m[35m        request_status = quota_response["RequestedQuota"]["Status"][0m
[30;1m1725 | [0m[35m        request_case_id = quota_response["RequestedQuota"].get("CaseId")  # might not be in response[0m
[30;1m1726 | [0m[35m[0m
[30;1m1727 | [0m[35m        info_text = ([0m
[30;1m1728 | [0m[35m            f"You've submitted a request in increase [bold]{quota_label}[/bold] "[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1625 | [0m[35m        quota_label = quota["class"][0m
[30;1m1626 | [0m[35m        if quota.get("value") is not None:[0m
[30;1m1627 | [0m[35m            quota_value_text = f"{quota.get('value'):>6} vCPU"[0m
[30;1m1628 | [0m[35m            if quota.get("is_low"):[0m
[30;1m1629 | [0m[35m                quota_value_text = f"{quota_value_text} (this quota is low, you may wish to request [0m
[30;1m1630 | [0m[35m        else:[0m
[30;1m1631 | [0m[35m            quota_value_text = f"[link]{quota['link']}[/link]"[0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1624 | [0m[35m    for quota in quotas:[0m
[30;1m1625 | [0m[35m        quota_label = quota["class"][0m
[30;1m1626 | [0m[35m        if quota.get("value") is not None:[0m
[30;1m1627 | [0m[35m            quota_value_text = f"{quota.get('value'):>6} vCPU"[0m
[30;1m1628 | [0m[35m            if quota.get("is_low"):[0m
[30;1m1629 | [0m[35m                quota_value_text = f"{quota_value_text} (this quota is low, you may wish to request [0m
[30;1m1630 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1623 | [0m[35m[0m
[30;1m1624 | [0m[35m    for quota in quotas:[0m
[30;1m1625 | [0m[35m        quota_label = quota["class"][0m
[30;1m1626 | [0m[35m        if quota.get("value") is not None:[0m
[30;1m1627 | [0m[35m            quota_value_text = f"{quota.get('value'):>6} vCPU"[0m
[30;1m1628 | [0m[35m            if quota.get("is_low"):[0m
[30;1m1629 | [0m[35m                quota_value_text = f"{quota_value_text} (this quota is low, you may wish to request [0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1605 | [0m[35m    try:[0m
[30;1m1606 | [0m[35m        for quota in quotas:[0m
[30;1m1607 | [0m[35m            quota["value"] = get_quota_value(quota_client, quota["code"])[0m
[30;1m1608 | [0m[35m            if quota.get("low") is not None and quota["value"] <= quota["low"]:[0m
[30;1m1609 | [0m[35m                quota["is_low"] = True[0m
[30;1m1610 | [0m[35m                low_quotas.append(quota)[0m
[30;1m1611 | [0m[35m            got_quotas = True[0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35m        except iam.exceptions.ClientError as e:[0m
[30;1m1428 | [0m[35m            error_code = e.response["Error"].get("Code")[0m
[30;1m1429 | [0m[35m            error_msg = e.response["Error"].get("Message")[0m
[30;1m1430 | [0m[35m            error_op = e.operation_name[0m
[30;1m1431 | [0m[35m[0m
[30;1m1432 | [0m[35m            coiled.add_interaction(action=error_op, success=False, error_message=error_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1425 | [0m[35m                )[0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35m        except iam.exceptions.ClientError as e:[0m
[30;1m1428 | [0m[35m            error_code = e.response["Error"].get("Code")[0m
[30;1m1429 | [0m[35m            error_msg = e.response["Error"].get("Message")[0m
[30;1m1430 | [0m[35m            error_op = e.operation_name[0m
[30;1m1431 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1335 | [0m[35m                custom_s3_bucket_prefix=custom_s3_bucket_prefix,[0m
[30;1m1336 | [0m[35m            )[0m
[30;1m1337 | [0m[35m        except KeyboardInterrupt:[0m
[30;1m1338 | [0m[35m            if not bool(dask.config.get("coiled.token", None)):[0m
[30;1m1339 | [0m[35m                print("[red]This computer doesn't have access to your Coiled account so setup cannot[0m
[30;1m1340 | [0m[35m                print("Try running [green]coiled login[/green] to authorize access to your Coiled ac[0m
[30;1m1341 | [0m[35m                return False[0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1300 | [0m[35m    local_user = get_local_user()[0m
[30;1m1301 | [0m[35m[0m
[30;1m1302 | [0m[35m    # this isn't perfect since we aren't checking if token is valid, but it's better than nothing[0m
[30;1m1303 | [0m[35m    is_logged_in = bool(dask.config.get("coiled.token", None))[0m
[30;1m1304 | [0m[35m[0m
[30;1m1305 | [0m[35m    # We don't want to require Coiled account if just using `coiled setup aws --quotas`, thus[0m
[30;1m1306 | [0m[35m    # skipping telemetry for `--quotas` if user doesn't already have local Coiled token.[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1172 | [0m[35m            coiled_account = cloud.default_workspace[0m
[30;1m1173 | [0m[35m[0m
[30;1m1174 | [0m[35m    setup_url = ([0m
[30;1m1175 | [0m[35m        f"{dask.config.get('coiled.server', coiled.utils.COILED_SERVER)}/{coiled_account}/settings/s[0m
[30;1m1176 | [0m[35m    )[0m
[30;1m1177 | [0m[35m[0m
[30;1m1178 | [0m[35m    print([0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1134 | [0m[35m        }[0m
[30;1m1135 | [0m[35m        cloud._sync_request(endpoint, method="POST", json=setup_data)[0m
[30;1m1136 | [0m[35m    region_ui_url = ([0m
[30;1m1137 | [0m[35m        f"{dask.config.get('coiled.server', coiled.utils.COILED_SERVER)}/"[0m
[30;1m1138 | [0m[35m        f"settings/setup/infrastructure?account={coiled_account}"[0m
[30;1m1139 | [0m[35m    )[0m
[30;1m1140 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m802 | [0m[35m        else ""[0m
[30;1m803 | [0m[35m    )[0m
[30;1m804 | [0m[35m[0m
[30;1m805 | [0m[35m    token = dask.config.get("coiled.token")[0m
[30;1m806 | [0m[35m    a, b, c = token[:24], token[24:48], token[48:][0m
[30;1m807 | [0m[35m    token_args = [[0m
[30;1m808 | [0m[35m        f"  --token {a} \\",[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m798 | [0m[35m    # explain cloudshell[0m
[30;1m799 | [0m[35m    server_arg = ([0m
[30;1m800 | [0m[35m        f"--server {dask.config.get('coiled.server', coiled.utils.COILED_SERVER)} \\ "[0m
[30;1m801 | [0m[35m        if dask.config.get("coiled.server", coiled.utils.COILED_SERVER) != coiled.utils.COILED_SERVE[0m
[30;1m802 | [0m[35m        else ""[0m
[30;1m803 | [0m[35m    )[0m
[30;1m804 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m797 | [0m[35mdef show_cloudshell_instructions(region, coiled_account):[0m
[30;1m798 | [0m[35m    # explain cloudshell[0m
[30;1m799 | [0m[35m    server_arg = ([0m
[30;1m800 | [0m[35m        f"--server {dask.config.get('coiled.server', coiled.utils.COILED_SERVER)} \\ "[0m
[30;1m801 | [0m[35m        if dask.config.get("coiled.server", coiled.utils.COILED_SERVER) != coiled.utils.COILED_SERVE[0m
[30;1m802 | [0m[35m        else ""[0m
[30;1m803 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m739 | [0m[35m[0m
[30;1m740 | [0m[35m        try:[0m
[30;1m741 | [0m[35m            r = iam.list_account_aliases()[0m
[30;1m742 | [0m[35m            account_alias = r.get("AccountAliases", [])[0][0m
[30;1m743 | [0m[35m            alias_string = f" ({account_alias})"[0m
[30;1m744 | [0m[35m            coiled.add_interaction([0m
[30;1m745 | [0m[35m                action="ListAccountAliases",[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m728 | [0m[35m        # get_caller_identity doesn't require any specific IAM rights[0m
[30;1m729 | [0m[35m        identity = sts.get_caller_identity()[0m
[30;1m730 | [0m[35m        aws_account = identity.get("Account")[0m
[30;1m731 | [0m[35m        identity_as = identity.get("Arn").split(":")[-1][0m
[30;1m732 | [0m[35m[0m
[30;1m733 | [0m[35m        coiled.add_interaction([0m
[30;1m734 | [0m[35m            action="GetCallerIdentity",[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m727 | [0m[35m    try:[0m
[30;1m728 | [0m[35m        # get_caller_identity doesn't require any specific IAM rights[0m
[30;1m729 | [0m[35m        identity = sts.get_caller_identity()[0m
[30;1m730 | [0m[35m        aws_account = identity.get("Account")[0m
[30;1m731 | [0m[35m        identity_as = identity.get("Arn").split(":")[-1][0m
[30;1m732 | [0m[35m[0m
[30;1m733 | [0m[35m        coiled.add_interaction([0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m697 | [0m[35m[0m
[30;1m698 | [0m[35m            return True[0m
[30;1m699 | [0m[35m        except iam.exceptions.ClientError as e:[0m
[30;1m700 | [0m[35m            error_code = e.response["Error"].get("Code")[0m
[30;1m701 | [0m[35m            if error_code == "InvalidClientTokenId":[0m
[30;1m702 | [0m[35m                print(".", end="")[0m
[30;1m703 | [0m[35m                time.sleep(1)[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m647 | [0m[35m        coiled.add_interaction(action="ListAccessKeys", success=True, user=user)[0m
[30;1m648 | [0m[35m        return True, r["AccessKeyMetadata"][0m
[30;1m649 | [0m[35m    except iam.exceptions.ClientError as e:[0m
[30;1m650 | [0m[35m        error_code = e.response["Error"].get("Code")[0m
[30;1m651 | [0m[35m[0m
[30;1m652 | [0m[35m        if error_code == "NoSuchEntity":[0m
[30;1m653 | [0m[35m            coiled.add_interaction([0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m520 | [0m[35m        policy = iam.get_policy(PolicyArn=arn)[0m
[30;1m521 | [0m[35m        existing_arn = arn[0m
[30;1m522 | [0m[35m    except iam.exceptions.ClientError as e:[0m
[30;1m523 | [0m[35m        error_code = e.response["Error"].get("Code")[0m
[30;1m524 | [0m[35m[0m
[30;1m525 | [0m[35m        if error_code == "NoSuchEntity":[0m
[30;1m526 | [0m[35m            return existing_arn, changes[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m501 | [0m[35m            changes = "\n".join(change_lines)[0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35m    except iam.exceptions.ClientError as e:[0m
[30;1m504 | [0m[35m        error_code = e.response["Error"].get("Code")[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m        if error_code == "NoSuchEntity":[0m
[30;1m507 | [0m[35m            return existing_arn, trust_doc, changes[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m491 | [0m[35m            # add external id for the desired principal[0m
[30;1m492 | [0m[35m            updated_access = {[0m
[30;1m493 | [0m[35m                **existing_access,[0m
[30;1m494 | [0m[35m                add_principal: [*existing_access.get(add_principal, []), add_external_id],[0m
[30;1m495 | [0m[35m            }[0m
[30;1m496 | [0m[35m[0m
[30;1m497 | [0m[35m            # trust doc that has existing and new access[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m469 | [0m[35m                    existing_access[statement_principal].extend(external_ids)[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m        change_lines = [][0m
[30;1m472 | [0m[35m        if add_external_id not in existing_access.get(add_principal, []):[0m
[30;1m473 | [0m[35m            change_lines.append([0m
[30;1m474 | [0m[35m                f"  [green][bold]+[/bold] sts:AssumeRole for [bold]{add_principal}[/bold]\n"[0m
[30;1m475 | [0m[35m                f"    where sts:ExternalId=[bold]{add_external_id}[/bold][/green]"[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m460 | [0m[35m        for statement in r["Role"].get("AssumeRolePolicyDocument", {}).get("Statement", []):[0m
[30;1m461 | [0m[35m            if statement.get("Effect") == "Allow" and statement.get("Action") == "sts:AssumeRole":[0m
[30;1m462 | [0m[35m                statement_principal = statement.get("Principal", {}).get("AWS")[0m
[30;1m463 | [0m[35m                external_ids = statement.get("Condition", {}).get("StringEquals", {}).get("sts:Exter[0m
[30;1m464 | [0m[35m                if external_ids:[0m
[30;1m465 | [0m[35m                    if isinstance(external_ids, str):[0m
[30;1m466 | [0m[35m                        external_ids = [external_ids][0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m460 | [0m[35m        for statement in r["Role"].get("AssumeRolePolicyDocument", {}).get("Statement", []):[0m
[30;1m461 | [0m[35m            if statement.get("Effect") == "Allow" and statement.get("Action") == "sts:AssumeRole":[0m
[30;1m462 | [0m[35m                statement_principal = statement.get("Principal", {}).get("AWS")[0m
[30;1m463 | [0m[35m                external_ids = statement.get("Condition", {}).get("StringEquals", {}).get("sts:Exter[0m
[30;1m464 | [0m[35m                if external_ids:[0m
[30;1m465 | [0m[35m                    if isinstance(external_ids, str):[0m
[30;1m466 | [0m[35m                        external_ids = [external_ids][0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m460 | [0m[35m        for statement in r["Role"].get("AssumeRolePolicyDocument", {}).get("Statement", []):[0m
[30;1m461 | [0m[35m            if statement.get("Effect") == "Allow" and statement.get("Action") == "sts:AssumeRole":[0m
[30;1m462 | [0m[35m                statement_principal = statement.get("Principal", {}).get("AWS")[0m
[30;1m463 | [0m[35m                external_ids = statement.get("Condition", {}).get("StringEquals", {}).get("sts:Exter[0m
[30;1m464 | [0m[35m                if external_ids:[0m
[30;1m465 | [0m[35m                    if isinstance(external_ids, str):[0m
[30;1m466 | [0m[35m                        external_ids = [external_ids][0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        for statement in r["Role"].get("AssumeRolePolicyDocument", {}).get("Statement", []):[0m
[30;1m461 | [0m[35m            if statement.get("Effect") == "Allow" and statement.get("Action") == "sts:AssumeRole":[0m
[30;1m462 | [0m[35m                statement_principal = statement.get("Principal", {}).get("AWS")[0m
[30;1m463 | [0m[35m                external_ids = statement.get("Condition", {}).get("StringEquals", {}).get("sts:Exter[0m
[30;1m464 | [0m[35m                if external_ids:[0m
[30;1m465 | [0m[35m                    if isinstance(external_ids, str):[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        for statement in r["Role"].get("AssumeRolePolicyDocument", {}).get("Statement", []):[0m
[30;1m461 | [0m[35m            if statement.get("Effect") == "Allow" and statement.get("Action") == "sts:AssumeRole":[0m
[30;1m462 | [0m[35m                statement_principal = statement.get("Principal", {}).get("AWS")[0m
[30;1m463 | [0m[35m                external_ids = statement.get("Condition", {}).get("StringEquals", {}).get("sts:Exter[0m
[30;1m464 | [0m[35m                if external_ids:[0m
[30;1m465 | [0m[35m                    if isinstance(external_ids, str):[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m458 | [0m[35m        existing_access = {}[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        for statement in r["Role"].get("AssumeRolePolicyDocument", {}).get("Statement", []):[0m
[30;1m461 | [0m[35m            if statement.get("Effect") == "Allow" and statement.get("Action") == "sts:AssumeRole":[0m
[30;1m462 | [0m[35m                statement_principal = statement.get("Principal", {}).get("AWS")[0m
[30;1m463 | [0m[35m                external_ids = statement.get("Condition", {}).get("StringEquals", {}).get("sts:Exter[0m
[30;1m464 | [0m[35m                if external_ids:[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m458 | [0m[35m        existing_access = {}[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        for statement in r["Role"].get("AssumeRolePolicyDocument", {}).get("Statement", []):[0m
[30;1m461 | [0m[35m            if statement.get("Effect") == "Allow" and statement.get("Action") == "sts:AssumeRole":[0m
[30;1m462 | [0m[35m                statement_principal = statement.get("Principal", {}).get("AWS")[0m
[30;1m463 | [0m[35m                external_ids = statement.get("Condition", {}).get("StringEquals", {}).get("sts:Exter[0m
[30;1m464 | [0m[35m                if external_ids:[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35m        existing_access = {}[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        for statement in r["Role"].get("AssumeRolePolicyDocument", {}).get("Statement", []):[0m
[30;1m461 | [0m[35m            if statement.get("Effect") == "Allow" and statement.get("Action") == "sts:AssumeRole":[0m
[30;1m462 | [0m[35m                statement_principal = statement.get("Principal", {}).get("AWS")[0m
[30;1m463 | [0m[35m                external_ids = statement.get("Condition", {}).get("StringEquals", {}).get("sts:Exter[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35m        existing_access = {}[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        for statement in r["Role"].get("AssumeRolePolicyDocument", {}).get("Statement", []):[0m
[30;1m461 | [0m[35m            if statement.get("Effect") == "Allow" and statement.get("Action") == "sts:AssumeRole":[0m
[30;1m462 | [0m[35m                statement_principal = statement.get("Principal", {}).get("AWS")[0m
[30;1m463 | [0m[35m                external_ids = statement.get("Condition", {}).get("StringEquals", {}).get("sts:Exter[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1489 | [0m[35m        print()[0m
[30;1m1490 | [0m[35m        print("[red][bold]ERROR[/bold][/red] Something unexpected happened:")[0m
[30;1m1491 | [0m[35m        print(f"    [red]{e}")[0m
[30;1m1492 | [0m[35m        print("Please reach out to Coiled Support at support@coiled.io if you need help with this is[0m
[30;1m1493 | [0m[35m        setup_failure([0m
[30;1m1494 | [0m[35m            f"Unhandled exception {msg}",[0m
[30;1m1495 | [0m[35m            backend="aws",[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1236 | [0m[35m        print("You may need to update your [bold]ongoing[/bold] IAM Policy.")[0m
[30;1m1237 | [0m[35m    elif ongoing_arn and not ongoing_diff:[0m
[30;1m1238 | [0m[35m        print("Your [bold]ongoing[/bold] IAM Policy is up-to-date")[0m
[30;1m1239 | [0m[35m        print("You may need to update your [bold]setup[/bold] IAM Policy.")[0m
[30;1m1240 | [0m[35m[0m
[30;1m1241 | [0m[35m    elif not yes and not Confirm.ask(PROMPTS["initial"], default=True):[0m
[30;1m1242 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1233 | [0m[35m        print("Your AWS IAM Policies are up-to-date")[0m
[30;1m1234 | [0m[35m    elif setup_arn and not setup_diff:[0m
[30;1m1235 | [0m[35m        print("Your [bold]setup[/bold] IAM Policy is up-to-date")[0m
[30;1m1236 | [0m[35m        print("You may need to update your [bold]ongoing[/bold] IAM Policy.")[0m
[30;1m1237 | [0m[35m    elif ongoing_arn and not ongoing_diff:[0m
[30;1m1238 | [0m[35m        print("Your [bold]ongoing[/bold] IAM Policy is up-to-date")[0m
[30;1m1239 | [0m[35m        print("You may need to update your [bold]setup[/bold] IAM Policy.")[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1141 | [0m[35m    message = f"""[0m
[30;1m1142 | [0m[35m[bold]Setup complete 🎉[/bold][0m
[30;1m1143 | [0m[35m[0m
[30;1m1144 | [0m[35mYou can configure networking and other options for your account at[0m
[30;1m1145 | [0m[35m[link]{region_ui_url}[/link][0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35mWhat's next?[0m
[30;1m1148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1012 | [0m[35m[0m
[30;1m1013 | [0m[35m    if not setup_arn or not ongoing_arn:[0m
[30;1m1014 | [0m[35m        resource_strings.append([0m
[30;1m1015 | [0m[35m            "\nDocumentation for IAM Policies at "[0m
[30;1m1016 | [0m[35m            "[link]https://docs.coiled.io/user_guide/aws_configure.html#create-iam-policies[/link]"[0m
[30;1m1017 | [0m[35m        )[0m
[30;1m1018 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m715 | [0m[35m[0m
[30;1m716 | [0m[35mThis will do the following ...[0m
[30;1m717 | [0m[35m1. Create limited IAM roles and grant them to Coiled[0m
[30;1m718 | [0m[35m2. Check and expand your AWS quota if needed[0m
[30;1m719 | [0m[35m3. Create initial resources to deploy clusters[0m
[30;1m720 | [0m[35m[0m
[30;1m721 | [0m[35mThis will [bold]not[/bold] ...[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m591 | [0m[35m                arn=policy_arn,[0m
[30;1m592 | [0m[35m                error_message=str(e),[0m
[30;1m593 | [0m[35m            )[0m
[30;1m594 | [0m[35m        print("[red]Unable to update existing policy[/red]:")[0m
[30;1m595 | [0m[35m        print(f"  [red]{e}[/red]")[0m
[30;1m596 | [0m[35m        print()[0m
[30;1m597 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m[0m
[30;1m411 | [0m[35mdef create_or_update_role(iam, aws_account, name, trust_policy):[0m
[30;1m412 | [0m[35m    """Create or update the role used for cross-account role assumption."""[0m
[30;1m413 | [0m[35m    try:[0m
[30;1m414 | [0m[35m        r = iam.create_role([0m
[30;1m415 | [0m[35m            RoleName=name,[0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m67 | [0m[35m    "--update-policies",[0m
[30;1m68 | [0m[35m    default=False,[0m
[30;1m69 | [0m[35m    is_flag=True,[0m
[30;1m70 | [0m[35m    help="Only update existing IAM Policies",[0m
[30;1m71 | [0m[35m)[0m
[30;1m72 | [0m[35m@click.option([0m
[30;1m73 | [0m[35m    "--update-instance-policy",[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1739 | [0m[35m            )[0m
[30;1m1740 | [0m[35m        elif request_status in ("DENIED", "CASE_CLOSED"):[0m
[30;1m1741 | [0m[35m            status_text = ([0m
[30;1m1742 | [0m[35m                "You can find more details about your quota request in the AWS Console:\n"[0m
[30;1m1743 | [0m[35m                f"[link]{get_support_case_link(request_case_id)}"[0m
[30;1m1744 | [0m[35m            )[0m
[30;1m1745 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1626 | [0m[35m        if quota.get("value") is not None:[0m
[30;1m1627 | [0m[35m            quota_value_text = f"{quota.get('value'):>6} vCPU"[0m
[30;1m1628 | [0m[35m            if quota.get("is_low"):[0m
[30;1m1629 | [0m[35m                quota_value_text = f"{quota_value_text} (this quota is low, you may wish to request [0m
[30;1m1630 | [0m[35m        else:[0m
[30;1m1631 | [0m[35m            quota_value_text = f"[link]{quota['link']}[/link]"[0m
[30;1m1632 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1616 | [0m[35m        )[0m
[30;1m1617 | [0m[35m    except Exception as e:[0m
[30;1m1618 | [0m[35m        error_message = ([0m
[30;1m1619 | [0m[35m            "An unexpected error occurred while trying to read your AWS service quotas:\n\n"[0m
[30;1m1620 | [0m[35m            f"[red]{e}[/red]\n\n"[0m
[30;1m1621 | [0m[35m            "You can check the quotas in the AWS Console using the links below."[0m
[30;1m1622 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1611 | [0m[35m            got_quotas = True[0m
[30;1m1612 | [0m[35m    except quota_client.exceptions.AccessDeniedException:[0m
[30;1m1613 | [0m[35m        error_message = ([0m
[30;1m1614 | [0m[35m            "[red]Your active AWS account doesn't have permission to read service quotas.[/red]\n\n"[0m
[30;1m1615 | [0m[35m            "You can check the quotas in the AWS Console using the links below."[0m
[30;1m1616 | [0m[35m        )[0m
[30;1m1617 | [0m[35m    except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1450 | [0m[35m                print()[0m
[30;1m1451 | [0m[35m                print(f"[red]{error_msg}[/red]")[0m
[30;1m1452 | [0m[35m                print()[0m
[30;1m1453 | [0m[35m                print("To run this setup script you'll need the following IAM permissions:")[0m
[30;1m1454 | [0m[35m                for permission in SCRIPT_REQUIRED_IAM:[0m
[30;1m1455 | [0m[35m                    print(f"- {permission}")[0m
[30;1m1456 | [0m[35m                print([0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m833 | [0m[35m        f"  [green]{cli_command}[/green]\n"[0m
[30;1m834 | [0m[35m    )[0m
[30;1m835 | [0m[35m[0m
[30;1m836 | [0m[35m    # box might be nice but would make copying the command much worse[0m
[30;1m837 | [0m[35m    print(instruction_text)[0m
[30;1m838 | [0m[35m[0m
[30;1m839 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m715 | [0m[35m[0m
[30;1m716 | [0m[35mThis will do the following ...[0m
[30;1m717 | [0m[35m1. Create limited IAM roles and grant them to Coiled[0m
[30;1m718 | [0m[35m2. Check and expand your AWS quota if needed[0m
[30;1m719 | [0m[35m3. Create initial resources to deploy clusters[0m
[30;1m720 | [0m[35m[0m
[30;1m721 | [0m[35mThis will [bold]not[/bold] ...[0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m559 | [0m[35m[0m
[30;1m560 | [0m[35m                    return "\n".join(diff_lines)[0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m        # if we couldn't print the short version, just print the raw diff object[0m
[30;1m563 | [0m[35m        return f"{doc_diff}"[0m
[30;1m564 | [0m[35m    else:[0m
[30;1m565 | [0m[35m        return ""[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport traceback[0m
[30;1m4 | [0m[35mfrom typing import Optional, Tuple, Union[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport boto3[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m532 | [0m[35m        "allow_cross_zone": True if kwargs["allow_cross_zone"] is None else kwargs["allow_cross_zone[0m
[30;1m533 | [0m[35m    }[0m
[30;1m534 | [0m[35m[0m
[30;1m535 | [0m[35m    # when task will run on scheduler, give it the same VM specs as worker node[0m
[30;1m536 | [0m[35m    if scheduler_task_ids:[0m
[30;1m537 | [0m[35m        cluster_kwargs = {[0m
[30;1m538 | [0m[35m            **cluster_kwargs,[0m
[30;1m539 | [0m[35m            "scheduler_vm_types": list(kwargs["vm_type"]) if kwargs["vm_type"] else None,[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m505 | [0m[35m        "n_workers": n_task_workers,[0m
[30;1m506 | [0m[35m        "software": kwargs["software"],[0m
[30;1m507 | [0m[35m        "show_widget": True,[0m
[30;1m508 | [0m[35m        # batch job can either run in normal Coiled software env (which defaults to package sync)[0m
[30;1m509 | [0m[35m        # or can run in an extra container (which doesn't need to include dask)[0m
[30;1m510 | [0m[35m        "batch_job_container": kwargs["container"],[0m
[30;1m511 | [0m[35m        # if batch job is running in extra container, then we just need a pretty minimal dask contai[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m446 | [0m[35m        if aws_creds["SessionToken"]:[0m
[30;1m447 | [0m[35m            job_secret_vars["AWS_SESSION_TOKEN"] = aws_creds["SessionToken"][0m
[30;1m448 | [0m[35m    else:[0m
[30;1m449 | [0m[35m        # don't set the ENV on container that makes AWS SDK look out our local endpoint for forwarde[0m
[30;1m450 | [0m[35m        dask.config.set({"coiled.use_aws_creds_endpoint": False})[0m
[30;1m451 | [0m[35m[0m
[30;1m452 | [0m[35m    # identify implicit files referenced by other files[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m342 | [0m[35m    if command[0].endswith(".py"):[0m
[30;1m343 | [0m[35m        command = ["python", *command][0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m    # unescape escaped COILED env vars in command[0m
[30;1m346 | [0m[35m    command = [part.replace("\\$COILED", "$COILED") for part in command][0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m    user_files = [][0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m302 | [0m[35m@click.option([0m
[30;1m303 | [0m[35m    "--host-setup-script",[0m
[30;1m304 | [0m[35m    default=None,[0m
[30;1m305 | [0m[35m    help="Path to local script which will be run on each VM prior to running any tasks.",[0m
[30;1m306 | [0m[35m)[0m
[30;1m307 | [0m[35m@click.argument("command", nargs=-1)[0m
[30;1m308 | [0m[35mdef batch_run_cli(ctx, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m    type=str,[0m
[30;1m231 | [0m[35m    help=([0m
[30;1m232 | [0m[35m        "IP address or CIDR from which connections to port 22 (SSH) are open; "[0m
[30;1m233 | [0m[35m        "can also be specified as 'everyone' (0.0.0.0/0) or 'me' (automatically determines public IP[0m
[30;1m234 | [0m[35m        "for your local client)."[0m
[30;1m235 | [0m[35m    ),[0m
[30;1m236 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m            approx_cloud_cost_per_hour = self._cluster_details.get("cloud_cost_per_hour") or ([0m
[30;1m276 | [0m[35m                self._cluster_details["cost_per_hour"] * 0.05[0m
[30;1m277 | [0m[35m            )[0m
[30;1m278 | [0m[35m            approx_cloud_total = self._cluster_details.get("cloud_total_cost") or ([0m
[30;1m279 | [0m[35m                self._cluster_details["total_cost"] * 0.05[0m
[30;1m280 | [0m[35m            )[0m
[30;1m281 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m        current_loader_frame = self._loader_frames[self._frame][0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m        if self._cluster_details:[0m
[30;1m275 | [0m[35m            approx_cloud_cost_per_hour = self._cluster_details.get("cloud_cost_per_hour") or ([0m
[30;1m276 | [0m[35m                self._cluster_details["cost_per_hour"] * 0.05[0m
[30;1m277 | [0m[35m            )[0m
[30;1m278 | [0m[35m            approx_cloud_total = self._cluster_details.get("cloud_total_cost") or ([0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m.hostname[0m
[30;1m394 | [0m[35m        return rich.panel.Panel([0m
[30;1m395 | [0m[35m            rich.console.Group([0m
[30;1m396 | [0m[35m                "",[0m
[30;1m397 | [0m[35m                *(() if not hostname_line else (hostname_line,)),[0m
[30;1m398 | [0m[35m                f"[bold green]Details: [/bold green]{linked_details_link}",[0m
[30;1m399 | [0m[35m                "",[0m
[30;1m400 | [0m[35m                self._progress.get_renderable(),[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m.hostname[0m
[30;1m394 | [0m[35m        return rich.panel.Panel([0m
[30;1m395 | [0m[35m            rich.console.Group([0m
[30;1m396 | [0m[35m                "",[0m
[30;1m397 | [0m[35m                *(() if not hostname_line else (hostname_line,)),[0m
[30;1m398 | [0m[35m                f"[bold green]Details: [/bold green]{linked_details_link}",[0m
[30;1m399 | [0m[35m                "",[0m
[30;1m400 | [0m[35m                self._progress.get_renderable(),[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m.hostname[0m
[30;1m389 | [0m[35m            formatted_extra_link = ([0m
[30;1m390 | [0m[35m                current_loader_frame if self._extra_link == "..." else f"[link]{self._extra_link}[/l[0m
[30;1m391 | [0m[35m            )[0m
[30;1m392 | [0m[35m            hostname_line = f"[bold green]{self._extra_link_title}: [/bold green]{formatted_extra_li[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m        return rich.panel.Panel([0m
[30;1m395 | [0m[35m            rich.console.Group([0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m.hostname[0m
[30;1m384 | [0m[35m        table.add_column()[0m
[30;1m385 | [0m[35m        table.add_row(config_table, rich.align.Align.right(costing_table))[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m        hostname_line = None[0m
[30;1m388 | [0m[35m        if self._extra_link:[0m
[30;1m389 | [0m[35m            formatted_extra_link = ([0m
[30;1m390 | [0m[35m                current_loader_frame if self._extra_link == "..." else f"[link]{self._extra_link}[/l[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m743 | [0m[35m            rich.layout.Layout(name="configuration"),[0m
[30;1m744 | [0m[35m        )[0m
[30;1m745 | [0m[35m[0m
[30;1m746 | [0m[35m        time = self.last_updated_utc.astimezone(LOCAL_TIMEZONE).strftime("%Y/%m/%d %H:%M:%S %Z")[0m
[30;1m747 | [0m[35m        if show_worker_states:[0m
[30;1m748 | [0m[35m            if self._final_update is None:[0m
[30;1m749 | [0m[35m                layout["progress"].update([0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m457 | [0m[35m        self._stopping_task = progress.add_task("Stopping", total=n_workers)[0m
[30;1m458 | [0m[35m        self._stopped_task = progress.add_task("Stopped", total=n_workers)[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        # In order to make the bar red for errors, the error progress bar is a different instance[0m
[30;1m461 | [0m[35m        # of rich.progress.Progress.[0m
[30;1m462 | [0m[35m        # But we still want this bar aligned with the others, since rich doesn't know these two grou[0m
[30;1m463 | [0m[35m        # are related, it doesn't automatically know how much right-padding to add[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m314 | [0m[35m        )[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m        # It's nice to show both hourly and total cost, but `coiled run` (currently) won't update wi[0m
[30;1m317 | [0m[35m        # while the user's script is running, so total wouldn't change over time and would be unhelp[0m
[30;1m318 | [0m[35m        total_cost = ([0m
[30;1m319 | [0m[35m            [[0m
[30;1m320 | [0m[35m                ([0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m314 | [0m[35m        )[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m        # It's nice to show both hourly and total cost, but `coiled run` (currently) won't update wi[0m
[30;1m317 | [0m[35m        # while the user's script is running, so total wouldn't change over time and would be unhelp[0m
[30;1m318 | [0m[35m        total_cost = ([0m
[30;1m319 | [0m[35m            [[0m
[30;1m320 | [0m[35m                ([0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m313 | [0m[35m            ("[bold green]VM Type:[/bold green]", rich.align.Align.left(f"{scheduler_instance_type}"[0m
[30;1m314 | [0m[35m        )[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m        # It's nice to show both hourly and total cost, but `coiled run` (currently) won't update wi[0m
[30;1m317 | [0m[35m        # while the user's script is running, so total wouldn't change over time and would be unhelp[0m
[30;1m318 | [0m[35m        total_cost = ([0m
[30;1m319 | [0m[35m            [[0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35mdef format_seconds(seconds, decimals=0, variant="long"):[0m
[30;1m92 | [0m[35m    """[0m
[30;1m93 | [0m[35m    Format a number of seconds into a human-readable time delta.[0m
[30;1m94 | [0m[35m    ported from formatSeconds in frontend/src/utils/index.ts[0m
[30;1m95 | [0m[35m    """[0m
[30;1m96 | [0m[35m    is_long = variant == "long"[0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m531 | [0m[35m            self._final_update = final_update[0m
[30;1m532 | [0m[35m[0m
[30;1m533 | [0m[35m        # We explicitly refresh to make sure updated info is shown.[0m
[30;1m534 | [0m[35m        # (Bad timing can lead auto-refresh to not show the update before we stop.)[0m
[30;1m535 | [0m[35m        self.live.refresh()[0m
[30;1m536 | [0m[35m[0m
[30;1m537 | [0m[35m    def _ipython_display_(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m313 | [0m[35m            ("[bold green]VM Type:[/bold green]", rich.align.Align.left(f"{scheduler_instance_type}"[0m
[30;1m314 | [0m[35m        )[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m        # It's nice to show both hourly and total cost, but `coiled run` (currently) won't update wi[0m
[30;1m317 | [0m[35m        # while the user's script is running, so total wouldn't change over time and would be unhelp[0m
[30;1m318 | [0m[35m        total_cost = ([0m
[30;1m319 | [0m[35m            [[0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/rich.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m263 | [0m[35m            self._final_update = final_update[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        # We explicitly refresh to make sure updated info is shown.[0m
[30;1m266 | [0m[35m        # (Bad timing can lead auto-refresh to not show the update before we stop.)[0m
[30;1m267 | [0m[35m        self.live.refresh()[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    def _get_renderable(self) -> rich.console.RenderableType:[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m868 | [0m[35m        {[0m
[30;1m869 | [0m[35m            "name": "In-use IP addresses",[0m
[30;1m870 | [0m[35m            "explanation": "one per VM",[0m
[30;1m871 | [0m[35m            "value": existing_quotas.get("IN_USE_ADDRESSES"),[0m
[30;1m872 | [0m[35m            "unit": "addresses",[0m
[30;1m873 | [0m[35m        },[0m
[30;1m874 | [0m[35m    ][0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m862 | [0m[35m        {[0m
[30;1m863 | [0m[35m            "name": "Persistent Disk SSD",[0m
[30;1m864 | [0m[35m            "explanation": "at least 40GB required per VM",[0m
[30;1m865 | [0m[35m            "value": existing_quotas.get("SSD_TOTAL_GB"),[0m
[30;1m866 | [0m[35m            "unit": "GB",[0m
[30;1m867 | [0m[35m        },[0m
[30;1m868 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m856 | [0m[35m        {[0m
[30;1m857 | [0m[35m            "name": "CPUs",[0m
[30;1m858 | [0m[35m            "explanation": "vCPUs per VM * number of VMs",[0m
[30;1m859 | [0m[35m            "value": existing_quotas.get("CPUS"),[0m
[30;1m860 | [0m[35m            "unit": "vCPU",[0m
[30;1m861 | [0m[35m        },[0m
[30;1m862 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m797 | [0m[35m        coiled.add_interaction(action="prompt:CoiledSetup", success=False)[0m
[30;1m798 | [0m[35m[0m
[30;1m799 | [0m[35m        setup_url = ([0m
[30;1m800 | [0m[35m            f"{dask.config.get('coiled.server', coiled.utils.COILED_SERVER)}/"[0m
[30;1m801 | [0m[35m            f"{coiled_account}/settings/setup/credentials"[0m
[30;1m802 | [0m[35m        )[0m
[30;1m803 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m840 | [0m[35m                "We've configured the data access service account with scope for "[0m
[30;1m841 | [0m[35m                "submitting logs and for accessing Google Storage. If you wish to "[0m
[30;1m842 | [0m[35m                "add or remove permissions attached to your Coiled clusters for "[0m
[30;1m843 | [0m[35m                "accessing data, you can do that at \n"[0m
[30;1m844 | [0m[35m                "\n"[0m
[30;1m845 | [0m[35m                f"[link]{data_role_console_link}[/link]."[0m
[30;1m846 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m820 | [0m[35m                f"1. Go to [link]{setup_url}[/link] and select GCP.\n"[0m
[30;1m821 | [0m[35m                "\n"[0m
[30;1m822 | [0m[35m                f"2. The credential file for [green]{main_sa}[/green] has been saved "[0m
[30;1m823 | [0m[35m                f"on your local computer at \n"[0m
[30;1m824 | [0m[35m                f"     {key_path}\n"[0m
[30;1m825 | [0m[35m                f"   Choose this file for the "[0m
[30;1m826 | [0m[35m                f"[bold]cluster-creation service account[/bold].\n"[0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m902 | [0m[35m                "\n"[0m
[30;1m903 | [0m[35m                "The default Coiled instance type ([bold]e2-standard-4[/bold]) has [bold]4 vCPUs[/bo[0m
[30;1m904 | [0m[35m                "so a 10 worker cluster (plus scheduler) would require [bold]44 vCPUs[/bold], "[0m
[30;1m905 | [0m[35m                "[bold]440 GB[/bold] Persistent Disk SSD, and [bold]11 IP addresses[/bold].\n"[0m
[30;1m906 | [0m[35m                "\n"[0m
[30;1m907 | [0m[35m                f"For [bold]{project}[/bold] (project) in [bold]{region}[/bold] "[0m
[30;1m908 | [0m[35m                f"you can view the current quotas and request increases in the [link={url}]Google Cl[0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m866 | [0m[35m            "unit": "GB",[0m
[30;1m867 | [0m[35m        },[0m
[30;1m868 | [0m[35m        {[0m
[30;1m869 | [0m[35m            "name": "In-use IP addresses",[0m
[30;1m870 | [0m[35m            "explanation": "one per VM",[0m
[30;1m871 | [0m[35m            "value": existing_quotas.get("IN_USE_ADDRESSES"),[0m
[30;1m872 | [0m[35m            "unit": "addresses",[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m838 | [0m[35m                "delete this if you wish.\n"[0m
[30;1m839 | [0m[35m                "\n"[0m
[30;1m840 | [0m[35m                "We've configured the data access service account with scope for "[0m
[30;1m841 | [0m[35m                "submitting logs and for accessing Google Storage. If you wish to "[0m
[30;1m842 | [0m[35m                "add or remove permissions attached to your Coiled clusters for "[0m
[30;1m843 | [0m[35m                "accessing data, you can do that at \n"[0m
[30;1m844 | [0m[35m                "\n"[0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m837 | [0m[35m                "longer need the credential file on your local computer and can "[0m
[30;1m838 | [0m[35m                "delete this if you wish.\n"[0m
[30;1m839 | [0m[35m                "\n"[0m
[30;1m840 | [0m[35m                "We've configured the data access service account with scope for "[0m
[30;1m841 | [0m[35m                "submitting logs and for accessing Google Storage. If you wish to "[0m
[30;1m842 | [0m[35m                "add or remove permissions attached to your Coiled clusters for "[0m
[30;1m843 | [0m[35m                "accessing data, you can do that at \n"[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m823 | [0m[35m                f"on your local computer at \n"[0m
[30;1m824 | [0m[35m                f"     {key_path}\n"[0m
[30;1m825 | [0m[35m                f"   Choose this file for the "[0m
[30;1m826 | [0m[35m                f"[bold]cluster-creation service account[/bold].\n"[0m
[30;1m827 | [0m[35m                "\n"[0m
[30;1m828 | [0m[35m                f"3. Enter [green]{data_email}[/green] as the [bold]data access "[0m
[30;1m829 | [0m[35m                f"service account[/bold].\n"[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m815 | [0m[35m                "You've successfully created service accounts for Coiled "[0m
[30;1m816 | [0m[35m                "in your Google Cloud project. "[0m
[30;1m817 | [0m[35m                "You can now complete your Coiled account setup by telling "[0m
[30;1m818 | [0m[35m                "us how to use these service accounts:\n"[0m
[30;1m819 | [0m[35m                "\n"[0m
[30;1m820 | [0m[35m                f"1. Go to [link]{setup_url}[/link] and select GCP.\n"[0m
[30;1m821 | [0m[35m                "\n"[0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m812 | [0m[35m[0m
[30;1m813 | [0m[35m        print([0m
[30;1m814 | [0m[35m            Panel([0m
[30;1m815 | [0m[35m                "You've successfully created service accounts for Coiled "[0m
[30;1m816 | [0m[35m                "in your Google Cloud project. "[0m
[30;1m817 | [0m[35m                "You can now complete your Coiled account setup by telling "[0m
[30;1m818 | [0m[35m                "us how to use these service accounts:\n"[0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m720 | [0m[35m        print()[0m
[30;1m721 | [0m[35m        print("[bold]You can setup Coiled to use the Google Cloud credentials you just created.")[0m
[30;1m722 | [0m[35m        print([0m
[30;1m723 | [0m[35m            "The service account key will go to Coiled, where it will be stored "[0m
[30;1m724 | [0m[35m            "securely and used to create clusters in your Google Cloud account "[0m
[30;1m725 | [0m[35m            "on your behalf."[0m
[30;1m726 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m686 | [0m[35m    for service in services:[0m
[30;1m687 | [0m[35m        print(f"  {service}")[0m
[30;1m688 | [0m[35m        if not gcloud_enable_service(service, project):[0m
[30;1m689 | [0m[35m            setup_failure(f"Enabling service {service} failed", backend="gcp")[0m
[30;1m690 | [0m[35m            return False[0m
[30;1m691 | [0m[35m    if enable_log_sink_permissions:[0m
[30;1m692 | [0m[35m        print("  orgpolicy.googleapis.com")[0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m683 | [0m[35m    if enable_gar:[0m
[30;1m684 | [0m[35m        services.append("artifactregistry.googleapis.com")[0m
[30;1m685 | [0m[35m[0m
[30;1m686 | [0m[35m    for service in services:[0m
[30;1m687 | [0m[35m        print(f"  {service}")[0m
[30;1m688 | [0m[35m        if not gcloud_enable_service(service, project):[0m
[30;1m689 | [0m[35m            setup_failure(f"Enabling service {service} failed", backend="gcp")[0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m614 | [0m[35m        f"IAM Role:\t\t[green]{main_role}[/green] "[0m
[30;1m615 | [0m[35m        f"(for [green]{main_sa}[/green] service account)\n"[0m
[30;1m616 | [0m[35m        f"IAM Role:\t\t[green]{data_role}[/green] "[0m
[30;1m617 | [0m[35m        f"(for [green]{data_sa}[/green] service account)"[0m
[30;1m618 | [0m[35m    )[0m
[30;1m619 | [0m[35m[0m
[30;1m620 | [0m[35m    if enable_gar:[0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m612 | [0m[35m        f"Service account for creating clusters:\t[green]{main_sa}[/green]\n"[0m
[30;1m613 | [0m[35m        f"Service account for data access:\t[green]{data_sa}[/green]\n"[0m
[30;1m614 | [0m[35m        f"IAM Role:\t\t[green]{main_role}[/green] "[0m
[30;1m615 | [0m[35m        f"(for [green]{main_sa}[/green] service account)\n"[0m
[30;1m616 | [0m[35m        f"IAM Role:\t\t[green]{data_role}[/green] "[0m
[30;1m617 | [0m[35m        f"(for [green]{data_sa}[/green] service account)"[0m
[30;1m618 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m430 | [0m[35m    "--enable-log-sink-permissions/--ignore-log-sink-permissions",[0m
[30;1m431 | [0m[35m    default=True,[0m
[30;1m432 | [0m[35m    is_flag=True,[0m
[30;1m433 | [0m[35m    help="Temporarily adjust organization policy so that service account for log sink can be granted[0m
[30;1m434 | [0m[35m)[0m
[30;1m435 | [0m[35m@click.option([0m
[30;1m436 | [0m[35m    "--manual-final-setup",[0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m392 | [0m[35m    command = [gcloud_path, "artifacts", "repositories", "describe", "coiled", "--location", region][0m
[30;1m393 | [0m[35m    t0 = time.time()[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m    # keep checking if service account has access to artifact registry[0m
[30;1m396 | [0m[35m    while True:[0m
[30;1m397 | [0m[35m        p = subprocess.run(command, capture_output=True)[0m
[30;1m398 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m379 | [0m[35m    # keep track of currently active account (for local `gcloud`) so we can switch back[0m
[30;1m380 | [0m[35m    previous_account = get_gcloud_config("account")[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m    # activate the service account we made --[0m
[30;1m383 | [0m[35m    # subsequent `gcloud` calls with be using those creds[0m
[30;1m384 | [0m[35m    gcloud_wrapper([0m
[30;1m385 | [0m[35m        ["auth", "activate-service-account", "--key-file", key_path],[0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35mdef gcloud_wait_for_repo(region: str, key_path: str) -> bool:[0m
[30;1m375 | [0m[35m    # it takes a while to give the service account (which we created)[0m
[30;1m376 | [0m[35m    # access to the artifact registry[0m
[30;1m377 | [0m[35m    # this function waits (with timeout) until that's ready[0m
[30;1m378 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35mDATA_ROLE = """[0m
[30;1m135 | [0m[35mtitle: coiled-data[0m
[30;1m136 | [0m[35mdescription: service account attached to cluster instances for data access[0m
[30;1m137 | [0m[35mstage: GA[0m
[30;1m138 | [0m[35mincludedPermissions:[0m
[30;1m139 | [0m[35m- logging.logEntries.create[0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport shutil[0m
[30;1m5 | [0m[35mimport subprocess[0m
[30;1m6 | [0m[35mimport sys[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom typing import List, Optional[0m
[30;1m9 | [0m[35mfrom urllib.parse import quote[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mimport click[0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/azure_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m            json_output=True,[0m
[30;1m57 | [0m[35m        )[0m
[30;1m58 | [0m[35m        lines.extend(response["lines"])[0m
[30;1m59 | [0m[35m        token = response.get("back", response.get("next"))[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    return sorted(lines, key=lambda line: line["timestamp"])[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/azure_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m            json_output=True,[0m
[30;1m57 | [0m[35m        )[0m
[30;1m58 | [0m[35m        lines.extend(response["lines"])[0m
[30;1m59 | [0m[35m        token = response.get("back", response.get("next"))[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    return sorted(lines, key=lambda line: line["timestamp"])[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/azure_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        print(response["error"])[0m
[30;1m43 | [0m[35m        return [][0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    token = response.get("back", response.get("next"))[0m
[30;1m46 | [0m[35m    lines = [][0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    while token:[0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/azure_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        print(response["error"])[0m
[30;1m43 | [0m[35m        return [][0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    token = response.get("back", response.get("next"))[0m
[30;1m46 | [0m[35m    lines = [][0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    while token:[0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/azure_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    url = f"{cloud.server}/api/v2/logs/cluster/{cluster_id}/init"[0m
[30;1m39 | [0m[35m    response = curl.sync_request(cloud=cloud, url=url, method="get", data={}, json_output=True)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    if response.get("error"):[0m
[30;1m42 | [0m[35m        print(response["error"])[0m
[30;1m43 | [0m[35m        return [][0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/azure_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport coiled[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom .. import curl[0m
[30;1m7 | [0m[35mfrom ..utils import CONTEXT_SETTINGS[0m
[30;1m8 | [0m[35mfrom .better_logs import format_log_event[0m
[30;1m9 | [0m[35mfrom .utils import find_cluster[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/examples/nyc_parquet.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35ms3://coiled-data/uber/[0m
[30;1m19 | [0m[35m```[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mLet's run this Python script to calculate how much Uber/Lyft riders paid vs[0m
[30;1m22 | [0m[35mhow much Uber/Lyft drivers got paid in NYC.\n[0m
[30;1m23 | [0m[35m""".strip()[0m
[30;1m24 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/list.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m        if not response:[0m
[30;1m105 | [0m[35m            return [][0m
[30;1m106 | [0m[35m        else:[0m
[30;1m107 | [0m[35m            return response.get("items", [])[0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/v2/widgets/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    If the instance type is still not determined, will show "Unknown".[0m
[30;1m39 | [0m[35m    """[0m
[30;1m40 | [0m[35m    scheduler_instance_type = SCHEDULER_SEARCH.search(cluster_details) or None[0m
[30;1m41 | [0m[35m    worker_instance_types = Counter(w.get("instance_type_id", None) for w in WORKER_SEARCH.search(cl[0m
[30;1m42 | [0m[35m    return scheduler_instance_type, worker_instance_types[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m664 | [0m[35m    except ClientAuthenticationError:[0m
[30;1m665 | [0m[35m        return None[0m
[30;1m666 | [0m[35m    with httpx.Client(http2=True) as client:[0m
[30;1m667 | [0m[35m        result = client.get([0m
[30;1m668 | [0m[35m            "https://graph.microsoft.com/v1.0/me?$select=id,userPrincipalName",[0m
[30;1m669 | [0m[35m            headers={"Authorization": f"Bearer {token_creds.token}"},[0m
[30;1m670 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m527 | [0m[35m        print("(there's no associated cost, this just enables these services for use in the Azure su[0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35m        for provider in REQUIRED_PROVIDERS:[0m
[30;1m530 | [0m[35m            if registered.get(provider):[0m
[30;1m531 | [0m[35m                print(f"  [bright_black]{provider} already registered")[0m
[30;1m532 | [0m[35m            else:[0m
[30;1m533 | [0m[35m                print(f"  Enabling [green]{provider}[/green]... ", end="")[0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m518 | [0m[35mdef enable_providers(credentials, sub_id):[0m
[30;1m519 | [0m[35m    resource_client = ResourceManagementClient(credentials, sub_id)  # pyright: ignore[reportPossibl[0m
[30;1m520 | [0m[35m    registered = {[0m
[30;1m521 | [0m[35m        provider: resource_client.providers.get(provider).registration_state == "Registered"[0m
[30;1m522 | [0m[35m        for provider in REQUIRED_PROVIDERS[0m
[30;1m523 | [0m[35m    }[0m
[30;1m524 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m.userInfo[0m
[30;1m657 | [0m[35m            return[0m
[30;1m658 | [0m[35m[0m
[30;1m659 | [0m[35m[0m
[30;1m660 | [0m[35mdef whoami(local_credentials):[0m
[30;1m661 | [0m[35m    try:[0m
[30;1m662 | [0m[35m        # note that this prints error if there aren't creds[0m
[30;1m663 | [0m[35m        token_creds = local_credentials.get_token("https://graph.microsoft.com/.default")[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m.userInfo[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35m[0m
[30;1m590 | [0m[35mdef ship_token_creds(local_credentials, coiled_account, sub_id, rg_name, region):[0m
[30;1m591 | [0m[35m    azure_user = whoami(local_credentials)[0m
[30;1m592 | [0m[35m[0m
[30;1m593 | [0m[35m    creds_to_submit, expiration = get_temporary_creds_to_submit(local_credentials)[0m
[30;1m594 | [0m[35m    last_refresh = datetime.datetime.now(tz=datetime.timezone.utc)[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m.userInfo[0m
[30;1m228 | [0m[35m        return[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m    creds = DefaultAzureCredential()  # pyright: ignore[reportPossiblyUnboundVariable][0m
[30;1m231 | [0m[35m    if not whoami(creds):[0m
[30;1m232 | [0m[35m        print()[0m
[30;1m233 | [0m[35m        print("[red]Unable to find local Azure credentials")[0m
[30;1m234 | [0m[35m        print("We recommend using the Azure CLI to configure your local Azure credentials")[0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m652 | [0m[35m            print([0m
[30;1m653 | [0m[35m                "Temporary access to your Azure resources will no longer be refreshed.\n"[0m
[30;1m654 | [0m[35m                f"Unless you restart the process to refresh access, any running clusters will be aut[0m
[30;1m655 | [0m[35m                f"5 minutes before the current access token expires at {expiration:%c %Z}."[0m
[30;1m656 | [0m[35m            )[0m
[30;1m657 | [0m[35m            return[0m
[30;1m658 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m612 | [0m[35m    with Live(display) as live:[0m
[30;1m613 | [0m[35m        try:[0m
[30;1m614 | [0m[35m            while True:[0m
[30;1m615 | [0m[35m                # update temporary credentials if they'll expire within 7 minutes[0m
[30;1m616 | [0m[35m                soon = datetime.datetime.now(tz=datetime.timezone.utc) + datetime.timedelta(minutes=[0m
[30;1m617 | [0m[35m                if expiration < soon:[0m
[30;1m618 | [0m[35m                    creds_to_submit, expiration = get_temporary_creds_to_submit(local_credentials)[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m547 | [0m[35m        f"in [bold]{remaining_time.seconds // 60} minutes[/bold]" if active else f"at [bold]{expirat[0m
[30;1m548 | [0m[35m    )[0m
[30;1m549 | [0m[35m    last_refresh_message = ([0m
[30;1m550 | [0m[35m        f"{refresh_since.seconds // 60}m{refresh_since.seconds % 60}s ago at {last_refresh:%c %Z}"[0m
[30;1m551 | [0m[35m        if active[0m
[30;1m552 | [0m[35m        else f"{last_refresh:%c %Z}"[0m
[30;1m553 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m346 | [0m[35m        print(f"  [bright_black]Creating/updating role definition {LOG_ROLE_NAME}...")[0m
[30;1m347 | [0m[35m        az_cli_wrapper([0m
[30;1m348 | [0m[35m            f"az role definition create --role-definition @{log_role_def_path}",[0m
[30;1m349 | [0m[35m            command_if_exists=f"az role definition update --role-definition @{log_role_def_path}",[0m
[30;1m350 | [0m[35m        )[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m    print(f"  [bright_black]Assigning '{RG_ROLE_NAME}' role to service principal on '{rg_name}' reso[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        az_cli_wrapper([0m
[30;1m343 | [0m[35m            f"az role definition create --role-definition @{role_def_path}",[0m
[30;1m344 | [0m[35m            command_if_exists=f"az role definition update --role-definition @{role_def_path}",[0m
[30;1m345 | [0m[35m        )[0m
[30;1m346 | [0m[35m        print(f"  [bright_black]Creating/updating role definition {LOG_ROLE_NAME}...")[0m
[30;1m347 | [0m[35m        az_cli_wrapper([0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m45 | [0m[35m    return {[0m
[30;1m46 | [0m[35m        "Name": f"{RG_ROLE_NAME}",[0m
[30;1m47 | [0m[35m        "IsCustom": True,[0m
[30;1m48 | [0m[35m        "Description": "Setup and ongoing Coiled permissions required at resource group scope",[0m
[30;1m49 | [0m[35m        "Actions": [[0m
[30;1m50 | [0m[35m            "Microsoft.Compute/*/read",[0m
[30;1m51 | [0m[35m            "Microsoft.Compute/virtualMachines/delete",[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m    print(f"  [bright_black]Assigning '{RG_ROLE_NAME}' role to service principal on '{rg_name}' reso[0m
[30;1m353 | [0m[35m    az_cli_wrapper(f"az role assignment create --role '{RG_ROLE_NAME}' --scope {rg_id} --assignee {s[0m
[30;1m354 | [0m[35m    print(f"  [bright_black]Assigning '{LOG_ROLE_NAME}' role to service principal on '{rg_name}' res[0m
[30;1m355 | [0m[35m    az_cli_wrapper(f"az role assignment create --role '{LOG_ROLE_NAME}' --scope {rg_id} --assignee {[0m
[30;1m356 | [0m[35m[0m
[30;1m357 | [0m[35m    creds_to_submit = {[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m349 | [0m[35m            command_if_exists=f"az role definition update --role-definition @{log_role_def_path}",[0m
[30;1m350 | [0m[35m        )[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m    print(f"  [bright_black]Assigning '{RG_ROLE_NAME}' role to service principal on '{rg_name}' reso[0m
[30;1m353 | [0m[35m    az_cli_wrapper(f"az role assignment create --role '{RG_ROLE_NAME}' --scope {rg_id} --assignee {s[0m
[30;1m354 | [0m[35m    print(f"  [bright_black]Assigning '{LOG_ROLE_NAME}' role to service principal on '{rg_name}' res[0m
[30;1m355 | [0m[35m    az_cli_wrapper(f"az role assignment create --role '{LOG_ROLE_NAME}' --scope {rg_id} --assignee {[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m321 | [0m[35m    app_creds_json = az_cli_wrapper(f"az ad app credential reset --id {app_id} {cred_reset_opts}")[0m
[30;1m322 | [0m[35m    app_creds = json.loads(app_creds_json)[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m    print(f"  [bright_black]Creating service principal for {app_name} ({app_id})...")[0m
[30;1m325 | [0m[35m    sp_id = strip_output([0m
[30;1m326 | [0m[35m        az_cli_wrapper([0m
[30;1m327 | [0m[35m            f"az ad sp create --id {app_id} --query id",[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35mdef setup_with_service_principal([0m
[30;1m304 | [0m[35m    creds, app_name, sub_id, rg_name, rg_id, coiled_account, region, keep_existing_keys: bool = Fals[0m
[30;1m305 | [0m[35m):[0m
[30;1m306 | [0m[35m    prompt = f"Create [green]{app_name}[/green] service principal and grant Coiled access to your Az[0m
[30;1m307 | [0m[35m    if not Confirm.ask(prompt, default=True):[0m
[30;1m308 | [0m[35m        coiled.add_interaction(action="prompt:Setup_Azure", success=False)[0m
[30;1m309 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m    creds = DefaultAzureCredential()  # pyright: ignore[reportPossiblyUnboundVariable][0m
[30;1m231 | [0m[35m    if not whoami(creds):[0m
[30;1m232 | [0m[35m        print()[0m
[30;1m233 | [0m[35m        print("[red]Unable to find local Azure credentials")[0m
[30;1m234 | [0m[35m        print("We recommend using the Azure CLI to configure your local Azure credentials")[0m
[30;1m235 | [0m[35m        if not has_az_cli:[0m
[30;1m236 | [0m[35m            print([0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m    if not ship_token and not has_az_cli:[0m
[30;1m217 | [0m[35m        print()[0m
[30;1m218 | [0m[35m        print("[red]Missing requirement[/red] Unable to find the [green]az[/green] Azure CLI, which [0m
[30;1m219 | [0m[35m        print([0m
[30;1m220 | [0m[35m            "See [link=https://learn.microsoft.com/en-us/cli/azure/install-azure-cli]"[0m
[30;1m221 | [0m[35m            "https://learn.microsoft.com/en-us/cli/azure/install-azure-cli[/link] "[0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m    if not ship_token and not has_az_cli:[0m
[30;1m217 | [0m[35m        print()[0m
[30;1m218 | [0m[35m        print("[red]Missing requirement[/red] Unable to find the [green]az[/green] Azure CLI, which [0m
[30;1m219 | [0m[35m        print([0m
[30;1m220 | [0m[35m            "See [link=https://learn.microsoft.com/en-us/cli/azure/install-azure-cli]"[0m
[30;1m221 | [0m[35m            "https://learn.microsoft.com/en-us/cli/azure/install-azure-cli[/link] "[0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m    is_flag=True,[0m
[30;1m170 | [0m[35m    default=False,[0m
[30;1m171 | [0m[35m    help=([0m
[30;1m172 | [0m[35m        "Instead of using a service principal to grant long-term access to your Azure account, this [0m
[30;1m173 | [0m[35m        "(and refresh) temporary OAuth tokens so that Coiled can operate in your Azure account as yo[0m
[30;1m174 | [0m[35m        "Not recommended for long-term Coiled use, but can be helpful if you don't want to (or can't[0m
[30;1m175 | [0m[35m        "service principal for Coiled to use."[0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35mTENANT=$(jq -r '.tenant' app-creds.json)[0m
[30;1m113 | [0m[35mSETUP_ENDPOINT=/api/v2/cloud-credentials/${COILED_ACCOUNT}/azure[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35mcoiled curl -X POST "${SETUP_ENDPOINT}" --json --data "{\\"credentials\\": {\\"tenant_id\\": \\"${TE[0m
[30;1m116 | [0m[35m"""  # noqa: E501[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    return f"{header}\n{body}"[0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35maz role definition create --role-definition ./coiled-resource-group-role.json[0m
[30;1m102 | [0m[35maz role definition create --role-definition ./coiled-log-access-role.json[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m# grant service principle access to the resource group[0m
[30;1m105 | [0m[35maz role assignment create --role "Coiled Resource Group Role" --scope $RG_ID --assignee $(cat sp-id.[0m
[30;1m106 | [0m[35maz role assignment create --role "Coiled Log Access" --scope $RG_ID --assignee $(cat sp-id.txt)[0m
[30;1m107 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m# create app, creds, and service principal[0m
[30;1m95 | [0m[35maz ad app create --display-name $APP_NAME --query "id" | tr -d '"' > app-id.txt[0m
[30;1m96 | [0m[35maz ad app credential reset --id $(cat app-id.txt) | tee app-creds.json[0m
[30;1m97 | [0m[35maz ad sp create --id $(cat app-id.txt) --query "id" | tr -d '"' > sp-id.txt[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m# create roles[0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m# log in if necessary[0m
[30;1m92 | [0m[35maz ad signed-in-user show 2>&1 1>\\dev\\null || az login[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m# create app, creds, and service principal[0m
[30;1m95 | [0m[35maz ad app create --display-name $APP_NAME --query "id" | tr -d '"' > app-id.txt[0m
[30;1m96 | [0m[35maz ad app credential reset --id $(cat app-id.txt) | tee app-creds.json[0m
[30;1m97 | [0m[35maz ad sp create --id $(cat app-id.txt) --query "id" | tr -d '"' > sp-id.txt[0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport shutil[0m
[30;1m6 | [0m[35mimport subprocess[0m
[30;1m7 | [0m[35mimport sys[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom typing import Optional[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mimport click[0m
[30;1m12 | [0m[35mimport httpx[0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m    if name == "config":[0m
[30;1m60 | [0m[35m        import dask.config[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        return dask.config.get("coiled")[0m
[30;1m63 | [0m[35m    raise AttributeError(f"module '{__name__}' has no attribute '{name}'")[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Get function backing "coiled install" command[0m
[30;1m2 | [0m[35m# Get function backing "coiled env inspect" command[0m
[30;1m3 | [0m[35mfrom importlib_metadata import version[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom .batch import run as batch_run[0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m        self.subdir: str = meta_json["subdir"][0m
[30;1m202 | [0m[35m        self.files: str = meta_json["files"][0m
[30;1m203 | [0m[35m        self.depends: List[str] = meta_json.get("depends", [])[0m
[30;1m204 | [0m[35m        self.constrains: List[str] = meta_json.get("constrains", [])[0m
[30;1m205 | [0m[35m        self.channel, self.channel_url = parse_conda_channel(self.name, meta_json["channel"], self.s[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m    def __repr__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m        self.version: str = meta_json["version"][0m
[30;1m201 | [0m[35m        self.subdir: str = meta_json["subdir"][0m
[30;1m202 | [0m[35m        self.files: str = meta_json["files"][0m
[30;1m203 | [0m[35m        self.depends: List[str] = meta_json.get("depends", [])[0m
[30;1m204 | [0m[35m        self.constrains: List[str] = meta_json.get("constrains", [])[0m
[30;1m205 | [0m[35m        self.channel, self.channel_url = parse_conda_channel(self.name, meta_json["channel"], self.s[0m
[30;1m206 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/types.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m378 | [0m[35m    keypair_name[0m
[30;1m379 | [0m[35m        AWS Keypair to assign worker/scheduler instances. This would need to be an existing keypair [0m
[30;1m380 | [0m[35m            account, and needs to be in the same region as your cluster. Note that Coiled can also m[0m
[30;1m381 | [0m[35m            adding a unique, ephemeral keypair for SSH access to your cluster;[0m
[30;1m382 | [0m[35m            see :doc:`ssh` for more information.[0m
[30;1m383 | [0m[35m    use_placement_group[0m
[30;1m384 | [0m[35m        If possible, this will attempt to put workers in the same cluster placement group (in theory[0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/types.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m343 | [0m[35m    use_dashboard_public_ip[0m
[30;1m344 | [0m[35m        Public IP is used by default, lets you choose to use private IP for dashboard link.[0m
[30;1m345 | [0m[35m    use_dashboard_https[0m
[30;1m346 | [0m[35m        When public IP address is used for dashboard, we'll enable HTTPS + auth by default.[0m
[30;1m347 | [0m[35m        You may want to disable this if using something that needs to connect directly to[0m
[30;1m348 | [0m[35m        the scheduler dashboard without authentication, such as jupyter dask-labextension.[0m
[30;1m349 | [0m[35m    network_volumes[0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/types.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m341 | [0m[35m        (usually pennies per GB), so this is a bad choice for shuffle-heavy workloads, but can be a [0m
[30;1m342 | [0m[35m        choice for large embarrassingly parallel workloads.[0m
[30;1m343 | [0m[35m    use_dashboard_public_ip[0m
[30;1m344 | [0m[35m        Public IP is used by default, lets you choose to use private IP for dashboard link.[0m
[30;1m345 | [0m[35m    use_dashboard_https[0m
[30;1m346 | [0m[35m        When public IP address is used for dashboard, we'll enable HTTPS + auth by default.[0m
[30;1m347 | [0m[35m        You may want to disable this if using something that needs to connect directly to[0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/types.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m341 | [0m[35m        (usually pennies per GB), so this is a bad choice for shuffle-heavy workloads, but can be a [0m
[30;1m342 | [0m[35m        choice for large embarrassingly parallel workloads.[0m
[30;1m343 | [0m[35m    use_dashboard_public_ip[0m
[30;1m344 | [0m[35m        Public IP is used by default, lets you choose to use private IP for dashboard link.[0m
[30;1m345 | [0m[35m    use_dashboard_https[0m
[30;1m346 | [0m[35m        When public IP address is used for dashboard, we'll enable HTTPS + auth by default.[0m
[30;1m347 | [0m[35m        You may want to disable this if using something that needs to connect directly to[0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/types.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m        List of ports to open to cidr on the scheduler.[0m
[30;1m304 | [0m[35m        For example, ``[22, 8786]`` opens port 22 for SSH and 8786 for client to Dask connection.[0m
[30;1m305 | [0m[35m    cidr[0m
[30;1m306 | [0m[35m        CIDR block from which to allow access. For example ``0.0.0.0/0`` allows access from any IP a[0m
[30;1m307 | [0m[35m    """[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35m    ports: List[int][0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/types.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m301 | [0m[35m    ----------[0m
[30;1m302 | [0m[35m    ports[0m
[30;1m303 | [0m[35m        List of ports to open to cidr on the scheduler.[0m
[30;1m304 | [0m[35m        For example, ``[22, 8786]`` opens port 22 for SSH and 8786 for client to Dask connection.[0m
[30;1m305 | [0m[35m    cidr[0m
[30;1m306 | [0m[35m        CIDR block from which to allow access. For example ``0.0.0.0/0`` allows access from any IP a[0m
[30;1m307 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/amp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    # check for existing workspace matching the name[0m
[30;1m129 | [0m[35m    result = None[0m
[30;1m130 | [0m[35m    existing = amp.list_workspaces().get("workspaces", [])[0m
[30;1m131 | [0m[35m    for workspace in existing:[0m
[30;1m132 | [0m[35m        if workspace["alias"] == name:[0m
[30;1m133 | [0m[35m            result = workspace[0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/amp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m    sts = session.client("sts")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    identity = sts.get_caller_identity()[0m
[30;1m57 | [0m[35m    account = identity.get("Account")[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    amp_arn, workspace_id = make_amp_workspace(session, name, region)[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m759 | [0m[35m                    if forward_gcp_adc:[0m
[30;1m760 | [0m[35m                        gcp_creds_to_forward = send_application_default_credentials(cluster, return_[0m
[30;1m761 | [0m[35m                        if gcp_creds_to_forward:[0m
[30;1m762 | [0m[35m                            runtime_env_dict = {**gcp_creds_to_forward.get("env", {}), **runtime_env[0m
[30;1m763 | [0m[35m[0m
[30;1m764 | [0m[35m                    _connection, _container_command, results = run_via_ssh([0m
[30;1m765 | [0m[35m                        cloud=cloud,[0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m.hostname[0m
[30;1m427 | [0m[35m        "Format is ``KEY=val``, multiple vars can be set with separate ``--env`` for each."[0m
[30;1m428 | [0m[35m    ),[0m
[30;1m429 | [0m[35m)[0m
[30;1m430 | [0m[35m@click.option("--subdomain", default=None, help="Custom subdomain for the VM hostname.")[0m
[30;1m431 | [0m[35m@click.option([0m
[30;1m432 | [0m[35m    "--allow-ssh-from",[0m
[30;1m433 | [0m[35m    default="me",[0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m716 | [0m[35m                }[0m
[30;1m717 | [0m[35m                cluster_kwargs["name"] = name or f"run-{short_random_string()}"[0m
[30;1m718 | [0m[35m                cluster_kwargs["cloud"] = cloud[0m
[30;1m719 | [0m[35m                cluster_kwargs["custom_widget"] = widget  # `Cluster` will update widget until it's [0m
[30;1m720 | [0m[35m[0m
[30;1m721 | [0m[35m                if no_credential_forwarding:[0m
[30;1m722 | [0m[35m                    cluster_kwargs["credentials"] = None[0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m733 | [0m[35m                    runtime_env_dict["DASK_COILED__SOFTWARE_IS_GPU_CLUSTER"] = cluster._is_gpu_clust[0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35m                    # by default "shutdown on close" is also what enables "keepalive" timeout on clu[0m
[30;1m736 | [0m[35m                    # but we want to use "keepalive" timeout (together with "keepalive sessions") to[0m
[30;1m737 | [0m[35m                    # down cluster after the run (submitted via SSH) is done[0m
[30;1m738 | [0m[35m                    if not shutdown_on_close:[0m
[30;1m739 | [0m[35m                        cluster.set_keepalive(keepalive=keepalive)[0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m732 | [0m[35m                    runtime_env_dict["DASK_COILED__SOFTWARE_REQUIRES_VM_ARCH"] = cluster.arch.vm_arc[0m
[30;1m733 | [0m[35m                    runtime_env_dict["DASK_COILED__SOFTWARE_IS_GPU_CLUSTER"] = cluster._is_gpu_clust[0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35m                    # by default "shutdown on close" is also what enables "keepalive" timeout on clu[0m
[30;1m736 | [0m[35m                    # but we want to use "keepalive" timeout (together with "keepalive sessions") to[0m
[30;1m737 | [0m[35m                    # down cluster after the run (submitted via SSH) is done[0m
[30;1m738 | [0m[35m                    if not shutdown_on_close:[0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m727 | [0m[35m                with coiled.Cluster(**cluster_kwargs) as cluster:[0m
[30;1m728 | [0m[35m                    info["cluster_id"] = cluster.cluster_id[0m
[30;1m729 | [0m[35m[0m
[30;1m730 | [0m[35m                    # set dask config so that cluster started from this cluster will re-use software[0m
[30;1m731 | [0m[35m                    runtime_env_dict["DASK_COILED__SOFTWARE"] = cluster._software_environment_name[0m
[30;1m732 | [0m[35m                    runtime_env_dict["DASK_COILED__SOFTWARE_REQUIRES_VM_ARCH"] = cluster.arch.vm_arc[0m
[30;1m733 | [0m[35m                    runtime_env_dict["DASK_COILED__SOFTWARE_IS_GPU_CLUSTER"] = cluster._is_gpu_clust[0m
[30;1m734 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m505 | [0m[35m@click.option([0m
[30;1m506 | [0m[35m    "--host-setup-script",[0m
[30;1m507 | [0m[35m    default=None,[0m
[30;1m508 | [0m[35m    help="Path to local script which will be run on each VM during setup process.",[0m
[30;1m509 | [0m[35m)[0m
[30;1m510 | [0m[35m@click.option([0m
[30;1m511 | [0m[35m    "--package-sync-strict",[0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m500 | [0m[35m    "--mount-bucket",[0m
[30;1m501 | [0m[35m    default=None,[0m
[30;1m502 | [0m[35m    multiple=True,[0m
[30;1m503 | [0m[35m    help="S3 or GCS bucket(s) to mount as volumes.",[0m
[30;1m504 | [0m[35m)[0m
[30;1m505 | [0m[35m@click.option([0m
[30;1m506 | [0m[35m    "--host-setup-script",[0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m461 | [0m[35m@click.option([0m
[30;1m462 | [0m[35m    "--sync", default=False, is_flag=True, help="Sync files between local working directory and ``/s[0m
[30;1m463 | [0m[35m)[0m
[30;1m464 | [0m[35m@click.option("--root", default=False, is_flag=True, help="Act as root in Docker container.")[0m
[30;1m465 | [0m[35m@click.option([0m
[30;1m466 | [0m[35m    "--skip-entrypoint",[0m
[30;1m467 | [0m[35m    default=False,[0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m435 | [0m[35m    help=([0m
[30;1m436 | [0m[35m        "IP address or CIDR from which connections to port 22 (SSH) are open; "[0m
[30;1m437 | [0m[35m        "can also be specified as 'everyone' (0.0.0.0/0) or 'me' (automatically determines public IP[0m
[30;1m438 | [0m[35m        "for your local client). Note that ``coiled run`` relies on SSH connection for executing com[0m
[30;1m439 | [0m[35m    ),[0m
[30;1m440 | [0m[35m)[0m
[30;1m441 | [0m[35m@click.option([0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m434 | [0m[35m    type=str,[0m
[30;1m435 | [0m[35m    help=([0m
[30;1m436 | [0m[35m        "IP address or CIDR from which connections to port 22 (SSH) are open; "[0m
[30;1m437 | [0m[35m        "can also be specified as 'everyone' (0.0.0.0/0) or 'me' (automatically determines public IP[0m
[30;1m438 | [0m[35m        "for your local client). Note that ``coiled run`` relies on SSH connection for executing com[0m
[30;1m439 | [0m[35m    ),[0m
[30;1m440 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35mdef make_remote_dir(connection, dir):[0m
[30;1m324 | [0m[35m    connection.run(f"mkdir -p {dir} && sudo chmod a+wrx {dir}", in_stream=False)[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35mdef get_entrypoint(connection, container_name) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m317 | [0m[35m    for f in files:[0m
[30;1m318 | [0m[35m        path = pathlib.Path(f)[0m
[30;1m319 | [0m[35m        if not path.exists():[0m
[30;1m320 | [0m[35m            raise FileNotFoundError(f"Cannot find specified file {f}")[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35mdef make_remote_dir(connection, dir):[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m304 | [0m[35m    docker_opts = "-it" if interactive else ""[0m
[30;1m305 | [0m[35m    docker_opts = f"{docker_opts} --detach" if detach else docker_opts[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m    env_opts = " ".join(f"--env {key}={val}" for key, val in env.items()) if env else ""[0m
[30;1m308 | [0m[35m    env_unset_opts = " ".join(f"--env {key}" for key in env_unset) if env_unset else ""[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m    return ([0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m298 | [0m[35m    workdir: str = "/scratch",[0m
[30;1m299 | [0m[35m    entrypoint: str = "",[0m
[30;1m300 | [0m[35m):[0m
[30;1m301 | [0m[35m    env = env or {}[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m    container_user = "-u root" if as_root else ""[0m
[30;1m304 | [0m[35m    docker_opts = "-it" if interactive else ""[0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m298 | [0m[35m    workdir: str = "/scratch",[0m
[30;1m299 | [0m[35m    entrypoint: str = "",[0m
[30;1m300 | [0m[35m):[0m
[30;1m301 | [0m[35m    env = env or {}[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m    container_user = "-u root" if as_root else ""[0m
[30;1m304 | [0m[35m    docker_opts = "-it" if interactive else ""[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m278 | [0m[35m    escaped_original_command = original_command.replace('"', '"')[0m
[30;1m279 | [0m[35m    tee_script = f"""[0m
[30;1m280 | [0m[35m    echo "{escaped_original_command}\t{command_id}" >> {COMMAND_DIR}/list[0m
[30;1m281 | [0m[35m    {inner_command_path} 2>&1 | tee -a /proc/1/fd/1[0m
[30;1m282 | [0m[35m    """[0m
[30;1m283 | [0m[35m    write_via_ssh(connection, tee_script, tee_command, mode=0o755)[0m
[30;1m284 | [0m[35m    command_string = f"bash {tee_command}"[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m    for f in file:[0m
[30;1m194 | [0m[35m        path = pathlib.Path(f)[0m
[30;1m195 | [0m[35m        if not path.exists():[0m
[30;1m196 | [0m[35m            raise FileNotFoundError(f"Cannot find specified file {f}")[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m        if path.is_file():[0m
[30;1m199 | [0m[35m            files_to_upload.append({"f": path})[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m    for path, temp_path in temp_paths.items():[0m
[30;1m97 | [0m[35m        # direct path manipulation because this is linux path, not local os path[0m
[30;1m98 | [0m[35m        path_dir = "/".join(path.split("/")[:-1])[0m
[30;1m99 | [0m[35m        move_commands.append(f"mkdir -p {path_dir} && mv {temp_path} {path}")[0m
[30;1m100 | [0m[35m    for command in move_commands:[0m
[30;1m101 | [0m[35m        # use `bash -c ...` so that `~` in path expands to user home inside container[0m
[30;1m102 | [0m[35m        connection.run(command_with_docker_exec(f"bash -c '{command}'"), hide=True, in_stream=False)[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/run.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m    ssh_address = ssh_info["scheduler_address_to_use"][0m
[30;1m70 | [0m[35m    if not ssh_address:[0m
[30;1m71 | [0m[35m        raise coiled.exceptions.CoiledException([0m
[30;1m72 | [0m[35m            f"Unable to connect to cluster (id={cluster_id}) because we don't have IP address for it[0m
[30;1m73 | [0m[35m        )[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    connection = fabric.connection.Connection(ssh_address, user="ubuntu", connect_kwargs={"pkey": pk[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mfrom .config import config[0m
[30;1m7 | [0m[35mfrom .curl import curl[0m
[30;1m8 | [0m[35mfrom .diagnostics import diagnostics[0m
[30;1m9 | [0m[35mfrom .env import env[0m
[30;1m10 | [0m[35mfrom .hello import hello[0m
[30;1m11 | [0m[35mfrom .login import login[0m
[30;1m12 | [0m[35mfrom .notebook import notebook_group[0m
[30;1m13 | [0m[35mfrom .package_sync import package_sync[0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mfrom .batch import batch_group[0m
[30;1m5 | [0m[35mfrom .cluster import better_logs, cluster[0m
[30;1m6 | [0m[35mfrom .config import config[0m
[30;1m7 | [0m[35mfrom .curl import curl[0m
[30;1m8 | [0m[35mfrom .diagnostics import diagnostics[0m
[30;1m9 | [0m[35mfrom .env import env[0m
[30;1m10 | [0m[35mfrom .hello import hello[0m
[30;1m11 | [0m[35mfrom .login import login[0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/hello/examples/exit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdef exit() -> bool:[0m
[30;1m5 | [0m[35m    with log_interactions("example-exit"):[0m
[30;1m6 | [0m[35m        console.print("See you next time :wave:")[0m
[30;1m7 | [0m[35m    return False[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m    if len(key) == 1:[0m
[30;1m72 | [0m[35m        existing[head] = val[0m
[30;1m73 | [0m[35m    else:[0m
[30;1m74 | [0m[35m        if head not in existing:[0m
[30;1m75 | [0m[35m            existing[head] = {}[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m        set_config_key(existing[head], key[1:], val)[0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35mdef set_config_key(existing: dict, key: List[str], val) -> dict:[0m
[30;1m68 | [0m[35m    if not key:[0m
[30;1m69 | [0m[35m        return existing[0m
[30;1m70 | [0m[35m    head = key[0][0m
[30;1m71 | [0m[35m    if len(key) == 1:[0m
[30;1m72 | [0m[35m        existing[head] = val[0m
[30;1m73 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/entry.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m78 | [0m[35m            "[green]AWS[/green]: [link]https://aws.amazon.com/free[/link]\n"[0m
[30;1m79 | [0m[35m            "[green]GCP[/green]: [link]https://cloud.google.com/free/[/link]\n\n"[0m
[30;1m80 | [0m[35m            "Alternatively, ask for a temporary guest account. "[0m
[30;1m81 | [0m[35m            "Reach out at "[0m
[30;1m82 | [0m[35m            "[link=mailto:hello@coiled.io?subject=Trial%20Account]hello@coiled.io[/link] "[0m
[30;1m83 | [0m[35m            "with a brief note about how you'd like to use Dask and Coiled"[0m
[30;1m84 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/setup/entry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35mTo begin you need to connect Coiled to your cloud account.[0m
[30;1m34 | [0m[35mSelect one of the following options:[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m  1. Amazon Web Service ([green]AWS[/green])[0m
[30;1m37 | [0m[35m  2. Google Cloud Platform ([green]GCP[/green])[0m
[30;1m38 | [0m[35m  3. I don't have a cloud account, set me up with a free trial?[0m
[30;1m39 | [0m[35m  [red]x[/red]. Exit setup[0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        credentials = cast(google.oauth2.credentials.Credentials, credentials)[0m
[30;1m264 | [0m[35m    credentials.refresh(Request())[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m    result = httpx.get(f"https://oauth2.googleapis.com/tokeninfo?access_token={credentials.token}")[0m
[30;1m267 | [0m[35m    return result.json()[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m    def get_token_expiry(token: str) -> datetime.datetime:[0m
[30;1m226 | [0m[35m        import httpx[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m        result = httpx.get(f"https://oauth2.googleapis.com/tokeninfo?access_token={token}")[0m
[30;1m229 | [0m[35m        data = result.json()[0m
[30;1m230 | [0m[35m        timestamp = int(data["exp"])[0m
[30;1m231 | [0m[35m        # note that refresh_handler is expected to return naive utc datetime[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m        if not token:[0m
[30;1m215 | [0m[35m            # It's not the normal use-case, but Coiled can also set this env on local client machine[0m
[30;1m216 | [0m[35m            # so that you can use `CoiledShippedCredentials` (with same OAuth2 token) locally and on[0m
[30;1m217 | [0m[35m            token = os.environ.get("COILED_LOCAL_CLOUDSDK_AUTH_ACCESS_TOKEN")[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m        if not token:[0m
[30;1m220 | [0m[35m            # print rather than log since we don't know how logging is configure on the cluster[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        except Exception:[0m
[30;1m210 | [0m[35m            pass[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        token = os.environ.get("CLOUDSDK_AUTH_ACCESS_TOKEN")[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        if not token:[0m
[30;1m215 | [0m[35m            # It's not the normal use-case, but Coiled can also set this env on local client machine[0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m240 | [0m[35m            from google.auth.exceptions import RefreshError[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m            raise RefreshError([0m
[30;1m243 | [0m[35m                "Coiled was unable to find Google OAuth2 token on the cluster. "[0m
[30;1m244 | [0m[35m                "See https://docs.coiled.io/user_guide/remote-data-access.html#gcp for details about[0m
[30;1m245 | [0m[35m                "OAuth2 tokens from the client to the cluster."[0m
[30;1m246 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m        if not token:[0m
[30;1m220 | [0m[35m            # print rather than log since we don't know how logging is configure on the cluster[0m
[30;1m221 | [0m[35m            print("No Google OAuth2 token found, CLOUDSDK_AUTH_ACCESS_TOKEN env var not set")[0m
[30;1m222 | [0m[35m        return token[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m212 | [0m[35m        token = os.environ.get("CLOUDSDK_AUTH_ACCESS_TOKEN")[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        if not token:[0m
[30;1m215 | [0m[35m            # It's not the normal use-case, but Coiled can also set this env on local client machine[0m
[30;1m216 | [0m[35m            # so that you can use `CoiledShippedCredentials` (with same OAuth2 token) locally and on[0m
[30;1m217 | [0m[35m            token = os.environ.get("COILED_LOCAL_CLOUDSDK_AUTH_ACCESS_TOKEN")[0m
[30;1m218 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m                local_creds.refresh(Request())[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m        if set_local_token_env:[0m
[30;1m57 | [0m[35m            # set local env var with token, in case `CoiledShippedCredentials` is being used locally[0m
[30;1m58 | [0m[35m            os.environ["COILED_LOCAL_CLOUDSDK_AUTH_ACCESS_TOKEN"] = local_creds.token or ""[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        return {[0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/credentials/google.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m            try:[0m
[30;1m42 | [0m[35m                local_creds.refresh(Request())[0m
[30;1m43 | [0m[35m            except RefreshError:[0m
[30;1m44 | [0m[35m                # when local creds are service account, we need to explicitly specify scope(s)[0m
[30;1m45 | [0m[35m                # or else we get this exception:[0m
[30;1m46 | [0m[35m                #   RefreshError:[0m
[30;1m47 | [0m[35m                #   ('invalid_scope: Invalid OAuth scope or ID token audience provided.',[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m605 | [0m[35m    "--include-vcs",[0m
[30;1m606 | [0m[35m    default=False,[0m
[30;1m607 | [0m[35m    is_flag=True,[0m
[30;1m608 | [0m[35m    help="Include version control files when syncing (e.g., `.git`).",[0m
[30;1m609 | [0m[35m)[0m
[30;1m610 | [0m[35m@click.option([0m
[30;1m611 | [0m[35m    "--debug",[0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m165 | [0m[35m    "--include-vcs",[0m
[30;1m166 | [0m[35m    default=False,[0m
[30;1m167 | [0m[35m    is_flag=True,[0m
[30;1m168 | [0m[35m    help="Include version control files when syncing (e.g., `.git`).",[0m
[30;1m169 | [0m[35m)[0m
[30;1m170 | [0m[35m@click.option([0m
[30;1m171 | [0m[35m    "--idle-timeout",[0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m12 | [0m[35mimport importlib_metadata[0m
[30;1m13 | [0m[35mfrom packaging.version import Version[0m
[30;1m14 | [0m[35mfrom rich import print[0m
[30;1m15 | [0m[35mfrom rich.control import Control[0m
[30;1m16 | [0m[35mfrom rich.prompt import Confirm[0m
[30;1m17 | [0m[35mfrom rich.segment import ControlType[0m
[30;1m18 | [0m[35mfrom urllib3.util import parse_url[0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m407 | [0m[35m            # clear ENV var so default `Client()` on notebook gives us a new local cluster[0m
[30;1m408 | [0m[35m            cluster.unset_env_vars(["DASK_SCHEDULER_ADDRESS"])[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m            # some env vars are set in dask config early in the dask loading process[0m
[30;1m411 | [0m[35m            # we set these to `""` since that's what we can do in the relevant dask config[0m
[30;1m412 | [0m[35m            # but some libraries don't accept empty string, so we'll unset them here.[0m
[30;1m413 | [0m[35m            # this won't affect things loaded by dask, but should affect user-code.[0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m404 | [0m[35m            assert cluster_id is not None[0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m            # by default, jupyter on the scheduler gives us client to that very scheduler[0m
[30;1m407 | [0m[35m            # clear ENV var so default `Client()` on notebook gives us a new local cluster[0m
[30;1m408 | [0m[35m            cluster.unset_env_vars(["DASK_SCHEDULER_ADDRESS"])[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m            # some env vars are set in dask config early in the dask loading process[0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m327 | [0m[35m    tags = dict_from_key_val_list(tag)[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m    try:[0m
[30;1m330 | [0m[35m        # when using package sync, check that local env has jupyter and recent distributed[0m
[30;1m331 | [0m[35m        if not software and not container:[0m
[30;1m332 | [0m[35m            if not check_distributed_version():[0m
[30;1m333 | [0m[35m                raise NotebookError("distributed version check")[0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m214 | [0m[35m@click.option([0m
[30;1m215 | [0m[35m    "--host-setup-script",[0m
[30;1m216 | [0m[35m    default=None,[0m
[30;1m217 | [0m[35m    help="Path to local script which will be run on each VM during setup process.",[0m
[30;1m218 | [0m[35m)[0m
[30;1m219 | [0m[35m@click.option([0m
[30;1m220 | [0m[35m    "--resumable",[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m    "--mount-bucket",[0m
[30;1m210 | [0m[35m    default=None,[0m
[30;1m211 | [0m[35m    multiple=True,[0m
[30;1m212 | [0m[35m    help="S3 or GCS bucket(s) to mount as volumes.",[0m
[30;1m213 | [0m[35m)[0m
[30;1m214 | [0m[35m@click.option([0m
[30;1m215 | [0m[35m    "--host-setup-script",[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m    default=None,[0m
[30;1m181 | [0m[35m    help="Control the CIDR from which cluster firewall allows ingress to scheduler; "[0m
[30;1m182 | [0m[35m    "by default this is open to any source address (0.0.0.0/0). You can specify "[0m
[30;1m183 | [0m[35m    "CIDR, or 'me' for just your IP address.",[0m
[30;1m184 | [0m[35m)[0m
[30;1m185 | [0m[35m@click.option([0m
[30;1m186 | [0m[35m    "--env",[0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m    help=([0m
[30;1m103 | [0m[35m        "IP address or CIDR from which connections to port 22 (SSH) are open; "[0m
[30;1m104 | [0m[35m        "can also be specified as 'everyone' (0.0.0.0/0) or 'me' (automatically determines public IP[0m
[30;1m105 | [0m[35m        "for your local client). Note that `--sync` relies on SSH connection."[0m
[30;1m106 | [0m[35m    ),[0m
[30;1m107 | [0m[35m)[0m
[30;1m108 | [0m[35m@click.option([0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m    type=str,[0m
[30;1m102 | [0m[35m    help=([0m
[30;1m103 | [0m[35m        "IP address or CIDR from which connections to port 22 (SSH) are open; "[0m
[30;1m104 | [0m[35m        "can also be specified as 'everyone' (0.0.0.0/0) or 'me' (automatically determines public IP[0m
[30;1m105 | [0m[35m        "for your local client). Note that `--sync` relies on SSH connection."[0m
[30;1m106 | [0m[35m    ),[0m
[30;1m107 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m        self._update_plan_interval = parse_timedelta(update_interval) if update_interval else None  [0m
[30;1m29 | [0m[35m        self._last_plan_update = time.monotonic()[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        target_duration = kwargs.get("target_duration")[0m
[30;1m32 | [0m[35m        if target_duration:[0m
[30;1m33 | [0m[35m            with Client(self.cluster, name="non-user-to-set-adaptive-target-duration") as client:[0m
[30;1m34 | [0m[35m                client.run_on_scheduler([0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    def __init__(self, cluster, **kwargs):[0m
[30;1m25 | [0m[35m        super().__init__(cluster, **kwargs)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        update_interval = dask.config.get("coiled.adaptive.update-plan-interval", None)[0m
[30;1m28 | [0m[35m        self._update_plan_interval = parse_timedelta(update_interval) if update_interval else None  [0m
[30;1m29 | [0m[35m        self._last_plan_update = time.monotonic()[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m98 | [0m[35merval, so if prior adaptive requests failed to get desired[0m
[30;1m99 | [0m[35m            # workers (e.g., there were availability limits which caused workers to go to `error` st[0m
[30;1m100 | [0m[35m            # will be aware that those workers failed and can request new workers.[0m
[30;1m101 | [0m[35m            # the interval will effectively control how often adaptive will retry to get workers.[0m
[30;1m102 | [0m[35m            elif self._update_plan_interval and time.monotonic() > self._last_plan_update + self._up[0m
[30;1m103 | [0m[35m                if hasattr(self.cluster, "_submit_cluster_event"):[0m
[30;1m104 | [0m[35m                    await self.cluster._submit_cluster_event([0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m95 | [0m[35m                await self.cluster._set_plan_requested()[0m
[30;1m96 | [0m[35m                self._last_plan_update = time.monotonic()[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m            # update current view of workers at regular interval, so if prior adaptive requests fail[0m
[30;1m99 | [0m[35m            # workers (e.g., there were availability limits which caused workers to go to `error` st[0m
[30;1m100 | [0m[35m            # will be aware that those workers failed and can request new workers.[0m
[30;1m101 | [0m[35m            # the interval will effectively control how often adaptive will retry to get workers.[0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m95 | [0m[35m                await self.cluster._set_plan_requested()[0m
[30;1m96 | [0m[35m                self._last_plan_update = time.monotonic()[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m            # update current view of workers at regular interval, so if prior adaptive requests fail[0m
[30;1m99 | [0m[35m            # workers (e.g., there were availability limits which caused workers to go to `error` st[0m
[30;1m100 | [0m[35m            # will be aware that those workers failed and can request new workers.[0m
[30;1m101 | [0m[35m            # the interval will effectively control how often adaptive will retry to get workers.[0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    async def recommendations(self, target: int) -> dict:[0m
[30;1m90 | [0m[35m        if self.cluster and hasattr(self.cluster, "_set_plan_requested"):[0m
[30;1m91 | [0m[35m            # update current view of workers if running worker on scheduler[0m
[30;1m92 | [0m[35m            # since we initially include fake worker in the set but this messes things up if we[0m
[30;1m93 | [0m[35m            # don't remove later when actual worker has appeared.[0m
[30;1m94 | [0m[35m            if "extra-worker-on-scheduler" in self.cluster.plan:[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport enum[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport dask.config[0m
[30;1m6 | [0m[35mfrom dask.distributed import Client[0m
[30;1m7 | [0m[35mfrom dask.utils import parse_timedelta[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m410 | [0m[35m[0m
[30;1m411 | [0m[35m    time_string = ""[0m
[30;1m412 | [0m[35m[0m
[30;1m413 | [0m[35m    if show_timestamp and event.get("timestamp"):[0m
[30;1m414 | [0m[35m        time_format = "%Y-%m-%d %H:%M:%S.%f"[0m
[30;1m415 | [0m[35m        t = datetime.utcfromtimestamp(event["timestamp"] / 1000)[0m
[30;1m416 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m402 | [0m[35m            color = instances[event["instance_id"]]["color"][0m
[30;1m403 | [0m[35m        else:[0m
[30;1m404 | [0m[35m            # we might not know about instance if it showed up while we're tailing all worker logs[0m
[30;1m405 | [0m[35m            label = event.get("instance_id") or event.get("instance")[0m
[30;1m406 | [0m[35m            color = COLORS[0][0m
[30;1m407 | [0m[35m    else:[0m
[30;1m408 | [0m[35m        label = ""[0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m402 | [0m[35m            color = instances[event["instance_id"]]["color"][0m
[30;1m403 | [0m[35m        else:[0m
[30;1m404 | [0m[35m            # we might not know about instance if it showed up while we're tailing all worker logs[0m
[30;1m405 | [0m[35m            label = event.get("instance_id") or event.get("instance")[0m
[30;1m406 | [0m[35m            color = COLORS[0][0m
[30;1m407 | [0m[35m    else:[0m
[30;1m408 | [0m[35m        label = ""[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m    message = event["message"][0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m    if show_label:[0m
[30;1m400 | [0m[35m        if event.get("instance_id") and event.get("instance_id") in instances:[0m
[30;1m401 | [0m[35m            label = instances[event["instance_id"]]["label"][0m
[30;1m402 | [0m[35m            color = instances[event["instance_id"]]["color"][0m
[30;1m403 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m    message = event["message"][0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m    if show_label:[0m
[30;1m400 | [0m[35m        if event.get("instance_id") and event.get("instance_id") in instances:[0m
[30;1m401 | [0m[35m            label = instances[event["instance_id"]]["label"][0m
[30;1m402 | [0m[35m            color = instances[event["instance_id"]]["color"][0m
[30;1m403 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m        instances.update({[0m
[30;1m235 | [0m[35m            worker["instance"]["id"]: dict(label=worker_label(worker), color=COLORS[idx % len(COLORS[0m
[30;1m236 | [0m[35m            for idx, worker in enumerate(workers_info)[0m
[30;1m237 | [0m[35m            if worker.get("instance") and (workers == "all" or filter_worker(worker))[0m
[30;1m238 | [0m[35m        })[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m    return instances[0m

[31m--[ [0m[34mMatch #[0m[33m839[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m                # match on private IP[0m
[30;1m224 | [0m[35m                return True[0m
[30;1m225 | [0m[35m            elif ([0m
[30;1m226 | [0m[35m                worker.get("current_state", {}).get("state")[0m
[30;1m227 | [0m[35m                and worker["current_state"]["state"] in worker_attrs_to_match[0m
[30;1m228 | [0m[35m            ):[0m
[30;1m229 | [0m[35m                # match on state[0m

[31m--[ [0m[34mMatch #[0m[33m840[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m                # match on private IP[0m
[30;1m224 | [0m[35m                return True[0m
[30;1m225 | [0m[35m            elif ([0m
[30;1m226 | [0m[35m                worker.get("current_state", {}).get("state")[0m
[30;1m227 | [0m[35m                and worker["current_state"]["state"] in worker_attrs_to_match[0m
[30;1m228 | [0m[35m            ):[0m
[30;1m229 | [0m[35m                # match on state[0m

[31m--[ [0m[34mMatch #[0m[33m841[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m                # match on name[0m
[30;1m218 | [0m[35m                return True[0m
[30;1m219 | [0m[35m            elif ([0m
[30;1m220 | [0m[35m                worker.get("instance", {}).get("private_ip_address")[0m
[30;1m221 | [0m[35m                and worker["instance"]["private_ip_address"] in worker_attrs_to_match[0m
[30;1m222 | [0m[35m            ):[0m
[30;1m223 | [0m[35m                # match on private IP[0m

[31m--[ [0m[34mMatch #[0m[33m842[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m                # match on name[0m
[30;1m218 | [0m[35m                return True[0m
[30;1m219 | [0m[35m            elif ([0m
[30;1m220 | [0m[35m                worker.get("instance", {}).get("private_ip_address")[0m
[30;1m221 | [0m[35m                and worker["instance"]["private_ip_address"] in worker_attrs_to_match[0m
[30;1m222 | [0m[35m            ):[0m
[30;1m223 | [0m[35m                # match on private IP[0m

[31m--[ [0m[34mMatch #[0m[33m843[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m        worker_attrs_to_match = workers.split(",")[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        def filter_worker(worker):[0m
[30;1m216 | [0m[35m            if worker.get("name") and worker["name"] in worker_attrs_to_match:[0m
[30;1m217 | [0m[35m                # match on name[0m
[30;1m218 | [0m[35m                return True[0m
[30;1m219 | [0m[35m            elif ([0m

[31m--[ [0m[34mMatch #[0m[33m844[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m        return ([0m
[30;1m204 | [0m[35m            worker.get("name", str(worker["instance"]["id"]))[0m
[30;1m205 | [0m[35m            if label == "name"[0m
[30;1m206 | [0m[35m            else worker["instance"].get(label, str(worker["instance"]["id"]))[0m
[30;1m207 | [0m[35m        )[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    # TODO when tailing "all" workers, this won't include workers that appear after we start[0m

[31m--[ [0m[34mMatch #[0m[33m845[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m        if label == "none":[0m
[30;1m202 | [0m[35m            return ""[0m
[30;1m203 | [0m[35m        return ([0m
[30;1m204 | [0m[35m            worker.get("name", str(worker["instance"]["id"]))[0m
[30;1m205 | [0m[35m            if label == "name"[0m
[30;1m206 | [0m[35m            else worker["instance"].get(label, str(worker["instance"]["id"]))[0m
[30;1m207 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m846[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m    instance_labels_dict = make_instance_labels([0m
[30;1m146 | [0m[35m        label=label,[0m
[30;1m147 | [0m[35m        no_scheduler=no_scheduler,[0m
[30;1m148 | [0m[35m        scheduler_id=cluster_info.get("scheduler", {}).get("instance", {}).get("id"),[0m
[30;1m149 | [0m[35m        workers=workers,[0m
[30;1m150 | [0m[35m        workers_info=cluster_info["workers"],[0m
[30;1m151 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m847[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m    instance_labels_dict = make_instance_labels([0m
[30;1m146 | [0m[35m        label=label,[0m
[30;1m147 | [0m[35m        no_scheduler=no_scheduler,[0m
[30;1m148 | [0m[35m        scheduler_id=cluster_info.get("scheduler", {}).get("instance", {}).get("id"),[0m
[30;1m149 | [0m[35m        workers=workers,[0m
[30;1m150 | [0m[35m        workers_info=cluster_info["workers"],[0m
[30;1m151 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m848[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m    instance_labels_dict = make_instance_labels([0m
[30;1m146 | [0m[35m        label=label,[0m
[30;1m147 | [0m[35m        no_scheduler=no_scheduler,[0m
[30;1m148 | [0m[35m        scheduler_id=cluster_info.get("scheduler", {}).get("instance", {}).get("id"),[0m
[30;1m149 | [0m[35m        workers=workers,[0m
[30;1m150 | [0m[35m        workers_info=cluster_info["workers"],[0m
[30;1m151 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m849[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m348 | [0m[35m                # handle sentinel inside longer message[0m
[30;1m349 | [0m[35m                pos = event["message"].find(stop_sentinel)[0m
[30;1m350 | [0m[35m                event["message"] = event["message"][:pos].strip()[0m
[30;1m351 | [0m[35m                # if there's text before stop sentinel, include event with sentinel, otherwise stop [0m
[30;1m352 | [0m[35m                show_to = i + 1 if event["message"] else i[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m            if not waiting_for_start_sentinel and show_to > -1:[0m

[31m--[ [0m[34mMatch #[0m[33m850[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m338 | [0m[35m                # handle sentinel inside longer message[0m
[30;1m339 | [0m[35m                pos = event["message"].find(start_sentinel)[0m
[30;1m340 | [0m[35m                event["message"] = event["message"][pos + len(start_sentinel) :].strip()[0m
[30;1m341 | [0m[35m                # if there's text after start sentinel, include event with sentinel, otherwise start[0m
[30;1m342 | [0m[35m                # this is especially important because multiple lines can be joined into one event[0m
[30;1m343 | [0m[35m                show_from = i if event["message"] else i + 1[0m
[30;1m344 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m851[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m319 | [0m[35m            time.sleep(interval)[0m
[30;1m320 | [0m[35m        elif not tail and until_timestamp is None and events:[0m
[30;1m321 | [0m[35m            # if there's no specified end time of range, then it's possible there are more events we[0m
[30;1m322 | [0m[35m            # the last event that we got back, so make another request with the updated start time o[0m
[30;1m323 | [0m[35m            continue[0m
[30;1m324 | [0m[35m        else:[0m
[30;1m325 | [0m[35m            break[0m

[31m--[ [0m[34mMatch #[0m[33m852[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m318 | [0m[35m                tail_max_times -= 1[0m
[30;1m319 | [0m[35m            time.sleep(interval)[0m
[30;1m320 | [0m[35m        elif not tail and until_timestamp is None and events:[0m
[30;1m321 | [0m[35m            # if there's no specified end time of range, then it's possible there are more events we[0m
[30;1m322 | [0m[35m            # the last event that we got back, so make another request with the updated start time o[0m
[30;1m323 | [0m[35m            continue[0m
[30;1m324 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m853[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m317 | [0m[35m            if tail_max_times:[0m
[30;1m318 | [0m[35m                tail_max_times -= 1[0m
[30;1m319 | [0m[35m            time.sleep(interval)[0m
[30;1m320 | [0m[35m        elif not tail and until_timestamp is None and events:[0m
[30;1m321 | [0m[35m            # if there's no specified end time of range, then it's possible there are more events we[0m
[30;1m322 | [0m[35m            # the last event that we got back, so make another request with the updated start time o[0m
[30;1m323 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m854[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m312 | [0m[35m            if found_stop_sentinel:[0m
[30;1m313 | [0m[35m                break[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m        if tail and (tail_max_times is None or tail_max_times > 0):[0m
[30;1m316 | [0m[35m            # TODO stop tailing once cluster is stopped/errored (future MR)[0m
[30;1m317 | [0m[35m            if tail_max_times:[0m
[30;1m318 | [0m[35m                tail_max_times -= 1[0m

[31m--[ [0m[34mMatch #[0m[33m855[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35m    until_timestamp = ts_ms_from_string(until)[0m
[30;1m268 | [0m[35m    last_events = set()[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    if tail and not from_timestamp:[0m
[30;1m271 | [0m[35m        # for tail, start with logs from 30s ago if start isn't specified[0m
[30;1m272 | [0m[35m        current_ms = int(time.time_ns() // 1e6)[0m
[30;1m273 | [0m[35m        from_timestamp = current_ms - (30 * 1000)[0m

[31m--[ [0m[34mMatch #[0m[33m856[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m220 | [0m[35m                worker.get("instance", {}).get("private_ip_address")[0m
[30;1m221 | [0m[35m                and worker["instance"]["private_ip_address"] in worker_attrs_to_match[0m
[30;1m222 | [0m[35m            ):[0m
[30;1m223 | [0m[35m                # match on private IP[0m
[30;1m224 | [0m[35m                return True[0m
[30;1m225 | [0m[35m            elif ([0m
[30;1m226 | [0m[35m                worker.get("current_state", {}).get("state")[0m
[30;1m227 | [0m[35m                and worker["current_state"]["state"] in worker_attrs_to_match[0m

[31m--[ [0m[34mMatch #[0m[33m857[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m        "stopped",[0m
[30;1m161 | [0m[35m        "error",[0m
[30;1m162 | [0m[35m    ):[0m
[30;1m163 | [0m[35m        tail = False[0m
[30;1m164 | [0m[35m        console.print(f"[red]Cluster state is {cluster_state} so not tailing.[/red]")[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    if (workers or not no_scheduler) and not instance_labels_dict:[0m

[31m--[ [0m[34mMatch #[0m[33m858[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m    cluster_name = cluster_info["name"][0m
[30;1m157 | [0m[35m    cluster_state = cluster_info["current_state"]["state"][0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m    if tail and cluster_state in ([0m
[30;1m160 | [0m[35m        "stopped",[0m
[30;1m161 | [0m[35m        "error",[0m
[30;1m162 | [0m[35m    ):[0m

[31m--[ [0m[34mMatch #[0m[33m859[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m    system = system or combined[0m
[30;1m135 | [0m[35m    label = label.lower()[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m    if tail and until:[0m
[30;1m138 | [0m[35m        raise click.ClickException("You can't use --until when tailing logs.")[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m    cluster = cluster or cluster_arg[0m

[31m--[ [0m[34mMatch #[0m[33m860[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m    default="all",[0m
[30;1m48 | [0m[35m    help=([0m
[30;1m49 | [0m[35m        "All worker logs included by default, specify 'none' or "[0m
[30;1m50 | [0m[35m        "comma-delimited list of names, states, or internal IP addresses"[0m
[30;1m51 | [0m[35m    ),[0m
[30;1m52 | [0m[35m)[0m
[30;1m53 | [0m[35m@click.option([0m

[31m--[ [0m[34mMatch #[0m[33m861[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/cluster/better_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport re[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom datetime import datetime, timedelta, timezone[0m
[30;1m4 | [0m[35mfrom typing import List, Optional, Tuple[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport click[0m

[31m--[ [0m[34mMatch #[0m[33m862[0m[34m of [0m[33m862[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/coiled-1.90.6.dev4/coiled/cli/batch/wait.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport itertools[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom collections import Counter[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport click[0m
[30;1m8 | [0m[35mfrom rich.align import Align[0m

862 matches found.
