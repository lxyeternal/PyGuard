[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m                    hostname=self._settings.ftp_url,[0m
[30;1m130 | [0m[35m                    port=self._settings.ftp_port,[0m
[30;1m131 | [0m[35m                    username=self._settings.ftp_user,[0m
[30;1m132 | [0m[35m                    password=self._settings.ftp_pass,[0m
[30;1m133 | [0m[35m                    pkey=pkey,[0m
[30;1m134 | [0m[35m                )[0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m            pkey = paramiko.RSAKey.from_private_key_file([0m
[30;1m118 | [0m[35m                filename=self._settings.ftp_ssh_key_path,[0m
[30;1m119 | [0m[35m                password=self._settings.ftp_ssh_key_pass,[0m
[30;1m120 | [0m[35m            )[0m
[30;1m121 | [0m[35m        except Exception as e:[0m
[30;1m122 | [0m[35m            raise config.ImproperlyConfigured([0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m            ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m            pkey = paramiko.RSAKey.from_private_key_file([0m
[30;1m118 | [0m[35m                filename=self._settings.ftp_ssh_key_path,[0m
[30;1m119 | [0m[35m                password=self._settings.ftp_ssh_key_pass,[0m
[30;1m120 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m110 | [0m[35mclass SFTPFileSet(FileSet):[0m
[30;1m111 | [0m[35m    def _get_sftp_connector(self) -> Tuple[SSHClient, SFTPClient]:[0m
[30;1m112 | [0m[35m        try:[0m
[30;1m113 | [0m[35m            ssh = paramiko.SSHClient()[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m            ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m317 | [0m[35m        settings = self._get_setting()[0m
[30;1m318 | [0m[35m        properties = " -Properties "[0m
[30;1m319 | [0m[35m        for item in settings["properties"]:[0m
[30;1m320 | [0m[35m            # Skip unreadable AD properties, such as "AccountPassword"[0m
[30;1m321 | [0m[35m            if item in self._unreadable_properties():[0m
[30;1m322 | [0m[35m                continue[0m
[30;1m323 | [0m[35m            properties += item + ","[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m308 | [0m[35m    def _unreadable_properties(self) -> List[str]:[0m
[30;1m309 | [0m[35m        """Return a list of AD properties which cannot be read by `Get-ADUser`, as they[0m
[30;1m310 | [0m[35m        are write-only."""[0m
[30;1m311 | [0m[35m        return ["AccountPassword"][0m
[30;1m312 | [0m[35m[0m
[30;1m313 | [0m[35m    def _properties(self):[0m
[30;1m314 | [0m[35m        # This is only called from `AD.get_from_ad`, and as such, it is only used to[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m301 | [0m[35m        """[0m
[30;1m302 | [0m[35m        settings = self._get_setting()[0m
[30;1m303 | [0m[35m        user_credential = credential_template.format([0m
[30;1m304 | [0m[35m            settings["system_user"], settings["password"][0m
[30;1m305 | [0m[35m        )[0m
[30;1m306 | [0m[35m        return user_credential[0m
[30;1m307 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m170 | [0m[35m            session = generate_kerberos_session([0m
[30;1m171 | [0m[35m                all_settings["global"]["winrm_host"],[0m
[30;1m172 | [0m[35m                all_settings["global"]["system_user"],[0m
[30;1m173 | [0m[35m                all_settings["global"]["password"],[0m
[30;1m174 | [0m[35m            )[0m
[30;1m175 | [0m[35m        else:[0m
[30;1m176 | [0m[35m            raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m164 | [0m[35m            session = generate_ntlm_session([0m
[30;1m165 | [0m[35m                all_settings["global"]["winrm_host"],[0m
[30;1m166 | [0m[35m                all_settings["global"]["system_user"],[0m
[30;1m167 | [0m[35m                all_settings["global"]["password"],[0m
[30;1m168 | [0m[35m            )[0m
[30;1m169 | [0m[35m        elif all_settings["primary"]["method"] == "kerberos":[0m
[30;1m170 | [0m[35m            session = generate_kerberos_session([0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m    session = ReauthenticatingKerberosSession([0m
[30;1m126 | [0m[35m        "http://{}:5985/wsman".format(hostname),[0m
[30;1m127 | [0m[35m        username=username,[0m
[30;1m128 | [0m[35m        password=password,[0m
[30;1m129 | [0m[35m    )[0m
[30;1m130 | [0m[35m    return session[0m
[30;1m131 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m    session = ReauthenticatingKerberosSession([0m
[30;1m126 | [0m[35m        "http://{}:5985/wsman".format(hostname),[0m
[30;1m127 | [0m[35m        username=username,[0m
[30;1m128 | [0m[35m        password=password,[0m
[30;1m129 | [0m[35m    )[0m
[30;1m130 | [0m[35m    return session[0m
[30;1m131 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m112 | [0m[35m        return rs[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35mdef generate_kerberos_session(hostname, username=None, password=None):[0m
[30;1m116 | [0m[35m    """[0m
[30;1m117 | [0m[35m    Method to create a kerberos session for running powershell scripts.[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    def __init__(self, target: str, username: str, password: str):[0m
[30;1m91 | [0m[35m        self._username = username[0m
[30;1m92 | [0m[35m        self._password = password[0m
[30;1m93 | [0m[35m        self._target = target[0m
[30;1m94 | [0m[35m        self._create_new_session()[0m
[30;1m95 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    def __init__(self, target: str, username: str, password: str):[0m
[30;1m91 | [0m[35m        self._username = username[0m
[30;1m92 | [0m[35m        self._password = password[0m
[30;1m93 | [0m[35m        self._target = target[0m
[30;1m94 | [0m[35m        self._create_new_session()[0m
[30;1m95 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m            target=self._target, transport="kerberos", auth=(None, None)[0m
[30;1m88 | [0m[35m        )[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    def __init__(self, target: str, username: str, password: str):[0m
[30;1m91 | [0m[35m        self._username = username[0m
[30;1m92 | [0m[35m        self._password = password[0m
[30;1m93 | [0m[35m        self._target = target[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m68 | [0m[35m            subprocess.run([0m
[30;1m69 | [0m[35m                cmd,[0m
[30;1m70 | [0m[35m                check=True,[0m
[30;1m71 | [0m[35m                input=self._password.encode(),[0m
[30;1m72 | [0m[35m                stdout=subprocess.DEVNULL,[0m
[30;1m73 | [0m[35m                stderr=subprocess.PIPE,[0m
[30;1m74 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m    session = Session([0m
[30;1m47 | [0m[35m        "https://{}:5986/wsman".format(hostname),[0m
[30;1m48 | [0m[35m        transport="ntlm",[0m
[30;1m49 | [0m[35m        auth=(system_user, password),[0m
[30;1m50 | [0m[35m        server_cert_validation="ignore",[0m
[30;1m51 | [0m[35m    )[0m
[30;1m52 | [0m[35m    return session[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m37 | [0m[35m    return text[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mdef generate_ntlm_session(hostname, system_user, password):[0m
[30;1m41 | [0m[35m    """Method to create a ntlm session for running powershell scripts.[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/gql_lora_cache_async.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1646 | [0m[35m        :param dry_run: For testing purposes it is possible to read from cache.[0m
[30;1m1647 | [0m[35m        """[0m
[30;1m1648 | [0m[35m        if dry_run is None:[0m
[30;1m1649 | [0m[35m            dry_run = os.environ.get("USE_CACHED_LORACACHE", False)[0m
[30;1m1650 | [0m[35m[0m
[30;1m1651 | [0m[35m        # Ensure that tmp/ exists[0m
[30;1m1652 | [0m[35m        Path("tmp/").mkdir(exist_ok=True)[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_location_element.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m84 | [0m[35m                "user_sam": None,  # not used[0m
[30;1m85 | [0m[35m            },[0m
[30;1m86 | [0m[35m            settings=settings,[0m
[30;1m87 | [0m[35m            environment=ad_writer._get_jinja_environment(),[0m
[30;1m88 | [0m[35m        )[0m
[30;1m89 | [0m[35m        # Assert[0m
[30;1m90 | [0m[35m        self._assert_matches(result, expected_pairs)[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m                    "exporters.actual_state_historic.password": secret_val_or_none([0m
[30;1m127 | [0m[35m                        self.historic_state.password[0m
[30;1m128 | [0m[35m                    )[0m
[30;1m129 | [0m[35m                    or secret_val_or_none(self.actual_state.password),[0m
[30;1m130 | [0m[35m                    "primary_manager_responsibility": self.primary_manager_responsibility,[0m
[30;1m131 | [0m[35m                    "use_new_cache": self.use_new_cache,[0m
[30;1m132 | [0m[35m                }[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m                    "exporters.actual_state_historic.user": self.historic_state.user[0m
[30;1m125 | [0m[35m                    or self.actual_state.user,[0m
[30;1m126 | [0m[35m                    "exporters.actual_state_historic.password": secret_val_or_none([0m
[30;1m127 | [0m[35m                        self.historic_state.password[0m
[30;1m128 | [0m[35m                    )[0m
[30;1m129 | [0m[35m                    or secret_val_or_none(self.actual_state.password),[0m
[30;1m130 | [0m[35m                    "primary_manager_responsibility": self.primary_manager_responsibility,[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m123 | [0m[35m                    or self.actual_state.db_name,[0m
[30;1m124 | [0m[35m                    "exporters.actual_state_historic.user": self.historic_state.user[0m
[30;1m125 | [0m[35m                    or self.actual_state.user,[0m
[30;1m126 | [0m[35m                    "exporters.actual_state_historic.password": secret_val_or_none([0m
[30;1m127 | [0m[35m                        self.historic_state.password[0m
[30;1m128 | [0m[35m                    )[0m
[30;1m129 | [0m[35m                    or secret_val_or_none(self.actual_state.password),[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m            "exporters.actual_state.db_name": self.actual_state.db_name,[0m
[30;1m107 | [0m[35m            "exporters.actual_state.user": self.actual_state.user,[0m
[30;1m108 | [0m[35m            "exporters.actual_state.password": secret_val_or_none([0m
[30;1m109 | [0m[35m                self.actual_state.password[0m
[30;1m110 | [0m[35m            ),[0m
[30;1m111 | [0m[35m            "primary_manager_responsibility": self.primary_manager_responsibility,[0m
[30;1m112 | [0m[35m            "exporters.actual_state.manager_responsibility_class": self.primary_manager_responsibili[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m            "exporters.actual_state.host": self.actual_state.host,[0m
[30;1m106 | [0m[35m            "exporters.actual_state.db_name": self.actual_state.db_name,[0m
[30;1m107 | [0m[35m            "exporters.actual_state.user": self.actual_state.user,[0m
[30;1m108 | [0m[35m            "exporters.actual_state.password": secret_val_or_none([0m
[30;1m109 | [0m[35m                self.actual_state.password[0m
[30;1m110 | [0m[35m            ),[0m
[30;1m111 | [0m[35m            "primary_manager_responsibility": self.primary_manager_responsibility,[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m    host: str | None[0m
[30;1m64 | [0m[35m    db_name: str[0m
[30;1m65 | [0m[35m    user: str | None[0m
[30;1m66 | [0m[35m    password: SecretStr | None[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mclass DatabaseSettings(JobSettings):[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m15 | [0m[35m    caplog.handler.setFormatter(formatter)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    logger.debug("password: %r", password)[0m
[30;1m18 | [0m[35m    assert password not in caplog.text[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14 | [0m[35m    # Patch pytest logging to use our custom log formatter[0m
[30;1m15 | [0m[35m    caplog.handler.setFormatter(formatter)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    logger.debug("password: %r", password)[0m
[30;1m18 | [0m[35m    assert password not in caplog.text[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14 | [0m[35m    # Patch pytest logging to use our custom log formatter[0m
[30;1m15 | [0m[35m    caplog.handler.setFormatter(formatter)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    logger.debug("password: %r", password)[0m
[30;1m18 | [0m[35m    assert password not in caplog.text[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35m    logger = logging.getLogger("testing")[0m
[30;1m8 | [0m[35m    password = "hunter2"[0m
[30;1m9 | [0m[35m    settings = {"global": {"password": password}}[0m
[30;1m10 | [0m[35m    formatter = PasswordRemovalFormatter(settings=settings)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m    # Capture logs on the "testing" logger at level DEBUG or higher[0m
[30;1m13 | [0m[35m    caplog.set_level(logging.DEBUG, "testing")[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m6 | [0m[35mdef test_password_removal(caplog):[0m
[30;1m7 | [0m[35m    logger = logging.getLogger("testing")[0m
[30;1m8 | [0m[35m    password = "hunter2"[0m
[30;1m9 | [0m[35m    settings = {"global": {"password": password}}[0m
[30;1m10 | [0m[35m    formatter = PasswordRemovalFormatter(settings=settings)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m    # Capture logs on the "testing" logger at level DEBUG or higher[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m6 | [0m[35mdef test_password_removal(caplog):[0m
[30;1m7 | [0m[35m    logger = logging.getLogger("testing")[0m
[30;1m8 | [0m[35m    password = "hunter2"[0m
[30;1m9 | [0m[35m    settings = {"global": {"password": password}}[0m
[30;1m10 | [0m[35m    formatter = PasswordRemovalFormatter(settings=settings)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m    # Capture logs on the "testing" logger at level DEBUG or higher[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mdef test_password_removal(caplog):[0m
[30;1m7 | [0m[35m    logger = logging.getLogger("testing")[0m
[30;1m8 | [0m[35m    password = "hunter2"[0m
[30;1m9 | [0m[35m    settings = {"global": {"password": password}}[0m
[30;1m10 | [0m[35m    formatter = PasswordRemovalFormatter(settings=settings)[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m3 | [0m[35mfrom ..ad_logger import PasswordRemovalFormatter[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mdef test_password_removal(caplog):[0m
[30;1m7 | [0m[35m    logger = logging.getLogger("testing")[0m
[30;1m8 | [0m[35m    password = "hunter2"[0m
[30;1m9 | [0m[35m    settings = {"global": {"password": password}}[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom ..ad_logger import PasswordRemovalFormatter[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mdef test_password_removal(caplog):[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/mocks.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m481 | [0m[35m            "method": "ntlm",[0m
[30;1m482 | [0m[35m            "cpr_separator": "",[0m
[30;1m483 | [0m[35m            "system_user": "system_user",[0m
[30;1m484 | [0m[35m            "password": "password",[0m
[30;1m485 | [0m[35m            "search_base": "search_base",[0m
[30;1m486 | [0m[35m            "cpr_field": "cpr_field",  # read by `ADWriter.get_from_ad`[0m
[30;1m487 | [0m[35m            "properties": [],  # read by `ADWriter._properties`[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/mocks.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m481 | [0m[35m            "method": "ntlm",[0m
[30;1m482 | [0m[35m            "cpr_separator": "",[0m
[30;1m483 | [0m[35m            "system_user": "system_user",[0m
[30;1m484 | [0m[35m            "password": "password",[0m
[30;1m485 | [0m[35m            "search_base": "search_base",[0m
[30;1m486 | [0m[35m            "cpr_field": "cpr_field",  # read by `ADWriter.get_from_ad`[0m
[30;1m487 | [0m[35m            "properties": [],  # read by `ADWriter._properties`[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_import.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m)[0m
[30;1m86 | [0m[35m@click.option([0m
[30;1m87 | [0m[35m    "--ftp-pass",[0m
[30;1m88 | [0m[35m    help="Password to use when logging into FTP server",[0m
[30;1m89 | [0m[35m)[0m
[30;1m90 | [0m[35m@click.option([0m
[30;1m91 | [0m[35m    "--ftp-folder",[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1065 | [0m[35m                            # We need to provide these to make[0m
[30;1m1066 | [0m[35m                            # `_read_global_settings` pass.[0m
[30;1m1067 | [0m[35m                            "system_user": "system_user",[0m
[30;1m1068 | [0m[35m                            "password": "password",[0m
[30;1m1069 | [0m[35m                            # We need to provide this to make[0m
[30;1m1070 | [0m[35m                            # `_read_primary_ad_settings` pass.[0m
[30;1m1071 | [0m[35m                            "cpr_field": "cpr_field",[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1065 | [0m[35m                            # We need to provide these to make[0m
[30;1m1066 | [0m[35m                            # `_read_global_settings` pass.[0m
[30;1m1067 | [0m[35m                            "system_user": "system_user",[0m
[30;1m1068 | [0m[35m                            "password": "password",[0m
[30;1m1069 | [0m[35m                            # We need to provide this to make[0m
[30;1m1070 | [0m[35m                            # `_read_primary_ad_settings` pass.[0m
[30;1m1071 | [0m[35m                            "cpr_field": "cpr_field",[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m147 | [0m[35m            self.ad_writer._ps_boiler_plate()["encoding"],[0m
[30;1m148 | [0m[35m            '$User = "' + self.settings["primary"]["system_user"] + '"',[0m
[30;1m149 | [0m[35m            '$PWord = ConvertTo-SecureString â€“String "'[0m
[30;1m150 | [0m[35m            + self.settings["primary"]["password"][0m
[30;1m151 | [0m[35m            + '" â€“AsPlainText -Force',[0m
[30;1m152 | [0m[35m            '$TypeName = "System.Management.Automation.PSCredential"',[0m
[30;1m153 | [0m[35m            ([0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m                dict_modifier({"primary": {"password": "Password1"}}),[0m
[30;1m107 | [0m[35m            ],[0m
[30;1m108 | [0m[35m            [[0m
[30;1m109 | [0m[35m                dict_modifier({"primary": {"password": "Hunter2"}}),[0m
[30;1m110 | [0m[35m            ],[0m
[30;1m111 | [0m[35m            # Test with overridden user[0m
[30;1m112 | [0m[35m            [[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m            ],[0m
[30;1m104 | [0m[35m            # Test with overridden password[0m
[30;1m105 | [0m[35m            [[0m
[30;1m106 | [0m[35m                dict_modifier({"primary": {"password": "Password1"}}),[0m
[30;1m107 | [0m[35m            ],[0m
[30;1m108 | [0m[35m            [[0m
[30;1m109 | [0m[35m                dict_modifier({"primary": {"password": "Hunter2"}}),[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m            ],[0m
[30;1m104 | [0m[35m            # Test with overridden password[0m
[30;1m105 | [0m[35m            [[0m
[30;1m106 | [0m[35m                dict_modifier({"primary": {"password": "Password1"}}),[0m
[30;1m107 | [0m[35m            ],[0m
[30;1m108 | [0m[35m            [[0m
[30;1m109 | [0m[35m                dict_modifier({"primary": {"password": "Hunter2"}}),[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m101 | [0m[35m            [[0m
[30;1m102 | [0m[35m                dict_modifier({}),[0m
[30;1m103 | [0m[35m            ],[0m
[30;1m104 | [0m[35m            # Test with overridden password[0m
[30;1m105 | [0m[35m            [[0m
[30;1m106 | [0m[35m                dict_modifier({"primary": {"password": "Password1"}}),[0m
[30;1m107 | [0m[35m            ],[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m296 | [0m[35m                    "cpr_field": "cpr_field",[0m
[30;1m297 | [0m[35m                    "cpr_separator": "ad_cpr_sep",[0m
[30;1m298 | [0m[35m                    "system_user": "system_user",[0m
[30;1m299 | [0m[35m                    "password": "password",[0m
[30;1m300 | [0m[35m                    "properties": [],[0m
[30;1m301 | [0m[35m                    "search_base": "search_base",[0m
[30;1m302 | [0m[35m                    "integrations.ad.ad_mo_sync_mapping": {},[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m296 | [0m[35m                    "cpr_field": "cpr_field",[0m
[30;1m297 | [0m[35m                    "cpr_separator": "ad_cpr_sep",[0m
[30;1m298 | [0m[35m                    "system_user": "system_user",[0m
[30;1m299 | [0m[35m                    "password": "password",[0m
[30;1m300 | [0m[35m                    "properties": [],[0m
[30;1m301 | [0m[35m                    "search_base": "search_base",[0m
[30;1m302 | [0m[35m                    "integrations.ad.ad_mo_sync_mapping": {},[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m133 | [0m[35m        "OtherName",[0m
[30;1m134 | [0m[35m        "Partition",[0m
[30;1m135 | [0m[35m        "PasswordNeverExpires",[0m
[30;1m136 | [0m[35m        "PasswordNotRequired",[0m
[30;1m137 | [0m[35m        "POBox",[0m
[30;1m138 | [0m[35m        "PostalCode",[0m
[30;1m139 | [0m[35m        "PrincipalsAllowedToDelegateToAccount",[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m132 | [0m[35m        "Organization",[0m
[30;1m133 | [0m[35m        "OtherName",[0m
[30;1m134 | [0m[35m        "Partition",[0m
[30;1m135 | [0m[35m        "PasswordNeverExpires",[0m
[30;1m136 | [0m[35m        "PasswordNotRequired",[0m
[30;1m137 | [0m[35m        "POBox",[0m
[30;1m138 | [0m[35m        "PostalCode",[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m        "AuthType",[0m
[30;1m101 | [0m[35m        "CannotChangePassword",[0m
[30;1m102 | [0m[35m        "Certificates",[0m
[30;1m103 | [0m[35m        "ChangePasswordAtLogon",[0m
[30;1m104 | [0m[35m        "City",[0m
[30;1m105 | [0m[35m        "Clear",[0m
[30;1m106 | [0m[35m        "Company",[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m        "Add",[0m
[30;1m99 | [0m[35m        "AllowReversiblePasswordEncryption",[0m
[30;1m100 | [0m[35m        "AuthType",[0m
[30;1m101 | [0m[35m        "CannotChangePassword",[0m
[30;1m102 | [0m[35m        "Certificates",[0m
[30;1m103 | [0m[35m        "ChangePasswordAtLogon",[0m
[30;1m104 | [0m[35m        "City",[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m        "AccountExpirationDate",[0m
[30;1m97 | [0m[35m        "AccountNotDelegated",[0m
[30;1m98 | [0m[35m        "Add",[0m
[30;1m99 | [0m[35m        "AllowReversiblePasswordEncryption",[0m
[30;1m100 | [0m[35m        "AuthType",[0m
[30;1m101 | [0m[35m        "CannotChangePassword",[0m
[30;1m102 | [0m[35m        "Certificates",[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m71 | [0m[35m        "OtherAttributes",[0m
[30;1m72 | [0m[35m        "OtherName",[0m
[30;1m73 | [0m[35m        "PasswordNeverExpires",[0m
[30;1m74 | [0m[35m        "PasswordNotRequired",[0m
[30;1m75 | [0m[35m        "Path",[0m
[30;1m76 | [0m[35m        "POBox",[0m
[30;1m77 | [0m[35m        "PostalCode",[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m70 | [0m[35m        "Organization",[0m
[30;1m71 | [0m[35m        "OtherAttributes",[0m
[30;1m72 | [0m[35m        "OtherName",[0m
[30;1m73 | [0m[35m        "PasswordNeverExpires",[0m
[30;1m74 | [0m[35m        "PasswordNotRequired",[0m
[30;1m75 | [0m[35m        "Path",[0m
[30;1m76 | [0m[35m        "POBox",[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m38 | [0m[35m        "AuthType",[0m
[30;1m39 | [0m[35m        "CannotChangePassword",[0m
[30;1m40 | [0m[35m        "Certificates",[0m
[30;1m41 | [0m[35m        "ChangePasswordAtLogon",[0m
[30;1m42 | [0m[35m        "City",[0m
[30;1m43 | [0m[35m        "Company",[0m
[30;1m44 | [0m[35m        "CompoundIdentitySupported",[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m36 | [0m[35m        "AccountPassword",[0m
[30;1m37 | [0m[35m        "AllowReversiblePasswordEncryption",[0m
[30;1m38 | [0m[35m        "AuthType",[0m
[30;1m39 | [0m[35m        "CannotChangePassword",[0m
[30;1m40 | [0m[35m        "Certificates",[0m
[30;1m41 | [0m[35m        "ChangePasswordAtLogon",[0m
[30;1m42 | [0m[35m        "City",[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m34 | [0m[35m        "AccountExpirationDate",[0m
[30;1m35 | [0m[35m        "AccountNotDelegated",[0m
[30;1m36 | [0m[35m        "AccountPassword",[0m
[30;1m37 | [0m[35m        "AllowReversiblePasswordEncryption",[0m
[30;1m38 | [0m[35m        "AuthType",[0m
[30;1m39 | [0m[35m        "CannotChangePassword",[0m
[30;1m40 | [0m[35m        "Certificates",[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m    "New-ADUser": {[0m
[30;1m34 | [0m[35m        "AccountExpirationDate",[0m
[30;1m35 | [0m[35m        "AccountNotDelegated",[0m
[30;1m36 | [0m[35m        "AccountPassword",[0m
[30;1m37 | [0m[35m        "AllowReversiblePasswordEncryption",[0m
[30;1m38 | [0m[35m        "AuthType",[0m
[30;1m39 | [0m[35m        "CannotChangePassword",[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m# Parameters that should not be quoted[0m
[30;1m28 | [0m[35mno_quote_list = ["Credential", "Enabled", "AccountPassword"][0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mcmdlet_parameters = {[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m381 | [0m[35m    """Build a complete powershell command template.[0m
[30;1m382 | [0m[35m[0m
[30;1m383 | [0m[35m    Args:[0m
[30;1m384 | [0m[35m        environment: Jinja2 `Environment` instance[0m
[30;1m385 | [0m[35m        cmd: command to generate template for.[0m
[30;1m386 | [0m[35m        settings: dictionary containing settings from settings.json[0m
[30;1m387 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_file_reader.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m67 | [0m[35m        user = self.settings["integrations.opus.smb_user"][0m
[30;1m68 | [0m[35m        password = self.settings["integrations.opus.smb_password"][0m
[30;1m69 | [0m[35m        smb_host = self.settings["integrations.opus.smb_host"][0m
[30;1m70 | [0m[35m        self.smb_fs = fs.open_fs(f"smb://{user}:{password}@{smb_host}")[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    @retry(**retry_args)[0m
[30;1m73 | [0m[35m    def list_opus_files(self) -> Dict[datetime.datetime, str]:[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_file_reader.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m    def __init__(self, settings):[0m
[30;1m66 | [0m[35m        self.settings = settings[0m
[30;1m67 | [0m[35m        user = self.settings["integrations.opus.smb_user"][0m
[30;1m68 | [0m[35m        password = self.settings["integrations.opus.smb_password"][0m
[30;1m69 | [0m[35m        smb_host = self.settings["integrations.opus.smb_host"][0m
[30;1m70 | [0m[35m        self.smb_fs = fs.open_fs(f"smb://{user}:{password}@{smb_host}")[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_file_reader.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m    def __init__(self, settings):[0m
[30;1m66 | [0m[35m        self.settings = settings[0m
[30;1m67 | [0m[35m        user = self.settings["integrations.opus.smb_user"][0m
[30;1m68 | [0m[35m        password = self.settings["integrations.opus.smb_password"][0m
[30;1m69 | [0m[35m        smb_host = self.settings["integrations.opus.smb_host"][0m
[30;1m70 | [0m[35m        self.smb_fs = fs.open_fs(f"smb://{user}:{password}@{smb_host}")[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m        "system_user"[0m
[30;1m47 | [0m[35m    )[0m
[30;1m48 | [0m[35m    primary_settings["password"] = top_settings["integrations.ad"][index].get([0m
[30;1m49 | [0m[35m        "password"[0m
[30;1m50 | [0m[35m    )[0m
[30;1m51 | [0m[35m    primary_settings["properties"] = top_settings["integrations.ad"][index].get([0m
[30;1m52 | [0m[35m        "properties"[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m    primary_settings["system_user"] = top_settings["integrations.ad"][index].get([0m
[30;1m46 | [0m[35m        "system_user"[0m
[30;1m47 | [0m[35m    )[0m
[30;1m48 | [0m[35m    primary_settings["password"] = top_settings["integrations.ad"][index].get([0m
[30;1m49 | [0m[35m        "password"[0m
[30;1m50 | [0m[35m    )[0m
[30;1m51 | [0m[35m    primary_settings["properties"] = top_settings["integrations.ad"][index].get([0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m    )[0m
[30;1m19 | [0m[35m    global_settings["winrm_host"] = top_settings.get("integrations.ad.winrm_host")[0m
[30;1m20 | [0m[35m    global_settings["system_user"] = top_settings["integrations.ad"][0]["system_user"][0m
[30;1m21 | [0m[35m    global_settings["password"] = top_settings["integrations.ad"][0]["password"][0m
[30;1m22 | [0m[35m    if not global_settings["winrm_host"]:[0m
[30;1m23 | [0m[35m        msg = "Missing hostname for remote management server"[0m
[30;1m24 | [0m[35m        logger.error(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m    )[0m
[30;1m19 | [0m[35m    global_settings["winrm_host"] = top_settings.get("integrations.ad.winrm_host")[0m
[30;1m20 | [0m[35m    global_settings["system_user"] = top_settings["integrations.ad"][0]["system_user"][0m
[30;1m21 | [0m[35m    global_settings["password"] = top_settings["integrations.ad"][0]["password"][0m
[30;1m22 | [0m[35m    if not global_settings["winrm_host"]:[0m
[30;1m23 | [0m[35m        msg = "Missing hostname for remote management server"[0m
[30;1m24 | [0m[35m        logger.error(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m    )[0m
[30;1m125 | [0m[35m    user = get_db_username(database_function, settings)[0m
[30;1m126 | [0m[35m    db_host = get_db_host(database_function, settings)[0m
[30;1m127 | [0m[35m    pw_raw = get_db_password(database_function, settings)[0m
[30;1m128 | [0m[35m    pw_raw = pw_raw or ""[0m
[30;1m129 | [0m[35m    pw = urllib.parse.quote_plus(pw_raw)[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mget_db_host = partial(load_setting, "host")[0m
[30;1m101 | [0m[35mget_db_username = partial(load_setting, "username")[0m
[30;1m102 | [0m[35mget_db_password = partial(load_setting, "password")[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35mdef generate_db_type_and_name([0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mget_db_host = partial(load_setting, "host")[0m
[30;1m101 | [0m[35mget_db_username = partial(load_setting, "username")[0m
[30;1m102 | [0m[35mget_db_password = partial(load_setting, "password")[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35mdef generate_db_type_and_name([0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m41 | [0m[35m    DatabaseFunction.ACTUAL_STATE_HISTORIC: {[0m
[30;1m42 | [0m[35m        "host": "exporters.actual_state.host",[0m
[30;1m43 | [0m[35m        "username": "exporters.actual_state.user",[0m
[30;1m44 | [0m[35m        "password": "exporters.actual_state.password",[0m
[30;1m45 | [0m[35m    },[0m
[30;1m46 | [0m[35m}[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m41 | [0m[35m    DatabaseFunction.ACTUAL_STATE_HISTORIC: {[0m
[30;1m42 | [0m[35m        "host": "exporters.actual_state.host",[0m
[30;1m43 | [0m[35m        "username": "exporters.actual_state.user",[0m
[30;1m44 | [0m[35m        "password": "exporters.actual_state.password",[0m
[30;1m45 | [0m[35m    },[0m
[30;1m46 | [0m[35m}[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m        "host": "exporters.actual_state_historic.host",[0m
[30;1m32 | [0m[35m        "db_name": "exporters.actual_state_historic.db_name",[0m
[30;1m33 | [0m[35m        "username": "exporters.actual_state_historic.user",[0m
[30;1m34 | [0m[35m        "password": "exporters.actual_state_historic.password",[0m
[30;1m35 | [0m[35m    },[0m
[30;1m36 | [0m[35m}[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m        "host": "exporters.actual_state_historic.host",[0m
[30;1m32 | [0m[35m        "db_name": "exporters.actual_state_historic.db_name",[0m
[30;1m33 | [0m[35m        "username": "exporters.actual_state_historic.user",[0m
[30;1m34 | [0m[35m        "password": "exporters.actual_state_historic.password",[0m
[30;1m35 | [0m[35m    },[0m
[30;1m36 | [0m[35m}[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m        "host": "exporters.actual_state.host",[0m
[30;1m25 | [0m[35m        "db_name": "exporters.actual_state.db_name",[0m
[30;1m26 | [0m[35m        "username": "exporters.actual_state.user",[0m
[30;1m27 | [0m[35m        "password": "exporters.actual_state.password",[0m
[30;1m28 | [0m[35m    },[0m
[30;1m29 | [0m[35m    DatabaseFunction.ACTUAL_STATE_HISTORIC: {[0m
[30;1m30 | [0m[35m        "type": "exporters.actual_state_historic.type",[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m        "host": "exporters.actual_state.host",[0m
[30;1m25 | [0m[35m        "db_name": "exporters.actual_state.db_name",[0m
[30;1m26 | [0m[35m        "username": "exporters.actual_state.user",[0m
[30;1m27 | [0m[35m        "password": "exporters.actual_state.password",[0m
[30;1m28 | [0m[35m    },[0m
[30;1m29 | [0m[35m    DatabaseFunction.ACTUAL_STATE_HISTORIC: {[0m
[30;1m30 | [0m[35m        "type": "exporters.actual_state_historic.type",[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_read_ad_conf_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m91 | [0m[35m            "primary": {[0m
[30;1m92 | [0m[35m                "cpr_field": "EmployeeID",[0m
[30;1m93 | [0m[35m                "method": "ntlm",[0m
[30;1m94 | [0m[35m                "password": "pwd",[0m
[30;1m95 | [0m[35m                "properties": [[0m
[30;1m96 | [0m[35m                    "givenName",[0m
[30;1m97 | [0m[35m                    "surname",[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_read_ad_conf_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m83 | [0m[35m        old_settings = {[0m
[30;1m84 | [0m[35m            "global": {[0m
[30;1m85 | [0m[35m                "mora.base": "http://localhost:5000",[0m
[30;1m86 | [0m[35m                "password": "pwd",[0m
[30;1m87 | [0m[35m                "servers": [],[0m
[30;1m88 | [0m[35m                "system_user": "os2mo",[0m
[30;1m89 | [0m[35m                "winrm_host": "AD",[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_read_ad_conf_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m        "integrations.ad": [[0m
[30;1m18 | [0m[35m            {[0m
[30;1m19 | [0m[35m                "system_user": "system_user",[0m
[30;1m20 | [0m[35m                "password": "password",[0m
[30;1m21 | [0m[35m                "search_base": "search_base",[0m
[30;1m22 | [0m[35m                "cpr_field": "cpr_field",[0m
[30;1m23 | [0m[35m                "properties": properties,[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_read_ad_conf_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m        "integrations.ad": [[0m
[30;1m18 | [0m[35m            {[0m
[30;1m19 | [0m[35m                "system_user": "system_user",[0m
[30;1m20 | [0m[35m                "password": "password",[0m
[30;1m21 | [0m[35m                "search_base": "search_base",[0m
[30;1m22 | [0m[35m                "cpr_field": "cpr_field",[0m
[30;1m23 | [0m[35m                "properties": properties,[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m        "formatters": {[0m
[30;1m34 | [0m[35m            "default": {[0m
[30;1m35 | [0m[35m                "format": "%(levelname)s %(asctime)s %(name)s: %(message)s",[0m
[30;1m36 | [0m[35m                "()": PasswordRemovalFormatter,[0m
[30;1m37 | [0m[35m                "settings": kwargs.get("settings") or read_settings(),[0m
[30;1m38 | [0m[35m            },[0m
[30;1m39 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def _remove_password(self, s):[0m
[30;1m24 | [0m[35m        for password in self._passwords:[0m
[30;1m25 | [0m[35m            s = s.replace(password, "*" * len(password))[0m
[30;1m26 | [0m[35m        return s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def _remove_password(self, s):[0m
[30;1m24 | [0m[35m        for password in self._passwords:[0m
[30;1m25 | [0m[35m            s = s.replace(password, "*" * len(password))[0m
[30;1m26 | [0m[35m        return s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m                yield password[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def _remove_password(self, s):[0m
[30;1m24 | [0m[35m        for password in self._passwords:[0m
[30;1m25 | [0m[35m            s = s.replace(password, "*" * len(password))[0m
[30;1m26 | [0m[35m        return s[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m                yield password[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def _remove_password(self, s):[0m
[30;1m24 | [0m[35m        for password in self._passwords:[0m
[30;1m25 | [0m[35m            s = s.replace(password, "*" * len(password))[0m
[30;1m26 | [0m[35m        return s[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m20 | [0m[35m            if password:[0m
[30;1m21 | [0m[35m                yield password[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def _remove_password(self, s):[0m
[30;1m24 | [0m[35m        for password in self._passwords:[0m
[30;1m25 | [0m[35m            s = s.replace(password, "*" * len(password))[0m
[30;1m26 | [0m[35m        return s[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m        for key in ("primary", "global"):[0m
[30;1m19 | [0m[35m            password = settings.get(key, {}).get("password")[0m
[30;1m20 | [0m[35m            if password:[0m
[30;1m21 | [0m[35m                yield password[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def _remove_password(self, s):[0m
[30;1m24 | [0m[35m        for password in self._passwords:[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m    def _get_passwords_from_settings(self, settings):[0m
[30;1m18 | [0m[35m        for key in ("primary", "global"):[0m
[30;1m19 | [0m[35m            password = settings.get(key, {}).get("password")[0m
[30;1m20 | [0m[35m            if password:[0m
[30;1m21 | [0m[35m                yield password[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def _remove_password(self, s):[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def _get_passwords_from_settings(self, settings):[0m
[30;1m18 | [0m[35m        for key in ("primary", "global"):[0m
[30;1m19 | [0m[35m            password = settings.get(key, {}).get("password")[0m
[30;1m20 | [0m[35m            if password:[0m
[30;1m21 | [0m[35m                yield password[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def _get_passwords_from_settings(self, settings):[0m
[30;1m18 | [0m[35m        for key in ("primary", "global"):[0m
[30;1m19 | [0m[35m            password = settings.get(key, {}).get("password")[0m
[30;1m20 | [0m[35m            if password:[0m
[30;1m21 | [0m[35m                yield password[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14 | [0m[35m        original = logging.Formatter.format(self, record)[0m
[30;1m15 | [0m[35m        return self._remove_password(original)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def _get_passwords_from_settings(self, settings):[0m
[30;1m18 | [0m[35m        for key in ("primary", "global"):[0m
[30;1m19 | [0m[35m            password = settings.get(key, {}).get("password")[0m
[30;1m20 | [0m[35m            if password:[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    def format(self, record):[0m
[30;1m14 | [0m[35m        original = logging.Formatter.format(self, record)[0m
[30;1m15 | [0m[35m        return self._remove_password(original)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def _get_passwords_from_settings(self, settings):[0m
[30;1m18 | [0m[35m        for key in ("primary", "global"):[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8 | [0m[35m    def __init__(self, *args, **kwargs):[0m
[30;1m9 | [0m[35m        settings = kwargs.pop("settings")[0m
[30;1m10 | [0m[35m        super().__init__(*args, **kwargs)[0m
[30;1m11 | [0m[35m        self._passwords = set(self._get_passwords_from_settings(settings))[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    def format(self, record):[0m
[30;1m14 | [0m[35m        original = logging.Formatter.format(self, record)[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8 | [0m[35m    def __init__(self, *args, **kwargs):[0m
[30;1m9 | [0m[35m        settings = kwargs.pop("settings")[0m
[30;1m10 | [0m[35m        super().__init__(*args, **kwargs)[0m
[30;1m11 | [0m[35m        self._passwords = set(self._get_passwords_from_settings(settings))[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    def format(self, record):[0m
[30;1m14 | [0m[35m        original = logging.Formatter.format(self, record)[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4 | [0m[35mfrom .read_ad_conf_settings import read_settings[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mclass PasswordRemovalFormatter(logging.Formatter):[0m
[30;1m8 | [0m[35m    def __init__(self, *args, **kwargs):[0m
[30;1m9 | [0m[35m        settings = kwargs.pop("settings")[0m
[30;1m10 | [0m[35m        super().__init__(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_fix_enddate.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m    "primary": {[0m
[30;1m41 | [0m[35m        "search_base": TEST_SEARCH_BASE,[0m
[30;1m42 | [0m[35m        "system_user": "username",[0m
[30;1m43 | [0m[35m        "password": "password",[0m
[30;1m44 | [0m[35m    },[0m
[30;1m45 | [0m[35m}[0m
[30;1m46 | [0m[35mVALID_AD_DATE = "2020-01-01"[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_fix_enddate.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m    "primary": {[0m
[30;1m41 | [0m[35m        "search_base": TEST_SEARCH_BASE,[0m
[30;1m42 | [0m[35m        "system_user": "username",[0m
[30;1m43 | [0m[35m        "password": "password",[0m
[30;1m44 | [0m[35m    },[0m
[30;1m45 | [0m[35m}[0m
[30;1m46 | [0m[35mVALID_AD_DATE = "2020-01-01"[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m962 | [0m[35m[0m
[30;1m963 | [0m[35m        # Add globally available vars[0m
[30;1m964 | [0m[35m        environment.globals["_upn_end"] = self.settings["primary_write"]["upn_end"][0m
[30;1m965 | [0m[35m        environment.globals["_get_all_ad_emails"] = get_all_ad_emails[0m
[30;1m966 | [0m[35m[0m
[30;1m967 | [0m[35m        return environment[0m
[30;1m968 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m        self._use_graphql_source_if_feature_flagged()[0m
[30;1m517 | [0m[35m        self._init_name_creator()[0m
[30;1m518 | [0m[35m        self._environment = self._get_jinja_environment()[0m
[30;1m519 | [0m[35m        self._reader = ADParameterReader()[0m
[30;1m520 | [0m[35m[0m
[30;1m521 | [0m[35m    def read_user(self, user=None, cpr=None):[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m292 | [0m[35m            url=f"{self._settings['global']['mora.base']}/graphql/v22",[0m
[30;1m293 | [0m[35m            client_id=os.environ.get("CLIENT_ID", "dipex"),[0m
[30;1m294 | [0m[35m            client_secret=os.environ["CLIENT_SECRET"],[0m
[30;1m295 | [0m[35m            auth_realm=os.environ.get("AUTH_REALM", "mo"),[0m
[30;1m296 | [0m[35m            auth_server=os.environ["AUTH_SERVER"],[0m
[30;1m297 | [0m[35m            sync=True,[0m
[30;1m298 | [0m[35m            httpx_client_kwargs={"timeout": None},[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m290 | [0m[35m    def _get_client(self):[0m
[30;1m291 | [0m[35m        return GraphQLClient([0m
[30;1m292 | [0m[35m            url=f"{self._settings['global']['mora.base']}/graphql/v22",[0m
[30;1m293 | [0m[35m            client_id=os.environ.get("CLIENT_ID", "dipex"),[0m
[30;1m294 | [0m[35m            client_secret=os.environ["CLIENT_SECRET"],[0m
[30;1m295 | [0m[35m            auth_realm=os.environ.get("AUTH_REALM", "mo"),[0m
[30;1m296 | [0m[35m            auth_server=os.environ["AUTH_SERVER"],[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/tests/test_util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m) -> typing.AsyncGenerator[ClientSession, None]:[0m
[30;1m158 | [0m[35m    mora_base = "http://example.com:8080"[0m
[30;1m159 | [0m[35m    # Mock a response from MO[0m
[30;1m160 | [0m[35m    aioresponses.post([0m
[30;1m161 | [0m[35m        f"{mora_base}{mo_endpoint}?force=1",[0m
[30;1m162 | [0m[35m        status=mo_http_status,[0m
[30;1m163 | [0m[35m        payload=mo_response or {},[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/tests/test_util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m    # Expect no exceptions if 404 is ignored[0m
[30;1m192 | [0m[35m    await _run_test(ignored_http_statuses=(404,))[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    # Expect an exception if `raise_for_status` is called in `submit_payloads`[0m
[30;1m195 | [0m[35m    with pytest.raises(ClientResponseError):[0m
[30;1m196 | [0m[35m        await _run_test(ignored_http_statuses=None)[0m
[30;1m197 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/tests/test_util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m                ignored_http_statuses=ignored_http_statuses,[0m
[30;1m189 | [0m[35m            )[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    # Expect no exceptions if 404 is ignored[0m
[30;1m192 | [0m[35m    await _run_test(ignored_http_statuses=(404,))[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    # Expect an exception if `raise_for_status` is called in `submit_payloads`[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/org_tree_print/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m    output = {}[0m
[30;1m79 | [0m[35m    for root in children_map.get(entry, []):[0m
[30;1m80 | [0m[35m        output[root] = {}[0m
[30;1m81 | [0m[35m        for entry in children_map.get(root, []):[0m
[30;1m82 | [0m[35m            output[root][entry] = recursive_build_tree(children_map, entry)[0m
[30;1m83 | [0m[35m    return output[0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/org_tree_print/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m        dict: Tree structure[0m
[30;1m77 | [0m[35m    """[0m
[30;1m78 | [0m[35m    output = {}[0m
[30;1m79 | [0m[35m    for root in children_map.get(entry, []):[0m
[30;1m80 | [0m[35m        output[root] = {}[0m
[30;1m81 | [0m[35m        for entry in children_map.get(root, []):[0m
[30;1m82 | [0m[35m            output[root][entry] = recursive_build_tree(children_map, entry)[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/tests/test_los_leder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m        with self._mock_lookup_employees(return_value=mock_employee_list):[0m
[30;1m247 | [0m[35m            instance.cache_cpr()[0m
[30;1m248 | [0m[35m            unique_mock_cprs = set([0m
[30;1m249 | [0m[35m                emp["cpr_no"] for emp in mock_employee_list if emp.get("cpr_no")[0m
[30;1m250 | [0m[35m            )[0m
[30;1m251 | [0m[35m            assert set(instance.cpr_cache.keys()) == unique_mock_cprs[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m.hostname[0m
[30;1m126 | [0m[35m        else:[0m
[30;1m127 | [0m[35m            try:[0m
[30;1m128 | [0m[35m                ssh.connect([0m
[30;1m129 | [0m[35m                    hostname=self._settings.ftp_url,[0m
[30;1m130 | [0m[35m                    port=self._settings.ftp_port,[0m
[30;1m131 | [0m[35m                    username=self._settings.ftp_user,[0m
[30;1m132 | [0m[35m                    password=self._settings.ftp_pass,[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35mdef read_csv(filename: str, model: T) -> List[T]:[0m
[30;1m281 | [0m[35m    """Read CSV file from FTP into list of model objects"""[0m
[30;1m282 | [0m[35m    logger.info("Processing %s", filename)[0m
[30;1m283 | [0m[35m    fileset = get_fileset_implementation()[0m
[30;1m284 | [0m[35m    lines = fileset.read_file(filename)[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35m        return filenames[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    def get_modified_datetime(self, filename: str) -> datetime:[0m
[30;1m157 | [0m[35m        """Read the 'modified' field from an FTP file"""[0m
[30;1m158 | [0m[35m        ssh, sftp = self._get_sftp_connector()[0m
[30;1m159 | [0m[35m        file_stats = sftp.stat(filename)[0m
[30;1m160 | [0m[35m        sftp.close()[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m            except Exception as e:[0m
[30;1m141 | [0m[35m                raise config.ImproperlyConfigured([0m
[30;1m142 | [0m[35m                    "cannot connect to FTP server %r"[0m
[30;1m143 | [0m[35m                    % getattr(self._settings, "ftp_url", None)[0m
[30;1m144 | [0m[35m                ) from e[0m
[30;1m145 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m120 | [0m[35m            )[0m
[30;1m121 | [0m[35m        except Exception as e:[0m
[30;1m122 | [0m[35m            raise config.ImproperlyConfigured([0m
[30;1m123 | [0m[35m                "cannot connect to FTP server %r"[0m
[30;1m124 | [0m[35m                % getattr(self._settings, "ftp_url", None)[0m
[30;1m125 | [0m[35m            ) from e[0m
[30;1m126 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m97 | [0m[35m        return lines[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    def write_file(self, filename: str, stream: StringIO, folder: Optional[str] = None):[0m
[30;1m100 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m101 | [0m[35m        if folder:[0m
[30;1m102 | [0m[35m            ftp.cwd(folder)[0m
[30;1m103 | [0m[35m        result = ftp.storlines([0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m        return datetime.strptime(modify_string, "%Y%m%d%H%M%S")[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    def read_file(self, filename: str) -> List[str]:[0m
[30;1m94 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m95 | [0m[35m        lines: List[str] = [][0m
[30;1m96 | [0m[35m        ftp.retrlines(f"RETR {filename}", lines.append)[0m
[30;1m97 | [0m[35m        return lines[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    def get_modified_datetime(self, filename: str) -> datetime:[0m
[30;1m84 | [0m[35m        """Read the 'modified' field from an FTP file"""[0m
[30;1m85 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m86 | [0m[35m        files = ftp.mlsd()[0m
[30;1m87 | [0m[35m        found_file = one(filter(lambda x: x[0] == filename, files))[0m
[30;1m88 | [0m[35m        filename, facts = found_file[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m        return filenames[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    def get_modified_datetime(self, filename: str) -> datetime:[0m
[30;1m84 | [0m[35m        """Read the 'modified' field from an FTP file"""[0m
[30;1m85 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m86 | [0m[35m        files = ftp.mlsd()[0m
[30;1m87 | [0m[35m        found_file = one(filter(lambda x: x[0] == filename, files))[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m76 | [0m[35m            return ftp[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    def get_import_filenames(self) -> List[str]:[0m
[30;1m79 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m80 | [0m[35m        filenames = ftp.nlst()[0m
[30;1m81 | [0m[35m        return filenames[0m
[30;1m82 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m73 | [0m[35m            ftp.encoding = "utf-8"[0m
[30;1m74 | [0m[35m            ftp.login(user=self._settings.ftp_user, passwd=self._settings.ftp_pass)[0m
[30;1m75 | [0m[35m            ftp.cwd(self._settings.ftp_folder)[0m
[30;1m76 | [0m[35m            return ftp[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    def get_import_filenames(self) -> List[str]:[0m
[30;1m79 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m80 | [0m[35m        filenames = ftp.nlst()[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m66 | [0m[35m            ftp = FTP(self._settings.ftp_url)[0m
[30;1m67 | [0m[35m        except Exception as e:[0m
[30;1m68 | [0m[35m            raise config.ImproperlyConfigured([0m
[30;1m69 | [0m[35m                "cannot connect to FTP server %r"[0m
[30;1m70 | [0m[35m                % getattr(self._settings, "ftp_url", None)[0m
[30;1m71 | [0m[35m            ) from e[0m
[30;1m72 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m63 | [0m[35mclass FTPFileSet(FileSet):[0m
[30;1m64 | [0m[35m    def _get_ftp_connector(self) -> FTP:[0m
[30;1m65 | [0m[35m        try:[0m
[30;1m66 | [0m[35m            ftp = FTP(self._settings.ftp_url)[0m
[30;1m67 | [0m[35m        except Exception as e:[0m
[30;1m68 | [0m[35m            raise config.ImproperlyConfigured([0m
[30;1m69 | [0m[35m                "cannot connect to FTP server %r"[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m5 | [0m[35mimport warnings[0m
[30;1m6 | [0m[35mfrom abc import ABC[0m
[30;1m7 | [0m[35mfrom datetime import datetime[0m
[30;1m8 | [0m[35mfrom ftplib import FTP[0m
[30;1m9 | [0m[35mfrom io import BytesIO[0m
[30;1m10 | [0m[35mfrom io import StringIO[0m
[30;1m11 | [0m[35mfrom operator import itemgetter[0m
[30;1m12 | [0m[35mfrom typing import Iterable[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35mdef read_csv(filename: str, model: T) -> List[T]:[0m
[30;1m281 | [0m[35m    """Read CSV file from FTP into list of model objects"""[0m
[30;1m282 | [0m[35m    logger.info("Processing %s", filename)[0m
[30;1m283 | [0m[35m    fileset = get_fileset_implementation()[0m
[30;1m284 | [0m[35m    lines = fileset.read_file(filename)[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m174 | [0m[35m        return lines[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m    def write_file(self, filename: str, stream: StringIO, folder: Optional[str] = None):[0m
[30;1m177 | [0m[35m        ssh, sftp = self._get_sftp_connector()[0m
[30;1m178 | [0m[35m        if folder:[0m
[30;1m179 | [0m[35m            try:[0m
[30;1m180 | [0m[35m                sftp.chdir(folder)[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m165 | [0m[35m        return datetime.fromtimestamp(float(modified_time))[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    def read_file(self, filename: str) -> List[str]:[0m
[30;1m168 | [0m[35m        ssh, sftp = self._get_sftp_connector()[0m
[30;1m169 | [0m[35m        file = sftp.file(filename=filename, mode="r")[0m
[30;1m170 | [0m[35m        lines = file.readlines()[0m
[30;1m171 | [0m[35m        file.close()[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    def get_modified_datetime(self, filename: str) -> datetime:[0m
[30;1m157 | [0m[35m        """Read the 'modified' field from an FTP file"""[0m
[30;1m158 | [0m[35m        ssh, sftp = self._get_sftp_connector()[0m
[30;1m159 | [0m[35m        file_stats = sftp.stat(filename)[0m
[30;1m160 | [0m[35m        sftp.close()[0m
[30;1m161 | [0m[35m        ssh.close()[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m        return filenames[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    def get_modified_datetime(self, filename: str) -> datetime:[0m
[30;1m157 | [0m[35m        """Read the 'modified' field from an FTP file"""[0m
[30;1m158 | [0m[35m        ssh, sftp = self._get_sftp_connector()[0m
[30;1m159 | [0m[35m        file_stats = sftp.stat(filename)[0m
[30;1m160 | [0m[35m        sftp.close()[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m147 | [0m[35m                return ssh, sftp[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def get_import_filenames(self) -> List[str]:[0m
[30;1m150 | [0m[35m        ssh, sftp = self._get_sftp_connector()[0m
[30;1m151 | [0m[35m        filenames = sftp.listdir()[0m
[30;1m152 | [0m[35m        sftp.close()[0m
[30;1m153 | [0m[35m        ssh.close()[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m                ) from e[0m
[30;1m145 | [0m[35m            else:[0m
[30;1m146 | [0m[35m                sftp.chdir(self._settings.ftp_folder)[0m
[30;1m147 | [0m[35m                return ssh, sftp[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def get_import_filenames(self) -> List[str]:[0m
[30;1m150 | [0m[35m        ssh, sftp = self._get_sftp_connector()[0m
[30;1m151 | [0m[35m        filenames = sftp.listdir()[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m            except Exception as e:[0m
[30;1m141 | [0m[35m                raise config.ImproperlyConfigured([0m
[30;1m142 | [0m[35m                    "cannot connect to FTP server %r"[0m
[30;1m143 | [0m[35m                    % getattr(self._settings, "ftp_url", None)[0m
[30;1m144 | [0m[35m                ) from e[0m
[30;1m145 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m                    pkey=pkey,[0m
[30;1m134 | [0m[35m                )[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m                sftp = ssh.open_sftp()[0m
[30;1m137 | [0m[35m                if not sftp:[0m
[30;1m138 | [0m[35m                    raise[0m
[30;1m139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m            )[0m
[30;1m121 | [0m[35m        except Exception as e:[0m
[30;1m122 | [0m[35m            raise config.ImproperlyConfigured([0m
[30;1m123 | [0m[35m                "cannot connect to FTP server %r"[0m
[30;1m124 | [0m[35m                % getattr(self._settings, "ftp_url", None)[0m
[30;1m125 | [0m[35m            ) from e[0m
[30;1m126 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35mclass SFTPFileSet(FileSet):[0m
[30;1m111 | [0m[35m    def _get_sftp_connector(self) -> Tuple[SSHClient, SFTPClient]:[0m
[30;1m112 | [0m[35m        try:[0m
[30;1m113 | [0m[35m            ssh = paramiko.SSHClient()[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m            ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m        return lines[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    def write_file(self, filename: str, stream: StringIO, folder: Optional[str] = None):[0m
[30;1m100 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m101 | [0m[35m        if folder:[0m
[30;1m102 | [0m[35m            ftp.cwd(folder)[0m
[30;1m103 | [0m[35m        result = ftp.storlines([0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m        return datetime.strptime(modify_string, "%Y%m%d%H%M%S")[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    def read_file(self, filename: str) -> List[str]:[0m
[30;1m94 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m95 | [0m[35m        lines: List[str] = [][0m
[30;1m96 | [0m[35m        ftp.retrlines(f"RETR {filename}", lines.append)[0m
[30;1m97 | [0m[35m        return lines[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    def get_modified_datetime(self, filename: str) -> datetime:[0m
[30;1m84 | [0m[35m        """Read the 'modified' field from an FTP file"""[0m
[30;1m85 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m86 | [0m[35m        files = ftp.mlsd()[0m
[30;1m87 | [0m[35m        found_file = one(filter(lambda x: x[0] == filename, files))[0m
[30;1m88 | [0m[35m        filename, facts = found_file[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m        return filenames[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    def get_modified_datetime(self, filename: str) -> datetime:[0m
[30;1m84 | [0m[35m        """Read the 'modified' field from an FTP file"""[0m
[30;1m85 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m86 | [0m[35m        files = ftp.mlsd()[0m
[30;1m87 | [0m[35m        found_file = one(filter(lambda x: x[0] == filename, files))[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m            return ftp[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    def get_import_filenames(self) -> List[str]:[0m
[30;1m79 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m80 | [0m[35m        filenames = ftp.nlst()[0m
[30;1m81 | [0m[35m        return filenames[0m
[30;1m82 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m            ftp.encoding = "utf-8"[0m
[30;1m74 | [0m[35m            ftp.login(user=self._settings.ftp_user, passwd=self._settings.ftp_pass)[0m
[30;1m75 | [0m[35m            ftp.cwd(self._settings.ftp_folder)[0m
[30;1m76 | [0m[35m            return ftp[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    def get_import_filenames(self) -> List[str]:[0m
[30;1m79 | [0m[35m        ftp = self._get_ftp_connector()[0m
[30;1m80 | [0m[35m        filenames = ftp.nlst()[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m            ftp = FTP(self._settings.ftp_url)[0m
[30;1m67 | [0m[35m        except Exception as e:[0m
[30;1m68 | [0m[35m            raise config.ImproperlyConfigured([0m
[30;1m69 | [0m[35m                "cannot connect to FTP server %r"[0m
[30;1m70 | [0m[35m                % getattr(self._settings, "ftp_url", None)[0m
[30;1m71 | [0m[35m            ) from e[0m
[30;1m72 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35mclass FTPFileSet(FileSet):[0m
[30;1m64 | [0m[35m    def _get_ftp_connector(self) -> FTP:[0m
[30;1m65 | [0m[35m        try:[0m
[30;1m66 | [0m[35m            ftp = FTP(self._settings.ftp_url)[0m
[30;1m67 | [0m[35m        except Exception as e:[0m
[30;1m68 | [0m[35m            raise config.ImproperlyConfigured([0m
[30;1m69 | [0m[35m                "cannot connect to FTP server %r"[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_files.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport warnings[0m
[30;1m6 | [0m[35mfrom abc import ABC[0m
[30;1m7 | [0m[35mfrom datetime import datetime[0m
[30;1m8 | [0m[35mfrom ftplib import FTP[0m
[30;1m9 | [0m[35mfrom io import BytesIO[0m
[30;1m10 | [0m[35mfrom io import StringIO[0m
[30;1m11 | [0m[35mfrom operator import itemgetter[0m
[30;1m12 | [0m[35mfrom typing import Iterable[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/tests/conftest.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m21 | [0m[35m    #     self.default_exception_handler(context)[0m
[30;1m22 | [0m[35m    #   File "/usr/lib/python3.10/asyncio/base_events.py", line 1752, in default_exception_handler[0m
[30;1m23 | [0m[35m    #     logger.error('\n'.join(log_lines), exc_info=exc_info)[0m
[30;1m24 | [0m[35m    # Message: 'Unclosed client session\nclient_session: <aiohttp.client.ClientSession object at 0x7[0m
[30;1m25 | [0m[35m    # Arguments: ()[0m
[30;1m26 | [0m[35m    #[0m
[30;1m27 | [0m[35m    # Source: https://github.com/pytest-dev/pytest/issues/14#issuecomment-521577819[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m419 | [0m[35m        server_string = ""[0m
[30;1m420 | [0m[35m        if server is not None:[0m
[30;1m421 | [0m[35m            server_string = " -Server {}".format(server)[0m
[30;1m422 | [0m[35m        elif self.all_settings["global"].get("servers"):[0m
[30;1m423 | [0m[35m            server_string = " -Server {}".format([0m
[30;1m424 | [0m[35m                random.choice(self.all_settings["global"]["servers"])[0m
[30;1m425 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m        """Find a unique AD account from cpr, otherwise raise an exception."""[0m
[30;1m335 | [0m[35m        if ad_dump:[0m
[30;1m336 | [0m[35m            cpr_field = self.all_settings["primary"]["cpr_field"][0m
[30;1m337 | [0m[35m            ad_users = filter(lambda ad_user: ad_user.get(cpr_field) == cpr, ad_dump)[0m
[30;1m338 | [0m[35m        else:[0m
[30;1m339 | [0m[35m            logger.debug("No AD information supplied, will look it up")[0m
[30;1m340 | [0m[35m            ad_users = self.get_from_ad(cpr=cpr)[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m.hostname[0m
[30;1m123 | [0m[35m        ReauthenticatingKerberosSession[0m
[30;1m124 | [0m[35m    """[0m
[30;1m125 | [0m[35m    session = ReauthenticatingKerberosSession([0m
[30;1m126 | [0m[35m        "http://{}:5985/wsman".format(hostname),[0m
[30;1m127 | [0m[35m        username=username,[0m
[30;1m128 | [0m[35m        password=password,[0m
[30;1m129 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m.hostname[0m
[30;1m112 | [0m[35m        return rs[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35mdef generate_kerberos_session(hostname, username=None, password=None):[0m
[30;1m116 | [0m[35m    """[0m
[30;1m117 | [0m[35m    Method to create a kerberos session for running powershell scripts.[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m.hostname[0m
[30;1m44 | [0m[35m        winrm.Session[0m
[30;1m45 | [0m[35m    """[0m
[30;1m46 | [0m[35m    session = Session([0m
[30;1m47 | [0m[35m        "https://{}:5986/wsman".format(hostname),[0m
[30;1m48 | [0m[35m        transport="ntlm",[0m
[30;1m49 | [0m[35m        auth=(system_user, password),[0m
[30;1m50 | [0m[35m        server_cert_validation="ignore",[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m.hostname[0m
[30;1m37 | [0m[35m    return text[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mdef generate_ntlm_session(hostname, system_user, password):[0m
[30;1m41 | [0m[35m    """Method to create a ntlm session for running powershell scripts.[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m313 | [0m[35m    def _properties(self):[0m
[30;1m314 | [0m[35m        # This is only called from `AD.get_from_ad`, and as such, it is only used to[0m
[30;1m315 | [0m[35m        # create a list of the AD properties we want to *read* (not write.)[0m
[30;1m316 | [0m[35m        # Thus it is irrelevant for the code paths which create or update AD users.[0m
[30;1m317 | [0m[35m        settings = self._get_setting()[0m
[30;1m318 | [0m[35m        properties = " -Properties "[0m
[30;1m319 | [0m[35m        for item in settings["properties"]:[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m63 | [0m[35m        Tries to generate a new Kerberos ticket, through a call to kinit[0m
[30;1m64 | [0m[35m        Raises an exception if the subprocess has non-zero exit code[0m
[30;1m65 | [0m[35m        """[0m
[30;1m66 | [0m[35m        cmd = ["kinit", self._username][0m
[30;1m67 | [0m[35m        try:[0m
[30;1m68 | [0m[35m            subprocess.run([0m
[30;1m69 | [0m[35m                cmd,[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m    def _build_ps(self, ps_script, format_rules):[0m
[30;1m273 | [0m[35m        """[0m
[30;1m274 | [0m[35m        Return the standard code need to execute a power shell script from a[0m
[30;1m275 | [0m[35m        template.[0m
[30;1m276 | [0m[35m        """[0m
[30;1m277 | [0m[35m        # This method is only used by `ADWriter._get_add_manager_command`.[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m        If the script output cannot be parsed as JSON, a `ValueError` exception[0m
[30;1m187 | [0m[35m        is raised.[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m        :param ps_script: The PowerShell script to run.[0m
[30;1m190 | [0m[35m        :return: A dictionary with the returned parameters.[0m
[30;1m191 | [0m[35m        """[0m
[30;1m192 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m183 | [0m[35m        """Run a PowerShell script and return the result.[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        If the script fails, a `CommandFailure` exception is raised.[0m
[30;1m186 | [0m[35m        If the script output cannot be parsed as JSON, a `ValueError` exception[0m
[30;1m187 | [0m[35m        is raised.[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m        :param ps_script: The PowerShell script to run.[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m182 | [0m[35m    def _run_ps_script(self, ps_script):[0m
[30;1m183 | [0m[35m        """Run a PowerShell script and return the result.[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        If the script fails, a `CommandFailure` exception is raised.[0m
[30;1m186 | [0m[35m        If the script output cannot be parsed as JSON, a `ValueError` exception[0m
[30;1m187 | [0m[35m        is raised.[0m
[30;1m188 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m        return session[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    def _run_ps_script(self, ps_script):[0m
[30;1m183 | [0m[35m        """Run a PowerShell script and return the result.[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        If the script fails, a `CommandFailure` exception is raised.[0m
[30;1m186 | [0m[35m        If the script output cannot be parsed as JSON, a `ValueError` exception[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m        Generate new internal session[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        XXX: Session is not properly cleaned up when a command fails[0m
[30;1m84 | [0m[35m             so we have to create a new internal session object each time[0m
[30;1m85 | [0m[35m        """[0m
[30;1m86 | [0m[35m        self._session = Session([0m
[30;1m87 | [0m[35m            target=self._target, transport="kerberos", auth=(None, None)[0m
[30;1m88 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport random[0m
[30;1m4 | [0m[35mimport subprocess[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom typing import Dict[0m
[30;1m7 | [0m[35mfrom typing import List[0m
[30;1m8 | [0m[35mfrom typing import Optional[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/gql_lora_cache_async.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1646 | [0m[35m        :param dry_run: For testing purposes it is possible to read from cache.[0m
[30;1m1647 | [0m[35m        """[0m
[30;1m1648 | [0m[35m        if dry_run is None:[0m
[30;1m1649 | [0m[35m            dry_run = os.environ.get("USE_CACHED_LORACACHE", False)[0m
[30;1m1650 | [0m[35m[0m
[30;1m1651 | [0m[35m        # Ensure that tmp/ exists[0m
[30;1m1652 | [0m[35m        Path("tmp/").mkdir(exist_ok=True)[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/gql_lora_cache_async.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m629 | [0m[35m                for i in range(1, 11):[0m
[30;1m630 | [0m[35m                    ed[f"udvidelse_{i}"] = ext_obj.pop(f"extension_{i}")[0m
[30;1m631 | [0m[35m[0m
[30;1m632 | [0m[35m                ext_obj["extensions"] = ed[0m
[30;1m633 | [0m[35m[0m
[30;1m634 | [0m[35m            return d[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m        if self.full_history:[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/gql_lora_cache_async.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m625 | [0m[35m            for ext_obj in d["obj"]:[0m
[30;1m626 | [0m[35m                if ext_obj is None:[0m
[30;1m627 | [0m[35m                    continue[0m
[30;1m628 | [0m[35m                ed = {}[0m
[30;1m629 | [0m[35m                for i in range(1, 11):[0m
[30;1m630 | [0m[35m                    ed[f"udvidelse_{i}"] = ext_obj.pop(f"extension_{i}")[0m
[30;1m631 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m        for unit in self.units:[0m
[30;1m172 | [0m[35m            diff.update_unit(unit)[0m
[30;1m173 | [0m[35m            calculated_uuid = opus_helpers.generate_uuid(unit["@id"])[0m
[30;1m174 | [0m[35m            if unit.get("street"):[0m
[30;1m175 | [0m[35m                diff.helper._mo_post.assert_called_with([0m
[30;1m176 | [0m[35m                    "details/create",[0m
[30;1m177 | [0m[35m                    {[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m484 | [0m[35m        employee addresses of the type 'Adresse' (= postal addresses.)"""[0m
[30;1m485 | [0m[35m        instance = self.get_instance({})[0m
[30;1m486 | [0m[35m        with patch.object(instance, "ensure_class_in_facet") as ensure_class:[0m
[30;1m487 | [0m[35m            # Make sure "DAR" returns a "DAR UUID" so we trigger an update of the[0m
[30;1m488 | [0m[35m            # "Adresse" address type (a postal address.)[0m
[30;1m489 | [0m[35m            with patch([0m
[30;1m490 | [0m[35m                "integrations.opus.opus_diff_import.dawa_helper.dawa_lookup",[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m450 | [0m[35m        xml_date,[0m
[30;1m451 | [0m[35m    ):[0m
[30;1m452 | [0m[35m        # Arrange[0m
[30;1m453 | [0m[35m        diff = OpusDiffImportTestbase(xml_date, ad_reader=None, employee_mapping="test")[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m        # Act[0m
[30;1m456 | [0m[35m        diff.update_employee([0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m433 | [0m[35m        xml_date,[0m
[30;1m434 | [0m[35m    ):[0m
[30;1m435 | [0m[35m        # Arrange[0m
[30;1m436 | [0m[35m        diff = OpusDiffImportTestbase(xml_date, ad_reader=None, employee_mapping="test")[0m
[30;1m437 | [0m[35m[0m
[30;1m438 | [0m[35m        # Act[0m
[30;1m439 | [0m[35m        diff.update_employee({"position": None, "cpr": "123456789"})[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m304 | [0m[35m        """Tests that calling ensure_class_in_facet calls morahelpers with the correct owner added""[0m
[30;1m305 | [0m[35m        root_uuid = uuid4()[0m
[30;1m306 | [0m[35m        root_uuid_mock.return_value = root_uuid[0m
[30;1m307 | [0m[35m        diff = OpusDiffImportTestbase([0m
[30;1m308 | [0m[35m            "2022-07-13", ad_reader=None, employee_mapping="test"[0m
[30;1m309 | [0m[35m        )[0m
[30;1m310 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m285 | [0m[35m        dawa_helper_mock,[0m
[30;1m286 | [0m[35m        xml_date,[0m
[30;1m287 | [0m[35m    ):[0m
[30;1m288 | [0m[35m        diff = OpusDiffImportTestbase(xml_date, ad_reader=None, employee_mapping="test")[0m
[30;1m289 | [0m[35m        diff.it_systems = {"Opus": "Opus_uuid"}[0m
[30;1m290 | [0m[35m        diff.morahelper_mock.get_e_itsystems.return_value = [[0m
[30;1m291 | [0m[35m            {"user_key": "username1", "uuid": "dummyuuid"},[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m236 | [0m[35m        dawa_helper_mock,[0m
[30;1m237 | [0m[35m        xml_date,[0m
[30;1m238 | [0m[35m    ):[0m
[30;1m239 | [0m[35m        diff = OpusDiffImportTestbase(xml_date, ad_reader=None, employee_mapping="test")[0m
[30;1m240 | [0m[35m        date = xml_date.strftime("%Y-%m-%d")[0m
[30;1m241 | [0m[35m        diff.it_systems = {"Opus": "Opus_uuid"}[0m
[30;1m242 | [0m[35m        diff.morahelper_mock.get_e_itsystems.return_value = [[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m    def test_perform_address_update_create([0m
[30;1m189 | [0m[35m        self, xml_date, fromdate, value, address_type_uuid, org_unit_uuid, visibility[0m
[30;1m190 | [0m[35m    ):[0m
[30;1m191 | [0m[35m        diff = OpusDiffImportTestbase([0m
[30;1m192 | [0m[35m            xml_date, ad_reader=None, employee_mapping={"dummy": 1}[0m
[30;1m193 | [0m[35m        )[0m
[30;1m194 | [0m[35m        address_type_uuid = str(address_type_uuid)[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m    @given(datetimes())[0m
[30;1m167 | [0m[35m    def test_update_unit(self, dawa_helper_mock, xml_date):[0m
[30;1m168 | [0m[35m        self.assertIsInstance(xml_date, datetime)[0m
[30;1m169 | [0m[35m        diff = OpusDiffImportTestbase(xml_date, ad_reader=None, employee_mapping="test")[0m
[30;1m170 | [0m[35m        diff.ensure_class_in_facet = MagicMock(return_value="dummy-class-uuid")[0m
[30;1m171 | [0m[35m        for unit in self.units:[0m
[30;1m172 | [0m[35m            diff.update_unit(unit)[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m    @given(datetimes())[0m
[30;1m145 | [0m[35m    def test_import_count(self, xml_date):[0m
[30;1m146 | [0m[35m        self.assertIsInstance(xml_date, datetime)[0m
[30;1m147 | [0m[35m        diff = OpusDiffImportTest_counts([0m
[30;1m148 | [0m[35m            xml_date, ad_reader=None, employee_mapping="test"[0m
[30;1m149 | [0m[35m        )[0m
[30;1m150 | [0m[35m        diff.start_import([0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_diff_import.py[0m
   Pattern: [32m.hostname[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m        super().__init__(latest_date, *args, **kwargs)[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    def _get_mora_helper(self, hostname, use_cache):[0m
[30;1m37 | [0m[35m        return self.morahelper_mock[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    def _setup_gql_client(self):[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1236 | [0m[35m    # two update attempts.[0m
[30;1m1237 | [0m[35m    assert len(instance.helper.update_user_calls) == 1[0m
[30;1m1238 | [0m[35m[0m
[30;1m1239 | [0m[35m    # Assert contents of the single update[0m
[30;1m1240 | [0m[35m    mo_uuid, mo_data = instance.helper.update_user_calls[0][0m
[30;1m1241 | [0m[35m    ad_user = instance.mock_ad_reader.read_user()[0m
[30;1m1242 | [0m[35m    assert mo_uuid == MO_UUID[0m
[30;1m1243 | [0m[35m    assert mo_data["user_key"] == ad_user["UserPrincipalName"][0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1233 | [0m[35m[0m
[30;1m1234 | [0m[35m    # Assert that we only issue *one* call to `self.helper.update_user` in[0m
[30;1m1235 | [0m[35m    # `_edit_user_attrs` as neither the AD user or MO user has changed between the[0m
[30;1m1236 | [0m[35m    # two update attempts.[0m
[30;1m1237 | [0m[35m    assert len(instance.helper.update_user_calls) == 1[0m
[30;1m1238 | [0m[35m[0m
[30;1m1239 | [0m[35m    # Assert contents of the single update[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m761 | [0m[35m        """Verify that `_edit_engagement` raises an exception if an[0m
[30;1m762 | [0m[35m        unmapped MO field is encountered.[0m
[30;1m763 | [0m[35m[0m
[30;1m764 | [0m[35m        This test mocks the presence of a `LoraCache` instance at `self.lc`.[0m
[30;1m765 | [0m[35m        """[0m
[30;1m766 | [0m[35m        self._setup_admosync([0m
[30;1m767 | [0m[35m            transform_settings=self._sync_engagement_mapping_transformer([0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m730 | [0m[35m        """Verify engagement data is synced correctly from AD to MO.[0m
[30;1m731 | [0m[35m        Test removal of dropped extensions in incoming AD object.[0m
[30;1m732 | [0m[35m[0m
[30;1m733 | [0m[35m        This test mocks the presence of a `LoraCache` instance at `self.lc`.[0m
[30;1m734 | [0m[35m        """[0m
[30;1m735 | [0m[35m        self._setup_admosync([0m
[30;1m736 | [0m[35m            transform_settings=self._sync_engagement_mapping_transformer([0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_recursive_dict_update.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m45 | [0m[35m                {"alfa": {"beta": {"echo": 6}}},[0m
[30;1m46 | [0m[35m                # Non recursive update[0m
[30;1m47 | [0m[35m                {"alfa": {"beta": {"echo": 6}}},[0m
[30;1m48 | [0m[35m                # Recursive update[0m
[30;1m49 | [0m[35m                {"alfa": {"beta": {"echo": 6}, "charlie": {"fox": 5}}},[0m
[30;1m50 | [0m[35m            ],[0m
[30;1m51 | [0m[35m        ][0m
[30;1m52 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_recursive_dict_update.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m43 | [0m[35m                {"alfa": {"beta": {"echo": 4}, "charlie": {"fox": 5}}},[0m
[30;1m44 | [0m[35m                # Updates[0m
[30;1m45 | [0m[35m                {"alfa": {"beta": {"echo": 6}}},[0m
[30;1m46 | [0m[35m                # Non recursive update[0m
[30;1m47 | [0m[35m                {"alfa": {"beta": {"echo": 6}}},[0m
[30;1m48 | [0m[35m                # Recursive update[0m
[30;1m49 | [0m[35m                {"alfa": {"beta": {"echo": 6}, "charlie": {"fox": 5}}},[0m
[30;1m50 | [0m[35m            ],[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_recursive_dict_update.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m                {"alfa": {"beta": {"echo": 6}}},[0m
[30;1m36 | [0m[35m                # Non recursive update[0m
[30;1m37 | [0m[35m                {"alfa": {"beta": {"echo": 6}}},[0m
[30;1m38 | [0m[35m                # Recursive update[0m
[30;1m39 | [0m[35m                {"alfa": {"beta": {"echo": 6, "fox": 5}, "charlie": 3}},[0m
[30;1m40 | [0m[35m            ],[0m
[30;1m41 | [0m[35m            [[0m
[30;1m42 | [0m[35m                # Original[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_recursive_dict_update.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35m                {"alfa": {"beta": {"echo": 4, "fox": 5}, "charlie": 3}},[0m
[30;1m34 | [0m[35m                # Updates[0m
[30;1m35 | [0m[35m                {"alfa": {"beta": {"echo": 6}}},[0m
[30;1m36 | [0m[35m                # Non recursive update[0m
[30;1m37 | [0m[35m                {"alfa": {"beta": {"echo": 6}}},[0m
[30;1m38 | [0m[35m                # Recursive update[0m
[30;1m39 | [0m[35m                {"alfa": {"beta": {"echo": 6, "fox": 5}, "charlie": 3}},[0m
[30;1m40 | [0m[35m            ],[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_recursive_dict_update.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35m                {"alfa": {"beta": 4}},[0m
[30;1m26 | [0m[35m                # Non recursive update[0m
[30;1m27 | [0m[35m                {"alfa": {"beta": 4}},[0m
[30;1m28 | [0m[35m                # Recursive update[0m
[30;1m29 | [0m[35m                {"alfa": {"beta": 4, "charlie": 3}},[0m
[30;1m30 | [0m[35m            ],[0m
[30;1m31 | [0m[35m            [[0m
[30;1m32 | [0m[35m                # Original[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_recursive_dict_update.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23 | [0m[35m                {"alfa": {"beta": 2, "charlie": 3}},[0m
[30;1m24 | [0m[35m                # Updates[0m
[30;1m25 | [0m[35m                {"alfa": {"beta": 4}},[0m
[30;1m26 | [0m[35m                # Non recursive update[0m
[30;1m27 | [0m[35m                {"alfa": {"beta": 4}},[0m
[30;1m28 | [0m[35m                # Recursive update[0m
[30;1m29 | [0m[35m                {"alfa": {"beta": 4, "charlie": 3}},[0m
[30;1m30 | [0m[35m            ],[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_recursive_dict_update.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m15 | [0m[35m                {"alfa": 2},[0m
[30;1m16 | [0m[35m                # Non recursive update[0m
[30;1m17 | [0m[35m                {"alfa": 2},[0m
[30;1m18 | [0m[35m                # Recursive update[0m
[30;1m19 | [0m[35m                {"alfa": 2},[0m
[30;1m20 | [0m[35m            ],[0m
[30;1m21 | [0m[35m            [[0m
[30;1m22 | [0m[35m                # Original[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_recursive_dict_update.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m13 | [0m[35m                {"alfa": 1},[0m
[30;1m14 | [0m[35m                # Updates[0m
[30;1m15 | [0m[35m                {"alfa": 2},[0m
[30;1m16 | [0m[35m                # Non recursive update[0m
[30;1m17 | [0m[35m                {"alfa": 2},[0m
[30;1m18 | [0m[35m                # Recursive update[0m
[30;1m19 | [0m[35m                {"alfa": 2},[0m
[30;1m20 | [0m[35m            ],[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m        Iterator[Tuple[str, str]],[0m
[30;1m196 | [0m[35m        map([0m
[30;1m197 | [0m[35m            itemgetter("cpr_no", "uuid"),[0m
[30;1m198 | [0m[35m            filter(lambda employee: employee.get("cpr_no"), employees),[0m
[30;1m199 | [0m[35m        ),[0m
[30;1m200 | [0m[35m    )[0m
[30;1m201 | [0m[35m    return dict(cache)[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m    async def submit(data: List[dict]) -> None:[0m
[30;1m149 | [0m[35m        doc = list(data)[0m
[30;1m150 | [0m[35m        # Use semaphore to throttle the amount of concurrent requests[0m
[30;1m151 | [0m[35m        async with session.post([0m
[30;1m152 | [0m[35m            base_url + endpoint,[0m
[30;1m153 | [0m[35m            params={"force": 1},[0m
[30;1m154 | [0m[35m            json=doc,[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m            mo_error,[0m
[30;1m110 | [0m[35m        )[0m
[30;1m111 | [0m[35m        # Examine the MO error to see if it should be ignored[0m
[30;1m112 | [0m[35m        mo_error_key = mo_error.get("error_key")[0m
[30;1m113 | [0m[35m        needs_check = mo_error_key and ignored_mo_error_keys[0m
[30;1m114 | [0m[35m        if needs_check and mo_error_key in ignored_mo_error_keys:[0m
[30;1m115 | [0m[35m            logger.debug("Continuing on ignored MO error ''%s", mo_error_key)[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/util.py[0m
   Pattern: [32m.hostname[0m
[30;1m184 | [0m[35mdef lookup_employees():[0m
[30;1m185 | [0m[35m    """Helper function for fetching all available 'employee' objects."""[0m
[30;1m186 | [0m[35m    settings = config.get_config()[0m
[30;1m187 | [0m[35m    mh = MoraHelper(hostname=settings.mora_base)[0m
[30;1m188 | [0m[35m    return mh.read_all_users()[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35mdef read_cpr(employee: dict) -> str:[0m
[30;1m367 | [0m[35m    cpr = employee.get("cpr")[0m
[30;1m368 | [0m[35m    if isinstance(cpr, dict):[0m
[30;1m369 | [0m[35m        cpr = employee["cpr"]["#text"][0m
[30;1m370 | [0m[35m    elif isinstance(cpr, str):[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m    [{'@action': 'leave'}][0m
[30;1m361 | [0m[35m    """[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m    return partition(lambda empl: empl.get("@action") == "leave", employees)[0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35mdef read_cpr(employee: dict) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m    [{'orgUnit': '1'}][0m
[30;1m346 | [0m[35m[0m
[30;1m347 | [0m[35m    """[0m
[30;1m348 | [0m[35m    return filter(lambda empl: empl.get("orgUnit") not in all_filtered_ids, employees)[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35mdef split_employees_leaves(employees: List[Dict]) -> Tuple[Iterable, Iterable]:[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m    def get_parent(parent_map, entry):[0m
[30;1m322 | [0m[35m        """Build a list of parents."""[0m
[30;1m323 | [0m[35m        parent = parent_map.get(entry, None)[0m
[30;1m324 | [0m[35m        if parent is None:[0m
[30;1m325 | [0m[35m            return [entry][0m
[30;1m326 | [0m[35m        return [entry] + get_parent(parent_map, parent)[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m269 | [0m[35m        if not original.get(key) == new[key]:[0m
[30;1m270 | [0m[35m            identical = False[0m
[30;1m271 | [0m[35m            msg = "Changed {} from {} to {}"[0m
[30;1m272 | [0m[35m            print(msg.format(key, original.get(key), new[key]))[0m
[30;1m273 | [0m[35m    return identical[0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m    for key in new.keys():[0m
[30;1m267 | [0m[35m        if key in skip_keys and not force:[0m
[30;1m268 | [0m[35m            continue[0m
[30;1m269 | [0m[35m        if not original.get(key) == new[key]:[0m
[30;1m270 | [0m[35m            identical = False[0m
[30;1m271 | [0m[35m            msg = "Changed {} from {} to {}"[0m
[30;1m272 | [0m[35m            print(msg.format(key, original.get(key), new[key]))[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m    old_ids = set(map(itemgetter("@id"), before))[0m
[30;1m220 | [0m[35m    new_ids = set(map(itemgetter("@id"), after))[0m
[30;1m221 | [0m[35m    missing = old_ids - new_ids[0m
[30;1m222 | [0m[35m    missing_elements = filter(lambda x: x.get("@id") in missing, before)[0m
[30;1m223 | [0m[35m    return list(missing_elements)[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m    data = xmltodict.parse(text_input)[0m
[30;1m146 | [0m[35m    data = data["kmd"][0m
[30;1m147 | [0m[35m    units = data.get("orgUnit", [])[0m
[30;1m148 | [0m[35m    employees = data.get("employee", [])[0m
[30;1m149 | [0m[35m    if opus_id is not None:[0m
[30;1m150 | [0m[35m        employees = list(filter(lambda x: int(x["@id"]) == opus_id, employees))[0m
[30;1m151 | [0m[35m        units = list(filter(lambda x: int(x["@id"]) == opus_id, units))[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    data = xmltodict.parse(text_input)[0m
[30;1m146 | [0m[35m    data = data["kmd"][0m
[30;1m147 | [0m[35m    units = data.get("orgUnit", [])[0m
[30;1m148 | [0m[35m    employees = data.get("employee", [])[0m
[30;1m149 | [0m[35m    if opus_id is not None:[0m
[30;1m150 | [0m[35m        employees = list(filter(lambda x: int(x["@id"]) == opus_id, employees))[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m389 | [0m[35m    disable_tqdm=False,[0m
[30;1m390 | [0m[35m    opus_id: Optional[int] = None,[0m
[30;1m391 | [0m[35m) -> tuple[list[dict], list[dict], list[dict], list[dict], list[dict]]:[0m
[30;1m392 | [0m[35m    """Gets the diff of two files and transforms the data based on filter_ids[0m
[30;1m393 | [0m[35m    Returns the active units, filtered units, active employees which are not in a filtered unit,[0m
[30;1m394 | [0m[35m    terminated employees and canceled employees[0m
[30;1m395 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m183 | [0m[35m            return True[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        old_obj = old_map[obj["@id"]][0m
[30;1m186 | [0m[35m        diff = DeepDiff([0m
[30;1m187 | [0m[35m            obj,[0m
[30;1m188 | [0m[35m            old_obj,[0m
[30;1m189 | [0m[35m            exclude_paths={[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m    before: List[Dict], after: List[Dict], disable_tqdm: bool = True[0m
[30;1m157 | [0m[35m) -> List[Dict]:[0m
[30;1m158 | [0m[35m    """Filter a list of dictionaries based on differences to another list of dictionaries[0m
[30;1m159 | [0m[35m    Used to find changes to org_units and employees in opus files.[0m
[30;1m160 | [0m[35m    Any registration in lastChanged is ignored here.[0m
[30;1m161 | [0m[35m    Use disable_tqdm in tests etc.[0m
[30;1m162 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m    cpr_map = pathlib.Path.cwd() / "settings" / "cpr_uuid_map.csv"[0m
[30;1m34 | [0m[35m    if not cpr_map.is_file():[0m
[30;1m35 | [0m[35m        logger.error("Did not find cpr mapping")[0m
[30;1m36 | [0m[35m        raise Exception("Did not find cpr mapping")[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    logger.info("Found cpr mapping")[0m
[30;1m39 | [0m[35m    employee_forced_uuids = cpr_mapper.employee_mapper(str(cpr_map))[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35mdef read_cpr_mapping():[0m
[30;1m33 | [0m[35m    cpr_map = pathlib.Path.cwd() / "settings" / "cpr_uuid_map.csv"[0m
[30;1m34 | [0m[35m    if not cpr_map.is_file():[0m
[30;1m35 | [0m[35m        logger.error("Did not find cpr mapping")[0m
[30;1m36 | [0m[35m        raise Exception("Did not find cpr mapping")[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    logger.info("Found cpr mapping")[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport hashlib[0m
[30;1m3 | [0m[35mimport logging[0m
[30;1m4 | [0m[35mimport pathlib[0m
[30;1m5 | [0m[35mimport sqlite3[0m
[30;1m6 | [0m[35mimport uuid[0m
[30;1m7 | [0m[35mfrom functools import lru_cache[0m
[30;1m8 | [0m[35mfrom operator import itemgetter[0m
[30;1m9 | [0m[35mfrom typing import Dict[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m    if args.get("sync_all"):[0m
[30;1m233 | [0m[35m        sync.sync_all()[0m
[30;1m234 | [0m[35m    if args.get("sync_cpr"):[0m
[30;1m235 | [0m[35m        sync.sync_one(args["sync_cpr"])[0m
[30;1m236 | [0m[35m    logger.info("Sync done")[0m
[30;1m237 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m    if "crontab.SENTRY_DSN" in sync.settings:[0m
[30;1m230 | [0m[35m        sentry_sdk.init(dsn=sync.settings["crontab.SENTRY_DSN"])[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m    if args.get("sync_all"):[0m
[30;1m233 | [0m[35m        sync.sync_all()[0m
[30;1m234 | [0m[35m    if args.get("sync_cpr"):[0m
[30;1m235 | [0m[35m        sync.sync_one(args["sync_cpr"])[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m    # Set log level according to --debug command line arg[0m
[30;1m220 | [0m[35m    logger.setLevel(logging.INFO)[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m    if args.get("debug"):[0m
[30;1m223 | [0m[35m        logger.setLevel(logging.DEBUG)[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m    logger.debug(args)[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        if self.all_settings["global"].get("servers"):[0m
[30;1m89 | [0m[35m            server_strings = [[0m
[30;1m90 | [0m[35m                " -Server {} ".format(server)[0m
[30;1m91 | [0m[35m                for server in self.all_settings["global"].get("servers")[0m
[30;1m92 | [0m[35m            ][0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        @apply[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m            return True[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        server_strings = [""][0m
[30;1m88 | [0m[35m        if self.all_settings["global"].get("servers"):[0m
[30;1m89 | [0m[35m            server_strings = [[0m
[30;1m90 | [0m[35m                " -Server {} ".format(server)[0m
[30;1m91 | [0m[35m                for server in self.all_settings["global"].get("servers")[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m        @apply[0m
[30;1m70 | [0m[35m        def filter_already_synced(ad_user, mo_uuid):[0m
[30;1m71 | [0m[35m            expected_mo_uuid = ad_user.get(ad_uuid_field)[0m
[30;1m72 | [0m[35m            if expected_mo_uuid is None:[0m
[30;1m73 | [0m[35m                msg = ([0m
[30;1m74 | [0m[35m                    "Read None from UUID field in AD!"[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        @apply[0m
[30;1m55 | [0m[35m        def lookup_mo_uuid(ad_user, cpr):[0m
[30;1m56 | [0m[35m            mo_uuid = mo_users.get(cpr)[0m
[30;1m57 | [0m[35m            return ad_user, mo_uuid[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        @apply[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        def extract_cpr(ad_user):[0m
[30;1m48 | [0m[35m            self.stats["attempted_users"] += 1[0m
[30;1m49 | [0m[35m            cpr = ad_user.get(cpr_field)[0m
[30;1m50 | [0m[35m            if separator:[0m
[30;1m51 | [0m[35m                cpr = cpr.replace(separator, "")[0m
[30;1m52 | [0m[35m            return ad_user, cpr[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m        }[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    def perform_sync(self, ad_users, mo_users):[0m
[30;1m44 | [0m[35m        separator = self.all_settings["primary"].get("cpr_separator", "")[0m
[30;1m45 | [0m[35m        cpr_field = self.all_settings["primary"]["cpr_field"][0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        def extract_cpr(ad_user):[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/sync_mo_uuid_to_ad.py[0m
   Pattern: [32m.hostname[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m    def _get_mora_helper(self):[0m
[30;1m201 | [0m[35m        return MoraHelper([0m
[30;1m202 | [0m[35m            hostname=self.all_settings["global"]["mora.base"], use_cache=False[0m
[30;1m203 | [0m[35m        )[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_xlsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m            index, data = row[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m            kle_uuid = kle_map.get(data.__getattr__(kle_field))[0m
[30;1m184 | [0m[35m            org_unit_uuid = org_unit_map.get(data.__getattr__(org_unit_field))[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m            if not kle_uuid or not org_unit_uuid:[0m
[30;1m187 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_xlsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m        for row in sheet.iterrows():[0m
[30;1m181 | [0m[35m            index, data = row[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m            kle_uuid = kle_map.get(data.__getattr__(kle_field))[0m
[30;1m184 | [0m[35m            org_unit_uuid = org_unit_map.get(data.__getattr__(org_unit_field))[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m            if not kle_uuid or not org_unit_uuid:[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_check_dar_adresses.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    )[0m
[30;1m23 | [0m[35m    invalid_addresses = [][0m
[30;1m24 | [0m[35m    for unit in tqdm(org_units):[0m
[30;1m25 | [0m[35m        if unit.get("street") and unit.get("zipCode"):[0m
[30;1m26 | [0m[35m            address_uuid = dawa_helper.dawa_lookup(unit["street"], unit["zipCode"])[0m
[30;1m27 | [0m[35m            if not address_uuid:[0m
[30;1m28 | [0m[35m                invalid_addresses.append([0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_check_dar_adresses.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    )[0m
[30;1m23 | [0m[35m    invalid_addresses = [][0m
[30;1m24 | [0m[35m    for unit in tqdm(org_units):[0m
[30;1m25 | [0m[35m        if unit.get("street") and unit.get("zipCode"):[0m
[30;1m26 | [0m[35m            address_uuid = dawa_helper.dawa_lookup(unit["street"], unit["zipCode"])[0m
[30;1m27 | [0m[35m            if not address_uuid:[0m
[30;1m28 | [0m[35m                invalid_addresses.append([0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_stam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m374 | [0m[35m            if itsystem_uuid not in csv_row_uuids[0m
[30;1m375 | [0m[35m        ][0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m        # Run create, update and terminate on found items[0m
[30;1m378 | [0m[35m        for new_item in new_items:[0m
[30;1m379 | [0m[35m            gql_create_it_system(gql_client, new_item)[0m
[30;1m380 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_stam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m    async def handle_itsystem(self):[0m
[30;1m335 | [0m[35m        """[0m
[30;1m336 | [0m[35m        Process the external 'it system' csv file and create, update and terminate items[0m
[30;1m337 | [0m[35m        if file is newer than last import.[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m        OBS: ITSystem are different than the other STAM data fields. since they are not[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_stam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m116 | [0m[35m        return self.user_key[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    # NOTE: we use 'class_uuid' since StamCSV was initially only meant for classes, or[0m
[30;1m119 | [0m[35m    # looks like that at least, and itsystems are not classes.. its a bit misleading, but it works.[0m
[30;1m120 | [0m[35m    @property[0m
[30;1m121 | [0m[35m    def class_uuid(self) -> uuid.UUID:[0m
[30;1m122 | [0m[35m        return self.it_system_uuid[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_stam.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m497 | [0m[35m        for changed_class in classes_with_changes:[0m
[30;1m498 | [0m[35m            gql_create_class(gql_client, changed_class, str(uuids.ORG_UUID), facet_uuid)  # type: ig[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m        # Find classes to terminate (classes in LoRa but no longer in CSV file)[0m
[30;1m501 | [0m[35m        class_uuids_to_terminate = [[0m
[30;1m502 | [0m[35m            class_uuid[0m
[30;1m503 | [0m[35m            for class_uuid in facet_class_uuids[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_stam.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m482 | [0m[35m            await mox_helper.insert_klassifikation_klasse(klasse, str(row.class_uuid))[0m
[30;1m483 | [0m[35m            logger.info("Created LoRa class %r", row.class_uuid)[0m
[30;1m484 | [0m[35m[0m
[30;1m485 | [0m[35m        # Find classes with updated data[0m
[30;1m486 | [0m[35m        classes_with_changes = list([0m
[30;1m487 | [0m[35m            filter([0m
[30;1m488 | [0m[35m                lambda csv_row: any(  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_stam.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m464 | [0m[35m        classes = gql_get_classes(gql_client, str(facet_uuid))[0m
[30;1m465 | [0m[35m        facet_class_uuids = [uuid.UUID(c["uuid"]) for c in classes][0m
[30;1m466 | [0m[35m[0m
[30;1m467 | [0m[35m        # Find rows to insert (classes in CSV but not yet in LoRa)[0m
[30;1m468 | [0m[35m        rows_class_uuids = set(row.class_uuid for row in rows)[0m
[30;1m469 | [0m[35m        rows_to_insert = [[0m
[30;1m470 | [0m[35m            row for row in rows if row.class_uuid not in facet_class_uuids[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_stam.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        facet_uuid = await self._get_or_create_facet(csv_class, mox_helper)[0m
[30;1m461 | [0m[35m[0m
[30;1m462 | [0m[35m        # Find class UUIDs currently in facet[0m
[30;1m463 | [0m[35m        gql_client = config.setup_gql_client(settings=settings)[0m
[30;1m464 | [0m[35m        classes = gql_get_classes(gql_client, str(facet_uuid))[0m
[30;1m465 | [0m[35m        facet_class_uuids = [uuid.UUID(c["uuid"]) for c in classes][0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_logger.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m9 | [0m[35m    settings = {"global": {"password": password}}[0m
[30;1m10 | [0m[35m    formatter = PasswordRemovalFormatter(settings=settings)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m    # Capture logs on the "testing" logger at level DEBUG or higher[0m
[30;1m13 | [0m[35m    caplog.set_level(logging.DEBUG, "testing")[0m
[30;1m14 | [0m[35m    # Patch pytest logging to use our custom log formatter[0m
[30;1m15 | [0m[35m    caplog.handler.setFormatter(formatter)[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m789 | [0m[35m@click.option("--uuid-field", default=load_setting("integrations.ad.write.uuid_field"))[0m
[30;1m790 | [0m[35m@click.option([0m
[30;1m791 | [0m[35m    "--ad-user",[0m
[30;1m792 | [0m[35m    help="If given, update only one AD user (specified by username)",[0m
[30;1m793 | [0m[35m)[0m
[30;1m794 | [0m[35m@click.option("--dry-run", is_flag=True)[0m
[30;1m795 | [0m[35m@click.option("--mora-base", envvar="MORA_BASE", default="http://mo")[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m742 | [0m[35m            if change.changes == {}:[0m
[30;1m743 | [0m[35m                logger.debug("skip unchanged user %r", change.ad_user)[0m
[30;1m744 | [0m[35m                continue[0m
[30;1m745 | [0m[35m            cmd = self.get_update_cmd([0m
[30;1m746 | [0m[35m                uuid_field,[0m
[30;1m747 | [0m[35m                change.ad_user.mo_uuid,[0m
[30;1m748 | [0m[35m                **change.changes,[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m730 | [0m[35m        dry: bool = False,[0m
[30;1m731 | [0m[35m    ) -> list[tuple[str, Any]]:[0m
[30;1m732 | [0m[35m        """Take the output of `ChangeList.get_changes` and turn it into update[0m
[30;1m733 | [0m[35m        commands. Run the update commands against AD if `dry` is False, or else just log[0m
[30;1m734 | [0m[35m        the commands that would have been run.[0m
[30;1m735 | [0m[35m        """[0m
[30;1m736 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m729 | [0m[35m        uuid_field: str,[0m
[30;1m730 | [0m[35m        dry: bool = False,[0m
[30;1m731 | [0m[35m    ) -> list[tuple[str, Any]]:[0m
[30;1m732 | [0m[35m        """Take the output of `ChangeList.get_changes` and turn it into update[0m
[30;1m733 | [0m[35m        commands. Run the update commands against AD if `dry` is False, or else just log[0m
[30;1m734 | [0m[35m        the commands that would have been run.[0m
[30;1m735 | [0m[35m        """[0m
[30;1m736 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m707 | [0m[35m        uuid: str,[0m
[30;1m708 | [0m[35m        **changes,[0m
[30;1m709 | [0m[35m    ) -> str:[0m
[30;1m710 | [0m[35m        """Return the relevant Powershell update command to update the given end date[0m
[30;1m711 | [0m[35m        field in AD with the given value."""[0m
[30;1m712 | [0m[35m        return self.remove_redundant([0m
[30;1m713 | [0m[35m            render_update_by_mo_uuid_cmd([0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m707 | [0m[35m        uuid: str,[0m
[30;1m708 | [0m[35m        **changes,[0m
[30;1m709 | [0m[35m    ) -> str:[0m
[30;1m710 | [0m[35m        """Return the relevant Powershell update command to update the given end date[0m
[30;1m711 | [0m[35m        field in AD with the given value."""[0m
[30;1m712 | [0m[35m        return self.remove_redundant([0m
[30;1m713 | [0m[35m            render_update_by_mo_uuid_cmd([0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m694 | [0m[35m[0m
[30;1m695 | [0m[35m[0m
[30;1m696 | [0m[35mclass ChangeListExecutor(AD):[0m
[30;1m697 | [0m[35m    """Given a list of changes, perform update commands against AD to bring the data of[0m
[30;1m698 | [0m[35m    the AD users up-to-date with the corresponding MO users.[0m
[30;1m699 | [0m[35m    """[0m
[30;1m700 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m608 | [0m[35m                future_list[0].get_org_unit_path(),  # org_unit_path_future[0m
[30;1m609 | [0m[35m            )[0m
[30;1m610 | [0m[35m[0m
[30;1m611 | [0m[35m        # No engagements at all[0m
[30;1m612 | [0m[35m        return MOSplitEngagement(ad_user, Unset(), Unset(), Unset(), Unset())[0m
[30;1m613 | [0m[35m[0m
[30;1m614 | [0m[35m    def _fold_in_utc([0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m543 | [0m[35m        try:[0m
[30;1m544 | [0m[35m            engagements = self._get_employee_engagements(ad_user.mo_uuid)[0m
[30;1m545 | [0m[35m        except KeyError:[0m
[30;1m546 | [0m[35m            # If MO user has no engagements, we should not update neither the current[0m
[30;1m547 | [0m[35m            # nor the future end date.[0m
[30;1m548 | [0m[35m            return MOSplitEngagement(ad_user, Unset(), Unset(), Unset(), Unset())[0m
[30;1m549 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m531 | [0m[35m            """Split the set of engagement validities into two partitions:[0m
[30;1m532 | [0m[35m            - one partition of past and present engagements.[0m
[30;1m533 | [0m[35m            - one partition of future engagements.[0m
[30;1m534 | [0m[35m            The split is determined by looking at the "from" part of the validity.[0m
[30;1m535 | [0m[35m            """[0m
[30;1m536 | [0m[35m            local_date = in_default_tz(datetime.datetime.now()).date()[0m
[30;1m537 | [0m[35m            # Take either engagement start date, or "negative infinity" if blank[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m391 | [0m[35m        )[0m
[30;1m392 | [0m[35m        if mo_value == Unset():[0m
[30;1m393 | [0m[35m            logger.info([0m
[30;1m394 | [0m[35m                "MO user %r: skipping %r update as MO value is unset",[0m
[30;1m395 | [0m[35m                self.ad_user.mo_uuid,[0m
[30;1m396 | [0m[35m                ad_text.field_name if ad_text is not None else "",[0m
[30;1m397 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m@dataclass[0m
[30;1m323 | [0m[35mclass MOSplitEngagement(MOSimpleEngagement):[0m
[30;1m324 | [0m[35m    """Represents the MO data to consider in the complex case, where we look at both the[0m
[30;1m325 | [0m[35m    current/past engagement, as well as a possible future engagement.[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m    This class extends `MOSimpleEngagement` to support comparisons on the additional[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m288 | [0m[35m        if mo_value == Unset():[0m
[30;1m289 | [0m[35m            # If MO value is `Unset`, leave it out of the set of changes[0m
[30;1m290 | [0m[35m            logger.info([0m
[30;1m291 | [0m[35m                "MO user %r: skipping %r update as MO value is unset",[0m
[30;1m292 | [0m[35m                self.ad_user.mo_uuid,[0m
[30;1m293 | [0m[35m                ad_date.field_name if ad_date is not None else "",[0m
[30;1m294 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mclass NegativeInfinity(_SymbolicConstant):[0m
[30;1m101 | [0m[35m    """Represents the lower bound of a validity period if MO returns `None`, i.e. the[0m
[30;1m102 | [0m[35m    validity period begins at "-infinity."[0m
[30;1m103 | [0m[35m    """[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def as_datetime(self) -> datetime.datetime:[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35mclass PositiveInfinity(_SymbolicConstant):[0m
[30;1m92 | [0m[35m    """Represents the upper bound of a validity period if MO returns `None`, i.e. the[0m
[30;1m93 | [0m[35m    validity period ends at "infinity."[0m
[30;1m94 | [0m[35m    """[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    def as_datetime(self) -> datetime.datetime:[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m77 | [0m[35m    Typically because the MO user has no engagements at all, or because the MO user has[0m
[30;1m78 | [0m[35m    no engagements in the future, or the past/present.[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    When encountering an `Unset` end date, the program should not update the matching[0m
[30;1m81 | [0m[35m    AD field.[0m
[30;1m82 | [0m[35m    """[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35mclass Unset(_SymbolicConstant):[0m
[30;1m76 | [0m[35m    """Represents an end date that should *not* be updated in AD.[0m
[30;1m77 | [0m[35m    Typically because the MO user has no engagements at all, or because the MO user has[0m
[30;1m78 | [0m[35m    no engagements in the future, or the past/present.[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    When encountering an `Unset` end date, the program should not update the matching[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m566 | [0m[35m            reverse=True,[0m
[30;1m567 | [0m[35m        )[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m        # Sort by validity start - the validity with the earliest start appears first in[0m
[30;1m570 | [0m[35m        # list.[0m
[30;1m571 | [0m[35m        future_list: list[_ParsedEngagement] = sorted([0m
[30;1m572 | [0m[35m            future,[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_fix_enddate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m556 | [0m[35m        future: Iterator[_ParsedEngagement][0m
[30;1m557 | [0m[35m        current, future = partition(_split, parsed_engagements)[0m
[30;1m558 | [0m[35m[0m
[30;1m559 | [0m[35m        # Sort by validity end - the validity with the latest end appears first in list[0m
[30;1m560 | [0m[35m        current_list: list[_ParsedEngagement] = sorted([0m
[30;1m561 | [0m[35m            current,[0m
[30;1m562 | [0m[35m            key=lambda parsed_engagement: self._fold_in_utc([0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m            with self.assertRaises(ValueError) as ctx:[0m
[30;1m30 | [0m[35m                self._ad._run_ps_script(self._ps_script)[0m
[30;1m31 | [0m[35m                # Assert that exception message contains offending part of the[0m
[30;1m32 | [0m[35m                # JSON doc, as well as the script that caused the error.[0m
[30;1m33 | [0m[35m                msg = ctx.exception[0][0m
[30;1m34 | [0m[35m                self.assertIn(invalid_json, msg)[0m
[30;1m35 | [0m[35m                self.assertIn(str(None), msg)[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/lc_for_jobs_db.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        "exporters.actual_state.db_name": settings.get([0m
[30;1m50 | [0m[35m            "lc-for-jobs.actual_db_name", "ActualState"[0m
[30;1m51 | [0m[35m        ),[0m
[30;1m52 | [0m[35m        "primary_manager_responsibility": settings.get([0m
[30;1m53 | [0m[35m            "primary_manager_responsibility"[0m
[30;1m54 | [0m[35m        ),[0m
[30;1m55 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/lc_for_jobs_db.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    overrides = {[0m
[30;1m47 | [0m[35m        "exporters.actual_state.type": "SQLite",[0m
[30;1m48 | [0m[35m        "exporters.actual_state_historic.type": "SQLite",[0m
[30;1m49 | [0m[35m        "exporters.actual_state.db_name": settings.get([0m
[30;1m50 | [0m[35m            "lc-for-jobs.actual_db_name", "ActualState"[0m
[30;1m51 | [0m[35m        ),[0m
[30;1m52 | [0m[35m        "primary_manager_responsibility": settings.get([0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/lc_for_jobs_db.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35mdef get_engine(dbpath=None):[0m
[30;1m22 | [0m[35m    if dbpath is None:[0m
[30;1m23 | [0m[35m        settings = load_settings()[0m
[30;1m24 | [0m[35m        dbpath = settings.get("lc-for-jobs.actual_db_name", "ActualState")[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    dbpath = str(dbpath)[0m
[30;1m27 | [0m[35m    if dbpath != ":memory:":[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/dar_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m    """[0m
[30;1m133 | [0m[35m    url = "https://api.dataforsyningen.dk/datavask/adresser"[0m
[30;1m134 | [0m[35m    params = {"struktur": "mini", "betegnelse": address}[0m
[30;1m135 | [0m[35m    async with client.get(url, params=params) as response:[0m
[30;1m136 | [0m[35m        response.raise_for_status()[0m
[30;1m137 | [0m[35m        result = await response.json()[0m
[30;1m138 | [0m[35m        # A and B are safe matches, and will only have one result in the array[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/dar_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    url = "https://dawa.aws.dk/" + addrtype[0m
[30;1m47 | [0m[35m    params = {"id": "|".join(uuids), "struktur": "mini"}[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    async with client.get(url, params=params) as response:[0m
[30;1m50 | [0m[35m        response.raise_for_status()[0m
[30;1m51 | [0m[35m        body = await response.json()[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/dar_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m        else:[0m
[30;1m21 | [0m[35m            # DAWA only accepts:[0m
[30;1m22 | [0m[35m            # * 30 requests per second per IP[0m
[30;1m23 | [0m[35m            # * 10 concurrent connections per IP[0m
[30;1m24 | [0m[35m            # Thus we limit our connections to 10 here.[0m
[30;1m25 | [0m[35m            connector = TCPConnector(limit=10)[0m
[30;1m26 | [0m[35m            async with ClientSession(connector=connector) as client:[0m
[30;1m27 | [0m[35m                return await func(*args, **kwargs, client=client)[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/dar_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m            return await func(*args, **kwargs)[0m
[30;1m20 | [0m[35m        else:[0m
[30;1m21 | [0m[35m            # DAWA only accepts:[0m
[30;1m22 | [0m[35m            # * 30 requests per second per IP[0m
[30;1m23 | [0m[35m            # * 10 concurrent connections per IP[0m
[30;1m24 | [0m[35m            # Thus we limit our connections to 10 here.[0m
[30;1m25 | [0m[35m            connector = TCPConnector(limit=10)[0m
[30;1m26 | [0m[35m            async with ClientSession(connector=connector) as client:[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_usernames.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m    def _patch_settings(self, settings: dict):[0m
[30;1m113 | [0m[35m        return mock.patch([0m
[30;1m114 | [0m[35m            self._load_setting_path,[0m
[30;1m115 | [0m[35m            new=lambda name, default=None: lambda: settings.get(name, default),[0m
[30;1m116 | [0m[35m        )[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_usernames.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m797 | [0m[35m        )[0m
[30;1m798 | [0m[35m    )[0m
[30;1m799 | [0m[35m    def test_valid_input(self, name):[0m
[30;1m800 | [0m[35m        # If `name` has at least two items, each item being a string of at least[0m
[30;1m801 | [0m[35m        # one consonant, we should be able to create a username.[0m
[30;1m802 | [0m[35m        self.instance.create_username(name)[0m
[30;1m803 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_usernames.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m797 | [0m[35m        )[0m
[30;1m798 | [0m[35m    )[0m
[30;1m799 | [0m[35m    def test_valid_input(self, name):[0m
[30;1m800 | [0m[35m        # If `name` has at least two items, each item being a string of at least[0m
[30;1m801 | [0m[35m        # one consonant, we should be able to create a username.[0m
[30;1m802 | [0m[35m        self.instance.create_username(name)[0m
[30;1m803 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m        [[0m
[30;1m94 | [0m[35m            # Look up bogus CPR in mock AD which will not find an AD user[0m
[30;1m95 | [0m[35m            (MockUnknownCPRADParameterReader(), "AD User not found"),[0m
[30;1m96 | [0m[35m            # Look up bogus CPR in mock MO which will not find a MO user[0m
[30;1m97 | [0m[35m            (MockADParameterReader(), "MO User not found"),[0m
[30;1m98 | [0m[35m        ][0m
[30;1m99 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_sync_mo_uuid_to_ad.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    @parameterized.expand([0m
[30;1m93 | [0m[35m        [[0m
[30;1m94 | [0m[35m            # Look up bogus CPR in mock AD which will not find an AD user[0m
[30;1m95 | [0m[35m            (MockUnknownCPRADParameterReader(), "AD User not found"),[0m
[30;1m96 | [0m[35m            # Look up bogus CPR in mock MO which will not find a MO user[0m
[30;1m97 | [0m[35m            (MockADParameterReader(), "MO User not found"),[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/user_names.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m290 | [0m[35m            except IndexError:[0m
[30;1m291 | [0m[35m                # Check if there are still more name parts to use[0m
[30;1m292 | [0m[35m                if p < len(name) - 1:[0m
[30;1m293 | [0m[35m                    # If yes, use next name part, starting at first letter[0m
[30;1m294 | [0m[35m                    p += 1[0m
[30;1m295 | [0m[35m                    offset = 0[0m
[30;1m296 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/user_names.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m278 | [0m[35m        # a consonant.)[0m
[30;1m279 | [0m[35m        result.append(only(string.ascii_lowercase, name[0])[0])[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m        # Continue at first letter of the second name part (first part if only one part)[0m
[30;1m282 | [0m[35m        p = min(1, len(name) - 1)  # second name part (or first if only one part)[0m
[30;1m283 | [0m[35m        offset = 0  # = first letter[0m
[30;1m284 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/user_names.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m267 | [0m[35m        # Check name parts[0m
[30;1m268 | [0m[35m        first_ascii = set(name[0]) & set(string.ascii_lowercase)[0m
[30;1m269 | [0m[35m        assert len(name) > 0, "name must have at least one part"[0m
[30;1m270 | [0m[35m        assert first_ascii, "first name part must contain at least one ASCII character"[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        def only(allowed: str, part: str):[0m
[30;1m273 | [0m[35m            return "".join(ch for ch in part if ch.lower() in allowed)[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/user_names.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m        # Check name parts[0m
[30;1m268 | [0m[35m        first_ascii = set(name[0]) & set(string.ascii_lowercase)[0m
[30;1m269 | [0m[35m        assert len(name) > 0, "name must have at least one part"[0m
[30;1m270 | [0m[35m        assert first_ascii, "first name part must contain at least one ASCII character"[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        def only(allowed: str, part: str):[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/user_names.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m        will keep returning new names until the algorithm runs out of options[0m
[30;1m206 | [0m[35m        and a RuntimeException is raised.[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m        :param name: Name of the user given as a list with at least two elements.[0m
[30;1m209 | [0m[35m        :param dry_run: If true the name will be returned, but will be added to[0m
[30;1m210 | [0m[35m        the interal list of reserved names.[0m
[30;1m211 | [0m[35m        :return: New username generated.[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/user_names.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m        get_usernameset_class_names = load_setting(setting_name, default=[])[0m
[30;1m89 | [0m[35m        try:[0m
[30;1m90 | [0m[35m            usernameset_class_names = get_usernameset_class_names()[0m
[30;1m91 | [0m[35m        except FileNotFoundError:  # could not find "settings.json"[0m
[30;1m92 | [0m[35m            logger.info("could not read settings, not adding extra username sets")[0m
[30;1m93 | [0m[35m        else:[0m
[30;1m94 | [0m[35m            for name in usernameset_class_names:[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/user_names.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m    def _lookup_class_by_name(cls, name):[0m
[30;1m67 | [0m[35m        if name and name in globals():[0m
[30;1m68 | [0m[35m            return globals()[name][0m
[30;1m69 | [0m[35m        raise NameError(f"could not find class {name}")[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    def __init__(self):[0m
[30;1m72 | [0m[35m        self.occupied_names = set()[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/user_names.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m            )[0m
[30;1m55 | [0m[35m        except NameError:[0m
[30;1m56 | [0m[35m            logger.warning([0m
[30;1m57 | [0m[35m                "could not find class %r, defaulting to %r",[0m
[30;1m58 | [0m[35m                name,[0m
[30;1m59 | [0m[35m                implementation_class,[0m
[30;1m60 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/user_names.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m            implementation_class = cls._lookup_class_by_name(name)[0m
[30;1m48 | [0m[35m        except (ValueError, FileNotFoundError):[0m
[30;1m49 | [0m[35m            # ValueError: "not in settings file and no default"[0m
[30;1m50 | [0m[35m            # FileNotFoundError: could not find "settings.json"[0m
[30;1m51 | [0m[35m            logger.warning([0m
[30;1m52 | [0m[35m                "could not read settings, defaulting to %r",[0m
[30;1m53 | [0m[35m                implementation_class,[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m        self._settings = settings[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m        self._run_ps_response = kwargs.get("run_ps_response") or MagicMock()[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m    def __enter__(self):[0m
[30;1m537 | [0m[35m        super().__enter__()[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m525 | [0m[35m        # False.[0m
[30;1m526 | [0m[35m        # This is because the tests that verify code paths related to `get_manager_uuid`[0m
[30;1m527 | [0m[35m        # currently can only test `ADWriter` when  `use_future_managers` is True.[0m
[30;1m528 | [0m[35m        settings["primary_write"]["use_future_managers"] = kwargs.get([0m
[30;1m529 | [0m[35m            "use_future_managers", True[0m
[30;1m530 | [0m[35m        )[0m
[30;1m531 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m516 | [0m[35m            template_to_ad_fields_when_disable[0m
[30;1m517 | [0m[35m        )[0m
[30;1m518 | [0m[35m[0m
[30;1m519 | [0m[35m        skip_locations = kwargs.get("skip_locations")[0m
[30;1m520 | [0m[35m        if skip_locations:[0m
[30;1m521 | [0m[35m            settings["primary_write"]["skip_locations"] = skip_locations[0m
[30;1m522 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m        settings = copy.deepcopy(self.all_settings)[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m        template_to_ad_fields = kwargs.get("template_to_ad_fields", {})[0m
[30;1m511 | [0m[35m        template_to_ad_fields_when_disable = kwargs.get([0m
[30;1m512 | [0m[35m            "template_to_ad_fields_when_disable", {}[0m
[30;1m513 | [0m[35m        )[0m
[30;1m514 | [0m[35m        settings["primary_write"]["template_to_ad_fields"].update(template_to_ad_fields)[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m        settings = copy.deepcopy(self.all_settings)[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m        template_to_ad_fields = kwargs.get("template_to_ad_fields", {})[0m
[30;1m511 | [0m[35m        template_to_ad_fields_when_disable = kwargs.get([0m
[30;1m512 | [0m[35m            "template_to_ad_fields_when_disable", {}[0m
[30;1m513 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m503 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m504 | [0m[35m        super().__init__()[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m        self._read_ou_addresses = kwargs.get("read_ou_addresses")[0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m        settings = copy.deepcopy(self.all_settings)[0m
[30;1m509 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m                        "from_date": eng["validity"]["from"],[0m
[30;1m193 | [0m[35m                        "to_date": eng["validity"]["to"],[0m
[30;1m194 | [0m[35m                        "extensions": extensions,[0m
[30;1m195 | [0m[35m                        "job_function": eng.get("job_function", {}).get("uuid"),[0m
[30;1m196 | [0m[35m                        "primary_type": None,[0m
[30;1m197 | [0m[35m                        "engagement_type": None,[0m
[30;1m198 | [0m[35m                    }[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/mocks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m                        "from_date": eng["validity"]["from"],[0m
[30;1m193 | [0m[35m                        "to_date": eng["validity"]["to"],[0m
[30;1m194 | [0m[35m                        "extensions": extensions,[0m
[30;1m195 | [0m[35m                        "job_function": eng.get("job_function", {}).get("uuid"),[0m
[30;1m196 | [0m[35m                        "primary_type": None,[0m
[30;1m197 | [0m[35m                        "engagement_type": None,[0m
[30;1m198 | [0m[35m                    }[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m97 | [0m[35m)[0m
[30;1m98 | [0m[35m@click.option([0m
[30;1m99 | [0m[35m    "--import-csv-folder",[0m
[30;1m100 | [0m[35m    help="Path to folder containing CSV files to import. Disables FTP reading",[0m
[30;1m101 | [0m[35m)[0m
[30;1m102 | [0m[35m@click.option([0m
[30;1m103 | [0m[35m    "--azid-it-system-uuid",[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m85 | [0m[35m)[0m
[30;1m86 | [0m[35m@click.option([0m
[30;1m87 | [0m[35m    "--ftp-pass",[0m
[30;1m88 | [0m[35m    help="Password to use when logging into FTP server",[0m
[30;1m89 | [0m[35m)[0m
[30;1m90 | [0m[35m@click.option([0m
[30;1m91 | [0m[35m    "--ftp-folder",[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m)[0m
[30;1m82 | [0m[35m@click.option([0m
[30;1m83 | [0m[35m    "--ftp-user",[0m
[30;1m84 | [0m[35m    help="Username to use when logging into FTP server",[0m
[30;1m85 | [0m[35m)[0m
[30;1m86 | [0m[35m@click.option([0m
[30;1m87 | [0m[35m    "--ftp-pass",[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m77 | [0m[35m@click.option("--import-from-date")[0m
[30;1m78 | [0m[35m@click.option([0m
[30;1m79 | [0m[35m    "--ftp-url",[0m
[30;1m80 | [0m[35m    help="URL of FTP where CSV files will be retrieved from",[0m
[30;1m81 | [0m[35m)[0m
[30;1m82 | [0m[35m@click.option([0m
[30;1m83 | [0m[35m    "--ftp-user",[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m31 | [0m[35m    else:[0m
[30;1m32 | [0m[35m        with open(state_file_path, "r") as f:[0m
[30;1m33 | [0m[35m            last_import = parser.parse(f.read())[0m
[30;1m34 | [0m[35m            logger.info("Last import performed at %s", last_import)[0m
[30;1m35 | [0m[35m            return last_import[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m)[0m
[30;1m98 | [0m[35m@click.option([0m
[30;1m99 | [0m[35m    "--import-csv-folder",[0m
[30;1m100 | [0m[35m    help="Path to folder containing CSV files to import. Disables FTP reading",[0m
[30;1m101 | [0m[35m)[0m
[30;1m102 | [0m[35m@click.option([0m
[30;1m103 | [0m[35m    "--azid-it-system-uuid",[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m)[0m
[30;1m86 | [0m[35m@click.option([0m
[30;1m87 | [0m[35m    "--ftp-pass",[0m
[30;1m88 | [0m[35m    help="Password to use when logging into FTP server",[0m
[30;1m89 | [0m[35m)[0m
[30;1m90 | [0m[35m@click.option([0m
[30;1m91 | [0m[35m    "--ftp-folder",[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m)[0m
[30;1m82 | [0m[35m@click.option([0m
[30;1m83 | [0m[35m    "--ftp-user",[0m
[30;1m84 | [0m[35m    help="Username to use when logging into FTP server",[0m
[30;1m85 | [0m[35m)[0m
[30;1m86 | [0m[35m@click.option([0m
[30;1m87 | [0m[35m    "--ftp-pass",[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m@click.option("--import-from-date")[0m
[30;1m78 | [0m[35m@click.option([0m
[30;1m79 | [0m[35m    "--ftp-url",[0m
[30;1m80 | [0m[35m    help="URL of FTP where CSV files will be retrieved from",[0m
[30;1m81 | [0m[35m)[0m
[30;1m82 | [0m[35m@click.option([0m
[30;1m83 | [0m[35m    "--ftp-user",[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1543 | [0m[35m        return self._prepare_adwriter(read_ou_addresses=address)[0m
[30;1m1544 | [0m[35m[0m
[30;1m1545 | [0m[35m    def _get_loracache_ad_writer(self, address):[0m
[30;1m1546 | [0m[35m        lc = MockLoraCacheUnitAddress(address_value=address.get("Adresse"))[0m
[30;1m1547 | [0m[35m        return self._prepare_adwriter(lc=lc, lc_historic=lc)[0m
[30;1m1548 | [0m[35m[0m
[30;1m1549 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1298 | [0m[35m            mismatch = ad_writer._sync_compare(mo_values, ad_dump=ad_dump)[0m
[30;1m1299 | [0m[35m[0m
[30;1m1300 | [0m[35m        # Assert we got the expected `mismatch["manager"]` value[0m
[30;1m1301 | [0m[35m        actual_manager_mismatch = mismatch.get("manager")[0m
[30;1m1302 | [0m[35m        self.assertEqual(actual_manager_mismatch, expected_manager_mismatch)[0m
[30;1m1303 | [0m[35m[0m
[30;1m1304 | [0m[35m        # Assert we logged the expected message[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35mfrom .test_utils import mo_modifier[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mJOB_TITLE_AD_FIELD_NAME = "titel"[0m
[30;1m49 | [0m[35mJOB_TITLE_TEMPLATE = "{{ ad_values.get('titel') or mo_values['title'] }}"[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m_SYNC_TIMESTAMP = "2020-01-01 12:30:00"[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1693 | [0m[35m[0m
[30;1m1694 | [0m[35mclass TestUpdateManager(_TestRealADWriter):[0m
[30;1m1695 | [0m[35m    # Mock an AD with an employee and a manager. The employee does not yet have its[0m
[30;1m1696 | [0m[35m    # `Manager` field set, so `ADWriter.sync_user` should try to update it.[0m
[30;1m1697 | [0m[35m    _ad_dump = [[0m
[30;1m1698 | [0m[35m        # Employee[0m
[30;1m1699 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1278 | [0m[35m        by `mo_values["manager_cpr"] in `ad_dump` and crashes unexpectedly.[0m
[30;1m1279 | [0m[35m[0m
[30;1m1280 | [0m[35m        This test verifies that we no longer crash in such cases, but simply do not[0m
[30;1m1281 | [0m[35m        update the `Manager` attribute in AD.[0m
[30;1m1282 | [0m[35m[0m
[30;1m1283 | [0m[35m        See: #50160[0m
[30;1m1284 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1240 | [0m[35m        updates in AD, giving empty AD fields the value `"None"`.[0m
[30;1m1241 | [0m[35m[0m
[30;1m1242 | [0m[35m        Even if no other AD fields need to be updated, this will cause `mo_to_ad_sync`[0m
[30;1m1243 | [0m[35m        to update every AD user, causing the program to take a very long time to finish.[0m
[30;1m1244 | [0m[35m[0m
[30;1m1245 | [0m[35m        Also, consider the reverse situation (AD value is `"None"`, MO value is `None`)[0m
[30;1m1246 | [0m[35m        as a non-mismatch.[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m456 | [0m[35m        update_script = first_true([0m
[30;1m457 | [0m[35m            self.ad_writer.scripts, pred=lambda s: "Set-ADUser" in s[0m
[30;1m458 | [0m[35m        )[0m
[30;1m459 | [0m[35m        # Assert that the update script uses the current AD job title[0m
[30;1m460 | [0m[35m        self._assert_script_contains_field([0m
[30;1m461 | [0m[35m            update_script,[0m
[30;1m462 | [0m[35m            JOB_TITLE_AD_FIELD_NAME,[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m                {#- If it divides without remainder, it is not prime -#}[0m
[30;1m178 | [0m[35m                {%- if remainder == 0 -%}[0m
[30;1m179 | [0m[35m                    {#- Update is_prime by reference -#}[0m
[30;1m180 | [0m[35m                    {%- set _ = vars.update({'is_prime': False}) -%}[0m
[30;1m181 | [0m[35m                {%- endif -%}[0m
[30;1m182 | [0m[35m            {%- endfor -%}[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1601 | [0m[35m            lambda mo_values: mo_values["location"] == MO_ROOT_ORG_UNIT_NAME,[0m
[30;1m1602 | [0m[35m        ),[0m
[30;1m1603 | [0m[35m        # 3. If `skip_locations` is set, and matches the location in `mo_values`,[0m
[30;1m1604 | [0m[35m        # expect `mo_values` to be None, indicating that this MO user should be skipped.[0m
[30;1m1605 | [0m[35m        ([0m
[30;1m1606 | [0m[35m            [MO_ROOT_ORG_UNIT_NAME],[0m
[30;1m1607 | [0m[35m            lambda mo_values: mo_values is None,[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1595 | [0m[35m            lambda mo_values: mo_values["location"] == MO_ROOT_ORG_UNIT_NAME,[0m
[30;1m1596 | [0m[35m        ),[0m
[30;1m1597 | [0m[35m        # 2. If `skip_locations` is set, but does not match the location in `mo_values`,[0m
[30;1m1598 | [0m[35m        # expect `mo_values` to be present and contain the expected location.[0m
[30;1m1599 | [0m[35m        ([0m
[30;1m1600 | [0m[35m            ["Something that is not MO_ROOT_ORG_UNIT_NAME"],[0m
[30;1m1601 | [0m[35m            lambda mo_values: mo_values["location"] == MO_ROOT_ORG_UNIT_NAME,[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1586 | [0m[35m[0m
[30;1m1587 | [0m[35mclass TestSkipLocation(_TestRealADWriter):[0m
[30;1m1588 | [0m[35m    _combinations = [[0m
[30;1m1589 | [0m[35m        # 1. If `skip_locations` is not set, expect `mo_values` to be present, and[0m
[30;1m1590 | [0m[35m        # contain the expected location.[0m
[30;1m1591 | [0m[35m        ([0m
[30;1m1592 | [0m[35m            # Value of the `skip_locations` setting[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1577 | [0m[35m    def test_get_enable_user_cmd_strips_linebreaks(self):[0m
[30;1m1578 | [0m[35m        ad_writer = self._prepare_adwriter()[0m
[30;1m1579 | [0m[35m        ps_script = ad_writer._get_enable_user_cmd("user", enable=False)[0m
[30;1m1580 | [0m[35m        # Find actual "Get-ADUser NNN | Set-ADUser NNN -Enabled $false" line in PS[0m
[30;1m1581 | [0m[35m        match = re.search("Get-ADUser .*", ps_script, re.MULTILINE)[0m
[30;1m1582 | [0m[35m        # Assert that this line does not contain any unintended line breaks, caused by[0m
[30;1m1583 | [0m[35m        # forgetting to call `AD.remove_redundant`.[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1333 | [0m[35m            "'ad_field_name': MO value is INVALID, not changing AD value None",[0m
[30;1m1334 | [0m[35m        )[0m
[30;1m1335 | [0m[35m[0m
[30;1m1336 | [0m[35m        # Assert that the generated PowerShell script does not include the invalid value[0m
[30;1m1337 | [0m[35m        with mock.patch.object(ad_writer, "_run_ps_script") as mock_run_ps_script:[0m
[30;1m1338 | [0m[35m            ad_writer.sync_user("mo_uuid", ad_dump=ad_dump)[0m
[30;1m1339 | [0m[35m            ps_script = mock_run_ps_script.call_args[0][0][0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1323 | [0m[35m[0m
[30;1m1324 | [0m[35m        # Assert that we logged the expected message[0m
[30;1m1325 | [0m[35m        self.assertEqual([0m
[30;1m1326 | [0m[35m            # Find matching log message[0m
[30;1m1327 | [0m[35m            only([0m
[30;1m1328 | [0m[35m                record.message[0m
[30;1m1329 | [0m[35m                for record in actual_log_messages.records[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1274 | [0m[35m        self, ad_dump_extra, expected_manager_mismatch, expected_log_message[0m
[30;1m1275 | [0m[35m    ):[0m
[30;1m1276 | [0m[35m        """When `ADWriter.sync_user` is called from `run_mo_to_ad_sync`, an `ad_dump`[0m
[30;1m1277 | [0m[35m        is provided. However, sometimes `sync_user` cannot find the AD user specified[0m
[30;1m1278 | [0m[35m        by `mo_values["manager_cpr"] in `ad_dump` and crashes unexpectedly.[0m
[30;1m1279 | [0m[35m[0m
[30;1m1280 | [0m[35m        This test verifies that we no longer crash in such cases, but simply do not[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1260 | [0m[35m            ([0m
[30;1m1261 | [0m[35m                [],  # manager not present in AD[0m
[30;1m1262 | [0m[35m                None,  # expected `mismatch["manager"]`[0m
[30;1m1263 | [0m[35m                "could not find manager by cpr",  # expected logging[0m
[30;1m1264 | [0m[35m            ),[0m
[30;1m1265 | [0m[35m            ([0m
[30;1m1266 | [0m[35m                # manager present in AD[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1240 | [0m[35m        updates in AD, giving empty AD fields the value `"None"`.[0m
[30;1m1241 | [0m[35m[0m
[30;1m1242 | [0m[35m        Even if no other AD fields need to be updated, this will cause `mo_to_ad_sync`[0m
[30;1m1243 | [0m[35m        to update every AD user, causing the program to take a very long time to finish.[0m
[30;1m1244 | [0m[35m[0m
[30;1m1245 | [0m[35m        Also, consider the reverse situation (AD value is `"None"`, MO value is `None`)[0m
[30;1m1246 | [0m[35m        as a non-mismatch.[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m782 | [0m[35m        # and one for updating the other AD user attributes.[0m
[30;1m783 | [0m[35m        self.assertEqual(len(self.ad_writer.scripts), 2)[0m
[30;1m784 | [0m[35m[0m
[30;1m785 | [0m[35m        # Fetch the "rename" command itself: the last line of the first script[0m
[30;1m786 | [0m[35m        rename_cmd = self.ad_writer.scripts[0].splitlines()[-1][0m
[30;1m787 | [0m[35m        # Assert that the "rename" command does indeed attempt to rename the AD[0m
[30;1m788 | [0m[35m        # user to "Firstname Lastname - testing", due to the mapping in[0m
[30;1m789 | [0m[35m        # `settings_transformer`.[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m456 | [0m[35m        update_script = first_true([0m
[30;1m457 | [0m[35m            self.ad_writer.scripts, pred=lambda s: "Set-ADUser" in s[0m
[30;1m458 | [0m[35m        )[0m
[30;1m459 | [0m[35m        # Assert that the update script uses the current AD job title[0m
[30;1m460 | [0m[35m        self._assert_script_contains_field([0m
[30;1m461 | [0m[35m            update_script,[0m
[30;1m462 | [0m[35m            JOB_TITLE_AD_FIELD_NAME,[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m452 | [0m[35m        mo_uuid = "invalid-provided-and-accepted-due-to-mocking"[0m
[30;1m453 | [0m[35m        mo_value = self.mo_values_func()["title"][0m
[30;1m454 | [0m[35m        self.ad_writer.sync_user(mo_uuid, ad_dump=None, sync_manager=False)[0m
[30;1m455 | [0m[35m        # Find the "update AD user" script[0m
[30;1m456 | [0m[35m        update_script = first_true([0m
[30;1m457 | [0m[35m            self.ad_writer.scripts, pred=lambda s: "Set-ADUser" in s[0m
[30;1m458 | [0m[35m        )[0m
[30;1m459 | [0m[35m        # Assert that the update script uses the current AD job title[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m452 | [0m[35m        mo_uuid = "invalid-provided-and-accepted-due-to-mocking"[0m
[30;1m453 | [0m[35m        mo_value = self.mo_values_func()["title"][0m
[30;1m454 | [0m[35m        self.ad_writer.sync_user(mo_uuid, ad_dump=None, sync_manager=False)[0m
[30;1m455 | [0m[35m        # Find the "update AD user" script[0m
[30;1m456 | [0m[35m        update_script = first_true([0m
[30;1m457 | [0m[35m            self.ad_writer.scripts, pred=lambda s: "Set-ADUser" in s[0m
[30;1m458 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m417 | [0m[35m        )[0m
[30;1m418 | [0m[35m        mo_uuid = "invalid-provided-and-accepted-due-to-mocking"[0m
[30;1m419 | [0m[35m        self.ad_writer.create_user(mo_uuid, create_manager=False)[0m
[30;1m420 | [0m[35m        # Find the "create AD user" script[0m
[30;1m421 | [0m[35m        create_script = first_true([0m
[30;1m422 | [0m[35m            self.ad_writer.scripts, pred=lambda s: "New-ADUser" in s[0m
[30;1m423 | [0m[35m        )[0m
[30;1m424 | [0m[35m        # Assert that it contains the mapped job title field[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m417 | [0m[35m        )[0m
[30;1m418 | [0m[35m        mo_uuid = "invalid-provided-and-accepted-due-to-mocking"[0m
[30;1m419 | [0m[35m        self.ad_writer.create_user(mo_uuid, create_manager=False)[0m
[30;1m420 | [0m[35m        # Find the "create AD user" script[0m
[30;1m421 | [0m[35m        create_script = first_true([0m
[30;1m422 | [0m[35m            self.ad_writer.scripts, pred=lambda s: "New-ADUser" in s[0m
[30;1m423 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m        This is verified by the 'verify_identical_common_code' method.[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        Create_user is used as a test-case to provoke the creation of a PS script,[0m
[30;1m127 | [0m[35m        but only the common top of the code is actually tested.[0m
[30;1m128 | [0m[35m        """[0m
[30;1m129 | [0m[35m        self._setup_adwriter(settings_transformer)[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m        )[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    def _assert_script_contains_field(self, script, name, value):[0m
[30;1m90 | [0m[35m        """Assert that AD PowerShell script `script` includes the AD field[0m
[30;1m91 | [0m[35m        called `name` and that the field value is `value`.[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        self.assertRegex(script, f'"{name}"="{value}"')[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m        """[0m
[30;1m63 | [0m[35m        self.assertEqual(len(self.ad_writer.scripts), num_expected_scripts)[0m
[30;1m64 | [0m[35m        # 1. Convert each script from a string into a list of strings (lines)[0m
[30;1m65 | [0m[35m        lines = [script.split("\n") for script in self.ad_writer.scripts][0m
[30;1m66 | [0m[35m        self.assertGreaterEqual(len(lines[0]), num_common_lines)[0m
[30;1m67 | [0m[35m        self.assertEqual(len(lines), num_expected_scripts)[0m
[30;1m68 | [0m[35m        # 2. Get the common lines (first `num_common_lines` lines in each[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m        I.e. that all scripts start with the same num_common_lines lines.[0m
[30;1m62 | [0m[35m        """[0m
[30;1m63 | [0m[35m        self.assertEqual(len(self.ad_writer.scripts), num_expected_scripts)[0m
[30;1m64 | [0m[35m        # 1. Convert each script from a string into a list of strings (lines)[0m
[30;1m65 | [0m[35m        lines = [script.split("\n") for script in self.ad_writer.scripts][0m
[30;1m66 | [0m[35m        self.assertGreaterEqual(len(lines[0]), num_common_lines)[0m
[30;1m67 | [0m[35m        self.assertEqual(len(lines), num_expected_scripts)[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m379 | [0m[35m        ):[0m
[30;1m380 | [0m[35m            with patch([0m
[30;1m381 | [0m[35m                "integrations.ad_integration.ad_writer.ADParameterReader",[0m
[30;1m382 | [0m[35m                kwargs.get("mock_ad_reader_class", MockEmptyADReader),[0m
[30;1m383 | [0m[35m            ):[0m
[30;1m384 | [0m[35m                self.ad_writer = ADWriterTestSubclass([0m
[30;1m385 | [0m[35m                    all_settings=self.settings,[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m340 | [0m[35m                        modified_settings.get([0m
[30;1m341 | [0m[35m                            "integrations.ad_writer.template_to_ad_fields", {}[0m
[30;1m342 | [0m[35m                        ).keys(),[0m
[30;1m343 | [0m[35m                        modified_settings.get([0m
[30;1m344 | [0m[35m                            "integrations.ad_writer.mo_to_ad_fields", {}[0m
[30;1m345 | [0m[35m                        ).values(),[0m
[30;1m346 | [0m[35m                        [modified_settings["integrations.ad.write.org_unit_field"]],[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m                map([0m
[30;1m335 | [0m[35m                    lambda x: x.lower(),[0m
[30;1m336 | [0m[35m                    chain([0m
[30;1m337 | [0m[35m                        modified_settings.get([0m
[30;1m338 | [0m[35m                            "integrations.ad_writer.template_to_ad_fields", {}[0m
[30;1m339 | [0m[35m                        ).keys(),[0m
[30;1m340 | [0m[35m                        modified_settings.get([0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m        # Transformer for mo_values return[0m
[30;1m81 | [0m[35m        self.read_ad_information_from_mo = read_ad_information_from_mo[0m
[30;1m82 | [0m[35m        # Replace real `_find_ad_user` with mock[0m
[30;1m83 | [0m[35m        if kwargs.get("mock_find_ad_user", True):[0m
[30;1m84 | [0m[35m            self._find_ad_user = lambda ad_user, ad_dump=None: ad_values_func()[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    def _init_name_creator(self):[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m        """[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        def run_ps(ps_script):[0m
[30;1m100 | [0m[35m            # Add our script to the list[0m
[30;1m101 | [0m[35m            self.scripts.append(ps_script)[0m
[30;1m102 | [0m[35m            # Fake the WinRM run_ps return type[0m
[30;1m103 | [0m[35m            return AttrDict([0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport uuid[0m
[30;1m3 | [0m[35mfrom datetime import datetime[0m
[30;1m4 | [0m[35mfrom functools import partial[0m
[30;1m5 | [0m[35mfrom itertools import chain[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/tests/test_los_stam.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m                expected_facet_uuid = uuid.uuid4()[0m
[30;1m174 | [0m[35m                mox_helper = mh.return_value[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m                # Pretend that we find the facet UUID in LoRa (= it already exists)[0m
[30;1m177 | [0m[35m                mox_helper.read_element_klassifikation_facet.return_value = ([0m
[30;1m178 | [0m[35m                    expected_facet_uuid[0m
[30;1m179 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m        logger.info("Posting payloads to OS2mo ")[0m
[30;1m132 | [0m[35m        url = "{}/service/details/create".format(self.mora_base)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        r = self.mora_session.post(url, json=payloads, params={"force": 1})[0m
[30;1m135 | [0m[35m        r.raise_for_status()[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m    @abstractmethod[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m        # filter by org_unit_level if configured in settings[0m
[30;1m122 | [0m[35m        if org_unit_levels := self.settings.integrations_kle_xlsx_org_unit_levels:[0m
[30;1m123 | [0m[35m            units = [[0m
[30;1m124 | [0m[35m                o for o in units if o["org_unit_level"].get("name") in org_unit_levels[0m
[30;1m125 | [0m[35m            ][0m
[30;1m126 | [0m[35m        logger.info("Found {} units".format(len(units)))[0m
[30;1m127 | [0m[35m        return units[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        :return:[0m
[30;1m79 | [0m[35m        """[0m
[30;1m80 | [0m[35m        logger.info("Fetching Organisation UUID from OS2mo")[0m
[30;1m81 | [0m[35m        r = self.mora_session.get("{}/service/o/".format(self.mora_base))[0m
[30;1m82 | [0m[35m        r.raise_for_status()[0m
[30;1m83 | [0m[35m        return r.json()[0]["uuid"][0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import_export.py[0m
   Pattern: [32m.hostname[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        self.mora_base = self.settings.mora_base[0m
[30;1m46 | [0m[35m        self.mora_session = self._get_mora_session()[0m
[30;1m47 | [0m[35m        self.helper = MoraHelper(hostname=self.mora_base)[0m
[30;1m48 | [0m[35m        self.org_uuid = self.helper.read_organisation()[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m        kle_classes = self.get_kle_classes_from_mo()[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_life_cycle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m372 | [0m[35m                MockLoraCacheParentChildUnit,[0m
[30;1m373 | [0m[35m                True,[0m
[30;1m374 | [0m[35m            ),[0m
[30;1m375 | [0m[35m            # Case 3: we look for the root unit, but there are no units at all.[0m
[30;1m376 | [0m[35m            ([0m
[30;1m377 | [0m[35m                mock_find_primary_engagement(MO_ROOT_ORG_UNIT_UUID),[0m
[30;1m378 | [0m[35m                MockLoraCacheEmptyUnit,[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_life_cycle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m119 | [0m[35m                # Assert no AD writes were done[0m
[30;1m120 | [0m[35m                None,[0m
[30;1m121 | [0m[35m            ),[0m
[30;1m122 | [0m[35m            # 5. An AD user must *not* be created if at least one "create[0m
[30;1m123 | [0m[35m            # filter" returns `True` for the corresponding MO user.[0m
[30;1m124 | [0m[35m            ([0m
[30;1m125 | [0m[35m                # A "create filter" is a Jinja template evaluating to `True` or[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m387 | [0m[35m                False,[0m
[30;1m388 | [0m[35m            ),[0m
[30;1m389 | [0m[35m            # Case 5: we look for a child unit, but the child node has an unset[0m
[30;1m390 | [0m[35m            # parent node reference, and we cannot find the root unit.[0m
[30;1m391 | [0m[35m            ([0m
[30;1m392 | [0m[35m                mock_find_primary_engagement(MO_CHILD_ORG_UNIT_UUID),[0m
[30;1m393 | [0m[35m                MockLoraCacheParentUnitUnset,[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m387 | [0m[35m                False,[0m
[30;1m388 | [0m[35m            ),[0m
[30;1m389 | [0m[35m            # Case 5: we look for a child unit, but the child node has an unset[0m
[30;1m390 | [0m[35m            # parent node reference, and we cannot find the root unit.[0m
[30;1m391 | [0m[35m            ([0m
[30;1m392 | [0m[35m                mock_find_primary_engagement(MO_CHILD_ORG_UNIT_UUID),[0m
[30;1m393 | [0m[35m                MockLoraCacheParentUnitUnset,[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m386 | [0m[35m                MockLoraCacheDanglingParentUnit,[0m
[30;1m387 | [0m[35m                False,[0m
[30;1m388 | [0m[35m            ),[0m
[30;1m389 | [0m[35m            # Case 5: we look for a child unit, but the child node has an unset[0m
[30;1m390 | [0m[35m            # parent node reference, and we cannot find the root unit.[0m
[30;1m391 | [0m[35m            ([0m
[30;1m392 | [0m[35m                mock_find_primary_engagement(MO_CHILD_ORG_UNIT_UUID),[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m366 | [0m[35m                MockLoraCacheExtended,[0m
[30;1m367 | [0m[35m                True,[0m
[30;1m368 | [0m[35m            ),[0m
[30;1m369 | [0m[35m            # Case 2: we look for a child of the root unit, and find it.[0m
[30;1m370 | [0m[35m            ([0m
[30;1m371 | [0m[35m                mock_find_primary_engagement(MO_CHILD_ORG_UNIT_UUID),[0m
[30;1m372 | [0m[35m                MockLoraCacheParentChildUnit,[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m    @parameterized.expand([0m
[30;1m362 | [0m[35m        [[0m
[30;1m363 | [0m[35m            # Case 1: we look for the root unit and find it.[0m
[30;1m364 | [0m[35m            ([0m
[30;1m365 | [0m[35m                mock_find_primary_engagement(MO_ROOT_ORG_UNIT_UUID),[0m
[30;1m366 | [0m[35m                MockLoraCacheExtended,[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m351 | [0m[35m        # Call decorated function with mock `(employee, ad_user)` tuple[0m
[30;1m352 | [0m[35m        foobar((employee, None))[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m        # Expect to find a dictionary mapping employee UUID to employee name[0m
[30;1m355 | [0m[35m        # under `instance.stats["skipped"]["foobar"]`.[0m
[30;1m356 | [0m[35m        self.assertDictEqual([0m
[30;1m357 | [0m[35m            instance.stats["skipped"]["foobar"],[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m351 | [0m[35m        # Call decorated function with mock `(employee, ad_user)` tuple[0m
[30;1m352 | [0m[35m        foobar((employee, None))[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m        # Expect to find a dictionary mapping employee UUID to employee name[0m
[30;1m355 | [0m[35m        # under `instance.stats["skipped"]["foobar"]`.[0m
[30;1m356 | [0m[35m        self.assertDictEqual([0m
[30;1m357 | [0m[35m            instance.stats["skipped"]["foobar"],[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m    @parameterized.expand([0m
[30;1m54 | [0m[35m        [[0m
[30;1m55 | [0m[35m            # 1. An AD user must be created when the AD is empty.[0m
[30;1m56 | [0m[35m            # In this test, we mock an empty AD. Therefore we expect exactly[0m
[30;1m57 | [0m[35m            # one AD write (`New-ADUser`) to be performed.[0m
[30;1m58 | [0m[35m            ([0m
[30;1m59 | [0m[35m                # Empty `_get_instance` kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/utils/priority_by_class.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35m    An address candidates desirability is inversely propertional to its address[0m
[30;1m9 | [0m[35m    types position inside prioritized_classes. I.e. address candidates whose address[0m
[30;1m10 | [0m[35m    types occur earlier in prioritized_classes are more desirable than address[0m
[30;1m11 | [0m[35m    candidates whose address types occur later (or yet worse, not at all).[0m
[30;1m12 | [0m[35m    Additionally lower UUIDs are considered more desirable than larger ones, this is[0m
[30;1m13 | [0m[35m    to ensure a consistent order regardless of the order of the candidates.[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m        jinja_map[ad_field] = "{{ mo_values['" + mo_field + "'] }}"[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m    # Local fields for MO->AD sync'ing[0m
[30;1m245 | [0m[35m    named_sync_template_fields = write_settings.get("template_to_ad_fields")[0m
[30;1m246 | [0m[35m    for ad_field, template in named_sync_template_fields.items():[0m
[30;1m247 | [0m[35m        jinja_map[ad_field] = template[0m
[30;1m248 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m    jinja_map[write_settings["org_field"]] = "{{ mo_values['location'] }}"[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    # Local fields for MO->AD sync'ing[0m
[30;1m240 | [0m[35m    named_sync_fields = write_settings.get("mo_to_ad_fields")[0m
[30;1m241 | [0m[35m    for mo_field, ad_field in named_sync_fields.items():[0m
[30;1m242 | [0m[35m        jinja_map[ad_field] = "{{ mo_values['" + mo_field + "'] }}"[0m
[30;1m243 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m    write_settings = _get_setting_type(settings, "primary_write")[0m
[30;1m230 | [0m[35m    primary_settings = _get_setting_type(settings, "primary")[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m    if write_settings.get("level2orgunit_field"):[0m
[30;1m233 | [0m[35m        jinja_map[write_settings["level2orgunit_field"]] = ([0m
[30;1m234 | [0m[35m            "{{ mo_values['level2orgunit'] }}"[0m
[30;1m235 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m393 | [0m[35m    cmd_options = cmdlet_templates.keys()[0m
[30;1m394 | [0m[35m    if cmd not in cmd_options:[0m
[30;1m395 | [0m[35m        raise ValueError([0m
[30;1m396 | [0m[35m            "prepare_template cmd must be one of: " + ",".join(cmd_options)[0m
[30;1m397 | [0m[35m        )[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m    command_template = load_jinja_template(environment, cmdlet_templates[cmd])[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m391 | [0m[35m    """[0m
[30;1m392 | [0m[35m    # Load command template via cmd[0m
[30;1m393 | [0m[35m    cmd_options = cmdlet_templates.keys()[0m
[30;1m394 | [0m[35m    if cmd not in cmd_options:[0m
[30;1m395 | [0m[35m        raise ValueError([0m
[30;1m396 | [0m[35m            "prepare_template cmd must be one of: " + ",".join(cmd_options)[0m
[30;1m397 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m389 | [0m[35m        str: A jinja template string produced by templating the command[0m
[30;1m390 | [0m[35m             template with all the field templates.[0m
[30;1m391 | [0m[35m    """[0m
[30;1m392 | [0m[35m    # Load command template via cmd[0m
[30;1m393 | [0m[35m    cmd_options = cmdlet_templates.keys()[0m
[30;1m394 | [0m[35m    if cmd not in cmd_options:[0m
[30;1m395 | [0m[35m        raise ValueError([0m
[30;1m396 | [0m[35m            "prepare_template cmd must be one of: " + ",".join(cmd_options)[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35mdef prepare_and_check_login_field_templates(jinja_map):[0m
[30;1m265 | [0m[35m    """Check validity and expand jinja_map with login templates.[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m    Args:[0m
[30;1m268 | [0m[35m        jinja_map: dictionary from ad field names to jinja template strings.[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m246 | [0m[35m    for ad_field, template in named_sync_template_fields.items():[0m
[30;1m247 | [0m[35m        jinja_map[ad_field] = template[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m    if cmd == "New-ADUser":  # New user[0m
[30;1m250 | [0m[35m        jinja_map["UserPrincipalName"] = "{{ user_sam }}@" + write_settings["upn_end"][0m
[30;1m251 | [0m[35m        jinja_map[write_settings["uuid_field"]] = "{{ mo_values['uuid'] }}"[0m
[30;1m252 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m179 | [0m[35m        }[0m
[30;1m180 | [0m[35m        {% endif %}[0m
[30;1m181 | [0m[35m    """,[0m
[30;1m182 | [0m[35m    # Update information saved on a user[0m
[30;1m183 | [0m[35m    # Notice: Name cannot be updated using Set-ADUser, this must be done[0m
[30;1m184 | [0m[35m    # with Rename-AdObject[0m
[30;1m185 | [0m[35m    # TODO: Consider Replace versus Remove/Clean/Add[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35mdef prepare_and_check_login_field_templates(jinja_map):[0m
[30;1m265 | [0m[35m    """Check validity and expand jinja_map with login templates.[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m    Args:[0m
[30;1m268 | [0m[35m        jinja_map: dictionary from ad field names to jinja template strings.[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_template_engine.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m220 | [0m[35m        try:[0m
[30;1m221 | [0m[35m            result = settings[key][0m
[30;1m222 | [0m[35m        except KeyError:[0m
[30;1m223 | [0m[35m            msg = "Unable to find settings type: " + key[0m
[30;1m224 | [0m[35m            print(msg)[0m
[30;1m225 | [0m[35m        if not result:[0m
[30;1m226 | [0m[35m            raise Exception("%r is empty" % key)[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_file_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m    settings = settings or load_settings()[0m
[30;1m98 | [0m[35m    if settings.get("integrations.opus.gcloud_bucket_name"):[0m
[30;1m99 | [0m[35m        return GcloudOpusReader(settings)[0m
[30;1m100 | [0m[35m    if settings.get("integrations.opus.smb_host"):[0m
[30;1m101 | [0m[35m        return SMBOpusReader(settings)[0m
[30;1m102 | [0m[35m    return LocalOpusReader(settings)[0m
[30;1m103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_file_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35mdef get_opus_filereader(settings: Optional[Dict] = None) -> OpusReaderInterface:[0m
[30;1m96 | [0m[35m    """Get the correct opus reader interface based on values from settings."""[0m
[30;1m97 | [0m[35m    settings = settings or load_settings()[0m
[30;1m98 | [0m[35m    if settings.get("integrations.opus.gcloud_bucket_name"):[0m
[30;1m99 | [0m[35m        return GcloudOpusReader(settings)[0m
[30;1m100 | [0m[35m    if settings.get("integrations.opus.smb_host"):[0m
[30;1m101 | [0m[35m        return SMBOpusReader(settings)[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m) -> Dict:[0m
[30;1m231 | [0m[35m    ad_settings = ad_settings or read_settings()[0m
[30;1m232 | [0m[35m    normal_settings = normal_settings or load_settings()[0m
[30;1m233 | [0m[35m    inject = normal_settings.get(settings_key, {})[0m
[30;1m234 | [0m[35m    for path, value in inject.items():[0m
[30;1m235 | [0m[35m        assign(ad_settings, path, value)[0m
[30;1m236 | [0m[35m    return ad_settings[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    # Check that all settings we write to are in properties for all ADs[0m
[30;1m197 | [0m[35m    for ad_settings in top_settings["integrations.ad"]:[0m
[30;1m198 | [0m[35m        properties = set(map(str.lower, ad_settings.get("properties", [])))[0m
[30;1m199 | [0m[35m        missing_properties = list([0m
[30;1m200 | [0m[35m            filter([0m
[30;1m201 | [0m[35m                lambda ad_field: ad_field != "" and ad_field.lower() not in properties,[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m    mo_to_ad_fields = conf["mo_to_ad_fields"][0m
[30;1m179 | [0m[35m    template_to_ad_fields = conf["template_to_ad_fields"][0m
[30;1m180 | [0m[35m    other_ad_field_names = [conf["org_field"], conf["uuid_field"]][0m
[30;1m181 | [0m[35m    if conf.get("level2orgunit_field"):[0m
[30;1m182 | [0m[35m        other_ad_field_names.append(conf["level2orgunit_field"])[0m
[30;1m183 | [0m[35m    ad_field_names = ([0m
[30;1m184 | [0m[35m        list(mo_to_ad_fields.values())[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m        conf["skip_locations"] = top_settings["integrations.ad_writer.skip_locations"][0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    # Feature flag "use future managers" (#47213)[0m
[30;1m173 | [0m[35m    conf["use_future_managers"] = top_settings.get([0m
[30;1m174 | [0m[35m        "integrations.ad_writer.use_future_managers", False[0m
[30;1m175 | [0m[35m    )[0m
[30;1m176 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m    conf["template_to_ad_fields"] = top_settings.get([0m
[30;1m154 | [0m[35m        "integrations.ad_writer.template_to_ad_fields", {}[0m
[30;1m155 | [0m[35m    )[0m
[30;1m156 | [0m[35m    conf["template_to_ad_fields_when_disable"] = top_settings.get([0m
[30;1m157 | [0m[35m        "integrations.ad_writer.template_to_ad_fields_when_disable", {}[0m
[30;1m158 | [0m[35m    )[0m
[30;1m159 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m    conf["mo_to_ad_fields"] = top_settings.get([0m
[30;1m151 | [0m[35m        "integrations.ad_writer.mo_to_ad_fields", {}[0m
[30;1m152 | [0m[35m    )[0m
[30;1m153 | [0m[35m    conf["template_to_ad_fields"] = top_settings.get([0m
[30;1m154 | [0m[35m        "integrations.ad_writer.template_to_ad_fields", {}[0m
[30;1m155 | [0m[35m    )[0m
[30;1m156 | [0m[35m    conf["template_to_ad_fields_when_disable"] = top_settings.get([0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m        raise ValueError(msg % missing)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    # Template fields[0m
[30;1m150 | [0m[35m    conf["mo_to_ad_fields"] = top_settings.get([0m
[30;1m151 | [0m[35m        "integrations.ad_writer.mo_to_ad_fields", {}[0m
[30;1m152 | [0m[35m    )[0m
[30;1m153 | [0m[35m    conf["template_to_ad_fields"] = top_settings.get([0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m    primary_settings["ad_mo_sync_pre_filters"] = index_settings.get([0m
[30;1m107 | [0m[35m        "ad_mo_sync_pre_filters", [][0m
[30;1m108 | [0m[35m    )[0m
[30;1m109 | [0m[35m    primary_settings["ad_mo_sync_terminate_disabled_filters"] = index_settings.get([0m
[30;1m110 | [0m[35m        "ad_mo_sync_terminate_disabled_filters", [][0m
[30;1m111 | [0m[35m    )[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m    primary_settings["ad_mo_sync_terminate_disabled"] = index_settings.get([0m
[30;1m104 | [0m[35m        "ad_mo_sync_terminate_disabled"[0m
[30;1m105 | [0m[35m    )[0m
[30;1m106 | [0m[35m    primary_settings["ad_mo_sync_pre_filters"] = index_settings.get([0m
[30;1m107 | [0m[35m        "ad_mo_sync_pre_filters", [][0m
[30;1m108 | [0m[35m    )[0m
[30;1m109 | [0m[35m    primary_settings["ad_mo_sync_terminate_disabled_filters"] = index_settings.get([0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m    primary_settings["ad_mo_sync_terminate_missing_require_itsystem"] = ([0m
[30;1m101 | [0m[35m        index_settings.get("ad_mo_sync_terminate_missing_require_itsystem", True)[0m
[30;1m102 | [0m[35m    )[0m
[30;1m103 | [0m[35m    primary_settings["ad_mo_sync_terminate_disabled"] = index_settings.get([0m
[30;1m104 | [0m[35m        "ad_mo_sync_terminate_disabled"[0m
[30;1m105 | [0m[35m    )[0m
[30;1m106 | [0m[35m    primary_settings["ad_mo_sync_pre_filters"] = index_settings.get([0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m        "ad_mo_sync_terminate_missing", False[0m
[30;1m99 | [0m[35m    )[0m
[30;1m100 | [0m[35m    primary_settings["ad_mo_sync_terminate_missing_require_itsystem"] = ([0m
[30;1m101 | [0m[35m        index_settings.get("ad_mo_sync_terminate_missing_require_itsystem", True)[0m
[30;1m102 | [0m[35m    )[0m
[30;1m103 | [0m[35m    primary_settings["ad_mo_sync_terminate_disabled"] = index_settings.get([0m
[30;1m104 | [0m[35m        "ad_mo_sync_terminate_disabled"[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m    primary_settings["ad_mo_sync_mapping"] = index_settings.get([0m
[30;1m95 | [0m[35m        "ad_mo_sync_mapping", {}[0m
[30;1m96 | [0m[35m    )[0m
[30;1m97 | [0m[35m    primary_settings["ad_mo_sync_terminate_missing"] = index_settings.get([0m
[30;1m98 | [0m[35m        "ad_mo_sync_terminate_missing", False[0m
[30;1m99 | [0m[35m    )[0m
[30;1m100 | [0m[35m    primary_settings["ad_mo_sync_terminate_missing_require_itsystem"] = ([0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    primary_settings["method"] = index_settings.get("method", "kerberos")[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    primary_settings["ad_mo_sync_mapping"] = index_settings.get([0m
[30;1m95 | [0m[35m        "ad_mo_sync_mapping", {}[0m
[30;1m96 | [0m[35m    )[0m
[30;1m97 | [0m[35m    primary_settings["ad_mo_sync_terminate_missing"] = index_settings.get([0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m    primary_settings["cpr_separator"] = index_settings.get("cpr_separator", "")[0m
[30;1m90 | [0m[35m    primary_settings["pseudo_cprs"] = index_settings.get("pseudo_cprs", [])[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    primary_settings["method"] = index_settings.get("method", "kerberos")[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    primary_settings["ad_mo_sync_mapping"] = index_settings.get([0m
[30;1m95 | [0m[35m        "ad_mo_sync_mapping", {}[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m    primary_settings["caseless_samname"] = index_settings.get("caseless_samname", True)[0m
[30;1m88 | [0m[35m    primary_settings["sam_filter"] = index_settings.get("sam_filter", "")[0m
[30;1m89 | [0m[35m    primary_settings["cpr_separator"] = index_settings.get("cpr_separator", "")[0m
[30;1m90 | [0m[35m    primary_settings["pseudo_cprs"] = index_settings.get("pseudo_cprs", [])[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    primary_settings["method"] = index_settings.get("method", "kerberos")[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m    primary_settings["servers"] = index_settings.get("servers", [])[0m
[30;1m87 | [0m[35m    primary_settings["caseless_samname"] = index_settings.get("caseless_samname", True)[0m
[30;1m88 | [0m[35m    primary_settings["sam_filter"] = index_settings.get("sam_filter", "")[0m
[30;1m89 | [0m[35m    primary_settings["cpr_separator"] = index_settings.get("cpr_separator", "")[0m
[30;1m90 | [0m[35m    primary_settings["pseudo_cprs"] = index_settings.get("pseudo_cprs", [])[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    primary_settings["method"] = index_settings.get("method", "kerberos")[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m    index_settings = top_settings["integrations.ad"][index][0m
[30;1m86 | [0m[35m    primary_settings["servers"] = index_settings.get("servers", [])[0m
[30;1m87 | [0m[35m    primary_settings["caseless_samname"] = index_settings.get("caseless_samname", True)[0m
[30;1m88 | [0m[35m    primary_settings["sam_filter"] = index_settings.get("sam_filter", "")[0m
[30;1m89 | [0m[35m    primary_settings["cpr_separator"] = index_settings.get("cpr_separator", "")[0m
[30;1m90 | [0m[35m    primary_settings["pseudo_cprs"] = index_settings.get("pseudo_cprs", [])[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m    # Settings that do not need to be set, or have defaults[0m
[30;1m85 | [0m[35m    index_settings = top_settings["integrations.ad"][index][0m
[30;1m86 | [0m[35m    primary_settings["servers"] = index_settings.get("servers", [])[0m
[30;1m87 | [0m[35m    primary_settings["caseless_samname"] = index_settings.get("caseless_samname", True)[0m
[30;1m88 | [0m[35m    primary_settings["sam_filter"] = index_settings.get("sam_filter", "")[0m
[30;1m89 | [0m[35m    primary_settings["cpr_separator"] = index_settings.get("cpr_separator", "")[0m
[30;1m90 | [0m[35m    primary_settings["pseudo_cprs"] = index_settings.get("pseudo_cprs", [])[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    # Settings that do not need to be set, or have defaults[0m
[30;1m85 | [0m[35m    index_settings = top_settings["integrations.ad"][index][0m
[30;1m86 | [0m[35m    primary_settings["servers"] = index_settings.get("servers", [])[0m
[30;1m87 | [0m[35m    primary_settings["caseless_samname"] = index_settings.get("caseless_samname", True)[0m
[30;1m88 | [0m[35m    primary_settings["sam_filter"] = index_settings.get("sam_filter", "")[0m
[30;1m89 | [0m[35m    primary_settings["cpr_separator"] = index_settings.get("cpr_separator", "")[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        primary_settings["discriminator.function"] = top_settings["integrations.ad"][[0m
[30;1m73 | [0m[35m            index[0m
[30;1m74 | [0m[35m        ].get("discriminator.function")[0m
[30;1m75 | [0m[35m        if primary_settings["discriminator.function"] is None:[0m
[30;1m76 | [0m[35m            missing.append("discriminator.function")[0m
[30;1m77 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m        # if we have a field we MUST have .values and .function[0m
[30;1m66 | [0m[35m        primary_settings["discriminator.values"] = top_settings["integrations.ad"][[0m
[30;1m67 | [0m[35m            index[0m
[30;1m68 | [0m[35m        ].get("discriminator.values")[0m
[30;1m69 | [0m[35m        if primary_settings["discriminator.values"] is None:[0m
[30;1m70 | [0m[35m            missing.append("discriminator.values")[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m    # 36182 exclude non primary AD-users[0m
[30;1m61 | [0m[35m    primary_settings["discriminator.field"] = top_settings["integrations.ad"][[0m
[30;1m62 | [0m[35m        index[0m
[30;1m63 | [0m[35m    ].get("discriminator.field")[0m
[30;1m64 | [0m[35m    if primary_settings["discriminator.field"] is not None:[0m
[30;1m65 | [0m[35m        # if we have a field we MUST have .values and .function[0m
[30;1m66 | [0m[35m        primary_settings["discriminator.values"] = top_settings["integrations.ad"][[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m    primary_settings["password"] = top_settings["integrations.ad"][index].get([0m
[30;1m49 | [0m[35m        "password"[0m
[30;1m50 | [0m[35m    )[0m
[30;1m51 | [0m[35m    primary_settings["properties"] = top_settings["integrations.ad"][index].get([0m
[30;1m52 | [0m[35m        "properties"[0m
[30;1m53 | [0m[35m    )[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m    primary_settings["system_user"] = top_settings["integrations.ad"][index].get([0m
[30;1m46 | [0m[35m        "system_user"[0m
[30;1m47 | [0m[35m    )[0m
[30;1m48 | [0m[35m    primary_settings["password"] = top_settings["integrations.ad"][index].get([0m
[30;1m49 | [0m[35m        "password"[0m
[30;1m50 | [0m[35m    )[0m
[30;1m51 | [0m[35m    primary_settings["properties"] = top_settings["integrations.ad"][index].get([0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m    primary_settings["cpr_field"] = top_settings["integrations.ad"][index].get([0m
[30;1m43 | [0m[35m        "cpr_field"[0m
[30;1m44 | [0m[35m    )[0m
[30;1m45 | [0m[35m    primary_settings["system_user"] = top_settings["integrations.ad"][index].get([0m
[30;1m46 | [0m[35m        "system_user"[0m
[30;1m47 | [0m[35m    )[0m
[30;1m48 | [0m[35m    primary_settings["password"] = top_settings["integrations.ad"][index].get([0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m    primary_settings["search_base"] = top_settings["integrations.ad"][index].get([0m
[30;1m40 | [0m[35m        "search_base"[0m
[30;1m41 | [0m[35m    )[0m
[30;1m42 | [0m[35m    primary_settings["cpr_field"] = top_settings["integrations.ad"][index].get([0m
[30;1m43 | [0m[35m        "cpr_field"[0m
[30;1m44 | [0m[35m    )[0m
[30;1m45 | [0m[35m    primary_settings["system_user"] = top_settings["integrations.ad"][index].get([0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        raise Exception("ad index %d not found" % index)[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    # settings that must be in place[0m
[30;1m39 | [0m[35m    primary_settings["search_base"] = top_settings["integrations.ad"][index].get([0m
[30;1m40 | [0m[35m        "search_base"[0m
[30;1m41 | [0m[35m    )[0m
[30;1m42 | [0m[35m    primary_settings["cpr_field"] = top_settings["integrations.ad"][index].get([0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35mdef _read_primary_ad_settings(top_settings, index=0):[0m
[30;1m30 | [0m[35m    primary_settings = {}[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    if top_settings.get("integrations.ad") is None:[0m
[30;1m33 | [0m[35m        raise Exception("integration.ad settings not found")[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    if len(top_settings["integrations.ad"]) < (index + 1):[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m    global_settings["servers"] = top_settings.get("integrations.ad")[0].get([0m
[30;1m17 | [0m[35m        "servers", [][0m
[30;1m18 | [0m[35m    )[0m
[30;1m19 | [0m[35m    global_settings["winrm_host"] = top_settings.get("integrations.ad.winrm_host")[0m
[30;1m20 | [0m[35m    global_settings["system_user"] = top_settings["integrations.ad"][0]["system_user"][0m
[30;1m21 | [0m[35m    global_settings["password"] = top_settings["integrations.ad"][0]["password"][0m
[30;1m22 | [0m[35m    if not global_settings["winrm_host"]:[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35mdef _read_global_settings(top_settings):[0m
[30;1m14 | [0m[35m    global_settings = {}[0m
[30;1m15 | [0m[35m    global_settings["mora.base"] = top_settings.get("mora.base")[0m
[30;1m16 | [0m[35m    global_settings["servers"] = top_settings.get("integrations.ad")[0].get([0m
[30;1m17 | [0m[35m        "servers", [][0m
[30;1m18 | [0m[35m    )[0m
[30;1m19 | [0m[35m    global_settings["winrm_host"] = top_settings.get("integrations.ad.winrm_host")[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35mdef _read_global_settings(top_settings):[0m
[30;1m14 | [0m[35m    global_settings = {}[0m
[30;1m15 | [0m[35m    global_settings["mora.base"] = top_settings.get("mora.base")[0m
[30;1m16 | [0m[35m    global_settings["servers"] = top_settings.get("integrations.ad")[0].get([0m
[30;1m17 | [0m[35m        "servers", [][0m
[30;1m18 | [0m[35m    )[0m
[30;1m19 | [0m[35m    global_settings["winrm_host"] = top_settings.get("integrations.ad.winrm_host")[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mdef _read_global_settings(top_settings):[0m
[30;1m14 | [0m[35m    global_settings = {}[0m
[30;1m15 | [0m[35m    global_settings["mora.base"] = top_settings.get("mora.base")[0m
[30;1m16 | [0m[35m    global_settings["servers"] = top_settings.get("integrations.ad")[0].get([0m
[30;1m17 | [0m[35m        "servers", [][0m
[30;1m18 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/read_ad_conf_settings.py[0m
   Pattern: [32m.hostname[0m
[30;1m20 | [0m[35m    global_settings["system_user"] = top_settings["integrations.ad"][0]["system_user"][0m
[30;1m21 | [0m[35m    global_settings["password"] = top_settings["integrations.ad"][0]["password"][0m
[30;1m22 | [0m[35m    if not global_settings["winrm_host"]:[0m
[30;1m23 | [0m[35m        msg = "Missing hostname for remote management server"[0m
[30;1m24 | [0m[35m        logger.error(msg)[0m
[30;1m25 | [0m[35m        raise Exception(msg)[0m
[30;1m26 | [0m[35m    return global_settings[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m        logger.debug([0m
[30;1m169 | [0m[35m            "Returned info for {}: {}".format(dict_key, self.results.get(dict_key, {}))[0m
[30;1m170 | [0m[35m        )[0m
[30;1m171 | [0m[35m        return self.results.get(dict_key, {})[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m    def get_all_samaccountname_values(self):[0m
[30;1m174 | [0m[35m        """Retrieve *all* AD usernames (= "SamAccountName" values) including usernames[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m        self.uncached_read_user(user=user, cpr=cpr)[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m        logger.debug([0m
[30;1m169 | [0m[35m            "Returned info for {}: {}".format(dict_key, self.results.get(dict_key, {}))[0m
[30;1m170 | [0m[35m        )[0m
[30;1m171 | [0m[35m        return self.results.get(dict_key, {})[0m
[30;1m172 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m        t = time.time()[0m
[30;1m125 | [0m[35m        return_value = [][0m
[30;1m126 | [0m[35m        date_range = list(range(1, 32))[0m
[30;1m127 | [0m[35m        if pseudo_cprs := self.all_settings["primary"].get("pseudo_cprs"):[0m
[30;1m128 | [0m[35m            date_range.extend(pseudo_cprs)[0m
[30;1m129 | [0m[35m        if print_progress:[0m
[30;1m130 | [0m[35m            date_range = tqdm(date_range, desc="Fetching AD accounts")[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m                    self.results[current_user_samaccountname] = current_user[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m                    # Remove CPR separator if found[0m
[30;1m100 | [0m[35m                    cpr = current_user.get(cpr_field, "")[0m
[30;1m101 | [0m[35m                    if cpr is not None:[0m
[30;1m102 | [0m[35m                        cpr = cpr.replace(cpr_separator, "")[0m
[30;1m103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m        cpr_field = settings["cpr_field"][0m
[30;1m76 | [0m[35m        cpr_separator = settings.get("cpr_separator", "")[0m
[30;1m77 | [0m[35m        caseless_samname = settings.get("caseless_samname", False)[0m
[30;1m78 | [0m[35m        sam_filter = settings.get("sam_filter", "")[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        logger.debug(f"Uncached AD read, user {user}")[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        settings = self._get_setting()[0m
[30;1m75 | [0m[35m        cpr_field = settings["cpr_field"][0m
[30;1m76 | [0m[35m        cpr_separator = settings.get("cpr_separator", "")[0m
[30;1m77 | [0m[35m        caseless_samname = settings.get("caseless_samname", False)[0m
[30;1m78 | [0m[35m        sam_filter = settings.get("sam_filter", "")[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        logger.debug(f"Uncached AD read, user {user}")[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m        # reading from AD.[0m
[30;1m74 | [0m[35m        settings = self._get_setting()[0m
[30;1m75 | [0m[35m        cpr_field = settings["cpr_field"][0m
[30;1m76 | [0m[35m        cpr_separator = settings.get("cpr_separator", "")[0m
[30;1m77 | [0m[35m        caseless_samname = settings.get("caseless_samname", False)[0m
[30;1m78 | [0m[35m        sam_filter = settings.get("sam_filter", "")[0m
[30;1m79 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    for value in settings.get("discriminator.values", []):[0m
[30;1m30 | [0m[35m        for user in users:[0m
[30;1m31 | [0m[35m            value_found = value == user.get(discrim_field)[0m
[30;1m32 | [0m[35m            if settings["discriminator.function"] == "include" and value_found:[0m
[30;1m33 | [0m[35m                return user[0m
[30;1m34 | [0m[35m            if settings["discriminator.function"] == "exclude" and not value_found:[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    if settings["discriminator.function"] == "include":[0m
[30;1m27 | [0m[35m        users = list(filter(lambda user: discrim_field in user, users))[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    for value in settings.get("discriminator.values", []):[0m
[30;1m30 | [0m[35m        for user in users:[0m
[30;1m31 | [0m[35m            value_found = value == user.get(discrim_field)[0m
[30;1m32 | [0m[35m            if settings["discriminator.function"] == "include" and value_found:[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m    include: given a list of users, return the first one that is included[0m
[30;1m19 | [0m[35m    exclude: given a list of users, return the first one that is not excluded[0m
[30;1m20 | [0m[35m    """[0m
[30;1m21 | [0m[35m    discrim_field = settings.get("discriminator.field")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    if not discrim_field:[0m
[30;1m24 | [0m[35m        return next(iter(users), {})[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m185 | [0m[35m        or MO user UUID.[0m
[30;1m186 | [0m[35m        """[0m
[30;1m187 | [0m[35m        server = self.all_settings["global"]["servers"][0][0m
[30;1m188 | [0m[35m        cmd = f"""{self._build_user_credential()}[0m
[30;1m189 | [0m[35m        Get-ADUser -Credential $usercredential -Filter '*' -Server {server} -Properties EmailAddress[0m
[30;1m190 | [0m[35m        all_users = self._run_ps_script(cmd)[0m
[30;1m191 | [0m[35m        return set(map(itemgetter("EmailAddress"), all_users))[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m175 | [0m[35m        of AD users without a CPR or MO user UUID.[0m
[30;1m176 | [0m[35m        """[0m
[30;1m177 | [0m[35m        server = self.all_settings["global"]["servers"][0][0m
[30;1m178 | [0m[35m        cmd = f"""{self._build_user_credential()}[0m
[30;1m179 | [0m[35m        Get-ADUser -Credential $usercredential -Filter '*' -Server {server} -Properties SamAccountNa[0m
[30;1m180 | [0m[35m        all_users = self._run_ps_script(cmd)[0m
[30;1m181 | [0m[35m        return set(map(itemgetter("SamAccountName"), all_users))[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m    # IndlÃ¦sning fra Opus og SD:[0m
[30;1m60 | [0m[35m    # -> Her lÃ¦ser vi fra 0'eren - vi skal have fat i object-guid[0m
[30;1m61 | [0m[35m    # cpr-uid-map-til rollekatalog skal ogsÃ¥ kun lÃ¦se fra 0 (for now....)[0m
[30;1m62 | [0m[35m    # vi kan teste en del med den, altsÃ¥:[0m
[30;1m63 | [0m[35m    # -> venv/bin/python exporters/cpr_uuid.py --use-ad[0m
[30;1m64 | [0m[35m    #[0m
[30;1m65 | [0m[35m    # cpr_mo_ad_map.csv har kun uuider/brugernavne pÇ» de linier, hvor den[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m    # -> mo_to_ad_sync: skriv kun til det fÃ¸rste (og lÃ¦s kun fra det fÃ¸rste)[0m
[30;1m58 | [0m[35m    #[0m
[30;1m59 | [0m[35m    # IndlÃ¦sning fra Opus og SD:[0m
[30;1m60 | [0m[35m    # -> Her lÃ¦ser vi fra 0'eren - vi skal have fat i object-guid[0m
[30;1m61 | [0m[35m    # cpr-uid-map-til rollekatalog skal ogsÃ¥ kun lÃ¦se fra 0 (for now....)[0m
[30;1m62 | [0m[35m    # vi kan teste en del med den, altsÃ¥:[0m
[30;1m63 | [0m[35m    # -> venv/bin/python exporters/cpr_uuid.py --use-ad[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m    # -> mo_to_ad_sync: skriv kun til det fÃ¸rste (og lÃ¦s kun fra det fÃ¸rste)[0m
[30;1m58 | [0m[35m    #[0m
[30;1m59 | [0m[35m    # IndlÃ¦sning fra Opus og SD:[0m
[30;1m60 | [0m[35m    # -> Her lÃ¦ser vi fra 0'eren - vi skal have fat i object-guid[0m
[30;1m61 | [0m[35m    # cpr-uid-map-til rollekatalog skal ogsÃ¥ kun lÃ¦se fra 0 (for now....)[0m
[30;1m62 | [0m[35m    # vi kan teste en del med den, altsÃ¥:[0m
[30;1m63 | [0m[35m    # -> venv/bin/python exporters/cpr_uuid.py --use-ad[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m    # HvornÃ¥r skal vi lÃ¦se og skrive i hvad?[0m
[30;1m52 | [0m[35m    #[0m
[30;1m53 | [0m[35m    # Opdatering af OS2mo fra AD:[0m
[30;1m54 | [0m[35m    # -> ad_sync: vi lÃ¦ser alle (for i in...) Ny reader og opdater mo[0m
[30;1m55 | [0m[35m    #[0m
[30;1m56 | [0m[35m    # Opdatering af AD fra OS2mo:[0m
[30;1m57 | [0m[35m    # -> mo_to_ad_sync: skriv kun til det fÃ¸rste (og lÃ¦s kun fra det fÃ¸rste)[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m    def read_it_all(self, print_progress=False):[0m
[30;1m49 | [0m[35m        return self.cache_all(print_progress=print_progress)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # HvornÃ¥r skal vi lÃ¦se og skrive i hvad?[0m
[30;1m52 | [0m[35m    #[0m
[30;1m53 | [0m[35m    # Opdatering af OS2mo fra AD:[0m
[30;1m54 | [0m[35m    # -> ad_sync: vi lÃ¦ser alle (for i in...) Ny reader og opdater mo[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_reader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport random[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom operator import itemgetter[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom fastramqpi.ra_utils.tqdm_wrapper import tqdm[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_reimport_one.py[0m
   Pattern: [32m.hostname[0m
[30;1m48 | [0m[35m    Optionally deletes the object and all related orgfuncs directly from Lora.[0m
[30;1m49 | [0m[35m    Defaults to reading latest file only, but supports reading full history[0m
[30;1m50 | [0m[35m    """[0m
[30;1m51 | [0m[35m    helper = MoraHelper(hostname=mora_base)[0m
[30;1m52 | [0m[35m    object_type, obj = find_type(opus_id, full_history)[0m
[30;1m53 | [0m[35m    if object_type == "bruger":[0m
[30;1m54 | [0m[35m        cpr = opus_helpers.read_cpr(obj)[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m                    filter([0m
[30;1m88 | [0m[35m                        lambda ad_user: ([0m
[30;1m89 | [0m[35m                            ad_user.get(AD_SAM_ACCOUNT_NAME)[0m
[30;1m90 | [0m[35m                            or ad_user.get(AD_CPR_FIELD_NAME)[0m
[30;1m91 | [0m[35m                        ),[0m
[30;1m92 | [0m[35m                        response,[0m
[30;1m93 | [0m[35m                    ),[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m                unique_everseen([0m
[30;1m87 | [0m[35m                    filter([0m
[30;1m88 | [0m[35m                        lambda ad_user: ([0m
[30;1m89 | [0m[35m                            ad_user.get(AD_SAM_ACCOUNT_NAME)[0m
[30;1m90 | [0m[35m                            or ad_user.get(AD_CPR_FIELD_NAME)[0m
[30;1m91 | [0m[35m                        ),[0m
[30;1m92 | [0m[35m                        response,[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m    value = settings.get(setting)[0m
[30;1m76 | [0m[35m    if value is None and fallback_setting:[0m
[30;1m77 | [0m[35m        logger.warning(f"Utilizing {fallback_setting} in place of {setting}!")[0m
[30;1m78 | [0m[35m        value = settings.get(fallback_setting)[0m
[30;1m79 | [0m[35m    return value[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m    setting = convert_key_to_setting(key, database_function)[0m
[30;1m73 | [0m[35m    fallback_setting = convert_key_to_fallback(key, database_function)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    value = settings.get(setting)[0m
[30;1m76 | [0m[35m    if value is None and fallback_setting:[0m
[30;1m77 | [0m[35m        logger.warning(f"Utilizing {fallback_setting} in place of {setting}!")[0m
[30;1m78 | [0m[35m        value = settings.get(fallback_setting)[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m    key: str, database_function: DatabaseFunction[0m
[30;1m62 | [0m[35m) -> Optional[str]:[0m
[30;1m63 | [0m[35m    """Convert a connection key to a fallback setting in settings.json."""[0m
[30;1m64 | [0m[35m    return FALLBACK_MAP.get(database_function, {}).get(key)[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mdef load_setting([0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m    key: str, database_function: DatabaseFunction[0m
[30;1m62 | [0m[35m) -> Optional[str]:[0m
[30;1m63 | [0m[35m    """Convert a connection key to a fallback setting in settings.json."""[0m
[30;1m64 | [0m[35m    return FALLBACK_MAP.get(database_function, {}).get(key)[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mdef load_setting([0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m            lazy_employee["primary_engagement"] = LazyEval([0m
[30;1m288 | [0m[35m                lambda key, dictionary: next([0m
[30;1m289 | [0m[35m                    filter([0m
[30;1m290 | [0m[35m                        lambda engagement: engagement.get("primary_boolean", False),[0m
[30;1m291 | [0m[35m                        dictionary["engagements"],[0m
[30;1m292 | [0m[35m                    ),[0m
[30;1m293 | [0m[35m                    None,[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m            create_filters, tuple_keys=("employee", "ad_object")[0m
[30;1m87 | [0m[35m        )[0m
[30;1m88 | [0m[35m        setting_name = f"integrations.ad.lifecycle.{source}"[0m
[30;1m89 | [0m[35m        filter_templates = self._settings.get(setting_name, [])[0m
[30;1m90 | [0m[35m        return [[0m
[30;1m91 | [0m[35m            # Decorate each `filter_func` so it will log skipped users under[0m
[30;1m92 | [0m[35m            # a name such as "create_filters_num_0", etc.[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m531 | [0m[35m        stats = sync.create_ad_accounts(dry_run)[0m
[30;1m532 | [0m[35m        logger.info("Stats: {}".format(stats))[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m    # Trigger writing back from AD to MO to update it-accounts[0m
[30;1m535 | [0m[35m    ad_mo_sync = AdMoSync()[0m
[30;1m536 | [0m[35m    ad_mo_sync.lc = None[0m
[30;1m537 | [0m[35m    for user_uuid in tqdm([0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m450 | [0m[35m    commands = sync.ad_writer._preview_create_command([0m
[30;1m451 | [0m[35m        mo_uuid, ad_dump=None, create_manager=False[0m
[30;1m452 | [0m[35m    )[0m
[30;1m453 | [0m[35m    for cmd in commands:[0m
[30;1m454 | [0m[35m        click.echo_via_pager(cmd)[0m
[30;1m455 | [0m[35m    return commands[0m
[30;1m456 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m403 | [0m[35m            [[0m
[30;1m404 | [0m[35m                # Remove users that already exist in AD[0m
[30;1m405 | [0m[35m                filter_user_already_in_ad,[0m
[30;1m406 | [0m[35m                # Remove users that have no active engagements at all[0m
[30;1m407 | [0m[35m                filter_user_without_engagements,[0m
[30;1m408 | [0m[35m                # Check if the user is in a create-user sub-tree[0m
[30;1m409 | [0m[35m                self._get_filter_users_outside_unit_tree(),[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m189 | [0m[35m            )[0m
[30;1m190 | [0m[35m            return False[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m        # Walk up the organisation unit tree, starting at `unit["parent"]`.[0m
[30;1m193 | [0m[35m        # Stop when we find an allowed root node, or if we encounter a node[0m
[30;1m194 | [0m[35m        # without a parent (must be root?)[0m
[30;1m195 | [0m[35m        looking = True[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m                unit = self.lc.units[unit["parent"]][0][0m
[30;1m204 | [0m[35m            else:[0m
[30;1m205 | [0m[35m                logger.warning([0m
[30;1m206 | [0m[35m                    "cannot find parent unit %r (user=%r)", unit["parent"], user["uuid"][0m
[30;1m207 | [0m[35m                )[0m
[30;1m208 | [0m[35m                looking = False[0m
[30;1m209 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m            return False[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m        # Walk up the organisation unit tree, starting at `unit["parent"]`.[0m
[30;1m193 | [0m[35m        # Stop when we find an allowed root node, or if we encounter a node[0m
[30;1m194 | [0m[35m        # without a parent (must be root?)[0m
[30;1m195 | [0m[35m        looking = True[0m
[30;1m196 | [0m[35m        while looking:[0m
[30;1m197 | [0m[35m            if unit["uuid"] in self.roots:[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m            return False[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m        # Walk up the organisation unit tree, starting at `unit["parent"]`.[0m
[30;1m193 | [0m[35m        # Stop when we find an allowed root node, or if we encounter a node[0m
[30;1m194 | [0m[35m        # without a parent (must be root?)[0m
[30;1m195 | [0m[35m        looking = True[0m
[30;1m196 | [0m[35m        while looking:[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m            unit = self.lc.units[eng_org_unit_uuid][0][0m
[30;1m186 | [0m[35m        except KeyError:[0m
[30;1m187 | [0m[35m            logger.warning([0m
[30;1m188 | [0m[35m                "cannot find unit %r (user=%r)", eng_org_unit_uuid, user["uuid"][0m
[30;1m189 | [0m[35m            )[0m
[30;1m190 | [0m[35m            return False[0m
[30;1m191 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m179 | [0m[35m            )[0m
[30;1m180 | [0m[35m            return False[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m        logger.debug("Primary found, now find org unit location")[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        try:[0m
[30;1m185 | [0m[35m            unit = self.lc.units[eng_org_unit_uuid][0][0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_life_cycle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m            ) = self.ad_writer.datasource.find_primary_engagement(user["uuid"])[0m
[30;1m176 | [0m[35m        except (NoActiveEngagementsException, NoPrimaryEngagementException):[0m
[30;1m177 | [0m[35m            logger.warning([0m
[30;1m178 | [0m[35m                "Warning: Unable to find primary for {}!".format(user["uuid"])[0m
[30;1m179 | [0m[35m            )[0m
[30;1m180 | [0m[35m            return False[0m
[30;1m181 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/clear_and_import_opus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m) -> None:[0m
[30;1m55 | [0m[35m    """Import one or all files from opus even if no previous files have been imported"""[0m
[30;1m56 | [0m[35m    settings = load_settings()[0m
[30;1m57 | [0m[35m    filter_ids = settings.get("integrations.opus.units.filter_ids", [])[0m
[30;1m58 | [0m[35m    dumps = opus_helpers.read_available_dumps()[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    all_dates = dumps.keys()[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/clear_and_import_opus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m) -> None:[0m
[30;1m29 | [0m[35m    """Remove all opus-units from MO"""[0m
[30;1m30 | [0m[35m    settings = settings or load_settings()[0m
[30;1m31 | [0m[35m    mox_base = settings.get("mox.base")[0m
[30;1m32 | [0m[35m    if opus_uuid:[0m
[30;1m33 | [0m[35m        session = requests.session()[0m
[30;1m34 | [0m[35m        dub = find_duplicates_classes(session=session, mox_base=mox_base)[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/clear_and_import_opus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mdef truncate_db(MOX_BASE: str = "http://localhost:5000/lora") -> None:[0m
[30;1m20 | [0m[35m    r = requests.get(MOX_BASE + "/db/truncate")[0m
[30;1m21 | [0m[35m    r.raise_for_status()[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m    if args.get("cleanup_removed_users"):[0m
[30;1m275 | [0m[35m        ad_import.cleanup_removed_users_from_mo()[0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35m    if args.get("full_sync"):[0m
[30;1m278 | [0m[35m        ad_import.create_or_update_users_in_mo()[0m
[30;1m279 | [0m[35m        ad_import.cleanup_removed_users_from_mo()[0m
[30;1m280 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m271 | [0m[35m    if args.get("create_or_update"):[0m
[30;1m272 | [0m[35m        ad_import.create_or_update_users_in_mo()[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    if args.get("cleanup_removed_users"):[0m
[30;1m275 | [0m[35m        ad_import.cleanup_removed_users_from_mo()[0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35m    if args.get("full_sync"):[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m268 | [0m[35m    if "crontab.SENTRY_DSN" in ad_import.settings:[0m
[30;1m269 | [0m[35m        sentry_sdk.init(dsn=ad_import.settings["crontab.SENTRY_DSN"])[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m    if args.get("create_or_update"):[0m
[30;1m272 | [0m[35m        ad_import.create_or_update_users_in_mo()[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    if args.get("cleanup_removed_users"):[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m                current_engagements = self.helper.read_user_engagement(user=mo_uuid)[0m
[30;1m247 | [0m[35m                this_engagement = list([0m
[30;1m248 | [0m[35m                    filter([0m
[30;1m249 | [0m[35m                        lambda x: x.get("org_unit").get("uuid") == uuids["unit_uuid"],[0m
[30;1m250 | [0m[35m                        current_engagements,[0m
[30;1m251 | [0m[35m                    )[0m
[30;1m252 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m                current_engagements = self.helper.read_user_engagement(user=mo_uuid)[0m
[30;1m247 | [0m[35m                this_engagement = list([0m
[30;1m248 | [0m[35m                    filter([0m
[30;1m249 | [0m[35m                        lambda x: x.get("org_unit").get("uuid") == uuids["unit_uuid"],[0m
[30;1m250 | [0m[35m                        current_engagements,[0m
[30;1m251 | [0m[35m                    )[0m
[30;1m252 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m                logger.info("Existing MO info: {}".format(mo_user))[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m                if mo_user:[0m
[30;1m235 | [0m[35m                    mo_uuid = mo_user.get("uuid")[0m
[30;1m236 | [0m[35m                else:[0m
[30;1m237 | [0m[35m                    mo_uuid = self._create_user(ad_user, cpr_field)[0m
[30;1m238 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m        :param ad_user: The ad_object to use as template for MO.[0m
[30;1m121 | [0m[35m        :return: uuid of the the user.[0m
[30;1m122 | [0m[35m        """[0m
[30;1m123 | [0m[35m        cpr_raw = ad_user.get(cpr_field)[0m
[30;1m124 | [0m[35m        if cpr_raw is None:[0m
[30;1m125 | [0m[35m            return None[0m
[30;1m126 | [0m[35m        cpr = cpr_raw.replace("-", "")[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m        search_string = self.settings["integrations.ad.import_ou.search_string"][0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        def filter_users(user: Dict) -> bool:[0m
[30;1m103 | [0m[35m            name = user.get("DistinguishedName")[0m
[30;1m104 | [0m[35m            if name:[0m
[30;1m105 | [0m[35m                if search_string in name:[0m
[30;1m106 | [0m[35m                    return True[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m.hostname[0m
[30;1m45 | [0m[35m        return load_settings()[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    def _get_mora_helper(self) -> MoraHelper:[0m
[30;1m48 | [0m[35m        return MoraHelper(hostname=self.settings["mora.base"], use_cache=False)[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    def _get_ad_it_system(self) -> UUID:[0m
[30;1m51 | [0m[35m        it_systems = self.helper.read_it_systems()[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m207 | [0m[35m    def create_or_update_users_in_mo(self) -> None:[0m
[30;1m208 | [0m[35m        """[0m
[30;1m209 | [0m[35m        Create users in MO that exist in AD but not in MO.[0m
[30;1m210 | [0m[35m        Update name of users that has changed name in AD.[0m
[30;1m211 | [0m[35m        """[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m        uuids = self._find_or_create_unit_and_classes()[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m115 | [0m[35m        self, ad_user: Dict, cpr_field: str, uuid: Optional[str] = None[0m
[30;1m116 | [0m[35m    ) -> Optional[UUID]:[0m
[30;1m117 | [0m[35m        """[0m
[30;1m118 | [0m[35m        Create or update a user in MO using an AD user as a template.[0m
[30;1m119 | [0m[35m        The user will share uuid between MO and AD.[0m
[30;1m120 | [0m[35m        :param ad_user: The ad_object to use as template for MO.[0m
[30;1m121 | [0m[35m        :return: uuid of the the user.[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    def _find_ou_users_in_ad(self) -> Dict[UUID, List]:[0m
[30;1m97 | [0m[35m        """[0m
[30;1m98 | [0m[35m        find users from AD that match a search string in DistinguishedName.[0m
[30;1m99 | [0m[35m        """[0m
[30;1m100 | [0m[35m        search_string = self.settings["integrations.ad.import_ou.search_string"][0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/import_ad_group_into_mo.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    def _find_or_create_unit_and_classes(self):[0m
[30;1m68 | [0m[35m        """[0m
[30;1m69 | [0m[35m        Find uuids of the needed unit and classes for the import. If any unit or[0m
[30;1m70 | [0m[35m        class is missing from MO, it will be created.The function returns a dict[0m
[30;1m71 | [0m[35m        containg uuids needed to create users and engagements.[0m
[30;1m72 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_read_ad_conf_settings.py[0m
   Pattern: [32m.hostname[0m
[30;1m52 | [0m[35m    del settings["integrations.ad.winrm_host"][0m
[30;1m53 | [0m[35m    with pytest.raises(Exception) as excinfo:[0m
[30;1m54 | [0m[35m        read_settings(settings)[0m
[30;1m55 | [0m[35m    assert "Missing hostname for remote management server" in str(excinfo.value)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m@given(st.text(), st.text() | st.none())[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/test_connectivity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35mdef cli(**args):[0m
[30;1m223 | [0m[35m    if args.get("test_read_settings"):[0m
[30;1m224 | [0m[35m        perform_read_test()[0m
[30;1m225 | [0m[35m    if args.get("test_write_settings"):[0m
[30;1m226 | [0m[35m        perform_read_test()[0m
[30;1m227 | [0m[35m        perform_write_test()[0m
[30;1m228 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/test_connectivity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m@optgroup.option("--test-read-settings", is_flag=True)[0m
[30;1m221 | [0m[35m@optgroup.option("--test-write-settings", is_flag=True)[0m
[30;1m222 | [0m[35mdef cli(**args):[0m
[30;1m223 | [0m[35m    if args.get("test_read_settings"):[0m
[30;1m224 | [0m[35m        perform_read_test()[0m
[30;1m225 | [0m[35m    if args.get("test_write_settings"):[0m
[30;1m226 | [0m[35m        perform_read_test()[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/test_connectivity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m        raise Exception("integrations.ad skal indeholde mindst 1 AD (settings)")[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    winrm_host_setting = "integrations.ad.winrm_host"[0m
[30;1m213 | [0m[35m    winrm_host_value = settings.get(winrm_host_setting)[0m
[30;1m214 | [0m[35m    if winrm_host_value is None:[0m
[30;1m215 | [0m[35m        raise Exception("%r is missing" % winrm_host_setting)[0m
[30;1m216 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/test_connectivity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m    if not isinstance(settings.get("integrations.ad"), list):[0m
[30;1m207 | [0m[35m        raise Exception("integrations.ad skal angives som en liste af dicts (settings)")[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    if len(settings.get("integrations.ad")) < 1:[0m
[30;1m210 | [0m[35m        raise Exception("integrations.ad skal indeholde mindst 1 AD (settings)")[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    winrm_host_setting = "integrations.ad.winrm_host"[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/test_connectivity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35mdef check_settings(settings):[0m
[30;1m206 | [0m[35m    if not isinstance(settings.get("integrations.ad"), list):[0m
[30;1m207 | [0m[35m        raise Exception("integrations.ad skal angives som en liste af dicts (settings)")[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    if len(settings.get("integrations.ad")) < 1:[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/test_connectivity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m    while len(user_info_list) < 10:[0m
[30;1m174 | [0m[35m        i = i + 1[0m
[30;1m175 | [0m[35m        if i > 31:[0m
[30;1m176 | [0m[35m            msg = "Cannot find 10 users - unable to test for available fields"[0m
[30;1m177 | [0m[35m            print(msg)[0m
[30;1m178 | [0m[35m            logger.error(msg)[0m
[30;1m179 | [0m[35m            exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/test_connectivity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35m    user_info_list = [][0m
[30;1m163 | [0m[35m    i = 0[0m
[30;1m164 | [0m[35m    logger.info("Check for availability of needed fields - find some test users")[0m
[30;1m165 | [0m[35m    print("Check for availability of needed fields - find some test users")[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    minimum_expected_fields = {[0m
[30;1m168 | [0m[35m        SETTINGS["integrations.ad.write.uuid_field"]: False,[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/test_connectivity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m    user_info_list = [][0m
[30;1m163 | [0m[35m    i = 0[0m
[30;1m164 | [0m[35m    logger.info("Check for availability of needed fields - find some test users")[0m
[30;1m165 | [0m[35m    print("Check for availability of needed fields - find some test users")[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    minimum_expected_fields = {[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m            "default": {[0m
[30;1m35 | [0m[35m                "format": "%(levelname)s %(asctime)s %(name)s: %(message)s",[0m
[30;1m36 | [0m[35m                "()": PasswordRemovalFormatter,[0m
[30;1m37 | [0m[35m                "settings": kwargs.get("settings") or read_settings(),[0m
[30;1m38 | [0m[35m            },[0m
[30;1m39 | [0m[35m        },[0m
[30;1m40 | [0m[35m        "handlers": {[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def _get_passwords_from_settings(self, settings):[0m
[30;1m18 | [0m[35m        for key in ("primary", "global"):[0m
[30;1m19 | [0m[35m            password = settings.get(key, {}).get("password")[0m
[30;1m20 | [0m[35m            if password:[0m
[30;1m21 | [0m[35m                yield password[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_logger.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def _get_passwords_from_settings(self, settings):[0m
[30;1m18 | [0m[35m        for key in ("primary", "global"):[0m
[30;1m19 | [0m[35m            password = settings.get(key, {}).get("password")[0m
[30;1m20 | [0m[35m            if password:[0m
[30;1m21 | [0m[35m                yield password[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/lora_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m40 | [0m[35m    lc.calculate_primary_engagements()[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    # Todo, in principle it should be possible to run with skip_past True[0m
[30;1m43 | [0m[35m    # This is now fixed in a different branch, remember to update when[0m
[30;1m44 | [0m[35m    # merged.[0m
[30;1m45 | [0m[35m    lc_historic = get_cache(resolve_dar=True, full_history=True, skip_past=False)[0m
[30;1m46 | [0m[35m    lc_historic.populate_cache(skip_associations=True)[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_org.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        def payloads_identical(p1, p2):[0m
[30;1m237 | [0m[35m            check_keys = (p1.keys() | p2.keys()) - {"validity"}[0m
[30;1m238 | [0m[35m            return all(p1.get(k) == p2.get(k) for k in check_keys)[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m        def is_not_consecutive(p1, p2):[0m
[30;1m241 | [0m[35m            p1_to = datetime.strptime(p1["validity"]["to"], "%Y-%m-%d")[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_org.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        def payloads_identical(p1, p2):[0m
[30;1m237 | [0m[35m            check_keys = (p1.keys() | p2.keys()) - {"validity"}[0m
[30;1m238 | [0m[35m            return all(p1.get(k) == p2.get(k) for k in check_keys)[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m        def is_not_consecutive(p1, p2):[0m
[30;1m241 | [0m[35m            p1_to = datetime.strptime(p1["validity"]["to"], "%Y-%m-%d")[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_org.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m391 | [0m[35m        # OS2mo reads an object before performing an edit to it, so we need to ensure[0m
[30;1m392 | [0m[35m        # that we don't perform multiple edits to an object in parallel, which could[0m
[30;1m393 | [0m[35m        # cause one edit to be overwritten by another[0m
[30;1m394 | [0m[35m        # We create layers containing at most one edit request for each org unit UUID,[0m
[30;1m395 | [0m[35m        # and execute the layers sequentially, while allowing the importer to submit the[0m
[30;1m396 | [0m[35m        # individual requests in a layer in parallel[0m
[30;1m397 | [0m[35m        edit_payloads = map(partial(map, mo_payloads.convert_create_to_edit), tails)[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_org.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m273 | [0m[35m        # server, as this was part of the assignment, despite the fact that it would always fail. We[0m
[30;1m274 | [0m[35m        # the CSV file, which is handled with the FS fileset[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        # Write CSV file to FTP folder[0m
[30;1m277 | [0m[35m        ftp_fileset = los_files.get_fileset_implementation()[0m
[30;1m278 | [0m[35m        try:[0m
[30;1m279 | [0m[35m            result = ftp_fileset.write_file([0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_org.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m269 | [0m[35m        writer.writeheader()[0m
[30;1m270 | [0m[35m        writer.writerows(f.dict() for f in failed)[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        # AaK never actually gave us write permissions to the FTP server. However, we had to try to [0m
[30;1m273 | [0m[35m        # server, as this was part of the assignment, despite the fact that it would always fail. We[0m
[30;1m274 | [0m[35m        # the CSV file, which is handled with the FS fileset[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        # Write CSV file to FTP folder[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_org.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m269 | [0m[35m        writer.writeheader()[0m
[30;1m270 | [0m[35m        writer.writerows(f.dict() for f in failed)[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        # AaK never actually gave us write permissions to the FTP server. However, we had to try to [0m
[30;1m273 | [0m[35m        # server, as this was part of the assignment, despite the fact that it would always fail. We[0m
[30;1m274 | [0m[35m        # the CSV file, which is handled with the FS fileset[0m
[30;1m275 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_org.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m273 | [0m[35m        # server, as this was part of the assignment, despite the fact that it would always fail. We[0m
[30;1m274 | [0m[35m        # the CSV file, which is handled with the FS fileset[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        # Write CSV file to FTP folder[0m
[30;1m277 | [0m[35m        ftp_fileset = los_files.get_fileset_implementation()[0m
[30;1m278 | [0m[35m        try:[0m
[30;1m279 | [0m[35m            result = ftp_fileset.write_file([0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_org.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m269 | [0m[35m        writer.writeheader()[0m
[30;1m270 | [0m[35m        writer.writerows(f.dict() for f in failed)[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        # AaK never actually gave us write permissions to the FTP server. However, we had to try to [0m
[30;1m273 | [0m[35m        # server, as this was part of the assignment, despite the fact that it would always fail. We[0m
[30;1m274 | [0m[35m        # the CSV file, which is handled with the FS fileset[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        # Write CSV file to FTP folder[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_org.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m269 | [0m[35m        writer.writeheader()[0m
[30;1m270 | [0m[35m        writer.writerows(f.dict() for f in failed)[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        # AaK never actually gave us write permissions to the FTP server. However, we had to try to [0m
[30;1m273 | [0m[35m        # server, as this was part of the assignment, despite the fact that it would always fail. We[0m
[30;1m274 | [0m[35m        # the CSV file, which is handled with the FS fileset[0m
[30;1m275 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/mo_to_ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m        # Retrieve AD user data for manager, if available[0m
[30;1m164 | [0m[35m        ([0m
[30;1m165 | [0m[35m            reader.read_user(cpr=mo_values["manager_cpr"])[0m
[30;1m166 | [0m[35m            if mo_values.get("manager_cpr")[0m
[30;1m167 | [0m[35m            else {}[0m
[30;1m168 | [0m[35m        ),[0m
[30;1m169 | [0m[35m    ][0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/mo_to_ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m99 | [0m[35m                stats["updated"] += 1[0m
[30;1m100 | [0m[35m            else:[0m
[30;1m101 | [0m[35m                logger.info([0m
[30;1m102 | [0m[35m                    "SKIP update of AD user %r (MO user = %r)",[0m
[30;1m103 | [0m[35m                    user["SamAccountName"],[0m
[30;1m104 | [0m[35m                    mo_uuid,[0m
[30;1m105 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/mo_to_ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m            )[0m
[30;1m92 | [0m[35m            if mo_values:[0m
[30;1m93 | [0m[35m                logger.info([0m
[30;1m94 | [0m[35m                    "Would update AD user %r (MO user = %r, location = %r)",[0m
[30;1m95 | [0m[35m                    user["SamAccountName"],[0m
[30;1m96 | [0m[35m                    mo_uuid,[0m
[30;1m97 | [0m[35m                    mo_values["location"],[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/mo_to_ad_sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m            stats = update_stats(stats, response)[0m
[30;1m116 | [0m[35m        except ManagerNotUniqueFromCprException:[0m
[30;1m117 | [0m[35m            stats["unknown_manager_failure"] += 1[0m
[30;1m118 | [0m[35m            msg = "Did not find a unique manager for {}".format(user[mo_uuid_field])[0m
[30;1m119 | [0m[35m            logger.error(msg)[0m
[30;1m120 | [0m[35m        except CprNotNotUnique:[0m
[30;1m121 | [0m[35m            stats["cpr_not_unique"] += 1[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m    def set_mo_org_uuid(self):[0m
[30;1m289 | [0m[35m        mora_base = self.mora_base[0m
[30;1m290 | [0m[35m        r = self.mo_session.get("{}/service/o/".format(mora_base))[0m
[30;1m291 | [0m[35m        r.raise_for_status()[0m
[30;1m292 | [0m[35m        self.org_uuid = r.json()[0]["uuid"][0m
[30;1m293 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m        url = "/klassifikation/klasse/{}"[0m
[30;1m121 | [0m[35m        full_url = self.mox_base + url.format(uuid)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m        response = requests.get(full_url)[0m
[30;1m124 | [0m[35m        if response.status_code not in [200, 404]:[0m
[30;1m125 | [0m[35m            logger.error("Loraopslag fejlede")[0m
[30;1m126 | [0m[35m            response.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        elif len(lora_all) == 0:[0m
[30;1m87 | [0m[35m            template = payloads.lora_facet(bvn=facet_name, org=self.org_uuid)[0m
[30;1m88 | [0m[35m            logger.info("creating facet: %r", template)[0m
[30;1m89 | [0m[35m            response = requests.post([0m
[30;1m90 | [0m[35m                self.mox_base + "/klassifikation/facet", json=template[0m
[30;1m91 | [0m[35m            )[0m
[30;1m92 | [0m[35m            return response.json()["uuid"][0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m        loraurl = self.mox_base + "/klassifikation/facet" + "?bvn=" + facet_name[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m        lora_all = requests.get(loraurl).json()["results"][0][0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        if len(lora_all) == 1:[0m
[30;1m84 | [0m[35m            return lora_all[0][0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m                xml_content = content_file.read()[0m
[30;1m57 | [0m[35m        else:[0m
[30;1m58 | [0m[35m            url = "http://api.kle-online.dk/resources/kle/"[0m
[30;1m59 | [0m[35m            response = requests.get(url + navn)[0m
[30;1m60 | [0m[35m            response.encoding = "utf-8"[0m
[30;1m61 | [0m[35m            xml_content = response.text[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import.py[0m
   Pattern: [32m.hostname[0m
[30;1m33 | [0m[35m    def __init__(self, mox_base, mora_base):[0m
[30;1m34 | [0m[35m        """[0m
[30;1m35 | [0m[35m        Init function[0m
[30;1m36 | [0m[35m        :para hostname: hostname for the rest interface[0m
[30;1m37 | [0m[35m        """[0m
[30;1m38 | [0m[35m        self.mox_base = mox_base[0m
[30;1m39 | [0m[35m        self.mora_base = mora_base[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/kle/kle_import.py[0m
   Pattern: [32m.hostname[0m
[30;1m33 | [0m[35m    def __init__(self, mox_base, mora_base):[0m
[30;1m34 | [0m[35m        """[0m
[30;1m35 | [0m[35m        Init function[0m
[30;1m36 | [0m[35m        :para hostname: hostname for the rest interface[0m
[30;1m37 | [0m[35m        """[0m
[30;1m38 | [0m[35m        self.mox_base = mox_base[0m
[30;1m39 | [0m[35m        self.mora_base = mora_base[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_jinja_filters.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m44 | [0m[35m        parts = list(map(lambda s: s.translate(special), parts))[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        if len(parts) < 2:[0m
[30;1m47 | [0m[35m            raise ValueError("name must have at least two parts (name=%r)" % name)[0m
[30;1m48 | [0m[35m        elif len(parts) == 2:[0m
[30;1m49 | [0m[35m            return parts[0m
[30;1m50 | [0m[35m        elif len(parts) > 2:[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_jinja_filters.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m            return sorted(numeric_suffixes)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        def next_suffix():[0m
[30;1m92 | [0m[35m            # Find next available suffix higher than or equal to `serial_start`.[0m
[30;1m93 | [0m[35m            # E.g. if `taken_suffixes` is `{0, 1, 3, 4, 6}`, the next available suffix[0m
[30;1m94 | [0m[35m            # is 5 - and not 2, as that would be below `serial_start` (which is 3.)[0m
[30;1m95 | [0m[35m            taken = taken_suffixes()[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_jinja_filters.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    def _variant_d(parts: List[str]) -> str:[0m
[30;1m71 | [0m[35m        # Like variant A, except a serial number is appended.[0m
[30;1m72 | [0m[35m        # If variants A, B, C and possibly D are already taken, find the next available[0m
[30;1m73 | [0m[35m        # suffixed variant, e.g. "firstname.lastname.4" if "firstname.lastname.1" to[0m
[30;1m74 | [0m[35m        # "firstname.lastname..3" are already taken.[0m
[30;1m75 | [0m[35m        prefix = _variant_a(parts)[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m753 | [0m[35m[0m
[30;1m754 | [0m[35m    except fastramqpi.ra_utils.ensure_single_run.LockTaken as name_of_lock:[0m
[30;1m755 | [0m[35m        logger.warning(f"Lock {name_of_lock} taken, aborting export")[0m
[30;1m756 | [0m[35m        if "log_overlapping_aak" in settings and settings.get("log_overlapping_aak"):[0m
[30;1m757 | [0m[35m            sql_export.log_overlapping_runs_aak()[0m
[30;1m758 | [0m[35m[0m
[30;1m759 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m551 | [0m[35m            brugernavn=it_connection_info["username"],[0m
[30;1m552 | [0m[35m            startdato=it_connection_info["from_date"],[0m
[30;1m553 | [0m[35m            slutdato=it_connection_info["to_date"],[0m
[30;1m554 | [0m[35m            primÃ¦r_boolean=it_connection_info.get("primary_boolean"),[0m
[30;1m555 | [0m[35m        )[0m
[30;1m556 | [0m[35m[0m
[30;1m557 | [0m[35m    def _add_it_users(self):[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m482 | [0m[35m            stillingsbetegnelse_uuid=job_function_uuid,[0m
[30;1m483 | [0m[35m            stillingsbetegnelse_titel=job_function_class["title"],[0m
[30;1m484 | [0m[35m            primÃ¦r_boolean=association_info.get("primary_boolean"),[0m
[30;1m485 | [0m[35m            faglig_organisation=association_info.get("dynamic_class"),[0m
[30;1m486 | [0m[35m        )[0m
[30;1m487 | [0m[35m[0m
[30;1m488 | [0m[35m    def _add_associations(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m481 | [0m[35m            it_forbindelse_uuid=association_info["it_user"],[0m
[30;1m482 | [0m[35m            stillingsbetegnelse_uuid=job_function_uuid,[0m
[30;1m483 | [0m[35m            stillingsbetegnelse_titel=job_function_class["title"],[0m
[30;1m484 | [0m[35m            primÃ¦r_boolean=association_info.get("primary_boolean"),[0m
[30;1m485 | [0m[35m            faglig_organisation=association_info.get("dynamic_class"),[0m
[30;1m486 | [0m[35m        )[0m
[30;1m487 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m            engagementstype_uuid=engagement_info["engagement_type"],[0m
[30;1m369 | [0m[35m            primÃ¦r_boolean=engagement_info.get("primary_boolean"),[0m
[30;1m370 | [0m[35m            arbejdstidsfraktion=engagement_info["fraction"],[0m
[30;1m371 | [0m[35m            engagementstype_titel=self.lc.classes.get([0m
[30;1m372 | [0m[35m                engagement_type_uuid, {"title": engagement_type_uuid}[0m
[30;1m373 | [0m[35m            )["title"],[0m
[30;1m374 | [0m[35m            primÃ¦rtype_titel=primÃ¦rtype_titel,[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m366 | [0m[35m            bruger_uuid=engagement_info["user"],[0m
[30;1m367 | [0m[35m            bvn=engagement_info["user_key"],[0m
[30;1m368 | [0m[35m            engagementstype_uuid=engagement_info["engagement_type"],[0m
[30;1m369 | [0m[35m            primÃ¦r_boolean=engagement_info.get("primary_boolean"),[0m
[30;1m370 | [0m[35m            arbejdstidsfraktion=engagement_info["fraction"],[0m
[30;1m371 | [0m[35m            engagementstype_titel=self.lc.classes.get([0m
[30;1m372 | [0m[35m                engagement_type_uuid, {"title": engagement_type_uuid}[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m298 | [0m[35m    def _generate_sql_units(self, uuid, unit_info, model: Type[_T_Enhed]) -> _T_Enhed:[0m
[30;1m299 | [0m[35m        location = unit_info.get("location")[0m
[30;1m300 | [0m[35m        manager_uuid = unit_info.get("manager_uuid")[0m
[30;1m301 | [0m[35m        acting_manager_uuid = unit_info.get("acting_manager_uuid")[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m        unit_type = unit_info["unit_type"][0m
[30;1m304 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    def _generate_sql_units(self, uuid, unit_info, model: Type[_T_Enhed]) -> _T_Enhed:[0m
[30;1m299 | [0m[35m        location = unit_info.get("location")[0m
[30;1m300 | [0m[35m        manager_uuid = unit_info.get("manager_uuid")[0m
[30;1m301 | [0m[35m        acting_manager_uuid = unit_info.get("acting_manager_uuid")[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m        unit_type = unit_info["unit_type"][0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m            self.session.commit()[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    def _generate_sql_units(self, uuid, unit_info, model: Type[_T_Enhed]) -> _T_Enhed:[0m
[30;1m299 | [0m[35m        location = unit_info.get("location")[0m
[30;1m300 | [0m[35m        manager_uuid = unit_info.get("manager_uuid")[0m
[30;1m301 | [0m[35m        acting_manager_uuid = unit_info.get("acting_manager_uuid")[0m
[30;1m302 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m        return Session()[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    def _get_lora_class(self, uuid: str) -> Tuple[str, dict]:[0m
[30;1m135 | [0m[35m        cls: dict = self.lc.classes.get(uuid) or {"title": uuid}[0m
[30;1m136 | [0m[35m        return uuid, cls[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    def perform_export(self, resolve_dar=True, use_pickle=None):[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        return create_engine(db_string, **engine_settings)[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    def _get_export_cpr_setting(self) -> bool:[0m
[30;1m115 | [0m[35m        return self.settings.get("exporters.actual_state.export_cpr", True)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    def _get_lora_cache(self, resolve_dar, use_pickle) -> GQLLoraCache:[0m
[30;1m118 | [0m[35m        if self.historic:[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/sql_export.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m698 | [0m[35m    def update_sql(self, uuid: UUID, objects: list[sql_type], table: Type[sql_type]):[0m
[30;1m699 | [0m[35m        """Updates sql with the provided objects matching the objects UUID.[0m
[30;1m700 | [0m[35m[0m
[30;1m701 | [0m[35m        Given a UUID, a list of objects and a table  we find any objects currently in sql for the gi[0m
[30;1m702 | [0m[35m        Then we add the objects that are not allready in sql - either new or changed in MO -  and re[0m
[30;1m703 | [0m[35m        do not match.[0m
[30;1m704 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1370 | [0m[35m        print("{} is now set as manager for {}".format(manager, user))[0m
[30;1m1371 | [0m[35m        ad_writer.add_manager_to_user(manager_sam=manager, user_sam=user)[0m
[30;1m1372 | [0m[35m[0m
[30;1m1373 | [0m[35m    if args.get("mo_values"):[0m
[30;1m1374 | [0m[35m        mo_values = ad_writer.read_ad_information_from_mo(str(args["mo_values"]))[0m
[30;1m1375 | [0m[35m        print(json.dumps(dict(mo_values.items()), indent=4))[0m
[30;1m1376 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1365 | [0m[35m            for key, value in sorted(user[0].items()):[0m
[30;1m1366 | [0m[35m                print("{}: {}".format(key, value))[0m
[30;1m1367 | [0m[35m[0m
[30;1m1368 | [0m[35m    if args.get("add_manager_to_user"):[0m
[30;1m1369 | [0m[35m        manager, user = args["add_manager_to_user"][0m
[30;1m1370 | [0m[35m        print("{} is now set as manager for {}".format(manager, user))[0m
[30;1m1371 | [0m[35m        ad_writer.add_manager_to_user(manager_sam=manager, user_sam=user)[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1355 | [0m[35m        status = ad_writer.sync_user(args["sync_user"])[0m
[30;1m1356 | [0m[35m        print(status[1])[0m
[30;1m1357 | [0m[35m[0m
[30;1m1358 | [0m[35m    if args.get("read_ad_information"):[0m
[30;1m1359 | [0m[35m        print("AD information on user:")[0m
[30;1m1360 | [0m[35m        sam = args["read_ad_information"][0m
[30;1m1361 | [0m[35m        user = ad_writer.read_user(user=sam)[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1350 | [0m[35m        status = ad_writer.create_user(args["create_user"], create_manager=False)[0m
[30;1m1351 | [0m[35m        print(status[1])[0m
[30;1m1352 | [0m[35m[0m
[30;1m1353 | [0m[35m    if args.get("sync_user"):[0m
[30;1m1354 | [0m[35m        print("Sync MO fields to AD")[0m
[30;1m1355 | [0m[35m        status = ad_writer.sync_user(args["sync_user"])[0m
[30;1m1356 | [0m[35m        print(status[1])[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1345 | [0m[35m        # two steps.[0m
[30;1m1346 | [0m[35m        print(status[1])[0m
[30;1m1347 | [0m[35m[0m
[30;1m1348 | [0m[35m    if args.get("create_user"):[0m
[30;1m1349 | [0m[35m        print("Create user, no link to manager:")[0m
[30;1m1350 | [0m[35m        status = ad_writer.create_user(args["create_user"], create_manager=False)[0m
[30;1m1351 | [0m[35m        print(status[1])[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1336 | [0m[35m[0m
[30;1m1337 | [0m[35m    ad_writer = ADWriter(skip_occupied_names=args["ignore_occupied_names"])[0m
[30;1m1338 | [0m[35m[0m
[30;1m1339 | [0m[35m    if args.get("create_user_with_manager"):[0m
[30;1m1340 | [0m[35m        print("Create_user_with_manager:")[0m
[30;1m1341 | [0m[35m        status = ad_writer.create_user([0m
[30;1m1342 | [0m[35m            args["create_user_with_manager"], create_manager=True[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1299 | [0m[35m        )[0m
[30;1m1300 | [0m[35m        if skip_locations is None:[0m
[30;1m1301 | [0m[35m            return False  # no skip locations defined[0m
[30;1m1302 | [0m[35m        if unit_info.get("location"):[0m
[30;1m1303 | [0m[35m            skip_locations_lower = set(s.lower() for s in skip_locations)[0m
[30;1m1304 | [0m[35m            location = unit_info["location"][0m
[30;1m1305 | [0m[35m            parts = location.split("\\")[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1294 | [0m[35m            return True, "enabled AD user" if enable else "disabled AD user"[0m
[30;1m1295 | [0m[35m[0m
[30;1m1296 | [0m[35m    def _skip_unit(self, unit_info):[0m
[30;1m1297 | [0m[35m        skip_locations = self.all_settings.get("primary_write", {}).get([0m
[30;1m1298 | [0m[35m            "skip_locations"[0m
[30;1m1299 | [0m[35m        )[0m
[30;1m1300 | [0m[35m        if skip_locations is None:[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1294 | [0m[35m            return True, "enabled AD user" if enable else "disabled AD user"[0m
[30;1m1295 | [0m[35m[0m
[30;1m1296 | [0m[35m    def _skip_unit(self, unit_info):[0m
[30;1m1297 | [0m[35m        skip_locations = self.all_settings.get("primary_write", {}).get([0m
[30;1m1298 | [0m[35m            "skip_locations"[0m
[30;1m1299 | [0m[35m        )[0m
[30;1m1300 | [0m[35m        if skip_locations is None:[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1261 | [0m[35m        if enable is False:[0m
[30;1m1262 | [0m[35m            # Read an additional field mapping which is only to be used when disabling[0m
[30;1m1263 | [0m[35m            # AD users.[0m
[30;1m1264 | [0m[35m            template_to_ad_fields_when_disable = settings["primary_write"].get([0m
[30;1m1265 | [0m[35m                "template_to_ad_fields_when_disable", {}[0m
[30;1m1266 | [0m[35m            )[0m
[30;1m1267 | [0m[35m            template_to_ad_fields.update(template_to_ad_fields_when_disable)[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1240 | [0m[35m    def _get_new_ad_user_path_argument(self):[0m
[30;1m1241 | [0m[35m        primary = self._get_setting()[0m
[30;1m1242 | [0m[35m        primary_write = self._get_write_setting()[0m
[30;1m1243 | [0m[35m        path = primary_write.get("new_ad_user_path", primary["search_base"])[0m
[30;1m1244 | [0m[35m        path_argument = f' -Path "{path}"'[0m
[30;1m1245 | [0m[35m        return path_argument[0m
[30;1m1246 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1223 | [0m[35m[0m
[30;1m1224 | [0m[35m        # Should this go to self._ps_boiler_plate()?[0m
[30;1m1225 | [0m[35m        server_string = ""[0m
[30;1m1226 | [0m[35m        if self.all_settings["global"].get("servers"):[0m
[30;1m1227 | [0m[35m            server_string = " -Server {} ".format([0m
[30;1m1228 | [0m[35m                random.choice(self.all_settings["global"]["servers"])[0m
[30;1m1229 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1153 | [0m[35m        edit_user_string = self.remove_redundant(edit_user_string)[0m
[30;1m1154 | [0m[35m[0m
[30;1m1155 | [0m[35m        server_string = ""[0m
[30;1m1156 | [0m[35m        if self.all_settings["global"].get("servers") is not None:[0m
[30;1m1157 | [0m[35m            server_string = " -Server {} ".format([0m
[30;1m1158 | [0m[35m                random.choice(self.all_settings["global"]["servers"])[0m
[30;1m1159 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1070 | [0m[35m        for ad_field, rendered_value in fields.items():[0m
[30;1m1071 | [0m[35m            mismatch.update(self._compare_fields(ad_field, rendered_value, ad_user))[0m
[30;1m1072 | [0m[35m[0m
[30;1m1073 | [0m[35m        if mo_values.get("manager_cpr"):[0m
[30;1m1074 | [0m[35m            try:[0m
[30;1m1075 | [0m[35m                manager_ad_user = self._find_ad_user([0m
[30;1m1076 | [0m[35m                    mo_values["manager_cpr"], ad_dump=ad_dump[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m    def _compare_fields(self, ad_field, value, ad_user):[0m
[30;1m915 | [0m[35m        mismatch = {}[0m
[30;1m916 | [0m[35m        ad_field_value = ad_user.get(ad_field)[0m
[30;1m917 | [0m[35m[0m
[30;1m918 | [0m[35m        # Some AD fields contain one-element lists, rather than the usual strings,[0m
[30;1m919 | [0m[35m        # numbers or UUIDs.[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m904 | [0m[35m        )[0m
[30;1m905 | [0m[35m        rename_user_string = self.remove_redundant(rename_user_string)[0m
[30;1m906 | [0m[35m        server_string = ""[0m
[30;1m907 | [0m[35m        if self.all_settings["global"].get("servers") is not None:[0m
[30;1m908 | [0m[35m            server_string = " -Server {} ".format([0m
[30;1m909 | [0m[35m                random.choice(self.all_settings["global"]["servers"])[0m
[30;1m910 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m839 | [0m[35m                    lambda _manager_mo_user: _manager_mo_user.get("name")[0m
[30;1m840 | [0m[35m                ),[0m
[30;1m841 | [0m[35m                "manager_cpr": LazyEvalDerived([0m
[30;1m842 | [0m[35m                    lambda _manager_mo_user: _manager_mo_user.get("cpr_no")[0m
[30;1m843 | [0m[35m                ),[0m
[30;1m844 | [0m[35m                "manager_mail": LazyEvalDerived([0m
[30;1m845 | [0m[35m                    lambda _manager_uuid: read_manager_mail(_manager_uuid)[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m836 | [0m[35m                    else {}[0m
[30;1m837 | [0m[35m                ),[0m
[30;1m838 | [0m[35m                "manager_name": LazyEvalDerived([0m
[30;1m839 | [0m[35m                    lambda _manager_mo_user: _manager_mo_user.get("name")[0m
[30;1m840 | [0m[35m                ),[0m
[30;1m841 | [0m[35m                "manager_cpr": LazyEvalDerived([0m
[30;1m842 | [0m[35m                    lambda _manager_mo_user: _manager_mo_user.get("cpr_no")[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m522 | [0m[35m        return self._reader.read_user(user=user, cpr=cpr)[0m
[30;1m523 | [0m[35m[0m
[30;1m524 | [0m[35m    def _use_graphql_source_if_feature_flagged(self):[0m
[30;1m525 | [0m[35m        feature_flag = self.settings.get("primary_write", {}).get("use_future_managers")[0m
[30;1m526 | [0m[35m        if feature_flag:[0m
[30;1m527 | [0m[35m            logger.info([0m
[30;1m528 | [0m[35m                "Using MOGraphqlSource to patch %r.get_manager_uuid", self.datasource[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m522 | [0m[35m        return self._reader.read_user(user=user, cpr=cpr)[0m
[30;1m523 | [0m[35m[0m
[30;1m524 | [0m[35m    def _use_graphql_source_if_feature_flagged(self):[0m
[30;1m525 | [0m[35m        feature_flag = self.settings.get("primary_write", {}).get("use_future_managers")[0m
[30;1m526 | [0m[35m        if feature_flag:[0m
[30;1m527 | [0m[35m            logger.info([0m
[30;1m528 | [0m[35m                "Using MOGraphqlSource to patch %r.get_manager_uuid", self.datasource[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m495 | [0m[35m    def __init__(self, lc=None, lc_historic=None, **kwargs):[0m
[30;1m496 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m497 | [0m[35m        self.settings = self.all_settings[0m
[30;1m498 | [0m[35m        self.skip_occupied_names = kwargs.get("skip_occupied_names", False)[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m        # Setup datasource for getting MO data.[0m
[30;1m501 | [0m[35m        # TODO: Create a factory instead of this hackery?[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m            return it_system["itsystem"]["uuid"], {[0m
[30;1m476 | [0m[35m                "uuid": it_system["uuid"],[0m
[30;1m477 | [0m[35m                "user": it_system["person"]["uuid"],[0m
[30;1m478 | [0m[35m                "unit": (it_system.get("org_unit") or {"uuid": None}).get("uuid"),[0m
[30;1m479 | [0m[35m                "username": it_system["user_key"],[0m
[30;1m480 | [0m[35m                "itsystem": it_system["itsystem"]["uuid"],[0m
[30;1m481 | [0m[35m                "from_date": it_system["validity"]["from"],[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m            return it_system["itsystem"]["uuid"], {[0m
[30;1m476 | [0m[35m                "uuid": it_system["uuid"],[0m
[30;1m477 | [0m[35m                "user": it_system["person"]["uuid"],[0m
[30;1m478 | [0m[35m                "unit": (it_system.get("org_unit") or {"uuid": None}).get("uuid"),[0m
[30;1m479 | [0m[35m                "username": it_system["user_key"],[0m
[30;1m480 | [0m[35m                "itsystem": it_system["itsystem"]["uuid"],[0m
[30;1m481 | [0m[35m                "from_date": it_system["validity"]["from"],[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m    def get_manager_uuid(self, mo_user: dict, eng_uuid) -> str | None:[0m
[30;1m394 | [0m[35m        """Look up manager UUID for employee"""[0m
[30;1m395 | [0m[35m        manager_uuid = self._manager_map.get(mo_user["uuid"])[0m
[30;1m396 | [0m[35m        if manager_uuid == mo_user["uuid"]:[0m
[30;1m397 | [0m[35m            return None[0m
[30;1m398 | [0m[35m        return manager_uuid[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m            url=f"{self._settings['global']['mora.base']}/graphql/v22",[0m
[30;1m293 | [0m[35m            client_id=os.environ.get("CLIENT_ID", "dipex"),[0m
[30;1m294 | [0m[35m            client_secret=os.environ["CLIENT_SECRET"],[0m
[30;1m295 | [0m[35m            auth_realm=os.environ.get("AUTH_REALM", "mo"),[0m
[30;1m296 | [0m[35m            auth_server=os.environ["AUTH_SERVER"],[0m
[30;1m297 | [0m[35m            sync=True,[0m
[30;1m298 | [0m[35m            httpx_client_kwargs={"timeout": None},[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m    def _get_client(self):[0m
[30;1m291 | [0m[35m        return GraphQLClient([0m
[30;1m292 | [0m[35m            url=f"{self._settings['global']['mora.base']}/graphql/v22",[0m
[30;1m293 | [0m[35m            client_id=os.environ.get("CLIENT_ID", "dipex"),[0m
[30;1m294 | [0m[35m            client_secret=os.environ["CLIENT_SECRET"],[0m
[30;1m295 | [0m[35m            auth_realm=os.environ.get("AUTH_REALM", "mo"),[0m
[30;1m296 | [0m[35m            auth_server=os.environ["AUTH_SERVER"],[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m.hostname[0m
[30;1m510 | [0m[35m        self.lc = lc[0m
[30;1m511 | [0m[35m        self.lc_historic = lc_historic[0m
[30;1m512 | [0m[35m        self.helper = MoraHelper([0m
[30;1m513 | [0m[35m            hostname=self.settings["global"]["mora.base"], use_cache=False[0m
[30;1m514 | [0m[35m        )[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m        self._use_graphql_source_if_feature_flagged()[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m.hostname[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m    def __init__(self, settings):[0m
[30;1m405 | [0m[35m        self.helper = MoraHelper([0m
[30;1m406 | [0m[35m            hostname=settings["global"]["mora.base"], use_cache=False[0m
[30;1m407 | [0m[35m        )[0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m    def read_user(self, uuid):[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1288 | [0m[35m        :param username: SamAccountName of the account to be enabled or disabled[0m
[30;1m1289 | [0m[35m        :param enable: If True enable account, if False, disable account[0m
[30;1m1290 | [0m[35m        """[0m
[30;1m1291 | [0m[35m        cmd = self._get_enable_user_cmd(username, enable)[0m
[30;1m1292 | [0m[35m        response = self._run_ps_script(cmd)  # raises `CommandFailure` if PS fails[0m
[30;1m1293 | [0m[35m        if response == {}:[0m
[30;1m1294 | [0m[35m            return True, "enabled AD user" if enable else "disabled AD user"[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1280 | [0m[35m            settings=settings,[0m
[30;1m1281 | [0m[35m        )[0m
[30;1m1282 | [0m[35m        cmd = self._build_user_credential() + self.remove_redundant(cmd)[0m
[30;1m1283 | [0m[35m        return cmd[0m
[30;1m1284 | [0m[35m[0m
[30;1m1285 | [0m[35m    def enable_user(self, username, enable=True):[0m
[30;1m1286 | [0m[35m        """[0m
[30;1m1287 | [0m[35m        Enable or disable an AD account.[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1279 | [0m[35m            },[0m
[30;1m1280 | [0m[35m            settings=settings,[0m
[30;1m1281 | [0m[35m        )[0m
[30;1m1282 | [0m[35m        cmd = self._build_user_credential() + self.remove_redundant(cmd)[0m
[30;1m1283 | [0m[35m        return cmd[0m
[30;1m1284 | [0m[35m[0m
[30;1m1285 | [0m[35m    def enable_user(self, username, enable=True):[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1268 | [0m[35m        settings["primary_write"]["template_to_ad_fields"] = template_to_ad_fields[0m
[30;1m1269 | [0m[35m[0m
[30;1m1270 | [0m[35m        # Render the PowerShell command to enable or disable an AD user[0m
[30;1m1271 | [0m[35m        cmd = template_powershell([0m
[30;1m1272 | [0m[35m            cmd="Set-ADUser",[0m
[30;1m1273 | [0m[35m            context={[0m
[30;1m1274 | [0m[35m                "user_sam": username,[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m384 | [0m[35m                if org_unit_uuid in org_unit_map:[0m
[30;1m385 | [0m[35m                    manager_uuid = org_unit_map[org_unit_uuid]["manager_uuid"][0m
[30;1m386 | [0m[35m                else:[0m
[30;1m387 | [0m[35m                    # We are at the end of the upwards traversal[0m
[30;1m388 | [0m[35m                    break[0m
[30;1m389 | [0m[35m            result[employee_uuid] = manager_uuid[0m
[30;1m390 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m208 | [0m[35m            future_engagement = next([0m
[30;1m209 | [0m[35m                filter_for_user(self.lc_historic.engagements.values()), None[0m
[30;1m210 | [0m[35m            )[0m
[30;1m211 | [0m[35m            # We do not have any engagements at all[0m
[30;1m212 | [0m[35m            if future_engagement is None:[0m
[30;1m213 | [0m[35m                raise NoActiveEngagementsException()[0m
[30;1m214 | [0m[35m            # We have future engagements, but LoraCache does not handle that.[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1076 | [0m[35m                    mo_values["manager_cpr"], ad_dump=ad_dump[0m
[30;1m1077 | [0m[35m                )[0m
[30;1m1078 | [0m[35m            except CprNotFoundInADException:[0m
[30;1m1079 | [0m[35m                logger.warning("could not find manager by cpr")[0m
[30;1m1080 | [0m[35m            else:[0m
[30;1m1081 | [0m[35m                manager_distinguished_name = manager_ad_user["DistinguishedName"][0m
[30;1m1082 | [0m[35m                if ad_user["manager"] != manager_distinguished_name:[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1007 | [0m[35m            mismatch = self._sync_compare(mo_values, ad_dump)[0m
[30;1m1008 | [0m[35m        except CprNotFoundInADException:[0m
[30;1m1009 | [0m[35m            # We might be running against an AD where we have not yet written any actual[0m
[30;1m1010 | [0m[35m            # users. In that case, we will not find the user by CPR. But we still want[0m
[30;1m1011 | [0m[35m            # to see the rename command that would be issued.[0m
[30;1m1012 | [0m[35m            logger.info("Previewing 'rename' command for nonexistent AD user")[0m
[30;1m1013 | [0m[35m            rename_cmd = self._get_rename_ad_user_command(user_sam, "<new name>")[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m967 | [0m[35m        return environment[0m
[30;1m968 | [0m[35m[0m
[30;1m969 | [0m[35m    def _render_field_template(self, context, template):[0m
[30;1m970 | [0m[35m        env = self._environment.overlay(undefined=Undefined)[0m
[30;1m971 | [0m[35m        template = env.from_string(template.strip('"'))[0m
[30;1m972 | [0m[35m        return template.render(**context)[0m
[30;1m973 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m661 | [0m[35m[0m
[30;1m662 | [0m[35m        unit_secure_email = None[0m
[30;1m663 | [0m[35m        unit_public_email = None[0m
[30;1m664 | [0m[35m        for mail in email:[0m
[30;1m665 | [0m[35m            if mail["visibility"] is None:[0m
[30;1m666 | [0m[35m                # If visibility is not set, we assume it is non-public.[0m
[30;1m667 | [0m[35m                unit_secure_email = mail["value"][0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m371 | [0m[35m                    employee_uuid = engagement["employee_uuid"][0m
[30;1m372 | [0m[35m                    engagement_map[employee_uuid] = org_unit_uuid[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m        # Step 2: visit each employee UUID in `engagement_map` and find its manager UUID[0m
[30;1m375 | [0m[35m        # either by taking it directly from `org_unit_map`, or by traversing "up" the[0m
[30;1m376 | [0m[35m        # org unit hierarchy, until the manager UUID differs from the employee UUID.[0m
[30;1m377 | [0m[35m        result = {}[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m249 | [0m[35m            # We found a manager directly[0m
[30;1m250 | [0m[35m            if manager_uuid != mo_user["uuid"]:[0m
[30;1m251 | [0m[35m                return manager_uuid[0m
[30;1m252 | [0m[35m            # Self manager, find a manager above us, if possible[0m
[30;1m253 | [0m[35m            parent_uuid = org_uuid_parent(eng_org_unit)[0m
[30;1m254 | [0m[35m            while manager_uuid == mo_user["uuid"]:[0m
[30;1m255 | [0m[35m                if parent_uuid is None:[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m245 | [0m[35m            eng_org_unit = engagement["unit"][0m
[30;1m246 | [0m[35m            manager_uuid = org_uuid_to_manager(eng_org_unit)[0m
[30;1m247 | [0m[35m            if manager_uuid is None:[0m
[30;1m248 | [0m[35m                raise Exception("Unable to find manager")[0m
[30;1m249 | [0m[35m            # We found a manager directly[0m
[30;1m250 | [0m[35m            if manager_uuid != mo_user["uuid"]:[0m
[30;1m251 | [0m[35m                return manager_uuid[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m240 | [0m[35m        try:[0m
[30;1m241 | [0m[35m            # Compatibility to mimic MORESTSource behaviour[0m
[30;1m242 | [0m[35m            # MORESTSource does an engagement lookup in the present, using[0m
[30;1m243 | [0m[35m            # the org uuid from that and fails if it doesn't find anything[0m
[30;1m244 | [0m[35m            engagement = self.lc.engagements[eng_uuid][0][0m
[30;1m245 | [0m[35m            eng_org_unit = engagement["unit"][0m
[30;1m246 | [0m[35m            manager_uuid = org_uuid_to_manager(eng_org_unit)[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m        """Find the primary engagement for the provided uuid user.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        Args:[0m
[30;1m91 | [0m[35m            uuid: UUID for the user to find primary engagement for.[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m        Returns:[0m
[30;1m94 | [0m[35m            tuple(string, string, string, string):[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mimport random[0m
[30;1m7 | [0m[35mimport re[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom abc import ABC[0m
[30;1m10 | [0m[35mfrom abc import abstractmethod[0m
[30;1m11 | [0m[35mfrom datetime import date[0m
[30;1m12 | [0m[35mfrom datetime import datetime[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m    prefix = "integrations.aarhus_los"[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def _get_setting_value(key: str, default: Optional[Any] = None):[0m
[30;1m18 | [0m[35m        return settings_json.get(f"{prefix}.{key}", default)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    return dict([0m
[30;1m21 | [0m[35m        ftp_url=_get_setting_value("ftp_url"),[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m764 | [0m[35m                else:[0m
[30;1m765 | [0m[35m                    uuid = employee["uuid"][0m
[30;1m766 | [0m[35m                    user = self.helper.read_user(uuid)[0m
[30;1m767 | [0m[35m                    cpr = user.get("cpr_no")[0m
[30;1m768 | [0m[35m                    if not cpr:[0m
[30;1m769 | [0m[35m                        logger.warning("no 'cpr_no' for MO user %r", uuid)[0m
[30;1m770 | [0m[35m                return cpr, employee[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m751 | [0m[35m            used_mo_fields = [][0m
[30;1m752 | [0m[35m[0m
[30;1m753 | [0m[35m            for key in self.mapping.keys():[0m
[30;1m754 | [0m[35m                for ad_field, mo_combi in self.mapping.get(key, {}).items():[0m
[30;1m755 | [0m[35m                    if mo_combi in used_mo_fields:[0m
[30;1m756 | [0m[35m                        msg = "MO field {} used more than once"[0m
[30;1m757 | [0m[35m                        raise Exception(msg.format(mo_combi))[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m659 | [0m[35m        # Debug log if enabled is not found[0m
[30;1m660 | [0m[35m        if "Enabled" not in ad_object:[0m
[30;1m661 | [0m[35m            logger.info("Enabled not in ad_object")[0m
[30;1m662 | [0m[35m        user_enabled = ad_object.get("Enabled", True)[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m        # If terminate_disabled is None, we decide on a per-user basis using the[0m
[30;1m665 | [0m[35m        # terminate_disabled_filters, by invariant we at least one exist.[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m653 | [0m[35m        """[0m
[30;1m654 | [0m[35m        # If `user_attrs` is set up, transfer values from mapped AD user fields[0m
[30;1m655 | [0m[35m        # to corresponding MO user attributes.[0m
[30;1m656 | [0m[35m        if self.mapping.get("user_attrs"):[0m
[30;1m657 | [0m[35m            self._edit_user_attrs(employee, ad_object)[0m
[30;1m658 | [0m[35m[0m
[30;1m659 | [0m[35m        # Debug log if enabled is not found[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m624 | [0m[35m            for ad_field_name, mo_field_name in user_attrs_mapping[0m
[30;1m625 | [0m[35m            if ([0m
[30;1m626 | [0m[35m                ad_object.get(ad_field_name) is not None[0m
[30;1m627 | [0m[35m                and ad_object[ad_field_name] != employee.get(mo_field_name)[0m
[30;1m628 | [0m[35m            )[0m
[30;1m629 | [0m[35m        }[0m
[30;1m630 | [0m[35m        if user_attrs_changed:[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m623 | [0m[35m            mo_field_name: ad_object.get(ad_field_name)[0m
[30;1m624 | [0m[35m            for ad_field_name, mo_field_name in user_attrs_mapping[0m
[30;1m625 | [0m[35m            if ([0m
[30;1m626 | [0m[35m                ad_object.get(ad_field_name) is not None[0m
[30;1m627 | [0m[35m                and ad_object[ad_field_name] != employee.get(mo_field_name)[0m
[30;1m628 | [0m[35m            )[0m
[30;1m629 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m620 | [0m[35m    def _edit_user_attrs(self, employee, ad_object):[0m
[30;1m621 | [0m[35m        user_attrs_mapping = self.mapping.get("user_attrs", {}).items()[0m
[30;1m622 | [0m[35m        user_attrs_changed = {[0m
[30;1m623 | [0m[35m            mo_field_name: ad_object.get(ad_field_name)[0m
[30;1m624 | [0m[35m            for ad_field_name, mo_field_name in user_attrs_mapping[0m
[30;1m625 | [0m[35m            if ([0m
[30;1m626 | [0m[35m                ad_object.get(ad_field_name) is not None[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m618 | [0m[35m        return response[0m
[30;1m619 | [0m[35m[0m
[30;1m620 | [0m[35m    def _edit_user_attrs(self, employee, ad_object):[0m
[30;1m621 | [0m[35m        user_attrs_mapping = self.mapping.get("user_attrs", {}).items()[0m
[30;1m622 | [0m[35m        user_attrs_changed = {[0m
[30;1m623 | [0m[35m            mo_field_name: ad_object.get(ad_field_name)[0m
[30;1m624 | [0m[35m            for ad_field_name, mo_field_name in user_attrs_mapping[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m            # Default `mo_value` to an empty string. In case the field is[0m
[30;1m424 | [0m[35m            # dropped from the AD object, this will empty its value in MO.[0m
[30;1m425 | [0m[35m            new_mo_value = ad_object.get(ad_field, None)[0m
[30;1m426 | [0m[35m            old_mo_value = mo_engagement.get(mo_field)[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m            # If we cannot read the field, maybe it is because our[0m
[30;1m429 | [0m[35m            # mo_engagement is from LoraCache, and thus is different from MO[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m        for ad_field, mo_field in self.mapping["engagements"].items():[0m
[30;1m423 | [0m[35m            # Default `mo_value` to an empty string. In case the field is[0m
[30;1m424 | [0m[35m            # dropped from the AD object, this will empty its value in MO.[0m
[30;1m425 | [0m[35m            new_mo_value = ad_object.get(ad_field, None)[0m
[30;1m426 | [0m[35m            old_mo_value = mo_engagement.get(mo_field)[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m            # If we cannot read the field, maybe it is because our[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m            to_date = ([0m
[30;1m406 | [0m[35m                engagement["to_date"][0m
[30;1m407 | [0m[35m                if self.lc[0m
[30;1m408 | [0m[35m                else engagement.get("validity", {}).get("to")[0m
[30;1m409 | [0m[35m            )[0m
[30;1m410 | [0m[35m            validity = {[0m
[30;1m411 | [0m[35m                "from": VALIDITY["from"],  # today[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m            to_date = ([0m
[30;1m406 | [0m[35m                engagement["to_date"][0m
[30;1m407 | [0m[35m                if self.lc[0m
[30;1m408 | [0m[35m                else engagement.get("validity", {}).get("to")[0m
[30;1m409 | [0m[35m            )[0m
[30;1m410 | [0m[35m            validity = {[0m
[30;1m411 | [0m[35m                "from": VALIDITY["from"],  # today[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m    def _setup_lora_cache(self):[0m
[30;1m203 | [0m[35m        # Possibly get IT-system directly from LoRa for better performance.[0m
[30;1m204 | [0m[35m        lora_speedup = self.settings.get([0m
[30;1m205 | [0m[35m            "integrations.ad.ad_mo_sync_direct_lora_speedup", False[0m
[30;1m206 | [0m[35m        )[0m
[30;1m207 | [0m[35m        if lora_speedup:[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m        _, visibility_scope = self._address_mapping[field][0m
[30;1m147 | [0m[35m        current_visibility = ([0m
[30;1m148 | [0m[35m            address["visibility"]["uuid"] if address.get("visibility") else None[0m
[30;1m149 | [0m[35m        )[0m
[30;1m150 | [0m[35m        target_visibility_class = ([0m
[30;1m151 | [0m[35m            self._visibility[visibility_scope] if visibility_scope is not None else None[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m                    continue[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m            # Field not in AD, terminate all corresponding MO addresses[0m
[30;1m118 | [0m[35m            if self._ad_object.get(field) is None:[0m
[30;1m119 | [0m[35m                for address in user_addresses:[0m
[30;1m120 | [0m[35m                    yield (self.TERMINATE, address)[0m
[30;1m121 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m            if not user_addresses:[0m
[30;1m104 | [0m[35m                # The field exists in AD, but there's no corresponding MO[0m
[30;1m105 | [0m[35m                # address.[0m
[30;1m106 | [0m[35m                if self._ad_object.get(field):[0m
[30;1m107 | [0m[35m                    # Yield a MO address creation.[0m
[30;1m108 | [0m[35m                    yield ([0m
[30;1m109 | [0m[35m                        self.CREATE,[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m.hostname[0m
[30;1m197 | [0m[35m            raise Exception("Error in visibility class configuration")[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    def _setup_mora_helper(self):[0m
[30;1m200 | [0m[35m        return MoraHelper(hostname=self.settings["mora.base"], use_cache=False)[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m    def _setup_lora_cache(self):[0m
[30;1m203 | [0m[35m        # Possibly get IT-system directly from LoRa for better performance.[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m662 | [0m[35m        user_enabled = ad_object.get("Enabled", True)[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m        # If terminate_disabled is None, we decide on a per-user basis using the[0m
[30;1m665 | [0m[35m        # terminate_disabled_filters, by invariant we at least one exist.[0m
[30;1m666 | [0m[35m        if terminate_disabled is None:[0m
[30;1m667 | [0m[35m            terminate_disabled = all([0m
[30;1m668 | [0m[35m                terminate_disabled_filter((employee["uuid"], ad_object))[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m523 | [0m[35m                self.stats["users"].add(uuid)[0m
[30;1m524 | [0m[35m            elif decision == AddressDecisionList.EDIT:[0m
[30;1m525 | [0m[35m                self._edit_address(address["uuid"], *args)[0m
[30;1m526 | [0m[35m                # Update internal stats[0m
[30;1m527 | [0m[35m                self.stats["addresses"][1] += 1[0m
[30;1m528 | [0m[35m                self.stats["users"].add(uuid)[0m
[30;1m529 | [0m[35m            elif decision == AddressDecisionList.TERMINATE:[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m518 | [0m[35m        for decision, address, *args in decision_list:[0m
[30;1m519 | [0m[35m            if decision == AddressDecisionList.CREATE:[0m
[30;1m520 | [0m[35m                self._create_address(*args)[0m
[30;1m521 | [0m[35m                # Update internal stats[0m
[30;1m522 | [0m[35m                self.stats["addresses"][0] += 1[0m
[30;1m523 | [0m[35m                self.stats["users"].add(uuid)[0m
[30;1m524 | [0m[35m            elif decision == AddressDecisionList.EDIT:[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m508 | [0m[35m            self._create_it_system(uuid, ad_username, mo_itsystem_uuid)[0m
[30;1m509 | [0m[35m            self.stats["it_systems"] += 1[0m
[30;1m510 | [0m[35m            self.stats["users"].add(uuid)[0m
[30;1m511 | [0m[35m        elif mo_username != ad_username:  # We need to update the mo_username[0m
[30;1m512 | [0m[35m            self._update_it_system(ad_username, binding_uuid)[0m
[30;1m513 | [0m[35m            self.stats["it_systems"] += 1[0m
[30;1m514 | [0m[35m            self.stats["users"].add(uuid)[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m440 | [0m[35m[0m
[30;1m441 | [0m[35m            mo_data[mo_field] = new_mo_value[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m        # Check that the loop added at least one key/value pair to `mo_data`.[0m
[30;1m444 | [0m[35m        if not mo_data:[0m
[30;1m445 | [0m[35m            logger.debug("Nothing to post, returning")[0m
[30;1m446 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m377 | [0m[35m                _make_exclude_function(itemgetter("from_date")),[0m
[30;1m378 | [0m[35m                list(engagements),[0m
[30;1m379 | [0m[35m            )[0m
[30;1m380 | [0m[35m            # Notice, this will only update current row, if more rows exists, they[0m
[30;1m381 | [0m[35m            # will not be updated until the first run after that row has become[0m
[30;1m382 | [0m[35m            # current. To fix this, we will need to ad option to LoRa cache to be[0m
[30;1m383 | [0m[35m            # able to return entire object validity (poc-code exists).[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m192 | [0m[35m        # Check that the configured visibilities are found in MO[0m
[30;1m193 | [0m[35m        configured_visibilities = set(self.visibility.values())[0m
[30;1m194 | [0m[35m        mo_visibilities = set(map(itemgetter("uuid"), mo_visibilities))[0m
[30;1m195 | [0m[35m        # If the configured visibiltities are not a subset, at least one is missing.[0m
[30;1m196 | [0m[35m        if not configured_visibilities.issubset(mo_visibilities):[0m
[30;1m197 | [0m[35m            raise Exception("Error in visibility class configuration")[0m
[30;1m198 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m120 | [0m[35m                    yield (self.TERMINATE, address)[0m
[30;1m121 | [0m[35m                continue[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m            # At this point we know that AD has a value for this field.[0m
[30;1m124 | [0m[35m            # Only process the MO addresses that differ from AD.[0m
[30;1m125 | [0m[35m            differing_addresses = filter([0m
[30;1m126 | [0m[35m                partial(self._mo_and_ad_differs, field),[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m# how to check these classes for noobs[0m
[30;1m30 | [0m[35m# look at :https://os2mo-test.holstebro.dk/service/o/ORGUUID/f/[0m
[30;1m31 | [0m[35m# It must be addresses, so we find the address thing for employees[0m
[30;1m32 | [0m[35m# https://os2mo-test.holstebro.dk/service/o/ORGUUID/f/employee_address_type/[0m
[30;1m33 | [0m[35m# There You have it - for example the mobile phone[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m743 | [0m[35m            ad_settings = ad_reader._get_setting()[0m
[30;1m744 | [0m[35m[0m
[30;1m745 | [0m[35m            # move to read_conf_settings og valider pÃ¥ tvÃ¦rs af alle-ad'er[0m
[30;1m746 | [0m[35m            # sÃ¥ vi ikke overskriver addresser, itsystemer og extensionfelter[0m
[30;1m747 | [0m[35m            # fra et ad med  med vÃ¦rdier fra et andet[0m
[30;1m748 | [0m[35m            self.mapping = ad_settings["ad_mo_sync_mapping"][0m
[30;1m749 | [0m[35m            self._verify_it_systems()[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m557 | [0m[35m            return itsystem_uuid in it_system_uuids[0m
[30;1m558 | [0m[35m[0m
[30;1m559 | [0m[35m        def _keep_only_open(itconnection):[0m
[30;1m560 | [0m[35m            # Figure out how to find the itsystem connection end-date[0m
[30;1m561 | [0m[35m            # Differs by source, as LoraCache and MO are not equivalent![0m
[30;1m562 | [0m[35m            if self.lc:[0m
[30;1m563 | [0m[35m                to_date = itconnection["to_date"][0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m538 | [0m[35m        if "it_systems" not in self.mapping:[0m
[30;1m539 | [0m[35m            return[0m
[30;1m540 | [0m[35m[0m
[30;1m541 | [0m[35m        # Figure out how to find the itsystems uuid[0m
[30;1m542 | [0m[35m        # Differs by source, as LoraCache and MO are not equivalent![0m
[30;1m543 | [0m[35m        def itsystem_uuid_extractor_mo(it):[0m
[30;1m544 | [0m[35m            return it["itsystem"]["uuid"][0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m# https://os2mo-test.holstebro.dk/service/o/ORGUUID/f/employee_address_type/[0m
[30;1m33 | [0m[35m# There You have it - for example the mobile phone[0m
[30;1m34 | [0m[35m# Now You may wonder if the VISIBLE/SECRET are right:[0m
[30;1m35 | [0m[35m# Find them here https://os2mo-test.holstebro.dk/service/o/ORGUUID/f/visibility/[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m# AD has no concept of temporality, validity is always from now to infinity.[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/ad_sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m# how to check these classes for noobs[0m
[30;1m30 | [0m[35m# look at :https://os2mo-test.holstebro.dk/service/o/ORGUUID/f/[0m
[30;1m31 | [0m[35m# It must be addresses, so we find the address thing for employees[0m
[30;1m32 | [0m[35m# https://os2mo-test.holstebro.dk/service/o/ORGUUID/f/employee_address_type/[0m
[30;1m33 | [0m[35m# There You have it - for example the mobile phone[0m
[30;1m34 | [0m[35m# Now You may wonder if the VISIBLE/SECRET are right:[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m        env_nested_delimiter = "__"[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m@fastapi_router.get("/")[0m
[30;1m311 | [0m[35masync def index() -> dict[str, str]:[0m
[30;1m312 | [0m[35m    return {"name": "sql_export"}[0m
[30;1m313 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m    result = await sql_exporter.lc._fetch_users(uuid)[0m
[30;1m230 | [0m[35m    users_objects = [[0m
[30;1m231 | [0m[35m        sql_exporter._generate_sql_users(uuid, res, Bruger)[0m
[30;1m232 | [0m[35m        for res in result.get(str(uuid), [])[0m
[30;1m233 | [0m[35m    ][0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m    sql_exporter.update_sql(uuid, users_objects, Bruger)[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m    result = await sql_exporter.lc._fetch_units(uuid)[0m
[30;1m217 | [0m[35m    units_objects = [[0m
[30;1m218 | [0m[35m        sql_exporter._generate_sql_units(uuid, res, Enhed)[0m
[30;1m219 | [0m[35m        for res in result.get(str(uuid), [])[0m
[30;1m220 | [0m[35m    ][0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m    sql_exporter.update_sql(uuid, units_objects, Enhed)[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m    result = await sql_exporter.lc._fetch_related(uuid)[0m
[30;1m204 | [0m[35m    related_objects = [[0m
[30;1m205 | [0m[35m        sql_exporter._generate_sql_related(uuid, res, Enhedssammenkobling)[0m
[30;1m206 | [0m[35m        for res in result.get(str(uuid), [])[0m
[30;1m207 | [0m[35m    ][0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    sql_exporter.update_sql(uuid, related_objects, Enhedssammenkobling)[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m                sql_exporter._generate_sql_manager_responsibility([0m
[30;1m191 | [0m[35m                    responsibility_uuid, uuid, res, LederAnsvar[0m
[30;1m192 | [0m[35m                )[0m
[30;1m193 | [0m[35m                for res in result.get(str(uuid), [])[0m
[30;1m194 | [0m[35m            ][0m
[30;1m195 | [0m[35m            sql_exporter.update_sql(uuid, manager_responsibility_objects, LederAnsvar)[0m
[30;1m196 | [0m[35m    sql_exporter.update_sql(uuid, managers_objects, Leder)[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m):[0m
[30;1m183 | [0m[35m    result = await sql_exporter.lc._fetch_managers(uuid)[0m
[30;1m184 | [0m[35m    managers_objects = [][0m
[30;1m185 | [0m[35m    for res in result.get(str(uuid), []):[0m
[30;1m186 | [0m[35m        managers_objects.append(sql_exporter._generate_sql_managers(uuid, res, Leder))[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m        for responsibility_uuid in res["manager_responsibility"]:[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m    result = await sql_exporter.lc._fetch_leaves(uuid)[0m
[30;1m171 | [0m[35m    leaves_objects = [[0m
[30;1m172 | [0m[35m        sql_exporter._generate_sql_leave(uuid, res, Orlov)[0m
[30;1m173 | [0m[35m        for res in result.get(str(uuid), [])[0m
[30;1m174 | [0m[35m    ][0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m    sql_exporter.update_sql(uuid, leaves_objects, Orlov)[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m    result = await sql_exporter.lc._fetch_kles(uuid)[0m
[30;1m158 | [0m[35m    kle_objects = [[0m
[30;1m159 | [0m[35m        sql_exporter._generate_sql_kle(uuid, res, KLE)[0m
[30;1m160 | [0m[35m        for res in result.get(str(uuid), [])[0m
[30;1m161 | [0m[35m    ][0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    sql_exporter.update_sql(uuid, kle_objects, KLE)[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m    result = await sql_exporter.lc._fetch_it_connections(uuid)[0m
[30;1m145 | [0m[35m    it_connections_objects = [[0m
[30;1m146 | [0m[35m        sql_exporter._generate_sql_it_user(uuid, res, ItForbindelse)[0m
[30;1m147 | [0m[35m        for res in result.get(str(uuid), [])[0m
[30;1m148 | [0m[35m    ][0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    sql_exporter.update_sql(uuid, it_connections_objects, ItForbindelse)[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m    sql_exporter: SqlExport,[0m
[30;1m130 | [0m[35m):[0m
[30;1m131 | [0m[35m    result = await sql_exporter.lc._fetch_itsystems(uuid)[0m
[30;1m132 | [0m[35m    res = result.get(str(uuid))[0m
[30;1m133 | [0m[35m    itsystems_objects = ([0m
[30;1m134 | [0m[35m        [sql_exporter._generate_sql_it_systems(uuid, res, ItSystem)] if res else [][0m
[30;1m135 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m    sql_exporter: SqlExport,[0m
[30;1m117 | [0m[35m):[0m
[30;1m118 | [0m[35m    result = await sql_exporter.lc._fetch_facets(uuid)[0m
[30;1m119 | [0m[35m    res = result.get(str(uuid))[0m
[30;1m120 | [0m[35m    facets_objects = ([0m
[30;1m121 | [0m[35m        [sql_exporter._generate_sql_facets(uuid, res, Facet)] if res else [][0m
[30;1m122 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m    result = await sql_exporter.lc._fetch_engagements(uuid)[0m
[30;1m106 | [0m[35m    engagements_objects = [[0m
[30;1m107 | [0m[35m        sql_exporter._generate_sql_engagements(uuid, res, Engagement)[0m
[30;1m108 | [0m[35m        for res in result.get(str(uuid), [])[0m
[30;1m109 | [0m[35m    ][0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    sql_exporter.update_sql(uuid, engagements_objects, Engagement)[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    sql_exporter: SqlExport,[0m
[30;1m92 | [0m[35m):[0m
[30;1m93 | [0m[35m    result = await sql_exporter.lc._fetch_classes(uuid)[0m
[30;1m94 | [0m[35m    res = result.get(str(uuid))[0m
[30;1m95 | [0m[35m    class_objects = ([0m
[30;1m96 | [0m[35m        [sql_exporter._generate_sql_classes(uuid, res, Klasse)] if res else [][0m
[30;1m97 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    association_objects = [[0m
[30;1m82 | [0m[35m        sql_exporter._generate_sql_associations(uuid, res, Tilknytning)[0m
[30;1m83 | [0m[35m        for res in result.get(str(uuid), [])[0m
[30;1m84 | [0m[35m    ][0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    sql_exporter.update_sql(uuid, association_objects, Tilknytning)[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m    result = await sql_exporter.lc._fetch_address(uuid)[0m
[30;1m61 | [0m[35m    address_objects = [][0m
[30;1m62 | [0m[35m    dar_address_objects = [][0m
[30;1m63 | [0m[35m    for res in result.get(str(uuid), []):[0m
[30;1m64 | [0m[35m        if res["scope"] == "DAR":[0m
[30;1m65 | [0m[35m            dar_address_objects.append([0m
[30;1m66 | [0m[35m                sql_exporter._generate_sql_dar_addresses(uuid, res, DARAdresse)[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/main.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m"""Integration entrypoint."""[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom contextlib import asynccontextmanager[0m
[30;1m9 | [0m[35mfrom typing import Annotated[0m
[30;1m10 | [0m[35mfrom typing import AsyncGenerator[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m    """[0m
[30;1m34 | [0m[35m    for key, value in updates.items():[0m
[30;1m35 | [0m[35m        if isinstance(value, Mapping):[0m
[30;1m36 | [0m[35m            original[key] = recursive_dict_update(original.get(key, {}), value)[0m
[30;1m37 | [0m[35m        else:[0m
[30;1m38 | [0m[35m            original[key] = value[0m
[30;1m39 | [0m[35m    return original[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m        # Non recursive update[0m
[30;1m25 | [0m[35m        updated = {**original, **updates}[0m
[30;1m26 | [0m[35m        self.assertEqual(updated, {'alfa': {'beta': 4}})[0m
[30;1m27 | [0m[35m        # Recursive update[0m
[30;1m28 | [0m[35m        r_updated = recursive_dict_update(original, updates)[0m
[30;1m29 | [0m[35m        self.assertEqual(r_updated, {'alfa': {'beta': 4, 'charlie': 3}})[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m21 | [0m[35m    Example:[0m
[30;1m22 | [0m[35m        original = {'alfa': {'beta': 2, 'charlie': 3}},[0m
[30;1m23 | [0m[35m        updates = {'alfa': {'beta': 4}}[0m
[30;1m24 | [0m[35m        # Non recursive update[0m
[30;1m25 | [0m[35m        updated = {**original, **updates}[0m
[30;1m26 | [0m[35m        self.assertEqual(updated, {'alfa': {'beta': 4}})[0m
[30;1m27 | [0m[35m        # Recursive update[0m
[30;1m28 | [0m[35m        r_updated = recursive_dict_update(original, updates)[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mdef recursive_dict_update(original, updates):[0m
[30;1m19 | [0m[35m    """Recursively update 'original' with keys from 'updates'.[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    Example:[0m
[30;1m22 | [0m[35m        original = {'alfa': {'beta': 2, 'charlie': 3}},[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1017 | [0m[35mif __name__ == "__main__":[0m
[30;1m1018 | [0m[35m    settings = load_settings()[0m
[30;1m1019 | [0m[35m[0m
[30;1m1020 | [0m[35m    reader = ad_reader.ADParameterReader() if settings.get("integrations.ad") else None[0m
[30;1m1021 | [0m[35m[0m
[30;1m1022 | [0m[35m    try:[0m
[30;1m1023 | [0m[35m        start_opus_diff(ad_reader=reader)[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m992 | [0m[35m[0m
[30;1m993 | [0m[35m    dumps = opus_helpers.read_available_dumps()[0m
[30;1m994 | [0m[35m    run_db = Path(SETTINGS["integrations.opus.import.run_db"])[0m
[30;1m995 | [0m[35m    filter_ids = SETTINGS.get("integrations.opus.units.filter_ids", [])[0m
[30;1m996 | [0m[35m[0m
[30;1m997 | [0m[35m    if not run_db.is_file():[0m
[30;1m998 | [0m[35m        logger.error("Local base not correctly initialized")[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m797 | [0m[35m        )[0m
[30;1m798 | [0m[35m[0m
[30;1m799 | [0m[35m        if self.ad_reader is not None:[0m
[30;1m800 | [0m[35m            sam_account = ad_info.get("SamAccountName")[0m
[30;1m801 | [0m[35m            self.connect_it_system([0m
[30;1m802 | [0m[35m                sam_account, constants.AD_it_system, employee, employee_mo_uuid[0m
[30;1m803 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m793 | [0m[35m[0m
[30;1m794 | [0m[35m        # Add it-systems[0m
[30;1m795 | [0m[35m        self.connect_it_system([0m
[30;1m796 | [0m[35m            employee.get("userId"), constants.Opus_it_system, employee, employee_mo_uuid[0m
[30;1m797 | [0m[35m        )[0m
[30;1m798 | [0m[35m[0m
[30;1m799 | [0m[35m        if self.ad_reader is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m779 | [0m[35m            uuid = self.employee_forced_uuids.get(cpr)[0m
[30;1m780 | [0m[35m            logger.info(f"Employee {uuid} in force list. AD info: {ad_info}")[0m
[30;1m781 | [0m[35m            if uuid is None:[0m
[30;1m782 | [0m[35m                uuid = ad_info.get("ObjectGuid")[0m
[30;1m783 | [0m[35m            employee_mo_uuid = self.create_user(employee, uuid)[0m
[30;1m784 | [0m[35m        else:[0m
[30;1m785 | [0m[35m            employee_mo_uuid = mo_user["uuid"][0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m776 | [0m[35m            ad_info = self.ad_reader.read_user(cpr=cpr)[0m
[30;1m777 | [0m[35m[0m
[30;1m778 | [0m[35m        if mo_user is None:[0m
[30;1m779 | [0m[35m            uuid = self.employee_forced_uuids.get(cpr)[0m
[30;1m780 | [0m[35m            logger.info(f"Employee {uuid} in force list. AD info: {ad_info}")[0m
[30;1m781 | [0m[35m            if uuid is None:[0m
[30;1m782 | [0m[35m                uuid = ad_info.get("ObjectGuid")[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m759 | [0m[35m    def update_employee(self, employee):[0m
[30;1m760 | [0m[35m        cpr = opus_helpers.read_cpr(employee)[0m
[30;1m761 | [0m[35m        logger.info("----")[0m
[30;1m762 | [0m[35m        logger.info("Now updating {}".format(employee.get("@id")))[0m
[30;1m763 | [0m[35m        logger.debug("Available info: {}".format(employee))[0m
[30;1m764 | [0m[35m        if employee["position"] is None:[0m
[30;1m765 | [0m[35m            logger.warning("Error in opus-file. Missing 'position'")[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m642 | [0m[35m            self.terminate_detail(current["uuid"], detail_type="it")[0m
[30;1m643 | [0m[35m            logger.info(f"No {it_system} info for {person_uuid} any longer")[0m
[30;1m644 | [0m[35m        # Changed account name. Only supports one account pr it-system[0m
[30;1m645 | [0m[35m        elif current.get("user_key") != username:[0m
[30;1m646 | [0m[35m            payload = payloads.edit_it_system_username([0m
[30;1m647 | [0m[35m                current["uuid"],[0m
[30;1m648 | [0m[35m                username,[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m479 | [0m[35m            "engagement_job_function", bvn=job[0m
[30;1m480 | [0m[35m        )[0m
[30;1m481 | [0m[35m[0m
[30;1m482 | [0m[35m        contract = employee.get("workContractText", "Ansat")[0m
[30;1m483 | [0m[35m        engagement_type_uuid = self.ensure_class_in_facet("engagement_type", contract)[0m
[30;1m484 | [0m[35m        return str(job_function_uuid), str(engagement_type_uuid)[0m
[30;1m485 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m454 | [0m[35m            "from_date": from_date,[0m
[30;1m455 | [0m[35m        }[0m
[30;1m456 | [0m[35m[0m
[30;1m457 | [0m[35m        if mo_unit.get("uuid"):  # Edit[0m
[30;1m458 | [0m[35m            unit_args["from_date"] = self.xml_date.strftime("%Y-%m-%d")[0m
[30;1m459 | [0m[35m            payload = payloads.edit_org_unit(**unit_args)[0m
[30;1m460 | [0m[35m            logger.info("Edit unit: {}".format(payload))[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m444 | [0m[35m            "org_unit_type", bvn=org_type_bvn, title=org_type_title[0m
[30;1m445 | [0m[35m        )[0m
[30;1m446 | [0m[35m        from_date = unit.get("startDate", "01-01-1900")[0m
[30;1m447 | [0m[35m        unit_user_key = self.settings.get("integrations.opus.unit_user_key", "@id")[0m
[30;1m448 | [0m[35m        unit_args = {[0m
[30;1m449 | [0m[35m            "unit": unit,[0m
[30;1m450 | [0m[35m            "unit_user_key": unit[unit_user_key],[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m443 | [0m[35m        unit_type = self.ensure_class_in_facet([0m
[30;1m444 | [0m[35m            "org_unit_type", bvn=org_type_bvn, title=org_type_title[0m
[30;1m445 | [0m[35m        )[0m
[30;1m446 | [0m[35m        from_date = unit.get("startDate", "01-01-1900")[0m
[30;1m447 | [0m[35m        unit_user_key = self.settings.get("integrations.opus.unit_user_key", "@id")[0m
[30;1m448 | [0m[35m        unit_args = {[0m
[30;1m449 | [0m[35m            "unit": unit,[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m        # Default to "Enhed" as unittype[0m
[30;1m440 | [0m[35m        org_type_title = unit.get("orgTypeTxt", "Enhed")[0m
[30;1m441 | [0m[35m        org_type_bvn = unit.get("orgType", org_type_title)[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m        unit_type = self.ensure_class_in_facet([0m
[30;1m444 | [0m[35m            "org_unit_type", bvn=org_type_bvn, title=org_type_title[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m437 | [0m[35m        mo_unit = self.helper.read_ou(calculated_uuid)[0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m        # Default to "Enhed" as unittype[0m
[30;1m440 | [0m[35m        org_type_title = unit.get("orgTypeTxt", "Enhed")[0m
[30;1m441 | [0m[35m        org_type_bvn = unit.get("orgType", org_type_title)[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m        unit_type = self.ensure_class_in_facet([0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m417 | [0m[35m                mo_addr_type,[0m
[30;1m418 | [0m[35m                scope=predefined_scopes.get(mo_addr_type),[0m
[30;1m419 | [0m[35m            )[0m
[30;1m420 | [0m[35m            current = address_dict.get(str(addr_type_uuid))[0m
[30;1m421 | [0m[35m            args = {[0m
[30;1m422 | [0m[35m                "address_type": {"uuid": str(addr_type_uuid)},[0m
[30;1m423 | [0m[35m                "value": unit[addr_type],[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m415 | [0m[35m            addr_type_uuid = self.ensure_class_in_facet([0m
[30;1m416 | [0m[35m                "org_unit_address_type",[0m
[30;1m417 | [0m[35m                mo_addr_type,[0m
[30;1m418 | [0m[35m                scope=predefined_scopes.get(mo_addr_type),[0m
[30;1m419 | [0m[35m            )[0m
[30;1m420 | [0m[35m            current = address_dict.get(str(addr_type_uuid))[0m
[30;1m421 | [0m[35m            args = {[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m409 | [0m[35m        for addr_type, mo_addr_type in UNIT_ADDRESS_CHECKS.items():[0m
[30;1m410 | [0m[35m            # addr_type is the opus name for the address, mo_addr_type[0m
[30;1m411 | [0m[35m            # is read from MO[0m
[30;1m412 | [0m[35m            if unit.get(addr_type) is None:[0m
[30;1m413 | [0m[35m                continue[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m            addr_type_uuid = self.ensure_class_in_facet([0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m396 | [0m[35m                "uuid": address["uuid"],[0m
[30;1m397 | [0m[35m            }[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m        if unit.get("street") and unit.get("zipCode"):[0m
[30;1m400 | [0m[35m            address_uuid = dawa_helper.dawa_lookup(unit["street"], unit["zipCode"])[0m
[30;1m401 | [0m[35m            if address_uuid:[0m
[30;1m402 | [0m[35m                logger.debug("Found DAR uuid: {}".format(address_uuid))[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m396 | [0m[35m                "uuid": address["uuid"],[0m
[30;1m397 | [0m[35m            }[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m        if unit.get("street") and unit.get("zipCode"):[0m
[30;1m400 | [0m[35m            address_uuid = dawa_helper.dawa_lookup(unit["street"], unit["zipCode"])[0m
[30;1m401 | [0m[35m            if address_uuid:[0m
[30;1m402 | [0m[35m                logger.debug("Found DAR uuid: {}".format(address_uuid))[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m        address_dict = {}[0m
[30;1m388 | [0m[35m        for address in unit_addresses:[0m
[30;1m389 | [0m[35m            if address_dict.get(address["type"]) is not None:[0m
[30;1m390 | [0m[35m                # More than one of this type exist in MO, this is not allowed.[0m
[30;1m391 | [0m[35m                msg = "Inconsistent addresses for unit: {}"[0m
[30;1m392 | [0m[35m                logger.error(msg.format(calculated_uuid))[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m                    scope="INTERNAL",[0m
[30;1m368 | [0m[35m                )[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m            current = mo_addresses.get(str(addr_type_uuid))[0m
[30;1m371 | [0m[35m            address_args = {[0m
[30;1m372 | [0m[35m                "address_type": {"uuid": str(addr_type_uuid)},[0m
[30;1m373 | [0m[35m                "value": opus_addresses[addr_type],[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m            addr_type_uuid = self.ensure_class_in_facet([0m
[30;1m357 | [0m[35m                "employee_address_type",[0m
[30;1m358 | [0m[35m                mo_addr_type,[0m
[30;1m359 | [0m[35m                scope=predefined_scopes.get(mo_addr_type),[0m
[30;1m360 | [0m[35m            )[0m
[30;1m361 | [0m[35m            visibility = None[0m
[30;1m362 | [0m[35m            if mo_addr_type == "Adresse":[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m350 | [0m[35m        logger.info("Addresses to be synced to MO: {}".format(opus_addresses))[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m        for addr_type, mo_addr_type in EMPLOYEE_ADDRESS_CHECKS.items():[0m
[30;1m353 | [0m[35m            if opus_addresses.get(addr_type) is None:[0m
[30;1m354 | [0m[35m                continue[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m            addr_type_uuid = self.ensure_class_in_facet([0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m335 | [0m[35m            response = self.helper._mo_post("details/create", payload)[0m
[30;1m336 | [0m[35m            assert response.status_code == 201[0m
[30;1m337 | [0m[35m        elif (args.get("value") == current.get("value")) and ([0m
[30;1m338 | [0m[35m            args.get("visibility") == current.get("visibility")[0m
[30;1m339 | [0m[35m        ):  # Nothing changed[0m
[30;1m340 | [0m[35m            logger.info("{} not updated".format(addr_type))[0m
[30;1m341 | [0m[35m        else:  # Edit address[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m335 | [0m[35m            response = self.helper._mo_post("details/create", payload)[0m
[30;1m336 | [0m[35m            assert response.status_code == 201[0m
[30;1m337 | [0m[35m        elif (args.get("value") == current.get("value")) and ([0m
[30;1m338 | [0m[35m            args.get("visibility") == current.get("visibility")[0m
[30;1m339 | [0m[35m        ):  # Nothing changed[0m
[30;1m340 | [0m[35m            logger.info("{} not updated".format(addr_type))[0m
[30;1m341 | [0m[35m        else:  # Edit address[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m            logger.debug("Create {} address payload: {}".format(addr_type, payload))[0m
[30;1m335 | [0m[35m            response = self.helper._mo_post("details/create", payload)[0m
[30;1m336 | [0m[35m            assert response.status_code == 201[0m
[30;1m337 | [0m[35m        elif (args.get("value") == current.get("value")) and ([0m
[30;1m338 | [0m[35m            args.get("visibility") == current.get("visibility")[0m
[30;1m339 | [0m[35m        ):  # Nothing changed[0m
[30;1m340 | [0m[35m            logger.info("{} not updated".format(addr_type))[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m            logger.debug("Create {} address payload: {}".format(addr_type, payload))[0m
[30;1m335 | [0m[35m            response = self.helper._mo_post("details/create", payload)[0m
[30;1m336 | [0m[35m            assert response.status_code == 201[0m
[30;1m337 | [0m[35m        elif (args.get("value") == current.get("value")) and ([0m
[30;1m338 | [0m[35m            args.get("visibility") == current.get("visibility")[0m
[30;1m339 | [0m[35m        ):  # Nothing changed[0m
[30;1m340 | [0m[35m            logger.info("{} not updated".format(addr_type))[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m313 | [0m[35m        if ([0m
[30;1m314 | [0m[35m            "postalCode" in employee[0m
[30;1m315 | [0m[35m            and employee["address"][0m
[30;1m316 | [0m[35m            and not self.settings.get("integrations.opus.skip_employee_address", False)[0m
[30;1m317 | [0m[35m        ):[0m
[30;1m318 | [0m[35m            if isinstance(employee["address"], dict):[0m
[30;1m319 | [0m[35m                logger.info("Protected addres, cannont import")[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m302 | [0m[35m        ):[0m
[30;1m303 | [0m[35m            opus_addresses["email"] = employee["email"][0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m        skip_employee_phone = self.settings.get([0m
[30;1m306 | [0m[35m            "integrations.opus.skip_employee_phone", False[0m
[30;1m307 | [0m[35m        )[0m
[30;1m308 | [0m[35m        if employee["workPhone"] is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    def _condense_employee_opus_addresses(self, employee):[0m
[30;1m299 | [0m[35m        opus_addresses = {}[0m
[30;1m300 | [0m[35m        if "email" in employee and not self.settings.get([0m
[30;1m301 | [0m[35m            "integrations.opus.skip_employee_email", False[0m
[30;1m302 | [0m[35m        ):[0m
[30;1m303 | [0m[35m            opus_addresses["email"] = employee["email"][0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m            return address_dict[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m        for address in user_addresses:[0m
[30;1m288 | [0m[35m            if address_dict.get(address["address_type"]["uuid"]) is not None:[0m
[30;1m289 | [0m[35m                # More than one of this type exist in MO, this is not allowed.[0m
[30;1m290 | [0m[35m                msg = "Inconsistent addresses for employee: {}"[0m
[30;1m291 | [0m[35m                logger.error(msg.format(mo_uuid))[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        self.employee_forced_uuids = employee_mapping or opus_helpers.read_cpr_mapping()[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m        self.settings = load_settings()[0m
[30;1m167 | [0m[35m        self.filter_ids = filter_ids or self.settings.get([0m
[30;1m168 | [0m[35m            "integrations.opus.units.filter_ids", [][0m
[30;1m169 | [0m[35m        )[0m
[30;1m170 | [0m[35m        self.dry_run = dry_run[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m.hostname[0m
[30;1m221 | [0m[35m        return types_dict, facet[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m    def _get_mora_helper(self, hostname="localhost:5000", use_cache=False):[0m
[30;1m224 | [0m[35m        return MoraHelper(hostname=self.settings["mora.base"], use_cache=False)[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    # This exact function also exists in sd_changed_at[0m
[30;1m227 | [0m[35m    def _assert(self, response):[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m.hostname[0m
[30;1m220 | [0m[35m            types_dict[class_type["user_key"]] = class_type["uuid"][0m
[30;1m221 | [0m[35m        return types_dict, facet[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m    def _get_mora_helper(self, hostname="localhost:5000", use_cache=False):[0m
[30;1m224 | [0m[35m        return MoraHelper(hostname=self.settings["mora.base"], use_cache=False)[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    # This exact function also exists in sd_changed_at[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m.hostname[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m        self.session = Session()[0m
[30;1m173 | [0m[35m        self.helper = self._get_mora_helper([0m
[30;1m174 | [0m[35m            hostname=self.settings["mora.base"], use_cache=False[0m
[30;1m175 | [0m[35m        )[0m
[30;1m176 | [0m[35m        self.gql_client = self._setup_gql_client()[0m
[30;1m177 | [0m[35m        if dry_run:[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m979 | [0m[35m[0m
[30;1m980 | [0m[35m    diff.handle_filtered_units(filtered_units)[0m
[30;1m981 | [0m[35m    if rundb_write and not dry_run:[0m
[30;1m982 | [0m[35m        opus_helpers.local_db_insert((xml_date, "Diff update ended: {}"))[0m
[30;1m983 | [0m[35m    print()[0m
[30;1m984 | [0m[35m[0m
[30;1m985 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m966 | [0m[35m        latest_path, xml_path, filter_ids, opus_id=opus_id[0m
[30;1m967 | [0m[35m    )[0m
[30;1m968 | [0m[35m    if rundb_write and not dry_run:[0m
[30;1m969 | [0m[35m        opus_helpers.local_db_insert((xml_date, "Running diff update since {}"))[0m
[30;1m970 | [0m[35m[0m
[30;1m971 | [0m[35m    diff = OpusDiffImport([0m
[30;1m972 | [0m[35m        xml_date,[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m948 | [0m[35m    dry_run=False,[0m
[30;1m949 | [0m[35m):[0m
[30;1m950 | [0m[35m    """Import one file at the date xml_date."""[0m
[30;1m951 | [0m[35m    msg = "Start update: File: {}, update since: {}"[0m
[30;1m952 | [0m[35m    logger.info(msg.format(xml_date, latest_date))[0m
[30;1m953 | [0m[35m    print(msg.format(xml_date, latest_date))[0m
[30;1m954 | [0m[35m    # Find changes to units and employees[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m947 | [0m[35m    rundb_write=True,[0m
[30;1m948 | [0m[35m    dry_run=False,[0m
[30;1m949 | [0m[35m):[0m
[30;1m950 | [0m[35m    """Import one file at the date xml_date."""[0m
[30;1m951 | [0m[35m    msg = "Start update: File: {}, update since: {}"[0m
[30;1m952 | [0m[35m    logger.info(msg.format(xml_date, latest_date))[0m
[30;1m953 | [0m[35m    print(msg.format(xml_date, latest_date))[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m832 | [0m[35m            self.update_manager_status(employee_mo_uuid, employee)[0m
[30;1m833 | [0m[35m        except TypeError as e:[0m
[30;1m834 | [0m[35m            if self.dry_run:[0m
[30;1m835 | [0m[35m                logger.debug("dry-run. Would update manager status for the new user")[0m
[30;1m836 | [0m[35m                return[0m
[30;1m837 | [0m[35m            raise (e)[0m
[30;1m838 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m804 | [0m[35m[0m
[30;1m805 | [0m[35m        self._update_employee_address(employee_mo_uuid, employee)[0m
[30;1m806 | [0m[35m[0m
[30;1m807 | [0m[35m        # Now we have a MO uuid, update engagement:[0m
[30;1m808 | [0m[35m        mo_engagements = self.helper.read_user_engagement([0m
[30;1m809 | [0m[35m            employee_mo_uuid, read_all=True[0m
[30;1m810 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m784 | [0m[35m        else:[0m
[30;1m785 | [0m[35m            employee_mo_uuid = mo_user["uuid"][0m
[30;1m786 | [0m[35m[0m
[30;1m787 | [0m[35m            # Update user if name has changed[0m
[30;1m788 | [0m[35m            if (employee["firstName"] != mo_user["givenname"]) or ([0m
[30;1m789 | [0m[35m                employee["lastName"] != mo_user["surname"][0m
[30;1m790 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m704 | [0m[35m                "validity": self.validity(employee, edit=True),[0m
[30;1m705 | [0m[35m            }[0m
[30;1m706 | [0m[35m            if manager_functions:[0m
[30;1m707 | [0m[35m                logger.info("Attempt manager update of {}:".format(employee_mo_uuid))[0m
[30;1m708 | [0m[35m                # Opus supports only a single manager object pr engagement[0m
[30;1m709 | [0m[35m                assert len(manager_functions) == 1[0m
[30;1m710 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m491 | [0m[35m        differences before shipping the payload to MO.[0m
[30;1m492 | [0m[35m        :param engagement: Relevant MO engagement object.[0m
[30;1m493 | [0m[35m        :param employee: Relevent Opus employee object.[0m
[30;1m494 | [0m[35m        :return: True if update happended, False if not.[0m
[30;1m495 | [0m[35m        """[0m
[30;1m496 | [0m[35m        job_function, eng_type = self._job_and_engagement_type(opus_employee)[0m
[30;1m497 | [0m[35m        unit_uuid = opus_helpers.generate_uuid(opus_employee["orgUnit"])[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m    def update_engagement(self, mo_engagement, opus_employee):[0m
[30;1m487 | [0m[35m        """[0m
[30;1m488 | [0m[35m        Update a MO engagement according to opus employee object.[0m
[30;1m489 | [0m[35m        It often happens that the change that provoked lastChanged to[0m
[30;1m490 | [0m[35m        be updated is not a MO field, and thus we check for relevant[0m
[30;1m491 | [0m[35m        differences before shipping the payload to MO.[0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m968 | [0m[35m    if rundb_write and not dry_run:[0m
[30;1m969 | [0m[35m        opus_helpers.local_db_insert((xml_date, "Running diff update since {}"))[0m
[30;1m970 | [0m[35m[0m
[30;1m971 | [0m[35m    diff = OpusDiffImport([0m
[30;1m972 | [0m[35m        xml_date,[0m
[30;1m973 | [0m[35m        ad_reader=ad_reader,[0m
[30;1m974 | [0m[35m        filter_ids=filter_ids,[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m966 | [0m[35m        latest_path, xml_path, filter_ids, opus_id=opus_id[0m
[30;1m967 | [0m[35m    )[0m
[30;1m968 | [0m[35m    if rundb_write and not dry_run:[0m
[30;1m969 | [0m[35m        opus_helpers.local_db_insert((xml_date, "Running diff update since {}"))[0m
[30;1m970 | [0m[35m[0m
[30;1m971 | [0m[35m    diff = OpusDiffImport([0m
[30;1m972 | [0m[35m        xml_date,[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m951 | [0m[35m    msg = "Start update: File: {}, update since: {}"[0m
[30;1m952 | [0m[35m    logger.info(msg.format(xml_date, latest_date))[0m
[30;1m953 | [0m[35m    print(msg.format(xml_date, latest_date))[0m
[30;1m954 | [0m[35m    # Find changes to units and employees[0m
[30;1m955 | [0m[35m    latest_path = None[0m
[30;1m956 | [0m[35m    if latest_date:[0m
[30;1m957 | [0m[35m        latest_path = dumps[latest_date][0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m324 | [0m[35m                if address_uuid:[0m
[30;1m325 | [0m[35m                    opus_addresses["dar"] = address_uuid[0m
[30;1m326 | [0m[35m                else:[0m
[30;1m327 | [0m[35m                    logger.warning("Could not find address in DAR")[0m
[30;1m328 | [0m[35m        return opus_addresses[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m    def _perform_address_update(self, args, current):[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/opus_diff_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m        filter_ids={},[0m
[30;1m159 | [0m[35m        dry_run: bool = False,[0m
[30;1m160 | [0m[35m    ):[0m
[30;1m161 | [0m[35m        logger.info("Opus diff importer __init__ started")[0m
[30;1m162 | [0m[35m        self.xml_date = xml_date[0m
[30;1m163 | [0m[35m        self.ad_reader = ad_reader[0m
[30;1m164 | [0m[35m        self.employee_forced_uuids = employee_mapping or opus_helpers.read_cpr_mapping()[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/dawa_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m@lru_cache(maxsize=None)[0m
[30;1m8 | [0m[35mdef dawa_lookup(street_name: str, postal_code: str) -> Optional[str]:[0m
[30;1m9 | [0m[35m    """Lookup an address object in DAWA and try to find an UUID for the address.[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    Note: `street_name` is a misleading parameter name, as it should contain the street[0m
[30;1m12 | [0m[35m          name along with house number, door, story, etc.[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/aarhus/los_leder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m    def generate_manager_payload([0m
[30;1m57 | [0m[35m        self, manager: Union[ManagerCreate, ManagerEdit][0m
[30;1m58 | [0m[35m    ) -> dict:[0m
[30;1m59 | [0m[35m        person_uuid = self.cpr_cache.get(manager.cpr)[0m
[30;1m60 | [0m[35m        if not person_uuid:[0m
[30;1m61 | [0m[35m            logger.error("No person found for CPR %s", manager.cpr[:6])[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_mo_to_ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m161 | [0m[35m                # Assert[0m
[30;1m162 | [0m[35m                assert mock_echo.call_count == 4[0m
[30;1m163 | [0m[35m                assert len(commands) == 4[0m
[30;1m164 | [0m[35m                for cmd in commands:[0m
[30;1m165 | [0m[35m                    assert isinstance(cmd, str)[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_mo_to_ad_sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m109 | [0m[35mclass TestMoToAdSyncDryRun:[0m
[30;1m110 | [0m[35m    @parameterized.expand([0m
[30;1m111 | [0m[35m        [[0m
[30;1m112 | [0m[35m            # 1. Engagement in the present, dry run should count it as an update[0m
[30;1m113 | [0m[35m            ([0m
[30;1m114 | [0m[35m                # `lc` contains (default) primary engagement in the present[0m
[30;1m115 | [0m[35m                MockLoraCacheExtended(mo_values={"uuid": MO_UUID}),[0m
[30;1m116 | [0m[35m                # Assert that the dry run would count this MO user as one to process[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/trigger.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m        lock.release()[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m@trigger_router.post("/trigger")[0m
[30;1m51 | [0m[35mdef trigger([0m
[30;1m52 | [0m[35m    background_tasks: BackgroundTasks,[0m
[30;1m53 | [0m[35m    resolve_dar: bool = Query(False),[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/trigger.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m19 | [0m[35mtrigger_router = APIRouter()[0m
[30;1m20 | [0m[35m# Concurrency lock to ensure that only 1 operation is running at a time[0m
[30;1m21 | [0m[35mlock_actual = Lock()[0m
[30;1m22 | [0m[35mlock_historic = Lock()[0m
[30;1m23 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/exporters/sql_export/trigger.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m19 | [0m[35mtrigger_router = APIRouter()[0m
[30;1m20 | [0m[35m# Concurrency lock to ensure that only 1 operation is running at a time[0m
[30;1m21 | [0m[35mlock_actual = Lock()[0m
[30;1m22 | [0m[35mlock_historic = Lock()[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/opus/tests/test_opus_helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m    def test_find_cancelled(self):[0m
[30;1m111 | [0m[35m        file_diffs = opus_helpers.file_diff(testfile1, testfile2, disable_tqdm=True)[0m
[30;1m112 | [0m[35m        assert len(file_diffs["cancelled_employees"]) == 1, ([0m
[30;1m113 | [0m[35m            "Expected to find 1 cancelled employee"[0m
[30;1m114 | [0m[35m        )[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_jinja_filters.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m118 | [0m[35m            "_get_all_ad_emails": lambda: set(),[0m
[30;1m119 | [0m[35m        }[0m
[30;1m120 | [0m[35m        if name.count(" ") or name.count("-"):[0m
[30;1m121 | [0m[35m            # Name contains at least one space or dash. This means we can extract at[0m
[30;1m122 | [0m[35m            # least two "name parts."[0m
[30;1m123 | [0m[35m            email = name_to_email_address(ctx, name)[0m
[30;1m124 | [0m[35m            assert email.endswith("@upn_end")[0m
[30;1m125 | [0m[35m            value = email.split("@upn_end")[0][0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_jinja_filters.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m118 | [0m[35m            "_get_all_ad_emails": lambda: set(),[0m
[30;1m119 | [0m[35m        }[0m
[30;1m120 | [0m[35m        if name.count(" ") or name.count("-"):[0m
[30;1m121 | [0m[35m            # Name contains at least one space or dash. This means we can extract at[0m
[30;1m122 | [0m[35m            # least two "name parts."[0m
[30;1m123 | [0m[35m            email = name_to_email_address(ctx, name)[0m
[30;1m124 | [0m[35m            assert email.endswith("@upn_end")[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m635[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/dipex-5.62.1/integrations/ad_integration/tests/test_ad_jinja_filters.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m61 | [0m[35m            ),[0m
[30;1m62 | [0m[35m            ([0m
[30;1m63 | [0m[35m                # Variants A, B and C taken, use variant D.[0m
[30;1m64 | [0m[35m                # Start serial number at 3 since no other D variants are taken.[0m
[30;1m65 | [0m[35m                {"tester.testesen@upn_end", "t.testesen@upn_end", "tester.t@upn_end"},[0m
[30;1m66 | [0m[35m                "tester.testesen.3@upn_end",[0m
[30;1m67 | [0m[35m            ),[0m

635 matches found.
