[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/utils/loaders.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m    """[0m
[30;1m271 | [0m[35m    from csv import reader[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m    key = kwargs.get("key", None)[0m
[30;1m274 | [0m[35m    data = {}[0m
[30;1m275 | [0m[35m    headers = [][0m
[30;1m276 | [0m[35m    if include:[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/utils/loaders.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m    """[0m
[30;1m111 | [0m[35m    result = {}[0m
[30;1m112 | [0m[35m    loader = kwargs.get("load", "python").lower()[0m
[30;1m113 | [0m[35m    include = kwargs.get("include", None)[0m
[30;1m114 | [0m[35m    if not text_data and include is None:[0m
[30;1m115 | [0m[35m        return None[0m
[30;1m116 | [0m[35m    elif text_data is None and include:[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/utils/loaders.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        data from elemnt.text string or from included text files[0m
[30;1m110 | [0m[35m    """[0m
[30;1m111 | [0m[35m    result = {}[0m
[30;1m112 | [0m[35m    loader = kwargs.get("load", "python").lower()[0m
[30;1m113 | [0m[35m    include = kwargs.get("include", None)[0m
[30;1m114 | [0m[35m    if not text_data and include is None:[0m
[30;1m115 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/utils/loaders.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m        from yaml import safe_load[0m
[30;1m232 | [0m[35m    except ModuleNotFoundError:[0m
[30;1m233 | [0m[35m        log.error([0m
[30;1m234 | [0m[35m            "loaders.load_yaml: failed to import yaml module, install: 'python -m pip install pyyaml[0m
[30;1m235 | [0m[35m        )[0m
[30;1m236 | [0m[35m    data = {}[0m
[30;1m237 | [0m[35m    if include:[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3464 | [0m[35m    if not LOG_LEVEL.upper() in valid_log_levels:[0m
[30;1m3465 | [0m[35m        return[0m
[30;1m3466 | [0m[35m    # if used as a CLI tool or sas a script - setup logging config using custom formatter[0m
[30;1m3467 | [0m[35m    if __name__ == "__main__" or _ttp_.get("_used_as_cli_tool_") == True:[0m
[30;1m3468 | [0m[35m        logging.basicConfig([0m
[30;1m3469 | [0m[35m            format="%(asctime)s.%(msecs)d [TTP %(levelname)s] %(lineno)d; %(message)s",[0m
[30;1m3470 | [0m[35m            datefmt="%m/%d/%Y %I:%M:%S",[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3415 | [0m[35m        for item in self.funcs:[0m
[30;1m3416 | [0m[35m            func_name = item["name"][0m
[30;1m3417 | [0m[35m            args = item.get("args", [])[0m
[30;1m3418 | [0m[35m            kwargs = item.get("kwargs", {})[0m
[30;1m3419 | [0m[35m            results = self._ttp_["output"][func_name](results, *args, **kwargs)[0m
[30;1m3420 | [0m[35m        # run formatters[0m
[30;1m3421 | [0m[35m        if format_type in self._ttp_["formatters"]:[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3414 | [0m[35m        # run functions[0m
[30;1m3415 | [0m[35m        for item in self.funcs:[0m
[30;1m3416 | [0m[35m            func_name = item["name"][0m
[30;1m3417 | [0m[35m            args = item.get("args", [])[0m
[30;1m3418 | [0m[35m            kwargs = item.get("kwargs", {})[0m
[30;1m3419 | [0m[35m            results = self._ttp_["output"][func_name](results, *args, **kwargs)[0m
[30;1m3420 | [0m[35m        # run formatters[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3408 | [0m[35m        # check condition to see if need to run this output[0m
[30;1m3409 | [0m[35m        if self.attributes.get("condition"):[0m
[30;1m3410 | [0m[35m            condition_var_name, condition_var_value = self.attributes["condition"][0m
[30;1m3411 | [0m[35m            var_value = self.template_obj.vars.get(condition_var_name, "_undef_")[0m
[30;1m3412 | [0m[35m            if not var_value == condition_var_value:[0m
[30;1m3413 | [0m[35m                return data[0m
[30;1m3414 | [0m[35m        # run functions[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3406 | [0m[35m        format_type = self.attributes["format"][0m
[30;1m3407 | [0m[35m        results = data[0m
[30;1m3408 | [0m[35m        # check condition to see if need to run this output[0m
[30;1m3409 | [0m[35m        if self.attributes.get("condition"):[0m
[30;1m3410 | [0m[35m            condition_var_name, condition_var_value = self.attributes["condition"][0m
[30;1m3411 | [0m[35m            var_value = self.template_obj.vars.get(condition_var_name, "_undef_")[0m
[30;1m3412 | [0m[35m            if not var_value == condition_var_value:[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3295 | [0m[35m[0m
[30;1m3296 | [0m[35m    def extract_load(self, element):[0m
[30;1m3297 | [0m[35m        # if formatter is jinja2, use text loader to load template[0m
[30;1m3298 | [0m[35m        if self.attributes.get("format") == "jinja2":[0m
[30;1m3299 | [0m[35m            self.attributes["load"] = "text"[0m
[30;1m3300 | [0m[35m        # run attributes extraction[0m
[30;1m3301 | [0m[35m        attribs = self._ttp_["utils"]["load_struct"](element.text, **self.attributes)[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3251 | [0m[35m        for item in self.record["FUNCTIONS"]:[0m
[30;1m3252 | [0m[35m            func_name = item["name"][0m
[30;1m3253 | [0m[35m            args = item.get("args", [])[0m
[30;1m3254 | [0m[35m            kwargs = item.get("kwargs", {})[0m
[30;1m3255 | [0m[35m            # run group functions[0m
[30;1m3256 | [0m[35m            self.record["result"], flags = self._ttp_["group"][func_name]([0m
[30;1m3257 | [0m[35m                self.record["result"], *args, **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3250 | [0m[35m        # process group functions[0m
[30;1m3251 | [0m[35m        for item in self.record["FUNCTIONS"]:[0m
[30;1m3252 | [0m[35m            func_name = item["name"][0m
[30;1m3253 | [0m[35m            args = item.get("args", [])[0m
[30;1m3254 | [0m[35m            kwargs = item.get("kwargs", {})[0m
[30;1m3255 | [0m[35m            # run group functions[0m
[30;1m3256 | [0m[35m            self.record["result"], flags = self._ttp_["group"][func_name]([0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3241 | [0m[35m            self.record["result"].setdefault(k, v)[0m
[30;1m3242 | [0m[35m        # if merge_with_last - tail match, attempt to reconstruct group result[0m
[30;1m3243 | [0m[35m        # this only will work if self.record["result"] contains enough info to form PATH[0m
[30;1m3244 | [0m[35m        if self.record.get("merge_with_last") is True:[0m
[30;1m3245 | [0m[35m            processed_path = self.form_path(list(self.record["PATH"]))[0m
[30;1m3246 | [0m[35m            if processed_path:[0m
[30;1m3247 | [0m[35m                self.record["result"] = self.reconstruct_last_element([0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3090 | [0m[35m                break[0m
[30;1m3091 | [0m[35m            # check if _line_ group started, don't remove previous started[0m
[30;1m3092 | [0m[35m            # groups to allow collection of non matched lines - #94[0m
[30;1m3093 | [0m[35m            if REDICT.get("IS_LINE"):[0m
[30;1m3094 | [0m[35m                self.started_groups.append(REDICT["GROUP"].group_id)[0m
[30;1m3095 | [0m[35m                break[0m
[30;1m3096 | [0m[35m            _ = self.started_groups.pop()[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3057 | [0m[35m                break[0m
[30;1m3058 | [0m[35m            # check if _line_ group started, don't remove previous started[0m
[30;1m3059 | [0m[35m            # groups to allow collection of non matched lines - #94[0m
[30;1m3060 | [0m[35m            if REDICT.get("IS_LINE"):[0m
[30;1m3061 | [0m[35m                self.started_groups.append(REDICT["GROUP"].group_id)[0m
[30;1m3062 | [0m[35m                break[0m
[30;1m3063 | [0m[35m            _ = self.started_groups.pop()[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3016 | [0m[35m            else:[0m
[30;1m3017 | [0m[35m                E.append(result_data)[0m
[30;1m3018 | [0m[35m        elif isinstance(E, dict):[0m
[30;1m3019 | [0m[35m            if self.record.get("merge_with_last"):[0m
[30;1m3020 | [0m[35m                self._merge_recursively(E, result_data)[0m
[30;1m3021 | [0m[35m            # check if result_path endswith "**" - update result's ELEMENET without converting it in[0m
[30;1m3022 | [0m[35m            elif result_path[-1][1] == "**":[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3011 | [0m[35m        # get ELEMENT from self.results by result_path[0m
[30;1m3012 | [0m[35m        E = self.dict_by_path(PATH=result_path, ELEMENT=self.results)[0m
[30;1m3013 | [0m[35m        if isinstance(E, list) and result_data:[0m
[30;1m3014 | [0m[35m            if self.record.get("merge_with_last"):[0m
[30;1m3015 | [0m[35m                self._merge_recursively(E[-1], result_data)[0m
[30;1m3016 | [0m[35m            else:[0m
[30;1m3017 | [0m[35m                E.append(result_data)[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3000 | [0m[35m        """[0m
[30;1m3001 | [0m[35m        for nk, nd in result_data.items():[0m
[30;1m3002 | [0m[35m            # check if need to run recursion[0m
[30;1m3003 | [0m[35m            if element.get(nk) and isinstance(nd, dict):[0m
[30;1m3004 | [0m[35m                self._merge_recursively(element[nk], nd)[0m
[30;1m3005 | [0m[35m            # nd is not a dict, simply save it in existing results[0m
[30;1m3006 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2392 | [0m[35m            func_name, args, kwargs = ([0m
[30;1m2393 | [0m[35m                item["name"],[0m
[30;1m2394 | [0m[35m                item.get("args", []),[0m
[30;1m2395 | [0m[35m                item.get("kwargs", {}),[0m
[30;1m2396 | [0m[35m            )[0m
[30;1m2397 | [0m[35m            self.DATATEXT, flags = self._ttp_["input"][func_name]([0m
[30;1m2398 | [0m[35m                self.DATATEXT, *args, **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2391 | [0m[35m        for item in input_functions:[0m
[30;1m2392 | [0m[35m            func_name, args, kwargs = ([0m
[30;1m2393 | [0m[35m                item["name"],[0m
[30;1m2394 | [0m[35m                item.get("args", []),[0m
[30;1m2395 | [0m[35m                item.get("kwargs", {}),[0m
[30;1m2396 | [0m[35m            )[0m
[30;1m2397 | [0m[35m            self.DATATEXT, flags = self._ttp_["input"][func_name]([0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2206 | [0m[35m            elif len(data["args"]) == 1:[0m
[30;1m2207 | [0m[35m                pattern = data["args"][0][0m
[30;1m2208 | [0m[35m                re_from_patterns = self._ttp_["patterns"]["get"](name=pattern)[0m
[30;1m2209 | [0m[35m                re_from_var = self.group.vars.get(pattern, None)[0m
[30;1m2210 | [0m[35m                if re_from_var:[0m
[30;1m2211 | [0m[35m                    self.regex = self.regex.replace([0m
[30;1m2212 | [0m[35m                        esc_var, r"(?:{})".format(re_from_var), 1[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2106 | [0m[35m                value = data["args"][0][0m
[30;1m2107 | [0m[35m                data["args"] = (self.group.vars.get(value, value),)[0m
[30;1m2108 | [0m[35m            elif len(data["args"]) > 1:[0m
[30;1m2109 | [0m[35m                data["args"] = tuple([self.group.vars.get(i, i) for i in data["args"]])[0m
[30;1m2110 | [0m[35m            self.functions.append(data)[0m
[30;1m2111 | [0m[35m[0m
[30;1m2112 | [0m[35m        def extract__headers_(data):[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2104 | [0m[35m            """[0m
[30;1m2105 | [0m[35m            if len(data["args"]) == 1:[0m
[30;1m2106 | [0m[35m                value = data["args"][0][0m
[30;1m2107 | [0m[35m                data["args"] = (self.group.vars.get(value, value),)[0m
[30;1m2108 | [0m[35m            elif len(data["args"]) > 1:[0m
[30;1m2109 | [0m[35m                data["args"] = tuple([self.group.vars.get(i, i) for i in data["args"]])[0m
[30;1m2110 | [0m[35m            self.functions.append(data)[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2086 | [0m[35m            except IndexError:[0m
[30;1m2087 | [0m[35m                # if {{ var_name | PHRASE }} used[0m
[30;1m2088 | [0m[35m                regex = data["name"][0m
[30;1m2089 | [0m[35m            re_from_var = self.group.vars.get(regex, None)[0m
[30;1m2090 | [0m[35m            re_from_patterns = self._ttp_["patterns"]["get"](name=regex)[0m
[30;1m2091 | [0m[35m            # check template variables[0m
[30;1m2092 | [0m[35m            if re_from_var:[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2055 | [0m[35m[0m
[30;1m2056 | [0m[35m        def extract_chain(data):[0m
[30;1m2057 | [0m[35m            """add items from chain to variable attributes and functions"""[0m
[30;1m2058 | [0m[35m            variable_value = self.group.vars.get(data["args"][0], None)[0m
[30;1m2059 | [0m[35m            if variable_value is None:[0m
[30;1m2060 | [0m[35m                log.error([0m
[30;1m2061 | [0m[35m                    "match_variable.extract_chain: match variable - '{}', chain var '{}' not found".[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1736 | [0m[35m[0m
[30;1m1737 | [0m[35m        def extract_chain(var_name):[0m
[30;1m1738 | [0m[35m            """add items from chain to group functions"""[0m
[30;1m1739 | [0m[35m            variable_value = self.vars.get(var_name, var_name)[0m
[30;1m1740 | [0m[35m            if isinstance(variable_value, str):[0m
[30;1m1741 | [0m[35m                attributes = self._ttp_["utils"]["get_attributes"](variable_value)[0m
[30;1m1742 | [0m[35m            elif isinstance(variable_value, list):[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1705 | [0m[35m[0m
[30;1m1706 | [0m[35m    def get_attributes(self, data):[0m
[30;1m1707 | [0m[35m        def extract_default(O):[0m
[30;1m1708 | [0m[35m            self.default = self.vars.get(O, O)[0m
[30;1m1709 | [0m[35m[0m
[30;1m1710 | [0m[35m        def extract_method(O):[0m
[30;1m1711 | [0m[35m            self.method = O.lower().strip()[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1453 | [0m[35m            # need to get name before getting any other attributes[0m
[30;1m1454 | [0m[35m            # as name used to extract groups and depending on python dict[0m
[30;1m1455 | [0m[35m            # hashing, groups can be attempted to extract before name attribute[0m
[30;1m1456 | [0m[35m            self.name = element.attrib.get("name", input_name).strip()[0m
[30;1m1457 | [0m[35m            # set default attribute values[0m
[30;1m1458 | [0m[35m            element.attrib.setdefault("groups", groups)[0m
[30;1m1459 | [0m[35m            element.attrib.setdefault("load", "python")[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1351 | [0m[35m                # if extended template has _anonymous_ group as the only child, use only its text[0m
[30;1m1352 | [0m[35m                if ([0m
[30;1m1353 | [0m[35m                    len(extend_ET) == 1[0m
[30;1m1354 | [0m[35m                    and extend_ET[0].attrib.get("name") == "_anonymous_"[0m
[30;1m1355 | [0m[35m                ):[0m
[30;1m1356 | [0m[35m                    template_ET.text += extend_ET[0].text[0m
[30;1m1357 | [0m[35m                    template_ET.remove(child)[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1344 | [0m[35m                    )[0m
[30;1m1345 | [0m[35m                # run extend tag macro function if any[0m
[30;1m1346 | [0m[35m                template_content = content[0][1][0m
[30;1m1347 | [0m[35m                if child.attrib.get("macro") in self.macro:[0m
[30;1m1348 | [0m[35m                    template_content = self.macro[child.attrib["macro"]](content[0][1])[0m
[30;1m1349 | [0m[35m                # construct etree out of template content[0m
[30;1m1350 | [0m[35m                extend_ET = self.construct_etree(template_content)[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1334 | [0m[35m        # recursively iterate over etree handling extend tags[0m
[30;1m1335 | [0m[35m        for index, child in enumerate(template_ET):[0m
[30;1m1336 | [0m[35m            if child.tag == "extend":[0m
[30;1m1337 | [0m[35m                path_to_template = child.attrib.get("template", "")[0m
[30;1m1338 | [0m[35m                content = self._ttp_["utils"]["load_files"](path_to_template, read=True)[0m
[30;1m1339 | [0m[35m                if content[0][1] == path_to_template:[0m
[30;1m1340 | [0m[35m                    raise FileNotFoundError([0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1304 | [0m[35m        # do filtering for nested tag allowing <group> and <extend> tags only[0m
[30;1m1305 | [0m[35m        else:[0m
[30;1m1306 | [0m[35m            for t in extend_template:[0m
[30;1m1307 | [0m[35m                tag_name = t.attrib.get("name")[0m
[30;1m1308 | [0m[35m                if t.tag in ["g", "grp", "group"]:[0m
[30;1m1309 | [0m[35m                    if groups:[0m
[30;1m1310 | [0m[35m                        if tag_name in groups or str(grp_index) in groups:[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1282 | [0m[35m                i.strip() for i in extend_tag.get("outputs", "").split(",") if i.strip()[0m
[30;1m1283 | [0m[35m            ][0m
[30;1m1284 | [0m[35m            for t in extend_template:[0m
[30;1m1285 | [0m[35m                tag_name = t.attrib.get("name")[0m
[30;1m1286 | [0m[35m                if inputs and t.tag in ["i", "in", "input"]:[0m
[30;1m1287 | [0m[35m                    if tag_name in inputs:[0m
[30;1m1288 | [0m[35m                        ret.append(t)[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1279 | [0m[35m                i.strip() for i in extend_tag.get("lookups", "").split(",") if i.strip()[0m
[30;1m1280 | [0m[35m            ][0m
[30;1m1281 | [0m[35m            outputs = [[0m
[30;1m1282 | [0m[35m                i.strip() for i in extend_tag.get("outputs", "").split(",") if i.strip()[0m
[30;1m1283 | [0m[35m            ][0m
[30;1m1284 | [0m[35m            for t in extend_template:[0m
[30;1m1285 | [0m[35m                tag_name = t.attrib.get("name")[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1276 | [0m[35m                i.strip() for i in extend_tag.get("vars", "").split(",") if i.strip()[0m
[30;1m1277 | [0m[35m            ][0m
[30;1m1278 | [0m[35m            lookups = [[0m
[30;1m1279 | [0m[35m                i.strip() for i in extend_tag.get("lookups", "").split(",") if i.strip()[0m
[30;1m1280 | [0m[35m            ][0m
[30;1m1281 | [0m[35m            outputs = [[0m
[30;1m1282 | [0m[35m                i.strip() for i in extend_tag.get("outputs", "").split(",") if i.strip()[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1273 | [0m[35m                i.strip() for i in extend_tag.get("inputs", "").split(",") if i.strip()[0m
[30;1m1274 | [0m[35m            ][0m
[30;1m1275 | [0m[35m            tvars = [[0m
[30;1m1276 | [0m[35m                i.strip() for i in extend_tag.get("vars", "").split(",") if i.strip()[0m
[30;1m1277 | [0m[35m            ][0m
[30;1m1278 | [0m[35m            lookups = [[0m
[30;1m1279 | [0m[35m                i.strip() for i in extend_tag.get("lookups", "").split(",") if i.strip()[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1270 | [0m[35m        # do filtering for top tag[0m
[30;1m1271 | [0m[35m        if top:[0m
[30;1m1272 | [0m[35m            inputs = [[0m
[30;1m1273 | [0m[35m                i.strip() for i in extend_tag.get("inputs", "").split(",") if i.strip()[0m
[30;1m1274 | [0m[35m            ][0m
[30;1m1275 | [0m[35m            tvars = [[0m
[30;1m1276 | [0m[35m                i.strip() for i in extend_tag.get("vars", "").split(",") if i.strip()[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1265 | [0m[35m        ret = [][0m
[30;1m1266 | [0m[35m        grp_index = 0[0m
[30;1m1267 | [0m[35m        groups = [[0m
[30;1m1268 | [0m[35m            i.strip() for i in extend_tag.get("groups", "").split(",") if i.strip()[0m
[30;1m1269 | [0m[35m        ][0m
[30;1m1270 | [0m[35m        # do filtering for top tag[0m
[30;1m1271 | [0m[35m        if top:[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1213 | [0m[35m        lookup_data = self._ttp_["utils"]["load_struct"](element.text, **element.attrib)[0m
[30;1m1214 | [0m[35m        if lookup_data is None:[0m
[30;1m1215 | [0m[35m            return[0m
[30;1m1216 | [0m[35m        if element.attrib.get("database", "").lower() == "geoip2":[0m
[30;1m1217 | [0m[35m            lookup_data = self._ttp_["lookup"]["geoip2_db_loader"](lookup_data)[0m
[30;1m1218 | [0m[35m        self.lookups[element.attrib["name"]] = lookup_data[0m
[30;1m1219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1183 | [0m[35m    def parse_template(self, element, template_index):[0m
[30;1m1184 | [0m[35m        # skip child templates that are not in requested children list[0m
[30;1m1185 | [0m[35m        if self.filters:[0m
[30;1m1186 | [0m[35m            if not element.attrib.get("name", None) in self.filters:[0m
[30;1m1187 | [0m[35m                return[0m
[30;1m1188 | [0m[35m        self.templates.append([0m
[30;1m1189 | [0m[35m            _template_class([0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1155 | [0m[35m        }[0m
[30;1m1156 | [0m[35m        # fill in self.tags dictionary:[0m
[30;1m1157 | [0m[35m        for child in list(element):[0m
[30;1m1158 | [0m[35m            tags_funcs.get(child.tag.lower(), self.invalid)(child)[0m
[30;1m1159 | [0m[35m[0m
[30;1m1160 | [0m[35m    def invalid(self, C):[0m
[30;1m1161 | [0m[35m        log.warning("template.parse: invalid tag '{}'".format(C.tag))[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m862 | [0m[35m        self.load_functions()[0m
[30;1m863 | [0m[35m        # run tasks[0m
[30;1m864 | [0m[35m        while True:[0m
[30;1m865 | [0m[35m            next_task = self.task_queue.get()[0m
[30;1m866 | [0m[35m            # check for dead pill to stop process[0m
[30;1m867 | [0m[35m            if next_task is None:[0m
[30;1m868 | [0m[35m                self.task_queue.task_done()[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m771 | [0m[35m        Example::[0m
[30;1m772 | [0m[35m[0m
[30;1m773 | [0m[35m            def group_cust_fun(data, *args, **kwargs):[0m
[30;1m774 | [0m[35m                if kwargs.get("upper") == True:[0m
[30;1m775 | [0m[35m                    data["description"] = data["description"].upper()[0m
[30;1m776 | [0m[35m                return data, None[0m
[30;1m777 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m492 | [0m[35m            tasks.join()[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m            for i in range(num_jobs):[0m
[30;1m495 | [0m[35m                result = results_queue.get()[0m
[30;1m496 | [0m[35m                template.form_results(result)[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m    def __parse_in_one_process(self):[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m470 | [0m[35m                    vars=template.vars,[0m
[30;1m471 | [0m[35m                    groups=template.groups,[0m
[30;1m472 | [0m[35m                    macro_text=template.macro_text,[0m
[30;1m473 | [0m[35m                    custom_functions=self._ttp_.get("_custom_functions_", {}),[0m
[30;1m474 | [0m[35m                    dynamic_path_key_to_int=self._ttp_["dynamic_path_key_to_int"],[0m
[30;1m475 | [0m[35m                )[0m
[30;1m476 | [0m[35m                for i in range(num_processes)[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m371 | [0m[35m                ttp_vars=self.vars,[0m
[30;1m372 | [0m[35m                name=template_name,[0m
[30;1m373 | [0m[35m                filters=filters,[0m
[30;1m374 | [0m[35m                ttp_macro=self._ttp_.get("_custom_functions_", {}).get("macro", {}),[0m
[30;1m375 | [0m[35m                _ttp_=self._ttp_,[0m
[30;1m376 | [0m[35m            )[0m
[30;1m377 | [0m[35m            # if not template_obj.templates - no 'template' tags in template[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m371 | [0m[35m                ttp_vars=self.vars,[0m
[30;1m372 | [0m[35m                name=template_name,[0m
[30;1m373 | [0m[35m                filters=filters,[0m
[30;1m374 | [0m[35m                ttp_macro=self._ttp_.get("_custom_functions_", {}).get("macro", {}),[0m
[30;1m375 | [0m[35m                _ttp_=self._ttp_,[0m
[30;1m376 | [0m[35m            )[0m
[30;1m377 | [0m[35m            # if not template_obj.templates - no 'template' tags in template[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m            parent_path, filename = os.path.split(module_file.name)[0m
[30;1m158 | [0m[35m            _, parent_dir = os.path.split(parent_path)[0m
[30;1m159 | [0m[35m            for func_name in functions:[0m
[30;1m160 | [0m[35m                name = _name_map_.get(func_name, func_name)[0m
[30;1m161 | [0m[35m                path = "{}.{}".format(parent_dir, filename.replace(".py", ""))[0m
[30;1m162 | [0m[35m                _ttp_.setdefault(parent_dir, {})[name] = CachedModule([0m
[30;1m163 | [0m[35m                    path, parent_dir, name, functions, _ttp_[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m            # use unpickled _ttp_ dictionary if it of the same python version[0m
[30;1m94 | [0m[35m            if ([0m
[30;1m95 | [0m[35m                _ttp_["python_major_version"] == version_info.major[0m
[30;1m96 | [0m[35m                and _ttp_.get("__version__") == __version__[0m
[30;1m97 | [0m[35m            ):[0m
[30;1m98 | [0m[35m                log.info([0m
[30;1m99 | [0m[35m                    "ttp.lazy_import_functions: loaded _ttp_ dictionary from ttp_dict_cache.pickle"[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        except AttributeError:[0m
[30;1m55 | [0m[35m            _name_map_ = {}[0m
[30;1m56 | [0m[35m        for func_name in self.parent_module_functions:[0m
[30;1m57 | [0m[35m            name = _name_map_.get(func_name, func_name)[0m
[30;1m58 | [0m[35m            self._ttp_[self.parent_dir][name] = getattr(module, func_name)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    def __call__(self, *args, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3116 | [0m[35m        DEFAULTS = DEFAULTS or {}[0m
[30;1m3117 | [0m[35m        FUNCTIONS = FUNCTIONS or [][0m
[30;1m3118 | [0m[35m        if self.record["PATH"] == PATH:  # if same path - save into self.record[0m
[30;1m3119 | [0m[35m            # update without overriding already existing values:[0m
[30;1m3120 | [0m[35m            result.update(self.record["result"])[0m
[30;1m3121 | [0m[35m            self.record["result"] = result[0m
[30;1m3122 | [0m[35m        # if different path - that can happen if we have group ended and result[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3018 | [0m[35m        elif isinstance(E, dict):[0m
[30;1m3019 | [0m[35m            if self.record.get("merge_with_last"):[0m
[30;1m3020 | [0m[35m                self._merge_recursively(E, result_data)[0m
[30;1m3021 | [0m[35m            # check if result_path endswith "**" - update result's ELEMENET without converting it in[0m
[30;1m3022 | [0m[35m            elif result_path[-1][1] == "**":[0m
[30;1m3023 | [0m[35m                result_data.update(E)[0m
[30;1m3024 | [0m[35m                E.update(result_data)[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2978 | [0m[35m            else:  # if first element not in dict - we found new key, update it into the dict[0m
[30;1m2979 | [0m[35m                ELEMENT.update([0m
[30;1m2980 | [0m[35m                    self.list_to_dict_fwd(PATH)[0m
[30;1m2981 | [0m[35m                )  # update new key into the nested dict with value equal to new nested dict branch[0m
[30;1m2982 | [0m[35m                return self.dict_by_path([0m
[30;1m2983 | [0m[35m                    PATH[1:], ELEMENT[name][0m
[30;1m2984 | [0m[35m                )  # run recursion to reach element in the PATH[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2975 | [0m[35m                return self.dict_by_path([0m
[30;1m2976 | [0m[35m                    PATH[1:], ELEMENT[name][0m
[30;1m2977 | [0m[35m                )  # run recursion with moving forward in both - PATH and ELEMENT[0m
[30;1m2978 | [0m[35m            else:  # if first element not in dict - we found new key, update it into the dict[0m
[30;1m2979 | [0m[35m                ELEMENT.update([0m
[30;1m2980 | [0m[35m                    self.list_to_dict_fwd(PATH)[0m
[30;1m2981 | [0m[35m                )  # update new key into the nested dict with value equal to new nested dict branch[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2955 | [0m[35m            PATH (list): list of keys in absolute path format[0m
[30;1m2956 | [0m[35m            ELEMENT: nested list, list of dictionaries or dictionary to get element from[0m
[30;1m2957 | [0m[35m        Returns:[0m
[30;1m2958 | [0m[35m            last element at given PATH of transformed ELEMENT dictionary[0m
[30;1m2959 | [0m[35m        """[0m
[30;1m2960 | [0m[35m        if PATH == []:[0m
[30;1m2961 | [0m[35m            return ELEMENT  # check if PATH is empty, if so - stop and return ELEMENT[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2938 | [0m[35m            if self._ttp_["dynamic_path_key_to_int"]:[0m
[30;1m2939 | [0m[35m                # convert key to integer if it is integer[0m
[30;1m2940 | [0m[35m                name = int(name) if name.isdigit() else name[0m
[30;1m2941 | [0m[35m            if asterisk_count == "*":  # if one * at the end - make a list[0m
[30;1m2942 | [0m[35m                if len(KEYS) == 1:  # if KEYS=[1,2,3,4*], returns {1:{2:{3:{4:[{}]}}}}[0m
[30;1m2943 | [0m[35m                    return {name: []}  # if last item in PATH - return emplty list[0m
[30;1m2944 | [0m[35m                else:  # if KEYS=[1,2,3*,4], returns {1:{2:{3:[{4:{}}]}}}[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2913 | [0m[35m            return [[0m
[30;1m2914 | [0m[35m                DATA,[0m
[30;1m2915 | [0m[35m                result,[0m
[30;1m2916 | [0m[35m            ]  # for resulting list - value at given PATH transformed into list with result appended[0m
[30;1m2917 | [0m[35m[0m
[30;1m2918 | [0m[35m    def list_to_dict_fwd(self, KEYS):[0m
[30;1m2919 | [0m[35m        """recursive function to build nested dict starting from first element in list - forward ord[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2884 | [0m[35m            PATH (list): list of path keys[0m
[30;1m2885 | [0m[35m            result : dict or list that contains results[0m
[30;1m2886 | [0m[35m        Returns:[0m
[30;1m2887 | [0m[35m            transformed DATA with list at given PATH and appended results to it[0m
[30;1m2888 | [0m[35m        """[0m
[30;1m2889 | [0m[35m        if PATH:[0m
[30;1m2890 | [0m[35m            name = PATH[0][0][0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2875 | [0m[35m        }[0m
[30;1m2876 | [0m[35m[0m
[30;1m2877 | [0m[35m    def value_to_list(self, DATA, PATH, result):[0m
[30;1m2878 | [0m[35m        """recursive function to get value at given PATH and transform it into the list[0m
[30;1m2879 | [0m[35m        Example:[0m
[30;1m2880 | [0m[35m            DATA={1:{2:{3:{4:5, 6:7}}}} and PATH=(1,2,3)[0m
[30;1m2881 | [0m[35m            running this function will transform DATA to {1:{2:{3:[{4:5, 6:7}]}}}[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2611 | [0m[35m                grps_unsort_rslts.append((run_re(group, results={}), group.outputs))[0m
[30;1m2612 | [0m[35m        # update groups runs (group default values) with global variables[0m
[30;1m2613 | [0m[35m        self.update_groups_runs(self._ttp_["global_vars"])[0m
[30;1m2614 | [0m[35m        # update groups runs (group default values) with group specific/local variables[0m
[30;1m2615 | [0m[35m        self.update_groups_runs(self.vars)[0m
[30;1m2616 | [0m[35m[0m
[30;1m2617 | [0m[35m        # sort results for groups with global outputs[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2609 | [0m[35m            else:[0m
[30;1m2610 | [0m[35m                # form a tuple of ({results}, [group.outputs],)[0m
[30;1m2611 | [0m[35m                grps_unsort_rslts.append((run_re(group, results={}), group.outputs))[0m
[30;1m2612 | [0m[35m        # update groups runs (group default values) with global variables[0m
[30;1m2613 | [0m[35m        self.update_groups_runs(self._ttp_["global_vars"])[0m
[30;1m2614 | [0m[35m        # update groups runs (group default values) with group specific/local variables[0m
[30;1m2615 | [0m[35m        self.update_groups_runs(self.vars)[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2492 | [0m[35m                            )[0m
[30;1m2493 | [0m[35m                            break[0m
[30;1m2494 | [0m[35m                        elif isinstance(flag, dict):[0m
[30;1m2495 | [0m[35m                            # update new_field data preserving previously got new_field[0m
[30;1m2496 | [0m[35m                            if "new_field" in flags and "new_field" in flag:[0m
[30;1m2497 | [0m[35m                                flags["new_field"].update(flag["new_field"])[0m
[30;1m2498 | [0m[35m                            else:[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2401 | [0m[35m                break[0m
[30;1m2402 | [0m[35m[0m
[30;1m2403 | [0m[35m    def update_groups_runs(self, D):[0m
[30;1m2404 | [0m[35m        """Method to update groups runs dictionaries with new values deirved[0m
[30;1m2405 | [0m[35m        during parsing, can be called from 'record' variable functions[0m
[30;1m2406 | [0m[35m        """[0m
[30;1m2407 | [0m[35m        for G in self.groups:[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1920 | [0m[35m            child.set_runs()[0m
[30;1m1921 | [0m[35m[0m
[30;1m1922 | [0m[35m    def update_runs(self, data):[0m
[30;1m1923 | [0m[35m        # func to update runs of the groups using data dictionary[0m
[30;1m1924 | [0m[35m        for k, v in data.items():[0m
[30;1m1925 | [0m[35m            for dk, dv in self.runs.items():[0m
[30;1m1926 | [0m[35m                if dv == k:[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1338 | [0m[35m                content = self._ttp_["utils"]["load_files"](path_to_template, read=True)[0m
[30;1m1339 | [0m[35m                if content[0][1] == path_to_template:[0m
[30;1m1340 | [0m[35m                    raise FileNotFoundError([0m
[30;1m1341 | [0m[35m                        "template.extend: failed load extend tag content at path: {}".format([0m
[30;1m1342 | [0m[35m                            path_to_template[0m
[30;1m1343 | [0m[35m                        )[0m
[30;1m1344 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1259 | [0m[35m        :param top: (bool) indicator if extend tag is at the top or nested[0m
[30;1m1260 | [0m[35m        :return: list of EX.XML objects that passed filtering[0m
[30;1m1261 | [0m[35m        """[0m
[30;1m1262 | [0m[35m        # check if no filters given at all - return straight away[0m
[30;1m1263 | [0m[35m        if top and len(extend_tag.attrib) == 1:[0m
[30;1m1264 | [0m[35m            return extend_template[0m
[30;1m1265 | [0m[35m        ret = [][0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1256 | [0m[35m[0m
[30;1m1257 | [0m[35m        :param extend_ET: (obj) ET.XML object of extended template[0m
[30;1m1258 | [0m[35m        :param child: (obj) ET.XML object of extend data[0m
[30;1m1259 | [0m[35m        :param top: (bool) indicator if extend tag is at the top or nested[0m
[30;1m1260 | [0m[35m        :return: list of EX.XML objects that passed filtering[0m
[30;1m1261 | [0m[35m        """[0m
[30;1m1262 | [0m[35m        # check if no filters given at all - return straight away[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1056 | [0m[35m[0m
[30;1m1057 | [0m[35m    def update_inputs_with_groups(self):[0m
[30;1m1058 | [0m[35m        """[0m
[30;1m1059 | [0m[35m        Method to update self.inputs group_inputs with group indexes[0m
[30;1m1060 | [0m[35m        """[0m
[30;1m1061 | [0m[35m        for G in self.groups:[0m
[30;1m1062 | [0m[35m            for input_name in G.inputs:[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m994 | [0m[35m        """Method to add results to self.results"""[0m
[30;1m995 | [0m[35m        datum = [][0m
[30;1m996 | [0m[35m        # result is always a dictionary, but if have _anonymous_[0m
[30;1m997 | [0m[35m        # group, need to merge it with the rest of results, at the[0m
[30;1m998 | [0m[35m        # same time _anonymous_ group result is always a list[0m
[30;1m999 | [0m[35m        if "_anonymous_" in result:[0m
[30;1m1000 | [0m[35m            datum = result.pop("_anonymous_")[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m980 | [0m[35m        [template.add_lookup(data) for template in self.templates][0m
[30;1m981 | [0m[35m[0m
[30;1m982 | [0m[35m    def add_vars(self, data):[0m
[30;1m983 | [0m[35m        """Method to update vars with given data"""[0m
[30;1m984 | [0m[35m        if isinstance(data, dict):[0m
[30;1m985 | [0m[35m            self.vars.update(data)[0m
[30;1m986 | [0m[35m            [template.add_vars(data) for template in self.templates][0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m952 | [0m[35m[0m
[30;1m953 | [0m[35m        # update inputs with the groups it has to be run against:[0m
[30;1m954 | [0m[35m        self.update_inputs_with_groups()[0m
[30;1m955 | [0m[35m        # update groups with output references:[0m
[30;1m956 | [0m[35m        self.update_groups_with_outputs()[0m
[30;1m957 | [0m[35m        # separate vars with functions from vars[0m
[30;1m958 | [0m[35m        self.get_var_functions()[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m950 | [0m[35m        # load template from string:[0m
[30;1m951 | [0m[35m        self.load_template_xml(self.template)[0m
[30;1m952 | [0m[35m[0m
[30;1m953 | [0m[35m        # update inputs with the groups it has to be run against:[0m
[30;1m954 | [0m[35m        self.update_inputs_with_groups()[0m
[30;1m955 | [0m[35m        # update groups with output references:[0m
[30;1m956 | [0m[35m        self.update_groups_with_outputs()[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m169 | [0m[35m            pickle.dump(_ttp_, f)[0m
[30;1m170 | [0m[35m    except Exception as e:[0m
[30;1m171 | [0m[35m        log.warning([0m
[30;1m172 | [0m[35m            "ttp.lazy_import_functions: failed to save cache at '{}', error '{}'".format([0m
[30;1m173 | [0m[35m                cache_file, e[0m
[30;1m174 | [0m[35m            )[0m
[30;1m175 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3696 | [0m[35m    parser_Obj.parse(one=ONE, multi=MULTI)[0m
[30;1m3697 | [0m[35m    timing("Data parsing finished")[0m
[30;1m3698 | [0m[35m[0m
[30;1m3699 | [0m[35m    # print data to screen[0m
[30;1m3700 | [0m[35m    if OUTPUTTER:[0m
[30;1m3701 | [0m[35m        if not OUT_TEMPLATE:[0m
[30;1m3702 | [0m[35m            OUT_TEMPLATE = [][0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3486 | [0m[35m[0m
[30;1m3487 | [0m[35mdef cli_tool():[0m
[30;1m3488 | [0m[35m    import argparse[0m
[30;1m3489 | [0m[35m    import time[0m
[30;1m3490 | [0m[35m[0m
[30;1m3491 | [0m[35m    # form _ttp_ dictionary and pre-load it with all functions[0m
[30;1m3492 | [0m[35m    _ttp_ = lazy_import_functions()[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3463 | [0m[35m    valid_log_levels = ["DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL"][0m
[30;1m3464 | [0m[35m    if not LOG_LEVEL.upper() in valid_log_levels:[0m
[30;1m3465 | [0m[35m        return[0m
[30;1m3466 | [0m[35m    # if used as a CLI tool or sas a script - setup logging config using custom formatter[0m
[30;1m3467 | [0m[35m    if __name__ == "__main__" or _ttp_.get("_used_as_cli_tool_") == True:[0m
[30;1m3468 | [0m[35m        logging.basicConfig([0m
[30;1m3469 | [0m[35m            format="%(asctime)s.%(msecs)d [TTP %(levelname)s] %(lineno)d; %(message)s",[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3312 | [0m[35m[0m
[30;1m3313 | [0m[35m        def extract_filename(O):[0m
[30;1m3314 | [0m[35m            """File name can contain time formatters supported by strftime"""[0m
[30;1m3315 | [0m[35m            from time import strftime[0m
[30;1m3316 | [0m[35m[0m
[30;1m3317 | [0m[35m            self.attributes["filename"] = strftime(O)[0m
[30;1m3318 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3311 | [0m[35m            self.attributes["returner"] = [i.strip() for i in O.split(",")][0m
[30;1m3312 | [0m[35m[0m
[30;1m3313 | [0m[35m        def extract_filename(O):[0m
[30;1m3314 | [0m[35m            """File name can contain time formatters supported by strftime"""[0m
[30;1m3315 | [0m[35m            from time import strftime[0m
[30;1m3316 | [0m[35m[0m
[30;1m3317 | [0m[35m            self.attributes["filename"] = strftime(O)[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3239 | [0m[35m        # add default values to group results[0m
[30;1m3240 | [0m[35m        for k, v in self.record["DEFAULTS"].items():[0m
[30;1m3241 | [0m[35m            self.record["result"].setdefault(k, v)[0m
[30;1m3242 | [0m[35m        # if merge_with_last - tail match, attempt to reconstruct group result[0m
[30;1m3243 | [0m[35m        # this only will work if self.record["result"] contains enough info to form PATH[0m
[30;1m3244 | [0m[35m        if self.record.get("merge_with_last") is True:[0m
[30;1m3245 | [0m[35m            processed_path = self.form_path(list(self.record["PATH"]))[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3094 | [0m[35m                self.started_groups.append(REDICT["GROUP"].group_id)[0m
[30;1m3095 | [0m[35m                break[0m
[30;1m3096 | [0m[35m            _ = self.started_groups.pop()[0m
[30;1m3097 | [0m[35m        # meaning top group started[0m
[30;1m3098 | [0m[35m        else:[0m
[30;1m3099 | [0m[35m            if REDICT["GROUP"].group_id not in self.started_groups:[0m
[30;1m3100 | [0m[35m                self.started_groups.append(REDICT["GROUP"].group_id)[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3061 | [0m[35m                self.started_groups.append(REDICT["GROUP"].group_id)[0m
[30;1m3062 | [0m[35m                break[0m
[30;1m3063 | [0m[35m            _ = self.started_groups.pop()[0m
[30;1m3064 | [0m[35m        # meaning top group started[0m
[30;1m3065 | [0m[35m        else:[0m
[30;1m3066 | [0m[35m            if REDICT["GROUP"].group_id not in self.started_groups:[0m
[30;1m3067 | [0m[35m                self.started_groups.append(REDICT["GROUP"].group_id)[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3035 | [0m[35m        """[0m
[30;1m3036 | [0m[35m        Method to retrieve last element value, make a copy of it and nerge with[0m
[30;1m3037 | [0m[35m        current results. This is to reconstruct group results for processing in[0m
[30;1m3038 | [0m[35m        a case where we have tail matches.[0m
[30;1m3039 | [0m[35m        """[0m
[30;1m3040 | [0m[35m        # get ELEMENT from self.results by result_path[0m
[30;1m3041 | [0m[35m        E = self.dict_by_path(PATH=result_path, ELEMENT=self.results)[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2841 | [0m[35m            )[0m
[30;1m2842 | [0m[35m[0m
[30;1m2843 | [0m[35m    def save_vars(self, variables):[0m
[30;1m2844 | [0m[35m        # need to sort keys first to introduce deterministic behavior[0m
[30;1m2845 | [0m[35m        sorted_pathes = sorted(list(variables["_vars_to_results_"].keys()))[0m
[30;1m2846 | [0m[35m        for path_item in sorted_pathes:[0m
[30;1m2847 | [0m[35m            # skip empty path items:[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2716 | [0m[35m                else:[0m
[30;1m2717 | [0m[35m                    re_ = None[0m
[30;1m2718 | [0m[35m                    startempty_re, start_re, normal_re, line_re = [], [], [], [][0m
[30;1m2719 | [0m[35m                    # sort matches across startempty (_start_), start, normal and line REs[0m
[30;1m2720 | [0m[35m                    for index, item in enumerate(result):[0m
[30;1m2721 | [0m[35m                        if item[0]["IS_LINE"] == True:[0m
[30;1m2722 | [0m[35m                            line_re.append(index)[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2628 | [0m[35m        RSLTSOBJ.make_results(self.vars, raw_results, main_results=self.main_results)[0m
[30;1m2629 | [0m[35m        self.main_results = RSLTSOBJ.results[0m
[30;1m2630 | [0m[35m[0m
[30;1m2631 | [0m[35m        # sort results for groups with group specific outputs[0m
[30;1m2632 | [0m[35m        for group_result in grps_unsort_rslts:[0m
[30;1m2633 | [0m[35m            if group_result[0]:[0m
[30;1m2634 | [0m[35m                grps_raw_results.append([0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2614 | [0m[35m        # update groups runs (group default values) with group specific/local variables[0m
[30;1m2615 | [0m[35m        self.update_groups_runs(self.vars)[0m
[30;1m2616 | [0m[35m[0m
[30;1m2617 | [0m[35m        # sort results for groups with global outputs[0m
[30;1m2618 | [0m[35m        for group_result in unsort_rslts:[0m
[30;1m2619 | [0m[35m            if group_result:[0m
[30;1m2620 | [0m[35m                raw_results.append([0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2551 | [0m[35m                        if group.start_re == [][0m
[30;1m2552 | [0m[35m                        else group.start_re[0][0m
[30;1m2553 | [0m[35m                    )[0m
[30;1m2554 | [0m[35m                    # find free index to place results in[0m
[30;1m2555 | [0m[35m                    while key in results:[0m
[30;1m2556 | [0m[35m                        key += 1[0m
[30;1m2557 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2428 | [0m[35m        """[0m
[30;1m2429 | [0m[35m        unsort_rslts = ([0m
[30;1m2430 | [0m[35m            [][0m
[30;1m2431 | [0m[35m        )  # list of dictionaries - one item per top group, each dictionary[0m
[30;1m2432 | [0m[35m        # contains unsorted match results for REs within group[0m
[30;1m2433 | [0m[35m        raw_results = []  # list to store sorted results for groups with global outputs[0m
[30;1m2434 | [0m[35m        grps_unsort_rslts = []  # match results for groups with group specific outputs[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2246 | [0m[35m            # remove {{ _headers_ }} variable from end of string[0m
[30;1m2247 | [0m[35m            index = self.LINE.find(esc_var)[0m
[30;1m2248 | [0m[35m            self.regex = self.LINE[:index].rstrip()[0m
[30;1m2249 | [0m[35m            # find all headers[0m
[30;1m2250 | [0m[35m            headers = re.findall(r"(\S+\s+|\S+)", self.regex)[0m
[30;1m2251 | [0m[35m            # form columns count[0m
[30;1m2252 | [0m[35m            columns = len(headers) - 2[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1904 | [0m[35m                    _ttp_=self._ttp_,[0m
[30;1m1905 | [0m[35m                )[0m
[30;1m1906 | [0m[35m            )[0m
[30;1m1907 | [0m[35m            # get regexes from tail[0m
[30;1m1908 | [0m[35m            if group.tail.strip():[0m
[30;1m1909 | [0m[35m                self.get_regexes(data=group.tail, tail=True)[0m
[30;1m1910 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1873 | [0m[35m                self.start_re.append(re_dict)[0m
[30;1m1874 | [0m[35m            else:[0m
[30;1m1875 | [0m[35m                self.re.append(re_dict)[0m
[30;1m1876 | [0m[35m        # if no regexes in this top group, set it to start unconditionally[0m
[30;1m1877 | [0m[35m        if isinstance(self.default, dict):[0m
[30;1m1878 | [0m[35m            self.defaults.update(self.default)[0m
[30;1m1879 | [0m[35m            if self.start_re == []:[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1859 | [0m[35m        for index, re_dict in enumerate(regexes):[0m
[30;1m1860 | [0m[35m            if "end" in re_dict["ACTION"]:[0m
[30;1m1861 | [0m[35m                self.end_re.append(re_dict)[0m
[30;1m1862 | [0m[35m            elif tail == True:[0m
[30;1m1863 | [0m[35m                self.re.append(re_dict)[0m
[30;1m1864 | [0m[35m            elif index == 0:[0m
[30;1m1865 | [0m[35m                if not "start" in re_dict["ACTION"]:[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1670 | [0m[35m        """[0m
[30;1m1671 | [0m[35m        self._ttp_ = _ttp_[0m
[30;1m1672 | [0m[35m        self.pathchar = pathchar[0m
[30;1m1673 | [0m[35m        self.top = top[0m
[30;1m1674 | [0m[35m        self.path = list(path or [])[0m
[30;1m1675 | [0m[35m        self.defaults = {}[0m
[30;1m1676 | [0m[35m        self.runs = {}[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1650 | [0m[35m        """Init method[0m
[30;1m1651 | [0m[35m        Attributes:[0m
[30;1m1652 | [0m[35m            element : xml ETree element to parse[0m
[30;1m1653 | [0m[35m            top (bool): to indicate that group is a top xml ETree group[0m
[30;1m1654 | [0m[35m            path (list): list containing results tree path, have to copy it otherwise[0m
[30;1m1655 | [0m[35m                it got overridden by recursion[0m
[30;1m1656 | [0m[35m            defaults (dict): contains group variables' default values[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1650 | [0m[35m        """Init method[0m
[30;1m1651 | [0m[35m        Attributes:[0m
[30;1m1652 | [0m[35m            element : xml ETree element to parse[0m
[30;1m1653 | [0m[35m            top (bool): to indicate that group is a top xml ETree group[0m
[30;1m1654 | [0m[35m            path (list): list containing results tree path, have to copy it otherwise[0m
[30;1m1655 | [0m[35m                it got overridden by recursion[0m
[30;1m1656 | [0m[35m            defaults (dict): contains group variables' default values[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1382 | [0m[35m        """[0m
[30;1m1383 | [0m[35m        try:[0m
[30;1m1384 | [0m[35m            template_ET = ET.XML(template_text)[0m
[30;1m1385 | [0m[35m            # check if top tag is not template:[0m
[30;1m1386 | [0m[35m            if template_ET.tag.lower() != "template":[0m
[30;1m1387 | [0m[35m                template_ET = ET.XML([0m
[30;1m1388 | [0m[35m                    "<template>\n{}\n</template>".format(template_text)[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1378 | [0m[35m        it if required[0m
[30;1m1379 | [0m[35m[0m
[30;1m1380 | [0m[35m        :param template_text: (str) TTp Template string[0m
[30;1m1381 | [0m[35m        :return: ET.XML object with top tag set to <template>[0m
[30;1m1382 | [0m[35m        """[0m
[30;1m1383 | [0m[35m        try:[0m
[30;1m1384 | [0m[35m            template_ET = ET.XML(template_text)[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1327 | [0m[35m        if template_text:[0m
[30;1m1328 | [0m[35m            template_ET = self.construct_etree(template_text)[0m
[30;1m1329 | [0m[35m        # load macro functions from top template into self.macro dict[0m
[30;1m1330 | [0m[35m        if top == True:[0m
[30;1m1331 | [0m[35m            for child in template_ET:[0m
[30;1m1332 | [0m[35m                if child.tag == "macro":[0m
[30;1m1333 | [0m[35m                    self.parse_macro(child)[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1326 | [0m[35m        # load template string to XML etree object[0m
[30;1m1327 | [0m[35m        if template_text:[0m
[30;1m1328 | [0m[35m            template_ET = self.construct_etree(template_text)[0m
[30;1m1329 | [0m[35m        # load macro functions from top template into self.macro dict[0m
[30;1m1330 | [0m[35m        if top == True:[0m
[30;1m1331 | [0m[35m            for child in template_ET:[0m
[30;1m1332 | [0m[35m                if child.tag == "macro":[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1267 | [0m[35m        groups = [[0m
[30;1m1268 | [0m[35m            i.strip() for i in extend_tag.get("groups", "").split(",") if i.strip()[0m
[30;1m1269 | [0m[35m        ][0m
[30;1m1270 | [0m[35m        # do filtering for top tag[0m
[30;1m1271 | [0m[35m        if top:[0m
[30;1m1272 | [0m[35m            inputs = [[0m
[30;1m1273 | [0m[35m                i.strip() for i in extend_tag.get("inputs", "").split(",") if i.strip()[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1260 | [0m[35m        :return: list of EX.XML objects that passed filtering[0m
[30;1m1261 | [0m[35m        """[0m
[30;1m1262 | [0m[35m        # check if no filters given at all - return straight away[0m
[30;1m1263 | [0m[35m        if top and len(extend_tag.attrib) == 1:[0m
[30;1m1264 | [0m[35m            return extend_template[0m
[30;1m1265 | [0m[35m        ret = [][0m
[30;1m1266 | [0m[35m        grp_index = 0[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1256 | [0m[35m[0m
[30;1m1257 | [0m[35m        :param extend_ET: (obj) ET.XML object of extended template[0m
[30;1m1258 | [0m[35m        :param child: (obj) ET.XML object of extend data[0m
[30;1m1259 | [0m[35m        :param top: (bool) indicator if extend tag is at the top or nested[0m
[30;1m1260 | [0m[35m        :return: list of EX.XML objects that passed filtering[0m
[30;1m1261 | [0m[35m        """[0m
[30;1m1262 | [0m[35m        # check if no filters given at all - return straight away[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1230 | [0m[35m        )[0m
[30;1m1231 | [0m[35m[0m
[30;1m1232 | [0m[35m    def parse_hierarch_tmplt(self, element):[0m
[30;1m1233 | [0m[35m        # collect and sort all the top level tags[0m
[30;1m1234 | [0m[35m        self.collect_tags(element)[0m
[30;1m1235 | [0m[35m[0m
[30;1m1236 | [0m[35m        # perform tags parsing/extraction[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1230 | [0m[35m        )[0m
[30;1m1231 | [0m[35m[0m
[30;1m1232 | [0m[35m    def parse_hierarch_tmplt(self, element):[0m
[30;1m1233 | [0m[35m        # collect and sort all the top level tags[0m
[30;1m1234 | [0m[35m        self.collect_tags(element)[0m
[30;1m1235 | [0m[35m[0m
[30;1m1236 | [0m[35m        # perform tags parsing/extraction[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1089 | [0m[35m                # go to next output if this output found:[0m
[30;1m1090 | [0m[35m                if group_output_found:[0m
[30;1m1091 | [0m[35m                    continue[0m
[30;1m1092 | [0m[35m                # try to find output in group specific outputs:[0m
[30;1m1093 | [0m[35m                for index, output in enumerate(self.groups_outputs):[0m
[30;1m1094 | [0m[35m                    if output.name == grp_output:[0m
[30;1m1095 | [0m[35m                        G.outputs[output_index] = output[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1064 | [0m[35m                if input_name not in self.inputs:[0m
[30;1m1065 | [0m[35m                    url = self.base_path + input_name[0m
[30;1m1066 | [0m[35m                    data_items = self._ttp_["utils"]["load_files"](path=url, read=False)[0m
[30;1m1067 | [0m[35m                    # skip 'text_data' from data as if by the time this method runs[0m
[30;1m1068 | [0m[35m                    # no input with such name found it means that group input is os path[0m
[30;1m1069 | [0m[35m                    # string and text_data will be returned by self.utils.load_files[0m
[30;1m1070 | [0m[35m                    # only if no such path exists, hence text_data does not make sense here[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m995 | [0m[35m        datum = [][0m
[30;1m996 | [0m[35m        # result is always a dictionary, but if have _anonymous_[0m
[30;1m997 | [0m[35m        # group, need to merge it with the rest of results, at the[0m
[30;1m998 | [0m[35m        # same time _anonymous_ group result is always a list[0m
[30;1m999 | [0m[35m        if "_anonymous_" in result:[0m
[30;1m1000 | [0m[35m            datum = result.pop("_anonymous_")[0m
[30;1m1001 | [0m[35m            if result:[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m932 | [0m[35m        self.__doc__ = ""  # string to contain template doc/description[0m
[30;1m933 | [0m[35m        self.template = template_text  # attribute to store template text[0m
[30;1m934 | [0m[35m[0m
[30;1m935 | [0m[35m        # dictionary to store template's top tags ET elements[0m
[30;1m936 | [0m[35m        self.tags = {[0m
[30;1m937 | [0m[35m            "vars": [],[0m
[30;1m938 | [0m[35m            "groups": [],[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m785 | [0m[35m            <group myFun="upper=True">[0m
[30;1m786 | [0m[35m            interface {{ interface }}[0m
[30;1m787 | [0m[35m             description {{ description | ORPHRASE }}[0m
[30;1m788 | [0m[35m             ip address {{ ip }} {{ mask }}[0m
[30;1m789 | [0m[35m            </group>[0m
[30;1m790 | [0m[35m            '''[0m
[30;1m791 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m785 | [0m[35m            <group myFun="upper=True">[0m
[30;1m786 | [0m[35m            interface {{ interface }}[0m
[30;1m787 | [0m[35m             description {{ description | ORPHRASE }}[0m
[30;1m788 | [0m[35m             ip address {{ ip }} {{ mask }}[0m
[30;1m789 | [0m[35m            </group>[0m
[30;1m790 | [0m[35m            '''[0m
[30;1m791 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m779 | [0m[35m            <input load="text">[0m
[30;1m780 | [0m[35m            interface Lo1[0m
[30;1m781 | [0m[35m             description this interface has description[0m
[30;1m782 | [0m[35m             ip address 1.1.1.1 32[0m
[30;1m783 | [0m[35m            </input>[0m
[30;1m784 | [0m[35m[0m
[30;1m785 | [0m[35m            <group myFun="upper=True">[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/ttp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m            except:[0m
[30;1m136 | [0m[35m                # in some versions of python open() does not support encoding[0m
[30;1m137 | [0m[35m                module_file = open("{}/{}".format(root, f), mode="r")[0m
[30;1m138 | [0m[35m            node = ast.parse(module_file.read())[0m
[30;1m139 | [0m[35m            assignments = [n for n in node.body if isinstance(n, ast.Assign)][0m
[30;1m140 | [0m[35m            functions = [n.name for n in node.body if isinstance(n, ast.FunctionDef)][0m
[30;1m141 | [0m[35m            functions = [f for f in functions if (not f.startswith("_"))][0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/jinja2_formatter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m        from jinja2 import Environment[0m
[30;1m12 | [0m[35m    except ImportError:[0m
[30;1m13 | [0m[35m        log.critical([0m
[30;1m14 | [0m[35m            "output.formatter_jinja2: Jinja2 not installed, install: 'python -m pip install jinja2'.[0m
[30;1m15 | [0m[35m        )[0m
[30;1m16 | [0m[35m        raise SystemExit()[0m
[30;1m17 | [0m[35m    # load template:[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/expand.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m18 | [0m[35m                if isinstance(ref, dict):[0m
[30;1m19 | [0m[35m                    ref[new_key] = value[0m
[30;1m20 | [0m[35m                break[0m
[30;1m21 | [0m[35m            # expand dictionary tree[0m
[30;1m22 | [0m[35m            ref = ref.setdefault(new_key, {})[0m
[30;1m23 | [0m[35m    del data[0m
[30;1m24 | [0m[35m    return ret, True[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/expand.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m7 | [0m[35m    if not isinstance(data, dict):[0m
[30;1m8 | [0m[35m        return data, True[0m
[30;1m9 | [0m[35m    ret = {}[0m
[30;1m10 | [0m[35m    # expand match variable names to dictionary[0m
[30;1m11 | [0m[35m    for key, value in data.items():[0m
[30;1m12 | [0m[35m        ref = ret[0m
[30;1m13 | [0m[35m        keys = key.split(".")[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/expand.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mdef expand(data):[0m
[30;1m2 | [0m[35m    """[0m
[30;1m3 | [0m[35m    Function to expand dot separated match variable names[0m
[30;1m4 | [0m[35m    to nested dictionary structure[0m
[30;1m5 | [0m[35m    """[0m
[30;1m6 | [0m[35m    # do sanity check on data[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/expand.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m                if isinstance(ref, dict):[0m
[30;1m19 | [0m[35m                    ref[new_key] = value[0m
[30;1m20 | [0m[35m                break[0m
[30;1m21 | [0m[35m            # expand dictionary tree[0m
[30;1m22 | [0m[35m            ref = ref.setdefault(new_key, {})[0m
[30;1m23 | [0m[35m    del data[0m
[30;1m24 | [0m[35m    return ret, True[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/expand.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m    if not isinstance(data, dict):[0m
[30;1m8 | [0m[35m        return data, True[0m
[30;1m9 | [0m[35m    ret = {}[0m
[30;1m10 | [0m[35m    # expand match variable names to dictionary[0m
[30;1m11 | [0m[35m    for key, value in data.items():[0m
[30;1m12 | [0m[35m        ref = ret[0m
[30;1m13 | [0m[35m        keys = key.split(".")[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/expand.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mdef expand(data):[0m
[30;1m2 | [0m[35m    """[0m
[30;1m3 | [0m[35m    Function to expand dot separated match variable names[0m
[30;1m4 | [0m[35m    to nested dictionary structure[0m
[30;1m5 | [0m[35m    """[0m
[30;1m6 | [0m[35m    # do sanity check on data[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/time_funcs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mdef get_time_ns(*args, **kwargs):[0m
[30;1m25 | [0m[35m    # Return the current time in nanoseconds since the Epoch[0m
[30;1m26 | [0m[35m    return time.time_ns()[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/time_funcs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdef get_time(*args, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/file_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    else:[0m
[30;1m27 | [0m[35m        filename = "output_{}.txt".format(ctime)[0m
[30;1m28 | [0m[35m    # if no filename provided, add outputter name to filename[0m
[30;1m29 | [0m[35m    if not kwargs.get("filename", False):[0m
[30;1m30 | [0m[35m        filename = _ttp_["output_object"].name + "_" + filename[0m
[30;1m31 | [0m[35m    # check if path exists already, create it if not:[0m
[30;1m32 | [0m[35m    if not os.path.exists(url):[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/file_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m        url (str): os path there to save files[0m
[30;1m15 | [0m[35m        filename (str): name of the file[0m
[30;1m16 | [0m[35m    """[0m
[30;1m17 | [0m[35m    url = kwargs.get("url", "./Output/")[0m
[30;1m18 | [0m[35m    if "filename" in kwargs:[0m
[30;1m19 | [0m[35m        filename = kwargs["filename"][0m
[30;1m20 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/file_returner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m    file_path = os.path.join(url, filename)[0m
[30;1m36 | [0m[35m    # save excel workbook to file:[0m
[30;1m37 | [0m[35m    if hasattr(D, "save") and hasattr(D, "worksheets"):[0m
[30;1m38 | [0m[35m        log.info("output.returner_file: saving excel workbook")[0m
[30;1m39 | [0m[35m        if not file_path.endswith(".xlsx"):[0m
[30;1m40 | [0m[35m            file_path += ".xlsx"[0m
[30;1m41 | [0m[35m        D.save(file_path)[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/file_returner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35m        os.mkdir(url)[0m
[30;1m34 | [0m[35m    # form file path:[0m
[30;1m35 | [0m[35m    file_path = os.path.join(url, filename)[0m
[30;1m36 | [0m[35m    # save excel workbook to file:[0m
[30;1m37 | [0m[35m    if hasattr(D, "save") and hasattr(D, "worksheets"):[0m
[30;1m38 | [0m[35m        log.info("output.returner_file: saving excel workbook")[0m
[30;1m39 | [0m[35m        if not file_path.endswith(".xlsx"):[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/file_returner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/output/is_equal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35m        is_equal = True[0m
[30;1m9 | [0m[35m    return {[0m
[30;1m10 | [0m[35m        "output_name": _ttp_["output_object"].name,[0m
[30;1m11 | [0m[35m        "output_description": _ttp_["output_object"].attributes.get([0m
[30;1m12 | [0m[35m            "description", "None"[0m
[30;1m13 | [0m[35m        ),[0m
[30;1m14 | [0m[35m        "is_equal": is_equal,[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/exclude_val.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3 | [0m[35m    check if certain key has certain value, return False if so and True otherwise[0m
[30;1m4 | [0m[35m    """[0m
[30;1m5 | [0m[35m    # try to get value variable from parser specific variables[0m
[30;1m6 | [0m[35m    value = _ttp_["vars"].get(value, value)[0m
[30;1m7 | [0m[35m    try:[0m
[30;1m8 | [0m[35m        if data[key] == value:[0m
[30;1m9 | [0m[35m            return data, False[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/patterns/get_pattern.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mPHRASE = r"(\S+ {1})+?\S+"[0m
[30;1m2 | [0m[35mROW = r"(\S+ +)+?\S+"[0m
[30;1m3 | [0m[35mORPHRASE = r"\S+|(\S+ {1})+?\S+"[0m
[30;1m4 | [0m[35mDIGIT = r"\d+"[0m
[30;1m5 | [0m[35mIP = r"(?:[0-9]{1,3}\.){3}[0-9]{1,3}"[0m
[30;1m6 | [0m[35mPREFIX = r"(?:[0-9]{1,3}\.){3}[0-9]{1,3}/[0-9]{1,2}"[0m
[30;1m7 | [0m[35mIPV6 = r"(?:[a-fA-F0-9]{1,4}:|:){1,7}(?:[a-fA-F0-9]{1,4}|:?)"[0m
[30;1m8 | [0m[35mPREFIXV6 = r"(?:[a-fA-F0-9]{1,4}:|:){1,7}(?:[a-fA-F0-9]{1,4}|:?)/[0-9]{1,3}"[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/output/validate_cerberus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    if not HAS_LIBS:[0m
[30;1m42 | [0m[35m        return data[0m
[30;1m43 | [0m[35m    # get validation schema from template variables[0m
[30;1m44 | [0m[35m    schema_data = _ttp_["output_object"].template_obj.vars.get(schema, None)[0m
[30;1m45 | [0m[35m    if not schema_data:[0m
[30;1m46 | [0m[35m        log.error("ttp.output.validate, schema '{}' not found".format(schema))[0m
[30;1m47 | [0m[35m        return data[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/equal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m4 | [0m[35m    """[0m
[30;1m5 | [0m[35m    # try to get value variable from parser specific variables[0m
[30;1m6 | [0m[35m    value = _ttp_["vars"].get(value, value)[0m
[30;1m7 | [0m[35m    if data.get(key) != value:[0m
[30;1m8 | [0m[35m        return data, False[0m
[30;1m9 | [0m[35m    return data, None[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/equal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3 | [0m[35m    check if certain key has certain value, return true if so and false otherwise[0m
[30;1m4 | [0m[35m    """[0m
[30;1m5 | [0m[35m    # try to get value variable from parser specific variables[0m
[30;1m6 | [0m[35m    value = _ttp_["vars"].get(value, value)[0m
[30;1m7 | [0m[35m    if data.get(key) != value:[0m
[30;1m8 | [0m[35m        return data, False[0m
[30;1m9 | [0m[35m    return data, None[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/tabulate_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m    # form table - list of lists[0m
[30;1m18 | [0m[35m    table = _ttp_["formatters"]["table"](data, **kwargs)[0m
[30;1m19 | [0m[35m    headers = table.pop(0)[0m
[30;1m20 | [0m[35m    attribs = _ttp_["output_object"].attributes.get([0m
[30;1m21 | [0m[35m        "format_attributes", {"args": [], "kwargs": {}}[0m
[30;1m22 | [0m[35m    )[0m
[30;1m23 | [0m[35m    # run tabulate:[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/tabulate_formatter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m        from tabulate import tabulate[0m
[30;1m12 | [0m[35m    except ImportError:[0m
[30;1m13 | [0m[35m        log.critical([0m
[30;1m14 | [0m[35m            "output.formatter_tabulate: tabulate not installed, install: 'python -m pip install tabu[0m
[30;1m15 | [0m[35m        )[0m
[30;1m16 | [0m[35m        raise SystemExit()[0m
[30;1m17 | [0m[35m    # form table - list of lists[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/validate_cerberus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m    if not HAS_LIBS:[0m
[30;1m65 | [0m[35m        return data, None[0m
[30;1m66 | [0m[35m    # get validation schema[0m
[30;1m67 | [0m[35m    schema_data = _ttp_["vars"].get(schema, None)[0m
[30;1m68 | [0m[35m    if not schema_data:[0m
[30;1m69 | [0m[35m        log.error("ttp.validate, schema '{}' not found".format(schema))[0m
[30;1m70 | [0m[35m        return data, None[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/validate_cerberus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    if not HAS_LIBS:[0m
[30;1m26 | [0m[35m        return data, None[0m
[30;1m27 | [0m[35m    # get validation schema[0m
[30;1m28 | [0m[35m    schema_data = _ttp_["vars"].get(schema, None)[0m
[30;1m29 | [0m[35m    if not schema_data:[0m
[30;1m30 | [0m[35m        log.error("ttp.validate, schema '{}' not found".format(schema))[0m
[30;1m31 | [0m[35m        return data, None[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/to_ip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mdef to_ip(data, ip_key, mask_key):[0m
[30;1m2 | [0m[35m    """This method takes ip_key and mask_key and tries to[0m
[30;1m3 | [0m[35m    convert them into ip object[0m
[30;1m4 | [0m[35m    """[0m
[30;1m5 | [0m[35m    if ip_key in data and mask_key in data:[0m
[30;1m6 | [0m[35m        ip_string = "{}/{}".format(data[ip_key], data[mask_key])[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/output/transform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m        path = [i.strip() for i in path.split(".")][0m
[30;1m17 | [0m[35m    if isinstance(data, dict):[0m
[30;1m18 | [0m[35m        for i in path:[0m
[30;1m19 | [0m[35m            result = result[i] if strict else result.get(i, {})[0m
[30;1m20 | [0m[35m    elif isinstance(data, list):[0m
[30;1m21 | [0m[35m        result = [traverse(i, path, strict) for i in data][0m
[30;1m22 | [0m[35m    return result[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/output/transform.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mdef _set_data(data, path, new_data):[0m
[30;1m26 | [0m[35m    # not yet tested, hence not available[0m
[30;1m27 | [0m[35m    # add new_data to data at given path or override existing results[0m
[30;1m28 | [0m[35m    if isinstance(path, str):[0m
[30;1m29 | [0m[35m        path = [i.strip() for i in path.split(".")][0m
[30;1m30 | [0m[35m    last_index = len(path) - 1[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/output/transform.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mdef traverse(data, path, strict=True):[0m
[30;1m7 | [0m[35m    """Method to traverse dictionary data and return element[0m
[30;1m8 | [0m[35m    at given path.[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m    strict - if True will fail with KeyError if path item not in data[0m
[30;1m11 | [0m[35m             will return empty dict if fails to find path item in data[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/output/transform.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m    at given path.[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m    strict - if True will fail with KeyError if path item not in data[0m
[30;1m11 | [0m[35m             will return empty dict if fails to find path item in data[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    result = data[0m
[30;1m14 | [0m[35m    # need to check path, in case if standalone function use[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/csv_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m        data, **kwargs[0m
[30;1m12 | [0m[35m    )  # pylint: disable=undefined-variable[0m
[30;1m13 | [0m[35m    sep = kwargs.get("sep", ",")[0m
[30;1m14 | [0m[35m    quote = kwargs.get("quote", '"')[0m
[30;1m15 | [0m[35m    sep = "{q}{s}{q}".format(s=sep, q=quote)[0m
[30;1m16 | [0m[35m    row_formatter = "\n{q}{{}}{q}".format(q=quote)[0m
[30;1m17 | [0m[35m    # form results:[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/csv_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m    table = _ttp_["formatters"]["table"]([0m
[30;1m11 | [0m[35m        data, **kwargs[0m
[30;1m12 | [0m[35m    )  # pylint: disable=undefined-variable[0m
[30;1m13 | [0m[35m    sep = kwargs.get("sep", ",")[0m
[30;1m14 | [0m[35m    quote = kwargs.get("quote", '"')[0m
[30;1m15 | [0m[35m    sep = "{q}{s}{q}".format(s=sep, q=quote)[0m
[30;1m16 | [0m[35m    row_formatter = "\n{q}{{}}{q}".format(q=quote)[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/contains_val.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m4 | [0m[35m    """[0m
[30;1m5 | [0m[35m    # try to get value variable from parser specific variables[0m
[30;1m6 | [0m[35m    value = _ttp_["vars"].get(value, value)[0m
[30;1m7 | [0m[35m    if not value in data.get(key, ""):[0m
[30;1m8 | [0m[35m        return data, False[0m
[30;1m9 | [0m[35m    return data, None[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/contains_val.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3 | [0m[35m    check if certain key has certain value, return true if so and false otherwise[0m
[30;1m4 | [0m[35m    """[0m
[30;1m5 | [0m[35m    # try to get value variable from parser specific variables[0m
[30;1m6 | [0m[35m    value = _ttp_["vars"].get(value, value)[0m
[30;1m7 | [0m[35m    if not value in data.get(key, ""):[0m
[30;1m8 | [0m[35m        return data, False[0m
[30;1m9 | [0m[35m    return data, None[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/itemize.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m11 | [0m[35m        return data.pop(key), None[0m
[30;1m12 | [0m[35m    # use path provided[0m
[30;1m13 | [0m[35m    elif key in data and path:[0m
[30;1m14 | [0m[35m        # update path cache with current matches[0m
[30;1m15 | [0m[35m        _ttp_["results_object"].dyn_path_cache.update(data)[0m
[30;1m16 | [0m[35m        # form and check path[0m
[30;1m17 | [0m[35m        path = [i.strip() for i in path.split(".")][0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/itemize.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m        if res_path[-1].endswith("**") or not res_path[-1].endswith("*"):[0m
[30;1m7 | [0m[35m            res_path[-1] = "{}*".format(res_path[-1].rstrip("*"))[0m
[30;1m8 | [0m[35m        _ttp_["results_object"].record["PATH"] = res_path[0m
[30;1m9 | [0m[35m        # update path cache with current matches[0m
[30;1m10 | [0m[35m        _ttp_["results_object"].dyn_path_cache.update(data)[0m
[30;1m11 | [0m[35m        return data.pop(key), None[0m
[30;1m12 | [0m[35m    # use path provided[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/itemize.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2 | [0m[35m    # if no path given use group path to save results[0m
[30;1m3 | [0m[35m    if key in data and not path:[0m
[30;1m4 | [0m[35m        res_path = _ttp_["results_object"].record["PATH"][0m
[30;1m5 | [0m[35m        # modify path to have single '*' at the end[0m
[30;1m6 | [0m[35m        if res_path[-1].endswith("**") or not res_path[-1].endswith("*"):[0m
[30;1m7 | [0m[35m            res_path[-1] = "{}*".format(res_path[-1].rstrip("*"))[0m
[30;1m8 | [0m[35m        _ttp_["results_object"].record["PATH"] = res_path[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/input/commands.py[0m
   Pattern: [32m.hostname[0m
[30;1m8 | [0m[35m    if hostname:[0m
[30;1m9 | [0m[35m        for command in commands:[0m
[30;1m10 | [0m[35m            regex = r"{}[#>] *{} *\n([\S\s]+?)(?={}[#>]|$)".format([0m
[30;1m11 | [0m[35m                hostname, command, hostname[0m
[30;1m12 | [0m[35m            )[0m
[30;1m13 | [0m[35m            match = search(regex, data)[0m
[30;1m14 | [0m[35m            if match:[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/input/commands.py[0m
   Pattern: [32m.hostname[0m
[30;1m8 | [0m[35m    if hostname:[0m
[30;1m9 | [0m[35m        for command in commands:[0m
[30;1m10 | [0m[35m            regex = r"{}[#>] *{} *\n([\S\s]+?)(?={}[#>]|$)".format([0m
[30;1m11 | [0m[35m                hostname, command, hostname[0m
[30;1m12 | [0m[35m            )[0m
[30;1m13 | [0m[35m            match = search(regex, data)[0m
[30;1m14 | [0m[35m            if match:[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/input/commands.py[0m
   Pattern: [32m.hostname[0m
[30;1m5 | [0m[35m    """Input function to find commands output in the "data" text"""[0m
[30;1m6 | [0m[35m    ret = ""[0m
[30;1m7 | [0m[35m    hostname = _ttp_["variable"]["gethostname"](data, "input find_command function")[0m
[30;1m8 | [0m[35m    if hostname:[0m
[30;1m9 | [0m[35m        for command in commands:[0m
[30;1m10 | [0m[35m            regex = r"{}[#>] *{} *\n([\S\s]+?)(?={}[#>]|$)".format([0m
[30;1m11 | [0m[35m                hostname, command, hostname[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/input/commands.py[0m
   Pattern: [32m.hostname[0m
[30;1m4 | [0m[35mdef extract_commands(data, *commands):[0m
[30;1m5 | [0m[35m    """Input function to find commands output in the "data" text"""[0m
[30;1m6 | [0m[35m    ret = ""[0m
[30;1m7 | [0m[35m    hostname = _ttp_["variable"]["gethostname"](data, "input find_command function")[0m
[30;1m8 | [0m[35m    if hostname:[0m
[30;1m9 | [0m[35m        for command in commands:[0m
[30;1m10 | [0m[35m            regex = r"{}[#>] *{} *\n([\S\s]+?)(?={}[#>]|$)".format([0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/input/commands.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdef extract_commands(data, *commands):[0m
[30;1m5 | [0m[35m    """Input function to find commands output in the "data" text"""[0m
[30;1m6 | [0m[35m    ret = ""[0m
[30;1m7 | [0m[35m    hostname = _ttp_["variable"]["gethostname"](data, "input find_command function")[0m
[30;1m8 | [0m[35m    if hostname:[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/yaml_formatter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m        log = logging.getLogger(__name__)[0m
[30;1m12 | [0m[35m        log.critical([0m
[30;1m13 | [0m[35m            "output.yaml_formatter: yaml not installed, install: 'python -m pip install pyyaml'. Exi[0m
[30;1m14 | [0m[35m        )[0m
[30;1m15 | [0m[35m        raise SystemExit()[0m
[30;1m16 | [0m[35m    return dump(data, default_flow_style=False)[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/syslog_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m    facility = kwargs.get("facility", 77)[0m
[30;1m21 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m22 | [0m[35m    iterate = kwargs.get("iterate", True)[0m
[30;1m23 | [0m[35m    interval = kwargs.get("interval", 1) / 1000[0m
[30;1m24 | [0m[35m    # normalize source_data to list:[0m
[30;1m25 | [0m[35m    source_data = data if isinstance(data, list) else [data][0m
[30;1m26 | [0m[35m    # initiate isolated logger[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/syslog_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m    port = int(kwargs.get("port", 514))[0m
[30;1m20 | [0m[35m    facility = kwargs.get("facility", 77)[0m
[30;1m21 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m22 | [0m[35m    iterate = kwargs.get("iterate", True)[0m
[30;1m23 | [0m[35m    interval = kwargs.get("interval", 1) / 1000[0m
[30;1m24 | [0m[35m    # normalize source_data to list:[0m
[30;1m25 | [0m[35m    source_data = data if isinstance(data, list) else [data][0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/syslog_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m        return[0m
[30;1m19 | [0m[35m    port = int(kwargs.get("port", 514))[0m
[30;1m20 | [0m[35m    facility = kwargs.get("facility", 77)[0m
[30;1m21 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m22 | [0m[35m    iterate = kwargs.get("iterate", True)[0m
[30;1m23 | [0m[35m    interval = kwargs.get("interval", 1) / 1000[0m
[30;1m24 | [0m[35m    # normalize source_data to list:[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/syslog_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m        )[0m
[30;1m18 | [0m[35m        return[0m
[30;1m19 | [0m[35m    port = int(kwargs.get("port", 514))[0m
[30;1m20 | [0m[35m    facility = kwargs.get("facility", 77)[0m
[30;1m21 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m22 | [0m[35m    iterate = kwargs.get("iterate", True)[0m
[30;1m23 | [0m[35m    interval = kwargs.get("interval", 1) / 1000[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/syslog_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m            "ttp.returners.syslog: no syslog servers addresses found, doing nothing..."[0m
[30;1m17 | [0m[35m        )[0m
[30;1m18 | [0m[35m        return[0m
[30;1m19 | [0m[35m    port = int(kwargs.get("port", 514))[0m
[30;1m20 | [0m[35m    facility = kwargs.get("facility", 77)[0m
[30;1m21 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m22 | [0m[35m    iterate = kwargs.get("iterate", True)[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/syslog_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mdef syslog(data, **kwargs):[0m
[30;1m11 | [0m[35m    # get kwargs[0m
[30;1m12 | [0m[35m    servers = kwargs.get("servers", None)[0m
[30;1m13 | [0m[35m    servers = [servers] if isinstance(servers, str) else servers[0m
[30;1m14 | [0m[35m    if not servers:[0m
[30;1m15 | [0m[35m        log.error([0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/syslog_returner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport logging.handlers[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport traceback[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mlog = logging.getLogger(__name__)[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/terminal_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m            "False,No,Failed,Error,Failure,Fail,false,no,failed,error,failure,fail",[0m
[30;1m21 | [0m[35m        )[0m
[30;1m22 | [0m[35m        green_words = kwargs.get("green", "True,Yes,Success,Ok,true,yes,success,ok")[0m
[30;1m23 | [0m[35m        yellow_words = kwargs.get("yellow", "Warning,warning")[0m
[30;1m24 | [0m[35m        # convert colour words to lists[0m
[30;1m25 | [0m[35m        red_words = [i.strip() for i in red_words.split(",")][0m
[30;1m26 | [0m[35m        green_words = [i.strip() for i in green_words.split(",")][0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/terminal_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m            "red",[0m
[30;1m20 | [0m[35m            "False,No,Failed,Error,Failure,Fail,false,no,failed,error,failure,fail",[0m
[30;1m21 | [0m[35m        )[0m
[30;1m22 | [0m[35m        green_words = kwargs.get("green", "True,Yes,Success,Ok,true,yes,success,ok")[0m
[30;1m23 | [0m[35m        yellow_words = kwargs.get("yellow", "Warning,warning")[0m
[30;1m24 | [0m[35m        # convert colour words to lists[0m
[30;1m25 | [0m[35m        red_words = [i.strip() for i in red_words.split(",")][0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/terminal_returner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m        N = "\033[0m"  # Reset[0m
[30;1m16 | [0m[35m        fttr = "{}{}{}"  # formatter[0m
[30;1m17 | [0m[35m        # get colour words from output[0m
[30;1m18 | [0m[35m        red_words = kwargs.get([0m
[30;1m19 | [0m[35m            "red",[0m
[30;1m20 | [0m[35m            "False,No,Failed,Error,Failure,Fail,false,no,failed,error,failure,fail",[0m
[30;1m21 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/returners/terminal_returner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m        from colorama import init[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m        init()[0m
[30;1m11 | [0m[35m        R = "\033[0;31;40m"  # RED[0m
[30;1m12 | [0m[35m        G = "\033[0;32;40m"  # GREEN[0m
[30;1m13 | [0m[35m        Y = "\033[0;33;40m"  # Yellow[0m
[30;1m14 | [0m[35m        # B = "\033[0;34;40m" # Blue[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/output/validate_yangson.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m148 | [0m[35m    metadata=True,[0m
[30;1m149 | [0m[35m):[0m
[30;1m150 | [0m[35m    """[0m
[30;1m151 | [0m[35m    Validate instance_data for compliance with YANG modules at[0m
[30;1m152 | [0m[35m    yang_mod_dir directory.[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m    Args:[0m
[30;1m155 | [0m[35m        instance_data (dictionary or list): parsing results to validate[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/output/validate_yangson.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35min that case, YANG JSON library generation step will be skipped. That[0m
[30;1m14 | [0m[35mcan increase execution time.[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mYANGSON git repository tools/python/mkylib.py script can be used to generates[0m
[30;1m17 | [0m[35mYANG JSON library of YANG modules used for validation.[0m
[30;1m18 | [0m[35m"""[0m
[30;1m19 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/output/validate_yangson.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35min that case, YANG JSON library generation step will be skipped. That[0m
[30;1m14 | [0m[35mcan increase execution time.[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mYANGSON git repository tools/python/mkylib.py script can be used to generates[0m
[30;1m17 | [0m[35mYANG JSON library of YANG modules used for validation.[0m
[30;1m18 | [0m[35m"""[0m
[30;1m19 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/output/validate_yangson.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mDependencies:[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m - yangson: python -m pip install yangson; https://github.com/CZ-NIC/yangson[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mOn each call, generates YANG library data in JSON format in accordance with[0m
[30;1m9 | [0m[35mRFC7895. YANG library used to validate results structures for compatibility[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m142 | [0m[35mformat="tabulate"[0m
[30;1m143 | [0m[35mpath="bgp_peers"[0m
[30;1m144 | [0m[35mreturner="terminal"[0m
[30;1m145 | [0m[35mheaders="hostname, local_asn, vrf_name, peer_ip, peer_asn, uptime, state, description, afi, rpl_in, [0m
[30;1m146 | [0m[35m/>[0m
[30;1m147 | [0m[35m"""[0m
[30;1m148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m127 | [0m[35m    <group name="/bgp_peers*" chain="chain_1">[0m
[30;1m128 | [0m[35m    neighbor {{ peer_ip }}[0m
[30;1m129 | [0m[35m      {{ local_asn | set(asn) }}[0m
[30;1m130 | [0m[35m      {{ hostname | set(hostname) }}[0m
[30;1m131 | [0m[35m      remote-as {{ peer_asn }}[0m
[30;1m132 | [0m[35m      description {{ description }}[0m
[30;1m133 | [0m[35m      address-family {{ afi }} unicast[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m127 | [0m[35m    <group name="/bgp_peers*" chain="chain_1">[0m
[30;1m128 | [0m[35m    neighbor {{ peer_ip }}[0m
[30;1m129 | [0m[35m      {{ local_asn | set(asn) }}[0m
[30;1m130 | [0m[35m      {{ hostname | set(hostname) }}[0m
[30;1m131 | [0m[35m      remote-as {{ peer_asn }}[0m
[30;1m132 | [0m[35m      description {{ description }}[0m
[30;1m133 | [0m[35m      address-family {{ afi }} unicast[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m109 | [0m[35m</doc>[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m<vars>[0m
[30;1m112 | [0m[35mhostname="gethostname"[0m
[30;1m113 | [0m[35mchain_1 = [[0m
[30;1m114 | [0m[35m    "set('vrf_name')",[0m
[30;1m115 | [0m[35m    "lookup('peer_ip', group='bgp_state', update=True)"[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m96 | [0m[35ml bgp "local_asn" added using previous matches.[0m
[30;1m97 | [0m[35mAdditionally, group lookup function used to lookup peer state from "bgp_state"[0m
[30;1m98 | [0m[35mgroup results, adding found data to peer results.[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mFinally, "bgp_peers" section of results passed via "tabulate_outputter" to[0m
[30;1m101 | [0m[35mfrom and print this table to terminal:[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35mhostname           local_asn    vrf_name    peer_ip    peer_asn    uptime    state    description   [0m
[30;1m104 | [0m[35m-----------------  -----------  ----------  ---------  ----------  --------  -------  ------------- [0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m93 | [0m[35m"/bgp_peers*" with path formatter to produce a list of peers under "bgp_peers"[0m
[30;1m94 | [0m[35mpath.[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mFor each peer "hostname" and local bgp "local_asn" added using previous matches.[0m
[30;1m97 | [0m[35mAdditionally, group lookup function used to lookup peer state from "bgp_state"[0m
[30;1m98 | [0m[35mgroup results, adding found data to peer results.[0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m## Example - a bit more complicated[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35mFor this example lets say we want to parse BGP peerings output, but combine state with configuration[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m<details><summary>Code</summary>[0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35mucs-core-switch-1  65100        CUST-1      192.0.2.1  65101       00:12:33  300      peer-1        [0m
[30;1m106 | [0m[35mucs-core-switch-1  65100        CUST-1      192.0.2.2  65102       03:55:01  idle     peer-2        [0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mRun this script with "python filename.py"[0m
[30;1m109 | [0m[35m</doc>[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m<vars>[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35mtemplate="""[0m
[30;1m87 | [0m[35m<doc>[0m
[30;1m88 | [0m[35mThis template first parses "show bgp vrf CUST-1 vpnv4 unicast summary" commands[0m
[30;1m89 | [0m[35moutput, forming results for "bgp_state" dictionary, where peer ip is a key.[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35mFollowing that, "show run | section bgp" output parsed by group "bgp_cfg". That[0m
[30;1m92 | [0m[35mgroup uses nested groups to form results structure, including absolute path[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35minterface {{ interface }}[0m
[30;1m57 | [0m[35m ip address {{ ip }}/{{ mask }}[0m
[30;1m58 | [0m[35m description {{ description }}[0m
[30;1m59 | [0m[35m ip vrf {{ vrf }}[0m
[30;1m60 | [0m[35m"""[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mparser = ttp(data, template)[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35mtemplate = """[0m
[30;1m56 | [0m[35minterface {{ interface }}[0m
[30;1m57 | [0m[35m ip address {{ ip }}/{{ mask }}[0m
[30;1m58 | [0m[35m description {{ description }}[0m
[30;1m59 | [0m[35m ip vrf {{ vrf }}[0m
[30;1m60 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35mtemplate = """[0m
[30;1m56 | [0m[35minterface {{ interface }}[0m
[30;1m57 | [0m[35m ip address {{ ip }}/{{ mask }}[0m
[30;1m58 | [0m[35m description {{ description }}[0m
[30;1m59 | [0m[35m ip vrf {{ vrf }}[0m
[30;1m60 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35minterface Vlan778[0m
[30;1m49 | [0m[35m description CPE_Acces_Vlan[0m
[30;1m50 | [0m[35m ip address 2002::fd37/124[0m
[30;1m51 | [0m[35m ip vrf CPE1[0m
[30;1m52 | [0m[35m![0m
[30;1m53 | [0m[35m"""[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m![0m
[30;1m48 | [0m[35minterface Vlan778[0m
[30;1m49 | [0m[35m description CPE_Acces_Vlan[0m
[30;1m50 | [0m[35m ip address 2002::fd37/124[0m
[30;1m51 | [0m[35m ip vrf CPE1[0m
[30;1m52 | [0m[35m![0m
[30;1m53 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35mdata = """[0m
[30;1m44 | [0m[35minterface Loopback0[0m
[30;1m45 | [0m[35m description Router-id-loopback[0m
[30;1m46 | [0m[35m ip address 192.168.0.113/24[0m
[30;1m47 | [0m[35m![0m
[30;1m48 | [0m[35minterface Vlan778[0m
[30;1m49 | [0m[35m description CPE_Acces_Vlan[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m## What?[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mIn essence TTP can help to:[0m
[30;1m20 | [0m[35m  - Prepare, sort and load text data for parsing[0m
[30;1m21 | [0m[35m  - Parse text using regexes dynamically derived out of templates[0m
[30;1m22 | [0m[35m  - Process matches on the fly using broad set of built-in or custom functions[0m
[30;1m23 | [0m[35m  - Combine match results in a structure with arbitrary hierarchy[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m## Why?[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mTo save ones time on transforming raw text into structured data and beyond.[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m## How?[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/lookup/geoip2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m    HAS_LIBS = True[0m
[30;1m9 | [0m[35mexcept ImportError:[0m
[30;1m10 | [0m[35m    log.error([0m
[30;1m11 | [0m[35m        "ttp.lookup.geoip2: failed to import geoip2 library, install: pip install geoip2"[0m
[30;1m12 | [0m[35m    )[0m
[30;1m13 | [0m[35m    HAS_LIBS = False[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m            "headers": headers,[0m
[30;1m50 | [0m[35m            "missing": tab_det.get("missing", ""),[0m
[30;1m51 | [0m[35m            "key": tab_det.get("key", ""),[0m
[30;1m52 | [0m[35m            "strict": tab_det.get("strict", True),[0m
[30;1m53 | [0m[35m        }[0m
[30;1m54 | [0m[35m        # form tab table[0m
[30;1m55 | [0m[35m        tab_table_data = _ttp_["formatters"]["table"](data, **tab_kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m            "path": [i.strip() for i in tab_det.get("path", "").split(".")],[0m
[30;1m49 | [0m[35m            "headers": headers,[0m
[30;1m50 | [0m[35m            "missing": tab_det.get("missing", ""),[0m
[30;1m51 | [0m[35m            "key": tab_det.get("key", ""),[0m
[30;1m52 | [0m[35m            "strict": tab_det.get("strict", True),[0m
[30;1m53 | [0m[35m        }[0m
[30;1m54 | [0m[35m        # form tab table[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m        tab_kwargs = {[0m
[30;1m48 | [0m[35m            "path": [i.strip() for i in tab_det.get("path", "").split(".")],[0m
[30;1m49 | [0m[35m            "headers": headers,[0m
[30;1m50 | [0m[35m            "missing": tab_det.get("missing", ""),[0m
[30;1m51 | [0m[35m            "key": tab_det.get("key", ""),[0m
[30;1m52 | [0m[35m            "strict": tab_det.get("strict", True),[0m
[30;1m53 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m            headers = [i.strip() for i in headers.split(",")][0m
[30;1m46 | [0m[35m        # get attributes out of tab_det[0m
[30;1m47 | [0m[35m        tab_kwargs = {[0m
[30;1m48 | [0m[35m            "path": [i.strip() for i in tab_det.get("path", "").split(".")],[0m
[30;1m49 | [0m[35m            "headers": headers,[0m
[30;1m50 | [0m[35m            "missing": tab_det.get("missing", ""),[0m
[30;1m51 | [0m[35m            "key": tab_det.get("key", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m            if "tab_name" in tab_det[0m
[30;1m41 | [0m[35m            else "Sheet{}".format(index)[0m
[30;1m42 | [0m[35m        )[0m
[30;1m43 | [0m[35m        headers = tab_det.get("headers", None)[0m
[30;1m44 | [0m[35m        if isinstance(headers, str):[0m
[30;1m45 | [0m[35m            headers = [i.strip() for i in headers.split(",")][0m
[30;1m46 | [0m[35m        # get attributes out of tab_det[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    url = kwargs.get("url", "./Output/")[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    # from filename[0m
[30;1m31 | [0m[35m    filename = kwargs.get("filename")[0m
[30;1m32 | [0m[35m    if not filename.endswith(".xlsx"):[0m
[30;1m33 | [0m[35m        filename = "{}.xlsx".format(filename)[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        )[0m
[30;1m26 | [0m[35m        raise SystemExit()[0m
[30;1m27 | [0m[35m    update = kwargs.get("update")[0m
[30;1m28 | [0m[35m    url = kwargs.get("url", "./Output/")[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    # from filename[0m
[30;1m31 | [0m[35m    filename = kwargs.get("filename")[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m            "output.formatter_excel: output tag missing table definition. Exiting"[0m
[30;1m25 | [0m[35m        )[0m
[30;1m26 | [0m[35m        raise SystemExit()[0m
[30;1m27 | [0m[35m    update = kwargs.get("update")[0m
[30;1m28 | [0m[35m    url = kwargs.get("url", "./Output/")[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    # from filename[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m56 | [0m[35m        table_tabs.append({"name": tab_name, "data": tab_table_data})[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    # check if need to load existing workbook[0m
[30;1m59 | [0m[35m    if update and os.path.exists(os.path.join(url, filename)):[0m
[30;1m60 | [0m[35m        wb = load_workbook(os.path.join(url, filename))[0m
[30;1m61 | [0m[35m    # create workbook[0m
[30;1m62 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m            "output.formatter_excel: output tag missing table definition. Exiting"[0m
[30;1m25 | [0m[35m        )[0m
[30;1m26 | [0m[35m        raise SystemExit()[0m
[30;1m27 | [0m[35m    update = kwargs.get("update")[0m
[30;1m28 | [0m[35m    url = kwargs.get("url", "./Output/")[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    # from filename[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/excel_formatter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m    from openpyxl import Workbook, load_workbook[0m
[30;1m8 | [0m[35mexcept ImportError:[0m
[30;1m9 | [0m[35m    log.critical([0m
[30;1m10 | [0m[35m        "output.formatter_excel: openpyxl not installed, install: 'python -m pip install openpyxl'. [0m
[30;1m11 | [0m[35m    )[0m
[30;1m12 | [0m[35m    raise SystemExit()[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m40 | [0m[35m            hostname_match = match.group(1)[0m
[30;1m41 | [0m[35m            for i in UTF_BOM:[0m
[30;1m42 | [0m[35m                hostname_match = hostname_match.lstrip(i)[0m
[30;1m43 | [0m[35m            return hostname_match[0m
[30;1m44 | [0m[35m        except StopIteration:[0m
[30;1m45 | [0m[35m            continue[0m
[30;1m46 | [0m[35m    log.error([0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m39 | [0m[35m            match = next(match_iter)[0m
[30;1m40 | [0m[35m            hostname_match = match.group(1)[0m
[30;1m41 | [0m[35m            for i in UTF_BOM:[0m
[30;1m42 | [0m[35m                hostname_match = hostname_match.lstrip(i)[0m
[30;1m43 | [0m[35m            return hostname_match[0m
[30;1m44 | [0m[35m        except StopIteration:[0m
[30;1m45 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m39 | [0m[35m            match = next(match_iter)[0m
[30;1m40 | [0m[35m            hostname_match = match.group(1)[0m
[30;1m41 | [0m[35m            for i in UTF_BOM:[0m
[30;1m42 | [0m[35m                hostname_match = hostname_match.lstrip(i)[0m
[30;1m43 | [0m[35m            return hostname_match[0m
[30;1m44 | [0m[35m        except StopIteration:[0m
[30;1m45 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m37 | [0m[35m        match_iter = finditer(regex, data)[0m
[30;1m38 | [0m[35m        try:[0m
[30;1m39 | [0m[35m            match = next(match_iter)[0m
[30;1m40 | [0m[35m            hostname_match = match.group(1)[0m
[30;1m41 | [0m[35m            for i in UTF_BOM:[0m
[30;1m42 | [0m[35m                hostname_match = hostname_match.lstrip(i)[0m
[30;1m43 | [0m[35m            return hostname_match[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m31 | [0m[35m        "ÿþ",[0m
[30;1m32 | [0m[35m        "\ufeff",[0m
[30;1m33 | [0m[35m    ]  # byte order marks (BOM) to strip from beginning[0m
[30;1m34 | [0m[35m    # of the hostname, some text files can have them[0m
[30;1m35 | [0m[35m    for item in REs:[0m
[30;1m36 | [0m[35m        name, regex = list(item.items())[0][0m
[30;1m37 | [0m[35m        match_iter = finditer(regex, data)[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m23 | [0m[35m        {"ios_exec": r"\n(\S+)>.*(?=\n)"},  # e.g. 'hostname>'[0m
[30;1m24 | [0m[35m        {[0m
[30;1m25 | [0m[35m            "fortigate": r"\n(\S+ \(\S+\)) #.*(?=\n)"[0m
[30;1m26 | [0m[35m        },  # e.g. 'forti-hostname (Default) #'[0m
[30;1m27 | [0m[35m    ][0m
[30;1m28 | [0m[35m    UTF_BOM = [[0m
[30;1m29 | [0m[35m        "ï»¿",[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m20 | [0m[35m        {"ios_priv": r"\n(\S+)#.*(?=\n)"},  # e.g. 'hostname#'[0m
[30;1m21 | [0m[35m        {"juniper": r"\n\S*@(\S+)>.*(?=\n)"},  # e.g. 'some.user@router-fw-host>'[0m
[30;1m22 | [0m[35m        {"huawei": r"\n<(\S+)>.*(?=\n)"},  # e.g. '<hostname>'[0m
[30;1m23 | [0m[35m        {"ios_exec": r"\n(\S+)>.*(?=\n)"},  # e.g. 'hostname>'[0m
[30;1m24 | [0m[35m        {[0m
[30;1m25 | [0m[35m            "fortigate": r"\n(\S+ \(\S+\)) #.*(?=\n)"[0m
[30;1m26 | [0m[35m        },  # e.g. 'forti-hostname (Default) #'[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m19 | [0m[35m        {"ios_xr": r"\n\S+:(\S+)#.*(?=\n)"},  # e.g. 'RP/0/4/CPU0:hostname#'[0m
[30;1m20 | [0m[35m        {"ios_priv": r"\n(\S+)#.*(?=\n)"},  # e.g. 'hostname#'[0m
[30;1m21 | [0m[35m        {"juniper": r"\n\S*@(\S+)>.*(?=\n)"},  # e.g. 'some.user@router-fw-host>'[0m
[30;1m22 | [0m[35m        {"huawei": r"\n<(\S+)>.*(?=\n)"},  # e.g. '<hostname>'[0m
[30;1m23 | [0m[35m        {"ios_exec": r"\n(\S+)>.*(?=\n)"},  # e.g. 'hostname>'[0m
[30;1m24 | [0m[35m        {[0m
[30;1m25 | [0m[35m            "fortigate": r"\n(\S+ \(\S+\)) #.*(?=\n)"[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m17 | [0m[35m        # 'A:ALA-12>config>system#', '*A:ALA-12>config>system#'[0m
[30;1m18 | [0m[35m        # ios-xr prompt re must go before ios privilege prompt re[0m
[30;1m19 | [0m[35m        {"ios_xr": r"\n\S+:(\S+)#.*(?=\n)"},  # e.g. 'RP/0/4/CPU0:hostname#'[0m
[30;1m20 | [0m[35m        {"ios_priv": r"\n(\S+)#.*(?=\n)"},  # e.g. 'hostname#'[0m
[30;1m21 | [0m[35m        {"juniper": r"\n\S*@(\S+)>.*(?=\n)"},  # e.g. 'some.user@router-fw-host>'[0m
[30;1m22 | [0m[35m        {"huawei": r"\n<(\S+)>.*(?=\n)"},  # e.g. '<hostname>'[0m
[30;1m23 | [0m[35m        {"ios_exec": r"\n(\S+)>.*(?=\n)"},  # e.g. 'hostname>'[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m16 | [0m[35m        },  # e.g. 'A:hostname>', '*A:hostname>', 'A:hostname#', '*A:hostname#',[0m
[30;1m17 | [0m[35m        # 'A:ALA-12>config>system#', '*A:ALA-12>config>system#'[0m
[30;1m18 | [0m[35m        # ios-xr prompt re must go before ios privilege prompt re[0m
[30;1m19 | [0m[35m        {"ios_xr": r"\n\S+:(\S+)#.*(?=\n)"},  # e.g. 'RP/0/4/CPU0:hostname#'[0m
[30;1m20 | [0m[35m        {"ios_priv": r"\n(\S+)#.*(?=\n)"},  # e.g. 'hostname#'[0m
[30;1m21 | [0m[35m        {"juniper": r"\n\S*@(\S+)>.*(?=\n)"},  # e.g. 'some.user@router-fw-host>'[0m
[30;1m22 | [0m[35m        {"huawei": r"\n<(\S+)>.*(?=\n)"},  # e.g. '<hostname>'[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m13 | [0m[35m    REs = [[0m
[30;1m14 | [0m[35m        {[0m
[30;1m15 | [0m[35m            "alu_sros": r"\n\S{1,2}:(\S+?)[>#].*(?=\n)"[0m
[30;1m16 | [0m[35m        },  # e.g. 'A:hostname>', '*A:hostname>', 'A:hostname#', '*A:hostname#',[0m
[30;1m17 | [0m[35m        # 'A:ALA-12>config>system#', '*A:ALA-12>config>system#'[0m
[30;1m18 | [0m[35m        # ios-xr prompt re must go before ios privilege prompt re[0m
[30;1m19 | [0m[35m        {"ios_xr": r"\n\S+:(\S+)#.*(?=\n)"},  # e.g. 'RP/0/4/CPU0:hostname#'[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m13 | [0m[35m    REs = [[0m
[30;1m14 | [0m[35m        {[0m
[30;1m15 | [0m[35m            "alu_sros": r"\n\S{1,2}:(\S+?)[>#].*(?=\n)"[0m
[30;1m16 | [0m[35m        },  # e.g. 'A:hostname>', '*A:hostname>', 'A:hostname#', '*A:hostname#',[0m
[30;1m17 | [0m[35m        # 'A:ALA-12>config>system#', '*A:ALA-12>config>system#'[0m
[30;1m18 | [0m[35m        # ios-xr prompt re must go before ios privilege prompt re[0m
[30;1m19 | [0m[35m        {"ios_xr": r"\n\S+:(\S+)#.*(?=\n)"},  # e.g. 'RP/0/4/CPU0:hostname#'[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m13 | [0m[35m    REs = [[0m
[30;1m14 | [0m[35m        {[0m
[30;1m15 | [0m[35m            "alu_sros": r"\n\S{1,2}:(\S+?)[>#].*(?=\n)"[0m
[30;1m16 | [0m[35m        },  # e.g. 'A:hostname>', '*A:hostname>', 'A:hostname#', '*A:hostname#',[0m
[30;1m17 | [0m[35m        # 'A:ALA-12>config>system#', '*A:ALA-12>config>system#'[0m
[30;1m18 | [0m[35m        # ios-xr prompt re must go before ios privilege prompt re[0m
[30;1m19 | [0m[35m        {"ios_xr": r"\n\S+:(\S+)#.*(?=\n)"},  # e.g. 'RP/0/4/CPU0:hostname#'[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m13 | [0m[35m    REs = [[0m
[30;1m14 | [0m[35m        {[0m
[30;1m15 | [0m[35m            "alu_sros": r"\n\S{1,2}:(\S+?)[>#].*(?=\n)"[0m
[30;1m16 | [0m[35m        },  # e.g. 'A:hostname>', '*A:hostname>', 'A:hostname#', '*A:hostname#',[0m
[30;1m17 | [0m[35m        # 'A:ALA-12>config>system#', '*A:ALA-12>config>system#'[0m
[30;1m18 | [0m[35m        # ios-xr prompt re must go before ios privilege prompt re[0m
[30;1m19 | [0m[35m        {"ios_xr": r"\n\S+:(\S+)#.*(?=\n)"},  # e.g. 'RP/0/4/CPU0:hostname#'[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mdef gethostname(data, *args, **kwargs):[0m
[30;1m10 | [0m[35m    """Description: Method to find hostname in show[0m
[30;1m11 | [0m[35m    command output, uses symbols '# ', '<', '>' to find hostname[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    REs = [[0m
[30;1m14 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m.hostname[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mdef gethostname(data, *args, **kwargs):[0m
[30;1m10 | [0m[35m    """Description: Method to find hostname in show[0m
[30;1m11 | [0m[35m    command output, uses symbols '# ', '<', '>' to find hostname[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    REs = [[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mdef gethostname(data, *args, **kwargs):[0m
[30;1m10 | [0m[35m    """Description: Method to find hostname in show[0m
[30;1m11 | [0m[35m    command output, uses symbols '# ', '<', '>' to find hostname[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    REs = [[0m
[30;1m14 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/variable/gethostname.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mdef gethostname(data, *args, **kwargs):[0m
[30;1m10 | [0m[35m    """Description: Method to find hostname in show[0m
[30;1m11 | [0m[35m    command output, uses symbols '# ', '<', '>' to find hostname[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    REs = [[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/n2g_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m    node_dups = kwargs.get("node_duplicates", "skip")[0m
[30;1m12 | [0m[35m    link_dups = kwargs.get("link_duplicates", "skip")[0m
[30;1m13 | [0m[35m    method_kwargs = kwargs.get("method_kwargs", {})[0m
[30;1m14 | [0m[35m    algo = kwargs.get("algo", None)[0m
[30;1m15 | [0m[35m    # import N2G library[0m
[30;1m16 | [0m[35m    try:[0m
[30;1m17 | [0m[35m        if module.lower() == "yed":[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/n2g_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m11 | [0m[35m    node_dups = kwargs.get("node_duplicates", "skip")[0m
[30;1m12 | [0m[35m    link_dups = kwargs.get("link_duplicates", "skip")[0m
[30;1m13 | [0m[35m    method_kwargs = kwargs.get("method_kwargs", {})[0m
[30;1m14 | [0m[35m    algo = kwargs.get("algo", None)[0m
[30;1m15 | [0m[35m    # import N2G library[0m
[30;1m16 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/n2g_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m    method = kwargs.get("method", "from_list")[0m
[30;1m10 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m11 | [0m[35m    node_dups = kwargs.get("node_duplicates", "skip")[0m
[30;1m12 | [0m[35m    link_dups = kwargs.get("link_duplicates", "skip")[0m
[30;1m13 | [0m[35m    method_kwargs = kwargs.get("method_kwargs", {})[0m
[30;1m14 | [0m[35m    algo = kwargs.get("algo", None)[0m
[30;1m15 | [0m[35m    # import N2G library[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/n2g_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35m    module = kwargs.get("module", "yed")[0m
[30;1m9 | [0m[35m    method = kwargs.get("method", "from_list")[0m
[30;1m10 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m11 | [0m[35m    node_dups = kwargs.get("node_duplicates", "skip")[0m
[30;1m12 | [0m[35m    link_dups = kwargs.get("link_duplicates", "skip")[0m
[30;1m13 | [0m[35m    method_kwargs = kwargs.get("method_kwargs", {})[0m
[30;1m14 | [0m[35m    algo = kwargs.get("algo", None)[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/n2g_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m7 | [0m[35m    # load kwargs[0m
[30;1m8 | [0m[35m    module = kwargs.get("module", "yed")[0m
[30;1m9 | [0m[35m    method = kwargs.get("method", "from_list")[0m
[30;1m10 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m11 | [0m[35m    node_dups = kwargs.get("node_duplicates", "skip")[0m
[30;1m12 | [0m[35m    link_dups = kwargs.get("link_duplicates", "skip")[0m
[30;1m13 | [0m[35m    method_kwargs = kwargs.get("method_kwargs", {})[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/n2g_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m6 | [0m[35mdef n2g(data, **kwargs):[0m
[30;1m7 | [0m[35m    # load kwargs[0m
[30;1m8 | [0m[35m    module = kwargs.get("module", "yed")[0m
[30;1m9 | [0m[35m    method = kwargs.get("method", "from_list")[0m
[30;1m10 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m11 | [0m[35m    node_dups = kwargs.get("node_duplicates", "skip")[0m
[30;1m12 | [0m[35m    link_dups = kwargs.get("link_duplicates", "skip")[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/formatters/n2g_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mdef n2g(data, **kwargs):[0m
[30;1m7 | [0m[35m    # load kwargs[0m
[30;1m8 | [0m[35m    module = kwargs.get("module", "yed")[0m
[30;1m9 | [0m[35m    method = kwargs.get("method", "from_list")[0m
[30;1m10 | [0m[35m    path = kwargs.get("path", [])[0m
[30;1m11 | [0m[35m    node_dups = kwargs.get("node_duplicates", "skip")[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/lookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m    try:[0m
[30;1m82 | [0m[35m        lookup_data = _ttp_["parser_object"].lookups[0m
[30;1m83 | [0m[35m        for i in path:[0m
[30;1m84 | [0m[35m            lookup_data = lookup_data.get(i, {})[0m
[30;1m85 | [0m[35m    except KeyError:[0m
[30;1m86 | [0m[35m        log.error("gpvlookup: lookup data not found")[0m
[30;1m87 | [0m[35m        return data, None[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/lookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m    try:[0m
[30;1m56 | [0m[35m        rlookup = _ttp_["parser_object"].lookups[0m
[30;1m57 | [0m[35m        for i in path:[0m
[30;1m58 | [0m[35m            rlookup = rlookup.get(i, {})[0m
[30;1m59 | [0m[35m    except KeyError:[0m
[30;1m60 | [0m[35m        return data, None[0m
[30;1m61 | [0m[35m    # perfrom rlookup:[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/lookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m        log.info("ttp.lookup no lookup data name provided, doing nothing.")[0m
[30;1m36 | [0m[35m        return data, None[0m
[30;1m37 | [0m[35m    for i in path:[0m
[30;1m38 | [0m[35m        lookup_data = lookup_data.get(i, {})[0m
[30;1m39 | [0m[35m    # perform lookup:[0m
[30;1m40 | [0m[35m    try:[0m
[30;1m41 | [0m[35m        found_value = lookup_data[data][0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/lookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35m    # import library[0m
[30;1m95 | [0m[35m    from fnmatch import fnmatch[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    # find first match and stop[0m
[30;1m98 | [0m[35m    if multimatch is False:[0m
[30;1m99 | [0m[35m        for key, patterns in lookup_data.items():[0m
[30;1m100 | [0m[35m            for pattern in patterns:[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/lookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m        return data, None[0m
[30;1m51 | [0m[35m    # traverse to lookup data[0m
[30;1m52 | [0m[35m    for i in path:[0m
[30;1m53 | [0m[35m        lookup_data = lookup_data.get(i, {})[0m
[30;1m54 | [0m[35m    # perform lookup:[0m
[30;1m55 | [0m[35m    try:[0m
[30;1m56 | [0m[35m        if isinstance(lookup_data, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/lookup.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m63 | [0m[35m            data[add_field] = found_value[0m
[30;1m64 | [0m[35m        except:[0m
[30;1m65 | [0m[35m            log.error("ttp.group.lookup failed to add new field '{}'".format(add_field))[0m
[30;1m66 | [0m[35m    elif update is True and isinstance(found_value, dict):[0m
[30;1m67 | [0m[35m        data.update(found_value)[0m
[30;1m68 | [0m[35m    elif replace:[0m
[30;1m69 | [0m[35m        data[key] = found_value[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/group/lookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m        # look for group that parses same input[0m
[30;1m39 | [0m[35m        if path[0] in _ttp_["parser_object"].main_results:[0m
[30;1m40 | [0m[35m            lookup_data = _ttp_["parser_object"].main_results[path[0]][0m
[30;1m41 | [0m[35m        # try to find results for group that parsed different input[0m
[30;1m42 | [0m[35m        else:[0m
[30;1m43 | [0m[35m            for result in _ttp_["template_obj"].results:[0m
[30;1m44 | [0m[35m                if path[0] in result:[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/dns_lookups.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m        if isinstance(servers, str):[0m
[30;1m43 | [0m[35m            servers = [i.strip() for i in servers.split(",")][0m
[30;1m44 | [0m[35m        dns_resolver_obj.nameservers = servers[0m
[30;1m45 | [0m[35m    dns_resolver_obj.lifetime = timeout * len(dns_resolver_obj.nameservers)[0m
[30;1m46 | [0m[35m    rev_name = dns.reversename.from_address(data)[0m
[30;1m47 | [0m[35m    try:[0m
[30;1m48 | [0m[35m        reverse_record = str(dns_resolver_obj.query(rev_name, "PTR")[0]).rstrip(".")[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/dns_lookups.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    data - ip address string, e.g. 192.168.0.1[0m
[30;1m38 | [0m[35m    """[0m
[30;1m39 | [0m[35m    servers = servers or [][0m
[30;1m40 | [0m[35m    dns_resolver_obj.timeout = timeout[0m
[30;1m41 | [0m[35m    if servers:[0m
[30;1m42 | [0m[35m        if isinstance(servers, str):[0m
[30;1m43 | [0m[35m            servers = [i.strip() for i in servers.split(",")][0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/dns_lookups.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef dns_reverse(data, timeout=1, servers=None, add_field=False):[0m
[30;1m36 | [0m[35m    """Performs reverse dns lookup using global dns_resolver_obj[0m
[30;1m37 | [0m[35m    data - ip address string, e.g. 192.168.0.1[0m
[30;1m38 | [0m[35m    """[0m
[30;1m39 | [0m[35m    servers = servers or [][0m
[30;1m40 | [0m[35m    dns_resolver_obj.timeout = timeout[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/dns_lookups.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m        if isinstance(servers, str):[0m
[30;1m15 | [0m[35m            servers = [i.strip() for i in servers.split(",")][0m
[30;1m16 | [0m[35m        dns_resolver_obj.nameservers = sorted(servers)[0m
[30;1m17 | [0m[35m    dns_resolver_obj.lifetime = timeout * len(dns_resolver_obj.nameservers)[0m
[30;1m18 | [0m[35m    try:[0m
[30;1m19 | [0m[35m        dns_records = [i.to_text() for i in dns_resolver_obj.query(data, record)][0m
[30;1m20 | [0m[35m        if add_field and isinstance(add_field, str):[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/dns_lookups.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mdef dns_forward(data, record="A", timeout=1, servers=None, add_field=False):[0m
[30;1m10 | [0m[35m    """Performs forward dns lookup using dns_resolver_obj global object"""[0m
[30;1m11 | [0m[35m    servers = servers or [][0m
[30;1m12 | [0m[35m    dns_resolver_obj.timeout = timeout[0m
[30;1m13 | [0m[35m    if servers:[0m
[30;1m14 | [0m[35m        if isinstance(servers, str):[0m
[30;1m15 | [0m[35m            servers = [i.strip() for i in servers.split(",")][0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/item.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mdef item(data, item_index):[0m
[30;1m2 | [0m[35m    """Method to return item of iterable at given index"""[0m
[30;1m3 | [0m[35m    item_index = int(item_index)[0m
[30;1m4 | [0m[35m    # item_index not out of range[0m
[30;1m5 | [0m[35m    if 0 <= item_index and item_index <= len(data) - 1:[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/string.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m    # try to get char from global variables[0m
[30;1m77 | [0m[35m    char_value = _ttp_["global_vars"].get(char, char)[0m
[30;1m78 | [0m[35m    # try to get from input specific variables[0m
[30;1m79 | [0m[35m    char_value = _ttp_["vars"].get(char, char)[0m
[30;1m80 | [0m[35m    if isinstance(data, str):[0m
[30;1m81 | [0m[35m        return (char_value + data), None[0m
[30;1m82 | [0m[35m    elif isinstance(data, list):[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/string.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35mdef prepend(data, char):[0m
[30;1m76 | [0m[35m    # try to get char from global variables[0m
[30;1m77 | [0m[35m    char_value = _ttp_["global_vars"].get(char, char)[0m
[30;1m78 | [0m[35m    # try to get from input specific variables[0m
[30;1m79 | [0m[35m    char_value = _ttp_["vars"].get(char, char)[0m
[30;1m80 | [0m[35m    if isinstance(data, str):[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/string.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m    # try to get char from global variables[0m
[30;1m63 | [0m[35m    char_value = _ttp_["global_vars"].get(char, char)[0m
[30;1m64 | [0m[35m    # try to get from input specific variables[0m
[30;1m65 | [0m[35m    char_value = _ttp_["vars"].get(char, char)[0m
[30;1m66 | [0m[35m    if isinstance(data, str):[0m
[30;1m67 | [0m[35m        return (data + char_value), None[0m
[30;1m68 | [0m[35m    elif isinstance(data, list):[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/string.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35mdef append(data, char):[0m
[30;1m62 | [0m[35m    # try to get char from global variables[0m
[30;1m63 | [0m[35m    char_value = _ttp_["global_vars"].get(char, char)[0m
[30;1m64 | [0m[35m    # try to get from input specific variables[0m
[30;1m65 | [0m[35m    char_value = _ttp_["vars"].get(char, char)[0m
[30;1m66 | [0m[35m    if isinstance(data, str):[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/ip.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35mdef cidr_match(data, prefix):[0m
[30;1m122 | [0m[35m    # try to get value from TTP vars variables[0m
[30;1m123 | [0m[35m    prefix = _ttp_["vars"].get(prefix, prefix)[0m
[30;1m124 | [0m[35m    # convert data to ipaddress object:[0m
[30;1m125 | [0m[35m    if isinstance(data, str):[0m
[30;1m126 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/uptimeparse.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mdef uptimeparse(data, format="seconds"):[0m
[30;1m53 | [0m[35m    """[0m
[30;1m54 | [0m[35m    Parse a time expression like:[0m
[30;1m55 | [0m[35m    2 years, 27 weeks, 3 days, 10 hours, 46 minutes[0m
[30;1m56 | [0m[35m    27 weeks, 3 days, 10 hours, 48 minutes[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/uptimeparse.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mThis function took most of the code from 'parsetime' python library:[0m
[30;1m4 | [0m[35mhttps://pypi.org/project/python-parsetime/[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mbut code was stripped to provide matching for required time formats only[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport re[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/geoip_lookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m                "city": found_value.city.name,[0m
[30;1m38 | [0m[35m                "continent": found_value.continent.names.get("en", ""),[0m
[30;1m39 | [0m[35m                "country_iso_code": found_value.country.iso_code,[0m
[30;1m40 | [0m[35m                "country": found_value.country.names.get("en", ""),[0m
[30;1m41 | [0m[35m                "latitude": found_value.location.latitude,[0m
[30;1m42 | [0m[35m                "longitude": found_value.location.longitude,[0m
[30;1m43 | [0m[35m                "accuracy_radius": found_value.location.accuracy_radius,[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/geoip_lookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m            found_value = lookup_data.city(data)[0m
[30;1m36 | [0m[35m            found_value = {[0m
[30;1m37 | [0m[35m                "city": found_value.city.name,[0m
[30;1m38 | [0m[35m                "continent": found_value.continent.names.get("en", ""),[0m
[30;1m39 | [0m[35m                "country_iso_code": found_value.country.iso_code,[0m
[30;1m40 | [0m[35m                "country": found_value.country.names.get("en", ""),[0m
[30;1m41 | [0m[35m                "latitude": found_value.location.latitude,[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/geoip_lookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m                "continent": found_value.continent.names.get("en", ""),[0m
[30;1m21 | [0m[35m                "continent_code": found_value.continent.code,[0m
[30;1m22 | [0m[35m                "country_iso_code": found_value.country.iso_code,[0m
[30;1m23 | [0m[35m                "country": found_value.country.names.get("en", ""),[0m
[30;1m24 | [0m[35m                "network": found_value.traits.network.with_prefixlen,[0m
[30;1m25 | [0m[35m            }[0m
[30;1m26 | [0m[35m        except:[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/geoip_lookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m        try:[0m
[30;1m18 | [0m[35m            found_value = lookup_data.country(data)[0m
[30;1m19 | [0m[35m            found_value = {[0m
[30;1m20 | [0m[35m                "continent": found_value.continent.names.get("en", ""),[0m
[30;1m21 | [0m[35m                "continent_code": found_value.continent.code,[0m
[30;1m22 | [0m[35m                "country_iso_code": found_value.country.iso_code,[0m
[30;1m23 | [0m[35m                "country": found_value.country.names.get("en", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/geoip_lookup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35m    path = [i.strip() for i in db_name.split(".")][0m
[30;1m9 | [0m[35m    # get reference to geoip2 reader object[0m
[30;1m10 | [0m[35m    for i in path:[0m
[30;1m11 | [0m[35m        lookup_data = lookup_data.get(i, {})[0m
[30;1m12 | [0m[35m    if not lookup_data:[0m
[30;1m13 | [0m[35m        return data, None[0m
[30;1m14 | [0m[35m    found_value = None[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/geoip_lookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m            }[0m
[30;1m64 | [0m[35m        except:[0m
[30;1m65 | [0m[35m            log.error([0m
[30;1m66 | [0m[35m                "ttp.match.geoip_lookup: something went wrong searching for '{}' IP in database '{}'[0m
[30;1m67 | [0m[35m                    data, db_name[0m
[30;1m68 | [0m[35m                )[0m
[30;1m69 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/geoip_lookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m            }[0m
[30;1m49 | [0m[35m        except:[0m
[30;1m50 | [0m[35m            log.error([0m
[30;1m51 | [0m[35m                "ttp.match.geoip_lookup: something went wrong searching for '{}' IP in database '{}'[0m
[30;1m52 | [0m[35m                    data, db_name[0m
[30;1m53 | [0m[35m                )[0m
[30;1m54 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/match/geoip_lookup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m            }[0m
[30;1m26 | [0m[35m        except:[0m
[30;1m27 | [0m[35m            log.error([0m
[30;1m28 | [0m[35m                "ttp.match.geoip_lookup: something went wrong searching for '{}' IP in database '{}'[0m
[30;1m29 | [0m[35m                    data, db_name[0m
[30;1m30 | [0m[35m                )[0m
[30;1m31 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m200 | [0m[35mformat="tabulate"[0m
[30;1m201 | [0m[35mpath="bgp_peers"[0m
[30;1m202 | [0m[35mreturner="terminal"[0m
[30;1m203 | [0m[35mheaders="hostname, local_asn, vrf_name, peer_ip, peer_asn, uptime, state, description, afi, rpl_in, [0m
[30;1m204 | [0m[35m/>[0m
[30;1m205 | [0m[35m"""[0m
[30;1m206 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m185 | [0m[35m    <group name="/bgp_peers*" chain="chain_1">[0m
[30;1m186 | [0m[35m    neighbor {{ peer_ip }}[0m
[30;1m187 | [0m[35m      {{ local_asn | set(asn) }}[0m
[30;1m188 | [0m[35m      {{ hostname | set(hostname) }}[0m
[30;1m189 | [0m[35m      remote-as {{ peer_asn }}[0m
[30;1m190 | [0m[35m      description {{ description }}[0m
[30;1m191 | [0m[35m      address-family {{ afi }} unicast[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m185 | [0m[35m    <group name="/bgp_peers*" chain="chain_1">[0m
[30;1m186 | [0m[35m    neighbor {{ peer_ip }}[0m
[30;1m187 | [0m[35m      {{ local_asn | set(asn) }}[0m
[30;1m188 | [0m[35m      {{ hostname | set(hostname) }}[0m
[30;1m189 | [0m[35m      remote-as {{ peer_asn }}[0m
[30;1m190 | [0m[35m      description {{ description }}[0m
[30;1m191 | [0m[35m      address-family {{ afi }} unicast[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m167 | [0m[35m</doc>[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m<vars>[0m
[30;1m170 | [0m[35mhostname="gethostname"[0m
[30;1m171 | [0m[35mchain_1 = [[0m
[30;1m172 | [0m[35m    "set('vrf_name')",[0m
[30;1m173 | [0m[35m    "lookup('peer_ip', group='bgp_state', update=True)"[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m154 | [0m[35mnd local bgp "local_asn" added using previous matches.[0m
[30;1m155 | [0m[35mAdditionally, group lookup function used to lookup peer state from "bgp_state"[0m
[30;1m156 | [0m[35mgroup results, adding found data to peer results.[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35mFinally, "bgp_peers" section of results passed via "tabulate_outputter" to[0m
[30;1m159 | [0m[35mfrom and print this table to terminal:[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35mhostname           local_asn    vrf_name    peer_ip    peer_asn    uptime    state    description   [0m
[30;1m162 | [0m[35m-----------------  -----------  ----------  ---------  ----------  --------  -------  ------------- [0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m151 | [0m[35m"/bgp_peers*" with path formatter to produce a list of peers under "bgp_peers"[0m
[30;1m152 | [0m[35mpath.[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35mFor each peer "hostname" and local bgp "local_asn" added using previous matches.[0m
[30;1m155 | [0m[35mAdditionally, group lookup function used to lookup peer state from "bgp_state"[0m
[30;1m156 | [0m[35mgroup results, adding found data to peer results.[0m
[30;1m157 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m## Example - a bit more complicated[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35mFor this example lets say we want to parse BGP peerings output, but combine state with configuration[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m<details><summary>Code</summary>[0m
[30;1m142 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35mucs-core-switch-1  65100        CUST-1      192.0.2.1  65101       00:12:33  300      peer-1        [0m
[30;1m164 | [0m[35mucs-core-switch-1  65100        CUST-1      192.0.2.2  65102       03:55:01  idle     peer-2        [0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35mRun this script with "python filename.py"[0m
[30;1m167 | [0m[35m</doc>[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m<vars>[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35mtemplate="""[0m
[30;1m145 | [0m[35m<doc>[0m
[30;1m146 | [0m[35mThis template first parses "show bgp vrf CUST-1 vpnv4 unicast summary" commands[0m
[30;1m147 | [0m[35moutput, forming results for "bgp_state" dictionary, where peer ip is a key.[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35mFollowing that, "show run | section bgp" output parsed by group "bgp_cfg". That[0m
[30;1m150 | [0m[35mgroup uses nested groups to form results structure, including absolute path[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35minterface {{ interface }}[0m
[30;1m115 | [0m[35m ip address {{ ip }}/{{ mask }}[0m
[30;1m116 | [0m[35m description {{ description }}[0m
[30;1m117 | [0m[35m ip vrf {{ vrf }}[0m
[30;1m118 | [0m[35m"""[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35mparser = ttp(data, template)[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mtemplate = """[0m
[30;1m114 | [0m[35minterface {{ interface }}[0m
[30;1m115 | [0m[35m ip address {{ ip }}/{{ mask }}[0m
[30;1m116 | [0m[35m description {{ description }}[0m
[30;1m117 | [0m[35m ip vrf {{ vrf }}[0m
[30;1m118 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mtemplate = """[0m
[30;1m114 | [0m[35minterface {{ interface }}[0m
[30;1m115 | [0m[35m ip address {{ ip }}/{{ mask }}[0m
[30;1m116 | [0m[35m description {{ description }}[0m
[30;1m117 | [0m[35m ip vrf {{ vrf }}[0m
[30;1m118 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35minterface Vlan778[0m
[30;1m107 | [0m[35m description CPE_Acces_Vlan[0m
[30;1m108 | [0m[35m ip address 2002::fd37/124[0m
[30;1m109 | [0m[35m ip vrf CPE1[0m
[30;1m110 | [0m[35m![0m
[30;1m111 | [0m[35m"""[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m![0m
[30;1m106 | [0m[35minterface Vlan778[0m
[30;1m107 | [0m[35m description CPE_Acces_Vlan[0m
[30;1m108 | [0m[35m ip address 2002::fd37/124[0m
[30;1m109 | [0m[35m ip vrf CPE1[0m
[30;1m110 | [0m[35m![0m
[30;1m111 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35mdata = """[0m
[30;1m102 | [0m[35minterface Loopback0[0m
[30;1m103 | [0m[35m description Router-id-loopback[0m
[30;1m104 | [0m[35m ip address 192.168.0.113/24[0m
[30;1m105 | [0m[35m![0m
[30;1m106 | [0m[35minterface Vlan778[0m
[30;1m107 | [0m[35m description CPE_Acces_Vlan[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m## What?[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35mIn essence TTP can help to:[0m
[30;1m78 | [0m[35m  - Prepare, sort and load text data for parsing[0m
[30;1m79 | [0m[35m  - Parse text using regexes dynamically derived out of templates[0m
[30;1m80 | [0m[35m  - Process matches on the fly using broad set of built-in or custom functions[0m
[30;1m81 | [0m[35m  - Combine match results in a structure with arbitrary hierarchy[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m## Why?[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mTo save ones time on transforming raw text into structured data and beyond.[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m## How?[0m
[30;1m72 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/utils/quick_parse.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m        ![0m
[30;1m32 | [0m[35m        interface Lo1[0m
[30;1m33 | [0m[35m        description this interface has description[0m
[30;1m34 | [0m[35m        ip address 1.1.1.1 32[0m
[30;1m35 | [0m[35m        '''[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        parsing_result = quick_parse(data, template)[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/utils/quick_parse.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        data = '''[0m
[30;1m29 | [0m[35m        interface Lo0[0m
[30;1m30 | [0m[35m        ip address 124.171.238.50 32[0m
[30;1m31 | [0m[35m        ![0m
[30;1m32 | [0m[35m        interface Lo1[0m
[30;1m33 | [0m[35m        description this interface has description[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/utils/quick_parse.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m        <group>[0m
[30;1m22 | [0m[35m        interface {{ interface }}[0m
[30;1m23 | [0m[35m        description {{ description | ORPHRASE }}[0m
[30;1m24 | [0m[35m        ip address {{ ip }} {{ mask }}[0m
[30;1m25 | [0m[35m        </group>[0m
[30;1m26 | [0m[35m        '''[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m272[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ttp-0.9.5/ttp/utils/quick_parse.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m        <group>[0m
[30;1m22 | [0m[35m        interface {{ interface }}[0m
[30;1m23 | [0m[35m        description {{ description | ORPHRASE }}[0m
[30;1m24 | [0m[35m        ip address {{ ip }} {{ mask }}[0m
[30;1m25 | [0m[35m        </group>[0m
[30;1m26 | [0m[35m        '''[0m
[30;1m27 | [0m[35m[0m

272 matches found.
