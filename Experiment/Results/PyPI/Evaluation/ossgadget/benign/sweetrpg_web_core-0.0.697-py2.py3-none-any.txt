[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/sweetrpg_web_core/blueprints/health/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m32 | [0m[35m@blueprint.route("/status")[0m
[30;1m33 | [0m[35mdef health_check():[0m
[30;1m34 | [0m[35m    r = {'services': {}}[0m
[30;1m35 | [0m[35m    build_info_path = os.environ.get(constants.BUILD_INFO_PATH)[0m
[30;1m36 | [0m[35m    if build_info_path:[0m
[30;1m37 | [0m[35m        with open(build_info_path, "r") as bi:[0m
[30;1m38 | [0m[35m            build_info = json.load(bi)[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/sweetrpg_web_core/helpers/context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m28 | [0m[35m            'gravatar_url': gravatar_url,[0m
[30;1m29 | [0m[35m        },[0m
[30;1m30 | [0m[35m        'base_path': os.environ.get(constants.APPLICATION_BASE_PATH, ""),[0m
[30;1m31 | [0m[35m        'static_asset_prefix': os.environ.get(constants.STATIC_ASSET_PREFIX, "")[0m
[30;1m32 | [0m[35m    }[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/sweetrpg_web_core/helpers/context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m27 | [0m[35m            'email_hash': email_hash,[0m
[30;1m28 | [0m[35m            'gravatar_url': gravatar_url,[0m
[30;1m29 | [0m[35m        },[0m
[30;1m30 | [0m[35m        'base_path': os.environ.get(constants.APPLICATION_BASE_PATH, ""),[0m
[30;1m31 | [0m[35m        'static_asset_prefix': os.environ.get(constants.STATIC_ASSET_PREFIX, "")[0m
[30;1m32 | [0m[35m    }[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/sweetrpg_web_core/blueprints/health/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m@blueprint.route("/status")[0m
[30;1m33 | [0m[35mdef health_check():[0m
[30;1m34 | [0m[35m    r = {'services': {}}[0m
[30;1m35 | [0m[35m    build_info_path = os.environ.get(constants.BUILD_INFO_PATH)[0m
[30;1m36 | [0m[35m    if build_info_path:[0m
[30;1m37 | [0m[35m        with open(build_info_path, "r") as bi:[0m
[30;1m38 | [0m[35m            build_info = json.load(bi)[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/sweetrpg_web_core/blueprints/health/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mdef register_health_check_service_hook(name: str, callable) -> None:[0m
[30;1m20 | [0m[35m    """Add a callable service hook for the health check endpoint.[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    :param name: The name of the hook.[0m
[30;1m23 | [0m[35m    :param callable: A callable that will return a JSON-encodable result. If this is `None`,[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/sweetrpg_web_core/helpers/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m    current_app.logger.info("Setting session values from request X-Forwarded-* headers")[0m
[30;1m69 | [0m[35m    session[constants.SESSION_ACCESS_TOKEN] = request.headers.get("X-Forwarded-Access-Token")[0m
[30;1m70 | [0m[35m    session[constants.SESSION_EMAIL] = request.headers.get("X-Forwarded-Email")[0m
[30;1m71 | [0m[35m    session[constants.SESSION_USER_ID] = request.headers.get("X-Forwarded-User")[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/sweetrpg_web_core/helpers/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    current_app.logger.info("Setting session values from request X-Forwarded-* headers")[0m
[30;1m69 | [0m[35m    session[constants.SESSION_ACCESS_TOKEN] = request.headers.get("X-Forwarded-Access-Token")[0m
[30;1m70 | [0m[35m    session[constants.SESSION_EMAIL] = request.headers.get("X-Forwarded-Email")[0m
[30;1m71 | [0m[35m    session[constants.SESSION_USER_ID] = request.headers.get("X-Forwarded-User")[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/sweetrpg_web_core/helpers/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        session[constants.PROFILE_KEY] = userinfo[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    current_app.logger.info("Setting session values from request X-Forwarded-* headers")[0m
[30;1m69 | [0m[35m    session[constants.SESSION_ACCESS_TOKEN] = request.headers.get("X-Forwarded-Access-Token")[0m
[30;1m70 | [0m[35m    session[constants.SESSION_EMAIL] = request.headers.get("X-Forwarded-Email")[0m
[30;1m71 | [0m[35m    session[constants.SESSION_USER_ID] = request.headers.get("X-Forwarded-User")[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/sweetrpg_web_core/helpers/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m            'gravatar_url': gravatar_url,[0m
[30;1m29 | [0m[35m        },[0m
[30;1m30 | [0m[35m        'base_path': os.environ.get(constants.APPLICATION_BASE_PATH, ""),[0m
[30;1m31 | [0m[35m        'static_asset_prefix': os.environ.get(constants.STATIC_ASSET_PREFIX, "")[0m
[30;1m32 | [0m[35m    }[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/sweetrpg_web_core/helpers/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m            'email_hash': email_hash,[0m
[30;1m28 | [0m[35m            'gravatar_url': gravatar_url,[0m
[30;1m29 | [0m[35m        },[0m
[30;1m30 | [0m[35m        'base_path': os.environ.get(constants.APPLICATION_BASE_PATH, ""),[0m
[30;1m31 | [0m[35m        'static_asset_prefix': os.environ.get(constants.STATIC_ASSET_PREFIX, "")[0m
[30;1m32 | [0m[35m    }[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/sweetrpg_web_core/helpers/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m        gravatar_url = f"https://www.gravatar.com/avatar/{email_hash}"[0m
[30;1m23 | [0m[35m    return {[0m
[30;1m24 | [0m[35m        'user': {[0m
[30;1m25 | [0m[35m            'id': session.get(constants.SESSION_USER_ID),[0m
[30;1m26 | [0m[35m            'email': email,[0m
[30;1m27 | [0m[35m            'email_hash': email_hash,[0m
[30;1m28 | [0m[35m            'gravatar_url': gravatar_url,[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/sweetrpg_web_core/helpers/context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m    :return:[0m
[30;1m16 | [0m[35m    """[0m
[30;1m17 | [0m[35m    email = session.get(constants.SESSION_EMAIL)[0m
[30;1m18 | [0m[35m    email_hash = None[0m
[30;1m19 | [0m[35m    gravatar_url = None[0m
[30;1m20 | [0m[35m    if email:[0m

12 matches found.
