{
  "package_name": "aiohttp_proxies_connector-0.2.29",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector-0.2.29/setup.py",
      "relative_path": "aiohttp_proxies_connector-0.2.29/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided code exhibits multiple strong indicators of malicious behavior consistent with known malware patterns and supply chain attacks. Key malicious characteristics include:\n\n1. Execution of obfuscated, base64-encoded payloads: The code decodes large base64 strings and writes them as Python scripts ('main.cpython-39.py' and 'scripts.cpython-39.py') into a suspiciously named hidden directory under the user's TEMP folder ('__pycache__'). This is a common tactic to hide malicious payloads.\n\n2. Execution of these payloads in hidden subprocesses: The 'run' function launches these scripts using 'pythonw.exe' with creation flags that hide the window, enabling stealthy execution without user awareness.\n\n3. Use of environment variables to locate user directories and write files: The code uses 'USERPROFILE' and constructs paths under 'appdata\\local\\temp', which is typical for malware staging.\n\n4. The embedded base64-decoded scripts contain extensive code that performs environment discovery, credential decryption (using Windows DPAPI), file enumeration, and network communication to suspicious external endpoints (e.g., 'androidstore.devsecwise.com', 'discord.com' webhooks, and other non-standard URLs).\n\n5. The code performs automated data exfiltration: It collects system information, user names, tokens, and other sensitive data, encodes it, and sends it via HTTP POST requests to attacker-controlled servers.\n\n6. The code includes multiple asynchronous functions that perform stealthy network communication and file operations without user consent.\n\n7. The setup script triggers this malicious behavior during package installation ('install' or 'bdist' commands), which is a classic supply chain attack vector.\n\n8. The code suppresses exceptions and writes errors to hidden files, avoiding detection.\n\n9. The presence of cryptographic operations, decryption routines, and dynamic code execution (eval/exec) on decoded data further confirms malicious intent.\n\n10. The code attempts to create persistence by writing to local storage folders and manipulating Windows startup folders.\n\nOverall, this code is a sophisticated malware sample that uses obfuscation, stealth execution, credential theft, data exfiltration, and persistence mechanisms embedded within a Python package installation process. It poses a critical security risk."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector/__init__.py",
      "relative_path": "aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector/helpers.py",
      "relative_path": "aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector/helpers.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector/connector.py",
      "relative_path": "aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector/connector.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector/proto.py",
      "relative_path": "aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector/proto.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector/errors.py",
      "relative_path": "aiohttp_proxies_connector-0.2.29/aiohttp_proxies_connector/errors.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}