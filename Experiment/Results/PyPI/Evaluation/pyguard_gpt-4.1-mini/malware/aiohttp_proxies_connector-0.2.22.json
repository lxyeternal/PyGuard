{
  "package_name": "aiohttp_proxies_connector-0.2.22",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector-0.2.22/setup.py",
      "relative_path": "aiohttp_proxies_connector-0.2.22/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The code exhibits multiple strong indicators of malicious behavior consistent with known malware patterns. It embeds a large base64-encoded payload that is decoded and written to temporary hidden directories under the user's profile path, specifically in a suspicious '__pycache__' folder inside the temp directory. The decoded payload is then executed via subprocesses launched in hidden windows, evading user detection. The code collects extensive environment information such as username, hostname, platform, and user directories, and sends this data encoded to suspicious external endpoints, including hardcoded URLs and IP addresses not associated with legitimate package sources. It performs dynamic code execution using eval on decompressed and decoded data, a classic obfuscation and code injection technique. The code also writes multiple Python scripts to disk and runs them asynchronously, indicating multi-stage payload deployment. It uses subprocess.Popen with creation flags to hide windows and suppress output, further indicating stealthy execution. The presence of cryptographic decryption routines, DPAPI usage, and encoded keys suggests attempts to decrypt and execute protected payloads. The code triggers execution during package installation phases (setup.py context), a known supply chain attack vector, without user consent or interaction. It also attempts to create and manipulate Windows startup folders and registry-like persistence mechanisms. The combination of environment reconnaissance, data exfiltration via HTTP POST to suspicious domains, dynamic code execution, hidden process spawning, and obfuscated payloads conclusively identifies this code as malicious."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector/__init__.py",
      "relative_path": "aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector/helpers.py",
      "relative_path": "aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector/helpers.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector/connector.py",
      "relative_path": "aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector/connector.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector/proto.py",
      "relative_path": "aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector/proto.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector/errors.py",
      "relative_path": "aiohttp_proxies_connector-0.2.22/aiohttp_proxies_connector/errors.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}