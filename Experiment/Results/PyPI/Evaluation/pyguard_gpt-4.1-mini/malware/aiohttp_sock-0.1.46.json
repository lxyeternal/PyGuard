{
  "package_name": "aiohttp_sock-0.1.46",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.46/aiohttp_sock-0.1.46/setup.py",
      "relative_path": "aiohttp_sock-0.1.46/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided code exhibits multiple strong indicators of malicious behavior consistent with known malware patterns and supply chain attacks. Key malicious characteristics include:\n\n1. Execution of arbitrary code during package installation: The setup script triggers subprocess calls to install additional packages and then writes a base64-decoded Python script to a hidden directory in the user's local appdata temp folder. This script is then executed via a VBScript launcher, which is a common evasion technique.\n\n2. Use of obfuscated payloads: The main payload is base64-encoded and embedded within the installer, which is decoded and executed dynamically. This obfuscation hides the true intent and evades static analysis.\n\n3. Creation of suspicious directories and files: The code creates a '__pycache__' directory inside the user's local temp directory and writes executable Python scripts there, which is unusual and suspicious behavior.\n\n4. Execution of hidden PowerShell commands: The VBScript runs a PowerShell command in hidden mode to execute the Python script, a known stealth technique used by malware.\n\n5. Extensive environment and system fingerprinting: The decoded payload (visible in the base64 string) collects detailed system information, including environment variables, user profile paths, and system directories.\n\n6. Data exfiltration patterns: The payload constructs HTTP requests to hardcoded suspicious URLs (e.g., 'http://144.24.115.170', 'androidstore.devsecwise.com'), sending encoded system and user data without user consent.\n\n7. Credential and sensitive data theft: The code includes DPAPI decryption routines, searches for sensitive files (e.g., browser data, Telegram data), decrypts stored passwords, and exfiltrates them.\n\n8. Persistence and stealth: The code attempts to create and manage tasks, manipulate local storage, and maintain stealthy background operations using threading and asynchronous calls.\n\n9. Use of cryptography and encoded keys: The presence of cryptographic operations with hardcoded keys and ciphertexts indicates attempts to decrypt or encrypt stolen data.\n\n10. Lack of user interaction or consent: All operations are performed silently during package installation without any user prompts or notifications.\n\nThese behaviors align with multiple critical risk indicators of malware, including supply chain attack vectors, remote code execution, data exfiltration, credential theft, and stealthy persistence mechanisms. Therefore, the code is conclusively malicious."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.46/aiohttp_sock-0.1.46/aiohttp_sock/__init__.py",
      "relative_path": "aiohttp_sock-0.1.46/aiohttp_sock/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.46/aiohttp_sock-0.1.46/aiohttp_sock/helpers.py",
      "relative_path": "aiohttp_sock-0.1.46/aiohttp_sock/helpers.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.46/aiohttp_sock-0.1.46/aiohttp_sock/connector.py",
      "relative_path": "aiohttp_sock-0.1.46/aiohttp_sock/connector.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.46/aiohttp_sock-0.1.46/aiohttp_sock/proto.py",
      "relative_path": "aiohttp_sock-0.1.46/aiohttp_sock/proto.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.46/aiohttp_sock-0.1.46/aiohttp_sock/errors.py",
      "relative_path": "aiohttp_sock-0.1.46/aiohttp_sock/errors.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}