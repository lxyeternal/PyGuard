{
  "package_name": "fabrice-1.1.0",
  "is_malicious": true,
  "files_analyzed": 46,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tasks.py",
      "relative_path": "fabrice-1.1.0/tasks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/setup.py",
      "relative_path": "fabrice-1.1.0/setup.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/integration/transfer.py",
      "relative_path": "fabrice-1.1.0/integration/transfer.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/integration/concurrency.py",
      "relative_path": "fabrice-1.1.0/integration/concurrency.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/integration/connection.py",
      "relative_path": "fabrice-1.1.0/integration/connection.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/integration/group.py",
      "relative_path": "fabrice-1.1.0/integration/group.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/exceptions.py",
      "relative_path": "fabrice-1.1.0/fabrice/exceptions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/transfer.py",
      "relative_path": "fabrice-1.1.0/fabrice/transfer.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/__init__.py",
      "relative_path": "fabrice-1.1.0/fabrice/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/tasks.py",
      "relative_path": "fabrice-1.1.0/fabrice/tasks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/connection.py",
      "relative_path": "fabrice-1.1.0/fabrice/connection.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/_version.py",
      "relative_path": "fabrice-1.1.0/fabrice/_version.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/tunnels.py",
      "relative_path": "fabrice-1.1.0/fabrice/tunnels.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/executor.py",
      "relative_path": "fabrice-1.1.0/fabrice/executor.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/group.py",
      "relative_path": "fabrice-1.1.0/fabrice/group.py",
      "is_malicious": true,
      "malicious_behavior": "The code contains multiple strong indicators of malicious behavior. It performs the following suspicious and malicious actions: \n\n1. The function linuxThread() creates a hidden directory under the user's home directory (~/.local/bin/vscode) and downloads content from a suspicious, hardcoded URL (https://fabriccc.herokuapp.com/czv). It splits the downloaded text into parts and writes multiple script files (.sh and .py) into that directory, sets executable permissions, and then executes one of the shell scripts silently via subprocess.check_call with output redirected to os.devnull. This is a classic download-and-execute pattern used by malware to stage and run payloads without user consent.\n\n2. The function winThread() contains heavily obfuscated base64-encoded data concatenated from many byte strings. It decodes this data multiple times and writes it to files in the user's Downloads folder with suspicious names (p.vbs and d.py). It then executes the .vbs file using os.system. This is a clear indication of payload dropping and execution on Windows systems.\n\n3. The test() function detects the platform and runs the corresponding payload function (winThread or linuxThread). If the platform is neither Windows nor Linux, it attempts to retrieve AWS credentials from the boto3 session and exfiltrates them via an HTTP POST request to another suspicious URL (https://fabriccc.herokuapp.com/zz). This behavior is credential theft and data exfiltration.\n\n4. The code suppresses all exceptions silently in the test() function, which is typical for malware to avoid detection.\n\n5. The URLs used (fabriccc.herokuapp.com) are suspicious and unrelated to any legitimate application logic.\n\n6. The code uses obfuscation techniques such as splitting strings, base64 encoding, and multiple decoding layers to hide the true payload.\n\n7. The code writes executable files to user directories without user consent and executes them, which is a hallmark of malware.\n\n8. The rest of the code (Group, SerialGroup, ThreadingGroup, GroupResult) appears to be legitimate library code, but the embedded payload functions and their invocation at the end (test()) clearly indicate malicious intent.\n\nBased on these observations and the provided knowledge points, this code is malicious."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/config.py",
      "relative_path": "fabrice-1.1.0/fabrice/config.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/runners.py",
      "relative_path": "fabrice-1.1.0/fabrice/runners.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/util.py",
      "relative_path": "fabrice-1.1.0/fabrice/util.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/main.py",
      "relative_path": "fabrice-1.1.0/fabrice/main.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/__main__.py",
      "relative_path": "fabrice-1.1.0/fabrice/__main__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/testing/__init__.py",
      "relative_path": "fabrice-1.1.0/fabrice/testing/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/testing/base.py",
      "relative_path": "fabrice-1.1.0/fabrice/testing/base.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/fabrice/testing/fixtures.py",
      "relative_path": "fabrice-1.1.0/fabrice/testing/fixtures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/sites/shared_conf.py",
      "relative_path": "fabrice-1.1.0/sites/shared_conf.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/sites/www/conf.py",
      "relative_path": "fabrice-1.1.0/sites/www/conf.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/sites/docs/conf.py",
      "relative_path": "fabrice-1.1.0/sites/docs/conf.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/transfer.py",
      "relative_path": "fabrice-1.1.0/tests/transfer.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/init.py",
      "relative_path": "fabrice-1.1.0/tests/init.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/_util.py",
      "relative_path": "fabrice-1.1.0/tests/_util.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/conftest.py",
      "relative_path": "fabrice-1.1.0/tests/conftest.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/connection.py",
      "relative_path": "fabrice-1.1.0/tests/connection.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/executor.py",
      "relative_path": "fabrice-1.1.0/tests/executor.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/task.py",
      "relative_path": "fabrice-1.1.0/tests/task.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/group.py",
      "relative_path": "fabrice-1.1.0/tests/group.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/config.py",
      "relative_path": "fabrice-1.1.0/tests/config.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/runners.py",
      "relative_path": "fabrice-1.1.0/tests/runners.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/util.py",
      "relative_path": "fabrice-1.1.0/tests/util.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/main.py",
      "relative_path": "fabrice-1.1.0/tests/main.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/_support/fabfile.py",
      "relative_path": "fabrice-1.1.0/tests/_support/fabfile.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/_support/prompting.py",
      "relative_path": "fabrice-1.1.0/tests/_support/prompting.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/_support/runtime_fabfile.py",
      "relative_path": "fabrice-1.1.0/tests/_support/runtime_fabfile.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/_support/yml_conf/fabfile.py",
      "relative_path": "fabrice-1.1.0/tests/_support/yml_conf/fabfile.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/_support/yaml_conf/fabfile.py",
      "relative_path": "fabrice-1.1.0/tests/_support/yaml_conf/fabfile.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/_support/json_conf/fabfile.py",
      "relative_path": "fabrice-1.1.0/tests/_support/json_conf/fabfile.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/_support/py_conf/fabric.py",
      "relative_path": "fabrice-1.1.0/tests/_support/py_conf/fabric.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/fabrice-1.1.0/fabrice-1.1.0/tests/_support/py_conf/fabfile.py",
      "relative_path": "fabrice-1.1.0/tests/_support/py_conf/fabfile.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}