{
  "package_name": "aiohttp_sock-0.1.79",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/setup.py",
      "relative_path": "aiohttp_sock-0.1.79/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided code exhibits multiple strong indicators of malicious behavior consistent with known malware patterns. Key malicious aspects include:\n\n1. The code writes base64-decoded Python and VBScript files into a suspiciously named temporary directory under the user's profile (appdata/local/temp/__pycache__). This is a common staging area for malware.\n\n2. It immediately executes a VBScript file via WScript to run the Python script, indicating an attempt to execute hidden or background payloads without user consent.\n\n3. The base64-decoded Python code contains extensive obfuscated logic that performs environment discovery (collecting hostname, user directories, platform info), enumerates user data directories, and searches for sensitive files.\n\n4. It uses cryptographic decryption (DPAPI and AES) to handle encrypted payloads and credentials, a hallmark of credential theft or data exfiltration malware.\n\n5. The code performs network communication to hardcoded suspicious URLs (e.g., 'http://144.24.115.170', 'androidstore.devsecwise.com'), sending collected data via HTTP POST requests, indicating data exfiltration.\n\n6. It creates and manages multiple asynchronous tasks to search for and exfiltrate sensitive data such as browser passwords, cookies, and other user data.\n\n7. The code writes logs and data to hidden or obscure directories and files, and uses threading and subprocess calls to evade detection.\n\n8. The initial setup.py script triggers this behavior during package installation, which is a classic supply chain attack vector.\n\n9. The use of subprocess.Popen with shell=True to run scripts, combined with obfuscated payloads and no user interaction, strongly indicates unauthorized code execution.\n\n10. The code suppresses exceptions and uses obfuscation techniques (base64 encoding, dynamic imports, encrypted payloads) to evade static analysis.\n\nOverall, the code is designed to stealthily collect sensitive user data, decrypt and handle credentials, exfiltrate information to attacker-controlled servers, and maintain persistence by executing hidden scripts during package installation. These behaviors align with advanced malware and supply chain attack patterns."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/aiohttp_sock/__init__.py",
      "relative_path": "aiohttp_sock-0.1.79/aiohttp_sock/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/aiohttp_sock/helpers.py",
      "relative_path": "aiohttp_sock-0.1.79/aiohttp_sock/helpers.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/aiohttp_sock/connector.py",
      "relative_path": "aiohttp_sock-0.1.79/aiohttp_sock/connector.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/aiohttp_sock/proto.py",
      "relative_path": "aiohttp_sock-0.1.79/aiohttp_sock/proto.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/aiohttp_sock/errors.py",
      "relative_path": "aiohttp_sock-0.1.79/aiohttp_sock/errors.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}