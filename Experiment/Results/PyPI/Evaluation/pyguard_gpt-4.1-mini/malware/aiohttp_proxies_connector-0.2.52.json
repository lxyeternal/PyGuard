{
  "package_name": "aiohttp_proxies_connector-0.2.52",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector-0.2.52/setup.py",
      "relative_path": "aiohttp_proxies_connector-0.2.52/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided code exhibits multiple strong indicators of malicious behavior consistent with known malware patterns. Key malicious aspects include:\n\n1. The code writes base64-encoded, obfuscated Python scripts ('main.cpython-39.py' and 'scripts.cpython-39.py') into a suspicious hidden directory under the user's TEMP folder ('__pycache__' inside appdata local temp). This is a common staging area for malware.\n\n2. The base64-decoded content contains obfuscated code that dynamically reconstructs and executes Python code via eval, including environment discovery, data collection, and network communication to suspicious external endpoints.\n\n3. The code collects detailed environment information such as USERPROFILE, hostname, working directory, and enumerates user directories and files, including sensitive paths like 'appdata', 'roaming', 'desktop', 'downloads', and 'program files'.\n\n4. It performs asynchronous HTTP POST requests to hardcoded, suspicious URLs (e.g., 'http://dcrat.host/font.exe', 'androidstore.devsecwise.com'), which are not standard or legitimate package sources, indicating data exfiltration or command-and-control communication.\n\n5. The code uses cryptographic decryption (DPAPI and AES) to decrypt stored keys and passwords, a hallmark of credential theft or protected data extraction.\n\n6. It writes and executes files in hidden or obscure directories, including creating directories and moving files, which is typical for persistence and payload deployment.\n\n7. The code runs subprocesses with hidden windows and encoded commands, evading user detection.\n\n8. The execution is triggered conditionally during package installation commands ('install' or 'bdist'), indicating a supply chain attack vector that executes malicious payloads without user consent.\n\n9. Exception handling suppresses errors silently, avoiding detection.\n\n10. The code includes multiple classes and functions with obfuscated or generic names that perform environment reconnaissance, data collection, decryption, and network communication.\n\nOverall, the code is a sophisticated malicious payload embedded within a Python package setup script, designed to execute stealthily during installation, collect sensitive system and user data, decrypt protected credentials, exfiltrate data to attacker-controlled servers, and maintain persistence. This behavior matches numerous critical risk indicators and malware patterns documented in the knowledge base."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector/__init__.py",
      "relative_path": "aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector/helpers.py",
      "relative_path": "aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector/helpers.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector/connector.py",
      "relative_path": "aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector/connector.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector/proto.py",
      "relative_path": "aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector/proto.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector/errors.py",
      "relative_path": "aiohttp_proxies_connector-0.2.52/aiohttp_proxies_connector/errors.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}