{
  "package_name": "aiohttp_socks_test_connector-0.2.19",
  "version": "aiohttp_socks_test_connector-0.2.19",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector-0.2.19/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided Python code contains multiple indicators of malicious behavior. It creates a hidden directory in the user's local temporary folder named '__pycache__' and writes a base64-decoded Python script ('main.cpython-39.py') into it. This embedded script is heavily obfuscated and performs the following malicious actions:\n\n1. **Persistence and Stealth:** The code sets up directories and files in user-specific temporary paths, which is a common tactic to evade detection.\n\n2. **Credential and Data Theft:** The embedded script searches through various user directories such as 'appdata', 'local', 'roaming', 'documents', 'downloads', and 'desktop' for files related to browsers (Chrome, Opera, Yandex), Telegram, Exodus wallet, Filezilla, and WhatsApp. It looks for files containing passwords, cookies, wallets, and other sensitive data.\n\n3. **Decryption of Sensitive Data:** The script includes cryptographic routines to decrypt stored passwords and cookies from browsers and other applications, indicating an intent to extract usable credentials.\n\n4. **Data Exfiltration:** After collecting and decrypting sensitive information, the script sends this data via HTTP POST requests to a remote server URL hardcoded in the configuration (e.g., 'http://218c-193-138-218-161.ngrok.io/receive_details'). This is a clear sign of data exfiltration.\n\n5. **Use of Windows-specific APIs and Tools:** The code uses Windows registry access, Windows cryptographic APIs, and Windows-specific paths, indicating it targets Windows systems.\n\n6. **Execution of Additional Payloads:** The initial script attempts to execute the embedded 'main.cpython-39.py' script, which contains the core malicious logic.\n\n7. **Obfuscation:** The main payload is base64-encoded and embedded within the script, making static analysis harder and indicating an attempt to hide malicious intent.\n\nOverall, this code is a sophisticated Windows credential stealer and data exfiltration malware that targets browser credentials, cookies, cryptocurrency wallets, and messaging app data, sending stolen information to a remote attacker-controlled server. It poses a significant security risk to any infected system.",
      "relative_path": "setup.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector/__init__.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_socks_test_connector/__init__.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector/helpers.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_socks_test_connector/helpers.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector/connector.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_socks_test_connector/connector.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector/proto.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_socks_test_connector/proto.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector-0.2.19/aiohttp_socks_test_connector/errors.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_socks_test_connector/errors.py"
    }
  ]
}