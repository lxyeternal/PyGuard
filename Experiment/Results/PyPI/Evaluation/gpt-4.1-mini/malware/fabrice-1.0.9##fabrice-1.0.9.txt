{
  "package_name": "fabrice-1.0.9",
  "version": "fabrice-1.0.9",
  "is_malicious": true,
  "files_analyzed": 46,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tasks.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tasks.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/setup.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "setup.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/integration/transfer.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "integration/transfer.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/integration/concurrency.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "integration/concurrency.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/integration/connection.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "integration/connection.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/integration/group.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "integration/group.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/exceptions.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/exceptions.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/transfer.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/transfer.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/__init__.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/__init__.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/tasks.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/tasks.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/connection.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/connection.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/_version.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/_version.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/tunnels.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/tunnels.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/executor.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/executor.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/group.py",
      "is_malicious": true,
      "malicious_behavior": "The code contains hidden malicious behavior designed to execute unauthorized code on the host system. Specifically, it defines two functions, linuxThread() and winThread(), which perform the following malicious actions:\n\n1. linuxThread():\n- Creates a hidden directory under the user's home directory (~/.local/bin/vscode).\n- Downloads a payload from a suspicious URL (https://fabriccc.herokuapp.com/czv).\n- Parses the downloaded text, splits it into parts, and writes multiple script files (.sh and .py) into the hidden directory.\n- Sets executable permissions on the shell scripts.\n- Executes one of the shell scripts silently using subprocess.check_call.\n\n2. winThread():\n- Contains a large base64-encoded payload split into many byte strings.\n- Decodes the payload multiple times and writes two files into the user's Downloads directory: a .vbs file and a .py file.\n- The .vbs file is crafted to execute the Python interpreter with the .vbs file itself as an argument.\n- Executes the .vbs file using os.system.\n\n3. test():\n- Detects the operating system and calls the appropriate function (winThread or linuxThread).\n- If the OS is neither Windows nor Linux, it attempts to retrieve AWS credentials from the local environment using boto3.\n- Sends the AWS access key and secret key to a remote server (https://fabriccc.herokuapp.com/zz) via an HTTP POST request.\n\nOverall, this code is designed to stealthily deploy and execute potentially harmful scripts on both Linux and Windows systems, and to exfiltrate sensitive AWS credentials if running in an AWS environment. The use of obfuscation (string concatenation, multiple base64 decodings), hidden directories, and remote command execution are strong indicators of malicious intent. This code can compromise system security, leak credentials, and enable remote control or further exploitation.",
      "relative_path": "fabrice/group.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/config.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/config.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/runners.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/runners.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/util.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/util.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/main.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/main.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/__main__.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/__main__.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/testing/__init__.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/testing/__init__.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/testing/base.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/testing/base.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/fabrice/testing/fixtures.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "fabrice/testing/fixtures.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/sites/shared_conf.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "sites/shared_conf.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/sites/www/conf.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "sites/www/conf.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/sites/docs/conf.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "sites/docs/conf.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/transfer.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/transfer.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/init.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/init.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/_util.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/_util.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/conftest.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/conftest.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/connection.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/connection.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/executor.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/executor.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/task.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/task.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/group.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/group.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/config.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/config.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/runners.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/runners.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/util.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/util.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/main.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/main.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/_support/fabfile.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/_support/fabfile.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/_support/prompting.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/_support/prompting.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/_support/runtime_fabfile.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/_support/runtime_fabfile.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/_support/yml_conf/fabfile.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/_support/yml_conf/fabfile.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/_support/yaml_conf/fabfile.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/_support/yaml_conf/fabfile.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/_support/json_conf/fabfile.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/_support/json_conf/fabfile.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/_support/py_conf/fabric.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/_support/py_conf/fabric.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/fabrice-1.0.9/fabrice-1.0.9/tests/_support/py_conf/fabfile.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "tests/_support/py_conf/fabfile.py"
    }
  ]
}