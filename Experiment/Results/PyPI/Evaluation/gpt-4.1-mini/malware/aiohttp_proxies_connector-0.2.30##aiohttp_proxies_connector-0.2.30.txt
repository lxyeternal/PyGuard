{
  "package_name": "aiohttp_proxies_connector-0.2.30",
  "version": "aiohttp_proxies_connector-0.2.30",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector-0.2.30/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided Python code exhibits clear malicious behavior. It is designed to stealthily execute and persist on a Windows system by performing the following actions:\n\n1. **Environment and Directory Manipulation:** The code uses environment variables to locate the user's AppData local temp directory and creates a hidden '__pycache__' folder there to store its payload scripts.\n\n2. **Base64-Encoded Payloads:** It writes base64-decoded Python scripts ('main.cpython-39.py' and 'scripts.cpython-39.py') into the hidden directory. These scripts contain obfuscated code that performs further malicious actions.\n\n3. **Background Execution:** The code launches these payload scripts using 'pythonw.exe' with flags to hide the console window, enabling background execution without user awareness.\n\n4. **Credential and Data Theft:** The payload scripts scan various local directories related to browsers, Telegram, WhatsApp, and other applications to extract sensitive data such as passwords, cookies, session tokens, and local storage files.\n\n5. **Decryption and Exfiltration:** The stolen data is decrypted (using cryptographic primitives) and then sent via HTTP POST requests to a remote server (not explicitly shown but implied by the use of HTTP client sessions and POST requests to URLs constructed from environment variables).\n\n6. **Persistence and Stealth:** The code attempts to maintain persistence by creating directories and files in user data paths, copying files, and possibly cleaning up traces. It also uses asynchronous tasks and subprocesses to run stealthily.\n\n7. **Use of Multiple Plugins:** The code references plugins for browsers, Telegram, WhatsApp, and other applications, indicating modular design to harvest data from multiple sources.\n\n8. **Error Handling and Debugging:** It writes errors to a log file in the hidden directory, which helps maintain stealth by avoiding crashes.\n\nOverall, this code is a sophisticated information stealer malware targeting Windows users, aiming to harvest credentials and sensitive data from popular applications and exfiltrate it to an attacker-controlled server. Its use of obfuscation, hidden directories, background execution, and multiple data sources confirms its malicious intent.",
      "relative_path": "setup.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector/__init__.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_proxies_connector/__init__.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector/helpers.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_proxies_connector/helpers.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector/connector.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_proxies_connector/connector.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector/proto.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_proxies_connector/proto.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector-0.2.30/aiohttp_proxies_connector/errors.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_proxies_connector/errors.py"
    }
  ]
}