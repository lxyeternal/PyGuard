{
  "package_name": "aiohttp_socks_connector-0.1.17",
  "version": "aiohttp_socks_connector-0.1.17",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector-0.1.17/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided code exhibits clear malicious behavior. It is a Python setup script that, beyond its apparent purpose of installing a package, performs several suspicious and harmful actions:\n\n1. Environment and Path Manipulation:\n   - It accesses the Windows user profile and temp directories to create a hidden '__pycache__' folder under the user's local temp directory.\n\n2. Writing and Executing Obfuscated Code:\n   - The script decodes a large base64-encoded payload and writes it as 'main.cpython-39.py' in the hidden directory.\n   - It also writes two VBScript files that appear to be designed to run or facilitate execution of the Python script.\n   - It then changes the working directory to this hidden folder and executes the Python script.\n\n3. Payload Behavior (from decoded base64 content and code structure):\n   - The decoded Python payload contains code that searches for user data, passwords, cookies, and other sensitive information from various local folders related to browsers (Chrome, Edge, Opera GX, Yandex Browser), Telegram, and other software.\n   - It attempts to decrypt stored passwords and cookies using cryptographic methods.\n   - It collects this sensitive data and sends it via HTTP POST requests to a remote server (notably, the hardcoded host is 'http://144.24.115.170').\n   - It also collects system information such as username, platform, and tags the data with client IDs.\n   - The code includes mechanisms to create directories, copy files, and maintain persistence by writing logs and possibly other files.\n\n4. Stealth and Persistence:\n   - The script uses obfuscation techniques such as base64 encoding and dynamic code writing.\n   - It attempts to avoid detection by writing logs and error files in hidden temp directories.\n\n5. Unauthorized Data Exfiltration:\n   - The primary malicious intent is to steal sensitive user credentials and data from browsers and other applications and exfiltrate them to a remote server.\n\nOverall, this code is a credential stealer and spyware that compromises user security and privacy by silently harvesting and transmitting sensitive information without user consent.",
      "relative_path": "setup.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector/__init__.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_socks_connector/__init__.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector/helpers.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_socks_connector/helpers.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector/connector.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_socks_connector/connector.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector/proto.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_socks_connector/proto.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector-0.1.17/aiohttp_socks_connector/errors.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_socks_connector/errors.py"
    }
  ]
}