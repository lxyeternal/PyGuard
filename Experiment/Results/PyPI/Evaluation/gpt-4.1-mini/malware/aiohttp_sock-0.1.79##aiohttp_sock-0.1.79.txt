{
  "package_name": "aiohttp_sock-0.1.79",
  "version": "aiohttp_sock-0.1.79",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided Python code contains multiple indicators of malicious behavior. After the initial legitimate-looking setup code for a Python package, the script proceeds to create a hidden directory inside the user's TEMP folder and writes a base64-decoded Python script named 'main.cpython-39.py' into it. This embedded script performs the following malicious actions:\n\n1. It attempts to create various directories and files in user data and system folders, including 'appdata', 'local', 'temp', 'program files', 'roaming', 'documents', 'downloads', and others, indicating an attempt to persist or hide data.\n\n2. It searches for local state folders and extracts encrypted passwords and cookies from browsers such as Chrome, Opera GX, Opera Stable, and Yandex Browser by accessing their SQLite databases and decrypting stored credentials using Windows DPAPI and AES decryption.\n\n3. It collects Telegram session data and other sensitive files from the user's system.\n\n4. It sends the stolen data via HTTP POST requests to a remote server (the IP address 144.24.115.170 is hardcoded in the script), effectively exfiltrating sensitive information.\n\n5. It creates and runs VBScript files to execute the embedded Python script via Windows Script Host, which is a common technique to evade detection and run code stealthily.\n\n6. The script uses asynchronous tasks and subprocess calls to install various Python packages (aiofiles, aiohttp, cryptography, aiomysql, etc.) which are likely used to facilitate network communication and encryption.\n\n7. The overall behavior is consistent with a credential stealer and data exfiltration malware targeting Windows systems, focusing on browser-stored passwords, cookies, Telegram sessions, and other user data.\n\nIn summary, this code is malicious. It is designed to stealthily collect sensitive user data from browsers and messaging apps, then send this data to a remote attacker-controlled server, posing a significant security and privacy risk.",
      "relative_path": "setup.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/aiohttp_sock/__init__.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_sock/__init__.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/aiohttp_sock/helpers.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_sock/helpers.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/aiohttp_sock/connector.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_sock/connector.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/aiohttp_sock/proto.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_sock/proto.py"
    },
    {
      "file_path": "/home2/wenbo/Documents/PyPIAgent/Dataset/www_regular/unzip_malware/aiohttp_sock-0.1.79/aiohttp_sock-0.1.79/aiohttp_sock/errors.py",
      "is_malicious": false,
      "malicious_behavior": "",
      "relative_path": "aiohttp_sock/errors.py"
    }
  ]
}