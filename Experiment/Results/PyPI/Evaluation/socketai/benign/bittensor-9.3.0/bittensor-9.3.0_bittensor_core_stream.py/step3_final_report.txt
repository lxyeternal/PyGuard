{
  "purpose": "Framework for handling streaming responses in an ASGI web server, utilizing a user-supplied token streamer callable to generate streaming content.",
  "sources": "The 'token_streamer' callable provided to 'create_streaming_response', invoked during response streaming via 'await self.token_streamer(send)'.",
  "sinks": "The 'send' function used to transmit response start, body, and headers to the client; potential data leaks or malicious actions depend on the implementation of 'token_streamer'.",
  "flows": "Input: 'token_streamer' callable; flow: 'create_streaming_response' creates a response object, which upon invocation calls 'stream_response', which in turn calls 'token_streamer' with 'send', transmitting data to client.",
  "anomalies": "No hardcoded secrets, obfuscation, or suspicious code patterns; reliance on external 'token_streamer' is expected in such frameworks but could be malicious if untrusted.",
  "analysis": "The code defines an abstract streaming response class with a nested response class that manages headers and invokes a user-defined 'token_streamer' during response. It includes abstract methods for processing streaming responses and extracting JSON, which must be implemented by subclasses. The 'token_streamer' is a callable supplied externally, which could be malicious if untrusted, but this is typical in plugin architectures. No signs of obfuscation, secrets, or malicious payloads are present. The code itself is standard, clean, and designed for extensibility. The primary security concern is the trustworthiness of the 'token_streamer' implementation, not the code itself.",
  "conclusion": "The code is a standard, well-structured framework for streaming responses with no embedded malicious behavior. The main risk stems from external 'token_streamer' code, which is expected in such designs. The malware score is 0, obfuscation score is 0, and the security risk score is low (~0.2), reflecting the reliance on external, potentially untrusted code but no inherent vulnerabilities.",
  "confidence": 0.9,
  "obfuscated": 0,
  "malware": 0,
  "securityRisk": 0.2,
  "model": "gpt-4.1-nano"
}