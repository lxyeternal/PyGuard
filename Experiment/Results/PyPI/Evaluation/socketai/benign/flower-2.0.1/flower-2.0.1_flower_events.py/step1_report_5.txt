{
  "purpose": "The code manages and monitors Celery worker events, collects metrics with Prometheus, and maintains state across event captures for a distributed task system.",
  "sources": "Reads event data from Celery event stream, environment options for metric configuration, and data from shelve database for persistence.",
  "sinks": "Updates Prometheus metrics, saves state to shelve, and runs control commands on the Celery app.",
  "flows": "Event data flows from Celery event stream through event handler -> metrics update and state update -> optional persistence.",
  "anomalies": "No suspicious hardcoded secrets, credentials, or backdoors. Use of shelve for persistence could be a concern if misused, but not inherently malicious. No obfuscated code or suspicious dynamic execution detected. The code uses threading and I/O loops appropriately. No external network connections or data exfiltration present.",
  "analysis": "The code is primarily for event collection, metrics reporting, and state management within a Celery-based system. It uses standard libraries and well-known third-party tools (celery, prometheus, tornado). No malicious behavior such as data theft, backdoors, or unauthorized external communications is evident. The shelve persistence is a typical pattern for local state saving. No hardcoded credentials or suspicious code patterns detected. The code's purpose aligns with monitoring and metrics collection, with no signs of sabotage or malware.",
  "conclusion": "The code appears to be a legitimate monitoring and event handling component for Celery workers, with no indications of malicious intent or sabotage. It manages metrics and state in a typical manner without suspicious behavior.",
  "confidence": 0.9,
  "obfuscated": 0,
  "malware": 0,
  "securityRisk": 0.2,
  "report_number": 5
}