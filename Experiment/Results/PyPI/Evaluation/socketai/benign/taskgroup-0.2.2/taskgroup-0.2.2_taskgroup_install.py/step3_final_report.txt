{
  "purpose": "The code implements an asyncio utility that manages task wrapping, cancellation, and context propagation, enabling tasks to be resumed or canceled gracefully within an event loop.",
  "sources": "The code reads input/data from sys modules, asyncio current task and loop, contextvars for context management, and task factory methods.",
  "sinks": "Potential untrusted callback functions and cancellation methods could influence task behavior or cause unintended side effects, but no external data leaks or network activity are present.",
  "flows": "The source data (task, context, callback) flows through coroutine wrapping and callback invocation, ultimately affecting task cancellation and resumption mechanisms.",
  "anomalies": "Unusual patterns include deletion of the '_add_done_callback' reference after use and complex coroutine wrapping via 'WrapCoro', but these are advanced asyncio patterns without malicious intent.",
  "analysis": "The code provides an asyncio-based mechanism for managing task cancellation and context propagation, using custom classes to wrap coroutines and control callback execution. No hardcoded secrets, network calls, or data exfiltration are present. The manipulation of callbacks and context is sophisticated but consistent with advanced asyncio control utilities. The deletion of callback references and custom coroutine wrappers are notable but not suspicious. The scores assigned in the reports (malware 0, risk ~0.2) are appropriate given the code's complexity but benign purpose.",
  "conclusion": "The code is a legitimate, advanced asyncio utility for task management, with no evidence of malicious behavior, backdoors, or supply chain threats. Its complexity allows for potential misuse if altered maliciously, but as provided, it is safe and non-malicious.",
  "confidence": 0.9,
  "obfuscated": 0,
  "malware": 0,
  "securityRisk": 0.2,
  "model": "gpt-4.1-nano"
}