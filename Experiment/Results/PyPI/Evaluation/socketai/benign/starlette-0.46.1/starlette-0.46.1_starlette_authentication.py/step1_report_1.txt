{
  "purpose": "The code provides authorization and authentication decorators and classes for a web application, handling scope verification, user authentication, and request validation.",
  "sources": "Function parameters, request objects, websocket objects, and URL parameters.",
  "sinks": "RedirectResponse creation, HTTPException raising, websocket.close() calls, and function calls that may process untrusted request data.",
  "flows": "Input scopes and request data flow into has_required_scope and request handling logic; upon failure, redirects or exceptions are triggered.",
  "anomalies": "No suspicious hardcoded secrets, credentials, or obfuscated code. No evidence of malicious backdoors or unusual behavior. The code performs standard authorization checks and request handling.",
  "analysis": "The code implements authorization decorators that verify user scopes for HTTP and websocket connections. It inspects function signatures to dynamically wrap request or websocket handlers. On scope failure, it either redirects or raises an HTTP exception, following standard patterns. No malicious or suspicious code, backdoors, or data exfiltration mechanisms are present. Usage of urlencode and URL formation appears to be standard. The classes define typical user and credential models without hidden or malicious logic.",
  "conclusion": "The code appears to be a standard authorization middleware implementation with no signs of malicious intent or malware. It securely manages user scopes and authentication without suspicious features.",
  "confidence": 1,
  "obfuscated": 0,
  "malware": 0,
  "securityRisk": 0.2,
  "report_number": 1
}