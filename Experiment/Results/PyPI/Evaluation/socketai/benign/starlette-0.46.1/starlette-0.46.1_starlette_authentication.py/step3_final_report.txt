{
  "purpose": "The code implements scope-based authorization decorators for HTTP and WebSocket handlers, along with user and authentication classes, to enforce access control based on user scopes.",
  "sources": "Function parameters named 'request' or 'websocket', request URL, request object properties such as 'auth.scopes' and 'url_for'.",
  "sinks": "RedirectResponse for unauthorized access, HTTPException raising, websocket.close() calls to terminate connections.",
  "flows": "Scope verification reads user or websocket scopes; upon failure, either redirects or raises exceptions; websocket closure occurs if scope check fails.",
  "anomalies": "Use of 'assert' statements for type validation, which could be disabled in production, but this is a common pattern and not malicious.",
  "analysis": "The code provides standard scope validation decorators for both synchronous and asynchronous functions, handling request and websocket objects. It performs straightforward scope checks, redirects on failure if specified, or raises HTTP exceptions. No hardcoded secrets, obfuscation, or malicious network activity are present. The use of 'assert' statements for type checks is noted but is a typical practice. The overall logic is transparent, aligned with common authorization patterns, and lacks any suspicious or malicious code segments.",
  "conclusion": "The code is a legitimate, standard implementation of scope-based authorization decorators with associated user classes. No malicious behavior, backdoors, or obfuscation are detected. The security risk is minimal, primarily related to potential misconfiguration rather than malicious intent. The malware score is 0, obfuscated score is 0, and the overall security risk score is 0.2, which is appropriate given the context.",
  "confidence": 1,
  "obfuscated": 0,
  "malware": 0,
  "securityRisk": 0.2,
  "model": "gpt-4.1-nano"
}