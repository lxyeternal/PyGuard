{
  "package_name": "apple-tv-new-1.0.0",
  "is_malicious": true,
  "files_analyzed": 33,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/setup.py",
      "relative_path": "apple-tv-new-1.0.0/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The code contains a malicious payload embedded after a legitimate-looking setuptools setup script. The suspicious part is the block that executes only on Windows (os.name == 'nt'). It performs the following malicious actions: \n\n1. Changes the working directory to the user's temporary directory obtained via 'echo %temp%'.\n2. Attempts to import 'requests' and if not present, installs it silently via pip without user consent.\n3. Downloads a file from a hardcoded suspicious IP address (http://52.14.229.35:1122/connect-CANDC.txt) and saves it as 'local_copy.txt'.\n4. Renames 'local_copy.txt' to 'local.bat' and executes it silently using cmd shell.\n5. Deletes the batch file after execution to cover tracks.\n6. Runs 'net session' to check for administrative privileges and prints a misleading message if access is denied.\n7. If admin privileges are present, downloads another file from the same suspicious IP (http://52.14.229.35:1122/shoomsha.jpg), saves it as 'local_b.txt', renames to 'loc.bat', executes it, and deletes it afterward.\n\nThis sequence of downloading remote files from an untrusted IP, saving them as batch scripts, executing them silently, and deleting traces is a classic multi-stage malware behavior. The code runs automatically during package installation or import without user interaction or consent, which is a hallmark of supply chain attacks. The use of subprocess.Popen with shell=True to execute downloaded batch files, silent installation of dependencies, and hardcoded attacker-controlled URLs further confirm malicious intent.\n\nTherefore, this code is malicious and poses a high security risk."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/certs.py",
      "relative_path": "apple-tv-new-1.0.0/requests/certs.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/exceptions.py",
      "relative_path": "apple-tv-new-1.0.0/requests/exceptions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/models.py",
      "relative_path": "apple-tv-new-1.0.0/requests/models.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/cookies.py",
      "relative_path": "apple-tv-new-1.0.0/requests/cookies.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/__init__.py",
      "relative_path": "apple-tv-new-1.0.0/requests/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/structures.py",
      "relative_path": "apple-tv-new-1.0.0/requests/structures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/__version__.py",
      "relative_path": "apple-tv-new-1.0.0/requests/__version__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/compat.py",
      "relative_path": "apple-tv-new-1.0.0/requests/compat.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/packages.py",
      "relative_path": "apple-tv-new-1.0.0/requests/packages.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/_internal_utils.py",
      "relative_path": "apple-tv-new-1.0.0/requests/_internal_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/sessions.py",
      "relative_path": "apple-tv-new-1.0.0/requests/sessions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/utils.py",
      "relative_path": "apple-tv-new-1.0.0/requests/utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/api.py",
      "relative_path": "apple-tv-new-1.0.0/requests/api.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/adapters.py",
      "relative_path": "apple-tv-new-1.0.0/requests/adapters.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/help.py",
      "relative_path": "apple-tv-new-1.0.0/requests/help.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/auth.py",
      "relative_path": "apple-tv-new-1.0.0/requests/auth.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/status_codes.py",
      "relative_path": "apple-tv-new-1.0.0/requests/status_codes.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/requests/hooks.py",
      "relative_path": "apple-tv-new-1.0.0/requests/hooks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/test_help.py",
      "relative_path": "apple-tv-new-1.0.0/tests/test_help.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/__init__.py",
      "relative_path": "apple-tv-new-1.0.0/tests/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/test_lowlevel.py",
      "relative_path": "apple-tv-new-1.0.0/tests/test_lowlevel.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/test_structures.py",
      "relative_path": "apple-tv-new-1.0.0/tests/test_structures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/conftest.py",
      "relative_path": "apple-tv-new-1.0.0/tests/conftest.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/compat.py",
      "relative_path": "apple-tv-new-1.0.0/tests/compat.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/utils.py",
      "relative_path": "apple-tv-new-1.0.0/tests/utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/test_utils.py",
      "relative_path": "apple-tv-new-1.0.0/tests/test_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/test_packages.py",
      "relative_path": "apple-tv-new-1.0.0/tests/test_packages.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/test_requests.py",
      "relative_path": "apple-tv-new-1.0.0/tests/test_requests.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/test_hooks.py",
      "relative_path": "apple-tv-new-1.0.0/tests/test_hooks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/test_testserver.py",
      "relative_path": "apple-tv-new-1.0.0/tests/test_testserver.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/testserver/__init__.py",
      "relative_path": "apple-tv-new-1.0.0/tests/testserver/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/apple-tv-new-1.0.0/apple-tv-new-1.0.0/tests/testserver/server.py",
      "relative_path": "apple-tv-new-1.0.0/tests/testserver/server.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}