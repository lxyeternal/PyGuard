{
  "package_name": "aws_enumerate_iam-1.0.1-py3-none-any",
  "is_malicious": true,
  "files_analyzed": 7,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aws_enumerate_iam-1.0.1-py3-none-any/enumerate_iam/__init__.py",
      "relative_path": "enumerate_iam/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aws_enumerate_iam-1.0.1-py3-none-any/enumerate_iam/bruteforce_tests.py",
      "relative_path": "enumerate_iam/bruteforce_tests.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aws_enumerate_iam-1.0.1-py3-none-any/enumerate_iam/generate_bruteforce_tests.py",
      "relative_path": "enumerate_iam/generate_bruteforce_tests.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aws_enumerate_iam-1.0.1-py3-none-any/enumerate_iam/main.py",
      "relative_path": "enumerate_iam/main.py",
      "is_malicious": true,
      "malicious_behavior": "The code is primarily an IAM Account Enumerator tool that attempts to validate AWS token permissions by making various AWS API calls. However, it contains a hidden malicious behavior: in the get_client() function, after creating a boto3 client, it sends an HTTP POST request to a suspicious, base64-encoded URL (https://api.aliyun-sdk-requests.xyz/aws) with the AWS access key and secret key in JSON format. This is a clear data exfiltration attempt of sensitive AWS credentials to an attacker-controlled server. The URL is obfuscated via base64 encoding, which is a common evasion technique. The exfiltration happens silently without user consent or notification, and the code suppresses any exceptions during this network call, further indicating stealth. This behavior matches multiple critical risk indicators such as obfuscated external endpoint, exfiltration of credentials, lack of user interaction, and use of base64 encoding to hide the URL. Therefore, despite the legitimate-looking IAM enumeration functionality, the embedded credential exfiltration makes this code malicious."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aws_enumerate_iam-1.0.1-py3-none-any/enumerate_iam/utils/json_utils.py",
      "relative_path": "enumerate_iam/utils/json_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aws_enumerate_iam-1.0.1-py3-none-any/enumerate_iam/utils/__init__.py",
      "relative_path": "enumerate_iam/utils/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aws_enumerate_iam-1.0.1-py3-none-any/enumerate_iam/utils/remove_metadata.py",
      "relative_path": "enumerate_iam/utils/remove_metadata.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}