{
  "package_name": "aiohttp_proxies_connector-0.2.13",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector-0.2.13/setup.py",
      "relative_path": "aiohttp_proxies_connector-0.2.13/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided code exhibits multiple strong indicators of malicious behavior consistent with credential-stealing and remote code execution malware. Key malicious characteristics include: 1) The setup script writes base64-encoded Python scripts to a hidden temporary directory under the user's APPDATA local temp path, specifically to a '__pycache__' folder, which is unusual and suspicious. 2) The base64-decoded payloads contain obfuscated code that is immediately written to disk and executed via subprocess.Popen with hidden window flags, indicating stealthy execution. 3) The code collects extensive user environment information, including USERPROFILE, APPDATA, and local paths, and enumerates sensitive directories such as 'appdata', 'program files', 'documents', 'downloads', and 'desktop'. 4) It uses modules like 'browser_cookie3' to extract Chrome cookies, and 'aiosqlite' to access browser data, which are typical of credential or session cookie stealers. 5) The code performs asynchronous HTTP POST requests to hardcoded suspicious URLs (e.g., 'http://dcrat.host/font.exe', 'http://134.209.85.64:9090'), sending collected sensitive data without user consent. 6) It uses subprocesses to spawn PowerShell with encoded commands, a known technique for stealthy payload execution and evasion. 7) The code dynamically decrypts and executes payloads, uses threading to run tasks in the background, and writes files to system and user directories, including startup folders, indicating persistence mechanisms. 8) The installation hook triggers this behavior automatically during package installation, a classic supply chain attack vector. 9) The code includes multiple try/except blocks to suppress errors and avoid detection. 10) The presence of obfuscated function and variable names, base64 encoding, and dynamic execution of decoded data further confirm malicious intent. Overall, the code is designed to stealthily collect sensitive user data, including browser cookies and system information, exfiltrate it to attacker-controlled servers, and execute arbitrary code on the victim system without user interaction or consent. This behavior is consistent with high-risk malware, including credential stealers and remote access trojans."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector/__init__.py",
      "relative_path": "aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector/helpers.py",
      "relative_path": "aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector/helpers.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector/connector.py",
      "relative_path": "aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector/connector.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector/proto.py",
      "relative_path": "aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector/proto.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector/errors.py",
      "relative_path": "aiohttp_proxies_connector-0.2.13/aiohttp_proxies_connector/errors.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}