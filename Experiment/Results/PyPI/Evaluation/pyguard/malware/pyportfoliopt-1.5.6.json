{
  "package_name": "pyportfoliopt-1.5.6",
  "is_malicious": true,
  "files_analyzed": 27,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/setup.py",
      "relative_path": "pyportfoliopt-1.5.6/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided Python code exhibits multiple strong indicators of malicious behavior. It contains heavy obfuscation, including meaningless variable and function names, and a large embedded compressed and encoded byte string that is decompressed and executed dynamically via exec. The code uses exec on decompressed data, which is a classic hallmark of malware to hide payloads and evade static analysis. The obfuscated class _invert has methods that perform suspicious operations, including dynamic execution of code stored in the __code__ variable and manipulation of globals and builtins in an unusual manner. The code also includes multiple calls to _invert._run with large base64-like byte strings, which are likely further payloads or stages of the malware. The presence of obfuscated code execution during the module's main execution path, combined with the use of exec on decompressed data, is a critical risk indicator of malicious intent. Additionally, the code is bundled with a legitimate-looking but unrelated setuptools setup script, which is a common tactic in supply chain attacks to hide malicious payloads within otherwise benign packages. The overall structure, obfuscation, and dynamic execution patterns strongly suggest this code is designed to execute hidden malicious payloads, potentially downloading or running further malware, stealing data, or compromising the system. Therefore, this code should be classified as malicious."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/exceptions.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/exceptions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/__init__.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/objective_functions.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/objective_functions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/base_optimizer.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/base_optimizer.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/expected_returns.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/expected_returns.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/risk_models.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/risk_models.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/cla.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/cla.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/black_litterman.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/black_litterman.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/hierarchical_portfolio.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/hierarchical_portfolio.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/discrete_allocation.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/discrete_allocation.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/pypfopt/plotting.py",
      "relative_path": "pyportfoliopt-1.5.6/pypfopt/plotting.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_black_litterman.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_black_litterman.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_base_optimizer.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_base_optimizer.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_custom_objectives.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_custom_objectives.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_imports.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_imports.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_risk_models.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_risk_models.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_cla.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_cla.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_objective_functions.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_objective_functions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_expected_returns.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_expected_returns.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_hrp.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_hrp.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_efficient_frontier.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_efficient_frontier.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_discrete_allocation.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_discrete_allocation.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_efficient_cdar.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_efficient_cdar.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_efficient_semivariance.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_efficient_semivariance.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_efficient_cvar.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_efficient_cvar.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyportfoliopt-1.5.6/pyportfoliopt-1.5.6/tests/test_plotting.py",
      "relative_path": "pyportfoliopt-1.5.6/tests/test_plotting.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}