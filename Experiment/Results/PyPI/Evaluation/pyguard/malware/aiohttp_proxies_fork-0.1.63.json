{
  "package_name": "aiohttp_proxies_fork-0.1.63",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork-0.1.63/setup.py",
      "relative_path": "aiohttp_proxies_fork-0.1.63/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided Python code exhibits multiple strong indicators of malicious behavior consistent with credential-stealing malware and supply chain attacks. Key malicious characteristics include: \n\n1. Execution of base64-decoded payload: The code writes a base64-decoded Python script ('main.cpython-39.py') into a hidden temporary directory and executes it in a hidden process (pythonw) with flags to suppress windows, indicating stealth execution.\n\n2. Automated installation of multiple dependencies (psutil, aiofiles, aiohttp, cryptography, aiosqlite, mss, pypiwin32) without user consent, which are commonly used in malware for system information gathering, file operations, and network communication.\n\n3. The embedded base64-decoded script contains extensive functionality for scanning user directories, extracting sensitive data such as browser cookies (using browser_cookie3), Telegram sessions, Chrome passwords, and other credential stores.\n\n4. The script performs environment reconnaissance by collecting user profile paths, local app data, roaming profiles, and other system-specific directories.\n\n5. It exfiltrates collected data via HTTP POST requests to hardcoded suspicious endpoints, including IP addresses and domains not associated with legitimate software.\n\n6. The code uses obfuscation techniques such as base64 encoding, zlib compression, and dynamic code execution (exec) to hide its true intent and evade detection.\n\n7. It leverages setuptools install hooks to trigger malicious payload execution during package installation, a known supply chain attack vector.\n\n8. The code spawns subprocesses with hidden windows and uses threading to run tasks asynchronously, further indicating attempts to evade user detection.\n\n9. It accesses environment variables and writes files to obscure locations like '__pycache__' in the temp directory, which is unusual for legitimate packages.\n\n10. The presence of suspicious class and function names (e.g., address_st3aler), hardcoded webhook URLs, and encoded PowerShell commands further confirm malicious intent.\n\nOverall, the code is designed to stealthily collect sensitive user information, including credentials and cookies, and exfiltrate it to attacker-controlled servers without user knowledge or consent. This behavior is characteristic of malware and supply chain attacks, making the code highly malicious."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork/__init__.py",
      "relative_path": "aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork/helpers.py",
      "relative_path": "aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork/helpers.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork/connector.py",
      "relative_path": "aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork/connector.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork/proto.py",
      "relative_path": "aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork/proto.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork/errors.py",
      "relative_path": "aiohttp_proxies_fork-0.1.63/aiohttp_proxies_fork/errors.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}