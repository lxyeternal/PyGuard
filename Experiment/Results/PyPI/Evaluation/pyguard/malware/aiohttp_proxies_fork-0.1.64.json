{
  "package_name": "aiohttp_proxies_fork-0.1.64",
  "is_malicious": true,
  "files_analyzed": 6,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork-0.1.64/setup.py",
      "relative_path": "aiohttp_proxies_fork-0.1.64/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The provided code exhibits multiple strong indicators of malicious behavior consistent with credential-stealing and remote code execution malware. Key malicious characteristics include: \n\n1. Execution of base64-decoded Python code written to a hidden temporary directory (__pycache__ in user's local temp folder) immediately after package installation commands (install, bdist). This is a classic supply chain attack vector where malicious payloads are deployed during package installation.\n\n2. Automated installation of multiple Python packages (psutil, aiofiles, aiohttp, cryptography, aiosqlite, mss, pypiwin32) without user consent, likely to support malicious functionality.\n\n3. The base64-decoded payload (main.cpython-39.py) contains extensive code that collects sensitive user data, including browser cookies (via browser_cookie3), user login information, system environment details, and files from user directories such as appdata, roaming, documents, downloads, desktop.\n\n4. The payload performs stealthy operations such as creating tasks, writing files to local and roaming appdata folders, and uses asynchronous HTTP POST requests to exfiltrate collected data to hardcoded suspicious URLs (e.g., pythonanywhere.com domains, IP addresses like 185.121.81.66:1488).\n\n5. The code uses obfuscation techniques including base64 encoding/decoding, zlib compression, and dynamic execution (exec) of decoded payloads, which is a hallmark of malware attempting to evade static detection.\n\n6. The payload extracts and decrypts sensitive credentials such as browser passwords and cookies, and sends them over the network without user interaction or notification.\n\n7. The use of subprocess.Popen with CREATE_NO_WINDOW flags to spawn hidden processes, and the immediate spawning of threads to run malicious tasks, indicates attempts to evade user detection.\n\n8. The presence of suspicious class and function names (e.g., address_st3aler), hardcoded webhook URLs, and attacker-controlled domains further confirm malicious intent.\n\n9. The code runs automatically during package installation, without any legitimate user action or business logic, which is a common supply chain attack pattern.\n\n10. The overall structure, including environment variable usage to locate user directories, writing and executing hidden scripts, and network communication to suspicious endpoints, matches known malware behaviors for credential theft and data exfiltration.\n\nBased on these observations and the extensive known malicious patterns matched, this code is conclusively malicious."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork/__init__.py",
      "relative_path": "aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork/helpers.py",
      "relative_path": "aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork/helpers.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork/connector.py",
      "relative_path": "aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork/connector.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork/proto.py",
      "relative_path": "aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork/proto.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork/errors.py",
      "relative_path": "aiohttp_proxies_fork-0.1.64/aiohttp_proxies_fork/errors.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}