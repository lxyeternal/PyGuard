Run started:2025-05-25 13:05:28.648951

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_eventgrid-0.2.4-py2.py3-none-any/azure/cli/command_modules/eventgrid/_help.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	    """
173	helps['eventgrid event-subscription create'] = """
174	    type: command
175	    short-summary: Create a new event subscription.
176	    parameters:
177	        - name: --advanced-filter
178	          short-summary: An advanced filter enables filtering of events based on a specific event property.
179	          long-summary: |
180	            Usage:                     --advanced-filter KEY[.INNERKEY] FILTEROPERATOR VALUE [VALUE ...]
181	            StringIn:                  --advanced-filter data.Color StringIn Blue Red Orange Yellow
182	            StringNotIn:               --advanced-filter data.Color StringNotIn Blue Red Orange Yellow
183	            StringContains:            --advanced-filter subject StringContains Blue Red
184	            StringBeginsWith:          --advanced-filter subject StringBeginsWith Blue Red
185	            StringEndsWith:            --advanced-filter subject StringEndsWith img png jpg
186	            NumberIn:                  --advanced-filter data.property1 NumberIn 5 10 20
187	            NumberNotIn:               --advanced-filter data.property2 NumberNotIn 100 200 300
188	            NumberLessThan:            --advanced-filter data.property3 NumberLessThan 100
189	            NumberLessThanOrEquals:    --advanced-filter data.property2 NumberLessThanOrEquals 100
190	            NumberGreaterThan:         --advanced-filter data.property3 NumberGreaterThan 100
191	            NumberGreaterThanOrEquals: --advanced-filter data.property2 NumberGreaterThanOrEquals 100
192	            BoolEquals:                --advanced-filter data.property3 BoolEquals true
193	            Multiple advanced filters can be specified by using more than one `--advanced-filter` argument.
194	        - name: --source-resource-id
195	          short-summary: Fully qualified identifier of the Azure resource to which the event subscription needs to be created.
196	          long-summary: |
197	            Usage:                      --source-resource-id Azure-Resource-ID
198	            For Azure subscription:     --source-resource-id /subscriptions/{SubID}
199	            For resource group:         --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1
200	            For EventGrid topic:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/topics/t1
201	            For storage account:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.Storage/storageaccounts/sa1
202	            For EventGrid domain:       --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1
203	            For EventGrid domain topic: --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1/topics/t1
204	        - name: --deadletter-endpoint
205	          short-summary: The Azure resource ID of an Azure Storage blob container destination where EventGrid should deadletter undeliverable events for this event subscription.
206	          long-summary: |
207	            Example: --deadletter-endpoint /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.Storage/storageAccounts/sa1/blobServices/default/containers/containerName
208	        - name: --endpoint-type
209	          short-summary: The type of the destination endpoint.
210	          long-summary: The type of the destination endpoint. It is expected that the destination endpoint be created and available for use before executing any Event Grid command.
211	    examples:
212	        - name: Create a new event subscription for an Event Grid topic, using default filters.
213	          text: |
214	            az eventgrid event-subscription create --name es1 \\
215	                --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1 \\
216	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code
217	        - name: Create a new event subscription for an Azure subscription subscription, using default filters.
218	          text: |
219	            az eventgrid event-subscription create --name es2 \\
220	                --source-resource-id /subscriptions/{SubID} \\
221	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code
222	        - name: Create a new event subscription for a resource group, using default filters.
223	          text: |
224	            az eventgrid event-subscription create --name es3 \\
225	                --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG} \\
226	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code
227	        - name: Create a new event subscription for a storage account, using default filters.
228	          text: |
229	            az eventgrid event-subscription create --name es3 \\
230	                --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/s1"  \\
231	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code
232	        - name: Create a new event subscription for a storage account, using advanced filters.
233	          text: |
234	            az eventgrid event-subscription create  --name es3 \\
235	                --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/s1" \\
236	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code
237	                --advanced-filter data.blobType StringIn BlockBlob
238	                --advanced-filter data.url StringBeginsWith https://myaccount.blob.core.windows.net
239	        - name: Create a new event subscription for an Azure subscription, with a filter specifying a subject prefix.
240	          text: |
241	            az eventgrid event-subscription create --name es4 \\
242	                --source-resource-id /subscriptions/{SubID} \\
243	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code \\
244	                --subject-begins-with mysubject_prefix
245	        - name: Create a new event subscription for a resource group, with a filter specifying a subject suffix.
246	          text: |
247	            az eventgrid event-subscription create --name es5 \\
248	                --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG} \\
249	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code \\
250	                --subject-ends-with mysubject_suffix
251	        - name: Create a new event subscription for an Azure subscription, using default filters, and an EventHub as a destination.
252	          text: |
253	            az eventgrid event-subscription create --name es2 \\
254	                --source-resource-id /subscriptions/{SubID} \\
255	                --endpoint-type eventhub \\
256	                --endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.EventHub/namespaces/n1/eventhubs/EH1
257	        - name: Create a new event subscription for an Azure subscription, using default filters, and an Azure Storage queue as a destination.
258	          text: |
259	            az eventgrid event-subscription create --name es2 \\
260	                --source-resource-id /subscriptions/{SubID} \\
261	                --endpoint-type storagequeue \\
262	                --endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.Storage/storageAccounts/sa1/queueservices/default/queues/q1
263	        - name: Create a new event subscription for an Azure subscription, using default filters, and an Azure ServiceBusQueue as a destination.
264	          text: |
265	            az eventgrid event-subscription create --name es2 \\
266	                --source-resource-id /subscriptions/{SubID} \\
267	                --endpoint-type servicebusqueue \\
268	                --endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.ServiceBus/namespaces/ns1/queues/queue1
269	        - name: Create a new event subscription for a storage account, with a deadletter destination and custom retry policy of maximum 10 delivery attempts and an Event TTL of 2 hours (whichever happens earlier).
270	          text: |
271	            az eventgrid event-subscription create --name es2 \\
272	                --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/s1" \\
273	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code \\
274	                --deadletter-endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.Storage/storageAccounts/s2/blobServices/default/containers/blobcontainer1 \\
275	                --max-delivery-attempts 10 --event-ttl 120
276	        - name: Create a new event subscription for a domain topic.
277	          text: |
278	            az eventgrid event-subscription create --name es2 \\
279	                --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/domains/domain1/topics/t1" \\
280	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code
281	        - name: Create a new event subscription (for a storage account) with an expiration date.
282	          text: |
283	            az eventgrid event-subscription create --name es2 \\
284	                --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/sa1" \\
285	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code
286	                --expiration-date "2018-10-31"
287	    """
288	helps['eventgrid event-subscription update'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_eventgrid-0.2.4-py2.py3-none-any/azure/cli/command_modules/eventgrid/_help.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
287	    """
288	helps['eventgrid event-subscription update'] = """
289	    type: command
290	    short-summary: Update an event subscription.
291	    parameters:
292	        - name: --source-resource-id
293	          short-summary: Fully qualified identifier of the Azure resource whose event subscription needs to be updated.
294	          long-summary: |
295	            Usage:                      --source-resource-id Azure-Resource-ID
296	            For Azure subscription:     --source-resource-id /subscriptions/{SubID}
297	            For resource group:         --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1
298	            For EventGrid topic:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/topics/t1
299	            For storage account:        --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.Storage/storageaccounts/sa1
300	            For EventGrid domain:       --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1
301	            For EventGrid domain topic: --source-resource-id /subscriptions/{SubID}/resourceGroups/rg1/providers/Microsoft.EventGrid/domains/d1/topics/t1
302	        - name: --endpoint-type
303	          short-summary: The type of the destination endpoint.
304	    examples:
305	        - name: Update an event subscription for an Event Grid topic to specify a new endpoint.
306	          text: |
307	            az eventgrid event-subscription update --name es1 \\
308	                --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.EventGrid/topics/topic1 \\
309	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code
310	        - name: Update an event subscription for an Azure subscription to specify a new subject-ends-with filter.
311	          text: |
312	            az eventgrid event-subscription update --name es2 \\
313	                --source-resource-id /subscriptions/{SubID} \\
314	                --subject-ends-with .jpg
315	        - name: Update an event subscription for a resource group to specify a new endpoint and a new subject-ends-with filter.
316	          text: |
317	            az eventgrid event-subscription update --name es3 \\
318	                --source-resource-id /subscriptions/{SubID}/resourceGroups/{RG} \\
319	                --subject-ends-with .png \\
320	                --endpoint https://contoso.azurewebsites.net/api/f1?code=code
321	        - name: Update an event subscription for a storage account to specify a new list of included event types.
322	          text: |
323	            az eventgrid event-subscription update --name es3 \\
324	                --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/microsoft.storage/storageaccounts/kalsegblob" \\
325	                --included-event-types Microsoft.Storage.BlobCreated Microsoft.Storage.BlobDeleted
326	        - name: Update an event subscription for a storage account, to include a deadletter destination.
327	          text: |
328	            az eventgrid event-subscription update --name es2 \\
329	                --source-resource-id "/subscriptions/{SubID}/resourceGroups/{RG}/providers/Microsoft.Storage/storageaccounts/kalsegblob" \\
330	                --deadletter-endpoint /subscriptions/{SubID}/resourceGroups/TestRG/providers/Microsoft.Storage/storageAccounts/sa1/blobServices/default/containers/blobcontainer1
331	    """
332	helps['eventgrid event-subscription delete'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_eventgrid-0.2.4-py2.py3-none-any/azure/cli/command_modules/eventgrid/custom.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
568	
569	        logger.warning('If the provided endpoint does not support subscription validation '
570	                       'handshake, navigate to the validation URL that you receive in the '

--------------------------------------------------

Code scanned:
	Total lines of code: 1265
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 0.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 0.0
Files skipped (0):
