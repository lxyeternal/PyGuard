Run started:2025-05-25 13:17:11.334908

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/acquire.py:2203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2202	        ):
2203	            flavour = platform.system()
2204	        acquire_gui = GUI(flavour=flavour, upload_available=args.auto_upload)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/acquire.py:2203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
2202	        ):
2203	            flavour = platform.system()
2204	        acquire_gui = GUI(flavour=flavour, upload_available=args.auto_upload)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/acquire.py:2203
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
2202	        ):
2203	            flavour = platform.system()
2204	        acquire_gui = GUI(flavour=flavour, upload_available=args.auto_upload)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/crypt.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	        self.cipher.update(header)
128	        self.fh.write(header)
129	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/crypt.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
130	    def write(self, b: bytes) -> int:
131	        return self.fh.write(self.cipher.encrypt(b))
132	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/crypt.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
147	
148	        self.fh.write(digest + footer.dumps())
149	        self.fh.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/dynamic/windows/handles.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	    queue = Queue()
184	    thread = threading.Thread(target=_get_file_name_thread, args=(handle, queue))
185	    thread.daemon = True

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/outputs/dir.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
37	        """
38	        if platform.system() == "Windows":
39	            output_path = output_path.replace(":", "_")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/outputs/dir.py:38
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
37	        """
38	        if platform.system() == "Windows":
39	            output_path = output_path.replace(":", "_")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/outputs/tar.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
53	        if encrypt:
54	            self._fh = EncryptedStream(self.path.open("wb"), public_key)
55	            self.tar = tarfile.open(fileobj=self._fh, mode=mode)  # noqa: SIM115

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/outputs/tar.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
54	            self._fh = EncryptedStream(self.path.open("wb"), public_key)
55	            self.tar = tarfile.open(fileobj=self._fh, mode=mode)  # noqa: SIM115
56	        else:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/outputs/tar.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
56	        else:
57	            self.tar = tarfile.open(name=self.path, mode=mode)  # noqa: SIM115
58	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
96	
97	        file_header_buf = fh.read(len(c_acquire.file))
98	        self.file_header = c_acquire.file(file_header_buf)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
99	
100	        header_buf = fh.read(self.file_header.header_size)
101	        decrypted_header = decrypt_header(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
113	            size = fh.tell() - offset
114	            self.digest = fh.read(self.footer.length)
115	            fh.seek(offset)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
139	                    try:
140	                        chunk = self.fh.read(CHUNK_SIZE)
141	                    except EOFError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
169	        read_size = max(0, min(length, self.size - offset))
170	        return self.cipher.decrypt(self.fh.read(read_size))
171	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
173	        while True:
174	            chunk = self.read(chunk_size)
175	            if not chunk:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
237	        return PKCS1_OAEP.new(rsa_key).decrypt(header)
238	    data = json.dumps({"fingerprint": fingerprint.hex(), "header": base64.b64encode(header).decode()}).encode("utf-8")
239	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:238
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
237	        return PKCS1_OAEP.new(rsa_key).decrypt(header)
238	    data = json.dumps({"fingerprint": fingerprint.hex(), "header": base64.b64encode(header).decode()}).encode("utf-8")
239	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
242	    try:
243	        resp = request.urlopen(req)
244	    except HTTPError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
247	        raise ValueError(f"Failed to decrypt header: {e}")
248	    result = json.loads(resp.read())
249	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
249	
250	    return base64.b64decode(result["header"])
251	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:250
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
249	
250	    return base64.b64decode(result["header"])
251	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
313	                            raise ValueError("stopping")  # noqa: TRY301
314	                        outfh.write(chunk)
315	                        _update(status_queue, task_id, advance=len(chunk))

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
424	    with ctx:
425	        signal_handler = signal.signal(signal.SIGINT, signal.SIG_IGN)
426	        with multiprocessing.Manager() as mp, ProcessPoolExecutor(max_workers=args.workers) as executor:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:425
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
424	    with ctx:
425	        signal_handler = signal.signal(signal.SIGINT, signal.SIG_IGN)
426	        with multiprocessing.Manager() as mp, ProcessPoolExecutor(max_workers=args.workers) as executor:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
425	        signal_handler = signal.signal(signal.SIGINT, signal.SIG_IGN)
426	        with multiprocessing.Manager() as mp, ProcessPoolExecutor(max_workers=args.workers) as executor:
427	            stop_event = mp.Event()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
449	
450	            signal.signal(signal.SIGINT, signal_handler)
451	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/tools/decrypter.py:450
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
449	
450	            signal.signal(signal.SIGINT, signal_handler)
451	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/utils.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
358	    try:
359	        return getpass.getuser()
360	    except Exception:

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/utils.py:359
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
358	    try:
359	        return getpass.getuser()
360	    except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/utils.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
399	    with path.open("w") as f:
400	        f.write(json.dumps(report_data, sort_keys=True, indent=4))
401	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/volatilestream.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
34	    def wrapper(*args: Any, **kwargs: Any) -> Any:
35	        with futures.ThreadPoolExecutor(max_workers=1) as executor:
36	            future = executor.submit(func, *args, **kwargs)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/acquire/volatilestream.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
92	            try:
93	                buf = self._os_read(self.fd, min(length, self.size - offset))
94	            except (BlockingIOError, TimeoutError):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/tests/test_outputs_tar.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
34	
35	    with tarfile.open(tar_output.path) as tar_file:
36	        files = tar_file.getmembers()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/tests/test_outputs_tar.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
58	
59	    encrypted_stream = EncryptedFile(tar_output.path.open("rb"), Path("tests/_data/private_key.pem"))
60	    decrypted_path = tmp_path / "decrypted.tar"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/tests/test_outputs_tar.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
63	
64	    with tarfile.open(name=decrypted_path, mode="r") as tar_file:
65	        assert entry.open().read() == tar_file.extractfile(entry_name).read()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/acquire-3.19.dev2/acquire-3.19.dev2/tests/test_outputs_tar.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
64	    with tarfile.open(name=decrypted_path, mode="r") as tar_file:
65	        assert entry.open().read() == tar_file.extractfile(entry_name).read()

--------------------------------------------------

Code scanned:
	Total lines of code: 6958
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 32.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 32.0
		High: 7.0
Files skipped (0):
