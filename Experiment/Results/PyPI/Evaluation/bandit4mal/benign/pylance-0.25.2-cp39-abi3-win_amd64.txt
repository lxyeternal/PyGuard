Run started:2025-05-25 12:40:45.091055

Test results:
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/_dataset/cache.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
60	                    writer = pa.ipc.new_stream(str(self.cache_file), batch.schema)
61	                writer.write(batch)
62	                yield batch

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/arrow.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
264	            try:
265	                return urlopen(req).read()
266	            except URLError as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	        raise Exception(
19	            "lindera is not installed. Please install it by following https://github.com/lindera/lindera/tree/main/lindera-cli"
20	        )
21	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	        requests = import_requests()
36	        resp = requests.get(
37	            "https://github.com/messense/jieba-rs/raw/refs/heads/main/src/data/dict.txt"
38	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	        resp = requests.get(
37	            "https://github.com/messense/jieba-rs/raw/refs/heads/main/src/data/dict.txt"
38	        )
39	        content = resp.content

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
39	        content = resp.content
40	        with open(os.path.join(dirname, "dict.txt"), "wb") as out:
41	            out.write(content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	        with open(os.path.join(dirname, "dict.txt"), "wb") as out:
41	            out.write(content)
42	    except Exception as _:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        print(
45	            "Download jieba language model failed. Please download dict.txt from "
46	            "https://github.com/messense/jieba-rs/tree/main/src/data "
47	            f"and put it in {dirname}"
48	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    if lm == "ipadic":
56	        url = "https://dlwqk3ibdg1xh.cloudfront.net/mecab-ipadic-2.7.0-20070801.tar.gz"
57	    elif lm == "ko-dic":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	    elif lm == "ko-dic":
58	        url = "https://dlwqk3ibdg1xh.cloudfront.net/mecab-ko-dic-2.1.1-20180720.tar.gz"
59	    elif lm == "unidic":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    elif lm == "unidic":
60	        url = "https://dlwqk3ibdg1xh.cloudfront.net/unidic-mecab-2.1.2.tar.gz"
61	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	    print(f"downloading language model: {url}")
65	    data = requests.get(url).content
66	    print(f"unzip language model: {url}")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/download.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
70	        os.chdir(src_dirname)
71	        with tarfile.open(fileobj=BytesIO(data)) as tar:
72	            tar.extractall()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/progress.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
142	            }
143	            out.write(json.dumps(progress_data).encode("utf-8"))
144	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/progress.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
145	        with self._fs.open_output_stream(self._fragment_file(fragment)) as out:
146	            out.write(json.dumps(fragment.to_json()).encode("utf-8"))
147	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/ray/sink.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	            warnings.warn(
151	                "write_results type is wrong. please check version, "
152	                "upgrade or downgrade your ray version. ray versions >= 2.38 "
153	                "and < 2.41 are unable to write Lance datasets, check ray PR "
154	                "https://github.com/ray-project/ray/pull/49251 in your "
155	                "ray version. ",
156	                DeprecationWarning,
157	            )
158	            return

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/torch/async_dataset.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
53	        self.started = True
54	        self.worker = Process(
55	            target=_worker_ep,
56	            args=(self.dataset_creator, self.queue, self.shutdown),
57	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pylance-0.25.2-cp39-abi3-win_amd64/lance/types.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	        raise TypeError(
99	            f"Unknown data type {type(data_obj)}. "
100	            "Please check "

--------------------------------------------------

Code scanned:
	Total lines of code: 10132
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 10.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 0.0
Files skipped (0):
