Run started:2025-05-25 12:51:12.129690

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/setup.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
15	      description='Monitoring and Profiling Service',
16	      long_description=open(readme_file).read(),
17	      author='whatap',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	      license='Whatap License',
20	      url='https://www.whatap.io',
21	      packages=find_packages(exclude=('whatap_dev', 'whatap_dev.*')),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
56	        with open('whatap.conf') as f:
57	            file_content = f.read()
58	        temporary_file_content = '[dummy_section]\n' + file_content

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
167	        f = open(os.path.join(os.environ.get(home), file_name), 'w+')
168	        f.write(value)
169	        f.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
216	                'r') as f:
217	            content = f.read()
218	            try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
219	                with open(config_file, 'w+') as new_f:
220	                    new_f.write(content)
221	            except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
247	                content += '\n{0}={1}\n'.format(opt_key, opt_value)
248	            open(config_file, 'w+').write(content)
249	    

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
386	            with open(cmdlinepath) as f:
387	                content = f.read()
388	                if content:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
399	
400	        source_cwd = os.path.join(os.path.join(os.path.dirname(__file__), 'agent'), platform.system().lower(),
401	                                  ARCH[platform.machine()])

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
399	
400	        source_cwd = os.path.join(os.path.join(os.path.dirname(__file__), 'agent'), platform.system().lower(),
401	                                  ARCH[platform.machine()])

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:400
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
399	
400	        source_cwd = os.path.join(os.path.join(os.path.dirname(__file__), 'agent'), platform.system().lower(),
401	                                  ARCH[platform.machine()])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
580	            lastPortFound += 1
581	        f.write(str(lastPortFound))
582	        f.write('\t')    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
581	        f.write(str(lastPortFound))
582	        f.write('\t')    
583	        f.write(home)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
582	        f.write('\t')    
583	        f.write(home)
584	        f.write('\n')    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/__init__.py:584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
583	        f.write(home)
584	        f.write('\n')    
585	        fcntl.lockf(f, fcntl.LOCK_UN)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/packet_enum.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
5	
6	    SERVER = "127.0.0.1"
7	    PORT = 6600

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
43	                    os.makedirs(prefix)
44	                sock = socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM)
45	                sock.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, PacketEnum.PACKET_SEND_BUFFER_SIZE)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
46	                sock.bind(tmp_socket_path)
47	                sock.connect(unix_socket_path)
48	                sock.settimeout(cls.read_timeout)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
47	                sock.connect(unix_socket_path)
48	                sock.settimeout(cls.read_timeout)
49	                if cls.s:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
50	                    try:
51	                        cls.s.close()
52	                    except Exception as e:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:56
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
55	        else:
56	            sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
57	            sock.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, PacketEnum.PACKET_SEND_BUFFER_SIZE)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
57	            sock.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, PacketEnum.PACKET_SEND_BUFFER_SIZE)
58	            sock.connect((PacketEnum.SERVER, int(conf.net_udp_port)))
59	            sock.settimeout(cls.read_timeout)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
58	            sock.connect((PacketEnum.SERVER, int(conf.net_udp_port)))
59	            sock.settimeout(cls.read_timeout)
60	            if cls.s:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
61	                try:
62	                    cls.s.close()
63	                except Exception as e:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
72	            if sum( [ len(x) for x in cls.buffer_arr]) + sum( [len(x) if isinstance(x, (str, bytes)) else 4 for x in datas ] ) +PacketEnum.PACKET_BODY_REQUIRED_SIZE + 1 > PacketEnum.PACKET_BUFFER_SIZE:
73	                cls.send(packet_type, ctx)
74	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
117	                        or packet_type == PacketTypeEnum.TX_END:
118	                    cls.send(packet_type, ctx)
119	        except Exception as e:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
134	            sendbuf = b''.join(cls.buffer_arr)
135	            s.send(sendbuf)
136	        except ConnectionRefusedError as e:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
143	            logging.debug(e, extra={'id': 'WA912'}, exc_info=True)
144	            cls.send(packet_type, ctx)
145	            logging.debug('re send!')

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
154	        try:
155	            received = cls.s.recv(1024)
156	            if received:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/net/udp_session.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
266	            if sum( [ len(x) for x in cls.buffer_arr]) + PacketEnum.PACKET_BODY_REQUIRED_SIZE + 1 > PacketEnum.PACKET_BUFFER_SIZE:
267	                cls.send(packet_type, None)
268	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/scripts/__init__.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
27	    try:
28	        os.system('killall {}'.format(AGENT_NAME))
29	    except Exception as e:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/scripts/__init__.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
27	    try:
28	        os.system('killall {}'.format(AGENT_NAME))
29	    except Exception as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/trace/mod/httpc_django.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
23	            httpc_url = args[0].upstream
24	            callback = interceptor_httpc_request(fn, httpc_url, *args, **kwargs)
25	            return callback

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/trace/mod/httpc_httplib.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
20	                httpc_url = getattr(args[0], 'host') + httpc_url
21	            callback = interceptor_httpc_request(fn, httpc_url, *newargs, **kwargs)
22	            return callback

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/trace/mod/httpc_httplib.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
53	                httpc_url = getattr(args[0], 'host') + httpc_url
54	            callback = interceptor_httpc_request(fn, httpc_url, *newargs, **kwargs)
55	        

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/trace/mod/httpc_requests.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
13	            httpc_url = args[1].url
14	            callback = interceptor_httpc_request(fn, httpc_url, *args, **kwargs)
15	            return callback

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/trace/mod/httpc_urllib3.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
19	                httpc_url = getattr(args[0], 'host') + httpc_url
20	            callback = interceptor_httpc_request(fn, httpc_url, *newargs, **kwargs)
21	            return callback

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/trace/trace_context.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
25	        self.id = TraceContextManager.getId()
26	        self.thread = threading.current_thread()
27	        self.thread_id = self.thread.ident

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/trace/trace_context_manager.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
99	    def setLocalContext(cls, o):
100	        o.thread = threading.current_thread()
101	        o.thread_id = o.thread.ident

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/whatap_python-1.7.9/whatap_python-1.7.9/whatap/util/ip_util.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
17	            except Exception:
18	                return '0.0.0.0'
19	

--------------------------------------------------

Code scanned:
	Total lines of code: 8030
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 33.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 4.0
Files skipped (0):
