Run started:2025-05-25 12:38:55.440658

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/_help.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	
76	helps["sf cluster create"] = """
77	    type: command
78	    short-summary: Create a new Azure Service Fabric cluster.
79	    examples:
80	        - name: Create a cluster with a given size and self-signed certificate that is downloaded locally.
81	          text: >
82	            az sf cluster create -g group-name -n cluster1 -l westus --cluster-size 4 --vm-password Password#1234 --certificate-output-folder MyCertificates --certificate-subject-name cluster1
83	        - name: Use a keyvault certificate and custom template to deploy a cluster.
84	          text: >
85	            az sf cluster create -g group-name -n cluster1 -l westus --template-file template.json \\
86	                --parameter-file parameter.json --secret-identifier https://{KeyVault}.vault.azure.net:443/secrets/{MyCertificate}
87	
88	"""
89	
90	helps["sf cluster certificate add"] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/_help.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	
90	helps["sf cluster certificate add"] = """
91	    type: command
92	    short-summary: Add a secondary cluster certificate to the cluster.
93	    examples:
94	        - name: Add a certificate to a  cluster using a keyvault secret identifier.
95	          text: |
96	            az sf cluster certificate add -g group-name -n cluster1 \\
97	                --secret-identifier 'https://{KeyVault}.vault.azure.net/secrets/{Secret}'
98	        - name: Add a self-signed certificate to a cluster.
99	          text: >
100	             az sf cluster certificate add -g group-name -n cluster1 --certificate-subject-name test.com
101	
102	"""
103	
104	helps["sf cluster certificate remove"] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/_help.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	
213	helps["sf application certificate add"] = """
214	    type: command

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
607	    import threading
608	    t1 = threading.Thread(target=wait, args=[cli_ctx, vmss_poll])
609	    t2 = threading.Thread(target=wait, args=[cli_ctx, update_cluster_poll])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
608	    t1 = threading.Thread(target=wait, args=[cli_ctx, vmss_poll])
609	    t2 = threading.Thread(target=wait, args=[cli_ctx, update_cluster_poll])
610	    t1.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
990	        json_data['storageAccountKey'] = list_results.keys[0].value
991	        json_data['storageAccountEndPoint'] = "https://core.windows.net/"
992	        diagnostics_ext.protected_settings = json_data

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1129	            certificate_thumbprint = b64_to_hex(
1130	                base64.b64encode(result.x509_thumbprint))
1131	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1130
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1129	            certificate_thumbprint = b64_to_hex(
1130	                base64.b64encode(result.x509_thumbprint))
1131	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1160	            certificate_thumbprint = b64_to_hex(
1161	                base64.b64encode(kv_result.x509_thumbprint))
1162	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1161
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1160	            certificate_thumbprint = b64_to_hex(
1161	                base64.b64encode(kv_result.x509_thumbprint))
1162	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1203	        for vmss in vmsses:
1204	            t = threading.Thread(target=_add_cert_to_vmss, args=[cli_ctx, vmss, resource_group_name, vault_id, secret_url])
1205	            t.start()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1364	    import base64
1365	    decoded = base64.b64decode(cert_bytes)
1366	    try:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1365
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1364	    import base64
1365	    decoded = base64.b64decode(cert_bytes)
1366	    try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1392	    import binascii
1393	    certificate_data = open(certificate_data, 'rb').read()
1394	    x509 = None

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1470	            import base64
1471	            decoded = base64.b64decode(secret_value)
1472	            p12 = crypto.load_pkcs12(decoded)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1471
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1470	            import base64
1471	            decoded = base64.b64decode(secret_value)
1472	            p12 = crypto.load_pkcs12(decoded)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1473	            f_pem = open(pem_path, 'wb')
1474	            f_pem.write(crypto.dump_privatekey(
1475	                crypto.FILETYPE_PEM, p12.get_privatekey()))
1476	            f_pem.write(crypto.dump_certificate(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1475	                crypto.FILETYPE_PEM, p12.get_privatekey()))
1476	            f_pem.write(crypto.dump_certificate(
1477	                crypto.FILETYPE_PEM, p12.get_certificate()))
1478	            ca = p12.get_ca_certificates()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1480	                for cert in ca:
1481	                    f_pem.write(crypto.dump_certificate(
1482	                        crypto.FILETYPE_PEM, cert))
1483	            f_pem.close()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1491	            import base64
1492	            decoded = base64.b64decode(secret_value)
1493	            p12 = crypto.load_pkcs12(decoded)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1492
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1491	            import base64
1492	            decoded = base64.b64decode(secret_value)
1493	            p12 = crypto.load_pkcs12(decoded)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azure_cli_servicefabric-0.1.20-py2.py3-none-any/azure/cli/command_modules/servicefabric/custom.py:1495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1494	            with open(pfx_path, 'wb') as f:
1495	                f.write(decoded)
1496	        except Exception as ex:  # pylint: disable=broad-except

--------------------------------------------------

Code scanned:
	Total lines of code: 1964
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 5.0
Files skipped (0):
