Run started:2025-05-25 12:34:26.541428

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_anthropic_utils.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
75	            "media_type": mime_type,
76	            "data": base64.b64encode(image_bytes).decode("ascii"),
77	        }

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_anthropic_utils.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
75	            "media_type": mime_type,
76	            "data": base64.b64encode(image_bytes).decode("ascii"),
77	        }

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_anthropic_utils.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
90	            "media_type": mime_type,
91	            "data": base64.b64encode(image_data).decode("ascii"),
92	        }

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_anthropic_utils.py:91
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
90	            "media_type": mime_type,
91	            "data": base64.b64encode(image_data).decode("ascii"),
92	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_anthropic_utils.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        raise ValueError(
95	            "Anthropic only supports base64-encoded images and urls currently."
96	            " Example: data:image/png;base64,'/9j/4AAQSk'..."
97	            " Example: https://your-valid-image-url.png"

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_image_utils.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
168	            encoded_string = match.group(1)
169	            return base64.b64decode(encoded_string)
170	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_image_utils.py:169
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
168	            encoded_string = match.group(1)
169	            return base64.b64decode(encoded_string)
170	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_image_utils.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	
186	        response = requests.get(url)
187	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_image_utils.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
258	        image_type = "image"
259	    encoded_bytes = base64.b64encode(image_bytes).decode(encoding)
260	    return f"data:{image_type}/{image_format};base64,{encoded_bytes}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_image_utils.py:259
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
258	        image_type = "image"
259	    encoded_bytes = base64.b64encode(image_bytes).decode(encoding)
260	    return f"data:{image_type}/{image_format};base64,{encoded_bytes}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_image_utils.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
303	
304	    if content_part.get("type") != "image_url":
305	        return None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_image_utils.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
306	
307	    image_str = content_part.get("image_url", {}).get("url")
308	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_image_utils.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
306	
307	    image_str = content_part.get("image_url", {}).get("url")
308	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_image_utils.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
328	
329	    if content_part.get("type") != "text":
330	        return None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/_image_utils.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
331	
332	    text = content_part.get("text")
333	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/embeddings.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
179	        self.instance["batch_size_validated"] = False
180	        self.instance["task_executor"] = ThreadPoolExecutor(
181	            max_workers=request_parallelism
182	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/model_garden.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
124	        """Run the LLM on the given prompt and input."""
125	        instances = self._prepare_request(prompts, **kwargs)
126	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/model_garden.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
148	        """Run the LLM on the given prompt and input."""
149	        instances = self._prepare_request(prompts, **kwargs)
150	        if self.single_example_per_request and len(instances) > 1:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/model_garden_maas/_base.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    credentials = (
52	        auth.default(scopes=["https://www.googleapis.com/auth/cloud-platform"])[0]
53	        if not credentials

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/model_garden_maas/_base.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
228	        else:
229	            response = await llm.async_client.post(url=llm._get_url_part(), json=kwargs)
230	            await _araise_on_error(response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/langchain_google_vertexai-2.0.19/langchain_google_vertexai-2.0.19/langchain_google_vertexai/model_garden_maas/_base.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
263	        return iter_sse()
264	    response = llm.client.post(url=llm._get_url_part(), json=kwargs)
265	    _raise_on_error(response)

--------------------------------------------------

Code scanned:
	Total lines of code: 8665
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 4.0
Files skipped (0):
