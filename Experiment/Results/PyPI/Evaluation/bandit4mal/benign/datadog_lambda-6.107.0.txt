Run started:2025-05-25 12:39:51.611971

Test results:
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/api.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
20	    """
21	    decoded_bytes = base64.b64decode(ciphertext)
22	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/api.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
20	    """
21	    decoded_bytes = base64.b64decode(ciphertext)
22	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/api.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	        endpoint_url = (
82	            f"https://secretsmanager-fips.{secrets_region}.amazonaws.com"
83	            if is_gov_region

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/api.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        fips_endpoint = (
95	            f"https://ssm-fips.{LAMBDA_REGION}.amazonaws.com" if is_gov_region else None
96	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/api.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
103	        fips_endpoint = (
104	            f"https://kms-fips.{LAMBDA_REGION}.amazonaws.com" if is_gov_region else None
105	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/api.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	        api._api_host = os.environ.get(
128	            "DATADOG_HOST", "https://api." + os.environ.get("DD_SITE", "datadoghq.com")
129	        )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/dogstatsd.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
50	    def _get_udp_socket(cls, host, port):
51	        sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
52	        sock.setblocking(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/dogstatsd.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
53	        cls._ensure_min_send_buffer_size(sock)
54	        sock.connect((host, port))
55	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/dogstatsd.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
73	                try:
74	                    self.socket.close()
75	                except OSError as e:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/dogstatsd.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
107	            mysocket = self.socket or self.get_socket()
108	            mysocket.send(packet.encode(self.encoding))
109	            return True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/extension.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	
4	AGENT_URL = "http://127.0.0.1:8124"
5	FLUSH_PATH = "/lambda/flush"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/extension.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
19	        req = urllib.request.Request(AGENT_URL + FLUSH_PATH, "".encode("ascii"))
20	        urllib.request.urlopen(req)
21	    except Exception as e:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/patch.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
143	    if request.headers.get("Content-Encoding") == "deflate":
144	        data = zlib.decompress(data)
145	    data_dict = json.loads(data)

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/patch.py:144
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
143	    if request.headers.get("Content-Encoding") == "deflate":
144	        data = zlib.decompress(data)
145	    data_dict = json.loads(data)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/tracing.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
263	                if dd_json_data:
264	                    dd_json_data = base64.b64decode(dd_json_data)
265	            elif dd_json_data_type == "String":

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/tracing.py:264
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
263	                if dd_json_data:
264	                    dd_json_data = base64.b64decode(dd_json_data)
265	            elif dd_json_data_type == "String":

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/tracing.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
378	            b64_bytes = data.encode("ascii")
379	            str_bytes = base64.b64decode(b64_bytes)
380	            data_str = str_bytes.decode("ascii")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/tracing.py:379
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
378	            b64_bytes = data.encode("ascii")
379	            str_bytes = base64.b64decode(b64_bytes)
380	            data_str = str_bytes.decode("ascii")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/tracing.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
559	
560	        injected_data = json.loads(base64.b64decode(dd_data_raw))
561	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/tracing.py:560
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
559	
560	        injected_data = json.loads(base64.b64decode(dd_data_raw))
561	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/trigger.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
246	        with gzip.GzipFile(
247	            fileobj=BytesIO(base64.b64decode(event.get("awslogs", {}).get("data")))
248	        ) as decompress_stream:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/trigger.py:247
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
246	        with gzip.GzipFile(
247	            fileobj=BytesIO(base64.b64decode(event.get("awslogs", {}).get("data")))
248	        ) as decompress_stream:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/wrapper.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
277	
278	        datadog_data = base64.b64encode(
279	            json.dumps(injected_headers, escape_forward_slashes=False).encode()
280	        ).decode()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/wrapper.py:278
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
277	
278	        datadog_data = base64.b64encode(
279	            json.dumps(injected_headers, escape_forward_slashes=False).encode()
280	        ).decode()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/xray.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
26	        if not self.sock:
27	            self._connect()
28	        try:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/xray.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
28	        try:
29	            self.sock.send(payload.encode("utf-8"))
30	        except Exception as e_send:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/xray.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
33	    def _connect(self):
34	        self.sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
35	        self.sock.setblocking(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/xray.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
35	        self.sock.setblocking(0)
36	        self.sock.connect(self.host_port_tuple)
37	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/datadog_lambda-6.107.0/datadog_lambda-6.107.0/datadog_lambda/xray.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
128	    segment_payload = build_segment_payload(segment)
129	    sock.send(segment_payload)

--------------------------------------------------

Code scanned:
	Total lines of code: 3175
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 9.0
Files skipped (0):
