Run started:2025-05-25 12:37:56.924636

Test results:
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_page_inputs.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
39	    def from_base64(cls, body):
40	        return cls(body=b64decode(body.encode()))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_page_inputs.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
39	    def from_base64(cls, body):
40	        return cls(body=b64decode(body.encode()))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
864	        )
865	        decoded_body = b64decode(body)
866	        if decoded_body != request.body:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:865
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
864	        )
865	        decoded_body = b64decode(body)
866	        if decoded_body != request.body:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:873
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
872	    elif request.body != b"":
873	        base64_body = b64encode(request.body).decode()
874	        api_params["httpRequestBody"] = base64_body

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:873
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
872	    elif request.body != b"":
873	        base64_body = b64encode(request.body).decode()
874	        api_params["httpRequestBody"] = base64_body

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
913	):
914	    _set_http_response_body_from_request(api_params=api_params, request=request)
915	    _set_http_response_headers_from_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
914	    _set_http_response_body_from_request(api_params=api_params, request=request)
915	    _set_http_response_headers_from_request(
916	        api_params=api_params,
917	        default_params=default_params,
918	        meta_params=meta_params,
919	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
919	    )
920	    _set_http_request_method_from_request(api_params=api_params, request=request)
921	    _set_request_headers_from_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
920	    _set_http_request_method_from_request(api_params=api_params, request=request)
921	    _set_request_headers_from_request(
922	        api_params=api_params,
923	        request=request,
924	        skip_headers=skip_headers,
925	        browser_headers=browser_headers,
926	        browser_ignore_headers=browser_ignore_headers,
927	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
927	    )
928	    _set_http_request_body_from_request(api_params=api_params, request=request)
929	    if cookies_enabled:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:931
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
930	        assert cookie_jars is not None  # typing
931	        _set_http_response_cookies_from_request(api_params=api_params)
932	        _set_http_request_cookies_from_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:932
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
931	        _set_http_response_cookies_from_request(api_params=api_params)
932	        _set_http_request_cookies_from_request(
933	            api_params=api_params,
934	            request=request,
935	            cookie_jars=cookie_jars,
936	            max_cookies=max_cookies,
937	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_params.py:1064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1063	
1064	    _update_api_params_from_request(
1065	        params,
1066	        request,
1067	        default_params=default_params,
1068	        meta_params=meta_params,
1069	        skip_headers=skip_headers,
1070	        browser_headers=browser_headers,
1071	        browser_ignore_headers=browser_ignore_headers,
1072	        cookies_enabled=cookies_enabled,
1073	        cookie_jars=cookie_jars,
1074	        max_cookies=max_cookies,
1075	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_request_fingerprinter.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
83	            if "httpRequestText" in api_params:
84	                api_params["httpRequestBody"] = b64encode(
85	                    api_params.pop("httpRequestText").encode()
86	                ).decode()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_request_fingerprinter.py:84
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
83	            if "httpRequestText" in api_params:
84	                api_params["httpRequestBody"] = b64encode(
85	                    api_params.pop("httpRequestText").encode()
86	                ).decode()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_session.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    logger.warning(
38	        f"Request {request} had no session ID assigned, unexpectedly. "
39	        f"If you are sure this issue is not caused by your own code, "

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_session.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
742	        if _DOWNLOAD_NEEDS_SPIDER:
743	            deferred = self._crawler.engine.download(  # type: ignore[call-arg]
744	                session_init_request, spider=spider
745	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_session.py:747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
746	        else:
747	            deferred = self._crawler.engine.download(session_init_request)
748	        try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_session.py:802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
801	                    raise RuntimeError(
802	                        f"Could not get a session ID from the session "
803	                        f"rotation queue after {attempts} attempts, waiting "
804	                        f"at least {self._queue_wait_time} seconds between "
805	                        f"attempts. Either the values of the "

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_session.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
881	        with self._fatal_error_handler:
882	            if self.is_init_request(request):
883	                return True

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_session.py:924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
923	        with self._fatal_error_handler:
924	            if self.is_init_request(request) or request.meta.get(
925	                "_zyte_api_session_assigned", False

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_session.py:960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
959	            request.meta.setdefault("_zyte_api_session_assigned", True)
960	            return session_config.process_request(request)
961	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_session.py:1014
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1013	        if not passed:
1014	            new_request_or_none = get_retry_request(
1015	                request,
1016	                spider=spider,
1017	                reason="session_expired",
1018	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_session.py:1029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1028	            not isinstance(exception, RequestError)
1029	            or self._sessions.is_init_request(request)
1030	            or not self._sessions.is_enabled(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/_session.py:1045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1044	
1045	        return get_retry_request(
1046	            request,
1047	            spider=spider,
1048	            reason=reason,
1049	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/handler.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
185	            return deferred_from_coro(
186	                self._download_request(api_params, request, spider)
187	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/handler.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
188	        assert self._fallback_handler
189	        return self._fallback_handler.download_request(request, spider)
190	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/handler.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
251	            retrying = self._retry_policy
252	        self._log_request(api_params)
253	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/providers.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
271	        api_response: ZyteAPITextResponse = await maybe_deferred_to_future(
272	            cast("Deferred[ZyteAPITextResponse]", crawler.engine.download(api_request))
273	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/responses.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
128	        elif api_response.get("httpResponseBody"):
129	            body = b64decode(api_response["httpResponseBody"])
130	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/responses.py:129
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
128	        elif api_response.get("httpResponseBody"):
129	            body = b64decode(api_response["httpResponseBody"])
130	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/responses.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
157	            status=api_response.get("statusCode") or 200,
158	            body=b64decode(api_response.get("httpResponseBody") or ""),
159	            request=request,

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/responses.py:158
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
157	            status=api_response.get("statusCode") or 200,
158	            body=b64decode(api_response.get("httpResponseBody") or ""),
159	            request=request,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/responses.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
204	            # FIXME: update this when python-zyte-api supports base64 decoding
205	            body=b64decode(api_response["httpResponseBody"]),  # type: ignore
206	        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scrapy_zyte_api-0.29.0/scrapy_zyte_api-0.29.0/scrapy_zyte_api/responses.py:205
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
204	            # FIXME: update this when python-zyte-api supports base64 decoding
205	            body=b64decode(api_response["httpResponseBody"]),  # type: ignore
206	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 3497
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 27.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 7.0
Files skipped (0):
