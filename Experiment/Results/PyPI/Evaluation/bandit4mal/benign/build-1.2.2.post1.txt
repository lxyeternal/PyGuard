Run started:2025-05-25 13:16:18.017466

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/docs/conf.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	intersphinx_mapping = {
42	    'python': ('https://docs.python.org/3/', None),
43	    'packaging': ('https://packaging.python.org/en/latest/', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/docs/conf.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	    'python': ('https://docs.python.org/3/', None),
43	    'packaging': ('https://packaging.python.org/en/latest/', None),
44	}

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/__main__.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
95	
96	    if platform.system() == 'Windows':
97	        try:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/__main__.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
95	
96	    if platform.system() == 'Windows':
97	        try:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/__main__.py:96
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
95	
96	    if platform.system() == 'Windows':
97	        try:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/__main__.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
274	        # extract sdist
275	        with tarfile.TarFile.open(sdist) as t:
276	            t.extractall(sdist_out)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/__main__.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
283	            finally:
284	                shutil.rmtree(sdist_out, ignore_errors=True)
285	    return [sdist_name, *built]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/_builder.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	        with open(path, 'rb') as f:
63	            return tomllib.loads(f.read().decode())
64	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/_ctx.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
53	
54	        with concurrent.futures.ThreadPoolExecutor(max_workers=2) as executor, subprocess.Popen(
55	            cmd, encoding='utf-8', env=env, stdout=subprocess.PIPE, stderr=subprocess.PIPE

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/env.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
102	        if os.path.exists(self._path):  # in case the user already deleted skip remove
103	            shutil.rmtree(self._path)
104	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/env.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
180	    def _get_minimum_pip_version_str() -> str:
181	        if platform.system() == 'Darwin':
182	            release, _, machine = platform.mac_ver()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/env.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
180	    def _get_minimum_pip_version_str() -> str:
181	        if platform.system() == 'Darwin':
182	            release, _, machine = platform.mac_ver()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/env.py:181
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
180	    def _get_minimum_pip_version_str() -> str:
181	        if platform.system() == 'Darwin':
182	            release, _, machine = platform.mac_ver()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/env.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
245	        with tempfile.NamedTemporaryFile('w', prefix='build-reqs-', suffix='.txt', delete=False, encoding='utf-8') as req_file:
246	            req_file.write(os.linesep.join(requirements))
247	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/src/build/env.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
245	        with tempfile.NamedTemporaryFile('w', prefix='build-reqs-', suffix='.txt', delete=False, encoding='utf-8') as req_file:
246	            req_file.write(os.linesep.join(requirements))
247	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/conftest.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	)
31	PYPY3_WIN_M = 'https://foss.heptapod.net/pypy/pypy/-/issues/3323 and https://foss.heptapod.net/pypy/pypy/-/issues/3321'
32	
33	
34	def pytest_collection_modifyitems(config, items):

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/conftest.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
119	
120	    os.chmod(file, ~stat.S_IRWXU)
121	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/conftest.py:120
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
119	
120	    os.chmod(file, ~stat.S_IRWXU)
121	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/conftest.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
123	
124	    os.chmod(file, orig_stat)
125	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/conftest.py:124
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
123	
124	    os.chmod(file, orig_stat)
125	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/conftest.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
132	
133	    shutil.rmtree(path)
134	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/packages/test-cant-build-via-sdist/backend_bad_sdist.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
10	    file = f'{name}.tar.gz'
11	    with tarfile.open(os.path.join(sdist_directory, file), 'w') as t:
12	        t.add('pyproject.toml', f'{name}/pyproject.toml')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/test_integration.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	        if not os.path.exists(tarball):
63	            url = f'https://github.com/{github_org_repo}/archive/{version}.tar.gz'
64	            with urllib.request.urlopen(url) as request, open(tarball, 'wb') as file_handler:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/test_integration.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
63	            url = f'https://github.com/{github_org_repo}/archive/{version}.tar.gz'
64	            with urllib.request.urlopen(url) as request, open(tarball, 'wb') as file_handler:
65	                shutil.copyfileobj(request, file_handler)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/test_integration.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
63	            url = f'https://github.com/{github_org_repo}/archive/{version}.tar.gz'
64	            with urllib.request.urlopen(url) as request, open(tarball, 'wb') as file_handler:
65	                shutil.copyfileobj(request, file_handler)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/test_integration.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
63	            url = f'https://github.com/{github_org_repo}/archive/{version}.tar.gz'
64	            with urllib.request.urlopen(url) as request, open(tarball, 'wb') as file_handler:
65	                shutil.copyfileobj(request, file_handler)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/test_integration.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
65	                shutil.copyfileobj(request, file_handler)
66	    with tarfile.open(tarball, 'r:gz') as tar_handler:
67	        tar_handler.extractall(str(dest))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/test_projectbuilder.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
462	    with open(out, 'w', encoding='utf-8') as f:
463	        f.write('Not a directory')
464	    with pytest.raises(build.BuildException, match='Build path .* exists and is not a directory'):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/build-1.2.2.post1/build-1.2.2.post1/tests/test_self_packaging.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
87	
88	    with tarfile.open(str(sdist), 'r:gz') as tar:
89	        simpler = {n.split('/', 1)[-1] for n in tar.getnames()}

--------------------------------------------------

Code scanned:
	Total lines of code: 2877
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 21.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 4.0
Files skipped (0):
