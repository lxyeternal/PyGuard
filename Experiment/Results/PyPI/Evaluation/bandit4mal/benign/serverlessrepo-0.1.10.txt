Run started:2025-05-25 13:22:42.354293

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/serverlessrepo/__version__.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	)
10	__url__ = 'https://github.com/awslabs/aws-serverlessrepo-python'
11	__author__ = 'Amazon Web Services'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/serverlessrepo/exceptions.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	
35	    MESSAGE = "The AWS Serverless Application Repository does not have read access to bucket '{bucket}', " \
36	              "key '{key}'. Please update your Amazon S3 bucket policy to grant the service read " \

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
17	with open(path.join(here, 'README.md'), encoding='utf-8') as f:
18	    long_description = '\n' + f.read()
19	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/setup.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
21	with open(path.join(here, 'serverlessrepo', '__version__.py')) as f:
22	    exec(f.read(), about)
23	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/setup.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	with open(path.join(here, 'serverlessrepo', '__version__.py')) as f:
22	    exec(f.read(), about)
23	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/tests/unit/test_application_metadata.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	            'Labels': ['label1', 'label2', 'label3'],
20	            'HomePageUrl': 'https://github.com/my-id/my-repo/',
21	            'SemanticVersion': '1.0.0',
22	            'SourceCodeUrl': 's3://bucket/code.zip'
23	        }
24	        app_metadata = ApplicationMetadata(app_metadata_dict)
25	        self.assertEqual(app_metadata.name, app_metadata_dict['Name'])
26	        self.assertEqual(app_metadata.description, app_metadata_dict['Description'])
27	        self.assertEqual(app_metadata.author, app_metadata_dict['Author'])
28	        self.assertEqual(app_metadata.spdx_license_id, app_metadata_dict['SpdxLicenseId'])
29	        self.assertEqual(app_metadata.license_body, app_metadata_dict['LicenseBody'])
30	        self.assertEqual(app_metadata.license_url, app_metadata_dict['LicenseUrl'])
31	        self.assertEqual(app_metadata.readme_body, app_metadata_dict['ReadmeBody'])
32	        self.assertEqual(app_metadata.readme_url, app_metadata_dict['ReadmeUrl'])
33	        self.assertEqual(app_metadata.labels, app_metadata_dict['Labels'])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/tests/unit/test_publish.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	        self.boto3_mock.client.return_value = self.serverlessrepo_mock
30	        self.template = """
31	        {
32	            "Metadata": {
33	                "AWS::ServerlessRepo::Application": {
34	                    "Name": "test-app",
35	                    "Description": "hello world",
36	                    "Author": "abc",
37	                    "LicenseUrl": "s3://test-bucket/LICENSE",
38	                    "ReadmeUrl": "s3://test-bucket/README.md",
39	                    "Labels": ["test1", "test2"],
40	                    "HomePageUrl": "https://github.com/abc/def",
41	                    "SourceCodeUrl": "https://github.com/abc/def",
42	                    "SemanticVersion": "1.0.0"
43	                }
44	            },
45	            "Resources": { "Key1": {}, "Key2": {} }
46	        }
47	        """
48	        self.template_dict = json.loads(self.template)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/tests/unit/test_publish.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	                'Labels': ['test1', 'test2'],
196	                'HomePageUrl': 'https://github.com/abc/def'
197	            }
198	        }
199	        self.assertEqual(expected_result, actual_result)
200	
201	        self.serverlessrepo_mock.create_application.assert_called_once()
202	        # should continue to update application if the exception is application already exists
203	        expected_request = dict({'ApplicationId': self.application_id}, **expected_result['details'])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/tests/unit/test_publish.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
234	                'Labels': ['test1', 'test2'],
235	                'HomePageUrl': 'https://github.com/abc/def',
236	                'ReadmeUrl': 's3://test-bucket/README.md'
237	            }
238	        }
239	        self.assertEqual(expected_result, actual_result)
240	
241	        self.serverlessrepo_mock.create_application.assert_called_once()
242	        self.serverlessrepo_mock.update_application.assert_called_once()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/tests/unit/test_publish.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
257	                'Labels': ['test1', 'test2'],
258	                'HomePageUrl': 'https://github.com/abc/def',
259	                'SourceCodeUrl': 'https://github.com/abc/def',
260	                'SemanticVersion': '1.0.0'
261	            }
262	        }
263	        self.assertEqual(expected_result, actual_result)
264	
265	        self.serverlessrepo_mock.create_application.assert_called_once()
266	        self.serverlessrepo_mock.update_application.assert_called_once()
267	        # should continue to create application version

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/tests/unit/test_publish.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	                'HomePageUrl': 'https://github.com/abc/def',
259	                'SourceCodeUrl': 'https://github.com/abc/def',
260	                'SemanticVersion': '1.0.0'
261	            }
262	        }
263	        self.assertEqual(expected_result, actual_result)
264	
265	        self.serverlessrepo_mock.create_application.assert_called_once()
266	        self.serverlessrepo_mock.update_application.assert_called_once()
267	        # should continue to create application version
268	        expected_request = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/tests/unit/test_publish.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
269	            'ApplicationId': self.application_id,
270	            'SourceCodeUrl': 'https://github.com/abc/def',
271	            'SemanticVersion': '1.0.0',
272	            'TemplateBody': self.yaml_template_without_metadata
273	        }
274	        self.serverlessrepo_mock.create_application_version.assert_called_once_with(**expected_request)
275	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/tests/unit/test_publish.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
326	                'Description': 'hello world',
327	                'HomePageUrl': 'https://github.com/abc/def',
328	                'Labels': ['test1', 'test2'],
329	                'LicenseBody': 'test test',
330	                'Name': 'test-app',
331	                'ReadmeUrl': 's3://test-bucket/README.md',
332	                'SemanticVersion': '1.0.0',
333	                'SourceCodeUrl': 'https://github.com/abc/def'
334	            }
335	        }
336	        self.assertEqual(expected_result, actual_result)
337	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/tests/unit/test_publish.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
332	                'SemanticVersion': '1.0.0',
333	                'SourceCodeUrl': 'https://github.com/abc/def'
334	            }
335	        }
336	        self.assertEqual(expected_result, actual_result)
337	
338	    def test_update_application_with_readmebody(self):
339	        self.serverlessrepo_mock.create_application.side_effect = self.application_exists_error
340	        template_with_readmebody = self.template \
341	            .replace('"SemanticVersion": "1.0.0"', '') \
342	            .replace('"ReadmeUrl": "s3://test-bucket/README.md"', '"ReadmeBody": "test test"')
343	        actual_result = publish_application(template_with_readmebody)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/serverlessrepo-0.1.10/serverlessrepo-0.1.10/tests/unit/test_publish.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
351	                'Labels': ['test1', 'test2'],
352	                'HomePageUrl': 'https://github.com/abc/def'
353	            }
354	        }
355	        self.assertEqual(expected_result, actual_result)
356	
357	
358	class TestUpdateApplicationMetadata(TestCase):

--------------------------------------------------

Code scanned:
	Total lines of code: 1349
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 2.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 1.0
Files skipped (0):
