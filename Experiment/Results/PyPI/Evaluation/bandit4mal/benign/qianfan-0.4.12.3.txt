Run started:2025-05-25 13:08:35.851757

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/chat.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
92	        self.console = replace_logger_handler()
93	        self.thread_pool = ThreadPoolExecutor(max_workers=len(self.clients))
94	        self.inference_args = kwargs

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/evaluation.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	        print_info_msg(
254	            "The data has been processed. Since manual evaluator is enabled, please go"
255	            " to https://console.bce.baidu.com/qianfan/modelcenter/model/manual/detail/task/{task_id}"
256	            " to evalate the results."

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/main.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
100	    default_config = {
101	        "host": "0.0.0.0",
102	        "port": 8001,
103	        "detach": False,
104	        "ignore_system": True,
105	        "log_file": None,
106	        "model_mapping": None,
107	        "api_key": None,
108	    }
109	    adapter_config = {}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/main.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
145	def proxy(
146	    host: str = typer.Option("0.0.0.0", "--host", "-h", help="Host to bind."),
147	    base_port: int = typer.Option(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/main.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	        help=(
266	            "Access key from"
267	            " [link=https://console.bce.baidu.com/iam/#/iam/accesslist]Qianfan"
268	            " IAM[/link]."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/main.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
276	        help=(
277	            "Secret key from"
278	            " [link=https://console.bce.baidu.com/iam/#/iam/accesslist]Qianfan"
279	            " IAM[/link]."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/main.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
287	        help=(
288	            "API key of"
289	            " [link=https://console.bce.baidu.com/qianfan/ais/console/applicationConsole/application]Qianfan"
290	            " App[/link]."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/main.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
298	        help=(
299	            "Secret key"
300	            " [link=https://console.bce.baidu.com/qianfan/ais/console/applicationConsole/application]Qianfan"
301	            " App[/link]."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/openai_adapter.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    messages = ["OpenAI wrapper server is running at"]
55	    messages.append(f"- http://127.0.0.1:{port}")
56	    display_host = host

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/openai_adapter.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
56	    display_host = host
57	    if display_host == "0.0.0.0":
58	        display_host = get_ip_address()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/openai_adapter.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
58	        display_host = get_ip_address()
59	    if display_host != "127.0.0.1":
60	        messages.append(f"- http://{display_host}:{port}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/openai_adapter.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	                                "message": (
98	                                    f"Incorrect API key provided: {key}. You can find"
99	                                    " your API key at"
100	                                    " https://platform.openai.com/account/api-keys."
101	                                ),
102	                                "type": "invalid_request_error",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/proxy.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
167	    display_host = host
168	    if display_host == "0.0.0.0":
169	        display_host = get_ip_address()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/utils.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
190	            print_info_msg(
191	                "You can find your key at"
192	                " https://console.bce.baidu.com/iam/#/iam/accesslist"
193	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/cli/utils.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
287	            Panel(
288	                _render_request(request),
289	                title="[cyan]Request[/] [dim](for debug)[/]",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/hub/hub.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	    var_type = path_list[0]
44	    cls = _hub_load_type.get(var_type, None)
45	    if cls is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/hub/hub.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	        try:
104	            s = requests.get(url).text
105	        except requests.RequestException as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/persister/persist.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
64	        with open(f_path, "wb") as f:
65	            f.write(b)
66	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/persister/persist.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
77	        with open(path.join(cache_files_path, t._space(), id), "rb") as f:
78	            return t.load(f.read())
79	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/persister/persist.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
88	                with open(file_path, "rb") as f:
89	                    res.append(t.load(f.read()))
90	            except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/common/runnable/base.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	            # start a thread for run
209	            main_t = threading.Thread(target=self._start, kwargs=kwargs)
210	            main_t.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/consts.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
297	    AccessToken: str = ""
298	    BaseURL: str = "https://aip.baidubce.com"
299	    ModelAPIPrefix: str = Consts.ModelAPIPrefix

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/consts.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	    IAMSignExpirationSeconds: int = 300
303	    ConsoleAPIBaseURL: str = "https://qianfan.baidubce.com"
304	    IAMBaseURL: str = "https://iam.bj.baidubce.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/consts.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
303	    ConsoleAPIBaseURL: str = "https://qianfan.baidubce.com"
304	    IAMBaseURL: str = "https://iam.bj.baidubce.com"
305	    AccessTokenRefreshMinInterval: float = 3600

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/afs.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
223	        with open(meta_info_path, mode="r", encoding=encoding()) as f:
224	            cache_meta_info = json.loads(f.read())
225	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/afs.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
247	        with open(cache_meta_info_path, mode="w", encoding=encoding()) as f:
248	            f.write(
249	                json.dumps(
250	                    {
251	                        "last_modified": new_last_modified_time.strftime(
252	                            "%Y-%m-%d %H:%M:%S"
253	                        )
254	                    },
255	                    ensure_ascii=False,
256	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/baidu_qianfan.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
326	        with open(info_path, mode="w", encoding=encoding()) as f:
327	            f.write(json.dumps(info, ensure_ascii=False))
328	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/bos.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
214	        with open(meta_info_path, mode="r", encoding=encoding()) as f:
215	            cache_meta_info = json.loads(f.read())
216	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/bos.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
237	        with open(cache_meta_info_path, mode="w", encoding=encoding()) as f:
238	            f.write(json.dumps(meta_info_obj, ensure_ascii=False))
239	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/chunk_reader.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	        if self.using_file_as_element:
184	            result = {QianfanDatasetPackColumnName: self._current_fd.read()}
185	            self._close_and_switch()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/chunk_reader.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
258	        for i in range(processing_thread_count):
259	            t = threading.Thread(target=_process_closure)
260	            t.start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/file.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
117	                assert isinstance(elem, str)
118	                fd.write(elem)
119	                fd.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/file.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
118	                fd.write(elem)
119	                fd.write("\n")
120	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/file.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
137	                ) as f:
138	                    f.write(table_slice[j])
139	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/file.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
184	            if self.file_format == FormatType.Json:
185	                f.write("[\n")
186	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/file.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
196	            if self.file_format == FormatType.Json:
197	                f.write("\n]")
198	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/utils.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
250	    finally:
251	        shutil.rmtree(tmp_folder_path, ignore_errors=True)
252	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/utils.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
269	def _has_cache_been_disabled(**kwargs: Any) -> bool:
270	    return kwargs.get("disable_cache", False) or get_config().DISABLE_CACHE
271	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/utils.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
448	    with open(meta_info_path, "w", encoding=encoding()) as meta:
449	        meta.write(cache_meta.json())
450	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/utils.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
460	        # 逐块读取文件内容并更新哈希对象
461	        for chunk in iter(lambda: file.read(4096), b""):
462	            result = hasher.digest() + chunk

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/utils.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
562	    with zipfile.ZipFile(zip_file_name, mode="w") as zip_file:
563	        zip_file.write(path)
564	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/utils.py:765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
764	    try:
765	        resp = requests.get(download_url, stream=True)
766	        with open(destination_file_path, "wb") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/utils.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
767	            for chuck in resp.iter_content(10240):
768	                f.write(chuck)
769	        resp.close()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/data_source/utils.py:845
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
844	            # 避免重名带来的影响
845	            shutil.rmtree(local_file_path, ignore_errors=True)
846	            _collect_all_images_and_annotations_in_one_folder(

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset.py:2398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
2397	        # 子进程
2398	        child_process = Process(
2399	            target=functools.partial(open_in_streamlit, self, insight_data)
2400	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	
55	top_half_html = """
56	<!DOCTYPE html>
57	<html lang="en">
58	<head>
59	  <meta charset="UTF-8">
60	  <meta name="viewport" content="width=device-width, initial-scale=1.0">
61	  <title>Ant Design Table Example</title>
62	  <!-- 引入 Ant Design 的 CSS 文件 -->
63	  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/antd/4.18.0/antd.min.css">
64	</head>
65	<body>
66	  <!-- 定义一个容器用于渲染表格 -->
67	  <div id="app"></div>
68	
69	  <!-- 引入 Ant Design 的 JavaScript 文件 -->
70	  <script src="https://cdn.bootcdn.net/ajax/libs/react/17.0.2/umd/react.production.min.js"></script>
71	  <script src="https://cdn.bootcdn.net/ajax/libs/react-dom/17.0.2/umd/react-dom.production.min.js"></script>
72	  <script src="https://cdn.bootcdn.net/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
73	  <script src="https://cdn.bootcdn.net/ajax/libs/antd/4.18.0/antd.min.js"></script>
74	
75	  <!-- 定义表格的列和数据 -->
76	  <script type="text/babel">
77	    const { Table } = antd;
78	
79	
80	"""
81	
82	bottom_half_html = """

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	    if result.statistic:
185	        request_latency = result.statistic.get("request_latency", None)
186	        if "first_token_latency" in result.statistic:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
347	            log_info(f"retrieve single entity from {elem['entity_url']} in try {i}")
348	            resp = requests.get(elem["entity_url"])
349	            if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
451	
452	    prompt_template: Optional[Prompt] = kwargs.get("prompt_template", None)
453	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
494	    def _write_columns_field(bio: BinaryIO) -> None:
495	        bio.write(bytes("\t\tconst columns = [\n", encoding="utf8"))
496	        bio.write(bytes(column_field_template.format("index"), encoding="utf8"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
495	        bio.write(bytes("\t\tconst columns = [\n", encoding="utf8"))
496	        bio.write(bytes(column_field_template.format("index"), encoding="utf8"))
497	        for field in ds.col_names():

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
497	        for field in ds.col_names():
498	            bio.write(bytes(column_field_template.format(field), encoding="utf8"))
499	        bio.write(bytes("\t\t];\n", encoding="utf8"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
498	            bio.write(bytes(column_field_template.format(field), encoding="utf8"))
499	        bio.write(bytes("\t\t];\n", encoding="utf8"))
500	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
501	    def _write_column_data(bio: BinaryIO) -> None:
502	        bio.write(bytes("\t\tconst data = [\n", encoding="utf8"))
503	        index = 0

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
508	
509	            bio.write(bytes("\t\t\t{\n", encoding="utf8"))
510	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
510	
511	            bio.write(bytes("\t\t\t\tkey: `{}`,\n".format(index), encoding="utf8"))
512	            bio.write(bytes("\t\t\t\tindex: `{}`,\n".format(index), encoding="utf8"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
511	            bio.write(bytes("\t\t\t\tkey: `{}`,\n".format(index), encoding="utf8"))
512	            bio.write(bytes("\t\t\t\tindex: `{}`,\n".format(index), encoding="utf8"))
513	            for k, v in entry.items():

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
513	            for k, v in entry.items():
514	                bio.write(bytes("\t\t\t\t{}: `{}`,\n".format(k, v), encoding="utf8"))
515	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
515	
516	            bio.write(bytes("\t\t\t},\n", encoding="utf8"))
517	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
518	        ds.iterate(_iterate)
519	        bio.write(bytes("\t\t];\n", encoding="utf8"))
520	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
520	
521	    browser = webbrowser.get(None)
522	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
528	
529	            self.wfile.write(bytes(top_half_html, encoding="utf8"))
530	            _write_columns_field(self.wfile)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
531	            _write_column_data(self.wfile)
532	            self.wfile.write(bytes(bottom_half_html, encoding="utf8"))
533	

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
533	
534	    server = HTTPServer(("127.0.0.1", 0), OneShotRequestHandler)
535	    browser.open("http://127.0.0.1:%s" % server.server_port)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
533	
534	    server = HTTPServer(("127.0.0.1", 0), OneShotRequestHandler)
535	    browser.open("http://127.0.0.1:%s" % server.server_port)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
534	    server = HTTPServer(("127.0.0.1", 0), OneShotRequestHandler)
535	    browser.open("http://127.0.0.1:%s" % server.server_port)
536	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
536	
537	    server.handle_request()
538	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/dataset_utils.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
536	
537	    server.handle_request()
538	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/schema.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	                    log_error(
120	                        f"response illegal in dataset row {index}. response data:"
121	                        f" {response_record}\n"
122	                        "for accurate dataset format, please check"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/schema.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
182	                        log_error(
183	                            f"response illegal in dataset row {index}. response data:"
184	                            f" {response_record}"
185	                            "for accurate dataset format, please check"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/load_runner.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
221	                with open(html_path, "w", encoding="utf-8") as f:
222	                    f.write(html_table)
223	                return ret

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/load_runner.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
226	                with open(html_path, "w", encoding="utf-8") as f:
227	                    f.write(html_table)
228	                logger.info("整句时延超时")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/load_runner.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
232	                with open(html_path, "w", encoding="utf-8") as f:
233	                    f.write(html_table)
234	                logger.info("成功率低于阈值")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/load_runner.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
238	        with open(html_path, "w", encoding="utf-8") as f:
239	            f.write(html_table)
240	        end_time = time.time()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/listeners/custom_handler.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
462	            ) as fs:
463	                fs.write(log_content)

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/logger.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
13	
14	HOSTNAME = socket.gethostname()
15	loglevel = "DEBUG"

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/logger.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
13	
14	HOSTNAME = socket.gethostname()
15	loglevel = "DEBUG"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/runner.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
61	        self.worker_num = worker_num
62	        self.master_host = master_host or "127.0.0.1"
63	        self.master_port = (

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/runner.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
201	
202	            if platform.system().lower() == "windows":
203	                os.kill(process.pid, getattr(signal, "CTRL_C_EVENT"))

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/runner.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
201	
202	            if platform.system().lower() == "windows":
203	                os.kill(process.pid, getattr(signal, "CTRL_C_EVENT"))

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/runner.py:202
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
201	
202	            if platform.system().lower() == "windows":
203	                os.kill(process.pid, getattr(signal, "CTRL_C_EVENT"))

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/runner.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
235	        if self.worker_num == 1:
236	            process = multiprocessing.Process(target=self.local)
237	            process.start()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/runner.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
247	            try:
248	                master = multiprocessing.Process(target=self.master)
249	                master.start()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/runner.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
258	                for i in range(self.worker_num):
259	                    worker = multiprocessing.Process(target=self.worker, args=(i,))
260	                    workers.append(worker)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/users/custom_user.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	        """
64	        if not kwargs.get("stream"):
65	            return None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/users/custom_user.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
174	        # in order to not trigger fetching of the body
175	        if kwargs.get("stream", False):
176	            # yame自定义逻辑

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/users/custom_user.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	                request_meta.update(custom_result)
179	            request_meta["response_length"] = request_meta.get(
180	                "response_length",  # 尝试优先读取自定义response_length
181	                int(response.headers.get("content-length") or 0),
182	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/users/custom_user.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	                "response_length",  # 尝试优先读取自定义response_length
181	                int(response.headers.get("content-length") or 0),
182	            )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/utils.py:15
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
14	    """
15	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
16	        try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/utils.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
17	            s.bind((host, port))
18	            s.close()
19	            return False

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/dataset/stress_test/yame/utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
24	def select_a_free_port(
25	    host: str = "127.0.0.1", start_port: int = 8000, end_port: int = 65535
26	) -> int:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/evaluation/evaluation_manager.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	                json.dump(inner_list, f, ensure_ascii=False)
100	                f.write("\n")
101	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/evaluation/evaluation_manager.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
196	        sector_length = math.ceil(len(dataset) / multiprocessing.cpu_count())
197	        pool = ThreadPoolExecutor()
198	        future_list: List[Future] = []

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/evaluation/evaluation_manager.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
253	        future_dict: Dict[int, Future] = {}
254	        pool = ThreadPoolExecutor()
255	        for index in range(len(llms)):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/evaluation/evaluation_manager.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
373	        eval_id = resp_body["result"]["evalIdStr"]
374	        task_url = f"https://console.bce.baidu.com/qianfan/modelcenter/model/eval/detail/task/{eval_id}"
375	        self.task_id = eval_id

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/evaluation/evaluation_manager.py:698
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
697	                    try:
698	                        shutil.rmtree(unfold_zip_file_path)
699	                    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	        request.url = path
95	        if not (request.query.get("client_id") or request.query.get("client_secret")):
96	            iam_sign(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	        request.url = path
95	        if not (request.query.get("client_id") or request.query.get("client_secret")):
96	            iam_sign(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	        request.url = url
100	        if not request.headers.get("Authorization", None):
101	            self._auth._ak = request.query.get("client_id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	        if not request.headers.get("Authorization", None):
101	            self._auth._ak = request.query.get("client_id")
102	            self._auth._sk = request.query.get("client_secret")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	            self._auth._ak = request.query.get("client_id")
102	            self._auth._sk = request.query.get("client_secret")
103	            request.query["access_token"] = self._auth.access_token()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	        if self.mock_port != -1:
124	            url_route = f"http://127.0.0.1:{self.mock_port}"
125	        url = url_route + request.url.path

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
160	            async with self._rate_limiter.acquire():
161	                qf_req = await self.get_request(request, url_route)
162	                if self._direct:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
160	            async with self._rate_limiter.acquire():
161	                qf_req = await self.get_request(request, url_route)
162	                if self._direct:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	                logging.debug(f"request: {qf_req}")
167	                if qf_req.json_body.get("stream", False):
168	                    resp, session = await self._client.arequest(qf_req)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
167	                if qf_req.json_body.get("stream", False):
168	                    resp, session = await self._client.arequest(qf_req)
169	                    if (

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
167	                if qf_req.json_body.get("stream", False):
168	                    resp, session = await self._client.arequest(qf_req)
169	                    if (

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
172	                    ):  # 判断返回中是否有流式数据
173	                        resp, session = await self._client.arequest(qf_req)
174	                        async with session:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
172	                    ):  # 判断返回中是否有流式数据
173	                        resp, session = await self._client.arequest(qf_req)
174	                        async with session:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
179	                else:
180	                    resp, session = await self._client.arequest(qf_req)
181	                    async with session:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/extensions/proxy/proxy.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
179	                else:
180	                    resp, session = await self._client.arequest(qf_req)
181	                    async with session:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/auth/oauth.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
222	                exception_msg_tmpl = (
223	                    "{err_msg}, please check! {chinese_err_msg}, 请检查！ AK/SK should"
224	                    " be obtained from"
225	                    " https://console.bce.baidu.com/qianfan/ais/console/applicationConsole/application"
226	                )
227	                err_msg = response.get("error_description", "AK/SK is not correct")
228	                chinese_err_msg = response.get("error_description", "AK/SK 错误")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/auth/oauth.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
294	                    # access token
295	                    resp = self._client.request(self._auth_request(ak, sk))
296	                    json_body = resp.json()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/auth/oauth.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
294	                    # access token
295	                    resp = self._client.request(self._auth_request(ak, sk))
296	                    json_body = resp.json()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/auth/oauth.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
330	                else:
331	                    resp, session = await self._client.arequest(
332	                        self._auth_request(ak, sk)
333	                    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/auth/oauth.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
331	                    resp, session = await self._client.arequest(
332	                        self._auth_request(ak, sk)
333	                    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/batch_inference/helper/helper.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
381	        self._running = False
382	        self._queue_process_thread = threading.Thread(
383	            target=self._start_process_queue, daemon=True
384	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/batch_inference/helper/helper.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
473	                    outfile = open(output_file, "w", encoding="utf-8")
474	                    outfile.write(line)
475	                    current_size = len(line.encode("utf-8"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/batch_inference/helper/helper.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
476	                else:
477	                    outfile.write(line)
478	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/batch_inference/helper/helper.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
492	        all_output_files = []
493	        with concurrent.futures.ThreadPoolExecutor() as executor:
494	            future_to_url = {

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/batch_inference/helper/helper.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
525	        # 使用多线程处理每个批次，并为每个批次分配组编号
526	        with concurrent.futures.ThreadPoolExecutor() as executor:
527	            futures = [

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/batch_inference/helper/helper.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
568	        # 使用多线程处理每个批次，并为每个批次分配组编号
569	        with concurrent.futures.ThreadPoolExecutor() as executor:
570	            futures = [

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/http_client.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
68	        """
69	        resp = self._session.request(
70	            **req.requests_args(),
71	            timeout=req.retry_config.timeout,
72	            verify=self.ssl,
73	            proxies=self._requests_proxy(),
74	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/http_client.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
68	        """
69	        resp = self._session.request(
70	            **req.requests_args(),
71	            timeout=req.retry_config.timeout,
72	            verify=self.ssl,
73	            proxies=self._requests_proxy(),
74	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/http_client.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
82	        """
83	        resp = self._session.request(
84	            **req.requests_args(),
85	            stream=True,
86	            timeout=req.retry_config.timeout,
87	            verify=self.ssl,
88	            proxies=self._requests_proxy(),
89	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/http_client.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
82	        """
83	        resp = self._session.request(
84	            **req.requests_args(),
85	            stream=True,
86	            timeout=req.retry_config.timeout,
87	            verify=self.ssl,
88	            proxies=self._requests_proxy(),
89	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/http_client.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
103	        timeout = aiohttp.ClientTimeout(total=req.retry_config.timeout)
104	        response = await session.request(
105	            **req.requests_args(),
106	            timeout=timeout,
107	            ssl=self.ssl,
108	            proxy=self._aiohttp_proxy(),
109	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/http_client.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
103	        timeout = aiohttp.ClientTimeout(total=req.retry_config.timeout)
104	        response = await session.request(
105	            **req.requests_args(),
106	            timeout=timeout,
107	            ssl=self.ssl,
108	            proxy=self._aiohttp_proxy(),
109	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/http_client.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
119	            timeout = aiohttp.ClientTimeout(total=req.retry_config.timeout)
120	            async with session.request(
121	                **req.requests_args(),
122	                timeout=timeout,
123	                ssl=self.ssl,
124	                proxy=self._aiohttp_proxy(),
125	            ) as resp:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/http_client.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
119	            timeout = aiohttp.ClientTimeout(total=req.retry_config.timeout)
120	            async with session.request(
121	                **req.requests_args(),
122	                timeout=timeout,
123	                ssl=self.ssl,
124	                proxy=self._aiohttp_proxy(),
125	            ) as resp:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/images/text2image.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
158	            for i in resp["body"]["data"]:
159	                i["image"] = base64.b64decode(i["b64_image"])
160	        return resp

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/images/text2image.py:159
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
158	            for i in resp["body"]["data"]:
159	                i["image"] = base64.b64decode(i["b64_image"])
160	        return resp

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/images/text2image.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
223	            for i in resp["body"]["data"]:
224	                i["image"] = base64.b64decode(i["b64_image"])
225	        return resp

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/images/text2image.py:224
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
223	            for i in resp["body"]["data"]:
224	                i["image"] = base64.b64decode(i["b64_image"])
225	        return resp

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/llm/base.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
85	        self._future_list: List[Future[Union[QfResponse, Iterator[QfResponse]]]] = []
86	        self._executor = ThreadPoolExecutor(max_workers=max_workers)
87	        self._finished_count = 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/rate_limiter/redis_rate_limiter.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
33	        self,
34	        host: str = "127.0.0.1",
35	        port: int = 6379,
36	        db: int = 0,
37	        **other: Any,
38	    ) -> None:
39	        self.host = host

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
90	        )
91	        if response.headers.get("X-Bce-Error-Code", ""):
92	            failed_msg += (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	
96	        if response.headers.get("X-Bce-Error-Message", ""):
97	            failed_msg += (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	        possible_reason = ""
105	        x_err_msg = response.headers.get("X-Bce-Error-Message", "")
106	        if x_err_msg == "NotFound, cause: Could not find credential.":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	            resp.statistic["start_timestamp"] = start_timestamp
202	            usage_tokens = resp.body.get("usage", {}).get(_COMPLETION_TOKENS_FIELD, 0)
203	            resp.statistic["avg_output_tokens_per_second"] = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	            resp.statistic["start_timestamp"] = start_timestamp
202	            usage_tokens = resp.body.get("usage", {}).get(_COMPLETION_TOKENS_FIELD, 0)
203	            resp.statistic["avg_output_tokens_per_second"] = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	            resp.statistic["start_timestamp"] = start_timestamp
233	            usage_tokens = resp.body.get("usage", {}).get(_COMPLETION_TOKENS_FIELD, 0)
234	            resp.statistic["avg_output_tokens_per_second"] = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	            resp.statistic["start_timestamp"] = start_timestamp
233	            usage_tokens = resp.body.get("usage", {}).get(_COMPLETION_TOKENS_FIELD, 0)
234	            resp.statistic["avg_output_tokens_per_second"] = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	                sse_block_receive_time = time.perf_counter()
277	                chunk_usage = r.body.get("usage", {}) or {}
278	                usage_tokens = chunk_usage.get(_COMPLETION_TOKENS_FIELD, 0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
277	                chunk_usage = r.body.get("usage", {}) or {}
278	                usage_tokens = chunk_usage.get(_COMPLETION_TOKENS_FIELD, 0)
279	                r.statistic["avg_output_tokens_per_second"] = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
327	                sse_block_receive_time = time.perf_counter()
328	                usage_tokens = r.body.get("usage", {}).get(_COMPLETION_TOKENS_FIELD, 0)
329	                r.statistic["avg_output_tokens_per_second"] = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
327	                sse_block_receive_time = time.perf_counter()
328	                usage_tokens = r.body.get("usage", {}).get(_COMPLETION_TOKENS_FIELD, 0)
329	                r.statistic["avg_output_tokens_per_second"] = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
351	            VersatileRateLimiter(**kwargs)
352	            if not kwargs.get("redis_rate_limiter", False)
353	            else RedisRateLimiter(**kwargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
354	        )
355	        self._host = kwargs.get("host")
356	        self.config = kwargs.get("config", get_config())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
355	        self._host = kwargs.get("host")
356	        self.config = kwargs.get("config", get_config())
357	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
375	        """
376	        request = self._preprocess_request(request)
377	        response = self._client.request(request)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
375	        """
376	        request = self._preprocess_request(request)
377	        response = self._client.request(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
376	        request = self._preprocess_request(request)
377	        response = self._client.request(request)
378	        check_error(response, self.config)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
376	        request = self._preprocess_request(request)
377	        response = self._client.request(request)
378	        check_error(response, self.config)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
406	        """
407	        request = self._preprocess_request(request)
408	        start = time.perf_counter()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
406	        """
407	        request = self._preprocess_request(request)
408	        start = time.perf_counter()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
408	        start = time.perf_counter()
409	        response, session = await self._client.arequest(request)
410	        request_latency = time.perf_counter() - start

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/base.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
408	        start = time.perf_counter()
409	        response, session = await self._client.arequest(request)
410	        request_latency = time.perf_counter() - start

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	        self._async_token_limiter = AsyncTokenLimiter(**kwargs)
74	        self._sync_reading_thread_count: Optional[int] = kwargs.get(
75	            "sync_reading_thread_count", None
76	        )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
78	        if self._sync_reading_thread_count is not None:
79	            self._sync_reading_thread_pool: ThreadPoolExecutor = ThreadPoolExecutor(
80	                max_workers=self._sync_reading_thread_count
81	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
112	        """
113	        request = self._preprocess_request(request)
114	        responses = self._client.request_stream(request)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
112	        """
113	        request = self._preprocess_request(request)
114	        responses = self._client.request_stream(request)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
116	        _, resp = next(responses)
117	        if "json" in resp.headers.get("content-type", "") or resp.status_code != 200:
118	            try:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
222	        """
223	        request = await self._async_preprocess_request(request)
224	        responses = self._client.arequest_stream(request)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
222	        """
223	        request = await self._async_preprocess_request(request)
224	        responses = self._client.arequest_stream(request)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	
232	        if "json" in resp.headers.get("content-type", "") or resp.status != 200:
233	            try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	        if "error_code" in body:
295	            req_id = body.get("id", "")
296	            error_code = body["error_code"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
296	            error_code = body["error_code"]
297	            err_msg = body.get("error_msg", "no error message found in response body")
298	            possible_reason = ""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
309	            log_error(
310	                f"api request req_id: {req_id} failed with error code: {error_code},"
311	                f" err msg: {err_msg}, please check"
312	                " https://cloud.baidu.com/doc/WENXINWORKSHOP/s/tlmyncueh"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
342	        token_count = 0
343	        messages = body.get("messages", None)
344	        prompt = body.get("prompt", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
343	        messages = body.get("messages", None)
344	        prompt = body.get("prompt", None)
345	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
353	            for message in messages:
354	                content = message.get("content", None)
355	                if not content:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
361	                        token_count += self._token_limiter.tokenizer.count_tokens(
362	                            ct.get("text", "")
363	                        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
374	        if isinstance(resp, QfResponse):
375	            token_usage = resp.body.get("usage", {}).get("total_tokens", 0)
376	            if token_usage:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
374	        if isinstance(resp, QfResponse):
375	            token_usage = resp.body.get("usage", {}).get("total_tokens", 0)
376	            if token_usage:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
396	
397	                chunk_usage = res.body.get("usage", {}) or {}
398	                chunk_usage.get("total_tokens", 0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
397	                chunk_usage = res.body.get("usage", {}) or {}
398	                chunk_usage.get("total_tokens", 0)
399	                yield res

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
407	        if isinstance(resp, QfResponse):
408	            token_usage = resp.body.get("usage", {}).get("total_tokens", 0)
409	            if token_usage:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
407	        if isinstance(resp, QfResponse):
408	            token_usage = resp.body.get("usage", {}).get("total_tokens", 0)
409	            if token_usage:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
435	
436	                token_usage = res.body.get("usage", {}).get("total_tokens", 0)
437	                yield res

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
435	
436	                token_usage = res.body.get("usage", {}).get("total_tokens", 0)
437	                yield res

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
458	        # TODO 应该放在Adapter中做处理。
459	        for m in body.get("messages", []):
460	            if m.get("role", "") == "function":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
459	        for m in body.get("messages", []):
460	            if m.get("role", "") == "function":
461	                if not m.get("name", None):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
460	            if m.get("role", "") == "function":
461	                if not m.get("name", None):
462	                    m["name"] = m.get("tool_call_id", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
461	                if not m.get("name", None):
462	                    m["name"] = m.get("tool_call_id", "")
463	                    m.pop("tool_call_id", None)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
466	        def _helper() -> Union[QfResponse, Iterator[QfResponse]]:
467	            req = self._base_llm_request(
468	                endpoint,
469	                header=header,
470	                query=query,
471	                body=body,
472	                retry_config=retry_config,
473	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
466	        def _helper() -> Union[QfResponse, Iterator[QfResponse]]:
467	            req = self._base_llm_request(
468	                endpoint,
469	                header=header,
470	                query=query,
471	                body=body,
472	                retry_config=retry_config,
473	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
492	                is_stress_test = (
493	                    os.environ.get("QIANFAN_ENABLE_STRESS_TEST", "false") == "true"
494	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
503	                else:
504	                    t = threading.Thread(target=_inner_worker, daemon=True)
505	                    t.start()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
535	                return self._compensate_token_usage_non_stream(
536	                    self._request(
537	                        req,
538	                        data_postprocess=data_postprocess,
539	                    ),
540	                    token_count,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
535	                return self._compensate_token_usage_non_stream(
536	                    self._request(
537	                        req,
538	                        data_postprocess=data_postprocess,
539	                    ),
540	                    token_count,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
560	        log_debug(f"async requesting llm api endpoint: {endpoint}")
561	        for m in body.get("messages", []):
562	            if m.get("role", "") == "function":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
561	        for m in body.get("messages", []):
562	            if m.get("role", "") == "function":
563	                if not m.get("name", None):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
562	            if m.get("role", "") == "function":
563	                if not m.get("name", None):
564	                    m["name"] = m.get("tool_call_id", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
563	                if not m.get("name", None):
564	                    m["name"] = m.get("tool_call_id", "")
565	                    m.pop("tool_call_id", None)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
593	        async def _helper() -> Union[QfResponse, AsyncIterator[QfResponse]]:
594	            req = self._base_llm_request(
595	                endpoint,
596	                header=header,
597	                query=query,
598	                body=body,
599	                retry_config=retry_config,
600	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
593	        async def _helper() -> Union[QfResponse, AsyncIterator[QfResponse]]:
594	            req = self._base_llm_request(
595	                endpoint,
596	                header=header,
597	                query=query,
598	                body=body,
599	                retry_config=retry_config,
600	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
628	                return await self._async_compensate_token_usage_non_stream(
629	                    await self._async_request(req, data_postprocess=data_postprocess),
630	                    token_count,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
628	                return await self._async_compensate_token_usage_non_stream(
629	                    await self._async_request(req, data_postprocess=data_postprocess),
630	                    token_count,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
659	        parsed_uri = urlparse(request.url)
660	        if os.environ.get("QIANFAN_IAM_HOST"):
661	            host = str(os.environ.get("QIANFAN_IAM_HOST"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
660	        if os.environ.get("QIANFAN_IAM_HOST"):
661	            host = str(os.environ.get("QIANFAN_IAM_HOST"))
662	            parsed_uri = parsed_uri._replace(scheme="https", netloc=host)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
738	        def _helper() -> QfResponse:
739	            return self._request(req)
740	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
738	        def _helper() -> QfResponse:
739	            return self._request(req)
740	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
751	        async def _helper() -> QfResponse:
752	            return await self._async_request(req)
753	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
751	        async def _helper() -> QfResponse:
752	            return await self._async_request(req)
753	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:847
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
846	        if "error" in body:
847	            req_id = body.get("id", "")
848	            error_code = body["error"]["code"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
848	            error_code = body["error"]["code"]
849	            err_msg = body["error"].get(
850	                "message", "no error message found in response body"
851	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
853	            log_error(
854	                f"api request req_id: {req_id} failed with error code: {error_code},"
855	                f" err msg: {err_msg}, please check"
856	                " https://cloud.baidu.com/doc/WENXINWORKSHOP/s/tlmyncueh"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
881	        super().__init__(**kwargs)
882	        self._ak = kwargs.get("ak", None) or get_config().AK
883	        self._sk = kwargs.get("sk", None) or get_config().SK

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
882	        self._ak = kwargs.get("ak", None) or get_config().AK
883	        self._sk = kwargs.get("sk", None) or get_config().SK
884	        self._access_code = kwargs.get("access_code", None) or get_config().ACCESS_CODE

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
883	        self._sk = kwargs.get("sk", None) or get_config().SK
884	        self._access_code = kwargs.get("access_code", None) or get_config().ACCESS_CODE
885	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
927	        def _helper() -> Union[QfResponse, Iterator[QfResponse]]:
928	            req = self._base_llm_request(
929	                endpoint,
930	                header=header,
931	                query=query,
932	                body=body,
933	                retry_config=retry_config,
934	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
927	        def _helper() -> Union[QfResponse, Iterator[QfResponse]]:
928	            req = self._base_llm_request(
929	                endpoint,
930	                header=header,
931	                query=query,
932	                body=body,
933	                retry_config=retry_config,
934	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
946	                return self._request_stream(req, data_postprocess=data_postprocess)
947	            return self._request(req, data_postprocess=data_postprocess)
948	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
946	                return self._request_stream(req, data_postprocess=data_postprocess)
947	            return self._request(req, data_postprocess=data_postprocess)
948	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:966
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
965	        async def _helper() -> Union[QfResponse, AsyncIterator[QfResponse]]:
966	            req = self._base_llm_request(
967	                endpoint,
968	                header=header,
969	                query=query,
970	                body=body,
971	                retry_config=retry_config,
972	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:966
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
965	        async def _helper() -> Union[QfResponse, AsyncIterator[QfResponse]]:
966	            req = self._base_llm_request(
967	                endpoint,
968	                header=header,
969	                query=query,
970	                body=body,
971	                retry_config=retry_config,
972	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
986	                )
987	            return await self._async_request(req, data_postprocess=data_postprocess)
988	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/resources/requestor/openapi_requestor.py:987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
986	                )
987	            return await self._async_request(req, data_postprocess=data_postprocess)
988	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/trainer/actions.py:786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
785	                log_prefix = log_prefix_mapping.get(self.train_mode, "sft")
786	                self.log_link = f"https://console.bce.baidu.com/qianfan/train/{log_prefix}/{self.job_id}/{self.task_id}/detail/traininglog"
787	                self.vdl_link = task_status_result.get("vdlLink", "")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/trainer/pipeline.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
104	
105	        t = threading.Thread(target=_exec_helper, args=[res])
106	        t.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/utils/utils.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
128	                log_info(
129	                    f"no event loop in thread `{current_thread().name}`, async feature"
130	                    " won't be available. Please make sure the object is initialized"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/utils/utils.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
232	    # arbitrary private address
233	    host = "10.254.254.254"
234	
235	    with socket.socket(socket.AddressFamily.AF_INET, socket.SOCK_DGRAM) as s:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/utils/utils.py:235
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
234	
235	    with socket.socket(socket.AddressFamily.AF_INET, socket.SOCK_DGRAM) as s:
236	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/utils/utils.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
236	        try:
237	            s.connect((host, 64512))
238	        except OSError:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/qianfan-0.4.12.3/qianfan-0.4.12.3/qianfan/utils/utils.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
238	        except OSError:
239	            return "127.0.0.1"
240	

--------------------------------------------------

Code scanned:
	Total lines of code: 46721
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 38.0
		High: 188.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 220.0
		High: 6.0
Files skipped (0):
