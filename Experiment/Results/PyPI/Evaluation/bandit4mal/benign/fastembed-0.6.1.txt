Run started:2025-05-25 13:04:21.268882

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/common/model_management.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	            return output_path
101	        response = requests.get(url, stream=True)
102	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/common/model_management.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	        # Get the total size of the file
111	        total_size_in_bytes = int(response.headers.get("content-length", 0))
112	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/common/model_management.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
124	        ) as progress_bar:
125	            with open(output_path, "wb") as file:
126	                for chunk in response.iter_content(chunk_size=1024):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/common/model_management.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
128	                        progress_bar.update(len(chunk))
129	                        file.write(chunk)
130	        return output_path

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/common/model_management.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
186	                if file_path.is_file() and file_path.name != cls.METADATA_FILE:
187	                    repo_file = file_info_map.get(file_path.name)
188	                    if repo_file:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/common/model_management.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
311	            # Open the tar.gz file
312	            with tarfile.open(targz_path, "r:gz") as tar:
313	                # Extract all files into the cache directory

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/common/model_management.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
321	            if "tmp" in cache_dir:
322	                shutil.rmtree(cache_dir)
323	            raise ValueError(f"An error occurred while decompressing {targz_path}: {e}")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/common/model_management.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
345	        if model_tmp_dir.exists():
346	            shutil.rmtree(model_tmp_dir)
347	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/common/model_management.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
402	        """
403	        local_files_only = kwargs.get("local_files_only", False)
404	        specific_model_path: Optional[str] = kwargs.pop("specific_model_path", None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/common/onnx_model.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	                warnings.warn(
101	                    f"Attempt to set CUDAExecutionProvider failed. Current providers: {current_providers}."
102	                    "If you are using CUDA 12.x, install onnxruntime-gpu via "
103	                    "`pip install onnxruntime-gpu --extra-index-url https://aiinfra.pkgs.visualstudio.com/PublicPackages/_packaging/onnxruntime-cuda-12/pypi/simple/`",
104	                    RuntimeWarning,

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/image/onnx_image_model.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
119	
120	            pool = ParallelWorkerPool(
121	                num_workers=parallel or 1,
122	                worker=self._get_worker_class(),
123	                cuda=cuda,
124	                device_ids=device_ids,
125	                start_method=start_method,
126	            )

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/late_interaction_multimodal/onnx_multimodal_model.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
151	
152	            pool = ParallelWorkerPool(
153	                num_workers=parallel or 1,
154	                worker=self._get_text_worker_class(),
155	                cuda=cuda,
156	                device_ids=device_ids,
157	                start_method=start_method,
158	            )

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/late_interaction_multimodal/onnx_multimodal_model.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
214	
215	            pool = ParallelWorkerPool(
216	                num_workers=parallel or 1,
217	                worker=self._get_image_worker_class(),
218	                cuda=cuda,
219	                device_ids=device_ids,
220	                start_method=start_method,
221	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/parallel_processor.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
81	        output_queue.close()
82	        input_queue.join_thread()
83	        output_queue.join_thread()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/parallel_processor.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	        input_queue.join_thread()
83	        output_queue.join_thread()
84	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/parallel_processor.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
127	            assert hasattr(self.ctx, "Process")
128	            process = self.ctx.Process(
129	                target=_worker,
130	                args=(
131	                    self.worker_class,
132	                    self.input_queue,
133	                    self.output_queue,
134	                    self.num_active_workers,
135	                    worker_id,
136	                    worker_kwargs,
137	                ),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/parallel_processor.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
204	            if self.emergency_shutdown:
205	                self.input_queue.cancel_join_thread()
206	                self.output_queue.cancel_join_thread()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/parallel_processor.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
205	                self.input_queue.cancel_join_thread()
206	                self.output_queue.cancel_join_thread()
207	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/parallel_processor.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
207	            else:
208	                self.input_queue.join_thread()
209	                self.output_queue.join_thread()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/parallel_processor.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	                self.input_queue.join_thread()
209	                self.output_queue.join_thread()
210	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/rerank/cross_encoder/onnx_text_model.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
125	
126	            pool = ParallelWorkerPool(
127	                num_workers=parallel or 1,
128	                worker=self._get_worker_class(),
129	                cuda=cuda,
130	                device_ids=device_ids,
131	                start_method=start_method,
132	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/sparse/bm25.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
163	        with open(stopwords_path, "r") as f:
164	            return f.read().splitlines()
165	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/sparse/bm25.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
201	            }
202	            pool = ParallelWorkerPool(
203	                num_workers=parallel or 1,
204	                worker=self._get_worker_class(),
205	                start_method=start_method,
206	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/text/onnx_embedding.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	            hf="Qdrant/fast-bge-base-en",
22	            url="https://storage.googleapis.com/qdrant-fastembed/fast-bge-base-en.tar.gz",
23	            _deprecated_tar_struct=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/text/onnx_embedding.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	            hf="qdrant/bge-base-en-v1.5-onnx-q",
38	            url="https://storage.googleapis.com/qdrant-fastembed/fast-bge-base-en-v1.5.tar.gz",
39	            _deprecated_tar_struct=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/text/onnx_embedding.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	            hf="Qdrant/bge-small-en",
66	            url="https://storage.googleapis.com/qdrant-fastembed/BAAI-bge-small-en.tar.gz",
67	            _deprecated_tar_struct=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/text/onnx_embedding.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	            hf="Qdrant/bge-small-zh-v1.5",
94	            url="https://storage.googleapis.com/qdrant-fastembed/fast-bge-small-zh-v1.5.tar.gz",
95	            _deprecated_tar_struct=True,

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/text/onnx_text_model.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
130	
131	            pool = ParallelWorkerPool(
132	                num_workers=parallel or 1,
133	                worker=self._get_worker_class(),
134	                cuda=cuda,
135	                device_ids=device_ids,
136	                start_method=start_method,
137	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/text/pooled_embedding.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	            hf="qdrant/multilingual-e5-large-onnx",
84	            url="https://storage.googleapis.com/qdrant-fastembed/fast-multilingual-e5-large.tar.gz",
85	            _deprecated_tar_struct=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/fastembed-0.6.1/fastembed-0.6.1/fastembed/text/pooled_normalized_embedding.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        sources=ModelSource(
22	            url="https://storage.googleapis.com/qdrant-fastembed/sentence-transformers-all-MiniLM-L6-v2.tar.gz",
23	            hf="qdrant/all-MiniLM-L6-v2-onnx",

--------------------------------------------------

Code scanned:
	Total lines of code: 5469
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 0.0
Files skipped (0):
