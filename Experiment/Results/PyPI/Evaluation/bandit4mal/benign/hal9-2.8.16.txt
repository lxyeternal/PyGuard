Run started:2025-05-25 12:39:08.478432

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/cli.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	@click.option('--target', default="hal9", help='Deployment target')
58	@click.option('--url', default="https://api.hal9.com", help='Deployment url')
59	@click.option('--name', default=None, help='Deployment name')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/describe.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	        with open(file_path, 'r', encoding='utf-8') as file:
35	          content = file.read()
36	          if any(keyword in content for keyword in criteria['contents']):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/iobind.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
77	      with open(file_path, 'rb') as file:
78	        contents = file.read()
79	  else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/iobind.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
139	  with open(f".storage/.output", 'w') as file:
140	    file.write("")
141	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/iobind.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
139	  with open(f".storage/.output", 'w') as file:
140	    file.write("")
141	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/runtimes/threed.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	  html_content = f"""
11	<html>
12	<head>
13	  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/online-3d-viewer@0.15.0/build/engine/o3dv.min.js"></script>
14	</head>
15	<body>
16	  <a id="open-link" href="{model_name}" target="_blank" rel="noopener noreferrer">Open {model_name}</a>
17	  <div class="online_3d_viewer" style="width: 100%; height: 100%;" model="{model_name}"></div>
18	  <script>window.addEventListener ('load', () => {{ OV.Init3DViewerElements (); }});</script>
19	  <script>
20	    document.addEventListener("DOMContentLoaded", function () {{
21	      const link = document.getElementById("open-link");
22	      const currentPageUrl = window.location.href + '{model_name}'; 
23	      link.href = `https://3dviewer.net/#model=${{currentPageUrl}}`;

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/runtimes/threed.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	  html_content = f"""
11	<html>
12	<head>
13	  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/online-3d-viewer@0.15.0/build/engine/o3dv.min.js"></script>
14	</head>
15	<body>
16	  <a id="open-link" href="{model_name}" target="_blank" rel="noopener noreferrer">Open {model_name}</a>
17	  <div class="online_3d_viewer" style="width: 100%; height: 100%;" model="{model_name}"></div>
18	  <script>window.addEventListener ('load', () => {{ OV.Init3DViewerElements (); }});</script>
19	  <script>
20	    document.addEventListener("DOMContentLoaded", function () {{
21	      const link = document.getElementById("open-link");
22	      const currentPageUrl = window.location.href + '{model_name}'; 
23	      link.href = `https://3dviewer.net/#model=${{currentPageUrl}}`;

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/targets/hal9.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	    with open(file_path, 'rb') as file:
23	        file_data = file.read()
24	    base64_data = base64.b64encode(file_data).decode('utf-8')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/targets/hal9.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
23	        file_data = file.read()
24	    base64_data = base64.b64encode(file_data).decode('utf-8')
25	    data_url = f"data:{mime_type};base64,{base64_data}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/targets/hal9.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
23	        file_data = file.read()
24	    base64_data = base64.b64encode(file_data).decode('utf-8')
25	    data_url = f"data:{mime_type};base64,{base64_data}"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/targets/hal9.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
44	                file_path = os.path.join(root, file)
45	                zipf.write(file_path, os.path.relpath(file_path, path))
46	    

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/targets/hal9.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
44	                file_path = os.path.join(root, file)
45	                zipf.write(file_path, os.path.relpath(file_path, path))
46	    

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/targets/hal9.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
57	            with open(os.path.join(root, file), 'rb') as f:
58	                encoded_content = base64.b64encode(f.read()).decode('utf-8')
59	                files_dict[relative_path] = encoded_content

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/targets/hal9.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
57	            with open(os.path.join(root, file), 'rb') as f:
58	                encoded_content = base64.b64encode(f.read()).decode('utf-8')
59	                files_dict[relative_path] = encoded_content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/targets/hal9.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	            with open(os.path.join(root, file), 'rb') as f:
58	                encoded_content = base64.b64encode(f.read()).decode('utf-8')
59	                files_dict[relative_path] = encoded_content

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/targets/hal9.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
83	    }
84	    response = requests.post(url + '/api/v1/assets/upload', headers = headers, data = json.dumps(payload))
85	    

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/targets/hal9.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	    else:
96	        exit(f'HAL9_TOKEN environment variable missing, see https://hal9.com/devs')
97	        # hal9_token = browser_login()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/templates/groq/app.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	
8	completions = Groq(base_url="https://api.hal9.com/proxy/server=https://api.groq.com/", api_key=os.environ['HAL9_TOKEN']).chat.completions.create(model = "llama3-70b-8192", messages = messages, stream = True)
9	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/urls.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
22	    with tempfile.NamedTemporaryFile(delete=False, suffix=file_extension) as temp_file:
23	      with urllib.request.urlopen(prompt) as response:
24	        temp_file.write(response.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/urls.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	      with urllib.request.urlopen(prompt) as response:
24	        temp_file.write(response.read())
25	      temp_file_path = temp_file.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/urls.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
23	      with urllib.request.urlopen(prompt) as response:
24	        temp_file.write(response.read())
25	      temp_file_path = temp_file.name

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/hal9-2.8.16/hal9-2.8.16/hal9/urls.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	      with urllib.request.urlopen(prompt) as response:
24	        temp_file.write(response.read())
25	      temp_file_path = temp_file.name

--------------------------------------------------

Code scanned:
	Total lines of code: 800
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 2.0
Files skipped (0):
