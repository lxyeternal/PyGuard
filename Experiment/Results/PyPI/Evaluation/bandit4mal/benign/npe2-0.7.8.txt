Run started:2025-05-25 13:01:37.830641

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/_docs/render.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	
23	SCHEMA_URL = "https://github.com/napari/npe2/releases/latest/download/schema.json"
24	DOCS = Path(__file__).parent

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/_docs/render.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
189	    else:
190	        with urlopen(SCHEMA_URL) as response:
191	            schema = json.load(response)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_inspection/_fetch.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
281	def _pypi_info(package: str) -> dict:
282	    with request.urlopen(f"https://pypi.org/pypi/{package}/json") as f:
283	        return json.load(f)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_inspection/_fetch.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	def _pypi_info(package: str) -> dict:
282	    with request.urlopen(f"https://pypi.org/pypi/{package}/json") as f:
283	        return json.load(f)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_inspection/_fetch.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
342	    """Extract remote zip file to a temporary directory."""
343	    with tempfile.TemporaryDirectory() as td, request.urlopen(url) as f:
344	        with ZipFile(io.BytesIO(f.read())) as zf:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_inspection/_fetch.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
343	    with tempfile.TemporaryDirectory() as td, request.urlopen(url) as f:
344	        with ZipFile(io.BytesIO(f.read())) as zf:
345	            zf.extractall(td)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_inspection/_fetch.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
353	
354	    with tempfile.TemporaryDirectory() as td, request.urlopen(url) as f:
355	        with tarfile.open(fileobj=f, mode="r:gz") as tar:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_inspection/_fetch.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
353	
354	    with tempfile.TemporaryDirectory() as td, request.urlopen(url) as f:
355	        with tarfile.open(fileobj=f, mode="r:gz") as tar:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_inspection/_fetch.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
354	    with tempfile.TemporaryDirectory() as td, request.urlopen(url) as f:
355	        with tarfile.open(fileobj=f, mode="r:gz") as tar:
356	            tar.extractall(td)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_inspection/_fetch.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
378	    """Return hub information for a specific plugin."""
379	    with request.urlopen(f"https://api.napari-hub.org/plugins/{plugin_name}") as r:
380	        return json.load(r)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_inspection/_fetch.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
378	    """Return hub information for a specific plugin."""
379	    with request.urlopen(f"https://api.napari-hub.org/plugins/{plugin_name}") as r:
380	        return json.load(r)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_inspection/_fetch.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
378	    """Return hub information for a specific plugin."""
379	    with request.urlopen(f"https://api.napari-hub.org/plugins/{plugin_name}") as r:
380	        return json.load(r)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_setuptools_plugin.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
52	    parser = configparser.ConfigParser()
53	    parser.read(["setup.cfg"])
54	    return parser.get("metadata", "name", fallback=None)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/_setuptools_plugin.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
133	        with open(name, encoding="UTF-8") as strm:
134	            data = strm.read()
135	        defn = _lazy_tomli_load(data)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/manifest/_npe1_adapter.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
44	            _cleared = list(ADAPTER_CACHE.iterdir())
45	            rmtree(ADAPTER_CACHE)
46	    return _cleared

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/manifest/_validators.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	        raise ValueError(
35	            f"{name!r} is not a valid python package name. "
36	            "See https://peps.python.org/pep-0508/#names "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/manifest/_validators.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	            raise ValueError(
76	                f"{v} is not a valid icon URL. It must start with 'https://'"
77	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/manifest/contributions/_commands.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        None,
73	        description="Icon used to represent this command in the UI, on "
74	        "buttons or in menus. These may be [superqt](https://github.com/napari/superqt)"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/manifest/contributions/_json_schema.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	
209	    schema_: str = Field("http://json-schema.org/draft-04/schema#", alias="$schema")
210	    id: Optional[str] = Field(None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/manifest/contributions/_json_schema.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
249	
250	    schema_: str = Field("http://json-schema.org/draft-06/schema#", alias="$schema")
251	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/manifest/contributions/_json_schema.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	
271	    schema_: str = Field("http://json-schema.org/draft-07/schema#", alias="$schema")
272	    comment: Optional[str] = Field(None, alias="$comment")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/manifest/contributions/_widgets.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	        default=False,
39	        description="If true, a widget will be autogenerated from the signature of "
40	        "the associated command using [magicgui](https://napari.org/magicgui/).",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/src/npe2/manifest/schema.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
199	        None,
200	        description="Package metadata following "
201	        "https://packaging.python.org/specifications/core-metadata/. "
202	        "For normal (non-dynamic) plugins, this data will come from the package's "
203	        "setup.cfg",
204	        hide_docs=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/npe1-plugin/npe1_module/__init__.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	        "local data": partial(np.ones, (4, 4)),
42	        "random image": "https://picsum.photos/1024",
43	        "sample_key": {
44	            "display_name": "Some Random Data (512 x 512)",
45	            "data": gen_data,
46	        },
47	        "local_ones": {
48	            "display_name": "Some local ones",
49	            "data": partial(np.ones, (4, 4)),
50	        },
51	    }
52	
53	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/sample/_with_decorators.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    title="URL Reader",
41	    filename_patterns=["http://*", "https://*"],
42	    accepts_directories=False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/sample/_with_decorators.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    title="URL Reader",
41	    filename_patterns=["http://*", "https://*"],
42	    accepts_directories=False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/test_config_contribution.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	            description="quux",
38	            ref="http://example.com",
39	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/test_contributions.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	    assert isinstance(ctrbB, SampleDataURI)
120	    assert ctrbB.uri == "https://picsum.photos/1024"
121	    assert isinstance(ctrbA.open(), list)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/test_fetch.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	def test_get_manifest_from_wheel(tmp_path):
75	    url = "https://files.pythonhosted.org/packages/f0/cc/7f6fbce81be3eb73266f398e49df92859ba247134eb086704dd70b43819a/affinder-0.2.3-py3-none-any.whl"
76	    dest = tmp_path / "affinder-0.2.3-py3-none-any.whl"

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/test_fetch.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
76	    dest = tmp_path / "affinder-0.2.3-py3-none-any.whl"
77	    urllib.request.urlretrieve(url, dest)
78	    mf = get_manifest_from_wheel(dest)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/test_fetch.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	    [
91	        "https://files.pythonhosted.org/packages/fb/01/e59bc1d6ac96f84ce9d7a46cc5422250e047958ead6c5693ed386cf94003/napari_dv-0.3.0.tar.gz",
92	        "https://files.pythonhosted.org/packages/5d/ae/17779e12ce60d8329306963e1a8dec608465caee582440011ff0c1310715/example_plugin-0.0.7-py3-none-any.whl",
93	        "git+https://github.com/napari/dummy-test-plugin.git@npe1",
94	        # this one doesn't use setuptools_scm, can check direct zip without clone
95	        "https://github.com/jo-mueller/napari-stl-exporter/archive/refs/heads/main.zip",
96	    ],
97	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/test_fetch.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	        "https://files.pythonhosted.org/packages/fb/01/e59bc1d6ac96f84ce9d7a46cc5422250e047958ead6c5693ed386cf94003/napari_dv-0.3.0.tar.gz",
92	        "https://files.pythonhosted.org/packages/5d/ae/17779e12ce60d8329306963e1a8dec608465caee582440011ff0c1310715/example_plugin-0.0.7-py3-none-any.whl",
93	        "git+https://github.com/napari/dummy-test-plugin.git@npe1",
94	        # this one doesn't use setuptools_scm, can check direct zip without clone
95	        "https://github.com/jo-mueller/napari-stl-exporter/archive/refs/heads/main.zip",
96	    ],
97	)
98	def test_fetch_urls(url):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/test_fetch.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        "https://files.pythonhosted.org/packages/5d/ae/17779e12ce60d8329306963e1a8dec608465caee582440011ff0c1310715/example_plugin-0.0.7-py3-none-any.whl",
93	        "git+https://github.com/napari/dummy-test-plugin.git@npe1",
94	        # this one doesn't use setuptools_scm, can check direct zip without clone
95	        "https://github.com/jo-mueller/napari-stl-exporter/archive/refs/heads/main.zip",
96	    ],
97	)
98	def test_fetch_urls(url):
99	    assert isinstance(fetch_manifest(url), PluginManifest)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/test_fetch.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        # this one doesn't use setuptools_scm, can check direct zip without clone
95	        "https://github.com/jo-mueller/napari-stl-exporter/archive/refs/heads/main.zip",
96	    ],
97	)
98	def test_fetch_urls(url):
99	    assert isinstance(fetch_manifest(url), PluginManifest)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/npe2-0.7.8/npe2-0.7.8/tests/test_validations.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	    """is not a valid icon URL. It must start with 'https://'"""
73	    data["icon"] = "http://example.com/icon.png"
74	

--------------------------------------------------

Code scanned:
	Total lines of code: 8291
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 0.0
Files skipped (0):
