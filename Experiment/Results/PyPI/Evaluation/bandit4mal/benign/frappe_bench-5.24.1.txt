Run started:2025-05-25 12:48:13.738548

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
212				if not os.path.islink(active_app_path):
213					shutil.rmtree(active_app_path)
214				else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
365			if app_path.is_dir():
366				shutil.rmtree(app_path)
367	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
372			mode = "r:gz" if cache_path.suffix.endswith(".tgz") else "r"
373			with tarfile.open(cache_path, mode) as tar:
374				extraction_filter = get_app_cache_extract_filter(count_threshold=150_000)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
387					logger.exception(message)
388					shutil.rmtree(app_path)
389					return False

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
414			try:
415				with tarfile.open(cache_path, mode) as tar:
416					tar.add(app_path.name)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
528	
529		with dinit_path.open("r", encoding="utf-8") as dinit:
530			for line in dinit:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
555			click.secho(
556				"Required frappe version not set in pyproject.toml, "
557				"please refer: https://github.com/frappe/bench/issues/1524",
558				fg="yellow",
559			)
560	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
590			can_delete = False
591			with package_json.open("r", encoding="utf-8") as f:
592				package_json = json.loads(f.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
591			with package_json.open("r", encoding="utf-8") as f:
592				package_json = json.loads(f.read())
593				build_script = package_json.get("scripts", {}).get("build", "")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
600				)
601				shutil.rmtree(node_modules)
602	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
625		try:
626			with open(os.path.join(bench_path, "sites", "excluded_apps.txt")) as f:
627				return f.read().strip().split("\n")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
626			with open(os.path.join(bench_path, "sites", "excluded_apps.txt")) as f:
627				return f.read().strip().split("\n")
628		except OSError:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
643	def write_excluded_apps_txt(apps, bench_path="."):
644		with open(os.path.join(bench_path, "sites", "excluded_apps.txt"), "w") as f:
645			return f.write("\n".join(apps))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
644		with open(os.path.join(bench_path, "sites", "excluded_apps.txt"), "w") as f:
645			return f.write("\n".join(apps))
646	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:847
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
846					click.secho(f"Removing installed app {app.name}", fg="yellow")
847					shutil.rmtree(path_to_app)
848				else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:1045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1044		if path.startswith("http"):
1045			r = requests.get(path)
1046			return r.json()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/app.py:1048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1047	
1048		with open(path) as f:
1049			return json.load(f)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/bench.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89				with open(self.excluded_apps_txt) as f:
90					return f.read().strip().split("\n")
91			except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/bench.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
182				with open(self.states_path) as f:
183					self.states = json.loads(f.read() or "{}")
184			except FileNotFoundError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/bench.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
202					with open(self.bench.apps_txt, "w") as f:
203						f.write("\n".join(self.apps))
204	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/bench.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
256			with open(self.states_path, "w") as f:
257				f.write(json.dumps(self.states, indent=4))
258	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/bench.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
270			with open(self.bench.apps_txt, "w") as f:
271				f.write("\n".join(self.apps))
272	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/bench.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
448				job.every(6).hours()
449				system_crontab.write()
450	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/bench.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
499		def dirs(self):
500			shutil.rmtree(self.bench.name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/cli.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
175			with open(dir_path_file) as f:
176				dir_path = f.read().strip()
177			if os.path.exists(dir_path):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/commands/git.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	def remote_reset_url(app):
24		git_url = f"https://github.com/frappe/{app}.git"
25		set_git_remote_url(git_url)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/commands/make.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
107				if os.path.exists(path):
108					shutil.rmtree(path)
109	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/common_site_config.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
10		"rebase_on_pull": False,
11		"frappe_user": getpass.getuser(),
12		"shallow_clone": True,

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/common_site_config.py:11
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
10		"rebase_on_pull": False,
11		"frappe_user": getpass.getuser(),
12		"shallow_clone": True,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/lets_encrypt.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61		with open(config_path, "w") as f:
62			f.write(config)
63	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/lets_encrypt.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112		job.setall("0 0 */1 * *")  # Run at 00:00 every day-of-month
113		system_crontab.write()
114	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/lets_encrypt.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125			raise CommandFailedError(
126				"Certbot is not installed on your system. Please visit https://certbot.eff.org/instructions for installation instructions, then try again."
127			)
128	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/lets_encrypt.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172			exec_cmd(
173				f"{get_certbot_path()} certonly --manual --preferred-challenges=dns {email_param} \
174				--server https://acme-v02.api.letsencrypt.org/directory \
175				--agree-tos -d {' -d '.join(domain_list)}"
176			)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/nginx.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
65		with open(conf_path, "w") as f:
66			f.write(nginx_conf)
67	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/nginx.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
104		with open(conf_path, "a") as myfile:
105			myfile.write(bench_manager_nginx_conf)
106	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/procfile.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
17	
18		is_mac = platform.system() == "Darwin"
19		if not yes and os.path.exists(procfile_path):

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/procfile.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
17	
18		is_mac = platform.system() == "Darwin"
19		if not yes and os.path.exists(procfile_path):

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/procfile.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
17	
18		is_mac = platform.system() == "Darwin"
19		if not yes and os.path.exists(procfile_path):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/procfile.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
42		with open(procfile_path, "w") as f:
43			f.write(procfile)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/production_setup.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
173		with open("/proc/1/comm") as f:
174			comm = f.read().strip()
175		if comm == "init":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/redis.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66		with open(os.path.join(bench_path, "config", template_name), "w") as f:
67			f.write(template.render(**context))
68	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
27		if not user:
28			user = getpass.getuser()
29	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
27		if not user:
28			user = getpass.getuser()
29	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	
34		web_worker_count = config.get(
35			"gunicorn_workers", get_gunicorn_workers()["gunicorn_workers"]
36		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36		)
37		max_requests = config.get(
38			"gunicorn_max_requests", get_default_max_requests(web_worker_count)
39		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46				"use_rq": use_rq(bench_path),
47				"http_timeout": config.get("http_timeout", 120),
48				"redis_server": which("redis-server"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51				"redis_queue_config": os.path.join(bench_dir, "config", "redis_queue.conf"),
52				"webserver_port": config.get("webserver_port", 8000),
53				"gunicorn_workers": web_worker_count,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56				"bench_name": get_bench_name(bench_path),
57				"background_workers": config.get("background_workers") or 1,
58				"bench_cmd": which("bench"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59				"skip_redis": skip_redis,
60				"workers": config.get("workers", {}),
61				"multi_queue_consumption": can_enable_multi_queue_consumption(bench_path),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73		with open(conf_path, "w") as f:
74			f.write(config)
75	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	
100		socketio_port = common_config.get("redis_socketio")
101		cache_port = common_config.get("redis_cache")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100		socketio_port = common_config.get("redis_socketio")
101		cache_port = common_config.get("redis_cache")
102		if socketio_port and socketio_port != cache_port:

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
127		if not user:
128			user = getpass.getuser()
129	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:128
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
127		if not user:
128			user = getpass.getuser()
129	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
139		config = configparser.ConfigParser()
140		config.read(supervisord_conf)
141	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/supervisor.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149			try:
150				current_value = config.get(section, key)
151			except configparser.NoOptionError:

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
30		if not user:
31			user = getpass.getuser()
32	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
30		if not user:
31			user = getpass.getuser()
32	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	
52		number_of_workers = config.get("background_workers") or 1
53		background_workers = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	
69		web_worker_count = config.get(
70			"gunicorn_workers", get_gunicorn_workers()["gunicorn_workers"]
71		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71		)
72		max_requests = config.get(
73			"gunicorn_max_requests", get_default_max_requests(web_worker_count)
74		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80			"use_rq": use_rq(bench_path),
81			"http_timeout": config.get("http_timeout", 120),
82			"redis_server": which("redis-server"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85			"redis_queue_config": os.path.join(bench_dir, "config", "redis_queue.conf"),
86			"webserver_port": config.get("webserver_port", 8000),
87			"gunicorn_workers": web_worker_count,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120		bench_config_path = os.path.join(
121			bench_path, "config", "systemd", bench_info.get("bench_name") + ".target"
122		)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
124		with open(bench_config_path, "w") as f:
125			f.write(bench_config)
126	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152		bench_workers_target_config_path = os.path.join(
153			bench_path, "config", "systemd", bench_info.get("bench_name") + "-workers.target"
154		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
158			"systemd",
159			bench_info.get("bench_name") + "-frappe-default-worker@.service",
160		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164			"systemd",
165			bench_info.get("bench_name") + "-frappe-short-worker@.service",
166		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
170			"systemd",
171			bench_info.get("bench_name") + "-frappe-long-worker@.service",
172		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176			"systemd",
177			bench_info.get("bench_name") + "-frappe-schedule.service",
178		)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
180		with open(bench_workers_target_config_path, "w") as f:
181			f.write(bench_workers_target_config)
182	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
183		with open(bench_default_worker_config_path, "w") as f:
184			f.write(bench_default_worker_config)
185	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
186		with open(bench_short_worker_config_path, "w") as f:
187			f.write(bench_short_worker_config)
188	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
189		with open(bench_long_worker_config_path, "w") as f:
190			f.write(bench_long_worker_config)
191	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
192		with open(bench_schedule_worker_config_path, "w") as f:
193			f.write(bench_schedule_worker_config)
194	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212		bench_web_target_config_path = os.path.join(
213			bench_path, "config", "systemd", bench_info.get("bench_name") + "-web.target"
214		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215		bench_web_service_config_path = os.path.join(
216			bench_path, "config", "systemd", bench_info.get("bench_name") + "-frappe-web.service"
217		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
221			"systemd",
222			bench_info.get("bench_name") + "-node-socketio.service",
223		)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
225		with open(bench_web_target_config_path, "w") as f:
226			f.write(bench_web_target_config)
227	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
228		with open(bench_web_service_config_path, "w") as f:
229			f.write(bench_web_service_config)
230	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
231		with open(bench_node_socketio_config_path, "w") as f:
232			f.write(bench_node_socketio_config)
233	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251		bench_redis_target_config_path = os.path.join(
252			bench_path, "config", "systemd", bench_info.get("bench_name") + "-redis.target"
253		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
254		bench_redis_cache_config_path = os.path.join(
255			bench_path, "config", "systemd", bench_info.get("bench_name") + "-redis-cache.service"
256		)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
257		bench_redis_queue_config_path = os.path.join(
258			bench_path, "config", "systemd", bench_info.get("bench_name") + "-redis-queue.service"
259		)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
261		with open(bench_redis_target_config_path, "w") as f:
262			f.write(bench_redis_target_config)
263	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
264		with open(bench_redis_cache_config_path, "w") as f:
265			f.write(bench_redis_cache_config)
266	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/config/systemd.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
267		with open(bench_redis_queue_config_path, "w") as f:
268			f.write(bench_redis_queue_config)
269	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/patches/__init__.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13				p.strip()
14				for p in f.read().splitlines()
15				if p.strip() and not p.strip().startswith("#")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/patches/__init__.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20			with open(target_patch_file) as f:
21				executed_patches = f.read().splitlines()
22	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/patches/__init__.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
34			with open(target_patch_file, "w") as f:
35				f.write("\n".join(executed_patches))
36	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/patches/__init__.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
37				# end with an empty line
38				f.write("\n")

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/patches/v5/fix_user_permissions.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
53		"""This patch checks if bench sudoers is set and regenerate supervisor and sudoers files"""
54		user = get_config(".").get("frappe_user") or getpass.getuser()
55	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/patches/v5/fix_user_permissions.py:54
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
53		"""This patch checks if bench sudoers is set and regenerate supervisor and sudoers files"""
54		user = get_config(".").get("frappe_user") or getpass.getuser()
55	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/patches/v5/update_archived_sites.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
45		if not os.listdir(old_directory):
46			os.rmdir(old_directory)
47	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_base.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
52						)
53					shutil.rmtree(bench_path, ignore_errors=True)
54	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_base.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
75				with open(os.path.join(bench_name, "config", config)) as f:
76					self.assertTrue(search_key in f.read())
77	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_base.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106				exec_cmd(
107					f"git clone https://github.com/frappe/frappe -b {FRAPPE_BRANCH} --depth 1 --origin upstream {frappe_tmp_path}"
108				)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_base.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121				exec_cmd(
122					"git remote set-url upstream https://github.com/frappe/frappe",
123					cwd=os.path.join(self.benches_path, bench_name, "apps", "frappe"),
124				)
125	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_init.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
91			with open(site_config_path) as f:
92				site_config = json.loads(f.read())
93	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_init.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
166			with open(os.path.join(bench_path, "sites", "apps.txt")) as f:
167				self.assertFalse(TEST_FRAPPE_APP in f.read())
168			self.assertFalse(

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_setup_production.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
17		def test_setup_production(self):
18			user = getpass.getuser()
19	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_setup_production.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
17		def test_setup_production(self):
18			user = getpass.getuser()
19	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_setup_production.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
55			with open(conf_src) as f:
56				f = f.read()
57	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_setup_production.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
99			with open(conf_src) as f:
100				f = f.read()
101	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_utils.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13		def test_app_utils(self):
14			git_url = "https://github.com/frappe/frappe"
15			branch = "develop"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_utils.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33				is_valid_frappe_branch(
34					"https://github.com/frappe/frappe.git", frappe_branch="random-branch"
35				)
36				is_valid_frappe_branch(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_utils.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36				is_valid_frappe_branch(
37					"https://github.com/random/random.git", frappe_branch="random-branch"
38				)
39	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40			is_valid_frappe_branch(
41				"https://github.com/frappe/frappe.git", frappe_branch="develop"
42			)
43			is_valid_frappe_branch(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43			is_valid_frappe_branch(
44				"https://github.com/frappe/frappe.git", frappe_branch="v13.29.0"
45			)
46	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_utils.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
74			with open(os.path.join(frappe_path, "frappe", "__init__.py"), "w+") as f:
75				f.write("__version__ = '11.0'")
76	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/tests/test_utils.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
99	
100			shutil.rmtree(bench_dir)
101	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138		try:
139			pypi_request = requests.get("https://pypi.org/pypi/frappe-bench/json")
140		except Exception:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
138		try:
139			pypi_request = requests.get("https://pypi.org/pypi/frappe-bench/json")
140		except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145		if pypi_request.status_code == 200:
146			pypi_version_str = pypi_request.json().get("info").get("version")
147			pypi_version = Version(pypi_version_str)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145		if pypi_request.status_code == 200:
146			pypi_version_str = pypi_request.json().get("info").get("version")
147			pypi_version = Version(pypi_version_str)

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
251	def is_root():
252		return os.getuid() == 0
253	

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:252
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
251	def is_root():
252		return os.getuid() == 0
253	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
258	
259		bench_path = kwargs.get("bench_path", ".")
260		f = get_env_cmd("python", bench_path=bench_path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
268	
269		p = subprocess.Popen(
270			(f, "-m", "frappe.utils.bench_helper", "frappe") + args,
271			cwd=sites_dir,
272			stdout=stdout,
273			stderr=stderr,
274		)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
289					while 1:
290						buf = p.stdout.read(1)
291						if not len(buf):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
306		if stream == "stderr":
307			return sys.stderr.write(data)
308		return sys.stdout.write(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
307			return sys.stderr.write(data)
308		return sys.stdout.write(data)
309	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
437		for org in ["frappe", "erpnext"]:
438			res = requests.head(f"https://api.github.com/repos/{org}/{org_repo}")
439			if res.status_code in (400, 403):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
439			if res.status_code in (400, 403):
440				res = requests.head(f"https://github.com/{org}/{org_repo}")
441			if res.ok:

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
484		# from http://stackoverflow.com/a/2699996
485		if os.getuid() != 0:
486			# We're not root so, like, whatever dude

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:485
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
484		# from http://stackoverflow.com/a/2699996
485		if os.getuid() != 0:
486			# We're not root so, like, whatever dude

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
531		def __getattr__(self, key):
532			ret = self.get(key)
533			# "__deepcopy__" exception added to fix frappe#14833 via DFP

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
629	def get_file_md5(p: Path) -> "str":
630		with open(p.as_posix(), "rb") as f:
631			try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/__init__.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
638	
639			while chunk := f.read(2**16):
640				file_md5.update(chunk)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
132		with open(os.path.join(repo_dir, os.path.basename(repo_dir), "hooks.py")) as f:
133			return get_version_from_string(f.read(), field="develop_version")
134	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
182	
183		git_api_url = f"https://api.github.com/repos/{org}/{name}/contents/{name}/{deps}"
184		params = {"ref": branch or "develop"}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184		params = {"ref": branch or "develop"}
185		res = requests.get(url=git_api_url, params=params).json()
186	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188			git_url = (
189				f"https://raw.githubusercontent.com/{org}/{name}/{params['ref']}/{name}/{deps}"
190			)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190			)
191			return requests.get(git_url).text
192	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238		if pyproject:
239			app_name = pyproject.get("project", {}).get("name")
240	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238		if pyproject:
239			app_name = pyproject.get("project", {}).get("name")
240	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244			config = read_configuration(config_py_path)
245			app_name = config.get("metadata", {}).get("name")
246	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244			config = read_configuration(config_py_path)
245			app_name = config.get("metadata", {}).get("name")
246	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
249			with open(setup_py_path, "rb") as f:
250				app_name = re.search(r'name\s*=\s*[\'"](.*)[\'"]', f.read().decode("utf-8"))[1]
251	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
288			if pyproject:
289				current_version = pyproject.get("project", {}).get("version")
290	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
288			if pyproject:
289				current_version = pyproject.get("project", {}).get("version")
290	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294				config = read_configuration(config_path)
295				current_version = config.get("metadata", {}).get("version")
296			if not current_version:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294				config = read_configuration(config_path)
295				current_version = config.get("metadata", {}).get("version")
296			if not current_version:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
297				with open(init_path) as f:
298					current_version = get_version_from_string(f.read())
299	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/app.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
302			with open(setup_path) as f:
303				current_version = get_version_from_string(f.read(), field="version")
304	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/bench.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
117		with open(pyproject_path) as f:
118			pyproject_config = loads(f.read())
119	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/bench.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
165				with open(package_json_path) as f:
166					app_package_json = json.loads(f.read())
167					# package.json is usually a dict in a dict

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/bench.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
180			with open(os.path.join(os.path.dirname(__file__), "package.json")) as f:
181				package_json = json.loads(f.read())
182	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/bench.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
183		with open(os.path.join(bench_path, "package.json"), "w") as f:
184			f.write(json.dumps(package_json, indent=1, sort_keys=True))
185	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/bench.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
497		print(
498			"_" * 80 + "\nBench: Deployment tool for Frappe and Frappe Applications"
499			" (https://frappe.io/bench).\nOpen source depends on your contributions, so do"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/bench.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
538		with open(os.path.join(clone_from, "sites", "apps.txt")) as f:
539			apps = f.read().splitlines()
540	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/bench.py:778
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
777		tot_size = get_dir_size(cache_path)
778		shutil.rmtree(cache_path)
779	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/system.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84		else:
85			frappe_path = frappe_path or "https://github.com/frappe/frappe.git"
86			is_valid_frappe_branch(frappe_path=frappe_path, frappe_branch=frappe_branch)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/system.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
125			with open("/etc/sudoers", "a") as f:
126				f.write("\n#includedir /etc/sudoers.d\n")
127	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/system.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
128			if set_permissions:
129				os.chmod("/etc/sudoers", 0o440)
130	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/system.py:129
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
128			if set_permissions:
129				os.chmod("/etc/sudoers", 0o440)
130	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/system.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
142		with open(sudoers_file, "w") as f:
143			f.write(frappe_sudoers)
144	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/system.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
144	
145		os.chmod(sudoers_file, 0o440)
146		log(f"Sudoers was set up for user {user}", level=1)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/system.py:145
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
144	
145		os.chmod(sudoers_file, 0o440)
146		log(f"Sudoers was set up for user {user}", level=1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/system.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	
210		exec_cmd("git clone https://github.com/frappe/fonts.git", cwd="/tmp")
211		os.rename("/etc/fonts", "/etc/fonts_backup")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/system.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
214		os.rename(os.path.join(fonts_path, "usr_share_fonts"), "/usr/share/fonts")
215		shutil.rmtree(fonts_path)
216		exec_cmd("fc-cache -fv")

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/translation.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
18	
19		pool = multiprocessing.Pool(multiprocessing.cpu_count())
20	

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/translation.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
18	
19		pool = multiprocessing.Pool(multiprocessing.cpu_count())
20	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/translation.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37		with open(lang_file) as f:
38			langs = json.loads(f.read())
39		return [d["code"] for d in langs]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/translation.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46		csv_file = os.path.join(translations_dir, f"{lang}.csv")
47		url = f"https://translate.erpnext.com/files/{app}-{lang}.csv"
48		r = requests.get(url, stream=True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/translation.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47		url = f"https://translate.erpnext.com/files/{app}-{lang}.csv"
48		r = requests.get(url, stream=True)
49		r.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/frappe_bench-5.24.1/frappe_bench-5.24.1/bench/utils/translation.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
54				if chunk:
55					f.write(chunk)
56					f.flush()

--------------------------------------------------

Code scanned:
	Total lines of code: 6007
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 32.0
		High: 135.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 155.0
		High: 12.0
Files skipped (0):
