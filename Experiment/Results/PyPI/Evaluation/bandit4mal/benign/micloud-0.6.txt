Run started:2025-05-25 12:54:15.652582

Test results:
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/micloud.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
68	        try:
69	            if self._login_request():
70	                self.failed_logins = 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/micloud.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	
132	        url = "https://account.xiaomi.com/pass/serviceLogin?sid=xiaomiio&_json=true"
133	        self.session.cookies.update({'userId': self.user_id if self.user_id else self.username})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/micloud.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	        self.session.cookies.update({'userId': self.user_id if self.user_id else self.username})
134	        response = self.session.get(url)
135	        response_json = json.loads(response.text.replace("&&&START&&&", ""))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/micloud.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	
156	        url = "https://account.xiaomi.com/pass/serviceLoginAuth2"
157	        post_data = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/micloud.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	            'hash': hashlib.md5(self.password.encode()).hexdigest().upper(),
160	            'callback': "https://sts.api.io.mi.com/sts",
161	            'qs': '%3Fsid%3Dxiaomiio%26_json%3Dtrue',
162	            'user': self.username,
163	            '_json': 'true'
164	        }
165	        if sign:
166	            post_data['_sign'] = sign
167	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/micloud.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
167	
168	        response = self.session.post(url, data = post_data)
169	        response_json = json.loads(response.text.replace("&&&START&&&", ""))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/micloud.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	        self.session.headers.update({'content-type': 'application/x-www-form-urlencoded'})
202	        response = self.session.get(location)
203	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/micloud.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
257	        try:
258	            resp = self.request(url, params)
259	            logging.debug("Get devices response: %s", resp)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/micloud.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
272	        url = self._get_api_url(country) + url_part
273	        response = self.request(url, params)
274	        logging.debug("Request to %s server %s. Response: %s", country, url_part, response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/micloud.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
308	
309	            response = self.session.post(url, data = post_data)
310	            if response.status_code == 403:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miotspec.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	
28	    BASE_URL = "https://miot-spec.org/miot-spec-v2"
29	
30	    @classmethod
31	    def get_specs(cls, status="released", session=None):

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
36	    b += part2.to_bytes(((part2.bit_length()+7)//8), 'big')
37	    return base64.b64encode(b).decode('utf-8')
38	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:37
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
36	    b += part2.to_bytes(((part2.bit_length()+7)//8), 'big')
37	    return base64.b64encode(b).decode('utf-8')
38	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
41	    m = hashlib.sha256()
42	    m.update(base64.b64decode(bytes(ssecret, 'utf-8')))
43	    m.update(base64.b64decode(bytes(nonce, 'utf-8')))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
41	    m = hashlib.sha256()
42	    m.update(base64.b64decode(bytes(ssecret, 'utf-8')))
43	    m.update(base64.b64decode(bytes(nonce, 'utf-8')))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
42	    m.update(base64.b64decode(bytes(ssecret, 'utf-8')))
43	    m.update(base64.b64decode(bytes(nonce, 'utf-8')))
44	    base64_bytes = base64.b64encode(m.digest())

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
42	    m.update(base64.b64decode(bytes(ssecret, 'utf-8')))
43	    m.update(base64.b64decode(bytes(nonce, 'utf-8')))
44	    base64_bytes = base64.b64encode(m.digest())

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
43	    m.update(base64.b64decode(bytes(nonce, 'utf-8')))
44	    base64_bytes = base64.b64encode(m.digest())
45	    return base64_bytes.decode('utf-8')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
43	    m.update(base64.b64decode(bytes(nonce, 'utf-8')))
44	    base64_bytes = base64.b64encode(m.digest())
45	    return base64_bytes.decode('utf-8')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	        for key in sorted (params) : 
62	            exps.append("%s=%s" % (key, params.get(key)))
63	    

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
73	
74	    signature = hmac.new(base64.b64decode(bytes(signed_nonce, 'utf-8')), msg = bytes(sign, 'utf-8'), digestmod = hashlib.sha256).digest()
75	    base64_bytes = base64.b64encode(signature)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:74
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
73	
74	    signature = hmac.new(base64.b64decode(bytes(signed_nonce, 'utf-8')), msg = bytes(sign, 'utf-8'), digestmod = hashlib.sha256).digest()
75	    base64_bytes = base64.b64encode(signature)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
74	    signature = hmac.new(base64.b64decode(bytes(signed_nonce, 'utf-8')), msg = bytes(sign, 'utf-8'), digestmod = hashlib.sha256).digest()
75	    base64_bytes = base64.b64encode(signature)
76	    return base64_bytes.decode('utf-8')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:75
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
74	    signature = hmac.new(base64.b64decode(bytes(signed_nonce, 'utf-8')), msg = bytes(sign, 'utf-8'), digestmod = hashlib.sha256).digest()
75	    base64_bytes = base64.b64encode(signature)
76	    return base64_bytes.decode('utf-8')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
89	    signature_string = "&".join(signature_params)
90	    return base64.b64encode(hashlib.sha1(signature_string.encode('utf-8')).digest()).decode()
91	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:90
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
89	    signature_string = "&".join(signature_params)
90	    return base64.b64encode(hashlib.sha1(signature_string.encode('utf-8')).digest()).decode()
91	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
107	def encrypt_rc4(password, payload):
108	    r = ARC4.new(base64.b64decode(password))
109	    r.encrypt(bytes(1024))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:108
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
107	def encrypt_rc4(password, payload):
108	    r = ARC4.new(base64.b64decode(password))
109	    r.encrypt(bytes(1024))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
109	    r.encrypt(bytes(1024))
110	    return base64.b64encode(r.encrypt(payload.encode())).decode()
111	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:110
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
109	    r.encrypt(bytes(1024))
110	    return base64.b64encode(r.encrypt(payload.encode())).decode()
111	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
113	def decrypt_rc4(password, payload):
114	    r = ARC4.new(base64.b64decode(password))
115	    r.encrypt(bytes(1024))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:114
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
113	def decrypt_rc4(password, payload):
114	    r = ARC4.new(base64.b64decode(password))
115	    r.encrypt(bytes(1024))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
115	    r.encrypt(bytes(1024))
116	    return r.encrypt(base64.b64decode(payload))
117	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/micloud/miutils.py:116
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
115	    r.encrypt(bytes(1024))
116	    return r.encrypt(base64.b64decode(payload))
117	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    author_email = 'sammy@ssvensson.se',
15	    url = 'https://github.com/squachen/micloud',
16	    download_url = 'https://github.com/Squachen/micloud/archive/v_0.6.tar.gz',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/micloud-0.6/micloud-0.6/setup.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    url = 'https://github.com/squachen/micloud',
16	    download_url = 'https://github.com/Squachen/micloud/archive/v_0.6.tar.gz',
17	    install_requires=[

--------------------------------------------------

Code scanned:
	Total lines of code: 512
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 19.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 11.0
Files skipped (0):
