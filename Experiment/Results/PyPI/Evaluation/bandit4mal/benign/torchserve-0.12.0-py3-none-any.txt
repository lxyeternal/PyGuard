Run started:2025-05-25 13:10:07.886444

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/async_service.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
169	
170	            with ThreadPoolExecutor(1) as executor:
171	                await asyncio.get_event_loop().run_in_executor(executor, check_threads)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/handler_utils/micro_batching.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
108	
109	                t = threading.Thread(
110	                    target=execute_call,
111	                    args=(in_queue, out_queue, call, self.thread_local_data, event),
112	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/handler_utils/micro_batching.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
113	                t.start()
114	                self.thread_groups[c].append(WorkerThread(event, t))
115	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/launcher.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	                while not self.queue1.empty():
41	                    self.queue1.get(False)
42	        except Empty:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/launcher.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	                while not self.queue2.empty():
48	                    self.queue2.get(False)
49	        except Empty:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/launcher.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	        while True:
63	            line = self._queue.get()
64	            if not line:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/launcher.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
107	def register_model_with_params(params):
108	    response = requests.post("http://localhost:8081/models", params=params)
109	    return response

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/launcher.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	def register_model_with_params(params):
108	    response = requests.post("http://localhost:8081/models", params=params)
109	    return response

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/llm_launcher.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	                "clone",
26	                "https://github.com/NVIDIA/TensorRT-LLM.git",
27	                "-b",
28	                "v0.12.0",
29	                "/tmp/TensorRT-LLM",
30	            ]
31	        )
32	    if not Path(f"{model_store}/{model_name}/tllm_checkpoint_1gpu_bf16").exists():
33	        subprocess.run(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/llm_launcher.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
160	    if args.engine == "vllm":
161	        shutil.rmtree(mar_file_path)
162	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/metrics/caching_metric.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
104	            f"[METRICS]{self.metric_name}.{self.unit}:{value}|#{dimension_string}|"
105	            f"#type:{self.metric_type.name}|#hostname:{socket.gethostname()},{int(time.time())}"
106	        )

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/metrics/caching_metric.py:105
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
104	            f"[METRICS]{self.metric_name}.{self.unit}:{value}|#{dimension_string}|"
105	            f"#type:{self.metric_type.name}|#hostname:{socket.gethostname()},{int(time.time())}"
106	        )

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/metrics/metric.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
91	            return (
92	                f"{self.name}.{self.unit}:{self.value}|#{dims}|#hostname:{socket.gethostname()},"
93	                f"{int(time.time())},{self.request_id}"

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/metrics/metric.py:92
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
91	            return (
92	                f"{self.name}.{self.unit}:{self.value}|#{dims}|#hostname:{socket.gethostname()},"
93	                f"{int(time.time())},{self.request_id}"

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/metrics/metric.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
95	
96	        return f"{self.name}.{self.unit}:{self.value}|#{dims}|#hostname:{socket.gethostname()},{int(time.time())}"
97	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/metrics/metric.py:96
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
95	
96	        return f"{self.name}.{self.unit}:{self.value}|#{dims}|#hostname:{socket.gethostname()},{int(time.time())}"
97	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/metrics/metric.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
108	                "Timestamp": int(time.time()),
109	                "HostName": socket.gethostname(),
110	                "RequestId": self.request_id,

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/metrics/metric.py:109
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
108	                "Timestamp": int(time.time()),
109	                "HostName": socket.gethostname(),
110	                "RequestId": self.request_id,

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_server.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
111	        class_path = "{}{}".format(
112	            platform_path_separator[platform.system()],
113	            os.path.join(ts_home, "ts", "frontend", "*"),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_server.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
111	        class_path = "{}{}".format(
112	            platform_path_separator[platform.system()],
113	            os.path.join(ts_home, "ts", "frontend", "*"),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_server.py:112
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
111	        class_path = "{}{}".format(
112	            platform_path_separator[platform.system()],
113	            os.path.join(ts_home, "ts", "frontend", "*"),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_server.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
214	            with open(pid_file, "w") as pf:
215	                pf.write(str(pid))
216	            if args.foreground:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_server.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
214	            with open(pid_file, "w") as pf:
215	                pf.write(str(pid))
216	            if args.foreground:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_service_worker.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
66	        elif s_type == "tcp":
67	            self.sock_name = host_addr if host_addr is not None else "127.0.0.1"
68	            if port_num is None:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_service_worker.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
75	        socket_family = socket.AF_INET if s_type == "tcp" else socket.AF_UNIX
76	        self.sock = socket.socket(socket_family, socket.SOCK_STREAM)
77	        self.metrics_cache = MetricsCacheYamlImpl(config_file_path=metrics_config)

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_service_worker.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
186	                    if LOCAL_RANK == 0:
187	                        cl_socket.sendall(resp)
188	                    else:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_service_worker.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
198	                resp += create_load_model_response(code, result)
199	                cl_socket.sendall(resp)
200	                if code != 200:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_service_worker.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
222	                resp += create_load_model_response(code, result)
223	                cl_socket.sendall(resp)
224	                if code != 200:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/model_service_worker.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
243	        if not DEBUG:
244	            self.sock.settimeout(SOCKET_ACCEPT_TIMEOUT)
245	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/protocol/otf_message_handler.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
139	                buff.seek(0)
140	                val_bytes = buff.read()
141	                msg += struct.pack("!i", len(val_bytes))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/torch_handler/base_handler.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
259	                logger.warning(
260	                    "This approach of specifying torch.compile() options is deprecated. The new standard approach is mentioned in https://github.com/pytorch/serve/issues/3164"
261	                )
262	        else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/torch_handler/request_envelope/json.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
44	                if list(row.keys()) == ["b64"]:
45	                    rows[row_i] = b64decode(row["b64"])
46	                else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/torch_handler/request_envelope/json.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
44	                if list(row.keys()) == ["b64"]:
45	                    rows[row_i] = b64decode(row["b64"])
46	                else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/torch_handler/request_envelope/json.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
50	                        ]:
51	                            row[col] = b64decode(col_value["b64"])
52	        return rows

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/torch_handler/request_envelope/json.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
50	                        ]:
51	                            row[col] = b64decode(col_value["b64"])
52	        return rows

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/torch_handler/unit_tests/test_image_segmenter.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	
39	    model_url = "https://download.pytorch.org/models/fcn_resnet101_coco-7ecb50ca.pth"
40	
41	    download_model(model_url, model_dir)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/torch_handler/unit_tests/test_object_detector.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    model_url = (
41	        "https://download.pytorch.org/models/fasterrcnn_resnet50_fpn_coco-258fb6c6.pth"
42	    )
43	
44	    download_model(model_url, model_dir)
45	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/torch_handler/unit_tests/test_utils/model_dir.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
20	    if not cache_dir.joinpath(filename).exists():
21	        with request.urlopen(model_url) as fin:
22	            with open(cache_dir / filename, "wb") as fout:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/torch_handler/vision_handler.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
49	                # if the image is a string of bytesarray.
50	                image = base64.b64decode(image)
51	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/torch_handler/vision_handler.py:50
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
49	                # if the image is a string of bytesarray.
50	                image = base64.b64decode(image)
51	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/utils/setup_model_venv.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
36	            if os.path.exists(user_site_packages_dir):
37	                f.write(f"{user_site_packages_dir}\n")
38	                print(user_site_packages_dir)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/utils/setup_model_venv.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
41	            if os.path.exists(global_site_packages_dir):
42	                f.write(f"{global_site_packages_dir}\n")
43	                print(global_site_packages_dir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchserve-0.12.0-py3-none-any/ts/version.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	version_path = os.path.join(Path(__file__).resolve().parent, 'version.txt')
8	__version__ = open(version_path, 'r').read().strip()

--------------------------------------------------

Code scanned:
	Total lines of code: 6192
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 9.0
Files skipped (0):
