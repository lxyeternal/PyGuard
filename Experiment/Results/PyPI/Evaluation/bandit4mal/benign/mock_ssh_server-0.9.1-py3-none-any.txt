Run started:2025-05-25 13:49:36.624217

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/conftest.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
49	        yield td
50	        shutil.rmtree(td)
51	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/server.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	                self.command_queues[channel.chanid] = Queue()
51	            t = threading.Thread(target=self.handle_client, args=(channel,))
52	            t.setDaemon(True)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/server.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
69	            try:
70	                channel.close()
71	            except EOFError:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/server.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
99	class Server(object):
100	    host = "127.0.0.1"
101	    handler_cls = Handler

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/server.py:127
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
126	    def __enter__(self):
127	        self._socket = s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
128	        s.bind((self.host, 0))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/server.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	        s.listen(5)
130	        self._thread = t = threading.Thread(target=self._run)
131	        t.setDaemon(True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/server.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	                handler = self.handler_cls(self, (conn, addr))
151	                t = threading.Thread(target=handler.run)
152	                t.setDaemon(True)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/server.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
157	            self._socket.shutdown(socket.SHUT_RDWR)
158	            self._socket.close()
159	        except Exception:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/server.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
171	        c.set_missing_host_key_policy(paramiko.RejectPolicy())
172	        c.connect(hostname=self.host,
173	                  port=self.port,
174	                  username=uid,
175	                  key_filename=private_key_path,
176	                  allow_agent=False,
177	                  look_for_keys=False)
178	        return c

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/sftp.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
137	            try:
138	                os.chmod(path, attrs.st_mode)
139	            except OSError as e:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/sftp.py:138
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
137	            try:
138	                os.chmod(path, attrs.st_mode)
139	            except OSError as e:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_server.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
56	    user, private_key = list(server._users.items())[0]
57	    open(pkey_path, 'w').write(open(private_key[0]).read())
58	    ssh_command = 'ssh -oStrictHostKeyChecking=no '

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
9	        with open(fname1, "rb") as f1, open(fname2, "rb") as f2:
10	            if f1.read() == f2.read():
11	                return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
9	        with open(fname1, "rb") as f1, open(fname2, "rb") as f2:
10	            if f1.read() == f2.read():
11	                return True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
29	
30	    open(foo, "w").write("foo")
31	    sftp_client.symlink(foo, bar)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	
39	    open(foo, "w").write("foo")
40	    os.symlink(foo, bar)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	def test_listdir(sftp_client, tmp_dir):
48	    open(os.path.join(tmp_dir, "foo"), "w").write("foo")
49	    open(os.path.join(tmp_dir, "bar"), "w").write("bar")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	    open(os.path.join(tmp_dir, "foo"), "w").write("foo")
49	    open(os.path.join(tmp_dir, "bar"), "w").write("bar")
50	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	    test_file = os.path.join(tmp_dir, "x")
60	    open(test_file, "w").write("X")
61	    sftp_client.remove(test_file)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66	    test_file = os.path.join(tmp_dir, "x")
67	    open(test_file, "w").write("X")
68	    sftp_client.unlink(test_file)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
88	    test_file = os.path.join(tmp_dir, "foo")
89	    open(test_file, "w").write("X")
90	    sftp_client.chmod(test_file, 0o600)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
89	    open(test_file, "w").write("X")
90	    sftp_client.chmod(test_file, 0o600)
91	    st = os.stat(test_file)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	    test_file = os.path.join(tmp_dir, "foo")
98	    open(test_file, "w").write("X")
99	    # test process probably can't change file uids

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
100	    # so just test if no exception occurs
101	    sftp_client.chown(test_file, os.getuid(), os.getgid())
102	

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:101
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
100	    # so just test if no exception occurs
101	    sftp_client.chown(test_file, os.getuid(), os.getgid())
102	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
105	    test_file = os.path.join(tmp_dir, "foo")
106	    open(test_file, "w").write("X")
107	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/mock_ssh_server-0.9.1-py3-none-any/mockssh/test_sftp.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	    test_file = os.path.join(tmp_dir, "foo")
115	    open(test_file, "w").write("X")
116	    renamed_test_file = os.path.join(tmp_dir, "bar")

--------------------------------------------------

Code scanned:
	Total lines of code: 565
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 3.0
Files skipped (0):
