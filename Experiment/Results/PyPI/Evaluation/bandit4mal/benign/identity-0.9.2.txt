Run started:2025-05-25 13:16:16.935387

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        cache = msal.SerializableTokenCache()
72	        if self._session.get(self._TOKEN_CACHE):
73	            cache.deserialize(self._session[self._TOKEN_CACHE])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	    def _load_user_from_session(self):
94	        return self._session.get(self._USER)  # It may already be expired
95	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
187	        """
188	        if auth_response and auth_response.get("state") == self._STATE_NO_OP:
189	            return {}  # Return a no-op, as that is what the request opted for

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	            return {}  # Return a no-op, as that is what the request opted for
190	        auth_flow = self._session.get(self._AUTH_FLOW, {})
191	        if not auth_flow:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
234	        flow = self._session.pop(self._AUTH_FLOW, {})
235	        return {"next_link": flow.get(self.__NEXT_LINK)}
236	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
278	            client_credential=self._client_credential, cache=cache)
279	        accounts = app.get_accounts(username=user.get("preferred_username"))
280	        if accounts:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
283	            self._save_cache(cache)  # Cache might be refreshed. Save it.
284	            if result and result.get("id_token_claims"):
285	                self._save_user_into_session(result["id_token_claims"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	        a = self._oidc_authority or self._authority
295	        conf = requests.get(f"{a}/.well-known/openid-configuration").json()
296	        if not conf.get(self._END_SESSION_ENDPOINT):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
295	        conf = requests.get(f"{a}/.well-known/openid-configuration").json()
296	        if not conf.get(self._END_SESSION_ENDPOINT):
297	            logger.warning(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
318	            # but its default (i.e. v1.0) endpoint will sign out the (only?) account
319	            endpoint = self._get_oidc_config().get(self._END_SESSION_ENDPOINT)
320	            if endpoint:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
433	            b2c_authority_template = (  # TODO: Support custom domain
434	                "https://{tenant}.b2clogin.com/{tenant}.onmicrosoft.com/{user_flow}")
435	            self._authority = b2c_authority_template.format(
436	                tenant=b2c_tenant_name,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
496	                        access_token=result["access_token"],
497	                        token_type=result.get("token_type", "Bearer"),
498	                        expires_in=result.get("expires_in", 300),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
497	                        token_type=result.get("token_type", "Bearer"),
498	                        expires_in=result.get("expires_in", 300),
499	                        refresh_token=result.get("refresh_token"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
498	                        expires_in=result.get("expires_in", 300),
499	                        refresh_token=result.get("refresh_token"),
500	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
500	                    )
501	                    context["scopes"] = result["scope"].split() if result.get(
502	                        "scope") else scopes
503	                else:  # Token request failed

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
505	                        "Access token unavailable. Error: %s, Desc: %s, keys: %s",
506	                        result.get("error"), result.get("error_description"),
507	                        result.keys())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/identity/web.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
505	                        "Access token unavailable. Error: %s, Desc: %s, keys: %s",
506	                        result.get("error"), result.get("error_description"),
507	                        result.keys())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_django.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    with pytest.raises(ValueError):
11	        _parse_redirect_uri("https://example.com")
12	    with pytest.raises(ValueError):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_django.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    with pytest.raises(ValueError):
13	        _parse_redirect_uri("https://example.com/")
14	    assert _parse_redirect_uri("https://example.com/x") == ("", "x")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_django.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        _parse_redirect_uri("https://example.com/")
14	    assert _parse_redirect_uri("https://example.com/x") == ("", "x")
15	    with pytest.raises(ValueError):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_django.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    with pytest.raises(ValueError):
16	        _parse_redirect_uri("https://example.com/x/")
17	    assert _parse_redirect_uri("https://example.com/x/y") == ("x/", "y")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_django.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        _parse_redirect_uri("https://example.com/x/")
17	    assert _parse_redirect_uri("https://example.com/x/y") == ("x/", "y")
18	    assert _parse_redirect_uri("https://example.com/x/y/z") == ("x/y/", "z")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_django.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    assert _parse_redirect_uri("https://example.com/x/y") == ("x/", "y")
18	    assert _parse_redirect_uri("https://example.com/x/y/z") == ("x/y/", "z")
19	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_flask.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
18	    yield app
19	    shutil.rmtree("flask_session")  # clean up
20	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_flask.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	        client_id="fake",
26	        redirect_uri="http://localhost:5000/redirect",  # To use auth code flow
27	        oidc_authority="https://example.com/foo",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_flask.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        redirect_uri="http://localhost:5000/redirect",  # To use auth code flow
27	        oidc_authority="https://example.com/foo",
28	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_flask.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    with patch.object(auth._auth, "_get_oidc_config", new=Mock(return_value={
32	        "end_session_endpoint": "https://example.com/end_session",
33	    })):
34	        with app.test_request_context("/", method="GET"):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_flask.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	        with app.test_request_context("/", method="GET"):
35	            homepage = "http://localhost/app_root"
36	            assert homepage in auth.logout().get_data(as_text=True), (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_flask.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	            assert session.get("_auth_flow", {}).get("identity.web.next_link") == (
58	                "http://localhost/app_root/path?foo=bar"  # The full url
59	                ), "Next path should honor APPLICATION_ROOT"
60	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_flask.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	@patch("msal.authority.tenant_discovery", new=Mock(return_value={
40	    "authorization_endpoint": "https://example.com/placeholder",
41	    "token_endpoint": "https://example.com/placeholder",
42	    }))
43	def test_login(app, auth):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_flask.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    "authorization_endpoint": "https://example.com/placeholder",
41	    "token_endpoint": "https://example.com/placeholder",
42	    }))
43	def test_login(app, auth):
44	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_quart.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	        app,
13	        authority="https://login.microsoftonline.com/123",
14	        client_id="fake",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_quart.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	        client_credential="fake",
16	        redirect_uri="http://localhost:5000/auth_response",
17	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_quart.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        lambda *args, **kwargs: {
23	            "authorization_endpoint": "https://login.microsoftonline.com/123/oauth2/v2.0/authorize",
24	            "token_endpoint": "https://login.microsoftonline.com/123/oauth2/v2.0/token",
25	        },
26	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_quart.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	            "authorization_endpoint": "https://login.microsoftonline.com/123/oauth2/v2.0/authorize",
24	            "token_endpoint": "https://login.microsoftonline.com/123/oauth2/v2.0/token",
25	        },
26	    )
27	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/identity-0.9.2/identity-0.9.2/tests/test_quart.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	
31	        assert "https://login.microsoftonline.com/123/oauth2/v2.0/authorize" in rendered_template
32	

--------------------------------------------------

Code scanned:
	Total lines of code: 1082
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 0.0
Files skipped (0):
