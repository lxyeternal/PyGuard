Run started:2025-05-25 12:37:22.899025

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/docs/source/conf.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
276	# Example configuration for intersphinx: refer to the Python standard library.
277	intersphinx_mapping = {"python": ("http://docs.python.org/", None)}
278	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/examples/async_reader.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
6	
7	BULBIP = "192.168.107.116"
8	
9	
10	logging.basicConfig(level=logging.DEBUG)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/examples/music_mode_test.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
10	
11	BULBIP = "10.76.19.240"
12	
13	
14	def do_nothing(param):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/aio.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
404	            with contextlib.suppress(socket.error):
405	                writer.close()
406	                async with asyncio_timeout(TIMEOUT):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/aio.py:778
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
777	            def on_connect(reader, writer):
778	                server.close()
779	                future.set_result((reader, writer))

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/decorator.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
203	            code = compile(src, filename, "single")
204	            exec(code, evaldict)
205	        except:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:517
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
516	        if self.__socket is None:
517	            self.__socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
518	            self.__socket.settimeout(5)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
517	            self.__socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
518	            self.__socket.settimeout(5)
519	            self.__socket.connect((self._ip, self._port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
518	            self.__socket.settimeout(5)
519	            self.__socket.connect((self._ip, self._port))
520	        return self.__socket

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:696
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
695	            self._is_listening = True
696	            self._notification_socket = socket.socket(
697	                socket.AF_INET, socket.SOCK_STREAM
698	            )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
699	            self._notification_socket.setblocking(True)
700	            self._notification_socket.connect((self._ip, self._port))
701	            while self._notification_socket is not None:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
701	            while self._notification_socket is not None:
702	                data = self._notification_socket.recv(16 * 1024)
703	                for line in data.split(b"\r\n"):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
720	                return
721	            self._notification_socket.close()
722	            self._notification_socket = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
728	        self._notification_socket.shutdown(socket.SHUT_RDWR)
729	        self._notification_socket.close()
730	        self._notification_socket = None

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
806	        try:
807	            self._socket.send(request)
808	            # This is a workaround for some firmware versions, it seems to help with the

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
809	            # "Bulb closed the connection" issue. More discussion can be found in issue #61.
810	            self._socket.send(b" ")
811	        except socket.error as ex:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
813	            # create a new one.
814	            self.__socket.close()
815	            self.__socket = None

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
828	            try:
829	                data = self._socket.recv(16 * 1024)
830	            except socket.error:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
831	                # An error occured, let's close and abort...
832	                self.__socket.close()
833	                self.__socket = None

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:1186
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1185	
1186	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
1187	        # Reuse sockets so we don't hit "address already in use" errors.

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:1195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
1194	        self.send_command("set_music", [1, local_ip, port])
1195	        s.settimeout(5)
1196	        conn, _ = s.accept()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:1197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1196	        conn, _ = s.accept()
1197	        s.close()  # Close the listening socket.
1198	        self.__socket.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:1198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1197	        s.close()  # Close the listening socket.
1198	        self.__socket.close()
1199	        self.__socket = conn

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/main.py:1213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1212	        if self.__socket:
1213	            self.__socket.close()
1214	            self.__socket = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/metadata.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	copyright = "2016 " + authors_string
25	url = "https://gitlab.com/stavros/python-yeelight"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/ssdp_discover.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
23	
24	def send_discovery_packet(timeout=2, interface=False, ip_address="239.255.255.250"):
25	    """

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/ssdp_discover.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
50	    # Set up the UDP socket.
51	    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
52	    s.setsockopt(socket.IPPROTO_IP, socket.IP_MULTICAST_TTL, 32)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/ssdp_discover.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
58	        )
59	    s.settimeout(timeout)
60	    s.sendto(msg.encode(), (ip_address, 1982))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/yeelight-0.7.16/yeelight-0.7.16/yeelight/tests.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
425	            assert self.bulb.last_properties == {}
426	            thread = threading.Thread(target=_listen)
427	            thread.start()

--------------------------------------------------

Code scanned:
	Total lines of code: 3483
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 19.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 5.0
Files skipped (0):
