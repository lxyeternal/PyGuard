Run started:2025-05-25 13:02:07.802055

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/request.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    body["sentAt"] = datetime.utcnow().replace(tzinfo=tzutc()).isoformat()
21	    url = remove_trailing_slash(host or 'https://api.segment.io') + '/v1/batch'
22	    auth = HTTPBasicAuth(write_key, '')

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/request.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
47	
48	    res = _session.post(url, data=data, auth=auth,
49	                        headers=headers, timeout=timeout)
50	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/client.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
70	            'userId', 'python test event', {'property': 'value'},
71	            {'ip': '192.168.0.1'}, datetime(2014, 9, 3), 'anonymousId',
72	            {'Amplitude': True}, 'messageId')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/client.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
78	        self.assertEqual(msg['integrations'], {'Amplitude': True})
79	        self.assertEqual(msg['context']['ip'], '192.168.0.1')
80	        self.assertEqual(msg['event'], 'python test event')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/client.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
105	        success, msg = client.identify(
106	            'userId', {'trait': 'value'}, {'ip': '192.168.0.1'},
107	            datetime(2014, 9, 3), 'anonymousId', {'Amplitude': True},

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/client.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
113	        self.assertEqual(msg['integrations'], {'Amplitude': True})
114	        self.assertEqual(msg['context']['ip'], '192.168.0.1')
115	        self.assertEqual(msg['traits'], {'trait': 'value'})

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/client.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
139	        success, msg = client.group(
140	            'userId', 'groupId', {'trait': 'value'}, {'ip': '192.168.0.1'},
141	            datetime(2014, 9, 3), 'anonymousId', {'Amplitude': True},

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/client.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
147	        self.assertEqual(msg['integrations'], {'Amplitude': True})
148	        self.assertEqual(msg['context']['ip'], '192.168.0.1')
149	        self.assertEqual(msg['traits'], {'trait': 'value'})

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/client.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
182	            'userId', 'category', 'name', {'property': 'value'},
183	            {'ip': '192.168.0.1'}, datetime(2014, 9, 3), 'anonymousId',
184	            {'Amplitude': True}, 'messageId')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/client.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
189	        self.assertEqual(msg['integrations'], {'Amplitude': True})
190	        self.assertEqual(msg['context']['ip'], '192.168.0.1')
191	        self.assertEqual(msg['properties'], {'property': 'value'})

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/client.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
216	            'userId', 'category', 'name', {'property': 'value'},
217	            {'ip': '192.168.0.1'}, datetime(2014, 9, 3), 'anonymousId',
218	            {'Amplitude': True}, 'messageId')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/client.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
223	        self.assertEqual(msg['integrations'], {'Amplitude': True})
224	        self.assertEqual(msg['context']['ip'], '192.168.0.1')
225	        self.assertEqual(msg['properties'], {'property': 'value'})

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/request.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
11	    def test_valid_request(self):
12	        res = post('testsecret', batch=[{
13	            'userId': 'userId',
14	            'event': 'python event',
15	            'type': 'track'
16	        }])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/request.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	        self.assertRaises(Exception, post, 'testsecret',
21	                          'https://api.segment.io', False, '[{]')
22	
23	    def test_invalid_host(self):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/request.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
39	    def test_should_not_timeout(self):
40	        res = post('testsecret', batch=[{
41	            'userId': 'userId',
42	            'event': 'python event',
43	            'type': 'track'
44	        }], timeout=15)
45	        self.assertEqual(res.status_code, 200)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/request.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
48	        with self.assertRaises(requests.ReadTimeout):
49	            post('testsecret', batch=[{
50	                'userId': 'userId',
51	                'event': 'python event',
52	                'type': 'track'
53	            }], timeout=0.0001)
54	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/request.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
55	    def test_proxies(self):
56	        res = post('testsecret', batch=[{
57	            'userId': 'userId',
58	            'event': 'python event',
59	            'type': 'track',
60	            'proxies': '203.243.63.16:80'
61	        }])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/utils.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	    def test_remove_slash(self):
75	        self.assertEqual('http://segment.io',
76	                         utils.remove_trailing_slash('http://segment.io/'))
77	        self.assertEqual('http://segment.io',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/utils.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	        self.assertEqual('http://segment.io',
76	                         utils.remove_trailing_slash('http://segment.io/'))
77	        self.assertEqual('http://segment.io',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/utils.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	                         utils.remove_trailing_slash('http://segment.io/'))
77	        self.assertEqual('http://segment.io',
78	                         utils.remove_trailing_slash('http://segment.io'))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/analytics/test/utils.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	        self.assertEqual('http://segment.io',
78	                         utils.remove_trailing_slash('http://segment.io'))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/segment/analytics/request.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    body["sentAt"] = datetime.utcnow().replace(tzinfo=tzutc()).isoformat()
21	    url = remove_trailing_slash(host or 'https://api.segment.io') + '/v1/batch'
22	    auth = HTTPBasicAuth(write_key, '')

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/analytics_python-1.4.post1-py2.py3-none-any/segment/analytics/request.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
47	
48	    res = _session.post(url, data=data, auth=auth,
49	                        headers=headers, timeout=timeout)
50	

--------------------------------------------------

Code scanned:
	Total lines of code: 1767
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 6.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 0.0
Files skipped (0):
