Run started:2025-05-25 12:31:12.063404

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/docs/source/conf.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	intersphinx_mapping = {
56	    'python': ('https://docs.python.org/3', None),
57	    'torch': ('https://pytorch.org/docs/main', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/docs/source/conf.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    'python': ('https://docs.python.org/3', None),
57	    'torch': ('https://pytorch.org/docs/main', None),
58	    'torchvision': ('https://pytorch.org/vision/main', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/docs/source/conf.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	    'torch': ('https://pytorch.org/docs/main', None),
58	    'torchvision': ('https://pytorch.org/vision/main', None),
59	    'nibabel': ('https://nipy.org/nibabel', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/docs/source/conf.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	    'torchvision': ('https://pytorch.org/vision/main', None),
59	    'nibabel': ('https://nipy.org/nibabel', None),
60	    'numpy': ('https://numpy.org/doc/stable', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/docs/source/conf.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    'nibabel': ('https://nipy.org/nibabel', None),
60	    'numpy': ('https://numpy.org/doc/stable', None),
61	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/constants.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	# Code repository
27	REPO_URL = 'https://github.com/TorchIO-project/torchio/'
28	
29	# Data repository
30	DATA_REPO = 'https://github.com/TorchIO-project/torchio-data/raw/main/data/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/constants.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	# Data repository
30	DATA_REPO = 'https://github.com/TorchIO-project/torchio-data/raw/main/data/'
31	
32	# Floating point error
33	MIN_FLOAT_32 = torch.finfo(torch.float32).eps

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/data/image.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	            message = (
170	                'The "channels_last" keyword argument is deprecated after'
171	                ' https://github.com/TorchIO-project/torchio/pull/685 and will be'
172	                ' removed in the future'
173	            )
174	            warnings.warn(message, DeprecationWarning, stacklevel=2)
175	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/data/image.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	            message = (
240	                'Using TorchIO images without a torchio.SubjectsLoader in PyTorch >='
241	                ' 2.3 might have unexpected consequences, e.g., the collated batches'
242	                ' will be instances of torchio.Subject with 5D images. Replace'
243	                ' your PyTorch DataLoader with a torchio.SubjectsLoader so that'
244	                ' the collated batch becomes a dictionary, as expected. See'
245	                ' https://github.com/TorchIO-project/torchio/issues/1179 for more'
246	                ' context about this issue.'
247	            )
248	            warnings.warn(message, stacklevel=1)
249	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/data/io.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	            message = (
43	                f'File "{path}" not understood.'
44	                ' Check supported formats by at'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/data/sampler/weighted.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
242	            message = (
243	                'Error retrieving probability in weighted sampler.'
244	                ' Please report this issue at'
245	                ' https://github.com/TorchIO-project/torchio/issues/new?labels=bug&template=bug_report.md'
246	            )
247	            raise RuntimeError(message)
248	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/data/subject.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
321	            message = (
322	                'As described above, some images in the subject are not in the'
323	                ' same space. You probably can use the transforms ToCanonical'
324	                ' and Resample to fix this, as explained at'
325	                ' https://github.com/TorchIO-project/torchio/issues/647#issuecomment-913025695'
326	            )
327	            raise RuntimeError(message) from e
328	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/bite.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	class BITE(SubjectsDataset, abc.ABC):
16	    base_url = 'http://www.bic.mni.mcgill.ca/uploads/Services/'
17	
18	    def __init__(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/episurg.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	
43	    data_url = 'https://s3-eu-west-1.amazonaws.com/pstorage-ucl-2748466690/26153588/EPISURG.zip'
44	    md5 = '5ec5831a2c6fbfdc8489ba2910a6504b'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/itk_snap/itk_snap.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	    url_base = 'https://www.nitrc.org/frs/download.php/'
19	
20	    def __init__(self, name, code):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/ixi.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	
66	    base_url = 'http://biomedic.doc.ic.ac.uk/brain-development/downloads/IXI/IXI-{modality}.tar'
67	    md5_dict = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/ixi.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
177	
178	    url = 'https://www.dropbox.com/s/ogxjwjxdv5mieah/ixi_tiny.zip?dl=1'
179	    md5 = 'bfb60f4074283d78622760230bfa1f98'

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/ixi.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
233	        (ixi_tiny_dir / 'label').rename(root / 'label')
234	        shutil.rmtree(ixi_tiny_dir)
235	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/medmnist.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	    BASE_URL = 'https://zenodo.org/record/5208230/files'
25	    SPLITS = 'train', 'training', 'val', 'validation', 'test', 'testing'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/mni/icbm.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	        self.name = 'mni_icbm152_nlin_sym_09c_nifti'
39	        self.url_base = 'http://www.bic.mni.mcgill.ca/~vfonov/icbm/2009/'
40	        self.filename = f'{self.name}.zip'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/mni/mni.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	
12	    url_base = 'http://packages.bic.mni.mcgill.ca/mni-models/'
13	
14	    @property
15	    def download_root(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/mni/pediatric.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	    def __init__(self, years, symmetric=False):
46	        self.url_dir = 'http://www.bic.mni.mcgill.ca/~vfonov/nihpd/obj1/'
47	        sym_string = 'sym' if symmetric else 'asym'

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/mni/sheep.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
23	            )
24	            shutil.rmtree(self.download_root / 'masks')
25	            for path in self.download_root.iterdir():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/datasets/slicer.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	
8	SLICER_URL = 'https://github.com/Slicer/SlicerTestingData/releases/download/'
9	URLS_DICT = {

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/download.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
21	    md5 = hashlib.md5()
22	    with open(fpath, 'rb') as f:
23	        for chunk in iter(lambda: f.read(chunk_size), b''):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/download.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	    with open(fpath, 'rb') as f:
23	        for chunk in iter(lambda: f.read(chunk_size), b''):
24	            md5.update(chunk)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/download.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
99	    if _is_tar(from_path):
100	        with tarfile.open(from_path, 'r') as tar:
101	            tar.extractall(path=to_path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/download.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
102	    elif _is_targz(from_path) or _is_tgz(from_path):
103	        with tarfile.open(from_path, 'r:gz') as tar:
104	            tar.extractall(path=to_path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/download.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
105	    elif _is_tarxz(from_path):
106	        with tarfile.open(from_path, 'r:xz') as tar:
107	            tar.extractall(path=to_path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/download.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
110	        to_path = os.path.join(to_path, stem)
111	        with open(to_path, 'wb') as out_f, gzip.GzipFile(from_path) as zip_f:
112	            out_f.write(zip_f.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/download.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	        with open(to_path, 'wb') as out_f, gzip.GzipFile(from_path) as zip_f:
112	            out_f.write(zip_f.read())
113	    elif _is_zip(from_path):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/download.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
111	        with open(to_path, 'wb') as out_f, gzip.GzipFile(from_path) as zip_f:
112	            out_f.write(zip_f.read())
113	    elif _is_zip(from_path):

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/download.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
148	            print('Downloading ' + url + ' to ' + fpath)  # noqa: T201
149	            urllib.request.urlretrieve(
150	                url,
151	                fpath,
152	                reporthook=gen_bar_updater(),
153	            )

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/download.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
163	                print(message)  # noqa: T201
164	                urllib.request.urlretrieve(
165	                    url,
166	                    fpath,
167	                    reporthook=gen_bar_updater(),
168	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/reference.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	
8	BIBTEX = r"""@article{perez-garcia_torchio_2021,
9	    title = {{TorchIO}: a {Python} library for efficient loading, preprocessing, augmentation and patch-based sampling of medical images in deep learning},
10	    journal = {Computer Methods and Programs in Biomedicine},
11	    pages = {106236},
12	    year = {2021},
13	    issn = {0169-2607},
14	    doi = {https://doi.org/10.1016/j.cmpb.2021.106236},
15	    url = {https://www.sciencedirect.com/science/article/pii/S0169260721003102},
16	    author = {P{\'e}rez-Garc{\'i}a, Fernando and Sparks, Rachel and Ourselin, S{\'e}bastien},
17	    keywords = {Medical image computing, Deep learning, Data augmentation, Preprocessing},
18	} """
19	
20	TITLE = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/transforms/data_parser.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	                message = (
74	                    'If the input is a dictionary, a value for "include" must'
75	                    ' be specified when instantiating the transform. See the'
76	                    ' docs for Transform:'
77	                    ' https://torchio.readthedocs.io/transforms/transforms.html#torchio.transforms.Transform'
78	                )
79	                raise RuntimeError(message)
80	            subject = self._get_subject_from_dict(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/utils.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
99	    if force:
100	        shutil.rmtree(images_dir)
101	        shutil.rmtree(labels_dir)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/src/torchio/utils.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
100	        shutil.rmtree(images_dir)
101	        shutil.rmtree(labels_dir)
102	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/torchio-0.20.6/torchio-0.20.6/tests/utils.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
155	        """Tear down test fixtures, if any."""
156	        shutil.rmtree(self.dir)
157	

--------------------------------------------------

Code scanned:
	Total lines of code: 15271
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 39.0
		High: 0.0
Files skipped (0):
