Run started:2025-05-25 13:12:45.996821

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/_logging_utils.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
156	                 metrics_package_version=TelemetryConstants.DEFAULT_VERSION,
157	                 os_info=platform.system(),
158	                 task_type="") -> None:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/_logging_utils.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
156	                 metrics_package_version=TelemetryConstants.DEFAULT_VERSION,
157	                 os_info=platform.system(),
158	                 task_type="") -> None:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/_logging_utils.py:157
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
156	                 metrics_package_version=TelemetryConstants.DEFAULT_VERSION,
157	                 os_info=platform.system(),
158	                 task_type="") -> None:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/_scoring.py:714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
713	    results = {}
714	    with ThreadPoolExecutor(max_workers=int(os.environ.get("MAX_THREADS_PER_METRIC", 10))) as thread_pool:
715	        executors = [thread_pool.submit(_calculate_rag_metric, metric, y_test, processed_y_pred, openai_params,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/exceptions.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
260	    def __init__(self, exception_message, target=None, reference_code=None, safe_message=None, **kwargs):
261	        DEFAULT_CONTENT_FILTER_MESSAGE = "Content Filter: The response was filtered due to the prompt " \
262	                                         "triggering Azure OpenAIâ€™s content management policy. Please " \
263	                                         "modify your prompt and retry. To learn more about our content filtering " \
264	                                         "policies please read our documentation: " \
265	                                         "https://go.microsoft.com/fwlink/?linkid=2198766"
266	        if safe_message is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/_llm.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
174	        )
175	        resp = requests.post(
176	            self.api_url, headers=oai_headers, json=oai_body, stream=True
177	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/_llm.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
187	            async with aiohttp.ClientSession() as session:
188	                async with session.post(
189	                    self.api_url, headers=oai_headers, json=oai_body, raise_for_status=True
190	                ) as response:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/_llm.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
275	        )
276	        resp_data = sync_post(
277	            url=self.api_url, headers=oai_headers, body=oai_body)
278	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/_llm_url_connector.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
128	        try:
129	            response = urllib.request.urlopen(req)
130	            result_obj = response.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/_llm_url_connector.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	            response = urllib.request.urlopen(req)
130	            result_obj = response.read()
131	            result = json.loads(result_obj)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/_llm_url_connector.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
129	            response = urllib.request.urlopen(req)
130	            result_obj = response.read()
131	            result = json.loads(result_obj)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/_llm_url_connector.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
142	            logger.warning(error.info())
143	            logger.warning(error.read().decode("utf8", 'ignore'))
144	            safe_message = "Not able to obtain http response from provided LLM api details."

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/_llm_url_connector.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
142	            logger.warning(error.info())
143	            logger.warning(error.read().decode("utf8", 'ignore'))
144	            safe_message = "Not able to obtain http response from provided LLM api details."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/auth_manager.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	    """
44	    AZURE_ENDPOINT = "https://ml.azure.com"
45	    AZURE_OPENAI_API = "https://cognitiveservices.azure.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/auth_manager.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    AZURE_ENDPOINT = "https://ml.azure.com"
45	    AZURE_OPENAI_API = "https://cognitiveservices.azure.com"
46	    MIR_ENDPOINT = "https://ml.azure.com/.default"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/auth_manager.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	    AZURE_OPENAI_API = "https://cognitiveservices.azure.com"
46	    MIR_ENDPOINT = "https://ml.azure.com/.default"
47	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/http_connection_utils.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
22	    async with aiohttp.ClientSession() as session:
23	        async with session.post(
24	                url,
25	                headers=headers,
26	                json=body,
27	                raise_for_status=False,
28	                timeout=aiohttp.ClientTimeout(total=timeout_sec),
29	        ) as response:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/http_connection_utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
45	def sync_post(url: str, headers: Dict[str, Any], body: Dict[str, Any]):
46	    resp = requests.post(url, headers=headers, json=body)
47	    resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/llm_utils.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	                if hasattr(e, "headers"):
160	                    retry_after_in_header = e.headers.get("Retry-After", None)
161	                if hasattr(e, "response") and hasattr(e.response, "headers"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/llm_utils.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	                if hasattr(e, "response") and hasattr(e.response, "headers"):
162	                    retry_after_in_header_response = e.response.headers.get("Retry-After", None)
163	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/llm_utils.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
186	                if e.response.status_code == 429:
187	                    retry_after = float(e.response.headers.get("Retry-After", sleep_time))
188	                    sleep_time = retry_after + sleep_time * (0.5 + random())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/llm_utils.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	                if hasattr(e, "headers"):
249	                    retry_after_in_header = e.headers.get("Retry-After", None)
250	                if hasattr(e, "response") and hasattr(e.response, "headers"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/llm_utils.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
250	                if hasattr(e, "response") and hasattr(e.response, "headers"):
251	                    retry_after_in_header_response = e.response.headers.get("Retry-After", None)
252	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/common/llm_connector/llm_utils.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	                if e.response.status_code == 429:
276	                    retry_after = float(e.response.headers.get("Retry-After", sleep_time))
277	                    sleep_time = retry_after + sleep_time * (0.5 + random())

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/text/qa/_similarity_utils.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
107	    try:
108	        response = urllib.request.urlopen(req)
109	        result_obj = response.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/text/qa/_similarity_utils.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
108	        response = urllib.request.urlopen(req)
109	        result_obj = response.read()
110	        result = json.loads(result_obj)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/text/qa/_similarity_utils.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
108	        response = urllib.request.urlopen(req)
109	        result_obj = response.read()
110	        result = json.loads(result_obj)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/text/qa/_similarity_utils.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
121	        logger.warning(error.info())
122	        logger.warning(error.read().decode("utf8", 'ignore'))
123	        safe_message = "Not able to obtain http response from provided LLM api details."

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/text/qa/_similarity_utils.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
121	        logger.warning(error.info())
122	        logger.warning(error.read().decode("utf8", 'ignore'))
123	        safe_message = "Not able to obtain http response from provided LLM api details."

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/text/rag_evaluation/_rag_evaluation.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
422	
423	            with ThreadPoolExecutor(max_workers=int(os.environ.get(
424	                    "MAX_THREADS_PER_METRIC", RagEvaluationMetric.max_threads_per_metric))) as thread_pool:
425	                # iterating over multiple conversations

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/text/rag_evaluation/_rag_evaluation.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
562	        with tqdm(total=num_conversations, desc="Computing gpt retrieval score") as pbar:
563	            with ThreadPoolExecutor(max_workers=int(os.environ.get(
564	                    "MAX_THREADS_PER_METRIC", RagEvaluationMetric.max_threads_per_metric))) as thread_pool:
565	                # iterating over multiple conversations

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/azureml_metrics-47.0.0-py3-none-any/azureml/metrics/text/rag_evaluation/_rag_evaluation.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
701	        with tqdm(total=num_conversations, desc="Computing gpt groundedness score") as pbar:
702	            with ThreadPoolExecutor(max_workers=int(os.environ.get(
703	                    "MAX_THREADS_PER_METRIC", RagEvaluationMetric.max_threads_per_metric))) as thread_pool:
704	                # iterating over multiple conversations

--------------------------------------------------

Code scanned:
	Total lines of code: 15507
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 27.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 1.0
Files skipped (0):
