Run started:2025-05-25 12:58:20.597629

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/apache_airflow_providers_elasticsearch-6.2.1/apache_airflow_providers_elasticsearch-6.2.1/src/airflow/providers/elasticsearch/get_provider_info.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        "name": "Elasticsearch",
28	        "description": "`Elasticsearch <https://www.elastic.co/elasticsearch>`__\n",
29	        "state": "ready",
30	        "source-date-epoch": 1741508781,
31	        "versions": [
32	            "6.2.1",
33	            "6.2.0",
34	            "6.0.0",
35	            "5.5.3",
36	            "5.5.2",
37	            "5.5.1",
38	            "5.5.0",
39	            "5.4.2",
40	            "5.4.1",
41	            "5.4.0",
42	            "5.3.4",
43	            "5.3.3",
44	            "5.3.2",
45	            "5.3.1",
46	            "5.3.0",
47	            "5.2.0",
48	            "5.1.1",
49	            "5.1.0",
50	            "5.0.2",
51	            "5.0.1",
52	            "5.0.0",
53	            "4.5.1",
54	            "4.5.0",
55	            "4.4.0",
56	            "4.3.3",
57	            "4.3.2",
58	            "4.3.1",
59	            "4.3.0",
60	            "4.2.1",
61	            "4.2.0",
62	            "4.1.0",
63	            "4.0.0",
64	            "3.0.3",
65	            "3.0.2",
66	            "3.0.1",
67	            "3.0.0",
68	            "2.2.0",
69	            "2.1.0",
70	            "2.0.3",
71	            "2.0.2",
72	            "2.0.1",
73	            "1.0.4",
74	            "1.0.3",
75	            "1.0.2",
76	            "1.0.1",
77	            "1.0.0",
78	        ],
79	        "integrations": [
80	            {
81	                "integration-name": "Elasticsearch",
82	                "external-doc-url": "https://www.elastic.co/elasticsearch",
83	                "logo": "/docs/integration-logos/Elasticsearch.png",
84	                "tags": ["software"],
85	            }
86	        ],
87	        "hooks": [
88	            {
89	                "integration-name": "Elasticsearch",
90	                "python-modules": ["airflow.providers.elasticsearch.hooks.elasticsearch"],
91	            }
92	        ],
93	        "connection-types": [
94	            {
95	                "hook-class-name": "airflow.providers.elasticsearch.hooks.elasticsearch.ElasticsearchSQLHook",
96	                "connection-type": "elasticsearch",
97	            }
98	        ],
99	        "logging": ["airflow.providers.elasticsearch.log.es_task_handler.ElasticsearchTaskHandler"],
100	        "config": {
101	            "elasticsearch": {
102	                "description": None,
103	                "options": {
104	                    "host": {
105	                        "description": "Elasticsearch host\n",
106	                        "version_added": "1.10.4",
107	                        "type": "string",
108	                        "example": None,
109	                        "default": "",
110	                    },
111	                    "log_id_template": {
112	                        "description": "Format of the log_id, which is used to query for a given tasks logs\n",
113	                        "version_added": "1.10.4",
114	                        "type": "string",
115	                        "example": None,
116	                        "is_template": True,
117	                        "default": "{dag_id}-{task_id}-{run_id}-{map_index}-{try_number}",
118	                    },
119	                    "end_of_log_mark": {
120	                        "description": "Used to mark the end of a log stream for a task\n",
121	                        "version_added": "1.10.4",
122	                        "type": "string",
123	                        "example": None,
124	                        "default": "end_of_log",
125	                    },
126	                    "frontend": {
127	                        "description": "Qualified URL for an elasticsearch frontend (like Kibana) with a template argument for log_id\nCode will construct log_id using the log_id template from the argument above.\nNOTE: scheme will default to https if one is not provided\n",
128	                        "version_added": "1.10.4",
129	                        "type": "string",
130	                        "example": "http://localhost:5601/app/kibana#/discover?_a=(columns:!(message),query:(language:kuery,query:'log_id: \"{log_id}\"'),sort:!(log.offset,asc))",
131	                        "default": "",
132	                    },
133	                    "write_stdout": {
134	                        "description": "Write the task logs to the stdout of the worker, rather than the default files\n",
135	                        "version_added": "1.10.4",
136	                        "type": "string",
137	                        "example": None,
138	                        "default": "False",
139	                    },
140	                    "write_to_es": {
141	                        "description": "Write the task logs to the ElasticSearch\n",
142	                        "version_added": "5.5.4",
143	                        "type": "string",
144	                        "example": None,
145	                        "default": "False",
146	                    },
147	                    "target_index": {
148	                        "description": "Name of the index to write to, when enabling writing the task logs to the ElasticSearch\n",
149	                        "version_added": "5.5.4",
150	                        "type": "string",
151	                        "example": None,
152	                        "default": "airflow-logs",
153	                    },
154	                    "json_format": {
155	                        "description": "Instead of the default log formatter, write the log lines as JSON\n",
156	                        "version_added": "1.10.4",
157	                        "type": "string",
158	                        "example": None,
159	                        "default": "False",
160	                    },
161	                    "json_fields": {
162	                        "description": "Log fields to also attach to the json output, if enabled\n",
163	                        "version_added": "1.10.4",
164	                        "type": "string",
165	                        "example": None,
166	                        "default": "asctime, filename, lineno, levelname, message",
167	                    },
168	                    "host_field": {
169	                        "description": "The field where host name is stored (normally either `host` or `host.name`)\n",
170	                        "version_added": "2.1.1",
171	                        "type": "string",
172	                        "example": None,
173	                        "default": "host",
174	                    },
175	                    "offset_field": {
176	                        "description": "The field where offset is stored (normally either `offset` or `log.offset`)\n",
177	                        "version_added": "2.1.1",
178	                        "type": "string",
179	                        "example": None,
180	                        "default": "offset",
181	                    },
182	                    "index_patterns": {
183	                        "description": "Comma separated list of index patterns to use when searching for logs (default: `_all`).\nThe index_patterns_callable takes precedence over this.\n",
184	                        "version_added": "2.6.0",
185	                        "type": "string",
186	                        "example": "something-*",
187	                        "default": "_all",
188	                    },
189	                    "index_patterns_callable": {
190	                        "description": "A string representing the full path to the Python callable path which accept TI object and\nreturn comma separated list of index patterns. This will takes precedence over index_patterns.\n",
191	                        "version_added": "5.5.0",
192	                        "type": "string",
193	                        "example": "module.callable",
194	                        "default": "",
195	                    },
196	                },
197	            },
198	            "elasticsearch_configs": {
199	                "description": None,
200	                "options": {
201	                    "http_compress": {
202	                        "description": None,
203	                        "version_added": "1.10.5",
204	                        "type": "string",
205	                        "example": None,
206	                        "default": "False",
207	                    },
208	                    "verify_certs": {
209	                        "description": None,
210	                        "version_added": "1.10.5",
211	                        "type": "string",
212	                        "example": None,
213	                        "default": "True",
214	                    },
215	                },
216	            },
217	        },
218	        "dependencies": [
219	            "apache-airflow>=2.9.0",
220	            "apache-airflow-providers-common-sql>=1.20.0",
221	            "elasticsearch>=8.10,<9",
222	        ],
223	        "devel-dependencies": [],
224	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/apache_airflow_providers_elasticsearch-6.2.1/apache_airflow_providers_elasticsearch-6.2.1/src/airflow/providers/elasticsearch/get_provider_info.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	                "integration-name": "Elasticsearch",
82	                "external-doc-url": "https://www.elastic.co/elasticsearch",
83	                "logo": "/docs/integration-logos/Elasticsearch.png",
84	                "tags": ["software"],
85	            }
86	        ],
87	        "hooks": [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/apache_airflow_providers_elasticsearch-6.2.1/apache_airflow_providers_elasticsearch-6.2.1/src/airflow/providers/elasticsearch/get_provider_info.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	                        "type": "string",
130	                        "example": "http://localhost:5601/app/kibana#/discover?_a=(columns:!(message),query:(language:kuery,query:'log_id: \"{log_id}\"'),sort:!(log.offset,asc))",
131	                        "default": "",
132	                    },
133	                    "write_stdout": {
134	                        "description": "Write the task logs to the stdout of the worker, rather than the default files\n",
135	                        "version_added": "1.10.4",
136	                        "type": "string",
137	                        "example": None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/apache_airflow_providers_elasticsearch-6.2.1/apache_airflow_providers_elasticsearch-6.2.1/src/airflow/providers/elasticsearch/log/es_task_handler.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	        offset_field: str = "offset",
161	        host: str = "http://localhost:9200",
162	        frontend: str = "localhost:5601",
163	        index_patterns: str = conf.get("elasticsearch", "index_patterns"),
164	        index_patterns_callable: str = conf.get("elasticsearch", "index_patterns_callable", fallback=""),
165	        es_kwargs: dict | None | Literal["default_es_kwargs"] = "default_es_kwargs",
166	        **kwargs,
167	    ):
168	        es_kwargs = es_kwargs or {}
169	        if es_kwargs == "default_es_kwargs":
170	            es_kwargs = get_es_kwargs_from_config()
171	        host = self.format_url(host)
172	        super().__init__(base_log_folder)
173	        self.closed = False
174	
175	        self.client = elasticsearch.Elasticsearch(host, **es_kwargs)
176	        # in airflow.cfg, host of elasticsearch has to be http://dockerhostXxxx:9200
177	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/apache_airflow_providers_elasticsearch-6.2.1/apache_airflow_providers_elasticsearch-6.2.1/src/airflow/providers/elasticsearch/log/es_task_handler.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
323	        log_id = self._render_log_id(ti, try_number)
324	        response = self._es_read(log_id, offset, ti)
325	        if response is not None and response.hits:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/apache_airflow_providers_elasticsearch-6.2.1/apache_airflow_providers_elasticsearch-6.2.1/src/airflow/providers/elasticsearch/log/es_task_handler.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
541	                if success and self.delete_local_copy:
542	                    shutil.rmtree(os.path.dirname(local_loc))
543	

--------------------------------------------------

Code scanned:
	Total lines of code: 1064
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 2.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 0.0
Files skipped (0):
