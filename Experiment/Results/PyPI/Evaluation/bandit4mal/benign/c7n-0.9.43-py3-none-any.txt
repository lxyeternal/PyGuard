Run started:2025-05-25 13:38:43.782585

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/actions/notify.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
92	
93	        serialized_payload = base64.b64encode(
94	            zlib.compress(
95	                payload.encode('utf8')
96	            )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/actions/notify.py:93
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
92	
93	        serialized_payload = base64.b64encode(
94	            zlib.compress(
95	                payload.encode('utf8')
96	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/actions/notify.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
141	        compressed = zlib.compress(dumped.encode('utf8'))
142	        b64encoded = base64.b64encode(compressed)
143	        return b64encoded.decode('ascii')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/actions/notify.py:142
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
141	        compressed = zlib.compress(dumped.encode('utf8'))
142	        b64encoded = base64.b64encode(compressed)
143	        return b64encoded.decode('ascii')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/actions/notify.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
391	        queue = self.data['transport']['queue'].format(**message)
392	        if queue.startswith('https://queue.amazonaws.com'):
393	            region = 'us-east-1'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/actions/notify.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
397	            queue_url = queue
398	        elif queue.startswith('https://sqs.'):
399	            region = queue.split('.', 2)[1]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/actions/notify.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
405	            queue_name = queue_arn_split[5]
406	            queue_url = "https://sqs.%s.amazonaws.com/%s/%s" % (
407	                region, owner_id, queue_name)
408	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/actions/notify.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
411	            queue_name = queue
412	            queue_url = "https://sqs.%s.amazonaws.com/%s/%s" % (
413	                region, owner_id, queue_name)
414	        client = self.manager.session_factory(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/cache.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
121	            with open(self.cache_path, 'rb') as fh:
122	                header = fh.read(15)
123	                if header != b'SQLite format 3':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/cli.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
234	
235	    metrics_help = ("Emit metrics to provider metrics. Specify 'aws', 'gcp', or 'azure'. "
236	            "For more details on aws metrics options, see: "
237	            "https://cloudcustodian.io/docs/aws/usage.html#metrics")
238	
239	    run.add_argument(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/credentials.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
179	    if region and USE_STS_REGIONAL:
180	        endpoint_url = "https://sts.{}.amazonaws.com".format(region)
181	        region_name = region

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/mu.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
192	        with open(src, 'rb') as fp:
193	            contents = fp.read()
194	        self.add_contents(dest, contents)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/mu.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
249	        assert self._closed, "Archive not closed"
250	        return self.get_stream().read()
251	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/mu.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
281	def checksum(fh, hasher, blocksize=65536):
282	    buf = fh.read(blocksize)
283	    while len(buf) > 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/mu.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
284	        hasher.update(buf)
285	        buf = fh.read(blocksize)
286	    return hasher.digest()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/mu.py:1847
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1846	            else:
1847	                raise Exception("You may have attempted to deploy a config "
1848	                                "based lambda function with an unsupported config type. "

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/output.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
462	        with open(os.path.join(self.root_dir, rel_path), 'w') as fh:
463	            fh.write(value)
464	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/output.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
462	        with open(os.path.join(self.root_dir, rel_path), 'w') as fh:
463	            fh.write(value)
464	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/output.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
524	        self.upload()
525	        shutil.rmtree(self.root_dir)
526	        self.log.debug("%s: policy logs uploaded", self.type)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/reports/csvout.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
277	
278	    with ThreadPoolExecutor(max_workers=20) as w:
279	        for key_set in p:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/reports/csvout.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
306	    result = s3.get_object(Bucket=bucket, Key=key['Key'])
307	    blob = io.BytesIO(result['Body'].read())
308	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resolver.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
45	        if response.info().get('Content-Encoding') != 'gzip':
46	            return response.read().decode('utf-8')
47	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resolver.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
47	
48	        data = zlib.decompress(response.read(),
49	                               ZIP_OR_GZIP_HEADER_DETECT).decode('utf8')
50	        return data

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resolver.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
47	
48	        data = zlib.decompress(response.read(),
49	                               ZIP_OR_GZIP_HEADER_DETECT).decode('utf8')
50	        return data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resolver.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	
48	        data = zlib.decompress(response.read(),
49	                               ZIP_OR_GZIP_HEADER_DETECT).decode('utf8')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resolver.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	        result = client.get_object(**params)
63	        body = result['Body'].read()
64	        if params['Key'].lower().endswith(('.gz', '.zip', '.gzip')):

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resolver.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
64	        if params['Key'].lower().endswith(('.gz', '.zip', '.gzip')):
65	            return zlib.decompress(body, ZIP_OR_GZIP_HEADER_DETECT).decode('utf-8')
66	        elif isinstance(body, str):

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resolver.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
64	        if params['Key'].lower().endswith(('.gz', '.zip', '.gzip')):
65	            return zlib.decompress(body, ZIP_OR_GZIP_HEADER_DETECT).decode('utf-8')
66	        elif isinstance(body, str):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/aws.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
554	        if self._is_subsegment(subsegment):
555	            subsegment.close(end_time)
556	            self._local.entities.remove(subsegment)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/aws.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
644	            log.info(
645	                ('View XRay Trace https://console.aws.amazon.com/xray/home?region=%s#/'
646	                 'traces/%s' % (self.ctx.options.region, self.segment.trace_id)))
647	        self.metadata.clear()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/ec2.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
737	def deserialize_user_data(user_data):
738	    data = base64.b64decode(user_data)
739	    # try raw and compressed

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/ec2.py:738
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
737	def deserialize_user_data(user_data):
738	    data = base64.b64decode(user_data)
739	    # try raw and compressed

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/ec2.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
742	    except UnicodeDecodeError:
743	        return zlib.decompress(data, 16).decode('utf8')
744	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/ec2.py:743
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
742	    except UnicodeDecodeError:
743	        return zlib.decompress(data, 16).decode('utf8')
744	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	                continue
118	            if cfg.get(k) == null_value:
119	                continue

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	    GRANTEE_MAP = {
142	        'AllUsers': "http://acs.amazonaws.com/groups/global/AllUsers",
143	        'AuthenticatedUsers': "http://acs.amazonaws.com/groups/global/AuthenticatedUsers",
144	        'LogDelivery': 'http://acs.amazonaws.com/groups/s3/LogDelivery'}
145	
146	    def handle_AccessControlList(self, resource, item_value):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
142	        'AllUsers': "http://acs.amazonaws.com/groups/global/AllUsers",
143	        'AuthenticatedUsers': "http://acs.amazonaws.com/groups/global/AuthenticatedUsers",
144	        'LogDelivery': 'http://acs.amazonaws.com/groups/s3/LogDelivery'}
145	
146	    def handle_AccessControlList(self, resource, item_value):
147	        # double serialized in config for some reason

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	        'AuthenticatedUsers': "http://acs.amazonaws.com/groups/global/AuthenticatedUsers",
144	        'LogDelivery': 'http://acs.amazonaws.com/groups/s3/LogDelivery'}
145	
146	    def handle_AccessControlList(self, resource, item_value):
147	        # double serialized in config for some reason
148	        if isinstance(item_value, str):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	
158	        for g in (item_value.get('grantList') or ()):
159	            if 'id' not in g['grantee']:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
187	        rules = []
188	        for r in item_value.get('rules'):
189	            rr = {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	            transitions = []
202	            for t in (r.get('transitions') or ()):
203	                tr = {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	                for k in ('date', 'days', 'storageClass'):
205	                    if t.get(k):
206	                        tr["%s%s" % (k[0].upper(), k[1:])] = t[k]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
210	
211	            if r.get('abortIncompleteMultipartUpload'):
212	                rr['AbortIncompleteMultipartUpload'] = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	                        'abortIncompleteMultipartUpload']['daysAfterInitiation']}
215	            if r.get('noncurrentVersionExpirationInDays'):
216	                rr['NoncurrentVersionExpiration'] = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
219	            nonc_transitions = []
220	            for t in (r.get('noncurrentVersionTransitions') or ()):
221	                nonc_transitions.append({

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
228	            rr['ID'] = r['id']
229	            if r.get('prefix'):
230	                rr['Prefix'] = r['prefix']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	            if n['filter']:
277	                for r in n['filter'].get('s3KeyFilter', {}).get('filterRules', []):
278	                    rules.append({'Name': r['name'], 'Value': r['value']})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	            if n['filter']:
277	                for r in n['filter'].get('s3KeyFilter', {}).get('filterRules', []):
278	                    rules.append({'Name': r['name'], 'Value': r['value']})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
287	                'ID': rid,
288	                'Status': r.get('status', ''),
289	                'Prefix': r.get('prefix', ''),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
288	                'Status': r.get('status', ''),
289	                'Prefix': r.get('prefix', ''),
290	                'Destination': {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	                rule['Destination']['Account'] = r['destinationConfig']['Account']
295	            if r['destinationConfig'].get('storageClass'):
296	                rule['Destination']['StorageClass'] = r['destinationConfig']['storageClass']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
300	    def handle_BucketPolicy(self, resource, item_value):
301	        resource['Policy'] = item_value.get('policyText')
302	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
316	        # boolean case.
317	        mfa_delete = item_value.get('isMfaDeleteEnabled')
318	        if mfa_delete is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
455	            log.warning("Bucket ssl error %s: %s %s",
456	                        b['Name'], b.get('Location', 'unknown'),
457	                        e)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
488	        if k == 'Location' and v is not None:
489	            b_location = v.get('LocationConstraint')
490	            # Location == region for all cases but EU

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
526	
527	        if 'get_bucket_tagging' in bucket.get('c7n:DeniedMethods', []):
528	            # avoid the additional API call if we already know that it's going

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
537	        try:
538	            bucket['Tags'] = client.get_bucket_tagging(
539	                Bucket=bucket['Name']).get('TagSet', [])
540	        except ClientError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
545	        new_tags = {t['Key']: t['Value'] for t in add_tags}
546	        for t in bucket.get('Tags', ()):
547	            if (t['Key'] not in new_tags and t['Key'] not in remove_tags):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
573	    remap = {None: 'us-east-1', 'EU': 'eu-west-1'}
574	    region = b.get('Location', {}).get('LocationConstraint')
575	    return remap.get(region, region)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
573	    remap = {None: 'us-east-1', 'EU': 'eu-west-1'}
574	    region = b.get('Location', {}).get('LocationConstraint')
575	    return remap.get(region, region)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
574	    region = b.get('Location', {}).get('LocationConstraint')
575	    return remap.get(region, region)
576	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
726	
727	    GLOBAL_ALL = "http://acs.amazonaws.com/groups/global/AllUsers"
728	    AUTH_ALL = "http://acs.amazonaws.com/groups/global/AuthenticatedUsers"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:728
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
727	    GLOBAL_ALL = "http://acs.amazonaws.com/groups/global/AllUsers"
728	    AUTH_ALL = "http://acs.amazonaws.com/groups/global/AuthenticatedUsers"
729	
730	    def process(self, buckets, event=None):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
736	    def process_bucket(self, b):
737	        acl = b.get('Acl', {'Grants': []})
738	        if not acl or not acl['Grants']:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
741	        results = []
742	        allow_website = self.data.get('allow_website', True)
743	        perms = self.data.get('permissions', [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
742	        allow_website = self.data.get('allow_website', True)
743	        perms = self.data.get('permissions', [])
744	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
745	        for grant in acl['Grants']:
746	            if 'URI' not in grant.get("Grantee", {}):
747	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
787	                        'error modifying bucket: policy:%s action:%s bucket:%s error:%s',
788	                        self.manager.data.get('name'), self.name, b['Name'], f.exception()
789	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
814	    def format_resource(self, r):
815	        owner = r.get("Acl", {}).get("Owner", {})
816	        resource = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
814	    def format_resource(self, r):
815	        owner = r.get("Acl", {}).get("Owner", {})
816	        resource = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
819	            "Region": get_region(r),
820	            "Tags": {t["Key"]: t["Value"] for t in r.get("Tags", [])},
821	            "Details": {self.resource_type: {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:822
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
821	            "Details": {self.resource_type: {
822	                "OwnerId": owner.get('ID', 'Unknown')}}
823	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
932	    def process_bucket(self, b):
933	        p = b.get('Policy')
934	        if p is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:939
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
938	
939	        statements = p.get('Statement', [])
940	        check = False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:979
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
978	    def __call__(self, b):
979	        p = b.get('Policy')
980	        if p is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:985
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
984	
985	        required = list(self.data.get('statement_ids', []))
986	        statements = p.get('Statement', [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
985	        required = list(self.data.get('statement_ids', []))
986	        statements = p.get('Statement', [])
987	        for s in list(statements):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:988
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
987	        for s in list(statements):
988	            if s.get('Sid') in required:
989	                required.remove(s['Sid'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1039	        found = False
1040	        for config in bucket.get('Notification', {}).get(field, []):
1041	            if self.match(config):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1039	        found = False
1040	        for config in bucket.get('Notification', {}).get(field, []):
1041	            if self.match(config):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1101	    def match_bucket(self, b):
1102	        op = self.data.get('op')
1103	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1103	
1104	        logging = b.get('Logging', {})
1105	        if op == 'disabled':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1118	            'source_bucket_region': get_region(b),
1119	            'target_bucket_name': self.data.get('target_bucket'),
1120	            'target_prefix': self.data.get('target_prefix'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1119	            'target_bucket_name': self.data.get('target_bucket'),
1120	            'target_prefix': self.data.get('target_prefix'),
1121	        })

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1122	        data = format_string_values(self.data, **variables)
1123	        target_bucket = data.get('target_bucket')
1124	        target_prefix = data.get('target_prefix', b['Name'] + '/')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1123	        target_bucket = data.get('target_bucket')
1124	        target_prefix = data.get('target_prefix', b['Name'] + '/')
1125	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1154	
1155	        statement_ids = self.data.get('statement_ids')
1156	        if statement_ids == 'matched':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1156	        if statement_ids == 'matched':
1157	            statement_ids = bucket.get(BucketNotificationFilter.annotation_key, ())
1158	        if not statement_ids:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1163	        for t in BucketNotificationFilter.FIELDS.values():
1164	            for c in n.get(t, []):
1165	                if c['Id'] not in statement_ids:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1246	    def process_bucket(self, bucket):
1247	        policy = bucket.get('Policy') or '{}'
1248	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1249	        target_statements = format_string_values(
1250	            copy.deepcopy({s['Sid']: s for s in self.data.get('statements', [])}),
1251	            **self.get_std_format_args(bucket))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1256	        for s in bucket_statements:
1257	            if s.get('Sid') not in target_statements:
1258	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1310	    def process_bucket(self, bucket):
1311	        p = bucket.get('Policy')
1312	        if p is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1377	        s3 = bucket_client(local_session(self.manager.session_factory), bucket)
1378	        state = self.data.get('state')
1379	        if state is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1437	        s3 = bucket_client(local_session(self.manager.session_factory), bucket)
1438	        config = dict(bucket.get(self.annotation_key, {key: False for key in self.keys}))
1439	        if self.annotation_key not in bucket:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1463	        if key_set:
1464	            return all([self.data.get(key) is config[key] for key in key_set])
1465	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1532	        s3 = bucket_client(local_session(self.manager.session_factory), bucket)
1533	        config = dict(bucket.get(self.annotation_key, {key: False for key in self.keys}))
1534	        if self.annotation_key not in bucket:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1544	            for key in key_set:
1545	                config[key] = self.data.get(key)
1546	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1547	            for key in self.keys:
1548	                config[key] = self.data.get('state', True)
1549	        s3.put_public_access_block(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1601	    def process(self, resources):
1602	        enabled = self.data.get('enabled', True)
1603	        for r in resources:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1656	    def validate(self):
1657	        if self.data.get('enabled', True):
1658	            if not self.data.get('target_bucket'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1657	        if self.data.get('enabled', True):
1658	            if not self.data.get('target_bucket'):
1659	                raise PolicyValidationError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1666	        kwargs = {
1667	            "enabled": self.data.get('enabled', True),
1668	            "session": session,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1675	        client = bucket_client(session, r)
1676	        is_logging = bool(r.get('Logging'))
1677	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1683	                'source_bucket_region': get_region(r),
1684	                'target_bucket_name': self.data.get('target_bucket'),
1685	                'target_prefix': self.data.get('target_prefix'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1684	                'target_bucket_name': self.data.get('target_bucket'),
1685	                'target_prefix': self.data.get('target_prefix'),
1686	            })

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1688	            config = {
1689	                'TargetBucket': data.get('target_bucket'),
1690	                'TargetPrefix': data.get('target_prefix', r['Name'] + '/')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1689	                'TargetBucket': data.get('target_bucket'),
1690	                'TargetPrefix': data.get('target_prefix', r['Name'] + '/')
1691	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1691	            }
1692	            if not is_logging or r.get('Logging') != config:
1693	                client.put_bucket_logging(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1746	        if (not getattr(self.manager.config, 'dryrun', True) and
1747	                not self.data.get('role', self.manager.config.assume_role)):
1748	            raise PolicyValidationError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1758	        account_id = self.manager.config.account_id
1759	        topic_arn = self.data.get('topic')
1760	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1761	        func = get_function(
1762	            None, self.data.get('role', self.manager.config.assume_role),
1763	            account_id=account_id, tags=self.data.get('tags'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1762	            None, self.data.get('role', self.manager.config.assume_role),
1763	            account_id=account_id, tags=self.data.get('tags'))
1764	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1867
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1866	
1867	        statements = p.get('Statement', [])
1868	        for s in list(statements):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1869
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1868	        for s in list(statements):
1869	            if s.get('Sid', '') == encryption_sid:
1870	                log.debug("Bucket:%s Found extant encrypt policy", b['Name'])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1927	        self.fh = open(self.path, 'w')
1928	        self.fh.write("[\n")
1929	        return self

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1935
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1934	        # we need an empty marker list at end to avoid trailing commas
1935	        self.fh.write("[]")
1936	        # and close the surrounding list

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1936	        # and close the surrounding list
1937	        self.fh.write("\n]")
1938	        self.fh.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1948
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1947	            return
1948	        self.fh.write(dumps(keys))
1949	        self.fh.write(",\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1949
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1948	        self.fh.write(dumps(keys))
1949	        self.fh.write(",\n")
1950	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1975
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1974	        return (
1975	            b.get('Versioning', {'Status': ''}).get('Status') in (
1976	                'Enabled', 'Suspended') and 'versioned' or 'standard')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1975
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1974	        return (
1975	            b.get('Versioning', {'Status': ''}).get('Status') in (
1976	                'Enabled', 'Suspended') and 'versioned' or 'standard')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:1989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1988	        for ck in content_keys:
1989	            keys.extend(key_set.get(ck, []))
1990	        return keys

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2008
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2007	                        "Error on bucket:%s region:%s policy:%s error: %s",
2008	                        b['Name'], b.get('Location', 'unknown'),
2009	                        self.manager.data.get('name'), f.exception())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2008	                        b['Name'], b.get('Location', 'unknown'),
2009	                        self.manager.data.get('name'), f.exception())
2010	                    self.denied_buckets.add(b['Name'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2156	        super(EncryptExtantKeys, self).__init__(data, manager)
2157	        self.kms_id = self.data.get('key-id')
2158	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2160	        perms = ("s3:GetObject", "s3:GetObjectVersion")
2161	        if self.data.get('report-only'):
2162	            perms += ('s3:DeleteObject', 's3:DeleteObjectVersion',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2202	    def process_chunk(self, batch, bucket):
2203	        crypto_method = self.data.get('crypto', 'AES256')
2204	        s3 = bucket_client(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2222	        # for AES256 then we don't need to do anything
2223	        if info.get('ServerSideEncryption') == 'AES256' and not self.kms_id:
2224	            return False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2225	
2226	        if info.get('ServerSideEncryption') == 'aws:kms':
2227	            # If we're not looking for a specific key any key will do.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2231	            # note this is not a strict equality match.
2232	            if self.kms_id in info.get('SSEKMSKeyId', ''):
2233	                return False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2234	
2235	        if self.data.get('report-only'):
2236	            return k

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2237	
2238	        storage_class = info.get('StorageClass', 'STANDARD')
2239	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2240	        if storage_class == 'GLACIER':
2241	            if not self.data.get('glacier'):
2242	                return False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2255	
2256	        crypto_method = self.data.get('crypto', 'AES256')
2257	        key_id = self.data.get('key-id')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2256	        crypto_method = self.data.get('crypto', 'AES256')
2257	        key_id = self.data.get('key-id')
2258	        # Note on copy we lose individual object acl grants

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2268	
2269	        if info['ContentLength'] > MAX_COPY_SIZE and self.data.get(
2270	                'large', True):
2271	            return self.process_large_file(s3, bucket_name, key, info, params)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2284	
2285	        if self.data.get('report-only'):
2286	            return key['Key'], key['VersionId']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2390	
2391	        services = self.data.get('services', ['elb', 's3', 'cloudtrail'])
2392	        self_log = self.data.get('self', False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2391	        services = self.data.get('services', ['elb', 's3', 'cloudtrail'])
2392	        self_log = self.data.get('self', False)
2393	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2412	            len(log_buckets), len(buckets)))
2413	        if self.data.get('value', True):
2414	            return [b for b in buckets if b['Name'] in log_buckets]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2421	        for b in buckets:
2422	            if b.get('Logging'):
2423	                if self_log:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2434	        names = {b['Name'] for b in buckets}
2435	        for t in client.describe_trails().get('trailList', ()):
2436	            if t.get('S3BucketName') in names:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2435	        for t in client.describe_trails().get('trailList', ()):
2436	            if t.get('S3BucketName') in names:
2437	                yield (t['S3BucketName'], t.get('S3KeyPrefix', ''))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2436	            if t.get('S3BucketName') in names:
2437	                yield (t['S3BucketName'], t.get('S3KeyPrefix', ''))
2438	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2519	    def process_bucket(self, b):
2520	        grantees = self.data.get(
2521	            'grantees', [
2522	                GlobalGrantsFilter.AUTH_ALL, GlobalGrantsFilter.GLOBAL_ALL])
2523	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2525	
2526	        acl = b.get('Acl', {'Grants': []})
2527	        if not acl or not acl['Grants']:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2530	        for grant in acl['Grants']:
2531	            grantee = grant.get('Grantee', {})
2532	            if not grantee:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2651	        """
2652	        regions = {t.get('HomeRegion') for t in trails}
2653	        clients = {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2658	        for t in trails:
2659	            for events in clients[t.get('HomeRegion')].get_event_selectors(
2660	                    TrailName=t['Name']).get('EventSelectors', ()):
2661	                if 'DataResources' not in events:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2658	        for t in trails:
2659	            for events in clients[t.get('HomeRegion')].get_event_selectors(
2660	                    TrailName=t['Name']).get('EventSelectors', ()):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2684	
2685	        op = ops[self.data.get('state', 'present')]
2686	        results = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2721	            client = bucket_client(local_session(self.manager.session_factory), b)
2722	            inventories = client.list_bucket_inventory_configurations(
2723	                Bucket=b['Name']).get('InventoryConfigurationList', [])
2724	            b['c7n:inventories'] = inventories

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2765	    def process_bucket(self, b):
2766	        inventory_name = self.data.get('name')
2767	        destination = self.data.get('destination')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2766	        inventory_name = self.data.get('name')
2767	        destination = self.data.get('destination')
2768	        prefix = self.data.get('prefix', '')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2767	        destination = self.data.get('destination')
2768	        prefix = self.data.get('prefix', '')
2769	        schedule = self.data.get('schedule', 'Daily')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2768	        prefix = self.data.get('prefix', '')
2769	        schedule = self.data.get('schedule', 'Daily')
2770	        fields = self.data.get('fields', ['LastModifiedDate', 'Size'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2769	        schedule = self.data.get('schedule', 'Daily')
2770	        fields = self.data.get('fields', ['LastModifiedDate', 'Size'])
2771	        versions = self.data.get('versions', 'Current')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2770	        fields = self.data.get('fields', ['LastModifiedDate', 'Size'])
2771	        versions = self.data.get('versions', 'Current')
2772	        state = self.data.get('state', 'enabled')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2771	        versions = self.data.get('versions', 'Current')
2772	        state = self.data.get('state', 'enabled')
2773	        encryption = self.data.get('encryption')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2772	        state = self.data.get('state', 'enabled')
2773	        encryption = self.data.get('encryption')
2774	        inventory_format = self.data.get('format', 'CSV')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2773	        encryption = self.data.get('encryption')
2774	        inventory_format = self.data.get('format', 'CSV')
2775	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2811	            bucket['Encryption'] = {encryption: {}}
2812	            if encryption == 'SSEKMS' and self.data.get('key_id'):
2813	                bucket['Encryption'] = {encryption: {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2828	        found = None
2829	        for i in inventories.get('InventoryConfigurationList', []):
2830	            if i['Id'] != inventory['Id']:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2903	                    Bucket=b['Name'])
2904	                b[self.annotation_key] = int_tier_config.get(
2905	                    'IntelligentTieringConfigurationList', [])
2906	            except ClientError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:2913
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2912	                    b.setdefault('c7n:DeniedMethods', []).append(method)
2913	        return b.get(self.annotation_key)
2914	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3037	
3038	        if 'list_bucket_intelligent_tiering_configurations' in bucket.get(
3039	            'c7n:DeniedMethods', []):
3040	            log.warning("Access Denied Bucket:%s while reading intelligent tiering configurations"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3043	
3044	        if self.data.get('Id') and self.data.get('IntelligentTieringConfiguration'):
3045	            try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3043	
3044	        if self.data.get('Id') and self.data.get('IntelligentTieringConfiguration'):
3045	            try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3047
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3046	                s3.put_bucket_intelligent_tiering_configuration(
3047	                    Bucket=bucket['Name'], Id=self.data.get(
3048	                      'Id'), IntelligentTieringConfiguration=self.data.get(
3049	                        'IntelligentTieringConfiguration'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3047	                    Bucket=bucket['Name'], Id=self.data.get(
3048	                      'Id'), IntelligentTieringConfiguration=self.data.get(
3049	                        'IntelligentTieringConfiguration'))
3050	            except ClientError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3055
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3054	                          % bucket['Name'])
3055	        if self.data.get('State'):
3056	            if self.data.get('Id') == 'matched':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3055	        if self.data.get('State'):
3056	            if self.data.get('Id') == 'matched':
3057	                for config in bucket.get(self.annotation_key):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3057
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3056	            if self.data.get('Id') == 'matched':
3057	                for config in bucket.get(self.annotation_key):
3058	                    self.delete_intelligent_tiering_configurations(s3, config.get('Id'), bucket)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3058
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3057	                for config in bucket.get(self.annotation_key):
3058	                    self.delete_intelligent_tiering_configurations(s3, config.get('Id'), bucket)
3059	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3060
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3059	            else:
3060	                self.delete_intelligent_tiering_configurations(s3, self.data.get('Id'), bucket)
3061	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3124	        # Stop replication so we can suspend versioning
3125	        if b.get('Replication') is not None:
3126	            client.delete_bucket_replication(Bucket=b['Name'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3130	        if (self.get_bucket_style(b) == 'versioned' and b['Versioning']['Status'] == 'Enabled' and
3131	        self.data.get('remove-contents', True)):
3132	            client.put_bucket_versioning(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3138	        for p in uploads.paginate(Bucket=b['Name']):
3139	            for u in p.get('Uploads', ()):
3140	                client.abort_multipart_upload(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3147	        # on the bucket up front before disabling versioning/replication.
3148	        if self.data.get('remove-contents', True):
3149	            self._process_with_futures(self.process_delete_enablement, buckets)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3196	            objects.append(obj)
3197	        results = s3.delete_objects(
3198	            Bucket=bucket['Name'], Delete={'Objects': objects}).get('Deleted', ())
3199	        if self.get_bucket_style(bucket) != 'versioned':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3361	
3362	        if 'get_bucket_lifecycle_configuration' in bucket.get('c7n:DeniedMethods', []):
3363	            log.warning("Access Denied Bucket:%s while reading lifecycle" % bucket['Name'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3366	        # Adjust the existing lifecycle by adding/deleting/overwriting rules as necessary
3367	        config = (bucket.get('Lifecycle') or {}).get('Rules', [])
3368	        for rule in self.data['rules']:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3366	        # Adjust the existing lifecycle by adding/deleting/overwriting rules as necessary
3367	        config = (bucket.get('Lifecycle') or {}).get('Rules', [])
3368	        for rule in self.data['rules']:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3406	    def resolve_keys(self, buckets):
3407	        key = self.data.get('key')
3408	        if not key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3414	            try:
3415	                key_meta = client.describe_key(
3416	                    KeyId=key
3417	                ).get('KeyMetadata', {})
3418	                key_id = key_meta.get('KeyId')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3417	                ).get('KeyMetadata', {})
3418	                key_id = key_meta.get('KeyId')
3419	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3421	                # to fully evaluate bucket encryption filters.
3422	                key_aliases = client.list_aliases(
3423	                    KeyId=key_id
3424	                ).get('Aliases', [])
3425	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3427	                    'KeyId': key_id,
3428	                    'Arn': key_meta.get('Arn'),
3429	                    'KeyManager': key_meta.get('KeyManager'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3428	                    'Arn': key_meta.get('Arn'),
3429	                    'KeyManager': key_meta.get('KeyManager'),
3430	                    'Description': key_meta.get('Description'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3429	                    'KeyManager': key_meta.get('KeyManager'),
3430	                    'Description': key_meta.get('Description'),
3431	                    'Aliases': [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3439	                self.log.error('Error resolving kms ARNs for set-bucket-encryption: %s key: %s' % (
3440	                    e, self.data.get('key')))
3441	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3445	        region = get_region(bucket)
3446	        key = self.arns.get(region)
3447	        if not key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3448	            self.log.warning('Unable to resolve key %s for bucket %s in region %s',
3449	                             self.data['key'], bucket.get('Name'), region)
3450	        return key

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3499	    def validate(self):
3500	        if self.data.get('bucket_key_enabled') is not None and self.data.get('key') is not None:
3501	            raise PolicyValidationError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3499	    def validate(self):
3500	        if self.data.get('bucket_key_enabled') is not None and self.data.get('key') is not None:
3501	            raise PolicyValidationError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3535	
3536	        rules = be.get('ServerSideEncryptionConfiguration', {}).get('Rules', [])
3537	        # default `state` to True as previous impl assumed state == True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3535	
3536	        rules = be.get('ServerSideEncryptionConfiguration', {}).get('Rules', [])
3537	        # default `state` to True as previous impl assumed state == True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3538	        # to preserve backwards compatibility
3539	        if self.data.get('bucket_key_enabled'):
3540	            for rule in rules:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3541	                return self.filter_bucket_key_enabled(rule)
3542	        elif self.data.get('bucket_key_enabled') is False:
3543	            for rule in rules:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3545	
3546	        if self.data.get('state', True):
3547	            for sse in rules:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3557	        key = self.get_key(b)
3558	        crypto = self.data.get('crypto')
3559	        rule = sse.get('ApplyServerSideEncryptionByDefault')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3558	        crypto = self.data.get('crypto')
3559	        rule = sse.get('ApplyServerSideEncryptionByDefault')
3560	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3562	            return False
3563	        algo = rule.get('SSEAlgorithm')
3564	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3587	            # implies the AWS-managed key.
3588	            key_ids = {key.get('Arn'), key.get('KeyId'), *key['Aliases']}
3589	            return rule.get('KMSMasterKeyID', 'alias/aws/s3') in key_ids

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3587	            # implies the AWS-managed key.
3588	            key_ids = {key.get('Arn'), key.get('KeyId'), *key['Aliases']}
3589	            return rule.get('KMSMasterKeyID', 'alias/aws/s3') in key_ids

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3588	            key_ids = {key.get('Arn'), key.get('KeyId'), *key['Aliases']}
3589	            return rule.get('KMSMasterKeyID', 'alias/aws/s3') in key_ids
3590	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3593	            return False
3594	        return rule.get('BucketKeyEnabled')
3595	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3676	    def process(self, buckets):
3677	        if self.data.get('enabled', True):
3678	            self.resolve_keys(buckets)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3689	        s3 = bucket_client(local_session(self.manager.session_factory), bucket)
3690	        if not self.data.get('enabled', True):
3691	            s3.delete_bucket_encryption(Bucket=bucket['Name'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3692	            return
3693	        algo = self.data.get('crypto', 'AES256')
3694	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3696	        # and ignores False values for that crypto
3697	        bucket_key = self.data.get('bucket-key', True)
3698	        config = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3812	            controls = {}
3813	        b[self.annotation_key] = controls.get('OwnershipControls')
3814	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3861
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3860	        # replication configuration is called in S3_AUGMENT_TABLE:
3861	        bucket_replication = b.get(self.annotation_key)
3862	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3864	        if bucket_replication is not None:
3865	            rules = bucket_replication.get('ReplicationConfiguration', {}).get('Rules', [])
3866	            for replication in rules:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3864	        if bucket_replication is not None:
3865	            rules = bucket_replication.get('ReplicationConfiguration', {}).get('Rules', [])
3866	            for replication in rules:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3871	    def augment_bucket_replication(self, b, replication, client):
3872	        destination_bucket = replication.get('Destination').get('Bucket').split(':')[5]
3873	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/s3.py:3872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3871	    def augment_bucket_replication(self, b, replication, client):
3872	        destination_bucket = replication.get('Destination').get('Bucket').split(':')[5]
3873	        try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/resources/sqs.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	        #
102	        endpoint = 'https://sqs.{region}.amazonaws.com'.format(region=self.config.region)
103	        # these only seem to have the legacy endpoints, so fall through to boto behavior.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/schema.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
396	    schema = {
397	        "$schema": "http://json-schema.org/draft-07/schema#",
398	        'id': 'http://schema.cloudcustodian.io/v0/custodian.json',
399	        'definitions': definitions,
400	        'type': 'object',
401	        'required': ['policies'],
402	        'additionalProperties': False,
403	        'properties': {
404	            'vars': {'type': 'object'},
405	            'policies': {
406	                'type': 'array',
407	                'additionalItems': False,
408	                'items': {'anyOf': resource_refs}
409	            }
410	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/schema.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
397	        "$schema": "http://json-schema.org/draft-07/schema#",
398	        'id': 'http://schema.cloudcustodian.io/v0/custodian.json',
399	        'definitions': definitions,
400	        'type': 'object',
401	        'required': ['policies'],
402	        'additionalProperties': False,
403	        'properties': {
404	            'vars': {'type': 'object'},
405	            'policies': {
406	                'type': 'array',
407	                'additionalItems': False,
408	                'items': {'anyOf': resource_refs}
409	            }
410	        }
411	    }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/testing.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
54	        if format == "json":
55	            fh.write(json.dumps(policy).encode("utf8"))
56	        else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/testing.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
54	        if format == "json":
55	            fh.write(json.dumps(policy).encode("utf8"))
56	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/testing.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	        else:
57	            fh.write(yaml.dump(policy, encoding="utf8", Dumper=yaml.SafeDumper))
58	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/testing.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
56	        else:
57	            fh.write(yaml.dump(policy, encoding="utf8", Dumper=yaml.SafeDumper))
58	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/testing.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
261	            b = b.decode("utf8")
262	        return super(TextTestIO, self).write(b)
263	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/testing.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
261	            b = b.decode("utf8")
262	        return super(TextTestIO, self).write(b)
263	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/c7n-0.9.43-py3-none-any/c7n/utils.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	    with open(path) as fh:
62	        contents = fh.read()
63	

--------------------------------------------------

Code scanned:
	Total lines of code: 61199
	Total lines skipped (#nosec): 11

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 206.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 222.0
		High: 6.0
Files skipped (0):
