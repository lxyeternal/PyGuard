Run started:2025-05-25 13:30:15.371773

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	            retrySeconds = expRetrySeconds
106	            retryAfterHeader = response.headers.get("retry-after")
107	            if retryAfterHeader is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
134	    """
135	    if options is not None and options.get("response_format") is not None:
136	        options_obj = options.get("response_format")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	    if options is not None and options.get("response_format") is not None:
136	        options_obj = options.get("response_format")
137	        if not isinstance(options_obj, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138	            raise ValueError("'response_format' should be an object")
139	        if options_obj.get("type") is None:
140	            raise ValueError("'type' cannot be empty for 'response_format' object")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
140	            raise ValueError("'type' cannot be empty for 'response_format' object")
141	        if not isinstance(options_obj.get("type"), str):
142	            raise ValueError("'type' needs to be a str for 'response_format' object")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	            raise ValueError("'type' needs to be a str for 'response_format' object")
143	        if options_obj.get("schema") is None:
144	            raise ValueError("'schema' cannot be empty for 'response_format' object")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
144	            raise ValueError("'schema' cannot be empty for 'response_format' object")
145	        if not isinstance(options_obj.get("schema"), dict):
146	            raise ValueError("'schema' needs to be a dict for 'response_format' object")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	    for event in data:
214	        event_type = event.get("event", "message")
215	        event_data = event.get("data", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	        event_type = event.get("event", "message")
215	        event_data = event.get("data", "")
216	        event_data = json.dumps(event_data)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
270	    logger.debug(f"making POST request to {url} (model={model})")
271	    return requests.post(
272	        url,
273	        json=body,
274	        headers=headers,
275	        stream=True,
276	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_complete.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
295	            # TODO: discuss during code review
296	            if parsed_resp.get("error"):
297	                yield json.dumps(parsed_resp)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/cortex/_finetune.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	CORTEX_FINETUNE_FIRST_VERSION = "1.7.0"
16	CORTEX_FINETUNE_DOCUMENTATION_URL = "https://docs.snowflake.com/en/user-guide/snowflake-cortex/cortex-finetuning"
17	
18	
19	class FinetuneError(Exception):

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/env.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
7	PYTHON_VERSION = platform.python_version()
8	OS = platform.system()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/env.py:8
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
7	PYTHON_VERSION = platform.python_version()
8	OS = platform.system()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/env_utils.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	SNOWPARK_ML_PKG_NAME = "snowflake-ml-python"
37	SNOWFLAKE_CONDA_CHANNEL_URL = "https://repo.anaconda.com/pkgs/snowflake"
38	
39	
40	def _validate_pip_requirement_string(req_str: str) -> requirements.Requirement:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/exceptions/modeling_error_messages.py:2
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	ATTRIBUTE_NOT_SET = (
2	    "{} is not set. To read more about Snowpark ML general API differences, please refer to: "
3	    "https://docs.snowflake.com/en/developer-guide/snowpark-ml/snowpark-ml-modeling#general-api"
4	    "-differences."
5	)
6	SIZE_MISMATCH = "Size mismatch: {}={}, {}={}."
7	INVALID_MODEL_PARAM = (

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/file_utils.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
198	            if path.is_file():
199	                with open(path, "rb") as f:
200	                    for chunk in iter(lambda: f.read(64 * 1024), b""):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/file_utils.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
199	                with open(path, "rb") as f:
200	                    for chunk in iter(lambda: f.read(64 * 1024), b""):
201	                        hash.update(chunk)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/file_utils.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
244	    with io.BytesIO() as output_stream:
245	        with tarfile.open(fileobj=output_stream, mode="w:gz") as tar:
246	            tar.add(source_dir, arcname=arcname)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/file_utils.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
273	    temp_file.close()
274	    with open(temp_file_path, "wb") as file:
275	        cloudpickle.dump(object, file)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/file_utils.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
394	    kwargs.setdefault("encoding", "utf-8")
395	    return open(path, *args, **kwargs)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/utils/identifier.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	        raise ValueError(
161	            f"Invalid object name `{object_name}` cannot be parsed as a SQL identifier. "
162	            "Alphanumeric characters and underscores are permitted. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/utils/identifier.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
394	        raise ValueError(
395	            f"{name} is not a valid SQL identifier: https://docs.snowflake.com/en/sql-reference/identifiers-syntax"
396	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/utils/jwt_generator.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
137	        # Base64-encode the value and prepend the prefix 'SHA256:'.
138	        public_key_fp = "SHA256:" + base64.b64encode(sha256hash.digest()).decode("utf-8")
139	        logger.info("Public key fingerprint is %s", public_key_fp)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/utils/jwt_generator.py:138
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
137	        # Base64-encode the value and prepend the prefix 'SHA256:'.
138	        public_key_fp = "SHA256:" + base64.b64encode(sha256hash.digest()).decode("utf-8")
139	        logger.info("Public key fingerprint is %s", public_key_fp)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/_internal/utils/temp_file_utils.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
48	            if os.path.isdir(file_to_delete):
49	                shutil.rmtree(path=file_to_delete, ignore_errors=True)
50	            else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/data/_internal/arrow_ingestor.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
130	                if not self._kwargs.get("filesystem"):
131	                    self._kwargs["filesystem"] = ingestor_utils.get_dataset_filesystem(self._session, source)
132	                sources.extend(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/fileset/fileset.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
555	                original_exception=fileset_errors.FileSetLocationError(
556	                    "A FileSet requires its location to be in an existing server-side-encrypted internal stage."
557	                    "See https://docs.snowflake.com/en/sql-reference/sql/create-stage#internal-stage-parameters-internalstageparams "  # noqa: E501
558	                    "on how to create such a stage."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/model/_client/ops/model_ops.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
636	                original_exception=RuntimeError(
637	                    "Please opt in to BCR Bundle 2024_08 ("
638	                    "https://docs.snowflake.com/en/release-notes/bcr-bundles/2024_08_bundle)."
639	                ),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/model/_model_composer/model_method/function_generator.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	        with open(function_file_path, "w", encoding="utf-8") as f:
78	            f.write(udf_code)
79	            f.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/model/_packager/model_meta/model_meta.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
390	        with open(model_yaml_path, encoding="utf-8") as f:
391	            loaded_meta = yaml.safe_load(f.read())
392	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/modeling/_internal/snowpark_implementations/distributed_hpo_trainer.py:974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
973	                udf_code = execute_template
974	                f.file.write(udf_code)
975	                f.file.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/modeling/_internal/snowpark_implementations/distributed_hpo_trainer.py:974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
973	                udf_code = execute_template
974	                f.file.write(udf_code)
975	                f.file.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/registry/_manager/model_manager.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
379	                original_exception=ValueError(
380	                    f"The model_name `{model_name}` cannot be parsed as a SQL identifier. Alphanumeric characters and "
381	                    "underscores are permitted. See https://docs.snowflake.com/en/sql-reference/identifiers-syntax for "

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/utils/authentication.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
51	
52	    response = requests.post(url, data=data)
53	    if response.status_code != http.HTTPStatus.OK:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/utils/connection_params.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	        with open(token_file) as f:
33	            token = f.read()
34	    return token

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/utils/connection_params.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
43	    with open(private_key_path, "rb") as f:
44	        private_key_pem = f.read()
45	    private_key_passphrase: Optional[str] = os.getenv("SNOWFLAKE_PRIVATE_KEY_PASSPHRASE", None)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/snowflake_ml_python-1.8.1/snowflake_ml_python-1.8.1/snowflake/ml/utils/connection_params.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
123	    logging.info(f"Reading {snowsql_config_file} for connection parameters defined as {connection_name}")
124	    config.read(snowsql_config_file)
125	    conn_params = dict(config[connection_name])

--------------------------------------------------

Code scanned:
	Total lines of code: 185101
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 2.0
Files skipped (0):
