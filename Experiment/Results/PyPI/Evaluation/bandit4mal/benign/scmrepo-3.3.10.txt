Run started:2025-05-25 12:52:05.062933

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/asyn.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	                loop = default_loop[0]
29	                th = threading.Thread(
30	                    target=loop.run_forever,  # type: ignore[attr-defined]
31	                    name="dvcIO",
32	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/__init__.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
225	                fobj.seek(fobj.tell() - 1, os.SEEK_SET)
226	                last = fobj.read(1)
227	                prefix = "" if last == "\n" else "\n"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/__init__.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
229	            if new_entry not in unique_lines:
230	                fobj.write(new_entry)
231	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/__init__.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
262	        hook.write_text(f"{directive}\n{script}\n", encoding="utf-8")
263	        hook.chmod(0o777)
264	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/dulwich/asyncssh_vendor.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	    if n is None:
34	        return await read(-1)
35	    result = []

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/dulwich/asyncssh_vendor.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
36	    while n > 0:
37	        data = await read(n)
38	        result.append(data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/dulwich/asyncssh_vendor.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
84	    def read_stderr(self, n: Optional[int] = None) -> bytes:
85	        return self.stderr.read(n)
86	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/dulwich/asyncssh_vendor.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	    async def _write(self, data: bytes) -> None:
88	        self.proc.stdin.write(data)
89	        await self.proc.stdin.drain()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/gitpython.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
96	        # and `open` with default "r" mode returns str)
97	        data = self.obj.data_stream.read()
98	        if mode == "rb":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/pygit2/__init__.py:789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
788	            try:
789	                self.repo.index.read(False)
790	                strategy = self._get_checkout_strategy()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/pygit2/__init__.py:841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
840	
841	        self.repo.index.read(False)
842	        if paths is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/pygit2/__init__.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
849	                self.repo.index.add(IndexEntry(rel, obj.id, obj.filemode))
850	            self.repo.index.write()
851	        elif hard:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/pygit2/__init__.py:903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
902	                    with open(path, "wb") as fobj:
903	                        fobj.write(self.repo.get(entry.id).read_raw())
904	                    index.add(entry.path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/pygit2/__init__.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
904	                    index.add(entry.path)
905	                index.write()
906	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/pygit2/__init__.py:966
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
965	        with self.release_odb_handles():
966	            self.repo.index.read(False)
967	            obj, _ref = self.repo.resolve_refish(rev)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/pygit2/__init__.py:980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
979	                self.repo.merge(obj.id)
980	                self.repo.index.write()
981	            except GitError as exc:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/backend/pygit2/__init__.py:1007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1006	                self.repo.state_cleanup()
1007	                self.repo.index.write()
1008	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/credentials.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
339	        try:
340	            stream.write(prompt)
341	            stream.flush()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/lfs/client.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
160	
161	        resp_data = await self._batch_request(objects, **kwargs)
162	        if resp_data.get("transfer", "basic") != "basic":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/lfs/client.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
268	        return json.loads(
269	            self._ssh.run_command(
270	                command=f"git-lfs-authenticate {path} {action}",
271	                host=host,
272	                port=port,
273	                username=username,
274	            ).read()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/lfs/pointer.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	LFS_VERSION = "https://git-lfs.github.com/spec/v1"
11	LEGACY_LFS_VERSION = "https://hawser.github.com/spec/v1"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/src/scmrepo/git/lfs/pointer.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	LFS_VERSION = "https://git-lfs.github.com/spec/v1"
11	LEGACY_LFS_VERSION = "https://hawser.github.com/spec/v1"
12	ALLOWED_VERSIONS = (LFS_VERSION, LEGACY_LFS_VERSION)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/conftest.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
128	    conn_info = {
129	        "host": "127.0.0.1",
130	        "port": docker.port_for("git-server", 2222),
131	        "client_keys": TEST_SSH_KEY_PATH,
132	        "known_hosts": None,
133	        "username": TEST_SSH_USER,
134	    }
135	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_credentials.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    assert run.call_args.kwargs.get("input") == "protocol=https\nhost=foo.com\n"
31	    assert creds == Credential(url="https://foo:bar@foo.com")
32	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_credentials.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
198	        "/usr/local/bin/my-askpass",
199	        "Username for 'https://foo.com': ",
200	    ]
201	    assert run.call_args_list[1].args[0] == [
202	        "/usr/local/bin/my-askpass",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_credentials.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
202	        "/usr/local/bin/my-askpass",
203	        "Password for 'https://foo@foo.com': ",
204	    ]
205	
206	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_credentials.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	    assert list(
220	        GitCredentialHelper.get_matching_commands("https://foo.com/foo.git", config)
221	    ) == [("/usr/local/bin/my-helper", True)]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_credentials.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
231	    assert list(
232	        GitCredentialHelper.get_matching_commands("https://foo.com/foo.git", config)
233	    ) == [("/usr/local/bin/my-helper", False)]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_credentials.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
244	        list(
245	            GitCredentialHelper.get_matching_commands("https://foo.com/foo.git", config)
246	        )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:89
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
88	
89	    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
90	    sock.bind(("127.0.0.1", 0))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
89	    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
90	    sock.bind(("127.0.0.1", 0))
91	    sock.listen(5)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	
108	    thread = threading.Thread(target=_run_server)
109	    thread.start()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
125	    vendor.run_command(
126	        "127.0.0.1",
127	        "test_run_command_password",
128	        username=USER,
129	        port=ssh_port,
130	        password=PASSWORD,
131	    )
132	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
139	        vendor.run_command(
140	            "127.0.0.1",
141	            "test_run_command_password",
142	            username=USER,
143	            port=ssh_port,
144	            password=None,
145	        )
146	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
152	    vendor.run_command(
153	        "127.0.0.1",
154	        "test_run_command_with_privkey",
155	        username=USER,
156	        port=ssh_port,
157	        key_filename=key,
158	    )
159	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
166	    con = vendor.run_command(
167	        "127.0.0.1",
168	        "test_run_command_data_transfer",
169	        username=USER,
170	        port=ssh_port,
171	        password=PASSWORD,
172	    )
173	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
176	    channel = server.transport.accept(5)  # type: ignore[attr-defined]
177	    channel.send(b"stdout\n")
178	    channel.send_stderr(b"stderr\n")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
178	    channel.send_stderr(b"stderr\n")
179	    channel.close()
180	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	    assert wait_until(con.can_read, timeout=1, pause=0.1)
182	    assert con.read(n=7 if use_len else None) == b"stdout\n"
183	    assert con.read_stderr(n=7 if use_len else None) == b"stderr\n"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
188	    con = vendor.run_command(
189	        "127.0.0.1",
190	        "test_run_command_data_transfer",
191	        username=USER,
192	        port=ssh_port,
193	        password=PASSWORD,
194	    )
195	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
201	    )
202	    assert con.read(n=7) == b"stdout\n"
203	    assert mock_stdout.call_count == 3

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
258	    with open(config, "wb") as fobj:
259	        fobj.write(
260	            b"""
261	Host *

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_dulwich.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
267	    with open(config, "wb") as fobj:
268	        fobj.write(
269	            b"""
270	Host *

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_fs.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	    with fs.open("foo", mode="r", encoding="utf-8", raw=raw) as fobj:
35	        assert fobj.read() == "foo"
36	    with fs.open("тест", mode="r", encoding="utf-8", raw=raw) as fobj:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_fs.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
36	    with fs.open("тест", mode="r", encoding="utf-8", raw=raw) as fobj:
37	        assert fobj.read() == "проверка"
38	    with pytest.raises(IOError):  # noqa: PT011

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	
32	BAD_PROXY_CONFIG = """[http]
33	proxy = "http://bad-proxy.dvc.org"
34	[https]
35	proxy = "http://bad-proxy.dvc.org"
36	"""
37	
38	
39	@pytest.fixture
40	def submodule_dir(tmp_dir: TmpDir, scm: Git):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
452	        for entry in test_entries:
453	            f.write(entry["entry"] + "\n")
454	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
471	    tmp_dir.gen(hook_file, "#!/usr/bin/env python\nimport sys\nsys.exit(1)")
472	    os.chmod(hook_file, stat.S_IREAD | stat.S_IWRITE | stat.S_IEXEC)
473	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:472
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
471	    tmp_dir.gen(hook_file, "#!/usr/bin/env python\nimport sys\nsys.exit(1)")
472	    os.chmod(hook_file, stat.S_IREAD | stat.S_IWRITE | stat.S_IEXEC)
473	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
905	    async with sftp.open("test-repo.git/refs/heads/master") as fobj:
906	        assert (await fobj.read(-1, 0)).strip() == rev
907	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:908
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
907	
908	    shutil.rmtree(tmp_dir / ".git")
909	    (tmp_dir / "foo").unlink()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
954	    with fs.open("foo", mode="r") as fobj:
955	        assert fobj.read().strip() == "foo"
956	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:969
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
968	def test_clone_proxy_server(proxy_server: str, scm: Git, git: Git, tmp_dir: TmpDir):
969	    url = "https://github.com/iterative/dvcyaml-schema"
970	
971	    p = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:990
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
989	def test_iter_remote_refs_proxy_server(proxy_server: str, scm: Git, tmp_dir: TmpDir):
990	    url = "https://github.com/iterative/dvcyaml-schema"
991	    git = GitBackends.DEFAULT["dulwich"](".")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:1016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1015	):
1016	    url = "https://github.com/iterative/dvcyaml-schema"
1017	
1018	    p = (

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:1089
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1088	    with (tmp_dir / "foo").open("a") as fobj:
1089	        fobj.write("modified")
1090	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_git.py:1092
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1091	    with (tmp_dir / "bar").open("a") as fobj:
1092	        fobj.write("modified")
1093	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	FOO_POINTER = (
22	    f"version https://git-lfs.github.com/spec/v1\n"
23	    f"oid sha256:{FOO_OID}\n"
24	    f"size {FOO_SIZE}\n"
25	).encode()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
58	    with open(tmp_dir / "foo.lfs", "rb") as fobj:
59	        pointer = Pointer.load(fobj)
60	    assert pointer.oid == FOO_OID

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
205	):
206	    client = LFSClient.from_git_url("http://git.example.com/namespace/project.git")
207	    recorder = CallbackResultRecorder()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
210	        lfs_server = LFSServerMock(
211	            m, recorder, f"{client.url}/objects/batch", "http://git-lfs.example.com"
212	        )
213	        lfs_server.mock_batch_429(rate_limit_header, rate_limit_value)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
217	
218	        client.download(storage, [Pointer(oid=FOO_OID, size=FOO_SIZE)])
219	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
237	):
238	    client = LFSClient.from_git_url("http://git.example.com/namespace/project.git")
239	    recorder = CallbackResultRecorder()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
242	        lfs_server = LFSServerMock(
243	            m, recorder, f"{client.url}/objects/batch", "http://git-lfs.example.com"
244	        )
245	        lfs_server.mock_batch_429(rate_limit_header, rate_limit_value, repeat=True)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
247	        with pytest.raises(ClientResponseError, match="Too many requests"):
248	            client.download(storage, [Pointer(oid=FOO_OID, size=FOO_SIZE)])
249	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
264	):
265	    client = LFSClient.from_git_url("http://git.example.com/namespace/project.git")
266	    recorder = CallbackResultRecorder()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
269	        lfs_server = LFSServerMock(
270	            m, recorder, f"{client.url}/objects/batch", "http://git-lfs.example.com"
271	        )
272	        lfs_server.mock_batch_200(Pointer(FOO_OID, FOO_SIZE))

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_lfs.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
277	        with pytest.raises(ClientResponseError, match="Too many requests"):
278	            client.download(storage, [Pointer(oid=FOO_OID, size=FOO_SIZE)])
279	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_scmrepo.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    progress = MagicMock()
12	    url = "https://github.com/iterative/dvcyaml-schema"
13	    rev = "cf279597596b54c5b0ce089eb4bda41ebbbb5db4"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_scmrepo.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	def test_clone_shallow(tmp_dir: TmpDir):
23	    url = "https://github.com/iterative/dvcyaml-schema"
24	    shallow_branch = "master"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_stash.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	
88	reason = """libgit2 stash_save() is flaky on linux when run inside pytest
89	    https://github.com/iterative/dvc/pull/5286#issuecomment-792574294"""
90	
91	
92	@pytest.mark.xfail(
93	    sys.platform in ("linux", "win32"),
94	    raises=AssertionError,
95	    strict=False,
96	    reason=reason,
97	)
98	@pytest.mark.parametrize("ref", [None, "refs/foo/stash"])
99	def test_git_stash_pop(tmp_dir: TmpDir, scm: Git, ref: Optional[str]):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_urls.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	        "ssh://login@server.com:12345/repository.git",
26	        "https://user:password@github.com/iterative/scmrepo.git",
27	        "https://github.com/iterative/scmrepo.git",
28	    ],
29	)
30	def test_scp_url_invalid(url: str):
31	    assert not is_scp_style_url(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/scmrepo-3.3.10/scmrepo-3.3.10/tests/test_urls.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        "https://user:password@github.com/iterative/scmrepo.git",
27	        "https://github.com/iterative/scmrepo.git",
28	    ],
29	)
30	def test_scp_url_invalid(url: str):
31	    assert not is_scp_style_url(url)

--------------------------------------------------

Code scanned:
	Total lines of code: 7905
	Total lines skipped (#nosec): 1

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 33.0
		High: 40.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 71.0
		High: 2.0
Files skipped (0):
