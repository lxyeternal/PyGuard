Run started:2025-05-25 12:31:10.330935

Test results:
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/setup.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
8	with (here / "trio_websocket" / "_version.py").open() as f:
9	    exec(f.read(), version)
10	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/setup.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    long_description_content_type='text/markdown',
22	    url='https://github.com/python-trio/trio-websocket',
23	    author='Mark E. Haase',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/setup.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    project_urls={
52	        'Bug Reports': 'https://github.com/python-trio/trio-websocket/issues',
53	        'Source': 'https://github.com/python-trio/trio-websocket',
54	    },
55	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/setup.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	        'Bug Reports': 'https://github.com/python-trio/trio-websocket/issues',
53	        'Source': 'https://github.com/python-trio/trio-websocket',
54	    },
55	)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
102	
103	HOST = '127.0.0.1'
104	RESOURCE = '/resource'

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
187	        client, server = memory_stream_pair()
188	        await self.queued_streams[0].send(server)
189	        return client

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
187	        client, server = memory_stream_pair()
188	        await self.queued_streams[0].send(server)
189	        return client

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
208	async def test_endpoint_ipv4() -> None:
209	    e1 = Endpoint('10.105.0.2', 80, False)
210	    assert e1.url == 'ws://10.105.0.2'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
211	    assert str(e1) == 'Endpoint(address="10.105.0.2", port=80, is_ssl=False)'
212	    e2 = Endpoint('127.0.0.1', 8000, False)
213	    assert e2.url == 'ws://127.0.0.1:8000'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
214	    assert str(e2) == 'Endpoint(address="127.0.0.1", port=8000, is_ssl=False)'
215	    e3 = Endpoint('0.0.0.0', 443, True)
216	    assert e3.url == 'wss://0.0.0.0'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
365	    with pytest.raises(ValueError):
366	        async with open_websocket_url('http://foo.com/bar'):
367	            pass

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:808
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
807	        assert not echo_conn.closed
808	        await echo_conn.aclose(code=1001, reason='test reason')
809	    assert isinstance(echo_conn.closed, CloseReason)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
817	    await nursery.start(server.run)
818	    stream = await listener.connect()
819	    conn = await wrap_client_stream(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1005	    async with client_ws:
1006	        await stream.aclose()
1007	        with pytest.raises(ConnectionClosed):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1028	            await client_ws.send_message('Hello from client')
1029	        await stream.aclose()
1030	    await done.wait()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1037	        async with server_ws:
1038	            await stream.aclose()
1039	            with pytest.raises(ConnectionClosed):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1204	    await connection.get_message()
1205	    await connection.aclose()
1206	    await trio.sleep(.1)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1225	        await ws.get_message()
1226	        await ws.aclose()
1227	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1259	            close_sent.set()
1260	        return await orig_send(event)
1261	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1259	            close_sent.set()
1260	        return await orig_send(event)
1261	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1290	    # send a CloseConnection event to server but leave client connected
1291	    await client._send(CloseConnection(code=1000))
1292	    await server_stream_closed.wait()

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1290	    # send a CloseConnection event to server but leave client connected
1291	    await client._send(CloseConnection(code=1000))
1292	    await server_stream_closed.wait()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1338	        server_stream.send_stream.send_all_hook = None
1339	        await server_ws._send(CloseConnection(code=1000, reason=None))
1340	        await server_stream.aclose()

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1338	        server_stream.send_stream.send_all_hook = None
1339	        await server_ws._send(CloseConnection(code=1000, reason=None))
1340	        await server_stream.aclose()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/tests/test_connection.py:1340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1339	        await server_ws._send(CloseConnection(code=1000, reason=None))
1340	        await server_stream.aclose()
1341	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
292	        raise TrioWebsocketInternalError(
293	            "The trio-websocket API is not expected to raise multiple exceptions. "
294	            "Please report this as a bug to "
295	            "https://github.com/python-trio/trio-websocket"

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1170	                self._close_reason = CloseReason(1000, None)
1171	                await self._send(CloseConnection(code=code, reason=reason))
1172	            elif self._wsproto.state in (ConnectionState.CONNECTING,

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1237	        self._pings[payload] = event
1238	        await self._send(Ping(payload=payload))
1239	        await event.wait()

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1251	            raise ConnectionClosed(self._close_reason)
1252	        await self._send(Pong(payload=payload or b''))
1253	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1270	            raise ValueError('message must be str or bytes')
1271	        await self._send(event)
1272	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1296	        self._path = request.target
1297	        await self._send(AcceptConnection(subprotocol=self._subprotocol,
1298	            extra_headers=extra_headers))
1299	        self._open_handshake.set()

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1320	            has_body=bool(body))
1321	        await self._send(reject_conn)
1322	        if body:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1323	            reject_body = RejectData(data=body)
1324	            await self._send(reject_body)
1325	        self._close_reason = CloseReason(1006, 'Rejected WebSocket handshake')

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1336	        if self._wsproto.state == ConnectionState.OPEN:
1337	            self._wsproto.send(CloseConnection(code=close_reason.value))
1338	        if self._close_reason is None:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1440	            self._for_testing_peer_closed_connection.set()
1441	            await self._send(event.response())
1442	        await self._close_web_socket(event.code, event.reason or None)

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1467	            self._close_reason = CloseReason(1009, err)
1468	            await self._send(CloseConnection(code=1009, reason=err))
1469	            await self._recv_channel.aclose()

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1480	            try:
1481	                await self._send_channel.send(msg)
1482	            except (trio.ClosedResourceError, trio.BrokenResourceError):

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1497	        logger.debug('%s ping %r', self, event.payload)
1498	        await self._send(event.response())
1499	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1545	            try:
1546	                await self._send(self._initial_request)
1547	            except ConnectionClosed:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1590	                        if err.event_hint:
1591	                            await self._send(err.event_hint)
1592	                        await self._close_stream()

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/trio_websocket-0.12.2/trio_websocket-0.12.2/trio_websocket/_impl.py:1606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
1605	        '''
1606	        data = self._wsproto.send(event)
1607	        async with self._stream_lock:

--------------------------------------------------

Code scanned:
	Total lines of code: 2627
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 31.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 1.0
Files skipped (0):
