Run started:2025-05-25 12:56:59.898158

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	            try:
69	                requests.get(config[oauth2_url], timeout=5)
70	            except RequestException:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	        config = get_config(OLD_CONFIG_NAME)
102	        url = config.get('url')
103	    params = {'json': 'true'}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	        params['scope'] = ' '.join(filter(is_user_scope, scope))
108	    response = requests.get(url, params=params, auth=(user, password), verify=not insecure)
109	    if response.status_code == 401:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	
118	    if not json_data.get('access_token'):
119	        raise ServerError('Token Service returned invalid JSON (access_token missing)')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	    data = get_tokens()
126	    existing_token = data.get(name)
127	    if is_valid(existing_token):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
158	        try:
159	            httpd = ClientRedirectServer(('127.0.0.1', port_number))
160	        except socket.error:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	                  'client_id':              config['client_id'],
173	                  'redirect_uri':           'http://localhost:{}'.format(port_number)}
174	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
184	        saved_stderr = os.dup(2)
185	        os.close(1)
186	        os.close(2)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
185	        os.close(1)
186	        os.close(2)
187	        os.open(os.devnull, os.O_RDWR)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
201	        # Handle next request, with token
202	        httpd.handle_request()
203	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	        # This will clear any non-JWT tokens
214	        if existing_token and existing_token.get('access_token').count('.') >= 2:
215	            return existing_token

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
234	
235	    refresh_token = data.get('refresh_token')
236	    if refresh_token and use_refresh:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
241	        try:
242	            r = requests.post(config['token_url'], timeout=20, data=payload)
243	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	        token = {'access_token':    response['access_token'],
260	                 'refresh_token':   response.get('refresh_token'),
261	                 'expires_in':      int(response['expires_in']),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
287	    now = time.time()
288	    return token and now < (token.get('creation_time', 0) + token.get('expires_in', 0) - TOKEN_MINIMUM_VALIDITY_SECONDS)
289	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
287	    now = time.time()
288	    return token and now < (token.get('creation_time', 0) + token.get('expires_in', 0) - TOKEN_MINIMUM_VALIDITY_SECONDS)
289	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/api.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
299	    try:
300	        access_token = tokens.get(name)
301	    except tokens.ConfigurationError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/stups_zign-1.2-py3-none-any/zign/oauth2.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	
21	EXTRACT_TOKEN_PAGE = '''<!DOCTYPE HTML>
22	<html lang="en-US">
23	  <head>
24	    <title>Redirecting...</title>
25	    <style>
26	        body {{
27	            font-family: sans-serif;
28	        }}
29	        #error {{
30	            color: red;
31	        }}
32	    </style>
33	    <script>
34	        (function extractFragmentQueryString() {{
35	            function displayError(message) {{
36	              var errorElement = document.getElementById("error");
37	              errorElement.textContent = message || "Unknown error";
38	            }}
39	
40	            function parseQueryString(qs) {{
41	                return qs.split("&")
42	                        .reduce(function (result, param) {{
43	                          var split = param.split("=");
44	                          if (split.length === 2) {{
45	                            var key = decodeURIComponent(split[0]);
46	                            var val = decodeURIComponent(split[1]);
47	                            result[key] = val;
48	                          }}
49	                          return result;
50	                        }}, {{}});
51	            }}
52	            var query = window.location.hash.substring(1);
53	            var params = parseQueryString(query);
54	            if (params.access_token) {{
55	                window.location.href = "http://localhost:{port}/?" + query;
56	            }} else {{
57	                displayError("Error: No access_token in URL.")
58	            }}
59	        }})();
60	    </script>
61	  </head>
62	  <body>
63	    <noscript>
64	        <p>Your browser does not support Javascript! Please enable it or switch to a Javascript enabled browser.</p>
65	    </noscript>
66	    <p>Redirecting...</p>
67	    <p id="error"></p>
68	  </body>
69	</html>'''
70	
71	ERROR_PAGE = '''<!DOCTYPE HTML>

--------------------------------------------------

Code scanned:
	Total lines of code: 464
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 0.0
Files skipped (0):
