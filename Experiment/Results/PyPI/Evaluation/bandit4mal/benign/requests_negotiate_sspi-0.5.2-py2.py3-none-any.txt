Run started:2025-05-25 13:31:30.688331

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	
98	        content_length = int(response.request.headers.get('Content-Length', '0'), base=10)
99	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	        # authentication-related info in cookies
114	        if response.headers.get('set-cookie'):
115	            request.headers['Cookie'] = response.headers.get('set-cookie')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	        if response.headers.get('set-cookie'):
115	            request.headers['Cookie'] = response.headers.get('set-cookie')
116	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
119	            error, auth = clientauth.authorize(sec_buffer)
120	            request.headers['Authorization'] = '{} {}'.format(scheme, base64.b64encode(auth[0].Buffer).decode('ASCII'))
121	            _logger.debug('Sending Initial Context Token - error={} authenticated={}'.format(error, clientauth.authenticated))

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:120
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
119	            error, auth = clientauth.authorize(sec_buffer)
120	            request.headers['Authorization'] = '{} {}'.format(scheme, base64.b64encode(auth[0].Buffer).decode('ASCII'))
121	            _logger.debug('Sending Initial Context Token - error={} authenticated={}'.format(error, clientauth.authenticated))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
132	        args_nostream = dict(args, stream=False)
133	        response2 = response.connection.send(request, **args_nostream)
134	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138	                # Kerberos may have succeeded; if so, finalize our auth context
139	                final = response2.headers.get('WWW-Authenticate')
140	                if final is not None:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
145	                        tokenbuf = win32security.PySecBufferType(pkg_info['MaxToken'], sspicon.SECBUFFER_TOKEN)
146	                        tokenbuf.Buffer = base64.b64decode(final)
147	                        sec_buffer.append(tokenbuf)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:146
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
145	                        tokenbuf = win32security.PySecBufferType(pkg_info['MaxToken'], sspicon.SECBUFFER_TOKEN)
146	                        tokenbuf.Buffer = base64.b64decode(final)
147	                        sec_buffer.append(tokenbuf)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	        # Keep passing the cookies along
165	        if response2.headers.get('set-cookie'):
166	            request.headers['Cookie'] = response2.headers.get('set-cookie')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	        if response2.headers.get('set-cookie'):
166	            request.headers['Cookie'] = response2.headers.get('set-cookie')
167	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	        # Extract challenge message from server
169	        challenge = [val[len(scheme)+1:] for val in response2.headers.get('WWW-Authenticate', '').split(', ') if scheme in val]
170	        if len(challenge) != 1:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
174	        tokenbuf = win32security.PySecBufferType(pkg_info['MaxToken'], sspicon.SECBUFFER_TOKEN)
175	        tokenbuf.Buffer = base64.b64decode(challenge[0])
176	        sec_buffer.append(tokenbuf)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:175
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
174	        tokenbuf = win32security.PySecBufferType(pkg_info['MaxToken'], sspicon.SECBUFFER_TOKEN)
175	        tokenbuf.Buffer = base64.b64decode(challenge[0])
176	        sec_buffer.append(tokenbuf)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
181	            error, auth = clientauth.authorize(sec_buffer)
182	            request.headers['Authorization'] = '{} {}'.format(scheme, base64.b64encode(auth[0].Buffer).decode('ASCII'))
183	            _logger.debug('Sending Response - error={} authenticated={}'.format(error, clientauth.authenticated))

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:182
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
181	            error, auth = clientauth.authorize(sec_buffer)
182	            request.headers['Authorization'] = '{} {}'.format(scheme, base64.b64encode(auth[0].Buffer).decode('ASCII'))
183	            _logger.debug('Sending Response - error={} authenticated={}'.format(error, clientauth.authenticated))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
187	
188	        response3 = response2.connection.send(request, **args)
189	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/requests_negotiate_sspi-0.5.2-py2.py3-none-any/requests_negotiate_sspi/requests_negotiate_sspi.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	            for scheme in ('Negotiate', 'NTLM'):
199	                if scheme.lower() in r.headers.get('WWW-Authenticate', '').lower():
200	                    return self._retry_using_http_Negotiate_auth(r, scheme, kwargs)

--------------------------------------------------

Code scanned:
	Total lines of code: 159
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 4.0
Files skipped (0):
