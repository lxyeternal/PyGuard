Run started:2025-05-25 13:15:22.943366

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/addon.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	        username = (
55	            args["username"] if args["username"] else os.environ.get("DC_USERNAME")
56	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/addon.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	        password = (
58	            args["password"] if args["password"] else os.environ.get("DC_PASSWORD")
59	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/addon.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	                # add title in case the add-on wants to reference its own title
126	                args["title"] = schema.get("title")
127	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/addon.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
135	        """Send yourself an email"""
136	        return self.client.post(
137	            "messages/", json={"subject": subject, "content": content}
138	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/addon.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	        file_name = os.path.basename(file.name)
167	        resp = self.client.get(
168	            f"addon_runs/{self.id}/", params={"upload_file": file_name}
169	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/addon.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	
190	        response = self.client.get(f"addon_events/{self.event_id}/")
191	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/addon.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
233	
234	        resp = self.client.post(
235	            f"organizations/{self.org_id}/ai_credits/",
236	            json={
237	                "ai_credits": amount,
238	                "addonrun_id": self.id,
239	                "note": f"AddOn run: {self.title} - {self.id}",
240	            },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/addon.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
288	        self.data["_restore_key"] = self.id
289	        self.client.post(
290	            "addon_runs/",
291	            json={
292	                "addon": self.addon_id,
293	                "parameters": self.data,
294	                **options,
295	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/client.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	        password=None,
26	        base_uri="https://api.www.documentcloud.org/api/",
27	        auth_uri="https://accounts.muckrock.com/api/",
28	        timeout=20,
29	        loglevel=None,
30	        rate_limit=True,
31	        rate_limit_sleep=True,
32	    ):
33	       # Initialize SquareletClient for authentication and request handling
34	        super().__init__(
35	            base_uri=base_uri,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/client.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        base_uri="https://api.www.documentcloud.org/api/",
27	        auth_uri="https://accounts.muckrock.com/api/",
28	        timeout=20,
29	        loglevel=None,
30	        rate_limit=True,
31	        rate_limit_sleep=True,
32	    ):
33	       # Initialize SquareletClient for authentication and request handling
34	        super().__init__(
35	            base_uri=base_uri,
36	            username=username,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/constants.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	BULK_LIMIT = 25
3	BASE_URI = "https://api.www.documentcloud.org/api/"
4	AUTH_URI = "https://accounts.muckrock.com/api/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/constants.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	BASE_URI = "https://api.www.documentcloud.org/api/"
4	AUTH_URI = "https://accounts.muckrock.com/api/"
5	TIMEOUT = 20

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	        for name, resource in objs:
57	            value = dict_.get(name)
58	            if isinstance(value, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	                dict_[f"_{name}"] = resource(client, value)
60	                dict_[f"{name}_id"] = value.get("id")
61	            elif isinstance(value, int):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	        if self._user is None:
140	            self._user = self._client.users.get(self.user_id)
141	        return self._user

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	        if self._organization is None:
147	            self._organization = self._client.organizations.get(self.organization_id)
148	        return self._organization

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	            # authentication credentials
170	            response = self._client.get(url, full_url=True)
171	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
171	        else:
172	            response = requests_retry_session().get(
173	                url, headers={"User-Agent": "python-documentcloud2"}
174	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	        while endpoint:
217	            response = self._client.get(endpoint)
218	            data = response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
219	
220	            results = data.get("results", [])
221	            for entry in results:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
221	            for entry in results:
222	                created_at_str = entry.get("created_at")
223	                if created_at_str:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
228	            all_results.extend(results)
229	            endpoint = data.get("next")
230	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
234	        """Reprocess the document"""
235	        self._client.post(f"{self.api_path}/{self.id}/process/")
236	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	            params["q"] = query
260	        response = self.client.get("documents/search/", params=params)
261	        return APIResults(self.resource, self.client, response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
343	        params["file_url"] = file_url
344	        response = self.client.post("documents/", json=params)
345	        return Document(self.client, response.json())

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
351	        params = self._format_upload_parameters(file_.name, **kwargs)
352	        response = self.client.post("documents/", json=params)
353	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
356	        presigned_url = create_json["presigned_url"]
357	        response = requests_retry_session().put(presigned_url, data=file_.read())
358	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
360	        doc_id = create_json["id"]
361	        response = self.client.post(
362	            f"documents/{doc_id}/process/", json={"force_ocr": force_ocr}
363	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
424	            try:
425	                response = self.client.post(
426	                    "documents/",
427	                    json=[
428	                        merge_dicts(
429	                            params,
430	                            {
431	                                "title": self._get_title(p),
432	                                "original_extension": os.path.splitext(
433	                                    os.path.basename(p)
434	                                )[1]
435	                                .lower()
436	                                .lstrip("."),
437	                            },
438	                        )
439	                        for p in file_paths
440	                    ],

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
460	                    with open(file_path, "rb") as file:
461	                        response = requests_retry_session().put(url, data=file.read())
462	                    self.client.raise_for_status(response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
477	            try:
478	                response = self.client.post("documents/process/", json={"ids": doc_ids})
479	            except (APIError, RequestException) as exc:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/documentcloud/documents.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
515	            try:
516	                response = self.client.post(
517	                    "documents/",
518	                    json=[
519	                        merge_dicts(
520	                            params,
521	                            {
522	                                "title": self._get_title(url),
523	                                "file_url": url,
524	                            },
525	                        )
526	                        for url in url_group
527	                    ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/python_documentcloud-4.4.1/python_documentcloud-4.4.1/setup.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    long_description_content_type="text/markdown",
16	    url="https://github.com/muckrock/python-documentcloud",
17	    license="MIT",

--------------------------------------------------

Code scanned:
	Total lines of code: 1918
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 33.0
		High: 0.0
Files skipped (0):
