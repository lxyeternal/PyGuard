Run started:2025-05-25 13:27:52.243580

Test results:
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/utils.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
84	def malloc_trim():
85	    ctypes.CDLL("libc.so.6").malloc_trim(0)
86	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/utils.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
92	    _, payload, _ = token.split('.')
93	    return json.loads(base64.urlsafe_b64decode(f'{payload}=='))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/api.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
107	        res = self.client.send(
108	            request=self.client.build_request(
109	                method='POST',
110	                url='/schedule',
111	                params=params,
112	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/client.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	SIGNUP_ON_HF_TXT = "Create a free account"
37	SIGNUP_ON_HF_URL = "https://huggingface.co/join"
38	SUBSCRIBE_TO_PRO_TXT = "Subscribe to Pro"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/client.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	SUBSCRIBE_TO_PRO_TXT = "Subscribe to Pro"
39	SUBSCRIBE_TO_PRO_URL = "https://huggingface.co/settings/billing/subscription"
40	
41	
42	def api_client():

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/client.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
108	
109	    token, payload = _get_token_and_payload(request)
110	    if token is not None and (token_error := payload.get('error')):

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/client.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
268	    try:
269	        payload = utils.jwt_payload(token)
270	    except Exception: # pragma: no cover

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/torch/packing.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	    while written_bytes < size:
60	        written_bytes += os.write(fd, mv[written_bytes:])
61	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/torch/packing.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	                for tensor, size, _ in batch:
117	                    write(fd, tensor)
118	                    callback(size)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/torch/packing.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
119	            for tensor, size, _ in big_tensors:
120	                write(fd, tensor)
121	                callback(size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/torch/packing.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	            batch_size = sum([aligned_size for *_, aligned_size in batch])
147	            read(fd, buffer, batch_size)
148	            read_buffers.put(buffer)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/torch/packing.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
153	                read_size = min(BUFFER_SIZE, aligned_size - read_bytes)
154	                read(fd, buffer, read_size)
155	                read_buffers.put(buffer)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/torch/packing.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
198	
199	    with ThreadPoolExecutor(2) as e:
200	        fd = os.open(pack.path(), os.O_RDONLY | os.O_DIRECT)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/torch/patching.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
397	    callback = callback if callback is not None else lambda _: None
398	    with ThreadPoolExecutor(1) as e:
399	        e.submit(copy_context().run, _move, callback=callback).result()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/torch/patching.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
402	def is_in_bad_fork():
403	    with ProcessPoolExecutor(mp_context=multiprocessing.get_context('fork')) as e:
404	        f = e.submit(torch.cuda._is_in_bad_fork)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/torch/patching_legacy.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
259	def is_in_bad_fork():
260	    with ProcessPoolExecutor(mp_context=multiprocessing.get_context('fork')) as e:
261	        f = e.submit(torch.cuda._is_in_bad_fork)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/wrappers.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	    ):
77	        self._sentinel = Thread(target=self._close_on_exit, daemon=True)
78	        self.arg_queue = Queue()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/wrappers.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
82	        if (server_port := get_server_port()) is not None:
83	            fds = [c.fd for c in psutil.Process().connections() if c.laddr.port == server_port]
84	            debug(f"{fds=}")

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/wrappers.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
90	            target(*args)
91	        self.process = Process(
92	            target=target,
93	            args=args,
94	            daemon=True,
95	        )

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/wrappers.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
233	        forked = True
234	        signal.signal(signal.SIGTERM, drop_params(arg_queue.close))
235	        initialized = False

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/wrappers.py:234
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
233	        forked = True
234	        signal.signal(signal.SIGTERM, drop_params(arg_queue.close))
235	        initialized = False

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/wrappers.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
252	            context = copy_context()
253	            with ThreadPoolExecutor() as executor:
254	                future = executor.submit(context.run, task, *args, **kwargs) # type: ignore

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/wrappers.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
342	        from typing_extensions import assert_never
343	        with ThreadPoolExecutor() as e:
344	            f = e.submit(copy_context().run, fill_yield_queue, worker)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/wrappers.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
374	        forked = True
375	        signal.signal(signal.SIGTERM, drop_params(arg_queue.close))
376	        initialized = False

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/wrappers.py:375
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
374	        forked = True
375	        signal.signal(signal.SIGTERM, drop_params(arg_queue.close))
376	        initialized = False

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/spaces-0.34.2/spaces-0.34.2/spaces/zero/wrappers.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
409	            GradioPartialContext.apply(gradio_context)
410	            with ThreadPoolExecutor() as executor:
411	                executor.submit(copy_context().run, iterate)

--------------------------------------------------

Code scanned:
	Total lines of code: 2244
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 22.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 2.0
Files skipped (0):
