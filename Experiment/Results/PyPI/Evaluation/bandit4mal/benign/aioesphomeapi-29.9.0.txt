Run started:2025-05-25 13:16:07.439172

Test results:
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/aioesphomeapi/connection.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
289	        if self._frame_helper is not None:
290	            self._frame_helper.close()
291	            self._frame_helper = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/aioesphomeapi/connection.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
293	        if self._socket is not None:
294	            self._socket.close()
295	            self._socket = None

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/aioesphomeapi/connection.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
577	        )
578	        await self._connect_socket_connect(addrs_info)
579	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/aioesphomeapi/connection.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
595	            ):
596	                await self._do_connect()
597	        except (Exception, CancelledError) as ex:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/aioesphomeapi/connection.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
662	            ):
663	                await self._do_finish_connect(login)
664	        except (Exception, CancelledError) as ex:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/aioesphomeapi/host_resolver.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
262	        if manager and not had_zeroconf_instance:
263	            await asyncio.shield(create_eager_task(manager.async_close()))
264	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	with open(os.path.join(here, "README.rst"), encoding="utf-8") as readme_file:
38	    long_description = readme_file.read()
39	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/setup.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	PROJECT_COPYRIGHT = " 2019-2020, Otto Winter"
47	PROJECT_URL = "https://esphome.io/"
48	PROJECT_EMAIL = "esphome@nabucasa.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/setup.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	
53	PYPI_URL = f"https://pypi.python.org/pypi/{PROJECT_PACKAGE_NAME}"
54	GITHUB_PATH = f"{PROJECT_GITHUB_USERNAME}/{PROJECT_GITHUB_REPOSITORY}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/setup.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	GITHUB_PATH = f"{PROJECT_GITHUB_USERNAME}/{PROJECT_GITHUB_REPOSITORY}"
55	GITHUB_URL = f"https://github.com/{GITHUB_PATH}"
56	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/setup.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	with open(os.path.join(here, "requirements/base.txt")) as requirements_txt:
60	    REQUIRES = requirements_txt.read().splitlines()
61	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test__frame_helper.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
358	    noise_psk = "QRTIErOb/fcE9Ukd/5qA3RGYMn0Y+p06U58SCtOXvPc="
359	    psk_bytes = base64.b64decode(noise_psk)
360	    writes = []

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test__frame_helper.py:359
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
358	    noise_psk = "QRTIErOb/fcE9Ukd/5qA3RGYMn0Y+p06U58SCtOXvPc="
359	    psk_bytes = base64.b64decode(noise_psk)
360	    writes = []

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test__frame_helper.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
407	    noise_psk = "QRTIErOb/fcE9Ukd/5qA3RGYMn0Y+p06U58SCtOXvPc="
408	    psk_bytes = base64.b64decode(noise_psk)
409	    writes = []

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test__frame_helper.py:408
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
407	    noise_psk = "QRTIErOb/fcE9Ukd/5qA3RGYMn0Y+p06U58SCtOXvPc="
408	    psk_bytes = base64.b64decode(noise_psk)
409	    writes = []

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test__frame_helper.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
469	    noise_psk = "QRTIErOb/fcE9Ukd/5qA3RGYMn0Y+p06U58SCtOXvPc="
470	    psk_bytes = base64.b64decode(noise_psk)
471	    writes = []

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test__frame_helper.py:470
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
469	    noise_psk = "QRTIErOb/fcE9Ukd/5qA3RGYMn0Y+p06U58SCtOXvPc="
470	    psk_bytes = base64.b64decode(noise_psk)
471	    writes = []

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test__frame_helper.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
536	    noise_psk = "QRTIErOb/fcE9Ukd/5qA3RGYMn0Y+p06U58SCtOXvPc="
537	    psk_bytes = base64.b64decode(noise_psk)
538	    writes = []

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test__frame_helper.py:537
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
536	    noise_psk = "QRTIErOb/fcE9Ukd/5qA3RGYMn0Y+p06U58SCtOXvPc="
537	    psk_bytes = base64.b64decode(noise_psk)
538	    writes = []

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test__frame_helper.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
614	    noise_psk = "QRTIErOb/fcE9Ukd/5qA3RGYMn0Y+p06U58SCtOXvPc="
615	    psk_bytes = base64.b64decode(noise_psk)
616	    writes = []

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test__frame_helper.py:615
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
614	    noise_psk = "QRTIErOb/fcE9Ukd/5qA3RGYMn0Y+p06U58SCtOXvPc="
615	    psk_bytes = base64.b64decode(noise_psk)
616	    writes = []

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
214	    ):
215	        await cli.connect()
216	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
226	
227	    cli = APIClient("127.0.0.1", 1234, None)
228	    with patch("aioesphomeapi.client.APIConnection", PatchableAPIConnection):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
244	    """Verify connection is unset if connecting is cancelled."""
245	    cli = APIClient("127.0.0.1", 1234, None)
246	    asyncio.get_event_loop()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
250	        mock_socket = create_autospec(socket.socket, spec_set=True, instance=True)
251	        mock_socket.getpeername.return_value = ("4.3.3.3", 323)
252	        return mock_socket

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
268	        mock_socket = create_autospec(socket.socket, spec_set=True, instance=True)
269	        mock_socket.getpeername.return_value = ("4.3.3.3", 323)
270	        return mock_socket

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
297	
298	    cli = PatchableApiClient("127.0.0.1", 1234, None)
299	    with (

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
305	    ):
306	        connect_task = asyncio.create_task(cli.connect())
307	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
353	
354	    await send(BinarySensorStateResponse())
355	    on_state.assert_called_once_with(BinarySensorState())

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
362	    auth_client.subscribe_states(on_state)
363	    await send(CameraImageResponse(key=1, data=b"asdf"))
364	    on_state.assert_not_called()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
365	
366	    await send(CameraImageResponse(key=1, data=b"qwer", done=True))
367	    on_state.assert_called_once_with(CameraState(key=1, data=b"asdfqwer"))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
397	) -> None:
398	    send = patch_send(auth_client)
399	    patch_api_version(auth_client, APIVersion(1, 0))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
421	) -> None:
422	    send = patch_send(auth_client)
423	    patch_api_version(auth_client, APIVersion(1, 1))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
459	) -> None:
460	    send = patch_send(auth_client)
461	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
523	) -> None:
524	    send = patch_send(auth_client)
525	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
540	) -> None:
541	    send = patch_send(auth_client)
542	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
563	) -> None:
564	    send = patch_send(auth_client)
565	    patch_api_version(auth_client, APIVersion(1, 4))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:620
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
619	) -> None:
620	    send = patch_send(auth_client)
621	    patch_api_version(auth_client, APIVersion(1, 5))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
637	) -> None:
638	    send = patch_send(auth_client)
639	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
660	) -> None:
661	    send = patch_send(auth_client)
662	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
684	) -> None:
685	    send = patch_send(auth_client)
686	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
708	) -> None:
709	    send = patch_send(auth_client)
710	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
733	) -> None:
734	    send = patch_send(auth_client)
735	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
752	) -> None:
753	    send = patch_send(auth_client)
754	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:776
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
775	) -> None:
776	    send = patch_send(auth_client)
777	    patch_api_version(auth_client, APIVersion(1, 1))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
793	) -> None:
794	    send = patch_send(auth_client)
795	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
830	) -> None:
831	    send = patch_send(auth_client)
832	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
812	        (
813	            dict(key=1, media_url="http://example.com"),
814	            dict(key=1, has_media_url=True, media_url="http://example.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
813	            dict(key=1, media_url="http://example.com"),
814	            dict(key=1, has_media_url=True, media_url="http://example.com"),
815	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:817
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
816	        (
817	            dict(key=1, media_url="http://example.com", announcement=True),
818	            dict(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
820	                has_media_url=True,
821	                media_url="http://example.com",
822	                has_announcement=True,

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:847
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
846	) -> None:
847	    send = patch_send(auth_client)
848	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:881
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
880	) -> None:
881	    send = patch_send(auth_client)
882	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
888	async def test_execute_service(auth_client: APIClient) -> None:
889	    send = patch_send(auth_client)
890	    patch_api_version(auth_client, APIVersion(1, 3))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
990	async def test_request_single_image(auth_client: APIClient) -> None:
991	    send = patch_send(auth_client)
992	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
998	async def test_request_image_stream(auth_client: APIClient) -> None:
999	    send = patch_send(auth_client)
1000	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1025	) -> None:
1026	    send = patch_send(auth_client)
1027	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1043
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1042	) -> None:
1043	    send = patch_send(auth_client)
1044	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1065	) -> None:
1066	    send = patch_send(auth_client)
1067	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1079	    cli = PatchableAPIClient(
1080	        address=Estr("127.0.0.1"),
1081	        port=6052,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1115	    cli = APIClient(
1116	        address=Estr("127.0.0.1"),
1117	        port=6052,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1131	    cli = APIClient(
1132	        address=Estr("127.0.0.1"),
1133	        port=6052,

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1150	    client, connection, transport, protocol = api_client
1151	    disconnect_task = asyncio.create_task(client.bluetooth_device_disconnect(1234))
1152	    await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1300	    assert client.log_name == "realname @ 10.0.0.512"
1301	    disconnect_task = asyncio.create_task(client.disconnect())
1302	    await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1317	    client, connection, transport, protocol = api_client
1318	    read_task = asyncio.create_task(client.bluetooth_gatt_read(1234, 1234))
1319	    await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1340	    client, connection, transport, protocol = api_client
1341	    read_task = asyncio.create_task(client.bluetooth_gatt_read(1234, 1234))
1342	    await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1362	    client, connection, transport, protocol = api_client
1363	    read_task = asyncio.create_task(client.bluetooth_gatt_read(1234, 1234))
1364	    await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1404	    write_task = asyncio.create_task(
1405	        client.bluetooth_gatt_write(1234, 1234, b"1234", True)
1406	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1427	    write_task = asyncio.create_task(
1428	        client.bluetooth_gatt_write(1234, 1234, b"1234", True)
1429	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1452	    write_task = asyncio.create_task(
1453	        client.bluetooth_gatt_write(1234, 1234, b"1234", False)
1454	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1464	    with pytest.raises(TimeoutAPIError, match="BluetoothGATTWriteResponse"):
1465	        await client.bluetooth_gatt_write(1234, 1234, b"1234", True, timeout=0)
1466	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1673	    abort_cb()
1674	    await client.disconnect(force=True)
1675	    # Ensure abort callback is a no-op after disconnect

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1946	    log_msg = SubscribeLogsResponse(level=1, message=b"asdf")
1947	    await send(log_msg)
1948	    on_logs.assert_called_with(log_msg)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1951	    log_msg = SubscribeLogsResponse(level=1, message=b"asdf")
1952	    await send(log_msg)
1953	    on_logs.assert_not_called()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1959
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1958	async def test_send_home_assistant_state(auth_client: APIClient) -> None:
1959	    send = patch_send(auth_client)
1960	    auth_client.send_home_assistant_state("binary_sensor.bla", None, "on")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:1974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1973	    service_msg = HomeassistantServiceResponse(service="bob")
1974	    await send(service_msg)
1975	    on_service_call.assert_called_with(HomeassistantServiceCall.from_pb(service_msg))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2022
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2021	    assert connection.on_stop is not None
2022	    await client.disconnect(force=True)
2023	    assert client._connection is None

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2024	    assert connection.is_connected is False
2025	    await client.disconnect(force=False)
2026	    assert connection.is_connected is False

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2062
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2061	    connect_task = asyncio.create_task(
2062	        client.bluetooth_device_connect(
2063	            1234,
2064	            on_bluetooth_connection_state,
2065	            timeout=1,
2066	            feature_flags=feature_flags,
2067	            has_cache=has_cache,
2068	            disconnect_timeout=1,
2069	            address_type=1,
2070	        )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2108	
2109	    await client.disconnect(force=True)
2110	    await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2129	    connect_task = asyncio.create_task(
2130	        client.bluetooth_device_connect(
2131	            1234,
2132	            on_bluetooth_connection_state,
2133	            timeout=0,
2134	            feature_flags=0,
2135	            has_cache=True,
2136	            disconnect_timeout=0,
2137	            address_type=1,
2138	        )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2158	    connect_task = asyncio.create_task(
2159	        client.bluetooth_device_connect(
2160	            1234,
2161	            on_bluetooth_connection_state,
2162	            timeout=0,
2163	            feature_flags=0,
2164	            has_cache=True,
2165	            disconnect_timeout=1,
2166	            address_type=1,
2167	        )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2202	    connect_task = asyncio.create_task(
2203	        client.bluetooth_device_connect(
2204	            1234,
2205	            on_bluetooth_connection_state,
2206	            timeout=10,
2207	            feature_flags=0,
2208	            has_cache=True,
2209	            disconnect_timeout=10,
2210	            address_type=1,
2211	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
2234	async def test_send_voice_assistant_event(auth_client: APIClient) -> None:
2235	    send = patch_send(auth_client)
2236	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
2270	    client, connection, transport, protocol = api_client
2271	    send = patch_send(client)
2272	    starts = []

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2338	    send.reset_mock()
2339	    await client.disconnect(force=True)
2340	    # Ensure abort callback is a no-op after disconnect

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
2353	    client, connection, transport, protocol = api_client
2354	    send = patch_send(client)
2355	    starts = []

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2421	    send.reset_mock()
2422	    await client.disconnect(force=True)
2423	    # Ensure abort callback is a no-op after disconnect

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
2436	    client, connection, transport, protocol = api_client
2437	    send = patch_send(client)
2438	    starts = []

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
2504	    client, connection, transport, protocol = api_client
2505	    send = patch_send(client)
2506	    starts = []

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2600	    send.reset_mock()
2601	    await client.disconnect(force=True)
2602	    # Ensure abort callback is a no-op after disconnect

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
2609	async def test_send_voice_assistant_timer_event(auth_client: APIClient) -> None:
2610	    send = patch_send(auth_client)
2611	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
2668	    client, connection, transport, protocol = api_client
2669	    send = patch_send(client)
2670	    done = asyncio.Event()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2702	
2703	    await client.disconnect(force=True)
2704	    # Ensure abort callback is a no-op after disconnect

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2769	    assert client.api_version == APIVersion(1, 9)
2770	    await client.disconnect(force=True)
2771	    assert client.api_version is None

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_client.py:2783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2782	    assert client.api_version == APIVersion(1, 9)
2783	    await client.disconnect(force=True)
2784	    assert client.api_version is None

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
116	    with patch("aioesphomeapi.connection.DISCONNECT_RESPONSE_TIMEOUT", 0.0):
117	        await conn.disconnect()
118	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
147	    ):
148	        await conn.disconnect()
149	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
182	    assert isinstance(conn._fatal_exception, RequiresEncryptionAPIError)
183	    conn.force_disconnect()
184	    assert isinstance(conn._fatal_exception, RequiresEncryptionAPIError)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
225	    remove()
226	    conn.force_disconnect()
227	    await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
239	    with patch.object(loop, "create_connection", side_effect=OSError("Socket error")):
240	        connect_task = asyncio.create_task(connect(conn, login=False))
241	        await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
272	    mock_socket.fileno.return_value = 1
273	    mock_socket.getpeername.return_value = ("10.0.0.512", 323)
274	    mock_socket.setsockopt = _setsockopt

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
286	    ):
287	        connect_task = asyncio.create_task(connect(conn, login=False))
288	        await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
298	    assert conn.is_connected
299	    conn.force_disconnect()
300	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
326	    mock_socket.fileno.return_value = 1
327	    mock_socket.getpeername.return_value = ("10.0.0.512", 323)
328	    mock_socket.setsockopt = _setsockopt

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
339	    ):
340	        connect_task = asyncio.create_task(connect(conn, login=False))
341	        await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
351	    assert conn.is_connected
352	    conn.force_disconnect()
353	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
373	    ):
374	        connect_task = asyncio.create_task(connect(conn, login=False))
375	        await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
395	    ):
396	        connect_task = asyncio.create_task(connect(conn, login=False))
397	        await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
413	    ):
414	        connect_task = asyncio.create_task(connect(conn, login=False))
415	        await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
432	    with patch.object(loop, "create_connection", side_effect=asyncio.CancelledError):
433	        connect_task = asyncio.create_task(connect(conn, login=False))
434	        await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
475	    remove()
476	    conn.force_disconnect()
477	    await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
557	    ):
558	        connect_task = asyncio.create_task(connect(conn, login=False))
559	        await connected.wait()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
571	    remove()
572	    conn.force_disconnect()
573	    await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
660	    with patch.object(protocol, "_writelines", side_effect=OSError):
661	        conn.force_disconnect()
662	    assert "Failed to send (forced) disconnect request" in caplog.text

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
719	    ):
720	        connect_task = asyncio.create_task(connect(conn, login=False))
721	        await connected.wait()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:761
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
760	    ):
761	        connect_task = asyncio.create_task(connect(conn, login=False))
762	        await connected.wait()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
794	    ):
795	        await connect(conn, login=False)
796	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_connection.py:1025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1024	    assert connection.is_connected
1025	    connection.force_disconnect()
1026	    await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_host_resolver.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
21	TEST_IPv6 = IPv6Address("2001:db8:85a3::8a2e:370:7334")
22	TEST_IPv4 = IPv4Address("10.0.0.42")
23	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_host_resolver.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
150	                "canon1",
151	                ("10.0.0.42", 6052),
152	            ),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_host_resolver.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
159	            ),
160	            (-1, socket.SOCK_STREAM, socket.IPPROTO_TCP, "canon3", ("10.0.0.42", 6052)),
161	        ]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_host_resolver.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
546	    resolve_addr.return_value = addr_infos
547	    ret = await hr.async_resolve_host(["127.0.0.1"], 6052)
548	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_host_resolver.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
555	            proto=6,
556	            sockaddr=hr.IPv4Sockaddr(address="127.0.0.1", port=6052),
557	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_log_runner.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
51	    cli = PatchableAPIClient(
52	        address=Estr("127.0.0.1"),
53	        port=6052,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_log_runner.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
120	    cli = PatchableAPIClient(
121	        address=Estr("127.0.0.1"),
122	        port=6052,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_log_runner.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
200	    cli = PatchableAPIClient(
201	        address=Estr("127.0.0.1"),
202	        port=6052,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_reconnect_logic.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
104	    cli = APIClient(
105	        address="127.0.0.1",
106	        port=6052,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_reconnect_logic.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
121	    )
122	    assert cli.log_name == "127.0.0.1"
123	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_reconnect_logic.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
128	    cli = APIClient(
129	        address="127.0.0.1",
130	        port=6052,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_reconnect_logic.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
374	                1000,
375	                ip_address("127.0.0.1").packed,
376	            ),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_reconnect_logic.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
715	    cli = PatchableAPIClient(
716	        address="127.0.0.1",
717	        port=6052,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/aioesphomeapi-29.9.0/aioesphomeapi-29.9.0/tests/test_reconnect_logic.py:796
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
795	    cli = PatchableAPIClient(
796	        address="127.0.0.1",
797	        port=6052,

--------------------------------------------------

Code scanned:
	Total lines of code: 12334
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 97.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 128.0
		High: 5.0
Files skipped (0):
