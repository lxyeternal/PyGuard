Run started:2025-05-25 13:28:28.550782

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/abacus/md.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	    with open_file(path_in) as fp:
162	        inlines = fp.read().split("\n")
163	    geometry_path_in = get_geometry_in(fname, inlines)  # base dir of STRU

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/abacus/md.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
177	    with open_file(os.path.join(path_out, "MD_dump")) as fp:
178	        dumplines = fp.read().split("\n")
179	    coords, cells, force, stress = get_coords_from_dump(dumplines, natoms)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/abacus/md.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	    with open_file(os.path.join(path_out, "running_md.log")) as fp:
182	        outlines = fp.read().split("\n")
183	    energy = get_energy(outlines, ndump, dump_freq)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/abacus/relax.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
179	    with open_file(path_in) as fp:
180	        inlines = fp.read().split("\n")
181	    geometry_path_in = get_geometry_in(fname, inlines)  # base dir of STRU

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/abacus/scf.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
201	    with open_file(path_in) as fp:
202	        inlines = fp.read().split("\n")
203	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/abacus/scf.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
210	    with open_file(path_out) as fp:
211	        outlines = fp.read().split("\n")
212	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/deepmd/comp.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
91	            for ii in sets:
92	                shutil.rmtree(ii)
93	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/deepmd/raw.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	        with open_file(os.path.join(folder, "type_map.raw")) as fp:
22	            my_type_map = fp.read().split()
23	    # else try to use arg type_map

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/format.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
240	        """
241	        return self.to_system(data, *args, **kwargs)
242	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/format.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
277	        """
278	        return self.to_system(data, *args, **kwargs)
279	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/gaussian/log.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	                        raise RuntimeError(
78	                            "Input orientation is not found. Using Gaussian keyword "
79	                            "`Geom=PrintInputOrient` to always print the input orientation. "
80	                            "See https://gaussian.com/geom/ for more details."

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/abacus.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	        with open_file(file_name, "w") as fp:
49	            fp.write(stru_string)
50	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/amber.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
148	                        raise RuntimeError(
149	                            "Run sqm failed! Output:\n" + f.read()
150	                        ) from e

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/ase.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
85	
86	        info_dict = self.from_system(atoms)
87	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/ase.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
140	
141	        frames = ase.io.read(file_name, format=ase_fmt, index=slice(begin, end, step))
142	        yield from frames

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/ase.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
241	        sub_traj = traj[begin:end:step]
242	        dict_frames = ASEStructureFormat().from_system(sub_traj[0])
243	        for atoms in sub_traj[1:]:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/ase.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
243	        for atoms in sub_traj[1:]:
244	            tmp = ASEStructureFormat().from_system(atoms)
245	            dict_frames["cells"] = np.append(dict_frames["cells"], tmp["cells"][0])

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/ase.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
292	
293	        dict_frames = ASEStructureFormat().from_labeled_system(sub_traj[0])
294	        for atoms in sub_traj[1:]:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/ase.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
294	        for atoms in sub_traj[1:]:
295	            tmp = ASEStructureFormat().from_labeled_system(atoms)
296	            dict_frames["cells"] = np.append(dict_frames["cells"], tmp["cells"][0])

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/ase.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
332	
333	        list_atoms = ASEStructureFormat().to_system(data, **kwargs)
334	        traj = Trajectory(file_name, "a")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/ase.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
334	        traj = Trajectory(file_name, "a")
335	        _ = [traj.write(atom) for atom in list_atoms]
336	        traj.close()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/ase.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
353	
354	        list_atoms = ASEStructureFormat().to_labeled_system(data, *args, **kwargs)
355	        traj = Trajectory(file_name, "a")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/ase.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
355	        traj = Trajectory(file_name, "a")
356	        _ = [traj.write(atom) for atom in list_atoms]
357	        traj.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/cp2k.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	string_warning = """
10	Hi, you got an error from dpdata,
11	please check if your cp2k files include full information,
12	otherwise its version is not supported by dpdata.
13	Try use dpdata plugin from cp2kdata package,
14	for details, please refer to
15	https://robinzyb.github.io/cp2kdata/
16	"""
17	
18	
19	@Format.register("cp2k/aimd_output")
20	class CP2KAIMDOutputFormat(Format):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/deepmd.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
175	        """
176	        return dpdata.deepmd.mixed.mix_system(*system, type_map=type_map, **kwargs)
177	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/deepmd.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
278	        """
279	        return self._from_system(file_name, type_map=type_map, labels=False)
280	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/deepmd.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
308	        """
309	        return self._from_system(file_name, type_map=type_map, labels=True)
310	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/gaussian.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
29	    def from_labeled_system(self, file_name: FileType, **kwargs):
30	        return GaussianLogFormat().from_labeled_system(file_name, md=True)
31	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/gaussian.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	        with open_file(file_name) as fp:
48	            text = fp.read()
49	        return dpdata.gaussian.gjf.read_gaussian_input(text)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/gaussian.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
64	        with open_file(file_name, "w") as fp:
65	            fp.write(text)
66	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/gaussian.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
64	        with open_file(file_name, "w") as fp:
65	            fp.write(text)
66	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/gaussian.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
118	                    with open_file(out_fn) as f:
119	                        out = f.read()
120	                    raise RuntimeError("Run gaussian failed! Output:\n" + out) from e

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/vasp.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
57	        """
58	        w_str = VASPStringFormat().to_system(data, frame_idx=frame_idx)
59	        with open_file(file_name, "w") as fp:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/plugins/vasp.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	        with open_file(file_name, "w") as fp:
60	            fp.write(w_str)
61	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/qe/scf.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
168	    with open_file(path_out) as fp:
169	        outlines = fp.read().split("\n")
170	    with open_file(path_in) as fp:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/qe/scf.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
170	    with open_file(path_in) as fp:
171	        inlines = fp.read().split("\n")
172	    cell = get_cell(inlines)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/system.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
236	    def from_fmt_obj(self, fmtobj: Format, file_name: Any, **kwargs: Any):
237	        data = fmtobj.from_system(file_name, **kwargs)
238	        if data:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/system.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
269	    def to_fmt_obj(self, fmtobj: Format, *args: Any, **kwargs: Any):
270	        return fmtobj.to_system(self.data, *args, **kwargs)
271	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/system.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
308	        if isinstance(key, (int, slice, list, np.ndarray)):
309	            return self.sub_system(key)
310	        return self.data[key]

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/system.py:931
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
930	        idx = np.random.permutation(self.get_nframes())
931	        self.data = self.sub_system(idx).data
932	        return idx

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/system.py:1224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1223	    def from_fmt_obj(self, fmtobj, file_name, **kwargs):
1224	        data = fmtobj.from_labeled_system(file_name, **kwargs)
1225	        if data:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/system.py:1238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1237	    def to_fmt_obj(self, fmtobj, *args, **kwargs):
1238	        return fmtobj.to_labeled_system(self.data, *args, **kwargs)
1239	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/system.py:1357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1356	        idx = np.abs(energies - np.mean(energies)) / std < threshold
1357	        return self.sub_system(idx)
1358	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/dpdata-0.2.24/dpdata-0.2.24/dpdata/system.py:1414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1413	        else:
1414	            mixed_systems = fmtobj.mix_system(
1415	                *list(self.systems.values()), type_map=self.atom_names, **kwargs
1416	            )

--------------------------------------------------

Code scanned:
	Total lines of code: 12151
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 42.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 44.0
		High: 0.0
Files skipped (0):
