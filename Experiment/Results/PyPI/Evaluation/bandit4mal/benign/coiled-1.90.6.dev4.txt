Run started:2025-05-25 13:09:25.058698

Test results:
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/analytics.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
49	    module = ModuleType(url)
50	    exec(compiled, module.__dict__)
51	    plugin = module.CoiledTelemetry()  # type: ignore

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/analytics.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
232	    module = ModuleType(url)
233	    exec(compiled, module.__dict__)
234	    plugin = module.CoiledTelemetry()  # type: ignore

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/auth.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
16	
17	        local_user = f"{getpass.getuser()}@{socket.gethostname()}"
18	    except Exception:

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/auth.py:17
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
16	
17	        local_user = f"{getpass.getuser()}@{socket.gethostname()}"
18	    except Exception:

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/auth.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
16	
17	        local_user = f"{getpass.getuser()}@{socket.gethostname()}"
18	    except Exception:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/auth.py:17
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
16	
17	        local_user = f"{getpass.getuser()}@{socket.gethostname()}"
18	    except Exception:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/batch.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
123	            try:
124	                response = sync_request(cloud, url, "get", data=None, json_output=True)
125	            except ServerDisconnectedError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/capture_environment.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	                "source": "conda",
92	                "channel_url": "https://conda.anaconda.org/conda-forge/",
93	                "channel": "conda-forge",
94	                "subdir": "noarch",
95	                "conda_name": "pip",
96	                "version": "22.3.1",
97	                "wheel_target": None,
98	            })
99	        else:
100	            # insert the users pip version and hope it exists on conda-forge
101	            packages.append({
102	                "name": "pip",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/capture_environment.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	                "source": "conda",
105	                "channel_url": "https://conda.anaconda.org/conda-forge/",
106	                "channel": "conda-forge",
107	                "subdir": "noarch",
108	                "conda_name": "pip",
109	                "version": pip["version"],
110	                "wheel_target": None,
111	            })
112	    coiled_selected_python = None
113	    if not user_conda_installed_python:
114	        # insert a special python package
115	        # that the backend will pick a channel for

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/batch/run.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
73	            with open(implicit_file) as f:
74	                file_content = f.read()
75	        except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/batch/run.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
465	        with open(kwargs["host_setup_script"]) as f:
466	            host_setup_content = f.read()
467	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	        with open(user_config_path) as f:
51	            user_config = f.read()
52	            if "dask.host" in user_config:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	                    with open(user_config_path, "w") as f:
62	                        f.write(f"{DEFAULT_SSH_AGENT_CONFIG}\n\n{user_config}")
63	                    return True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	        with open(key_path, "w") as f:
78	            f.write(key)
79	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
80	        # ssh needs file permissions to be set
81	        os.chmod(key_path, mode=0o600)
82	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:81
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
80	        # ssh needs file permissions to be set
81	        os.chmod(key_path, mode=0o600)
82	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
104	    with open(key_path, "w") as f:
105	        f.write(key)
106	    # ssh needs file permissions to be set

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
106	    # ssh needs file permissions to be set
107	    os.chmod(key_path, mode=0o600)
108	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:107
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
106	    # ssh needs file permissions to be set
107	    os.chmod(key_path, mode=0o600)
108	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
132	        with open(coiled_config_path, "r") as f:
133	            if f"Host {address}" not in f.read():
134	                do_write = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
139	        with open(coiled_config_path, "a") as af:
140	            af.write(identity_config)
141	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	        with open(coiled_config_path, "r") as f:
146	            contents = f.read()
147	        if f"Host {address}" in contents:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
149	            with open(coiled_config_path, "w") as f:
150	                f.write(updated)
151	            # print(f"Removed 'Host {address} [...]' from {coiled_config_path}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	            with open(ssh_config_path, "r") as f:
162	                ssh_config_contents = f.read()
163	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/cluster/ssh.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	                print(f"Add {include_line!r} to {ssh_config_path}")
169	                wf.write(f"{include_line}\n\n{ssh_config_contents}")
170	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/hello/hello.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        Panel(
73	            rf"""
74	[bold]                                                  [{PRIMARY_COLOR}]                ..       [/]
75	                                                   [{PRIMARY_COLOR}]               ###      [/]
76	              ____           _   _              _  [{PRIMARY_COLOR}]          .### ###.     [/]
77	             / ___|   ___   (_) | |   ___    __| | [{PRIMARY_COLOR}]         .#### .#.      [/]
78	            | |      / _ \  | | | |  / _ \  / _` | [{PRIMARY_COLOR}]         #####          [/]
79	            | |___  | (_) | | | | | |  __/ | (_| | [{PRIMARY_COLOR}]         .#### .        [/]
80	             \____|  \___/  |_| |_|  \___|  \__,_| [{PRIMARY_COLOR}]           .## ###      [/]
81	                                                   [{PRIMARY_COLOR}]               ###.     [/]
82	                 Website: [{PRIMARY_COLOR}][link=https://coiled.io?utm_source=coiled-hello&utm_medium=banner]https://coiled.io[/link][/{PRIMARY_COLOR}]        [{PRIMARY_COLOR}]             # ###      [/]
83	                 Docs: [{PRIMARY_COLOR}][link=https://docs.coiled.io?utm_source=coiled-hello&utm_medium=banner]https://docs.coiled.io[/link][/{PRIMARY_COLOR}]      [{PRIMARY_COLOR}]            ## ##.      [/]
84	                                                   [{PRIMARY_COLOR}]            ##          [/]
85	                                                   [{PRIMARY_COLOR}]             #          [/][/bold]
86	""".strip()  # noqa

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/hello/hello.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        Panel(
73	            rf"""
74	[bold]                                                  [{PRIMARY_COLOR}]                ..       [/]
75	                                                   [{PRIMARY_COLOR}]               ###      [/]
76	              ____           _   _              _  [{PRIMARY_COLOR}]          .### ###.     [/]
77	             / ___|   ___   (_) | |   ___    __| | [{PRIMARY_COLOR}]         .#### .#.      [/]
78	            | |      / _ \  | | | |  / _ \  / _` | [{PRIMARY_COLOR}]         #####          [/]
79	            | |___  | (_) | | | | | |  __/ | (_| | [{PRIMARY_COLOR}]         .#### .        [/]
80	             \____|  \___/  |_| |_|  \___|  \__,_| [{PRIMARY_COLOR}]           .## ###      [/]
81	                                                   [{PRIMARY_COLOR}]               ###.     [/]
82	                 Website: [{PRIMARY_COLOR}][link=https://coiled.io?utm_source=coiled-hello&utm_medium=banner]https://coiled.io[/link][/{PRIMARY_COLOR}]        [{PRIMARY_COLOR}]             # ###      [/]
83	                 Docs: [{PRIMARY_COLOR}][link=https://docs.coiled.io?utm_source=coiled-hello&utm_medium=banner]https://docs.coiled.io[/link][/{PRIMARY_COLOR}]      [{PRIMARY_COLOR}]            ## ##.      [/]
84	                                                   [{PRIMARY_COLOR}]            ##          [/]
85	                                                   [{PRIMARY_COLOR}]             #          [/][/bold]
86	""".strip()  # noqa

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/hello/hello.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
294	                Panel(
295	                    Markdown("""
296	Yee-haw you've done all my examples ðŸŽ‰  

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/hello/utils.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
221	                Markdown(
222	                    f"""
223	We're about to run a fun Python example on the cloud.  

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
492	                            # hammering ctrl-C
493	                            signal.signal(signal.SIGINT, signal_handler_noop)
494	                            break

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/notebook/notebook.py:493
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
492	                            # hammering ctrl-C
493	                            signal.signal(signal.SIGINT, signal_handler_noop)
494	                            break

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/run.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
83	    if mode:
84	        connection.sftp().chmod(path, mode)
85	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/run.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	                    with open(implicit_file) as f:
184	                        contents = f.read()
185	                    callstack.append({"code": contents, "filename": implicit_file})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/amp.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	
61	    api_endpoint = f"https://aps-workspaces.{region}.amazonaws.com/workspaces/{workspace_id}"
62	    created_info["api_endpoint"] = api_endpoint

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/aws.py:828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
827	    instruction_text = (
828	        "Run setup from AWS CloudShell with the following steps:\n\n"
829	        "1. Go to [link]https://console.aws.amazon.com/cloudshell[/link]\n"
830	        "2. Sign in to your AWS account\n"
831	        "   (if you usually switch role or profile, you should do this)\n"
832	        "3. Run the following command in CloudShell:\n\n"
833	        f"  [green]{cli_command}[/green]\n"
834	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/aws.py:1015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1014	        resource_strings.append(
1015	            "\nDocumentation for IAM Policies at "
1016	            "[link]https://docs.coiled.io/user_guide/aws_configure.html#create-iam-policies[/link]"
1017	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/aws.py:1141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1140	
1141	    message = f"""
1142	[bold]Setup complete ðŸŽ‰[/bold]
1143	
1144	You can configure networking and other options for your account at
1145	[link]{region_ui_url}[/link]
1146	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/aws.py:1457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1456	                print(
1457	                    "If you don't have access to an AWS profile with these permissions, you may need to ask "
1458	                    "someone with administrative access to your AWS account to help you create the IAM User "
1459	                    "and IAM Policies described in our documentation: "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/aws.py:1767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1766	    if case_id:
1767	        return f"https://support.console.aws.amazon.com/support/home#/case/?displayId={case_id}"
1768	    return "https://support.console.aws.amazon.com/support/home#/case/history"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/aws.py:1768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1767	        return f"https://support.console.aws.amazon.com/support/home#/case/?displayId={case_id}"
1768	    return "https://support.console.aws.amazon.com/support/home#/case/history"
1769	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/azure.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	        print(
220	            "See [link=https://learn.microsoft.com/en-us/cli/azure/install-azure-cli]"
221	            "https://learn.microsoft.com/en-us/cli/azure/install-azure-cli[/link] "
222	            "for Azure CLI installation instructions."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/azure.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
236	            print(
237	                "See [link=https://learn.microsoft.com/en-us/cli/azure/install-azure-cli]"
238	                "https://learn.microsoft.com/en-us/cli/azure/install-azure-cli[/link] "
239	                "for Azure CLI installation instructions."

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/azure.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
284	        with open(path, "w") as f:
285	            f.write(bash_script(coiled_account, sub_id, rg_name))
286	            print(f"Saved [bold]Coiled setup script[/bold] as [green]{path}")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/azure.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
389	        }
390	        cloud._sync_request(setup_endpoint, method="POST", json=setup_data)
391	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/azure.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
394	            # did it work?
395	            print(cloud._sync_request(setup_endpoint))
396	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/azure.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
487	        print(
488	            "[red]No Resource Groups were found[/red]\n\n"
489	            "To run Coiled in your Azure subscription, you'll need to create a Resource Group.\n"
490	            "You can do this in the Azure Portal at:\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/azure.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
576	def get_temporary_creds_to_submit(local_credentials):
577	    scope = "https://management.azure.com/.default"
578	    token_creds = local_credentials.get_token(scope)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/azure.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
662	        # note that this prints error if there aren't creds
663	        token_creds = local_credentials.get_token("https://graph.microsoft.com/.default")
664	    except ClientAuthenticationError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/azure.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
667	        result = client.get(
668	            "https://graph.microsoft.com/v1.0/me?$select=id,userPrincipalName",
669	            headers={"Authorization": f"Bearer {token_creds.token}"},
670	        )
671	    return result.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/entry.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	        print(
77	            "\nYou can easily set up a free account with AWS or GCP.\n\n"
78	            "[green]AWS[/green]: [link]https://aws.amazon.com/free[/link]\n"
79	            "[green]GCP[/green]: [link]https://cloud.google.com/free/[/link]\n\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	            print()
210	            print(f"[link]https://console.cloud.google.com/billing?project={project}")
211	            print()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
541	            with open(export_path, "w") as f:
542	                f.write(CONTROL_PLANE_ROLE)
543	            print(f"Exported Coiled role definition to {export_path}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
546	            with open(export_path, "w") as f:
547	                f.write(DATA_ROLE)
548	            print(f"Exported Coiled 'data access' role definition to {export_path}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
560	
561	        print("For more information, see [link]https://docs.coiled.io/user_guide/setup/gcp/cli.html[/link]")
562	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
630	        with open(main_file, "w") as f:
631	            f.write(CONTROL_PLANE_ROLE)
632	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
634	        with open(data_file, "w") as f:
635	            f.write(DATA_ROLE)
636	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
804	        data_role_console_link = (
805	            "https://console.cloud.google.com/iam-admin/roles/details/"
806	            f"projects%3C{project}%3Croles%3C{data_role}?project={project}"
807	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/gcp.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
921	    return (
922	        "https://console.cloud.google.com/iam-admin/quotas"
923	        f"?project={project}"
924	        "&pageState=(%22allQuotasTable%22:"
925	        "(%22f%22:%22%255B%257B_22k_22_3A_22Quota_22_2C_22t_22_3A10_2C_22v_22_3A_22_5C_22_5C_5C_5C_22"
926	        "CPUs_5C_5C_5C_22_5C_22_22_2C_22i_22_3A_22displayName_22%257D_2C%257B_22k_22_3A_22_22_2C_22t_"
927	        f"22_3A10_2C_22v_22_3A_22_5C_22region_3A{region}_5C_22_22_2C_22s_22_3Atrue%257D_2C%257B_22k"
928	        "_22_3A_22_22_2C_22t_22_3A10_2C_22v_22_3A_22_5C_22OR_5C_22_22_2C_22o_22_3Atrue%257D_2C%257B_"
929	        "22k_22_3A_22Quota_22_2C_22t_22_3A10_2C_22v_22_3A_22_5C_22"
930	        f"{disk_quota}_5C_22_22_2C_22s_22_3Atrue_2C_22i_22_3A_22"
931	        "displayName_22%257D_2C%257B_22k_22_3A_22_22_2C_22t_22_3A10_2C_22v_22_3A_22_5C_22"
932	        f"region_3A{region}_5C_22_22_2C_22s_22_3Atrue%257D_2C%257B_22k_22_3A_22_22_2C_22t_22_"
933	        "3A10_2C_22v_22_3A_22_5C_22OR_5C_22_22_2C_22o_22_3Atrue%257D_2C%257B_22k_22_3A_22"
934	        f"Quota_22_2C_22t_22_3A10_2C_22v_22_3A_22_5C_22{ip_quota}_5C_22_22_2C_"
935	        "22s_22_3Atrue_2C_22i_22_3A_22displayName_22%257D_2C%257B_22k_22_3A_22_22_2C_22t_22_3A10_"
936	        f"2C_22v_22_3A_22_5C_22region_3A{region}_5C_22_22_2C_22s_22_3Atrue%257D%255D%22,%22s%22:%5B"
937	        "(%22i%22:%22displayName%22,%22s%22:%220%22),"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/prometheus.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
81	    with open(filename, "w") as f:
82	        f.write(yaml_string)
83	    print(f"saved yaml as {filename}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/setup/util.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	
3	SUCCESS_MESSAGE = """
4	[bold]Setup complete ðŸŽ‰[/bold]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/cli/sync.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        print(
80	            "[bold red]"
81	            "mutagen must be installed to synchronize files with notebooks.[/]\n"
82	            "Install via homebrew (on macOS, Linux, or Windows) with:\n\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/context.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	        params["end"] = str(int(fuzzed.timestamp() * 1000))
63	    return f"https://app.datadoghq.com/apm/traces?{urlencode(params)}"
64	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
408	        """
409	        return await self._do_request(*args, ensure_running=ensure_running, **kwargs)
410	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
425	        session = self._ensure_session(ensure_running)
426	        response = await session.request(*args, **kwargs)
427	        return response

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
500	        if self.session:
501	            await self.session.close()
502	        self.status = "closed"

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
524	    async def __aexit__(self: Cloud[Async], typ, value, tb) -> None:
525	        await self._close()
526	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
530	    def __exit__(self: Cloud[Sync], typ, value, tb) -> None:
531	        self.close()
532	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
575	        if workspace not in self.accounts:
576	            await self._close()
577	            if workspace:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
694	        logger.debug(f"Starting upload for {package_name}")
695	        package_bytes = package_file.read()
696	        # s3 expects the md5 to be base64 encoded

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
696	        # s3 expects the md5 to be base64 encoded
697	        wheel_md5 = base64.b64encode(md5(package_bytes).digest()).decode("utf-8")
698	        workspace = workspace or self.default_workspace

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:697
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
696	        # s3 expects the md5 to be base64 encoded
697	        wheel_md5 = base64.b64encode(md5(package_bytes).digest()).decode("utf-8")
698	        workspace = workspace or self.default_workspace

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
699	
700	        response = await self._do_request(
701	            "POST",
702	            self.server + f"/api/v2/software-environment/account/{workspace}/package-upload",
703	            json={
704	                "name": package_name,
705	                "md5": contents_md5,
706	                "wheel_md5": wheel_md5,
707	                "region_name": region_name,
708	            },

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
946	                    else:
947	                        log_output.write("--- Logs from remote build follow ---\n")
948	                        final_state = await self._tail_software_build_logs(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
954	                        )
955	                        log_output.write(f"--- Logs end, may be truncated, see {info_url} for full output ---\n")
956	                        if final_state == "error":

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:969
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
968	    ) -> List[ApproximatePackageResult]:
969	        response = await self._do_request(
970	            "POST",
971	            f"{self.server}/api/v2/software-environment/approximate-packages",
972	            json={
973	                "architecture": architecture,
974	                "packages": packages,
975	                "metadata": {
976	                    "base_prefix": sys.base_prefix,
977	                    "platform": platform.platform(),
978	                    "prefix": sys.prefix,
979	                    "sys_path": sys.path,
980	                },
981	                "index_urls": get_index_urls(),
982	                "pip_check_errors": pip_check_errors,
983	                "gpu_enabled": gpu_enabled,
984	            },

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1001	        for log in logs["events"]:
1002	            log_output.write(log["message"] + "\n")
1003	            printed_logs.add(log["eventId"])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1010
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1009	                    if log["eventId"] not in printed_logs:
1010	                        log_output.write(log["message"] + "\n")
1011	                        printed_logs.add(log["eventId"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1022	        workspace = workspace or self.default_workspace
1023	        resp = await self._do_request(
1024	            "GET",
1025	            self.server + f"/api/v2/software-environment/account/{workspace}/build/{senv_build_id}",
1026	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1039	            params["pageToken"] = page_token
1040	        resp = await self._do_request(
1041	            "GET",
1042	            self.server + f"/api/v2/software-environment/account/{workspace}/build/logs/{senv_build_id}",
1043	            params=params,
1044	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1075	            payload["raw_pip"] = senv["raw_pip"]
1076	        resp = await self._do_request(
1077	            "POST",
1078	            self.server + f"/api/v2/software-environment/account/{workspace}",
1079	            json=payload,
1080	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1097
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1096	            data["expiry"] = expiry.isoformat()
1097	        response = await self._do_request(
1098	            "POST",
1099	            self.server + "/api/v1/api-tokens/",
1100	            json=data,
1101	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1120	    async def _list_api_tokens_page(self, page: int) -> Tuple[Dict[str, dict], str | None]:
1121	        response = await self._do_request(
1122	            "GET",
1123	            self.server + "/api/v1/api-tokens/",
1124	            params={"page": page},
1125	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1157	
1158	        response = await self._do_request(
1159	            "DELETE",
1160	            self.server + f"/api/v1/api-tokens/{identifier}/revoke",
1161	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1208	        workspace = workspace or self.default_workspace
1209	        response = await self._do_request(
1210	            "GET",
1211	            self.server + f"/api/v2/software-environment/account/{workspace}/alias",
1212	            params={"offset": offset},
1213	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1223	        workspace = workspace or self.default_workspace
1224	        response = await self._do_request(
1225	            "GET",
1226	            self.server + f"/api/v1/{workspace}/software_environments/",
1227	            params={"page": page},
1228	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1302	        }
1303	        response = await self._do_request(
1304	            "POST",
1305	            self.server + f"/api/v2/cloud-credentials/{account}/gcp",
1306	            json=payload,
1307	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1317	        account = account or self.default_workspace
1318	        response = await self._do_request(
1319	            "DELETE",
1320	            self.server + f"/api/v2/cloud-credentials/{account}/gcp",
1321	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1331	        account = account or self.default_workspace
1332	        response = await self._do_request(
1333	            "POST",
1334	            self.server + f"/api/v2/cloud-credentials/{account}/aws",
1335	            json=aws_credentials,
1336	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1346	        account = account or self.default_workspace
1347	        response = await self._do_request(
1348	            "DELETE",
1349	            self.server + f"/api/v2/cloud-credentials/{account}/aws",
1350	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1396	
1397	        response = await self._do_request(
1398	            "GET",
1399	            f"{self.server}/api/v1/vm-types/",
1400	            params=params,
1401	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1484	            name = ":".join([name, tag])
1485	        response = await self._do_request(
1486	            "DELETE",
1487	            f"{self.server}/api/v2/software-environment/account/{workspace}/alias/name/{name}",
1488	        )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1559	        )
1560	        await ws.connect()
1561	        await ws.send_json(default_configuration_message)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1642	        account = account or self.default_workspace
1643	        response = await self._do_request(
1644	            "GET",
1645	            self.server + f"/api/v1/{account}/backend_options/",
1646	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1716	        workspace, name = self._normalize_name(name, context_workspace=workspace)
1717	        response = await self._do_request(
1718	            "GET",
1719	            self.server + f"/api/v2/software-environment/account/{workspace}/alias/name/{name}",
1720	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1728
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1727	        workspace = workspace or self.default_workspace
1728	        response = await self._do_request(
1729	            "GET",
1730	            self.server + f"/api/v2/software-environment/account/{workspace}/spec/{pk}",
1731	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1748	
1749	        response = await self._do_request("GET", f"{self.server}/api/v1/{account}/usage/cores/")
1750	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1790	    async def _noop_wait(self, duration: int):
1791	        response = await self._do_request("GET", self.server + f"/api/v1/_noop_wait/{int(duration)}")
1792	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1813	            upload_type = "private" if private else "public"
1814	            response = await self._do_request(
1815	                "POST",
1816	                f"{self.server}/api/v1/{account}/performance_reports/{upload_type}/",
1817	                data=data,
1818	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1864	        account = account or self.default_workspace
1865	        response = await self._do_request(
1866	            "GET",
1867	            f"{self.server}/api/v1/{account}/performance_reports/all/",
1868	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1908	    ) -> dict:
1909	        response = await self._do_request("GET", self.server + "/api/v1/users/me/")
1910	        if response.status >= 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1917	    async def _health_check(self) -> dict:
1918	        response = await self._do_request("GET", self.server + "/api/v1/health")
1919	        if response.status >= 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:1959
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1958	            params["page"] = page
1959	        response = await self._do_request(
1960	            "GET",
1961	            f"{self.server}/api/v1/{account}/billing-events/",
1962	            params=params,
1963	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:2034
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2033	        }
2034	        response = await self._do_request(
2035	            "POST",
2036	            f"{self.server}/api/v2/interactions/interaction",
2037	            json=data,
2038	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/core.py:2557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
2556	            with open(gcp_service_creds_file, "r") as json_file:
2557	                creds = json.load(json_file)
2558	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/credentials/google.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	                local_creds, project = google.auth.default(
51	                    scopes=[*(scopes or []), "https://www.googleapis.com/auth/cloud-platform"]
52	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/credentials/google.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
135	            with open(abs_path, "w") as f:
136	                f.write(content)
137	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/credentials/google.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
205	            with open("/scratch/.creds/gcp-oauth2-token") as f:
206	                token = f.read()
207	                if token:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/credentials/google.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
211	
212	        token = os.environ.get("CLOUDSDK_AUTH_ACCESS_TOKEN")
213	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/credentials/google.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	            # so that you can use `CoiledShippedCredentials` (with same OAuth2 token) locally and on cluster.
217	            token = os.environ.get("COILED_LOCAL_CLOUDSDK_AUTH_ACCESS_TOKEN")
218	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/credentials/google.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	
228	        result = httpx.get(f"https://oauth2.googleapis.com/tokeninfo?access_token={token}")
229	        data = result.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/credentials/google.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
227	
228	        result = httpx.get(f"https://oauth2.googleapis.com/tokeninfo?access_token={token}")
229	        data = result.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/credentials/google.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
242	            raise RefreshError(
243	                "Coiled was unable to find Google OAuth2 token on the cluster. "
244	                "See https://docs.coiled.io/user_guide/remote-data-access.html#gcp for details about shipping "
245	                "OAuth2 tokens from the client to the cluster."

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/credentials/google.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	
266	    result = httpx.get(f"https://oauth2.googleapis.com/tokeninfo?access_token={credentials.token}")
267	    return result.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/credentials/google.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	
266	    result = httpx.get(f"https://oauth2.googleapis.com/tokeninfo?access_token={credentials.token}")
267	    return result.json()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/plugins.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
22	            with open(abs_path, "w") as f:
23	                f.write(content)
24	                logger.info(f"{self.name} wrote to {abs_path}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/plugins.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	            with open(abs_path, "w") as f:
51	                f.write(content)
52	                logger.info(f"{self.name} wrote to {abs_path}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/prefect.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    _block_type_name = "Coiled Credentials"
24	    _logo_url = "https://blog.coiled.io/_static/logo.svg"
25	    _documentation_url = "https://docs.coiled.io/user_guide/labs/prefect.html"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/prefect.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    _logo_url = "https://blog.coiled.io/_static/logo.svg"
25	    _documentation_url = "https://docs.coiled.io/user_guide/labs/prefect.html"
26	    _code_example = """

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/scan.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
296	            with absolute_path.open("rb") as f:
297	                actual_hash = urlsafe_b64encode(hash_func(f.read()).digest()).strip(b"=").decode()
298	                if actual_hash == pkg_hash.value:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/scan.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
296	            with absolute_path.open("rb") as f:
297	                actual_hash = urlsafe_b64encode(hash_func(f.read()).digest()).strip(b"=").decode()
298	                if actual_hash == pkg_hash.value:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/software.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
101	        with NamedTemporaryFile("wt") as f:
102	            f.write("\n".join(pip))
103	            f.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/software_utils.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	COILED_LOCAL_PACKAGE_PREFIX = "coiled_local_"
57	DEFAULT_JSON_PYPI_URL = "https://pypi.org/pypi"
58	DEFAULT_PYPI_URL = "https://pypi.org/simple"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/software_utils.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	DEFAULT_JSON_PYPI_URL = "https://pypi.org/pypi"
58	DEFAULT_PYPI_URL = "https://pypi.org/simple"
59	LOCK_PATH = Path(os.path.expanduser("~")) / ".coiled" / "locks"

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/software_utils.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
110	# on the same thread
111	FILE_LOCK_POOL = ThreadPoolExecutor(max_workers=1)
112	THREAD_LOCK_POOL = ThreadPoolExecutor(max_workers=1)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/software_utils.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
111	FILE_LOCK_POOL = ThreadPoolExecutor(max_workers=1)
112	THREAD_LOCK_POOL = ThreadPoolExecutor(max_workers=1)
113	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/software_utils.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
301	                with open(dist_info_dir / "METADATA", "w") as f:
302	                    f.write(f"Metadata-Version: 2.1\nName: {pkg_name}\nVersion: {version}\n")
303	                with open(dist_info_dir / "WHEEL", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/software_utils.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
303	                with open(dist_info_dir / "WHEEL", "w") as f:
304	                    f.write("Wheel-Version: 1.0\nGenerator: coiled\nRoot-Is-Purelib: true\nTag: py3-none-any\n")
305	                src_path = Path(src)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/spark.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    raise ImportError(
21	        """pyspark and other libraries not installed
22	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	COILED_LOGGER_NAME = "coiled"
82	COILED_SERVER = "https://cloud.coiled.io"
83	COILED_RUNTIME_REGEX = re.compile(r"^coiled/coiled-runtime-(?P<version>\d+\-\d+\-\d+)-*")

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
193	                            pass
194	                        os.chmod(path, 0o700)
195	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:194
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
193	                            pass
194	                        os.chmod(path, 0o700)
195	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
203	                        except (IsADirectoryError, PermissionError):
204	                            cls._rmtree(path, ignore_errors=ignore_errors)
205	                    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
212	
213	            shutil.rmtree(name, onerror=onerror)
214	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
216	        def _cleanup(cls, name, warn_message, ignore_errors=False):
217	            cls._rmtree(name, ignore_errors=ignore_errors)
218	            warnings.warn(warn_message, ResourceWarning, stacklevel=2)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
221	            if self._finalizer.detach() or os.path.exists(self.name):
222	                self._rmtree(self.name, ignore_errors=self._ignore_cleanup_errors)
223	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
262	                with open(key_path, "w") as f:
263	                    f.write(self.tls_scheduler_key)
264	                with open(cert_path, "w") as f:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
262	                with open(key_path, "w") as f:
263	                    f.write(self.tls_scheduler_key)
264	                with open(cert_path, "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
264	                with open(cert_path, "w") as f:
265	                    f.write(self.tls_scheduler_cert)
266	                ctx = ssl.create_default_context(purpose=ssl.Purpose.SERVER_AUTH, cafile=cert_path)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
264	                with open(cert_path, "w") as f:
265	                    f.write(self.tls_scheduler_cert)
266	                ctx = ssl.create_default_context(purpose=ssl.Purpose.SERVER_AUTH, cafile=cert_path)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
387	async def _fetch_data(*, session, server, endpoint):
388	    response = await session.request("GET", f"{server}{endpoint}")
389	    if response.status == 426:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
600	        with open(config_file, "w") as f:
601	            f.write(yaml.dump(config))
602	    except OSError as e:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
600	        with open(config_file, "w") as f:
601	            f.write(yaml.dump(config))
602	    except OSError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
628	        with self._screen_lock:
629	            sys.stdout.write(next(self.spinner))
630	            sys.stdout.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
628	        with self._screen_lock:
629	            sys.stdout.write(next(self.spinner))
630	            sys.stdout.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
633	        with self._screen_lock:
634	            sys.stdout.write("\b")
635	            if cleanup:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
633	        with self._screen_lock:
634	            sys.stdout.write("\b")
635	            if cleanup:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
635	            if cleanup:
636	                sys.stdout.write(" ")  # overwrite spinner with blank
637	                sys.stdout.write("\r")  # move to next line

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
635	            if cleanup:
636	                sys.stdout.write(" ")  # overwrite spinner with blank
637	                sys.stdout.write("\r")  # move to next line

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
636	                sys.stdout.write(" ")  # overwrite spinner with blank
637	                sys.stdout.write("\r")  # move to next line
638	            sys.stdout.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
636	                sys.stdout.write(" ")  # overwrite spinner with blank
637	                sys.stdout.write("\r")  # move to next line
638	            sys.stdout.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
649	            self.busy = True
650	            self.thread = threading.Thread(target=self.spinner_task)
651	            self.thread.start()

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
649	            self.busy = True
650	            self.thread = threading.Thread(target=self.spinner_task)
651	            self.thread.start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
657	        else:
658	            sys.stdout.write("\r")
659	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
657	        else:
658	            sys.stdout.write("\r")
659	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
892	        params["to_ts"] = str(int(fuzzed.timestamp() * 1000))
893	    return f"https://app.datadoghq.com/logs?{urlencode(params)}"
894	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:1530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1529	                with urllib3.PoolManager() as pool:
1530	                    my_public_ip = pool.request("GET", "https://api.ipify.org").data.decode("utf-8")
1531	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:1530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1529	                with urllib3.PoolManager() as pool:
1530	                    my_public_ip = pool.request("GET", "https://api.ipify.org").data.decode("utf-8")
1531	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:1646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1645	    skip_dirs = set()
1646	    if platform.system() == "Darwin":
1647	        skip_dirs = {

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:1646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
1645	    skip_dirs = set()
1646	    if platform.system() == "Darwin":
1647	        skip_dirs = {

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:1646
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
1645	    skip_dirs = set()
1646	    if platform.system() == "Darwin":
1647	        skip_dirs = {

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:1782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1781	    # Check installation directory for each OS
1782	    system = platform.system()
1783	    if system == "Linux" and sys.prefix == "/usr":

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:1782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
1781	    # Check installation directory for each OS
1782	    system = platform.system()
1783	    if system == "Linux" and sys.prefix == "/usr":

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:1782
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
1781	    # Check installation directory for each OS
1782	    system = platform.system()
1783	    if system == "Linux" and sys.prefix == "/usr":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:2011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2010	
2011	    url = f"https://hub.docker.com/v2/repositories/{name}/tags?name={tag}"
2012	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/utils.py:2015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2014	        with urllib3.PoolManager() as http:
2015	            response = http.request("GET", url)
2016	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:908
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
907	            with open(host_setup_script) as f:
908	                self.host_setup_script_content = f.read()
909	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2259	            )
2260	        elif not token_creds.get("SessionToken"):
2261	            await self._submit_cluster_event(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2264	
2265	        if token_creds and token_creds.get("SessionToken"):
2266	            scheduler_comm = self._ensure_scheduler_comm()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2276	            # so this is a way to (for now) feature flag using creds endpoint (vs. env vars)
2277	            if dask.config.get("coiled.use_aws_creds_endpoint", False):
2278	                keys.append("Expiration")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2280	            def _format_vals(k: str) -> str | None:
2281	                if k == "Expiration" and isinstance(token_creds.get("Expiration"), datetime.datetime):
2282	                    # use assert to make pyright happy since it doesn't understand that the above conditional

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2289	                # values should be str | None; make sure we don't use "None"
2290	                return str(token_creds.get(k)) if token_creds.get(k) is not None else None
2291	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2289	                # values should be str | None; make sure we don't use "None"
2290	                return str(token_creds.get(k)) if token_creds.get(k) is not None else None
2291	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2295	                "forwarding AWS credentials",
2296	                extra_data={"expiration": str(token_creds.get("Expiration"))},
2297	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2299	
2300	            if creds_to_send.get("Expiration"):
2301	                self._using_aws_creds_endpoint = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2304	                self._schedule_cred_update(
2305	                    expiration=token_creds.get("Expiration"),
2306	                    label="AWS STS token",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2313	                logger.debug("AWS STS token from local credentials shipped to cluster, no scheduled refresh")
2314	        elif dask.config.get("coiled.use_aws_creds_endpoint", False):
2315	            # since we aren't shipping local creds, remove creds endpoint in credential chain

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2330	
2331	            if gcp_token.get("token"):
2332	                await self._submit_cluster_event(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2334	                    "forwarding Google credentials",
2335	                    extra_data={"expiration": str(gcp_token.get("expiry"))},
2336	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2340	
2341	                if gcp_token.get("expiry") and schedule_callback:
2342	                    self._schedule_cred_update(expiration=gcp_token.get("expiry"), label="Google Cloud OAuth2 token")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2341	                if gcp_token.get("expiry") and schedule_callback:
2342	                    self._schedule_cred_update(expiration=gcp_token.get("expiry"), label="Google Cloud OAuth2 token")
2343	                else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2356	        """
2357	        if self.credentials is CredentialsPreferred.NONE and dask.config.get("coiled.use_aws_creds_endpoint", False):
2358	            await self._unset_env_vars(["AWS_CONTAINER_CREDENTIALS_FULL_URI"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2421	        # any events prior to cluster having an ID get queued and sent once there's an event when cluster has ID
2422	        if self.cluster_id and dask.config.get("coiled.send_client_events", True):
2423	            url = f"{self.cloud.server}/api/v2/clusters/id/{self.cluster_id}/event"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2426	                try:
2427	                    await self.cloud._do_request("POST", url, json=payload)
2428	                except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2449	            try:
2450	                state = (await self.cloud._get_cluster_state(cluster_id=self.cluster_id, workspace=self.workspace)).get(
2451	                    "state"
2452	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2467	                    check_interval = (
2468	                        dask.utils.parse_timedelta(dask.config.get("coiled.cluster-state-check-interval"))
2469	                        * 1000

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2565	            # (e.g., unique data could not be moved to any other worker), so we won't forcibly stop the VM.
2566	            scheduler_retired_names = {w.get("name") for w in scheduler_workers_retired.values()}
2567	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/cluster.py:2885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2884	    def jupyter_link(self):
2885	        if not self.scheduler_options.get("jupyter"):
2886	            logger.warning(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
202	            kwargs["user"] = user
203	        response = await self._do_request(
204	            "GET",
205	            self.server + f"/api/v2/analytics/{workspace}/clusters/list",
206	            params={
207	                "limit": page_size,
208	                "offset": page_size * page,
209	                **kwargs,
210	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
285	
286	        response = await self._do_request(
287	            "GET",
288	            self.server + api,
289	            params={"limit": page_size, "offset": page_size * page},
290	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
381	            kwargs["scheduler"] = scheduler_id
382	        response = await self._do_request(
383	            "GET",
384	            self.server + f"/api/v2/analytics/{workspace}/exceptions/list",
385	            params={"limit": page_size, "offset": page_size * page, **kwargs},
386	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
401	        workspace = workspace or self.default_workspace
402	        response = await self._do_request(
403	            "GET",
404	            self.server + f"/api/v2/analytics/{workspace}/{cluster_id}/events/list",
405	            params={"limit": page_size, "offset": page_size * page},
406	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
426	        workspace = workspace or self.default_workspace
427	        response = await self._do_request(
428	            "POST",
429	            self.server + f"/api/v2/analytics/{workspace}/{cluster_id}/desired-state",
430	            json={"desired_status": desired_status},
431	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
482	        workspace = workspace or self.default_workspace
483	        response = await self._do_request(
484	            "GET",
485	            self.server + f"/api/v2/clusters/account/{workspace}/",
486	            params={"limit": page_size, "offset": page_size * page, "just_mine": "1" if just_mine else "0"},
487	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
567	        workspace = workspace or self.default_workspace
568	        response = await self._do_request(
569	            "POST",
570	            self.server + f"/api/v2/clusters/account/{workspace}/https-certificate",
571	            json={"subdomain": subdomain},
572	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
576	    async def _check_custom_certificate(self, subdomain: str, workspace: str | None = None):
577	        response = await self._do_request(
578	            "GET",
579	            self.server + f"/api/v2/clusters/account/{workspace}/https-certificate/{subdomain}",
580	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
701	
702	        response = await self._do_request(
703	            "POST",
704	            self.server + f"/api/v2/clusters/account/{account}/",
705	            json=data,
706	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
723	                        # the user setup their cloud backend, so let's try creating cluster again!
724	                        response = await self._do_request(
725	                            "POST",
726	                            self.server + f"/api/v2/clusters/account/{account}/",
727	                            json=data,
728	                        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
903	        session = self._ensure_session()
904	        response = await session.request(
905	            "GET", self.server + f"/api/v2/clusters/account/{workspace}/id/{cluster_id}/state"
906	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
985	
986	        response = await self._do_request(
987	            "GET",
988	            self.server + f"/api/v2/workers/account/{workspace}/cluster/{cluster_id}/",
989	            params={"limit": page_size, "offset": page_size * page},
990	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1067	
1068	        response = await self._do_request(
1069	            "GET",
1070	            self.server + f"/api/v2/clusters/account/{workspace}/name/{name}",
1071	            params={"include_paused": int(include_paused)},
1072	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1183	
1184	        response = await self._do_request(
1185	            "GET",
1186	            self.server + f"/api/v2/clusters/account/{workspace}/",
1187	            params={"name": name},
1188	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1296	    async def _instance_logs(self, workspace: str, instance_name: str, safe=True) -> Log:
1297	        response = await self._do_request(
1298	            "GET",
1299	            self.server + "/api/v2/instances/{}/instance/{}/logs".format(workspace, instance_name),
1300	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1429	
1430	        response = await self._do_request(
1431	            "GET",
1432	            f"{self.server}{url_path}",
1433	            params=url_params,
1434	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1475	            data["reason"] = reason  # type: ignore
1476	        response = await self._do_request(
1477	            "POST", f"{self.server}/api/v2/workers/account/{workspace}/cluster/{cluster_id}/", json=data
1478	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1493	        reason_dict = {"reason": reason} if reason else {}
1494	        response = await self._do_request(
1495	            "DELETE",
1496	            f"{self.server}/api/v2/workers/account/{workspace}/cluster/{cluster_id}/",
1497	            params={"name": workers, **reason_dict},
1498	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1522	        workspace = workspace or self.default_workspace
1523	        response = await self._do_request("GET", f"{self.server}/api/v2/packages/", params={"account": workspace})
1524	        if response.status >= 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1548	
1549	        response = await self._do_request("GET", url, params={"worker": worker} if worker else None)
1550	        if response.status >= 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1576	
1577	        response = await self._do_request("GET", url)
1578	        if response.status >= 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1600	
1601	        response = await self._do_request("GET", url, params=params)
1602	        if response.status >= 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/coiled-1.90.6.dev4/coiled-1.90.6.dev4/coiled/v2/core.py:1612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1611	
1612	        response = await self._do_request("POST", url, json=data)
1613	        if response.status >= 400:

--------------------------------------------------

Code scanned:
	Total lines of code: 21519
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 51.0
		High: 159.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 199.0
		High: 11.0
Files skipped (0):
