Run started:2025-05-25 13:22:42.215343

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/api/fuse.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	        GITHUB_CONTENT_TAG_URL = (
34	            "https://raw.githubusercontent.com/databrickslabs/mosaic/main"
35	        )
36	        script_url = f"{GITHUB_CONTENT_TAG_URL}/scripts/0.4.2/{self.script_in_name}"
37	        script = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/api/fuse.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	            with requests.Session() as s:
41	                script = s.get(script_url, allow_redirects=True).text
42	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/api/fuse.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	                    GITHUB_RELEASE_URL_BASE = (
83	                        "https://github.com/databrickslabs/mosaic/releases"
84	                    )
85	                    latest = None
86	                    with requests.Session() as s:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/api/fuse.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	                        latest = str(
88	                            s.get(
89	                                f"{GITHUB_RELEASE_URL_BASE}/latest",
90	                                allow_redirects=True,
91	                            ).content

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/api/fuse.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	                    with requests.Session() as s:
100	                        r = s.get(
101	                            f"{GITHUB_RELEASE_URL_BASE}/download/v_{resource_version}/{jar_filename}",
102	                            stream=True,
103	                        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/api/fuse.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
105	                            for ch in r.iter_content(chunk_size=CHUNK_SIZE):
106	                                f.write(ch)
107	                        resource_statuses[jar_filename] = r.status_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/api/fuse.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	                            so_path = f"{self.to_fuse_dir}/{so_filename}"
133	                            r = s.get(
134	                                f"{GITHUB_CONTENT_TAG_URL}/resources/gdal/jammy/{so_filename}",
135	                                stream=True,
136	                            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/api/fuse.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	                                for ch in r.iter_content(chunk_size=CHUNK_SIZE):
139	                                    f.write(ch)
140	                            resource_statuses[so_filename] = r.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/api/fuse.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	        print(
161	            f"               more at https://docs.databricks.com/en/init-scripts/cluster-scoped.html"
162	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/resources/__init__.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
7	with open(mosaic_logo_path, "rb") as fh:
8	    mosaic_logo_b64str = base64.b64encode(fh.read()).decode("utf-8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/resources/__init__.py:8
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
7	with open(mosaic_logo_path, "rb") as fh:
8	    mosaic_logo_b64str = base64.b64encode(fh.read()).decode("utf-8")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/resources/__init__.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	with open(mosaic_logo_path, "rb") as fh:
8	    mosaic_logo_b64str = base64.b64encode(fh.read()).decode("utf-8")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/mosaic/utils/notebook_utils.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
8	            with open("./mosaic_kepler_view.html", "w") as f:
9	                f.write(html)
10	        print(html)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/test_raster_functions.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
121	            .withColumn(
122	                "rst_write", api.rst_write("tile", lit("/mnt/mosaic_tmp/write-tile"))
123	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/test_raster_functions.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
200	        census_df = (
201	            readers.read()
202	            .format("multi_read_ogr")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/test_raster_functions.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
263	        points_df = (
264	            readers.read()
265	            .format("multi_read_ogr")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/test_raster_functions.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
275	        lines_df = (
276	            readers.read()
277	            .format("multi_read_ogr")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/utils/mosaic_test_case_with_gdal.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
38	        if cls.check_dir is not None and os.path.exists(cls.check_dir):
39	            shutil.rmtree(cls.check_dir)
40	        if cls.new_check_dir is not None and os.path.exists(cls.new_check_dir):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/utils/mosaic_test_case_with_gdal.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
40	        if cls.new_check_dir is not None and os.path.exists(cls.new_check_dir):
41	            shutil.rmtree(cls.new_check_dir)
42	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/utils/setup_fuse.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
18	    def __del__(self):
19	        shutil.rmtree(self._temp_dir)
20	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/utils/setup_fuse.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
33	        )
34	        os.chmod(fuse_install_script_target, mode=0x744)
35	        result = subprocess.run(

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/utils/setup_fuse.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
33	        )
34	        os.chmod(fuse_install_script_target, mode=0x744)
35	        result = subprocess.run(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/utils/setup_gdal.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
15	    def __del__(self):
16	        shutil.rmtree(self._temp_dir)
17	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/databricks_mosaic-0.4.3/databricks_mosaic-0.4.3/test/utils/spark_test_case.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
53	        if cls.tmp_dir is not None and os.path.exists(cls.tmp_dir):
54	            shutil.rmtree(cls.tmp_dir)
55	

--------------------------------------------------

Code scanned:
	Total lines of code: 5660
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 19.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 2.0
Files skipped (0):
