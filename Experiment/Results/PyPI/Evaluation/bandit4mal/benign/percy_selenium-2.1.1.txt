Run started:2025-05-25 13:51:52.128430

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
18	# Maybe get the CLI API address from the environment
19	PERCY_CLI_API = os.environ.get('PERCY_CLI_API') or 'http://localhost:5338'
20	PERCY_DEBUG = os.environ.get('PERCY_LOGLEVEL') == 'debug'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	# Maybe get the CLI API address from the environment
19	PERCY_CLI_API = os.environ.get('PERCY_CLI_API') or 'http://localhost:5338'
20	PERCY_DEBUG = os.environ.get('PERCY_LOGLEVEL') == 'debug'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	PERCY_CLI_API = os.environ.get('PERCY_CLI_API') or 'http://localhost:5338'
20	PERCY_DEBUG = os.environ.get('PERCY_LOGLEVEL') == 'debug'
21	RESONSIVE_CAPTURE_SLEEP_TIME = os.environ.get('RESONSIVE_CAPTURE_SLEEP_TIME')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	PERCY_DEBUG = os.environ.get('PERCY_LOGLEVEL') == 'debug'
21	RESONSIVE_CAPTURE_SLEEP_TIME = os.environ.get('RESONSIVE_CAPTURE_SLEEP_TIME')
22	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
30	    try:
31	        requests.post(f'{PERCY_CLI_API}/percy/log',
32	                    json={'message': message, 'level': lvl}, timeout=1)
33	    except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	    try:
44	        response = requests.get(f'{PERCY_CLI_API}/percy/healthcheck', timeout=30)
45	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	        data = response.json()
47	        session_type =  data.get('type', None)
48	        widths = data.get('widths', {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	        session_type =  data.get('type', None)
48	        widths = data.get('widths', {})
49	        config = data.get('config', {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	        widths = data.get('widths', {})
49	        config = data.get('config', {})
50	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	        if not data['success']: raise Exception(data['error'])
52	        version = response.headers.get('x-percy-core-version')
53	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	        if not version:
55	            print(f'{LABEL} You may be using @percy/agent '
56	                  'which is no longer supported by this SDK. '

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	def fetch_percy_dom():
78	    response = requests.get(f'{PERCY_CLI_API}/percy/dom.js', timeout=30)
79	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	def get_widths_for_multi_dom(eligible_widths, **kwargs):
88	    user_passed_widths = kwargs.get('widths', [])
89	    width = kwargs.get('width')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	    user_passed_widths = kwargs.get('widths', [])
89	    width = kwargs.get('width')
90	    if width: user_passed_widths = [width]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	    # Deep copy mobile widths otherwise it will get overridden
93	    allWidths = eligible_widths.get('mobile', [])[:]
94	    if len(user_passed_widths) != 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	    else:
97	        allWidths.extend(eligible_widths.get('config', []))
98	    return list(set(allWidths))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	    # Don't run resposive snapshot capture when defer uploads is enabled
144	    if 'percy' in config and config['percy'].get('deferUploads', False): return False
145	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	
146	    return kwargs.get('responsive_snapshot_capture', False) or kwargs.get(
147	            'responsiveSnapshotCapture', False) or (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	
146	    return kwargs.get('responsive_snapshot_capture', False) or kwargs.get(
147	            'responsiveSnapshotCapture', False) or (
148	                'snapshot' in config and config['snapshot'].get('responsiveSnapshotCapture'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	            'responsiveSnapshotCapture', False) or (
148	                'snapshot' in config and config['snapshot'].get('responsiveSnapshotCapture'))
149	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	
155	    if data['session_type'] == "automate": raise Exception("Invalid function call - "\
156	      "percy_snapshot(). Please use percy_screenshot() function while using Percy with Automate. "\

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
171	        # Post the DOM to the snapshot endpoint with snapshot options and other info
172	        response = requests.post(f'{PERCY_CLI_API}/percy/snapshot', json={**kwargs, **{
173	            'client_info': CLIENT_INFO,
174	            'environment_info': ENV_INFO,
175	            'dom_snapshot': dom_snapshot,
176	            'url': driver.current_url,
177	            'name': name
178	        }}, timeout=600)
179	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	        if not data['success']: raise Exception(data['error'])
185	        return data.get("data", None)
186	    except Exception as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	
196	    if data['session_type'] != "automate": raise Exception("Invalid function call - "\
197	      "percy_screenshot(). Please use percy_snapshot() function for taking screenshot. "\

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	        ignore_region_elements = get_element_ids(
216	            options.get("ignore_region_selenium_elements", [])
217	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	        consider_region_elements = get_element_ids(
219	            options.get("consider_region_selenium_elements", [])
220	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
226	        # Post to automateScreenshot endpoint with driver options and other info
227	        response = requests.post(f'{PERCY_CLI_API}/percy/automateScreenshot', json={**kwargs, **{
228	            'client_info': CLIENT_INFO,
229	            'environment_info': ENV_INFO,
230	            'sessionId': metadata.session_id,
231	            'commandExecutorUrl': metadata.command_executor_url,
232	            'capabilities': metadata.capabilities,
233	            'snapshotName': name,
234	            'options': options
235	        }}, timeout=600)
236	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/percy/snapshot.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	        if not data['success']: raise Exception(data['error'])
242	        return data.get("data", None)
243	    except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	with open(path.join(cwd, 'README.md'), encoding='utf-8') as f:
8	    long_description = f.read()
9	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/setup.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    author_email='team@percy.io',
19	    url='https://github.com/percy/percy-selenium-python',
20	    keywords='selenium percy visual testing',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_cache.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        self.session_id = 'session_id_123'
11	        self.command_executor_url = 'https://example-hub:4444/wd/hub'
12	        self.capabilities = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_driver_metadata.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	        self.mock_webdriver.session_id = 'session_id_123'
15	        self.mock_webdriver.command_executor._url = 'https://example-hub:4444/wd/hub' # pylint: disable=W0212
16	        self.mock_webdriver.capabilities = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_driver_metadata.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    def test_command_executor_url(self):
39	        url = 'https://example-hub:4444/wd/hub'
40	        self.assertEqual(self.metadata.command_executor_url, url)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
26	        self.end_headers()
27	        self.wfile.write(('Snapshot Me').encode('utf-8'))
28	    def log_message(self, format, *args):

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
41	# daemon threads automatically shut down when the main process exits
42	mock_server = HTTPServer(('localhost', 8000), MockServerRequestHandler)
43	mock_server_thread = Thread(target=mock_server.serve_forever)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	mock_server = HTTPServer(('localhost', 8000), MockServerRequestHandler)
43	mock_server_thread = Thread(target=mock_server.serve_forever)
44	mock_server_thread.daemon = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	    httpretty.register_uri(
72	        httpretty.GET, 'http://localhost:5338/percy/healthcheck',
73	        body=health_body,
74	        adding_headers=health_headers,
75	        status=health_status)
76	    httpretty.register_uri(
77	        httpretty.GET, 'http://localhost:5338/percy/dom.js',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	    httpretty.register_uri(
77	        httpretty.GET, 'http://localhost:5338/percy/dom.js',
78	        body='window.PercyDOM = \
79	         { serialize: () => { return { html: document.documentElement.outerHTML } }, \
80	           waitForResize: () => { if(!window.resizeCount) { window.addEventListener(\'resize\',\
81	             () => window.resizeCount++) } window.resizeCount = 0; }}',
82	        status=200)
83	
84	def mock_snapshot(fail=False, data=False):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	    httpretty.register_uri(
86	        httpretty.POST, 'http://localhost:5338/percy/snapshot',
87	        body = json.dumps({
88	            "success": "false" if fail else "true",
89	            "error": "test" if fail else None,
90	            "data": data_object if data else None
91	        }),
92	        status=(500 if fail else 200))
93	
94	def mock_logger():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	    httpretty.register_uri(
96	        httpretty.POST, 'http://localhost:5338/percy/log',
97	        body = json.dumps({ "success": "true" }),
98	        status=200
99	    )
100	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
103	    httpretty.register_uri(
104	        httpretty.POST, 'http://localhost:5338/percy/automateScreenshot',
105	        body = json.dumps({
106	            "success": not fail,
107	            "error": "test" if fail else None,
108	            "data": data_object if data else None
109	        }),
110	        status=(500 if fail else 200))
111	
112	class TestPercySnapshot(unittest.TestCase):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	        local.fetch_percy_dom.cache_clear()
127	        self.driver.get('http://localhost:8000')
128	        self.driver.delete_all_cookies()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	        local.fetch_percy_dom.cache_clear()
127	        self.driver.get('http://localhost:8000')
128	        self.driver.delete_all_cookies()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
151	
152	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
153	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
151	
152	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
153	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
162	
163	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
164	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
162	
163	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
164	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	            mock_print.assert_called_with(
173	                f'{LABEL} You may be using @percy/agent which is no longer supported by this SDK. '
174	                'Please uninstall @percy/agent and install @percy/cli instead. '

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
176	
177	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
178	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
176	
177	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
178	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
188	
189	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
190	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
188	
189	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
190	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
192	        self.assertEqual(s1['name'], 'Snapshot 1')
193	        self.assertEqual(s1['url'], 'http://localhost:8000/')
194	        self.assertEqual(s1['dom_snapshot'], { 'cookies': expected_cookies,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
211	
212	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
213	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
211	
212	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
213	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
215	        self.assertEqual(s1['name'], 'Snapshot 1')
216	        self.assertEqual(s1['url'], 'http://localhost:8000/')
217	        self.assertEqual(s1['dom_snapshot'], {

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
251	
252	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
253	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
251	
252	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
253	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
255	        self.assertEqual(s1['name'], 'Snapshot 1')
256	        self.assertEqual(s1['url'], 'http://localhost:8000/')
257	        self.assertEqual(s1['dom_snapshot'], expected_dom_snapshot)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
285	
286	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
287	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
285	
286	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
287	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
289	        self.assertEqual(s1['name'], 'Snapshot 1')
290	        self.assertEqual(s1['url'], 'http://localhost:8000/')
291	        self.assertEqual(s1['dom_snapshot'], expected_dom_snapshot)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
310	
311	        with patch.object(driver, 'current_url', 'http://localhost:8000/'):
312	            with patch.object(driver, 'capabilities', new={ 'browserName': 'chrome' }):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
314	
315	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
316	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
314	
315	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
316	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
318	        self.assertEqual(s1['name'], 'Snapshot 1')
319	        self.assertEqual(s1['url'], 'http://localhost:8000/')
320	        self.assertEqual(s1['dom_snapshot'], expected_dom_snapshot)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
327	
328	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
329	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
327	
328	        self.assertEqual(httpretty.last_request().path, '/percy/snapshot')
329	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
331	        self.assertEqual(s1['name'], 'Snapshot')
332	        self.assertEqual(s1['url'], 'http://localhost:8000/')
333	        self.assertEqual(s1['dom_snapshot'], {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
354	
355	        self.assertEqual("Invalid function call - "\
356	        "percy_snapshot(). Please use percy_screenshot() function while using Percy with Automate."\
357	        " For more information on usage of PercyScreenshot, refer https://www.browserstack.com"\
358	        "/docs/percy/integrate/functional-and-visual", str(context.exception))
359	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
371	        driver.command_executor = Mock(spec=mock_connection)
372	        driver.command_executor._url = 'https://hub-cloud.browserstack.com/wd/hub' # pylint: disable=W0212
373	        return driver

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
380	        local.is_percy_enabled.cache_clear()
381	        self.driver.get('http://localhost:8000')
382	        httpretty.enable()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
380	        local.is_percy_enabled.cache_clear()
381	        self.driver.get('http://localhost:8000')
382	        httpretty.enable()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
404	
405	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
406	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
404	
405	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
406	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
415	
416	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
417	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
415	
416	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
417	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
425	            mock_print.assert_called_with(
426	                f'{LABEL} You may be using @percy/agent which is no longer supported by this SDK. '
427	                'Please uninstall @percy/agent and install @percy/cli instead. '

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
429	
430	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
431	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
429	
430	        self.assertEqual(httpretty.last_request().path, '/percy/healthcheck')
431	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
475	
476	        self.assertEqual(httpretty.last_request().path, '/percy/automateScreenshot')
477	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
475	
476	        self.assertEqual(httpretty.last_request().path, '/percy/automateScreenshot')
477	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
520	
521	        self.assertEqual("Invalid function call - "\
522	        "percy_screenshot(). Please use percy_snapshot() function for taking screenshot. "\
523	        "percy_screenshot() should be used only while using Percy with Automate. "\
524	        "For more information on usage of percy_snapshot(), refer doc for your language "\
525	        "https://www.browserstack.com/docs/percy/integrate/overview", str(context.exception))
526	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
527	def get_percy_test_requests():
528	    response = requests.get('http://localhost:5338/test/requests', timeout=10)
529	    data = response.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
527	def get_percy_test_requests():
528	    response = requests.get('http://localhost:5338/test/requests', timeout=10)
529	    data = response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
546	        local.fetch_percy_dom.cache_clear()
547	        self.driver.get('http://localhost:8000')
548	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
546	        local.fetch_percy_dom.cache_clear()
547	        self.driver.get('http://localhost:8000')
548	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/percy_selenium-2.1.1/percy_selenium-2.1.1/tests/test_snapshot.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
555	        self.assertEqual(s1['name'], 'Snapshot 1')
556	        self.assertEqual(s1['url'], 'http://localhost:8000/')
557	        self.assertRegex(s1['client_info'], r'percy-selenium-python/\d+')

--------------------------------------------------

Code scanned:
	Total lines of code: 848
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 58.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 88.0
		High: 0.0
Files skipped (0):
