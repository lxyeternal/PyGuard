Run started:2025-05-25 13:30:10.773230

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	DEFAULT_VERSION = "5.4.2"
40	DEFAULT_URL = "https://pypi.python.org/packages/source/s/setuptools/"
41	
42	def _python_cmd(*args):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
110	        os.chdir(old_wd)
111	        shutil.rmtree(tmpdir)
112	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	                """).format(VC_err=VC_err, version=version)
156	            sys.stderr.write(msg)
157	            sys.exit(2)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
155	                """).format(VC_err=VC_err, version=version)
156	            sys.stderr.write(msg)
157	            sys.exit(2)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
194	def has_powershell():
195	    if platform.system() != 'Windows':
196	        return False

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
194	def has_powershell():
195	    if platform.system() != 'Windows':
196	        return False

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:195
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
194	def has_powershell():
195	    if platform.system() != 'Windows':
196	        return False

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
241	    """
242	    src = urlopen(url)
243	    try:

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:242
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
241	    """
242	    src = urlopen(url)
243	    try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
244	        # Read all the data in one block.
245	        data = src.read()
246	    finally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
250	    with open(target, "wb") as dst:
251	        dst.write(data)
252	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/ez_setup.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
250	    with open(target, "wb") as dst:
251	        dst.write(data)
252	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    long_description=readme + '\n\n' + history,
20	    url="https://github.com/graingert/python-clamd",
21	    package_dir={'': 'src'},

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
20	scan_response = re.compile(r"^(?P<path>.*): ((?P<virus>.+) )?(?P<status>(FOUND|OK|ERROR))$")
21	EICAR = base64.b64decode(b'WDVPIVAlQEFQWzRcUFpYNTQoUF4pN0NDKTd9JEVJQ0FSLVNUQU5E' \
22	                b'QVJELUFOVElWSVJVUy1URVNU\nLUZJTEUhJEgrSCo=\n')

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
20	scan_response = re.compile(r"^(?P<path>.*): ((?P<virus>.+) )?(?P<status>(FOUND|OK|ERROR))$")
21	EICAR = base64.b64decode(b'WDVPIVAlQEFQWzRcUFpYNTQoUF4pN0NDKTd9JEVJQ0FSLVNUQU5E' \
22	                b'QVJELUFOVElWSVJVUy1URVNU\nLUZJTEUhJEgrSCo=\n')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
44	    """
45	    def __init__(self, host='127.0.0.1', port=3310, timeout=None):
46	        """

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:63
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
62	        try:
63	            self.clamd_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
64	            self.clamd_socket.connect((self.host, self.port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
63	            self.clamd_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
64	            self.clamd_socket.connect((self.host, self.port))
65	            self.clamd_socket.settimeout(self.timeout)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
64	            self.clamd_socket.connect((self.host, self.port))
65	            self.clamd_socket.settimeout(self.timeout)
66	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
189	                size = struct.pack(b'!L', len(chunk))
190	                self.clamd_socket.send(size + chunk)
191	                chunk = buff.read(max_chunk_size)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
192	
193	            self.clamd_socket.send(struct.pack(b'!L', 0))
194	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
231	        cmd = 'n{cmd}{args}\n'.format(cmd=cmd, args=concat_args).encode('utf-8')
232	        self.clamd_socket.send(cmd)
233	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
259	        """
260	        self.clamd_socket.close()
261	        return

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:293
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
292	        try:
293	            self.clamd_socket = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
294	            self.clamd_socket.connect(self.unix_socket)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
293	            self.clamd_socket = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
294	            self.clamd_socket.connect(self.unix_socket)
295	            self.clamd_socket.settimeout(self.timeout)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/clamd-1.0.2/clamd-1.0.2/src/clamd/__init__.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
294	            self.clamd_socket.connect(self.unix_socket)
295	            self.clamd_socket.settimeout(self.timeout)
296	        except socket.error:

--------------------------------------------------

Code scanned:
	Total lines of code: 537
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 5.0
Files skipped (0):
