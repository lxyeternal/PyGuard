Run started:2025-05-25 12:47:55.988844

Test results:
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/api_call.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
167	        """
168	        return self._execute_request(
169	            session.get,
170	            endpoint,
171	            entity_type,
172	            as_json,
173	            params=params,
174	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/api_call.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
239	        """
240	        return self._execute_request(
241	            session.post,
242	            endpoint,
243	            entity_type,
244	            as_json,
245	            params=params,
246	            data=body,
247	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/api_call.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
266	        """
267	        return self._execute_request(
268	            session.put,
269	            endpoint,
270	            entity_type,
271	            as_json=True,
272	            params=params,
273	            data=body,
274	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/api_call.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
293	        """
294	        return self._execute_request(
295	            session.patch,
296	            endpoint,
297	            entity_type,
298	            as_json=True,
299	            params=params,
300	            data=body,
301	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/api_call.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
319	        """
320	        return self._execute_request(
321	            session.delete,
322	            endpoint,
323	            entity_type,
324	            as_json=True,
325	            params=params,
326	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/api_call.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
459	            self.node_manager.set_node_health(node, is_healthy=False)
460	            return self._execute_request(
461	                fn,
462	                endpoint,
463	                entity_type,
464	                as_json,
465	                last_exception=server_error,
466	                num_retries=num_retries + 1,
467	                **kwargs,
468	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/api_call.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
478	        """Make the API request and process the response."""
479	        request_response = self.request_handler.make_request(
480	            fn=fn,
481	            url=url,
482	            as_json=as_json,
483	            entity_type=entity_type,
484	            **kwargs,
485	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/api_call.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
500	
501	        if kwargs.get("params"):
502	            self.request_handler.normalize_params(kwargs["params"])

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/keys.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
122	        params_str = json.dumps(key_parameters)
123	        digest = base64.b64encode(
124	            hmac.new(
125	                search_key.encode("utf-8"),
126	                params_str.encode("utf-8"),
127	                digestmod=hashlib.sha256,
128	            ).digest(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/keys.py:123
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
122	        params_str = json.dumps(key_parameters)
123	        digest = base64.b64encode(
124	            hmac.new(
125	                search_key.encode("utf-8"),
126	                params_str.encode("utf-8"),
127	                digestmod=hashlib.sha256,
128	            ).digest(),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/keys.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
131	        raw_scoped_key = f"{digest.decode('utf-8')}{key_prefix}{params_str}"
132	        return base64.b64encode(raw_scoped_key.encode("utf-8"))
133	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/keys.py:132
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
131	        raw_scoped_key = f"{digest.decode('utf-8')}{key_prefix}{params_str}"
132	        return base64.b64encode(raw_scoped_key.encode("utf-8"))
133	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/request_handler.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	        kwargs.setdefault("verify", self.config.verify)
215	        if kwargs.get("data") and not isinstance(kwargs["data"], (str, bytes)):
216	            kwargs["data"] = json.dumps(kwargs["data"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/request_handler.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
260	        """
261	        content_type = response.headers.get("Content-Type", "")
262	        if content_type.startswith("application/json"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/request_handler.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	        if content_type.startswith("application/json"):
263	            err_message: str = response.json().get("message", "API error.")
264	            return err_message

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/typesense-1.0.3/typesense-1.0.3/src/typesense/request_handler.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
277	        """
278	        return _ERROR_CODE_MAP.get(str(http_code), TypesenseClientError)

--------------------------------------------------

Code scanned:
	Total lines of code: 5443
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 2.0
Files skipped (0):
