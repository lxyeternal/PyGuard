Run started:2025-05-25 12:55:44.728709

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/collate_sqllineage/core/parser/sqlfluff/extractors/dml_merge_extractor.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	                if segment.type == "table_reference":
62	                    holder.add_write(SqlFluffTable.of(segment))
63	                tgt_flag = False

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/collate_sqllineage/core/parser/sqlfluff/extractors/dml_merge_extractor.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	                    direct_source = SqlFluffTable.of(segment)
67	                    holder.add_read(direct_source)
68	                elif segment.type == "bracketed":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/collate_sqllineage/core/parser/sqlfluff/extractors/dml_merge_extractor.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
77	                    )
78	                    holder.add_read(direct_source)
79	                    if direct_source.query.get_child("with_compound_statement"):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/collate_sqllineage/drawing.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
69	                with open(static_fname, "rb") as f:
70	                    text = f.read()
71	                return self.handle_200_text(start_response, mimetype, text)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/collate_sqllineage/drawing.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	                    request_body_size = int(environ["CONTENT_LENGTH"])
75	                    request_body = environ["wsgi.input"].read(request_body_size)
76	                    payload = json.loads(request_body)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	            with StringIO() as f:
24	                length = f.write(body)
25	                f.seek(0)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
32	    # 200
33	    mock_request("GET", "/")
34	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
34	    assert container.status.startswith(str(HTTPStatus.OK.value))
35	    mock_request("GET", "/manifest.json")
36	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
36	    assert container.status.startswith(str(HTTPStatus.OK.value))
37	    mock_request("POST", "/lineage", {"e": "SELECT * FROM dual", "p": 5000})
38	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
38	    assert container.status.startswith(str(HTTPStatus.OK.value))
39	    mock_request("POST", "/script", {"e": "SELECT * FROM dual", "p": 5000})
40	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
40	    assert container.status.startswith(str(HTTPStatus.OK.value))
41	    mock_request("POST", "/directory", {"f": __file__})
42	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
42	    assert container.status.startswith(str(HTTPStatus.OK.value))
43	    mock_request("POST", "/directory", {"d": os.path.dirname(__file__)})
44	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
44	    assert container.status.startswith(str(HTTPStatus.OK.value))
45	    mock_request("POST", "/directory", {})
46	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
46	    assert container.status.startswith(str(HTTPStatus.OK.value))
47	    mock_request("OPTIONS", "/directory", {})
48	    assert container.status.startswith(str(HTTPStatus.OK.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
49	    # 400
50	    mock_request("POST", "/lineage", {"e": "SELECT * FROM where foo='bar'"})
51	    assert container.status.startswith(str(HTTPStatus.BAD_REQUEST.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
52	    # 404
53	    mock_request("GET", "/non-exist-resource")
54	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
54	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))
55	    mock_request("GET", "/static")
56	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
56	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))
57	    mock_request("POST", "/script", {"f": "non-exist-file"})
58	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
58	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))
59	    mock_request("POST", "/non-exist-resource", {"e": "SELECT * FROM where foo='bar'"})
60	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
60	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))
61	    mock_request("GET", "/../cli.py")
62	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
62	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))
63	    mock_request("OPTIONS", "/non-exist-resource")
64	    assert container.status.startswith(str(HTTPStatus.NOT_FOUND.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
65	    # 405
66	    mock_request("PUT", "/")
67	    assert container.status.startswith(str(HTTPStatus.METHOD_NOT_ALLOWED.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
67	    assert container.status.startswith(str(HTTPStatus.METHOD_NOT_ALLOWED.value))
68	    mock_request("PATCH", "/")
69	    assert container.status.startswith(str(HTTPStatus.METHOD_NOT_ALLOWED.value))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/collate_sqllineage-1.6.14/collate_sqllineage-1.6.14/tests/test_drawing.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
69	    assert container.status.startswith(str(HTTPStatus.METHOD_NOT_ALLOWED.value))
70	    mock_request("DELETE", "/")
71	    assert container.status.startswith(str(HTTPStatus.METHOD_NOT_ALLOWED.value))

--------------------------------------------------

Code scanned:
	Total lines of code: 7125
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 24.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 0.0
Files skipped (0):
